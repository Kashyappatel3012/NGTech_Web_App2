 
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VAPT Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/vapt_dashboard.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .proceed-btn:disabled {
            opacity: 0.6 !important;
            cursor: not-allowed !important;
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 9999;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.7);
        }
        
        .modal-content {
            background-color: #fefefe;
            margin: 2% auto;
            padding: 0;
            border: 1px solid #888;
            width: 90%;
            max-width: 1000px;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            max-height: 95vh;
            display: flex;
            flex-direction: column;
        }
        
        .modal-header {
            padding: 20px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 12px 12px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h3 {
            margin: 0;
            font-size: 24px;
        }
        
        .close-modal {
            color: white;
            font-size: 32px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .close-modal:hover {
            transform: scale(1.2);
        }
        
        .modal-body {
            padding: 30px;
            overflow-y: auto;
            flex: 1;
        }
        
        .scrollable-content {
            max-height: calc(95vh - 200px);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }
        
        .form-group input[type="text"],
        .form-group input[type="email"],
        .form-group input[type="date"],
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .combo-input {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .hidden {
            display: none !important;
        }
        
        .name-input {
            display: flex;
            gap: 10px;
        }
        
        .title-select {
            width: 100px;
        }
        
        .add-member-btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
        }
        
        .add-member-btn:hover {
            background: #229954;
        }
        
        .team-member {
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 2px solid #e0e0e0;
        }
        
        .radio-group {
            display: flex;
            gap: 20px;
        }
        
        .radio-group label {
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: normal;
        }
        
        .file-upload-group {
            margin-bottom: 20px;
        }
        
        .file-help {
            display: block;
            margin-top: 5px;
            font-size: 12px;
        }
        
        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #e0e0e0;
        }
        
        .submit-btn, .cancel-btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .submit-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .cancel-btn {
            background: #e74c3c;
            color: white;
        }
        
        .cancel-btn:hover {
            background: #c0392b;
        }
        
        /* Vulnerability Dialog Styles */
        .vuln-confirmation-dialog {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }
        
        .dialog-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .proceed-btn {
            background: #27ae60;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
        }
        
        .proceed-btn:hover {
            background: #229954;
        }
        
        .button-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        
        /* Loading Indicator */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 99999;
        }
        
        .loading-content {
            background: white;
            padding: 40px;
            border-radius: 12px;
            text-align: center;
        }
        
        .loading-spinner {
            border: 8px solid #f3f3f3;
            border-top: 8px solid #667eea;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <div class="sidebar">
            <div class="sidebar-header">
                <h2><i class="fas fa-shield-alt"></i> VAPT Dashboard</h2>
                <p>Welcome, User</p>
            </div>
            <nav>
                <a href="#employee-section" class="active"><i class="fas fa-users"></i> Employee Details</a>
                <a href="#reporting-section"><i class="fas fa-file-alt"></i> Reporting</a>
                <a href="#chat-section"><i class="fas fa-comments"></i> AI Chat Board</a>
                <a href="#work-section"><i class="fas fa-tasks"></i> Update Your Work</a>
                <a href="{{ url_for('logout') }}"><i class="fas fa-sign-out-alt"></i> Logout</a>
            </nav>
        </div>

        
        <div class="main-content">
            <!-- Update the employee details section -->
<section id="employee-section" class="dashboard-section">
    <h1><i class="fas fa-users"></i> Employee Details</h1>
    <div class="employee-container">
        <div class="employee-card">
            <div class="employee-info">
    <img src="{{ url_for('static', filename='uploads/' + employee_data.photo) if employee_data and employee_data.photo else url_for('static', filename='images/default_avatar.jpg') }}" alt="Employee Photo" class="employee-img">
    <div class="employee-details">
        <h3>{{ current_user.employee_name }}</h3>
        <p><i class="fas fa-briefcase"></i> {{ employee_data.position if employee_data else 'Position not set' }}</p>
        <p><i class="fas fa-building"></i> {{ current_user.department }} Department</p>
        <p><i class="fas fa-clock"></i> {{ employee_data.experience if employee_data else 'Experience not set' }}</p>
    </div>
</div>
<div class="employee-additional-info">
    <div class="info-row">
        <span><i class="fas fa-graduation-cap"></i> <strong>Education:</strong> {{ employee_data.education if employee_data else 'Not set' }}</span>
    </div>
    <div class="info-row">
        <span><i class="fas fa-certificate"></i> <strong>Certification:</strong> {{ employee_data.certifications if employee_data else 'Not set' }}</span>
    </div>
    <div class="info-row">
        <span><i class="fas fa-birthday-cake"></i> <strong>DOB:</strong> {{ employee_data.date_of_birth.strftime('%d/%m/%Y') if employee_data and employee_data.date_of_birth else 'Not set' }}</span>
    </div>
    <div class="info-row">
        <span><i class="fas fa-tint"></i> <strong>Blood Group:</strong> {{ employee_data.blood_group if employee_data else 'Not set' }}</span>
    </div>
    <div class="info-row">
        <span><i class="fas fa-envelope"></i> <strong>Email:</strong> {{ current_user.email }}</span>
    </div>
    <div class="info-row">
        <span><i class="fas fa-phone"></i> <strong>Contact:</strong> {{ employee_data.contact_number if employee_data else 'Not set' }}</span>
    </div>
</div>
        </div>

<div class="progress-chart">
    <span class="chart-title">Previous Month Performance</span>
    <div id="progressChartContainer" style="width: 100%; height: 260px; position: relative; display: block; min-height: 260px;">
        <canvas id="progressChart" style="display: block; width: 100% !important; height: 100% !important;"></canvas>
    </div>
    <span class="chart-title" style="margin-top: 2rem;">Last Year Performance</span>
    <div id="lastYearChartContainer" style="width: 100%; height: 260px; position: relative; display: block; min-height: 260px;">
        <canvas id="lastYearChart" style="display: block; width: 100% !important; height: 100% !important;"></canvas>
    </div>
</div>

    </div>
</section>
            <section id="reporting-section" class="dashboard-section">
                <h1><i class="fas fa-file-alt"></i> Reporting Section</h1>
                <div class="report-accordion">
                    <!-- Infrastructure VAPT Report -->
                    <div class="accordion-item">
                        <button class="accordion-btn">
                            <i class="fas fa-server"></i>
                            <span>Infrastructure VAPT Report</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="accordion-content">
                            <button class="report-option" onclick="openVaptModal('vaptFirstAuditModal')"><i class="fas fa-file-excel"></i> Infrastructure First Audit Report Excel</button>
                            <button class="report-option" onclick="openVaptModal('vaptFirstAuditWordModal')"><i class="fas fa-file-word"></i> Infrastructure First Audit Report</button>
                            <button class="report-option" onclick="openVaptModal('vaptFollowUpAuditModal')"><i class="fas fa-file-excel"></i> Infrastructure Follow-up Audit Report Excel</button>
                            <button class="report-option" onclick="openVaptModal('vaptFollowUpAuditWordModal')"><i class="fas fa-file-word"></i> Infrastructure Follow-up Audit Report</button>
                            <button class="report-option" onclick="openVaptModal('vaptFirstAuditMetaDataModal')"><i class="fas fa-database"></i> Infrastructure First Audit Meta Data Create</button>
                            <button class="report-option" onclick="openVaptModal('vaptFollowUpAuditMetaDataModal')"><i class="fas fa-database"></i> Infrastructure Follow up Audit Meta Data Create</button>
                            <button class="report-option" onclick="openVaptModal('vaptFirstAuditCertificateModal')"><i class="fas fa-certificate"></i> Infrastructure First Audit Completion Certificate</button>
                            <button class="report-option" onclick="openVaptModal('vaptFollowUpAuditCertificateModal')"><i class="fas fa-certificate"></i> Infrastructure Follow-up Audit Completion Certificate</button>
                        </div>
                    </div>
                    
                    <!-- Website VAPT Report -->
                    <div class="accordion-item">
                        <button class="accordion-btn">
                            <i class="fas fa-globe"></i>
                            <span>Website VAPT Report</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="accordion-content">
                            <button class="report-option" onclick="openVaptModal('websiteVaptFirstAuditModal')"><i class="fas fa-file-excel"></i> Website First Audit Report Excel</button>
                            <button class="report-option" onclick="openVaptModal('websiteVaptFirstAuditWordModal')"><i class="fas fa-file-word"></i> Website First Audit Report</button>
                            <button class="report-option" onclick="openVaptModal('websiteVaptFollowUpAuditModal')"><i class="fas fa-file-excel"></i> Website Follow-up Audit Report Excel</button>
                            <button class="report-option" onclick="openVaptModal('websiteVaptFollowUpAuditWordModal')"><i class="fas fa-file-word"></i> Website Follow-up Audit Report</button>
                            <button class="report-option" onclick="openVaptModal('websiteVaptFirstAuditMetaDataModal')"><i class="fas fa-database"></i> Website First Audit Meta Data Create</button>
                            <button class="report-option" onclick="openVaptModal('websiteVaptFollowUpAuditMetaDataModal')"><i class="fas fa-database"></i> Website Follow up Audit Meta Data Create</button>
                            <button class="report-option" onclick="openVaptModal('websiteVaptFirstAuditCertificateModal')"><i class="fas fa-certificate"></i> Website First Audit Completion Certificate</button>
                            <button class="report-option" onclick="openVaptModal('websiteVaptFollowUpAuditCertificateModal')"><i class="fas fa-certificate"></i> Website Follow-up Audit Completion Certificate</button>
                        </div>
                    </div>
                    
                    <!-- Public IP VAPT Report -->
                    <div class="accordion-item">
                        <button class="accordion-btn">
                            <i class="fas fa-network-wired"></i>
                            <span>Public IP VAPT Report</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="accordion-content">
                            <button class="report-option" onclick="openVaptModal('publicIpFirstAuditModal')"><i class="fas fa-file-excel"></i> Public IP First Audit Report Excel</button>
                            <button class="report-option" onclick="openVaptModal('publicIpFirstAuditWordModal')"><i class="fas fa-file-word"></i> Public IP First Audit Report</button>
                            <button class="report-option" onclick="openVaptModal('publicIpFollowUpAuditModal')"><i class="fas fa-file-excel"></i> Public IP Follow-up Audit Report Excel</button>
                            <button class="report-option" onclick="openVaptModal('publicIpFollowUpAuditWordModal')"><i class="fas fa-file-word"></i> Public IP Follow-up Audit Report</button>
                            <button class="report-option" onclick="openVaptModal('publicIpFirstAuditMetaDataModal')"><i class="fas fa-database"></i> Public IP First Audit Meta Data Create</button>
                            <button class="report-option" onclick="openVaptModal('publicIpFollowUpAuditMetaDataModal')"><i class="fas fa-database"></i> Public IP Follow up Audit Meta Data Create</button>
                            <button class="report-option" onclick="openVaptModal('publicIpFirstAuditCertificateModal')"><i class="fas fa-certificate"></i> Public IP First Audit Completion Certificate</button>
                            <button class="report-option" onclick="openVaptModal('publicIpVaptFollowUpAuditCertificateModal')"><i class="fas fa-certificate"></i> Public IP Follow-up Audit Completion Certificate</button>
                        </div>
                    </div>
                    
                    <!-- Web Application VAPT Report -->
                    <div class="accordion-item">
                        <button class="accordion-btn">
                            <i class="fas fa-code"></i>
                            <span>Web Application VAPT Report</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="accordion-content">
                            <button class="report-option" onclick="openVaptModal('webAppFirstAuditModal')"><i class="fas fa-file-excel"></i> Web Application First Audit Report Excel</button>
                            <button class="report-option" onclick="openVaptModal('webAppFirstAuditWordModal')"><i class="fas fa-file-word"></i> Web Application First Audit Report</button>
                            <button class="report-option" onclick="openVaptModal('webAppFollowUpAuditModal')"><i class="fas fa-file-excel"></i> Web Application Follow-up Audit Report Excel</button>
                            <button class="report-option" onclick="openVaptModal('webAppFollowUpAuditWordModal')"><i class="fas fa-file-word"></i> Web Application Follow-up Audit Report</button>
                            <button class="report-option" onclick="openVaptModal('webAppVaptFirstAuditMetaDataModal')"><i class="fas fa-database"></i> Web Application First Audit Meta Data Create</button>
                            <button class="report-option" onclick="openVaptModal('webAppVaptFollowUpAuditMetaDataModal')"><i class="fas fa-database"></i> Web Application Follow up Audit Meta Data Create</button>
                            <button class="report-option" onclick="openVaptModal('webAppVaptFirstAuditCertificateModal')"><i class="fas fa-certificate"></i> Web Application First Audit Completion Certificate</button>
                            <button class="report-option" onclick="openVaptModal('webAppVaptFollowUpAuditCertificateModal')"><i class="fas fa-certificate"></i> Web Application Follow-up Audit Completion Certificate</button>
                        </div>
                    </div>
                    
                    <!-- Android Mobile Application VAPT Report -->
                    <div class="accordion-item">
                        <button class="accordion-btn">
                            <i class="fas fa-mobile-alt"></i>
                            <span>Android Mobile Application VAPT Report</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="accordion-content">
                            <button class="report-option" onclick="openVaptModal('androidAppFirstAuditModal')"><i class="fas fa-file-excel"></i> Android Mobile Application First Audit Report Excel</button>
                            <button class="report-option" onclick="openVaptModal('androidAppFirstAuditWordModal')"><i class="fas fa-file-word"></i> Android Mobile Application First Audit Report</button>
                            <button class="report-option" onclick="openVaptModal('androidAppFollowUpAuditModal')"><i class="fas fa-file-excel"></i> Android Mobile Application Follow-up Audit Report Excel</button>
                            <button class="report-option" onclick="openVaptModal('androidAppFollowUpAuditWordModal')"><i class="fas fa-file-word"></i> Android Mobile Application Follow-up Audit Report</button>
                            <button class="report-option" onclick="openVaptModal('androidVaptFirstAuditMetaDataModal')"><i class="fas fa-database"></i> Android Mobile Application First Audit Meta Data Create</button>
                            <button class="report-option" onclick="openVaptModal('androidVaptFollowUpAuditMetaDataModal')"><i class="fas fa-database"></i> Android Mobile Application Follow up Audit Meta Data Create</button>
                            <button class="report-option" onclick="openVaptModal('androidAppVaptFirstAuditCertificateModal')"><i class="fas fa-certificate"></i> Android Mobile Application First Audit Completion Certificate</button>
                            <button class="report-option" onclick="openVaptModal('androidAppVaptFollowUpAuditCertificateModal')"><i class="fas fa-certificate"></i> Android Mobile Application Follow-up Audit Completion Certificate</button>
                        </div>
                    </div>
                    
                    <!-- IOS Mobile Application VAPT Report -->
                    <div class="accordion-item">
                        <button class="accordion-btn">
                            <i class="fas fa-apple"></i>
                            <span>IOS Mobile Application VAPT Report</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="accordion-content">
                            <button class="report-option" onclick="openVaptModal('iosAppFirstAuditModal')"><i class="fas fa-file-excel"></i> IOS Mobile Application First Audit Report Excel</button>
                            <button class="report-option" onclick="openVaptModal('iosAppFirstAuditWordModal')"><i class="fas fa-file-word"></i> IOS Mobile Application First Audit Report</button>
                            <button class="report-option" onclick="openVaptModal('iosAppFollowUpAuditModal')"><i class="fas fa-file-excel"></i> IOS Mobile Application Follow-up Audit Report Excel</button>
                            <button class="report-option" onclick="openVaptModal('iosAppFollowUpAuditWordModal')"><i class="fas fa-file-word"></i> IOS Mobile Application Follow-up Audit Report</button>
                            <button class="report-option" onclick="openVaptModal('iosVaptFirstAuditMetaDataModal')"><i class="fas fa-database"></i> IOS Mobile Application First Audit Meta Data Create</button>
                            <button class="report-option" onclick="openVaptModal('iosVaptFollowUpAuditMetaDataModal')"><i class="fas fa-database"></i> IOS Mobile Application Follow up Audit Meta Data Create</button>
                            <button class="report-option" onclick="openVaptModal('iosAppVaptFirstAuditCertificateModal')"><i class="fas fa-certificate"></i> IOS Mobile Application First Audit Completion Certificate</button>
                            <button class="report-option" onclick="openVaptModal('iosAppVaptFollowUpAuditCertificateModal')"><i class="fas fa-certificate"></i> IOS Mobile Application Follow-up Audit Completion Certificate</button>
                        </div>
                    </div>
                    
                    <!-- API VAPT Report -->
                    <div class="accordion-item">
                        <button class="accordion-btn">
                            <i class="fas fa-plug"></i>
                            <span>API VAPT Report</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="accordion-content">
                            <button class="report-option" onclick="openVaptModal('apiFirstAuditModal')"><i class="fas fa-file-excel"></i> API First Audit Report Excel</button>
                            <button class="report-option" onclick="openVaptModal('apiAppFirstAuditWordModal')"><i class="fas fa-file-word"></i> API First Audit Report</button>
                            <button class="report-option" onclick="openVaptModal('apiFollowUpAuditModal')"><i class="fas fa-file-excel"></i> API Follow-up Audit Report Excel</button>
                            <button class="report-option" onclick="openVaptModal('apiFollowUpAuditWordModal')"><i class="fas fa-file-word"></i> API Follow-up Audit Report</button>
                            <button class="report-option" onclick="openVaptModal('apiFirstAuditMetaDataModal')"><i class="fas fa-database"></i> API First Audit Meta Data Create</button>
                            <button class="report-option" onclick="openVaptModal('apiFollowUpAuditMetaDataModal')"><i class="fas fa-database"></i> API Follow up Audit Meta Data Create</button>
                            <button class="report-option" onclick="openVaptModal('apiVaptFirstAuditCertificateModal')"><i class="fas fa-certificate"></i> API First Audit Completion Certificate</button>
                            <button class="report-option" onclick="openVaptModal('apiVaptFollowUpAuditCertificateModal')"><i class="fas fa-certificate"></i> API Follow-up Audit Completion Certificate</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- VAPT First Audit Modal -->
            <div id="vaptFirstAuditModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Infrastructure VAPT First Audit Details</h3>
                        <span class="close-modal" onclick="closeVaptModal('vaptFirstAuditModal')">&times;</span>
                    </div>
                    <div class="modal-body scrollable-content">
                        <form id="vaptFirstAuditForm" action="/process_vapt_first_audit_report" method="POST" enctype="multipart/form-data">
                            <!-- Organization Section -->
                            <div class="form-group">
                                <label for="vaptOrganization">Organization Name*</label>
                                <div class="combo-input">
                                    <select id="vaptOrganization" name="organization" required onchange="toggleVaptOtherInput('vaptOrganization', 'vaptOtherOrganization')">
                                        <option value="">Select Organization</option>
                                        <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                        <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                        <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                        <option value="Megasoft Limited">Megasoft Limited</option>
                                        <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                        <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                        <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                        <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                        <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                        <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                        <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                        <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                        <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                        <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                        <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                        <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                        <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                        <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                        <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                        <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                        <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                        <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                        <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                        <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                        <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                        <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                        <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                        <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                        <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                        <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                        <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                        <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                        <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                        <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                        <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                        <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                        <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                        <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                        <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                        <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                        
            
                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="vaptOtherOrganization" name="otherOrganization" class="hidden" placeholder="Enter Organization Name">
                                </div>
                            </div>

                            <!-- Location Section -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="vaptCity">City*</label>
                                    <div class="combo-input">
                                        <select id="vaptCity" name="city" required onchange="toggleVaptOtherInput('vaptCity', 'vaptOtherCity')">
                                            <option value="">Select City</option>
                                            <!-- Gujarat -->
                                            <option value="Ahmedabad">Ahmedabad</option>
                                            <option value="Amreli">Amreli</option>
                                            <option value="Anand">Anand</option>
                                            <option value="Aravalli">Aravalli</option>
                                            <option value="Banaskantha">Banaskantha</option>
                                            <option value="Bharuch">Bharuch</option>
                                            <option value="Bhavnagar">Bhavnagar</option>
                                            <option value="Botad">Botad</option>
                                            <option value="Chhota Udaipur">Chhota Udaipur</option>
                                            <option value="Dahod">Dahod</option>
                                            <option value="Dang">Dang</option>
                                            <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                            <option value="Gandhinagar">Gandhinagar</option>
                                            <option value="Gir Somnath">Gir Somnath</option>
                                            <option value="Jamnagar">Jamnagar</option>
                                            <option value="Junagadh">Junagadh</option>
                                            <option value="Kheda">Kheda</option>
                                            <option value="Kutch">Kutch</option>
                                            <option value="Mahisagar">Mahisagar</option>
                                            <option value="Mehsana">Mehsana</option>
                                            <option value="Morbi">Morbi</option>
                                            <option value="Narmada">Narmada</option>
                                            <option value="Navsari">Navsari</option>
                                            <option value="Patan">Patan</option>
                                            <option value="Panchmahal">Panchmahal</option>
                                            <option value="Porbandar">Porbandar</option>
                                            <option value="Rajkot">Rajkot</option>
                                            <option value="Sabarkantha">Sabarkantha</option>
                                            <option value="Surat">Surat</option>
                                            <option value="Surendranagar">Surendranagar</option>
                                            <option value="Tapi">Tapi</option>
                                            <option value="Vadodara">Vadodara</option>
                                            <option value="Valsad">Valsad</option>
                
                                            <!-- Rajasthan -->
                                            <option value="Ajmer">Ajmer</option>
                                            <option value="Alwar">Alwar</option>
                                            <option value="Banswara">Banswara</option>
                                            <option value="Baran">Baran</option>
                                            <option value="Barmer">Barmer</option>
                                            <option value="Bharatpur">Bharatpur</option>
                                            <option value="Bhilwara">Bhilwara</option>
                                            <option value="Bikaner">Bikaner</option>
                                            <option value="Bundi">Bundi</option>
                                            <option value="Chittorgarh">Chittorgarh</option>
                                            <option value="Churu">Churu</option>
                                            <option value="Dausa">Dausa</option>
                                            <option value="Dholpur">Dholpur</option>
                                            <option value="Dungarpur">Dungarpur</option>
                                            <option value="Hanumangarh">Hanumangarh</option>
                                            <option value="Jaipur">Jaipur</option>
                                            <option value="Jaisalmer">Jaisalmer</option>
                                            <option value="Jalore">Jalore</option>
                                            <option value="Jhalawar">Jhalawar</option>
                                            <option value="Jhunjhunu">Jhunjhunu</option>
                                            <option value="Jodhpur">Jodhpur</option>
                                            <option value="Karauli">Karauli</option>
                                            <option value="Kota">Kota</option>
                                            <option value="Nagaur">Nagaur</option>
                                            <option value="Pali">Pali</option>
                                            <option value="Pratapgarh">Pratapgarh</option>
                                            <option value="Rajsamand">Rajsamand</option>
                                            <option value="Sikar">Sikar</option>
                                            <option value="Sirohi">Sirohi</option>
                                            <option value="Sri Ganganagar">Sri Ganganagar</option>
                                            <option value="Tonk">Tonk</option>
                                            <option value="Udaipur">Udaipur</option>
                
                                            <!-- Maharashtra -->
                                            <option value="Ahmednagar">Ahmednagar</option>
                                            <option value="Akola">Akola</option>
                                            <option value="Amravati">Amravati</option>
                                            <option value="Aurangabad">Aurangabad</option>
                                            <option value="Beed">Beed</option>
                                            <option value="Bhandara">Bhandara</option>
                                            <option value="Chandrapur">Chandrapur</option>
                                            <option value="Dhule">Dhule</option>
                                            <option value="Gadchiroli">Gadchiroli</option>
                                            <option value="Gondia">Gondia</option>
                                            <option value="Hingoli">Hingoli</option>
                                            <option value="Jalgaon">Jalgaon</option>
                                            <option value="Jalna">Jalna</option>
                                            <option value="Kolhapur">Kolhapur</option>
                                            <option value="Latur">Latur</option>
                                            <option value="Mumbai City">Mumbai City</option>
                                            <option value="Mumbai Suburban">Mumbai Suburban</option>
                                            <option value="Nagpur">Nagpur</option>
                                            <option value="Nanded">Nanded</option>
                                            <option value="Nandurbar">Nandurbar</option>
                                            <option value="Nashik">Nashik</option>
                                            <option value="Osmanabad">Osmanabad</option>
                                            <option value="Palghar">Palghar</option>
                                            <option value="Parbhani">Parbhani</option>
                                            <option value="Pune">Pune</option>
                                            <option value="Raigad">Raigad</option>
                                            <option value="Ratnagiri">Ratnagiri</option>
                                            <option value="Sangli">Sangli</option>
                                            <option value="Satara">Satara</option>
                                            <option value="Sindhudurg">Sindhudurg</option>
                                            <option value="Solapur">Solapur</option>
                                            <option value="Thane">Thane</option>
                                            <option value="Wardha">Wardha</option>
                                            <option value="Washim">Washim</option>
                                            <option value="Yavatmal">Yavatmal</option>
                
                                            <!-- Uttar Pradesh -->
                                            <option value="Agra">Agra</option>
                                            <option value="Aligarh">Aligarh</option>
                                            <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                            <option value="Amethi">Amethi</option>
                                            <option value="Amroha">Amroha</option>
                                            <option value="Auraiya">Auraiya</option>
                                            <option value="Ayodhya">Ayodhya</option>
                                            <option value="Azamgarh">Azamgarh</option>
                                            <option value="Bagpat">Bagpat</option>
                                            <option value="Bahraich">Bahraich</option>
                                            <option value="Ballia">Ballia</option>
                                            <option value="Balrampur">Balrampur</option>
                                            <option value="Banda">Banda</option>
                                            <option value="Barabanki">Barabanki</option>
                                            <option value="Bareilly">Bareilly</option>
                                            <option value="Basti">Basti</option>
                                            <option value="Bhadohi">Bhadohi</option>
                                            <option value="Bijnor">Bijnor</option>
                                            <option value="Bulandshahr">Bulandshahr</option>
                                            <option value="Chandauli">Chandauli</option>
                                            <option value="Chitrakoot">Chitrakoot</option>
                                            <option value="Deoria">Deoria</option>
                                            <option value="Etah">Etah</option>
                                            <option value="Etawah">Etawah</option>
                                            <option value="Farrukhabad">Farrukhabad</option>
                                            <option value="Fatehpur">Fatehpur</option>
                                            <option value="Firozabad">Firozabad</option>
                                            <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                            <option value="Ghaziabad">Ghaziabad</option>
                                            <option value="Ghazipur">Ghazipur</option>
                                            <option value="Gonda">Gonda</option>
                                            <option value="Gorakhpur">Gorakhpur</option>
                                            <option value="Hamirpur">Hamirpur</option>
                                            <option value="Hapur">Hapur</option>
                                            <option value="Hardoi">Hardoi</option>
                                            <option value="Hathras">Hathras</option>
                                            <option value="Jalaun">Jalaun</option>
                                            <option value="Jaunpur">Jaunpur</option>
                                            <option value="Jhansi">Jhansi</option>
                                            <option value="Kannauj">Kannauj</option>
                                            <option value="Kanpur Dehat">Kanpur Dehat</option>
                                            <option value="Kanpur Nagar">Kanpur Nagar</option>
                                            <option value="Kasganj">Kasganj</option>
                                            <option value="Kaushambi">Kaushambi</option>
                                            <option value="Kushinagar">Kushinagar</option>
                                            <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                            <option value="Lalitpur">Lalitpur</option>
                                            <option value="Lucknow">Lucknow</option>
                                            <option value="Maharajganj">Maharajganj</option>
                                            <option value="Mahoba">Mahoba</option>
                                            <option value="Mainpuri">Mainpuri</option>
                                            <option value="Mathura">Mathura</option>
                                            <option value="Mau">Mau</option>
                                            <option value="Meerut">Meerut</option>
                                            <option value="Mirzapur">Mirzapur</option>
                                            <option value="Moradabad">Moradabad</option>
                                            <option value="Muzaffarnagar">Muzaffarnagar</option>
                                            <option value="Pilibhit">Pilibhit</option>
                                            <option value="Pratapgarh">Pratapgarh</option>
                                            <option value="Rae Bareli">Rae Bareli</option>
                                            <option value="Rampur">Rampur</option>
                                            <option value="Saharanpur">Saharanpur</option>
                                            <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                            <option value="Shahjahanpur">Shahjahanpur</option>
                                            <option value="Shravasti">Shravasti</option>
                                            <option value="Siddharthnagar">Siddharthnagar</option>
                                            <option value="Sitapur">Sitapur</option>
                                            <option value="Sonbhadra">Sonbhadra</option>
                                            <option value="Sultanpur">Sultanpur</option>
                                            <option value="Unnao">Unnao</option>
                                            <option value="Varanasi">Varanasi</option>
                
                                            <!-- Uttarakhand -->
                                            <option value="Almora">Almora</option>
                                            <option value="Bageshwar">Bageshwar</option>
                                            <option value="Chamoli">Chamoli</option>
                                            <option value="Champawat">Champawat</option>
                                            <option value="Dehradun">Dehradun</option>
                                            <option value="Haridwar">Haridwar</option>
                                            <option value="Nainital">Nainital</option>
                                            <option value="Pauri Garhwal">Pauri Garhwal</option>
                                            <option value="Pithoragarh">Pithoragarh</option>
                                            <option value="Rudraprayag">Rudraprayag</option>
                                            <option value="Tehri Garhwal">Tehri Garhwal</option>
                                            <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                            <option value="Uttarkashi">Uttarkashi</option>
                                                            <!-- Add more cities as needed -->
                                            <option value="other">Other (Please specify)</option>
                                        </select>
                                        <input type="text" id="vaptOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="vaptState">State*</label>
                                    <select id="vaptState" name="state" required>
                                        <option value="">Select State</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                        <option value="Assam">Assam</option>
                                        <option value="Bihar">Bihar</option>
                                        <option value="Chhattisgarh">Chhattisgarh</option>
                                        <option value="Goa">Goa</option>
                                        <option value="Gujarat">Gujarat</option>
                                        <option value="Haryana">Haryana</option>
                                        <option value="Himachal Pradesh">Himachal Pradesh</option>
                                        <option value="Jharkhand">Jharkhand</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Kerala">Kerala</option>
                                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Manipur">Manipur</option>
                                        <option value="Meghalaya">Meghalaya</option>
                                        <option value="Mizoram">Mizoram</option>
                                        <option value="Nagaland">Nagaland</option>
                                        <option value="Odisha">Odisha</option>
                                        <option value="Punjab">Punjab</option>
                                        <option value="Rajasthan">Rajasthan</option>
                                        <option value="Sikkim">Sikkim</option>
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="Telangana">Telangana</option>
                                        <option value="Tripura">Tripura</option>
                                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                                        <option value="Uttarakhand">Uttarakhand</option>
                                        <option value="West Bengal">West Bengal</option>
                                        <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                        <option value="Chandigarh">Chandigarh</option>
                                        <option value="Dadra and Nagar Haveli and Daman and Diu">Dadra and Nagar Haveli and Daman and Diu</option>
                                        <option value="Delhi">Delhi</option>
                                        <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                                        <option value="Ladakh">Ladakh</option>
                                        <option value="Lakshadweep">Lakshadweep</option>
                                        <option value="Puducherry">Puducherry</option>
                                        
                                        <!-- Add all states as needed -->
                                    </select>
                                </div>
                            </div>

                            <!-- Audit Dates -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="vaptStartDate">Start Audit Date*</label>
                                    <input type="date" id="vaptStartDate" name="startDate" required>
                                </div>
                                <div class="form-group">
                                    <label for="vaptEndDate">Finish Audit Date*</label>
                                    <input type="date" id="vaptEndDate" name="endDate" required>
                                </div>
                            </div>

                            <!-- Report Prepared By -->
                            <div class="form-group">
                                <label>Report Prepared By*</label>
                                <div class="name-input">
                                    <select class="title-select" name="preparedByTitle" required>
                                        <option value="Mr.">Mr.</option>
                                        <option value="Ms.">Ms.</option>
                                        <option value="Mrs.">Mrs.</option>
                                        <option value="Dr.">Dr.</option>
                                    </select>
                                    <input type="text" placeholder="Full Name" name="preparedByName" required>
                                </div>
                            </div>

                            <!-- Auditee Details -->
                            <div class="form-group">
                                <label>Name of Auditee Organization Person*</label>
                                <div class="name-input">
                                    <select class="title-select" name="auditeeTitle" required>
                                        <option value="Mr.">Mr.</option>
                                        <option value="Ms.">Ms.</option>
                                        <option value="Mrs.">Mrs.</option>
                                        <option value="Dr.">Dr.</option>
                                    </select>
                                    <input type="text" placeholder="Full Name" name="auditeeName" required>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="vaptDesignation">Designation of the Person*</label>
                                <input type="text" id="vaptDesignation" name="designation" required>
                            </div>

                            <div class="form-group">
                                <label for="vaptBankEmail">Email ID of the Bank*</label>
                                <div id="vaptEmailContainer">
                                    <input type="email" name="bankEmail[]" placeholder="Email Address" required>
                                </div>
                                <button type="button" class="add-member-btn" id="vaptAddEmailBtn" style="margin-top: 10px;">+ Add Another Email</button>
                            </div>

                            <!-- Auditing Team -->
                            <div class="form-group">
                                <label>Details of Auditing Team* (At least 1 required, max 8)</label>
                                <div id="vaptAuditTeamContainer">
                                    <div class="team-member" data-index="0">
                                        <div class="form-row">
                                            <div class="form-group">
                                                <input type="text" name="teamName[]" placeholder="Name*" required>
                                            </div>
                                            <div class="form-group">
                                                <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                                            </div>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                                            </div>
                                            <div class="form-group">
                                                <input type="text" name="teamQualification[]" placeholder="Qualification/Certification*" required>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label>Certified (Yes/No)*</label>
                                            <div class="radio-group">
                                                <label><input type="radio" name="teamCertified[0]" value="yes" required> Yes</label>
                                                <label><input type="radio" name="teamCertified[0]" value="no"> No</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <button type="button" class="add-member-btn" id="vaptAddMemberBtn">+ Add Team Member</button>
                            </div>

                            <!-- File Uploads -->
                            <div class="form-group">
                                <label>File Uploads*</label>
                                
                                <div class="file-upload-group">
                                    <label for="vaptNmapFiles">Nmap Zip Files</label>
                                    <input type="file" id="vaptNmapFiles" name="nmapFiles" accept=".zip" required>
                                    <small class="file-help" style="color: brown;">All Nmap files must be placed directly in the ZIP file (no nested folders) and must be in CSV format.</small>
                                </div>
                                
                                <div class="file-upload-group">
                                    <label for="vaptNessusFiles">Nessus Zip Files</label>
                                    <input type="file" id="vaptNessusFiles" name="nessusFiles" accept=".zip" required>
                                    <small class="file-help" style="color: brown;">All Nessus files must be placed directly inside a single ZIP file with no nested folders. File names should follow branch names (e.g., Head-Office, Althan), and extra text after a space or underscore is acceptable as it will be ignored. Use a dash (-) for multi-word branch names (e.g., Kala-talav). For device reports (Server, Switch, Router, Firewall, DVR, NVR, Workstations, Access Points, SAN, NAS), use the device name directly. For specific devices like DR Router or DC Firewall, write them without spaces or underscores (e.g., DRRouter, DCFirewall). File names must follow these rules since the Excel report is generated based on them.</small>
                                </div>
                                
                                <div class="file-upload-group">
                                    <label for="vaptEvidenceFiles">Evidences Zip Files</label>
                                    <input type="file" id="vaptEvidenceFiles" name="evidenceFiles" accept=".zip" required>
                                    <small class="file-help" style="color: brown;">The evidence ZIP file may contain separate subfolders for different branches or devices, but it must include a folder named "ALL POC". This folder should contain a single piece of evidence(Image) for each vulnerability that needs to be added to the Excel file. The evidence(Image) file name must exactly match the vulnerability name (e.g., SSL Certificate Expiry). To avoid spelling mistakes, always use copy-paste for naming instead of typing manually. If the file name does not match, the corresponding image will not be added to the Excel file.</small>
                                </div>
                            </div>

                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('vaptFirstAuditModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Submit Report</button>
                            </div>
                            <br>
                            <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>  
                            </small>
                        </form>
                    </div>
                </div>
            </div>

            <!-- VAPT First Audit Word Report Modal -->
            <div id="vaptFirstAuditWordModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>First Audit Word Report</h3>
                        <span class="close-modal" onclick="closeVaptModal('vaptFirstAuditWordModal')">&times;</span>
                    </div>
                    <div class="modal-body">
                        <form id="vaptFirstAuditWordForm" action="/process_vapt_first_audit_word_report" method="POST" enctype="multipart/form-data">
                            <div class="form-group">
                                <label for="vaptWordExcelFile">Upload Excel File (.xlsx)*</label>
                                <input type="file" id="vaptWordExcelFile" name="excelFile" accept=".xlsx" required>
                                <small class="file-help" style="color: brown;">Please select an Excel file (.xlsx) to generate the Word report. If the Excel file is generated through this tool, it will work correctly. However, if you create it manually, you must follow the proper format. To download the example format, <a href="static\Formats_and_Catalog\Sample_Files\Infrastructure_VAPT_First_Audit_Sample_Excel.xlsx" download>click here.</a> If the Excel file is not prepared according to these guidelines, the Word report may not be generated properly or may contain multiple issues.
                                   <br> <br>After generating the Word report, you must manually update the index page numbers by refreshing the table.
                                </small>
                                <br>
                                <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>  
                                </small>
                            </div>
                             
                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('vaptFirstAuditWordModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Word Report</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Web Application VAPT First Audit Word Report Modal -->
            <div id="webAppFirstAuditWordModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Web Application First Audit Word Report</h3>
                        <span class="close-modal" onclick="closeVaptModal('webAppFirstAuditWordModal')">&times;</span>
                    </div>
                    <div class="modal-body">
                        <form id="webAppFirstAuditWordForm" action="/process_web_app_vapt_first_audit_word_report" method="POST" enctype="multipart/form-data">
                            <div class="form-group">
                                <label for="webAppWordExcelFile">Upload Excel File (.xlsx)*</label>
                                <input type="file" id="webAppWordExcelFile" name="excelFile" accept=".xlsx" required>
                                <small class="file-help" style="color: brown;">Please select an Excel file (.xlsx) generated through the "Web Application First Audit Report Excel" tool. If you prepare the Excel manually, it must follow the required format, including the Meta_Data worksheet with asset information. Otherwise, the Word report may be generated incorrectly or contain issues.<br><br>After generating the Word report, manually refresh the table of contents to update page numbers.</small>
                                <br>
                                <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center></small>
                            </div>
                            
                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('webAppFirstAuditWordModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Word Report</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Android Mobile Application VAPT First Audit Word Report Modal -->
            <div id="androidAppFirstAuditWordModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Android Mobile Application First Audit Word Report</h3>
                        <span class="close-modal" onclick="closeVaptModal('androidAppFirstAuditWordModal')">&times;</span>
                    </div>
                    <div class="modal-body">
                        <form id="androidAppFirstAuditWordForm" action="/process_android_app_vapt_first_audit_word_report" method="POST" enctype="multipart/form-data">
                            <div class="form-group">
                                <label for="androidAppWordExcelFile">Upload Excel File (.xlsx)*</label>
                                <input type="file" id="androidAppWordExcelFile" name="excelFile" accept=".xlsx" required>
                                <small class="file-help" style="color: brown;">Please select an Excel file (.xlsx) generated through the "Android Mobile Application First Audit Report Excel" tool. If you prepare the Excel manually, it must follow the required format, including the Meta_Data worksheet with asset information (Description, Criticality, Hash Value, Version). Otherwise, the Word report may be generated incorrectly or contain issues.<br><br>After generating the Word report, manually refresh the table of contents to update page numbers.</small>
                                <br>
                                <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center></small>
                            </div>
                            
                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('androidAppFirstAuditWordModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Word Report</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <div id="iosAppFirstAuditWordModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>IOS Mobile Application First Audit Word Report</h3>
                        <span class="close-modal" onclick="closeVaptModal('iosAppFirstAuditWordModal')">&times;</span>
                    </div>
                    <div class="modal-body">
                        <form id="iosAppFirstAuditWordForm" action="/process_ios_app_vapt_first_audit_word_report" method="POST" enctype="multipart/form-data">
                            <div class="form-group">
                                <label for="iosAppWordExcelFile">Upload Excel File (.xlsx)*</label>
                                <input type="file" id="iosAppWordExcelFile" name="excelFile" accept=".xlsx" required>
                                <small class="file-help" style="color: brown;">Please select an Excel file (.xlsx) generated through the "IOS Mobile Application First Audit Report Excel" tool. If prepared manually, ensure it matches the required Meta_Data format, otherwise the Word report may be incorrect.<br><br>After downloading the Word report, refresh the table of contents to update page numbers.</small>
                                <br>
                                <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center></small>
                            </div>

                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('iosAppFirstAuditWordModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Word Report</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <div id="apiAppFirstAuditWordModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>API First Audit Word Report</h3>
                        <span class="close-modal" onclick="closeVaptModal('apiAppFirstAuditWordModal')">&times;</span>
                    </div>
                    <div class="modal-body">
                        <form id="apiAppFirstAuditWordForm" action="/process_api_vapt_first_audit_word_report" method="POST" enctype="multipart/form-data">
                            <div class="form-group">
                                <label for="apiAppWordExcelFile">Upload Excel File (.xlsx)*</label>
                                <input type="file" id="apiAppWordExcelFile" name="excelFile" accept=".xlsx" required>
                                <small class="file-help" style="color: brown;">Please select an Excel file (.xlsx) generated through the API First Audit Report Excel tool. If you prepare it manually, ensure the workbook includes the Meta_Data sheet and API VAPT worksheet with the expected structure to avoid placeholder issues in the Word output.<br><br>After downloading the Word report, refresh the table of contents to update page numbers.</small>
                                <br>
                                <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center></small>
                            </div>

                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('apiAppFirstAuditWordModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Word Report</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Android Mobile Application Follow-Up Audit Word Report Modal -->
            <div id="androidAppFollowUpAuditWordModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Android Mobile Application Follow-Up Audit Word Report</h3>
                        <span class="close-modal" onclick="closeVaptModal('androidAppFollowUpAuditWordModal')">&times;</span>
                    </div>
                    <div class="modal-body scrollable-content">
                        <form id="androidAppFollowUpAuditWordForm" action="/process_android_app_vapt_follow_up_audit_word_report" method="POST" enctype="multipart/form-data">
                            <!-- Organization Section -->
                            <div class="form-group">
                                <label for="androidAppFollowUpWordOrganization">Organization Name*</label>
                                <div class="combo-input">
                                    <select id="androidAppFollowUpWordOrganization" name="organization" required onchange="toggleVaptOtherInput('androidAppFollowUpWordOrganization', 'androidAppFollowUpWordOtherOrganization')">
                                        <option value="">Select Organization</option>
                                        <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                        <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                        <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                        <option value="Megasoft Limited">Megasoft Limited</option>
                                        <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                        <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                        <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                        <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                        <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                        <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                        <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                        <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                        <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                        <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                        <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                        <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                        <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                        <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                        <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                        <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                        <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                        <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                        <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                        <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                        <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                        <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                        <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                        <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                        <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                        <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                        <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                        <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                        <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                        <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                        <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                        <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                        <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                        <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                        <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                        <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="androidAppFollowUpWordOtherOrganization" name="otherOrganization" class="hidden" placeholder="Enter Organization Name">
                                </div>
                            </div>

                            <!-- Location Section -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="androidAppFollowUpWordCity">City*</label>
                                    <div class="combo-input">
                                        <select id="androidAppFollowUpWordCity" name="city" required onchange="toggleVaptOtherInput('androidAppFollowUpWordCity', 'androidAppFollowUpWordOtherCity')">
                                            <option value="">Select City</option>
                                            <option value="Ahmedabad">Ahmedabad</option>
                                            <option value="Mumbai">Mumbai</option>
                                            <option value="Delhi">Delhi</option>
                                            <option value="Bangalore">Bangalore</option>
                                            <option value="Chennai">Chennai</option>
                                            <option value="Kolkata">Kolkata</option>
                                            <option value="Hyderabad">Hyderabad</option>
                                            <option value="Pune">Pune</option>
                                            <option value="other">Other (Please specify)</option>
                                        </select>
                                        <input type="text" id="androidAppFollowUpWordOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="androidAppFollowUpWordState">State*</label>
                                    <select id="androidAppFollowUpWordState" name="state" required>
                                        <option value="">Select State</option>
                                        <option value="Gujarat">Gujarat</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Rajasthan">Rajasthan</option>
                                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                                        <option value="Uttarakhand">Uttarakhand</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="West Bengal">West Bengal</option>
                                        <option value="Delhi">Delhi</option>
                                    </select>
                                </div>
                            </div>

                            <!-- First Audit Report Details -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="androidAppFollowUpWordFirstAuditReportId">First Audit Report ID*</label>
                                    <input type="text" id="androidAppFollowUpWordFirstAuditReportId" name="firstAuditReportId" required>
                                </div>
                                <div class="form-group">
                                    <label for="androidAppFollowUpWordFirstAuditReportDate">First Audit Report Release Date*</label>
                                    <input type="date" id="androidAppFollowUpWordFirstAuditReportDate" name="firstAuditReportDate" required>
                                </div>
                            </div>

                            <!-- Audit Dates -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="androidAppFollowUpWordStartDate">Start Audit Date*</label>
                                    <input type="date" id="androidAppFollowUpWordStartDate" name="startDate" required>
                                </div>
                                <div class="form-group">
                                    <label for="androidAppFollowUpWordEndDate">Finish Audit Date*</label>
                                    <input type="date" id="androidAppFollowUpWordEndDate" name="endDate" required>
                                </div>
                            </div>

                            <!-- Asset Details -->
                            <div class="form-group">
                                <label>Asset Details* (At least 1 required, max 8)</label>
                                <div id="androidAppFollowUpWordAssetContainer">
                                    <div class="asset-entry" data-asset-index="0">
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label for="androidAppFollowUpWordAssetDescription_0">Asset Description*</label>
                                                <input type="text" id="androidAppFollowUpWordAssetDescription_0" name="assetDescription[]" placeholder="Enter asset description" required>
                                            </div>
                                            <div class="form-group">
                                                <label for="androidAppFollowUpWordAssetCriticality_0">Criticality of Asset*</label>
                                                <input type="text" id="androidAppFollowUpWordAssetCriticality_0" name="assetCriticality[]" placeholder="Enter criticality" required>
                                            </div>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label for="androidAppFollowUpWordAssetHash_0">Hash Value*</label>
                                                <input type="text" id="androidAppFollowUpWordAssetHash_0" name="assetHash[]" placeholder="Enter hash value" required>
                                            </div>
                                            <div class="form-group">
                                                <label for="androidAppFollowUpWordAssetVersion_0">Version*</label>
                                                <input type="text" id="androidAppFollowUpWordAssetVersion_0" name="assetVersion[]" placeholder="Enter version" required>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <button type="button" class="add-member-btn" id="androidAppFollowUpWordAddAssetBtn">+ Add Asset</button>
                            </div>

                            <!-- Report Prepared By -->
                            <div class="form-group">
                                <label>Report Prepared By*</label>
                                <div class="name-input">
                                    <select class="title-select" name="preparedByTitle" required>
                                        <option value="Mr.">Mr.</option>
                                        <option value="Ms.">Ms.</option>
                                        <option value="Mrs.">Mrs.</option>
                                        <option value="Dr.">Dr.</option>
                                    </select>
                                    <input type="text" placeholder="Full Name" name="preparedByName" required>
                                </div>
                            </div>

                            <!-- Auditee Details -->
                            <div class="form-group">
                                <label>Name of Auditee Organization Person*</label>
                                <div class="name-input">
                                    <select class="title-select" name="auditeeTitle" required>
                                        <option value="Mr.">Mr.</option>
                                        <option value="Ms.">Ms.</option>
                                        <option value="Mrs.">Mrs.</option>
                                        <option value="Dr.">Dr.</option>
                                    </select>
                                    <input type="text" placeholder="Full Name" name="auditeeName" required>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="androidAppFollowUpWordDesignation">Designation of the Person*</label>
                                <input type="text" id="androidAppFollowUpWordDesignation" name="designation" required>
                            </div>

                            <div class="form-group">
                                <label for="androidAppFollowUpWordBankEmail">Email ID of the Organization*</label>
                                <div id="androidAppFollowUpWordEmailContainer">
                                    <input type="email" name="bankEmail[]" placeholder="Email Address" required>
                                </div>
                                <button type="button" class="add-member-btn" id="androidAppFollowUpWordAddEmailBtn" style="margin-top: 10px;">+ Add Another Email</button>
                            </div>

                            <!-- Auditing Team -->
                            <div class="form-group">
                                <label>Details of Auditing Team* (At least 1 required, max 8)</label>
                                <div id="androidAppFollowUpWordAuditTeamContainer">
                                    <div class="team-member" data-index="0">
                                        <div class="form-row">
                                            <div class="form-group">
                                                <input type="text" name="teamName[]" placeholder="Name*" required>
                                            </div>
                                            <div class="form-group">
                                                <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                                            </div>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                                            </div>
                                            <div class="form-group">
                                                <input type="text" name="teamQualification[]" placeholder="Qualification*" required>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label>Certified (Yes/No)*</label>
                                            <div class="radio-group">
                                                <label><input type="radio" name="teamCertified[0]" value="yes" required> Yes</label>
                                                <label><input type="radio" name="teamCertified[0]" value="no"> No</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <button type="button" class="add-member-btn" id="androidAppFollowUpWordAddMemberBtn">+ Add Team Member</button>
                            </div>

                            <!-- Excel File Upload -->
                            <div class="form-group">
                                <label for="androidAppFollowUpWordExcelFile">Upload Excel File (.xlsx)*</label>
                                <input type="file" id="androidAppFollowUpWordExcelFile" name="followUpExcelFile" accept=".xlsx" required>
                                <small class="file-help" style="color: brown;">
                                    Please select an Excel file (.xlsx) generated via this tool or matching the required format.
                                    After generating the Word report, refresh the index page in Word to update page numbers.
                                </small>
                            </div>

                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('androidAppFollowUpAuditWordModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Word Report</button>
                            </div>
                            <br>
                            <small class="file-help" style="color: red; font-weight: bold;">
                                <center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>
                            </small>
                        </form>
                    </div>
                </div>
            </div>

            <!-- IOS Mobile Application Follow-Up Audit Word Report Modal -->
            <div id="iosAppFollowUpAuditWordModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>IOS Mobile Application Follow-Up Audit Word Report</h3>
                        <span class="close-modal" onclick="closeVaptModal('iosAppFollowUpAuditWordModal')">&times;</span>
                    </div>
                    <div class="modal-body scrollable-content">
                        <form id="iosAppFollowUpAuditWordForm" action="/process_ios_app_vapt_follow_up_audit_word_report" method="POST" enctype="multipart/form-data">
                            <!-- Organization Section -->
                            <div class="form-group">
                                <label for="iosAppFollowUpWordOrganization">Organization Name*</label>
                                <div class="combo-input">
                                    <select id="iosAppFollowUpWordOrganization" name="organization" required onchange="toggleVaptOtherInput('iosAppFollowUpWordOrganization', 'iosAppFollowUpWordOtherOrganization')">
                                        <option value="">Select Organization</option>
                                        <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                        <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                        <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                        <option value="Megasoft Limited">Megasoft Limited</option>
                                        <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                        <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                        <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                        <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                        <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                        <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                        <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                        <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                        <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                        <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                        <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                        <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                        <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                        <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                        <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                        <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                        <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                        <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                        <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                        <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                        <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                        <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                        <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                        <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                        <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                        <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                        <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                        <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                        <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                        <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                        <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                        <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                        <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                        <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                        <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                        <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="iosAppFollowUpWordOtherOrganization" name="otherOrganization" class="hidden" placeholder="Enter Organization Name">
                                </div>
                            </div>

                            <!-- Location Section -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="iosAppFollowUpWordCity">City*</label>
                                    <div class="combo-input">
                                        <select id="iosAppFollowUpWordCity" name="city" required onchange="toggleVaptOtherInput('iosAppFollowUpWordCity', 'iosAppFollowUpWordOtherCity')">
                                            <option value="">Select City</option>
                                            <option value="Ahmedabad">Ahmedabad</option>
                                            <option value="Mumbai">Mumbai</option>
                                            <option value="Delhi">Delhi</option>
                                            <option value="Bangalore">Bangalore</option>
                                            <option value="Chennai">Chennai</option>
                                            <option value="Kolkata">Kolkata</option>
                                            <option value="Hyderabad">Hyderabad</option>
                                            <option value="Pune">Pune</option>
                                            <option value="other">Other (Please specify)</option>
                                        </select>
                                        <input type="text" id="iosAppFollowUpWordOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="iosAppFollowUpWordState">State*</label>
                                    <select id="iosAppFollowUpWordState" name="state" required>
                                        <option value="">Select State</option>
                                        <option value="Gujarat">Gujarat</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Rajasthan">Rajasthan</option>
                                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                                        <option value="Uttarakhand">Uttarakhand</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="West Bengal">West Bengal</option>
                                        <option value="Delhi">Delhi</option>
                                    </select>
                                </div>
                            </div>

                            <!-- First Audit Report Details -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="iosAppFollowUpWordFirstAuditReportId">First Audit Report ID*</label>
                                    <input type="text" id="iosAppFollowUpWordFirstAuditReportId" name="firstAuditReportId" required>
                                </div>
                                <div class="form-group">
                                    <label for="iosAppFollowUpWordFirstAuditReportDate">First Audit Report Release Date*</label>
                                    <input type="date" id="iosAppFollowUpWordFirstAuditReportDate" name="firstAuditReportDate" required>
                                </div>
                            </div>

                            <!-- Audit Dates -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="iosAppFollowUpWordStartDate">Start Audit Date*</label>
                                    <input type="date" id="iosAppFollowUpWordStartDate" name="startDate" required>
                                </div>
                                <div class="form-group">
                                    <label for="iosAppFollowUpWordEndDate">Finish Audit Date*</label>
                                    <input type="date" id="iosAppFollowUpWordEndDate" name="endDate" required>
                                </div>
                            </div>

                            <!-- Asset Details -->
                            <div class="form-group">
                                <label>Asset Details* (At least 1 required, max 8)</label>
                                <div id="iosAppFollowUpWordAssetContainer">
                                    <div class="asset-entry" data-asset-index="0">
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label for="iosAppFollowUpWordAssetDescription_0">Asset Description*</label>
                                                <input type="text" id="iosAppFollowUpWordAssetDescription_0" name="assetDescription[]" placeholder="Enter asset description" required>
                                            </div>
                                            <div class="form-group">
                                                <label for="iosAppFollowUpWordAssetCriticality_0">Criticality of Asset*</label>
                                                <input type="text" id="iosAppFollowUpWordAssetCriticality_0" name="assetCriticality[]" placeholder="Enter criticality" required>
                                            </div>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label for="iosAppFollowUpWordAssetHash_0">Hash Value*</label>
                                                <input type="text" id="iosAppFollowUpWordAssetHash_0" name="assetHash[]" placeholder="Enter hash value" required>
                                            </div>
                                            <div class="form-group">
                                                <label for="iosAppFollowUpWordAssetVersion_0">Version*</label>
                                                <input type="text" id="iosAppFollowUpWordAssetVersion_0" name="assetVersion[]" placeholder="Enter version" required>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <button type="button" class="add-member-btn" id="iosAppFollowUpWordAddAssetBtn">+ Add Asset</button>
                            </div>

                            <!-- Report Prepared By -->
                            <div class="form-group">
                                <label>Report Prepared By*</label>
                                <div class="name-input">
                                    <select class="title-select" name="preparedByTitle" required>
                                        <option value="Mr.">Mr.</option>
                                        <option value="Ms.">Ms.</option>
                                        <option value="Mrs.">Mrs.</option>
                                        <option value="Dr.">Dr.</option>
                                    </select>
                                    <input type="text" placeholder="Full Name" name="preparedByName" required>
                                </div>
                            </div>

                            <!-- Auditee Details -->
                            <div class="form-group">
                                <label>Name of Auditee Organization Person*</label>
                                <div class="name-input">
                                    <select class="title-select" name="auditeeTitle" required>
                                        <option value="Mr.">Mr.</option>
                                        <option value="Ms.">Ms.</option>
                                        <option value="Mrs.">Mrs.</option>
                                        <option value="Dr.">Dr.</option>
                                    </select>
                                    <input type="text" placeholder="Full Name" name="auditeeName" required>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="iosAppFollowUpWordDesignation">Designation of the Person*</label>
                                <input type="text" id="iosAppFollowUpWordDesignation" name="designation" required>
                            </div>

                            <div class="form-group">
                                <label for="iosAppFollowUpWordBankEmail">Email ID of the Organization*</label>
                                <div id="iosAppFollowUpWordEmailContainer">
                                    <input type="email" name="bankEmail[]" placeholder="Email Address" required>
                                </div>
                                <button type="button" class="add-member-btn" id="iosAppFollowUpWordAddEmailBtn" style="margin-top: 10px;">+ Add Another Email</button>
                            </div>

                            <!-- Auditing Team -->
                            <div class="form-group">
                                <label>Details of Auditing Team* (At least 1 required, max 8)</label>
                                <div id="iosAppFollowUpWordAuditTeamContainer">
                                    <div class="team-member" data-index="0">
                                        <div class="form-row">
                                            <div class="form-group">
                                                <input type="text" name="teamName[]" placeholder="Name*" required>
                                            </div>
                                            <div class="form-group">
                                                <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                                            </div>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                                            </div>
                                            <div class="form-group">
                                                <input type="text" name="teamQualification[]" placeholder="Qualification*" required>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label>Certified (Yes/No)*</label>
                                            <div class="radio-group">
                                                <label><input type="radio" name="teamCertified[0]" value="yes" required> Yes</label>
                                                <label><input type="radio" name="teamCertified[0]" value="no"> No</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <button type="button" class="add-member-btn" id="iosAppFollowUpWordAddMemberBtn">+ Add Team Member</button>
                            </div>

                            <!-- Excel File Upload -->
                            <div class="form-group">
                                <label for="iosAppFollowUpWordExcelFile">Upload Excel File (.xlsx)*</label>
                                <input type="file" id="iosAppFollowUpWordExcelFile" name="followUpExcelFile" accept=".xlsx" required>
                                <small class="file-help" style="color: brown;">
                                    Please select an Excel file (.xlsx) generated via this tool or matching the required format.
                                    After generating the Word report, refresh the index page in Word to update page numbers.
                                </small>
                            </div>

                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('iosAppFollowUpAuditWordModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Word Report</button>
                            </div>
                            <br>
                            <small class="file-help" style="color: red; font-weight: bold;">
                                <center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>
                            </small>
                        </form>
                    </div>
                </div>
            </div>

            <!-- API VAPT Follow-Up Audit Word Report Modal -->
            <div id="apiFollowUpAuditWordModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>API Follow-Up Audit Word Report</h3>
                        <span class="close-modal" onclick="closeVaptModal('apiFollowUpAuditWordModal')">&times;</span>
                    </div>
                    <div class="modal-body scrollable-content">
                        <form id="apiFollowUpAuditWordForm" action="/process_api_vapt_follow_up_audit_word_report" method="POST" enctype="multipart/form-data">
                            <!-- Organization Section -->
                            <div class="form-group">
                                <label for="apiFollowUpWordOrganization">Organization Name*</label>
                                <div class="combo-input">
                                    <select id="apiFollowUpWordOrganization" name="organization" required onchange="toggleVaptOtherInput('apiFollowUpWordOrganization', 'apiFollowUpWordOtherOrganization')">
                                        <option value="">Select Organization</option>
                                        <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                        <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                        <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                        <option value="Megasoft Limited">Megasoft Limited</option>
                                        <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                        <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                        <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                        <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                        <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                        <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                        <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                        <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                        <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                        <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                        <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                        <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                        <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                        <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                        <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                        <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                        <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                        <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                        <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                        <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                        <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                        <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                        <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                        <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                        <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                        <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                        <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                        <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                        <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                        <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                        <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                        <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                        <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                        <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                        <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                        <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="apiFollowUpWordOtherOrganization" name="otherOrganization" class="hidden" placeholder="Enter Organization Name">
                                </div>
                            </div>

                            <!-- Location Section -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="apiFollowUpWordCity">City*</label>
                                    <div class="combo-input">
                                        <select id="apiFollowUpWordCity" name="city" required onchange="toggleVaptOtherInput('apiFollowUpWordCity', 'apiFollowUpWordOtherCity')">
                                            <option value="">Select City</option>
                                            <option value="Ahmedabad">Ahmedabad</option>
                                            <option value="Mumbai">Mumbai</option>
                                            <option value="Delhi">Delhi</option>
                                            <option value="Bangalore">Bangalore</option>
                                            <option value="Chennai">Chennai</option>
                                            <option value="Kolkata">Kolkata</option>
                                            <option value="Hyderabad">Hyderabad</option>
                                            <option value="Pune">Pune</option>
                                            <option value="other">Other (Please specify)</option>
                                        </select>
                                        <input type="text" id="apiFollowUpWordOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="apiFollowUpWordState">State*</label>
                                    <select id="apiFollowUpWordState" name="state" required>
                                        <option value="">Select State</option>
                                        <option value="Gujarat">Gujarat</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Rajasthan">Rajasthan</option>
                                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                                        <option value="Uttarakhand">Uttarakhand</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="West Bengal">West Bengal</option>
                                        <option value="Delhi">Delhi</option>
                                    </select>
                                </div>
                            </div>

                            <!-- First Audit Report Details -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="apiFollowUpWordFirstAuditReportId">First Audit Report ID*</label>
                                    <input type="text" id="apiFollowUpWordFirstAuditReportId" name="firstAuditReportId" required>
                                </div>
                                <div class="form-group">
                                    <label for="apiFollowUpWordFirstAuditReportDate">First Audit Report Release Date*</label>
                                    <input type="date" id="apiFollowUpWordFirstAuditReportDate" name="firstAuditReportDate" required>
                                </div>
                            </div>

                            <!-- Audit Dates -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="apiFollowUpWordStartDate">Start Audit Date*</label>
                                    <input type="date" id="apiFollowUpWordStartDate" name="startDate" required>
                                </div>
                                <div class="form-group">
                                    <label for="apiFollowUpWordEndDate">Finish Audit Date*</label>
                                    <input type="date" id="apiFollowUpWordEndDate" name="endDate" required>
                                </div>
                            </div>

                            <!-- Asset Details -->
                            <div class="form-group">
                                <label>Asset Details* (At least 1 required, max 8)</label>
                                <div id="apiFollowUpWordAssetContainer">
                                    <div class="asset-entry" data-asset-index="0">
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label for="apiFollowUpWordAssetDescription_0">Asset Description*</label>
                                                <input type="text" id="apiFollowUpWordAssetDescription_0" name="assetDescription[]" placeholder="Enter asset description" required>
                                            </div>
                                            <div class="form-group">
                                                <label for="apiFollowUpWordAssetCriticality_0">Criticality of Asset*</label>
                                                <input type="text" id="apiFollowUpWordAssetCriticality_0" name="assetCriticality[]" placeholder="Enter criticality" required>
                                            </div>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label for="apiFollowUpWordAssetUrl_0">URL*</label>
                                                <input type="text" id="apiFollowUpWordAssetUrl_0" name="assetUrl[]" placeholder="Enter URL" required>
                                            </div>
                                            <div class="form-group">
                                                <label for="apiFollowUpWordAssetHash_0">Hash Value*</label>
                                                <input type="text" id="apiFollowUpWordAssetHash_0" name="assetHash[]" placeholder="Enter hash value" required>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="apiFollowUpWordAssetVersion_0">Version*</label>
                                            <input type="text" id="apiFollowUpWordAssetVersion_0" name="assetVersion[]" placeholder="Enter version" required>
                                        </div>
                                    </div>
                                </div>
                                <button type="button" class="add-member-btn" id="apiFollowUpWordAddAssetBtn">+ Add Asset</button>
                            </div>

                            <!-- Report Prepared By -->
                            <div class="form-group">
                                <label>Report Prepared By*</label>
                                <div class="name-input">
                                    <select class="title-select" name="preparedByTitle" required>
                                        <option value="Mr.">Mr.</option>
                                        <option value="Ms.">Ms.</option>
                                        <option value="Mrs.">Mrs.</option>
                                        <option value="Dr.">Dr.</option>
                                    </select>
                                    <input type="text" placeholder="Full Name" name="preparedByName" required>
                                </div>
                            </div>

                            <!-- Auditee Details -->
                            <div class="form-group">
                                <label>Name of Auditee Organization Person*</label>
                                <div class="name-input">
                                    <select class="title-select" name="auditeeTitle" required>
                                        <option value="Mr.">Mr.</option>
                                        <option value="Ms.">Ms.</option>
                                        <option value="Mrs.">Mrs.</option>
                                        <option value="Dr.">Dr.</option>
                                    </select>
                                    <input type="text" placeholder="Full Name" name="auditeeName" required>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="apiFollowUpWordDesignation">Designation of the Person*</label>
                                <input type="text" id="apiFollowUpWordDesignation" name="designation" required>
                            </div>

                            <div class="form-group">
                                <label for="apiFollowUpWordBankEmail">Email ID of the Organization*</label>
                                <div id="apiFollowUpWordEmailContainer">
                                    <input type="email" name="bankEmail[]" placeholder="Email Address" required>
                                </div>
                                <button type="button" class="add-member-btn" id="apiFollowUpWordAddEmailBtn" style="margin-top: 10px;">+ Add Another Email</button>
                            </div>

                            <!-- Auditing Team -->
                            <div class="form-group">
                                <label>Details of Auditing Team* (At least 1 required, max 8)</label>
                                <div id="apiFollowUpWordAuditTeamContainer">
                                    <div class="team-member" data-index="0">
                                        <div class="form-row">
                                            <div class="form-group">
                                                <input type="text" name="teamName[]" placeholder="Name*" required>
                                            </div>
                                            <div class="form-group">
                                                <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                                            </div>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                                            </div>
                                            <div class="form-group">
                                                <input type="text" name="teamQualification[]" placeholder="Qualification*" required>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label>Certified (Yes/No)*</label>
                                            <div class="radio-group">
                                                <label><input type="radio" name="teamCertified[0]" value="yes" required> Yes</label>
                                                <label><input type="radio" name="teamCertified[0]" value="no"> No</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <button type="button" class="add-member-btn" id="apiFollowUpWordAddMemberBtn">+ Add Team Member</button>
                            </div>

                            <!-- Excel File Upload -->
                            <div class="form-group">
                                <label for="apiFollowUpWordExcelFile">Upload Excel File (.xlsx)*</label>
                                <input type="file" id="apiFollowUpWordExcelFile" name="followUpExcelFile" accept=".xlsx" required>
                                <small class="file-help" style="color: brown;">
                                    Please select an Excel file (.xlsx) generated via this tool or matching the required format.
                                    After generating the Word report, refresh the index page in Word to update page numbers.
                                </small>
                            </div>

                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('apiFollowUpAuditWordModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Word Report</button>
                            </div>
                            <br>
                            <small class="file-help" style="color: red; font-weight: bold;">
                                <center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>
                            </small>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Website VAPT Follow-Up Audit Word Report Modal -->
            <div id="websiteVaptFollowUpAuditWordModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Website Follow-Up Audit Word Report</h3>
                        <span class="close-modal" onclick="closeVaptModal('websiteVaptFollowUpAuditWordModal')">&times;</span>
                    </div>
                    <div class="modal-body">
                        <form id="websiteVaptFollowUpAuditWordForm" action="/process_website_vapt_follow_up_audit_word_report" method="POST" enctype="multipart/form-data">
                            <div class="form-group">
                                <label for="websiteVaptFollowUpWordExcelFile">Upload Excel File (.xlsx)*</label>
                                <input type="file" id="websiteVaptFollowUpWordExcelFile" name="websiteFollowUpExcelFile" accept=".xlsx" required>
                                <small class="file-help" style="color: brown;">Please select an Excel file (.xlsx) to generate the Word report. The Excel file should be generated through the "Website Follow-up Audit Report Excel" tool and must contain a "Website_VAPT" worksheet with the required columns including Status, Old POC, and POC columns.
                                   <br> <br>After generating the Word report, you must manually update the index page numbers by refreshing the table.
                                </small>
                                <br>
                                <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>  
                                </small>
                            </div>
                             
                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('websiteVaptFollowUpAuditWordModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Word Report</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Website VAPT First Audit Word Report Modal -->
            <div id="websiteVaptFirstAuditWordModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Website First Audit Word Report</h3>
                        <span class="close-modal" onclick="closeVaptModal('websiteVaptFirstAuditWordModal')">&times;</span>
                    </div>
                    <div class="modal-body">
                        <form id="websiteVaptFirstAuditWordForm" action="/process_website_vapt_first_audit_word_report" method="POST" enctype="multipart/form-data">
                            <div class="form-group">
                                <label for="websiteVaptWordExcelFile">Upload Excel File (.xlsx)*</label>
                                <input type="file" id="websiteVaptWordExcelFile" name="excelFile" accept=".xlsx" required>
                                <small class="file-help" style="color: brown;">Please select an Excel file (.xlsx) to generate the Word report. If the Excel file is generated through this tool, it will work correctly. However, if you create it manually, you must follow the proper format. The Excel file should contain a "Website_VAPT" worksheet with the required columns. If the Excel file is not prepared according to these guidelines, the Word report may not be generated properly or may contain multiple issues.
                                   <br> <br>After generating the Word report, you must manually update the index page numbers by refreshing the table.
                                </small>
                                <br>
                                <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>  
                                </small>
                            </div>
                             
                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('websiteVaptFirstAuditWordModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Word Report</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Public IP First Audit Word Modal -->
            <div id="publicIpFirstAuditWordModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Public IP First Audit Word Report</h3>
                        <span class="close-modal" onclick="closeVaptModal('publicIpFirstAuditWordModal')">&times;</span>
                    </div>
                    <div class="modal-body">
                        <form id="publicIpFirstAuditWordForm" action="/process_public_ip_vapt_first_audit_word_report" method="POST" enctype="multipart/form-data">
                            <div class="form-group">
                                <label for="publicIpWordExcelFile">Upload Excel File (.xlsx)*</label>
                                <input type="file" id="publicIpWordExcelFile" name="excelFile" accept=".xlsx" required>
                                <small class="file-help" style="color: brown;">Please select an Excel file (.xlsx) to generate the Word report. If the Excel file is generated through this tool, it will work correctly. However, if you create it manually, you must follow the proper format. The Excel file should contain a "Public_IP_VAPT" worksheet with the required columns. If the Excel file is not prepared according to these guidelines, the Word report may not be generated properly or may contain multiple issues.
                                   <br> <br>After generating the Word report, you must manually update the index page numbers by refreshing the table.
                                </small>
                                <br>
                                <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>  
                                </small>
                            </div>
                             
                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('publicIpFirstAuditWordModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Word Report</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- VAPT Follow-up Audit Modal -->
            <div id="vaptFollowUpAuditModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Infrastructure VAPT Follow Up Audit Details</h3>
                        <span class="close-modal" onclick="closeVaptModal('vaptFollowUpAuditModal')">&times;</span>
                    </div>
                    <div class="modal-body scrollable-content">
                        <form id="vaptFollowUpAuditForm" action="/process_vapt_follow_up_audit_report" method="POST" enctype="multipart/form-data">
                            <!-- Organization Section -->
                            <div class="form-group">
                                <label for="vaptFollowUpOrganization">Organization Name*</label>
                                <div class="combo-input">
                                    <select id="vaptFollowUpOrganization" name="organization" required onchange="toggleVaptOtherInput('vaptFollowUpOrganization', 'vaptFollowUpOtherOrganization')">
                                        <option value="">Select Organization</option>
                                        <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                        <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                        <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                        <option value="Megasoft Limited">Megasoft Limited</option>
                                        <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                        <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                        <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                        <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                        <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                        <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                        <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                        <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                        <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                        <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                        <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                        <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                        <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                        <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                        <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                        <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                        <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                        <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                        <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                        <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                        <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                        <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                        <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                        <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                        <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                        <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                        <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                        <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                        <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                        <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                        <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                        <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                        <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                        <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                        <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                        <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                        
            
                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="vaptFollowUpOtherOrganization" name="otherOrganization" class="hidden" placeholder="Enter Organization Name">
                                </div>
                            </div>

                            <!-- Location Section -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="vaptFollowUpCity">City*</label>
                                    <div class="combo-input">
                                        <select id="vaptFollowUpCity" name="city" required onchange="toggleVaptOtherInput('vaptFollowUpCity', 'vaptFollowUpOtherCity')">
                                            <option value="">Select City</option>
                                            <option value="Ahmedabad">Ahmedabad</option>
                                            <option value="Amreli">Amreli</option>
                                            <option value="Anand">Anand</option>
                                            <option value="Aravalli">Aravalli</option>
                                            <option value="Banaskantha">Banaskantha</option>
                                            <option value="Bharuch">Bharuch</option>
                                            <option value="Bhavnagar">Bhavnagar</option>
                                            <option value="Botad">Botad</option>
                                            <option value="Chhota Udaipur">Chhota Udaipur</option>
                                            <option value="Dahod">Dahod</option>
                                            <option value="Dang">Dang</option>
                                            <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                            <option value="Gandhinagar">Gandhinagar</option>
                                            <option value="Gir Somnath">Gir Somnath</option>
                                            <option value="Jamnagar">Jamnagar</option>
                                            <option value="Junagadh">Junagadh</option>
                                            <option value="Kheda">Kheda</option>
                                            <option value="Kutch">Kutch</option>
                                            <option value="Mahisagar">Mahisagar</option>
                                            <option value="Mehsana">Mehsana</option>
                                            <option value="Morbi">Morbi</option>
                                            <option value="Narmada">Narmada</option>
                                            <option value="Navsari">Navsari</option>
                                            <option value="Patan">Patan</option>
                                            <option value="Panchmahal">Panchmahal</option>
                                            <option value="Porbandar">Porbandar</option>
                                            <option value="Rajkot">Rajkot</option>
                                            <option value="Sabarkantha">Sabarkantha</option>
                                            <option value="Surat">Surat</option>
                                            <option value="Surendranagar">Surendranagar</option>
                                            <option value="Tapi">Tapi</option>
                                            <option value="Vadodara">Vadodara</option>
                                            <option value="Valsad">Valsad</option>
                
                                            <!-- Rajasthan -->
                                            <option value="Ajmer">Ajmer</option>
                                            <option value="Alwar">Alwar</option>
                                            <option value="Banswara">Banswara</option>
                                            <option value="Baran">Baran</option>
                                            <option value="Barmer">Barmer</option>
                                            <option value="Bharatpur">Bharatpur</option>
                                            <option value="Bhilwara">Bhilwara</option>
                                            <option value="Bikaner">Bikaner</option>
                                            <option value="Bundi">Bundi</option>
                                            <option value="Chittorgarh">Chittorgarh</option>
                                            <option value="Churu">Churu</option>
                                            <option value="Dausa">Dausa</option>
                                            <option value="Dholpur">Dholpur</option>
                                            <option value="Dungarpur">Dungarpur</option>
                                            <option value="Hanumangarh">Hanumangarh</option>
                                            <option value="Jaipur">Jaipur</option>
                                            <option value="Jaisalmer">Jaisalmer</option>
                                            <option value="Jalore">Jalore</option>
                                            <option value="Jhalawar">Jhalawar</option>
                                            <option value="Jhunjhunu">Jhunjhunu</option>
                                            <option value="Jodhpur">Jodhpur</option>
                                            <option value="Karauli">Karauli</option>
                                            <option value="Kota">Kota</option>
                                            <option value="Nagaur">Nagaur</option>
                                            <option value="Pali">Pali</option>
                                            <option value="Pratapgarh">Pratapgarh</option>
                                            <option value="Rajsamand">Rajsamand</option>
                                            <option value="Sikar">Sikar</option>
                                            <option value="Sirohi">Sirohi</option>
                                            <option value="Sri Ganganagar">Sri Ganganagar</option>
                                            <option value="Tonk">Tonk</option>
                                            <option value="Udaipur">Udaipur</option>
                
                                            <!-- Maharashtra -->
                                            <option value="Ahmednagar">Ahmednagar</option>
                                            <option value="Akola">Akola</option>
                                            <option value="Amravati">Amravati</option>
                                            <option value="Aurangabad">Aurangabad</option>
                                            <option value="Beed">Beed</option>
                                            <option value="Bhandara">Bhandara</option>
                                            <option value="Chandrapur">Chandrapur</option>
                                            <option value="Dhule">Dhule</option>
                                            <option value="Gadchiroli">Gadchiroli</option>
                                            <option value="Gondia">Gondia</option>
                                            <option value="Hingoli">Hingoli</option>
                                            <option value="Jalgaon">Jalgaon</option>
                                            <option value="Jalna">Jalna</option>
                                            <option value="Kolhapur">Kolhapur</option>
                                            <option value="Latur">Latur</option>
                                            <option value="Mumbai City">Mumbai City</option>
                                            <option value="Mumbai Suburban">Mumbai Suburban</option>
                                            <option value="Nagpur">Nagpur</option>
                                            <option value="Nanded">Nanded</option>
                                            <option value="Nandurbar">Nandurbar</option>
                                            <option value="Nashik">Nashik</option>
                                            <option value="Osmanabad">Osmanabad</option>
                                            <option value="Palghar">Palghar</option>
                                            <option value="Parbhani">Parbhani</option>
                                            <option value="Pune">Pune</option>
                                            <option value="Raigad">Raigad</option>
                                            <option value="Ratnagiri">Ratnagiri</option>
                                            <option value="Sangli">Sangli</option>
                                            <option value="Satara">Satara</option>
                                            <option value="Sindhudurg">Sindhudurg</option>
                                            <option value="Solapur">Solapur</option>
                                            <option value="Thane">Thane</option>
                                            <option value="Wardha">Wardha</option>
                                            <option value="Washim">Washim</option>
                                            <option value="Yavatmal">Yavatmal</option>
                
                                            <!-- Uttar Pradesh -->
                                            <option value="Agra">Agra</option>
                                            <option value="Aligarh">Aligarh</option>
                                            <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                            <option value="Amethi">Amethi</option>
                                            <option value="Amroha">Amroha</option>
                                            <option value="Auraiya">Auraiya</option>
                                            <option value="Ayodhya">Ayodhya</option>
                                            <option value="Azamgarh">Azamgarh</option>
                                            <option value="Bagpat">Bagpat</option>
                                            <option value="Bahraich">Bahraich</option>
                                            <option value="Ballia">Ballia</option>
                                            <option value="Balrampur">Balrampur</option>
                                            <option value="Banda">Banda</option>
                                            <option value="Barabanki">Barabanki</option>
                                            <option value="Bareilly">Bareilly</option>
                                            <option value="Basti">Basti</option>
                                            <option value="Bhadohi">Bhadohi</option>
                                            <option value="Bijnor">Bijnor</option>
                                            <option value="Bulandshahr">Bulandshahr</option>
                                            <option value="Chandauli">Chandauli</option>
                                            <option value="Chitrakoot">Chitrakoot</option>
                                            <option value="Deoria">Deoria</option>
                                            <option value="Etah">Etah</option>
                                            <option value="Etawah">Etawah</option>
                                            <option value="Farrukhabad">Farrukhabad</option>
                                            <option value="Fatehpur">Fatehpur</option>
                                            <option value="Firozabad">Firozabad</option>
                                            <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                            <option value="Ghaziabad">Ghaziabad</option>
                                            <option value="Ghazipur">Ghazipur</option>
                                            <option value="Gonda">Gonda</option>
                                            <option value="Gorakhpur">Gorakhpur</option>
                                            <option value="Hamirpur">Hamirpur</option>
                                            <option value="Hapur">Hapur</option>
                                            <option value="Hardoi">Hardoi</option>
                                            <option value="Hathras">Hathras</option>
                                            <option value="Jalaun">Jalaun</option>
                                            <option value="Jaunpur">Jaunpur</option>
                                            <option value="Jhansi">Jhansi</option>
                                            <option value="Kannauj">Kannauj</option>
                                            <option value="Kanpur Dehat">Kanpur Dehat</option>
                                            <option value="Kanpur Nagar">Kanpur Nagar</option>
                                            <option value="Kasganj">Kasganj</option>
                                            <option value="Kaushambi">Kaushambi</option>
                                            <option value="Kushinagar">Kushinagar</option>
                                            <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                            <option value="Lalitpur">Lalitpur</option>
                                            <option value="Lucknow">Lucknow</option>
                                            <option value="Maharajganj">Maharajganj</option>
                                            <option value="Mahoba">Mahoba</option>
                                            <option value="Mainpuri">Mainpuri</option>
                                            <option value="Mathura">Mathura</option>
                                            <option value="Mau">Mau</option>
                                            <option value="Meerut">Meerut</option>
                                            <option value="Mirzapur">Mirzapur</option>
                                            <option value="Moradabad">Moradabad</option>
                                            <option value="Muzaffarnagar">Muzaffarnagar</option>
                                            <option value="Pilibhit">Pilibhit</option>
                                            <option value="Pratapgarh">Pratapgarh</option>
                                            <option value="Rae Bareli">Rae Bareli</option>
                                            <option value="Rampur">Rampur</option>
                                            <option value="Saharanpur">Saharanpur</option>
                                            <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                            <option value="Shahjahanpur">Shahjahanpur</option>
                                            <option value="Shravasti">Shravasti</option>
                                            <option value="Siddharthnagar">Siddharthnagar</option>
                                            <option value="Sitapur">Sitapur</option>
                                            <option value="Sonbhadra">Sonbhadra</option>
                                            <option value="Sultanpur">Sultanpur</option>
                                            <option value="Unnao">Unnao</option>
                                            <option value="Varanasi">Varanasi</option>
                
                                            <!-- Uttarakhand -->
                                            <option value="Almora">Almora</option>
                                            <option value="Bageshwar">Bageshwar</option>
                                            <option value="Chamoli">Chamoli</option>
                                            <option value="Champawat">Champawat</option>
                                            <option value="Dehradun">Dehradun</option>
                                            <option value="Haridwar">Haridwar</option>
                                            <option value="Nainital">Nainital</option>
                                            <option value="Pauri Garhwal">Pauri Garhwal</option>
                                            <option value="Pithoragarh">Pithoragarh</option>
                                            <option value="Rudraprayag">Rudraprayag</option>
                                            <option value="Tehri Garhwal">Tehri Garhwal</option>
                                            <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                            <option value="Uttarkashi">Uttarkashi</option>
                                                            <option value="other">Other (Please specify)</option>
                                        </select>
                                        <input type="text" id="vaptFollowUpOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="vaptFollowUpState">State*</label>
                                    <select id="vaptFollowUpState" name="state" required>
                                        <option value="">Select State</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                        <option value="Assam">Assam</option>
                                        <option value="Bihar">Bihar</option>
                                        <option value="Chhattisgarh">Chhattisgarh</option>
                                        <option value="Goa">Goa</option>
                                        <option value="Gujarat">Gujarat</option>
                                        <option value="Haryana">Haryana</option>
                                        <option value="Himachal Pradesh">Himachal Pradesh</option>
                                        <option value="Jharkhand">Jharkhand</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Kerala">Kerala</option>
                                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Manipur">Manipur</option>
                                        <option value="Meghalaya">Meghalaya</option>
                                        <option value="Mizoram">Mizoram</option>
                                        <option value="Nagaland">Nagaland</option>
                                        <option value="Odisha">Odisha</option>
                                        <option value="Punjab">Punjab</option>
                                        <option value="Rajasthan">Rajasthan</option>
                                        <option value="Sikkim">Sikkim</option>
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="Telangana">Telangana</option>
                                        <option value="Tripura">Tripura</option>
                                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                                        <option value="Uttarakhand">Uttarakhand</option>
                                        <option value="West Bengal">West Bengal</option>
                                        <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                        <option value="Chandigarh">Chandigarh</option>
                                        <option value="Dadra and Nagar Haveli and Daman and Diu">Dadra and Nagar Haveli and Daman and Diu</option>
                                        <option value="Delhi">Delhi</option>
                                        <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                                        <option value="Ladakh">Ladakh</option>
                                        <option value="Lakshadweep">Lakshadweep</option>
                                        <option value="Puducherry">Puducherry</option>
                                        
                                    </select>
                                </div>
                            </div>

                            <!-- First Audit Report Details -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="vaptFollowUpFirstAuditReportId">First Audit Report ID*</label>
                                    <input type="text" id="vaptFollowUpFirstAuditReportId" name="firstAuditReportId" placeholder="Enter First Audit Report ID" required>
                                </div>
                                <div class="form-group">
                                    <label for="vaptFollowUpFirstAuditReportDate">First Audit Report Release Date*</label>
                                    <input type="date" id="vaptFollowUpFirstAuditReportDate" name="firstAuditReportDate" required>
                                </div>
                            </div>

                            <!-- Audit Dates -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="vaptFollowUpStartDate">Start Audit Date*</label>
                                    <input type="date" id="vaptFollowUpStartDate" name="startDate" required>
                                </div>
                                <div class="form-group">
                                    <label for="vaptFollowUpEndDate">Finish Audit Date*</label>
                                    <input type="date" id="vaptFollowUpEndDate" name="endDate" required>
                                </div>
                            </div>

                            <!-- Report Prepared By -->
                            <div class="form-group">
                                <label>Report Prepared By*</label>
                                <div class="name-input">
                                    <select class="title-select" name="preparedByTitle" required>
                                        <option value="Mr.">Mr.</option>
                                        <option value="Ms.">Ms.</option>
                                        <option value="Mrs.">Mrs.</option>
                                        <option value="Dr.">Dr.</option>
                                    </select>
                                    <input type="text" placeholder="Full Name" name="preparedByName" required>
                                </div>
                            </div>

                            <!-- Auditee Details -->
                            <div class="form-group">
                                <label>Name of Auditee Organization Person*</label>
                                <div class="name-input">
                                    <select class="title-select" name="auditeeTitle" required>
                                        <option value="Mr.">Mr.</option>
                                        <option value="Ms.">Ms.</option>
                                        <option value="Mrs.">Mrs.</option>
                                        <option value="Dr.">Dr.</option>
                                    </select>
                                    <input type="text" placeholder="Full Name" name="auditeeName" required>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="vaptFollowUpDesignation">Designation of the Person*</label>
                                <input type="text" id="vaptFollowUpDesignation" name="designation" required>
                            </div>

                            <div class="form-group">
                                <label for="vaptFollowUpBankEmail">Email ID of the Bank*</label>
                                <div id="vaptFollowUpEmailContainer">
                                    <input type="email" name="bankEmail[]" placeholder="Email Address" required>
                                </div>
                                <button type="button" class="add-member-btn" id="vaptAddFollowUpEmailBtn" style="margin-top: 10px;">+ Add Another Email</button>
                            </div>

                            <!-- Auditing Team -->
                            <div class="form-group">
                                <label>Details of Auditing Team* (At least 1 required, max 8)</label>
                                <div id="vaptFollowUpAuditTeamContainer">
                                    <div class="team-member" data-index="0">
                                        <div class="form-row">
                                            <div class="form-group">
                                                <input type="text" name="teamName[]" placeholder="Name*" required>
                                            </div>
                                            <div class="form-group">
                                                <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                                            </div>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                                            </div>
                                            <div class="form-group">
                                                <input type="text" name="teamQualification[]" placeholder="Qualification/Certification*" required>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label>Certified (Yes/No)*</label>
                                            <div class="radio-group">
                                                <label><input type="radio" name="teamCertified[0]" value="yes" required> Yes</label>
                                                <label><input type="radio" name="teamCertified[0]" value="no"> No</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <button type="button" class="add-member-btn" id="vaptAddFollowUpMemberBtn">+ Add Team Member</button>
                            </div>

                            <!-- Old Excel File Upload -->
                            <div class="form-group">
                                <label for="vaptFollowUpOldExcelFile">Old Excel File (First Audit)*</label>
                                <input type="file" id="vaptFollowUpOldExcelFile" name="userExcelFile" accept=".xlsx" required>
                                <small class="file-help" style="color: brown;">Upload the Excel file from the First Audit to carry forward resolved vulnerabilities and their evidence.</small>
                            </div>


                            <!-- File Uploads -->
                            <div class="form-group">
                                <label>File Uploads*</label>
                                
                                <div class="file-upload-group">
                                    <label for="vaptFollowUpNmapFiles">Nmap Zip Files</label>
                                    <input type="file" id="vaptFollowUpNmapFiles" name="nmapFiles" accept=".zip" required>
                                    <small class="file-help" style="color: brown;">All Nmap files must be placed directly in the ZIP file (no nested folders) and must be in CSV format.</small>
                                </div>
                                
                                <div class="file-upload-group">
                                    <label for="vaptFollowUpNessusFiles">Nessus Zip Files</label>
                                    <input type="file" id="vaptFollowUpNessusFiles" name="nessusFiles" accept=".zip" required>
                                    <small class="file-help" style="color: brown;">All Nessus files must be placed directly inside a single ZIP file with no nested folders.</small>
                                </div>
                                
                                <div class="file-upload-group">
                                    <label for="vaptFollowUpEvidenceFiles">New Evidences Zip Files</label>
                                    <input type="file" id="vaptFollowUpEvidenceFiles" name="evidenceFiles" accept=".zip" required>
                                    <small class="file-help" style="color: brown;">Upload new evidence for current follow-up audit vulnerabilities.</small>
                                </div>
                            </div>

                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('vaptFollowUpAuditModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Submit Report</button>
                            </div>
                            <br>
                            <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>  
                            </small>
                        </form>
                    </div>
                </div>
            </div>

            <!-- VAPT Follow-up Audit Word Report Modal -->
            <div id="vaptFollowUpAuditWordModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Follow Up Audit Word Report</h3>
                        <span class="close-modal" onclick="closeVaptModal('vaptFollowUpAuditWordModal')">&times;</span>
                    </div>
                    <div class="modal-body">
                        <form id="vaptFollowUpAuditWordForm" action="/process_vapt_follow_up_audit_word_report" method="POST" enctype="multipart/form-data">
                            <div class="form-group">
                                <label for="vaptFollowUpWordExcelFile">Upload Excel File (.xlsx)*</label>
                                <input type="file" id="vaptFollowUpWordExcelFile" name="followUpExcelFile" accept=".xlsx" required>
                                <small class="file-help" style="color: brown;">Please select an Excel file (.xlsx) to generate the Word report. If the Excel file is generated through this tool, it will work correctly. However, if you create it manually, you must follow the proper format. To download the example format, <a href="static\Formats_and_Catalog\Sample_Files\Infrastructure_VAPT_First_Audit_Sample_Excel.xlsx" download>click here.</a> If the Excel file is not prepared according to these guidelines, the Word report may not be generated properly or may contain multiple issues.
                                   <br> <br>After generating the Word report, you must manually update the index page numbers by refreshing the table.
                                </small>
                                <br>
                                <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>  
                                </small>
                            </div>
                             
                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('vaptFollowUpAuditWordModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Word Report</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- First Audit MetaData Modal -->
            <div id="vaptFirstAuditMetaDataModal" class="modal">
                <div class="modal-content" style="max-width: 1000px;">
                    <div class="modal-header">
                        <h3>First Audit MetaData</h3>
                        <span class="close-modal" onclick="closeVaptModal('vaptFirstAuditMetaDataModal')">&times;</span>
                    </div>
                    <div class="modal-body scrollable-content">
                        <form id="vaptFirstAuditMetaDataForm" method="POST" onsubmit="handleVaptFirstAuditMetaDataSubmit(event)">
                            
                            <!-- Audit Dates -->
                            <div class="form-group">
                                <label for="vaptMetaStartDate" class="form-label">Start Audit Date*</label>
                                <input type="date" id="vaptMetaStartDate" name="startAuditDate" class="form-input" required>
                            </div>

                            <div class="form-group">
                                <label for="vaptMetaEndDate" class="form-label">End Audit Date*</label>
                                <input type="date" id="vaptMetaEndDate" name="endAuditDate" class="form-input" required>
                            </div>

                            <!-- Name of Auditee organization -->
                            <div class="form-group">
                                <label for="vaptMetaAuditeeOrg" class="form-label">Name of Auditee Organization*</label>
                                <select id="vaptMetaAuditeeOrg" name="nameOfAuditeeOrg" class="form-input" required onchange="toggleVaptOtherField('vaptMetaAuditeeOrg', 'vaptMetaAuditeeOrgOther')">
                                    <option value="">Select Organization</option>
                                    <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                    <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                    <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                    <option value="Megasoft Limited">Megasoft Limited</option>
                                    <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                    <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                    <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                    <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                    <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                    <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                    <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                    <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                    <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                    <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                    <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                    <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                    <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                    <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                    <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                    <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                    <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                    <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                    <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                    <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                    <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                    <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                    <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                    <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                    <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                    <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                    <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                    <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                    <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                    <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                    <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                    <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                    <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                    <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                    <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                    <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                    
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="vaptMetaAuditeeOrgOther" name="nameOfAuditeeOrgOther" class="form-input" placeholder="Specify organization name" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Category of Organization -->
                            <div class="form-group">
                                <label for="vaptMetaCategoryOrg" class="form-label">Category of Organization*</label>
                                <select id="vaptMetaCategoryOrg" name="categoryOfOrg" class="form-input" required>
                                    <option value="">Select Category</option>
                                    <option value="Central Ministry/Department">Central Ministry/Department</option>
                                    <option value="Organization under Government Department">Organization under Government Department</option>
                                    <option value="Private Sector" selected>Private Sector</option>
                                    <option value="Public sector organisations">Public sector organisations</option>
                                    <option value="State Government Department">State Government Department</option>
                                </select>
                            </div>

                            <!-- Sector of Organization -->
                            <div class="form-group">
                                <label for="vaptMetaSectorOrg" class="form-label">Sector of Organization*</label>
                                <select id="vaptMetaSectorOrg" name="sectorOfOrg" class="form-input" required onchange="updateVaptSubSectorOptions()">
                                    <option value="">Select Sector</option>
                                    <option value="Agriculture">Agriculture</option>
                                    <option value="Defence">Defence</option>
                                    <option value="Education">Education</option>
                                    <option value="Energy">Energy</option>
                                    <option value="Finance" selected>Finance</option>
                                    <option value="Healthcare">Healthcare</option>
                                    <option value="Information_and_Broadcasting">Information and Broadcasting</option>
                                    <option value="Information_and_Communication_Technology">Information and Communication Technology</option>
                                    <option value="Law_Enforcement_and_Security">Law Enforcement and Security</option>
                                    <option value="Public_Essential_Services_and_Utilities">Public Essential Services and Utilities</option>
                                    <option value="Space">Space</option>
                                    <option value="Transportation">Transportation</option>
                                </select>
                            </div>

                            <!-- Sub Sector -->
                            <div class="form-group">
                                <label for="vaptMetaSubSector" class="form-label">Sub Sector*</label>
                                <select id="vaptMetaSubSector" name="subSector" class="form-input" required>
                                    <option value="">Select Sector First</option>
                                </select>
                            </div>

                            <!-- Type of audit -->
                            <div class="form-group">
                                <label for="vaptMetaTypeAudit" class="form-label">Type of Audit*</label>
                                <select id="vaptMetaTypeAudit" name="typeOfAudit" class="form-input" required onchange="toggleVaptOtherField('vaptMetaTypeAudit', 'vaptMetaTypeAuditOther')">
                                    <option value="">Select Type</option>
                                    <option value="API Security Audit">API Security Audit</option>
                                    <option value="Cloud Security Audit">Cloud Security Audit</option>
                                    <option value="Compliance to Standard/Framework/Policies Related Audit">Compliance to Standard/Framework/Policies Related Audit</option>
                                    <option value="Digital Forensic Readiness Assessment">Digital Forensic Readiness Assessment</option>
                                    <option value="Industrial Control Systems (ICS) / SCADA Audit">Industrial Control Systems (ICS) / SCADA Audit</option>
                                    <option value="IoT Security Assessment">IoT Security Assessment</option>
                                    <option value="Mobile Application Audit">Mobile Application Audit</option>
                                    <option value="Network Infrastructure Audits">Network Infrastructure Audits</option>
                                    <option value="Process Audit">Process Audit</option>
                                    <option value="Red Team Assessment">Red Team Assessment</option>
                                    <option value="Source Code Review">Source Code Review</option>
                                    <option value="VAPT-Infrastructure" selected>VAPT-Infrastructure</option>
                                    <option value="VAPT-Application">VAPT-Application</option>
                                    <option value="Website /Web Application Audit">Website /Web Application Audit</option>
                                    <option value="Wireless security audit">Wireless security audit</option>
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="vaptMetaTypeAuditOther" name="typeOfAuditOther" class="form-input" placeholder="Please specify type of audit" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Details of website/application/infrastructure -->
                            <div class="form-group">
                                <label for="vaptMetaDetails" class="form-label">Details of web site/name of application/no. of servers, perimeter devices, other infrastructure*</label>
                                <textarea id="vaptMetaDetails" name="detailsOfWebsite" class="form-input" placeholder="Enter details" required rows="3"></textarea>
                            </div>

                            <!-- Reason for conducting Audit -->
                            <div class="form-group">
                                <label for="vaptMetaReason" class="form-label">Reason for conducting Audit*</label>
                                <select id="vaptMetaReason" name="reasonForAudit" class="form-input" required>
                                    <option value="">Select Reason</option>
                                    <option value="Certificate of compliance like ISO 27001">Certificate of compliance like ISO 27001</option>
                                    <option value="Certificate of safe hosting">Certificate of safe hosting</option>
                                    <option value="Change in process or infrastructure">Change in process or infrastructure</option>
                                    <option value="Government directions">Government directions</option>
                                    <option value="Incident/ Breach in Organisation">Incident/ Breach in Organisation</option>
                                    <option value="Incident/ Breach in Sector">Incident/ Breach in Sector</option>
                                    <option value="New application/ Infrastructure">New application/ Infrastructure</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Periodic Audit as per Policy of organisation.">Periodic Audit as per Policy of organisation.</option>
                                    <option value="Regulatory directions" selected>Regulatory directions</option>
                                    <option value="Third Party Initiated">Third Party Initiated</option>
                                </select>
                            </div>

                            <!-- Standards Used for conducting Audit -->
                            <div class="form-group">
                                <label for="vaptMetaStandards" class="form-label">Standards Used for conducting Audit*</label>
                                <input type="text" id="vaptMetaStandards" name="standardsUsed" class="form-input" placeholder="Enter standards" required>
                            </div>

                            <!-- Challenges in conducting Audits -->
                            <div class="form-group">
                                <label for="vaptMetaChallenges" class="form-label">Challenges in conducting Audits*</label>
                                <textarea id="vaptMetaChallenges" name="challenges" class="form-input" placeholder="Enter challenges" required rows="3"></textarea>
                            </div>

                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Compliance Questions</h4>
                            </div>

                            <!-- Compliance questions -->
                            <div class="form-group">
                                <label for="vaptMetaCompFinancial" class="form-label">Compliance to financial sector regulatory bodies guidelines/circulars/directions like from RBI, IRDAI, SEBI, NPCI*</label>
                                <select id="vaptMetaCompFinancial" name="complianceFinancial" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="vaptMetaCompRegulatory" class="form-label">Compliance to regulatory bodies guidelines/circulars/directions like from UIDAI, CCA, DoT, TRAI*</label>
                                <select id="vaptMetaCompRegulatory" name="complianceRegulatory" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="vaptMetaCompCertIn" class="form-label">Compliance to CERT-In directions under sub-section (6) of section 70B of the IT Act, 2000 dated 28 April, 2022*</label>
                                <select id="vaptMetaCompCertIn" name="complianceCertIn" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="vaptMetaCompCEA" class="form-label">Compliance to CEA (Cyber Security in Power Sector) guidelines 2021*</label>
                                <select id="vaptMetaCompCEA" name="complianceCEA" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="vaptMetaCompOther" class="form-label">Any other domestic regulation, directions, guidelines (Please Specify)*</label>
                                <select id="vaptMetaCompOther" name="complianceOther" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No" selected>No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <!-- Type of Audit Report -->
                            <div class="form-group">
                                <label for="vaptMetaTypeReport" class="form-label">Type of Audit Report*</label>
                                <select id="vaptMetaTypeReport" name="typeOfAuditReport" class="form-input" required>
                                    <option value="">Select Type</option>
                                    <option value="First Audit Report" selected>First Audit Report</option>
                                    <option value="Follow up Audit Report">Follow up Audit Report</option>
                                </select>
                            </div>

                            <!-- No. of vulnerabilities -->
                            <div class="form-group">
                                <label for="vaptMetaNumVuln" class="form-label">No. of vulnerabilities/ security issues reported during FIRST Audit*</label>
                                <input type="number" id="vaptMetaNumVuln" name="numVulnerabilities" class="form-input" placeholder="Enter number" min="0" required>
                            </div>

                            <!-- No. of days taken to patch -->
                            <div class="form-group">
                                <label for="vaptMetaDaysPatch" class="form-label">No. of days taken by Client to patch the vulnerabilities after submission of Audit report*</label>
                                <select id="vaptMetaDaysPatch" name="numDaysToPatch" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Follow up audit not performed" selected>Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- Duration between audits -->
                            <div class="form-group">
                                <label for="vaptMetaDuration" class="form-label">Durations (in days) between end of FIRST audit and start of FOLLOW-UP/SECOND audit*</label>
                                <select id="vaptMetaDuration" name="durationBetweenAudits" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed" selected>Follow up audit not performed</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- No. of open issues -->
                            <div class="form-group">
                                <label for="vaptMetaOpenIssues" class="form-label">No. of open issues after follow-up audits*</label>
                                <select id="vaptMetaOpenIssues" name="numOpenIssues" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed" selected>Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="0">0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="101">101</option>
                                    <option value="102">102</option>
                                    <option value="103">103</option>
                                    <option value="104">104</option>
                                    <option value="105">105</option>
                                    <option value="106">106</option>
                                    <option value="107">107</option>
                                    <option value="108">108</option>
                                    <option value="109">109</option>
                                    <option value="110">110</option>
                                    <option value="111">111</option>
                                    <option value="112">112</option>
                                    <option value="113">113</option>
                                    <option value="114">114</option>
                                    <option value="115">115</option>
                                    <option value="116">116</option>
                                    <option value="117">117</option>
                                    <option value="118">118</option>
                                    <option value="119">119</option>
                                    <option value="120">120</option>
                                    <option value="121">121</option>
                                    <option value="122">122</option>
                                    <option value="123">123</option>
                                    <option value="124">124</option>
                                    <option value="125">125</option>
                                    <option value="126">126</option>
                                    <option value="127">127</option>
                                    <option value="128">128</option>
                                    <option value="129">129</option>
                                    <option value="130">130</option>
                                    <option value="131">131</option>
                                    <option value="132">132</option>
                                    <option value="133">133</option>
                                    <option value="134">134</option>
                                    <option value="135">135</option>
                                    <option value="136">136</option>
                                    <option value="137">137</option>
                                    <option value="138">138</option>
                                    <option value="139">139</option>
                                    <option value="140">140</option>
                                    <option value="141">141</option>
                                    <option value="142">142</option>
                                    <option value="143">143</option>
                                    <option value="144">144</option>
                                    <option value="145">145</option>
                                    <option value="146">146</option>
                                    <option value="147">147</option>
                                    <option value="148">148</option>
                                    <option value="149">149</option>
                                    <option value="150">150</option>
                                    <option value="151">151</option>
                                    <option value="152">152</option>
                                    <option value="153">153</option>
                                    <option value="154">154</option>
                                    <option value="155">155</option>
                                    <option value="156">156</option>
                                    <option value="157">157</option>
                                    <option value="158">158</option>
                                    <option value="159">159</option>
                                    <option value="160">160</option>
                                    <option value="161">161</option>
                                    <option value="162">162</option>
                                    <option value="163">163</option>
                                    <option value="164">164</option>
                                    <option value="165">165</option>
                                    <option value="166">166</option>
                                    <option value="167">167</option>
                                    <option value="168">168</option>
                                    <option value="169">169</option>
                                    <option value="170">170</option>
                                    <option value="171">171</option>
                                    <option value="172">172</option>
                                    <option value="173">173</option>
                                    <option value="174">174</option>
                                    <option value="175">175</option>
                                    <option value="176">176</option>
                                    <option value="177">177</option>
                                    <option value="178">178</option>
                                    <option value="179">179</option>
                                    <option value="180">180</option>
                                    <option value="More than 180">More than 180</option>
                                </select>
                            </div>

                            <!-- Geographical detail -->
                            <div class="form-group">
                                <label for="vaptMetaGeoState" class="form-label">Geographical detail of Client (State/UT)*</label>
                                <select id="vaptMetaGeoState" name="geographicalState" class="form-input" required>
                                    <option value="">Select State/UT</option>
                                    <option value="Andhra Pradesh">Andhra Pradesh</option>
                                    <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                    <option value="Assam">Assam</option>
                                    <option value="Bihar">Bihar</option>
                                    <option value="Chhattisgarh">Chhattisgarh</option>
                                    <option value="Goa">Goa</option>
                                    <option value="Gujarat">Gujarat</option>
                                    <option value="Haryana">Haryana</option>
                                    <option value="Himachal Pradesh">Himachal Pradesh</option>
                                    <option value="Jharkhand">Jharkhand</option>
                                    <option value="Karnataka">Karnataka</option>
                                    <option value="Kerala">Kerala</option>
                                    <option value="Madhya Pradesh">Madhya Pradesh</option>
                                    <option value="Maharashtra">Maharashtra</option>
                                    <option value="Manipur">Manipur</option>
                                    <option value="Meghalaya">Meghalaya</option>
                                    <option value="Mizoram">Mizoram</option>
                                    <option value="Nagaland">Nagaland</option>
                                    <option value="Odisha">Odisha</option>
                                    <option value="Punjab">Punjab</option>
                                    <option value="Rajasthan">Rajasthan</option>
                                    <option value="Sikkim">Sikkim</option>
                                    <option value="Tamil Nadu">Tamil Nadu</option>
                                    <option value="Telangana">Telangana</option>
                                    <option value="Tripura">Tripura</option>
                                    <option value="Uttar Pradesh">Uttar Pradesh</option>
                                    <option value="Uttarakhand">Uttarakhand</option>
                                    <option value="West Bengal">West Bengal</option>

                                    <!-- Union Territories -->
                                    <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                    <option value="Chandigarh">Chandigarh</option>
                                    <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                    <option value="Delhi">Delhi</option>
                                    <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                    <option value="Ladakh">Ladakh</option>
                                    <option value="Lakshadweep">Lakshadweep</option>
                                    <option value="Puducherry">Puducherry</option>

                                </select>
                            </div>

                            <!-- Date of Audit Completion -->
                            <div class="form-group">
                                <label for="vaptMetaDateCompletion" class="form-label">Date of Audit Completion*</label>
                                <input type="date" id="vaptMetaDateCompletion" name="dateAuditCompletion" class="form-input" required>
                            </div>

                            <!-- Date of last audit -->
                            <div class="form-group">
                                <label for="vaptMetaDateLastAuditType" class="form-label">Date of last audit of same infrastructure*</label>
                                <select id="vaptMetaDateLastAuditType" name="dateLastAuditType" class="form-input" required onchange="toggleVaptLastAuditDateInput('vaptMetaDateLastAuditType', 'vaptMetaDateLastAudit')">
                                    <option value="">Select</option>
                                    <option value="NA" selected>NA</option>
                                    <option value="EnterDate">Enter Date</option>
                                </select>
                                <input type="date" id="vaptMetaDateLastAudit" class="form-input" style="display: none; margin-top: 10px;">
                                <input type="hidden" id="vaptMetaDateLastAuditValue" name="dateLastAudit" value="NA">
                            </div>

                            <!-- Vulnerability Status Radio Buttons -->
                            <div class="form-group">
                                <label class="form-label" style="margin-bottom: 10px;">Vulnerability Status*</label>
                                <div style="display: flex; gap: 30px; margin-top: 10px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="0" required onchange="toggleVaptVulnerabilitySection()" style="width: auto;">
                                        <span>0 Vulnerability</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="has" required onchange="toggleVaptVulnerabilitySection()" style="width: auto;">
                                        <span>Has Vulnerability</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Vulnerability Details Section -->
                            <div id="vaptVulnerabilitySection" style="display: none;">
                                <div class="form-group">
                                    <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                        Audited Infrastructure Details
                                        <button type="button" class="submit-btn" onclick="addVaptVulnerabilityEntry()" style="float: right; margin-top: -5px;">
                                            <i class="fas fa-plus"></i> Add Entry
                                        </button>
                                    </h4>
                                </div>

                                <div id="vaptVulnerabilityContainer">
                                <!-- First vulnerability entry -->
                                <div class="vulnerability-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Audited infrastructure details*</label>
                                        <input type="text" name="vuln_0_infrastructure" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                                        <input type="text" name="vuln_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CVE/CWE Reference Number*</label>
                                        <input type="text" name="vuln_0_cve" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Severity of Issue*</label>
                                        <select name="vuln_0_severity" class="form-input" required>
                                            <option value="">Select Severity</option>
                                            <option value="Critical">Critical</option>
                                            <option value="High">High</option>
                                            <option value="Medium">Medium</option>
                                            <option value="Low">Low</option>
                                            <option value="Informational">Informational</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                                        <input type="number" name="vuln_0_count" class="form-input" min="0" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Attributing Factor*</label>
                                        <select name="vuln_0_factor" class="form-input" required>
                                            <option value="">Select Factor</option>
                                            <option value="Coding Error">Coding Error</option>
                                            <option value="Configuration Error">Configuration Error</option>
                                            <option value="Deployment Error">Deployment Error</option>
                                            <option value="Design Error">Design Error</option>
                                            <option value="Operation Error">Operation Error</option>
                                            <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            </div>

                            <!-- Employee Details Section -->
                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                    Employee Details
                                    <button type="button" class="submit-btn" onclick="addVaptEmployeeEntry()" style="float: right; margin-top: -5px;">
                                        <i class="fas fa-plus"></i> Add Employee
                                    </button>
                                </h4>
                            </div>

                            <div id="vaptEmployeeContainer">
                                <!-- First employee entry -->
                                <div class="employee-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Name of employee*</label>
                                        <input type="text" name="emp_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">E-mail ID*</label>
                                        <input type="email" name="emp_0_email" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISSP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cissp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cissp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cisa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cisa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISM*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cism" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cism" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">ISO*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_iso" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_iso" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">DISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_disa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_disa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">OSCP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_oscp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_oscp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CEH*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_ceh" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_ceh" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Others</label>
                                        <input type="text" name="emp_0_others" class="form-input" placeholder="Specify other certifications">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                                        <input type="number" name="emp_0_experience" class="form-input" min="0" step="0.5" required>
                                    </div>
                                </div>
                            </div>

                            <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                                <button type="button" class="btn btn-secondary" onclick="closeVaptModal('vaptFirstAuditMetaDataModal')">Cancel</button>
                                <button type="submit" class="btn btn-primary" id="vaptFirstAuditMetaDataSubmitBtn">
                                    <i class="fas fa-check"></i> Submit
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            

<!-- API First Audit MetaData Modal -->
            <div id="apiFirstAuditMetaDataModal" class="modal">
                <div class="modal-content" style="max-width: 1000px;">
                    <div class="modal-header">
                        <h3>API First Audit MetaData</h3>
                        <span class="close-modal" onclick="closeVaptModal('apiFirstAuditMetaDataModal')">&times;</span>
                    </div>
                    <div class="modal-body scrollable-content">
                        <form id="apiFirstAuditMetaDataForm" method="POST" onsubmit="handleApiFirstAuditMetaDataSubmit(event)">
                            
                            <!-- Audit Dates -->
                            <div class="form-group">
                                <label for="apiMetaStartDate" class="form-label">Start Audit Date*</label>
                                <input type="date" id="apiMetaStartDate" name="startAuditDate" class="form-input" required>
                            </div>

                            <div class="form-group">
                                <label for="apiMetaEndDate" class="form-label">End Audit Date*</label>
                                <input type="date" id="apiMetaEndDate" name="endAuditDate" class="form-input" required>
                            </div>

                            <!-- Name of Auditee organization -->
                            <div class="form-group">
                                <label for="apiMetaAuditeeOrg" class="form-label">Name of Auditee Organization*</label>
                                <select id="apiMetaAuditeeOrg" name="nameOfAuditeeOrg" class="form-input" required onchange="toggleVaptOtherField('apiMetaAuditeeOrg', 'apiMetaAuditeeOrgOther')">
                                    <option value="">Select Organization</option>
                                    <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                    <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                    <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                    <option value="Megasoft Limited">Megasoft Limited</option>
                                    <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                    <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                    <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                    <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                    <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                    <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                    <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                    <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                    <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                    <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                    <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                    <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                    <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                    <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                    <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                    <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                    <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                    <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                    <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                    <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                    <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                    <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                    <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                    <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                    <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                    <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                    <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                    <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                    <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                    <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                    <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                    <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                    <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                    <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                    <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                    <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                    
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="apiMetaAuditeeOrgOther" name="nameOfAuditeeOrgOther" class="form-input" placeholder="Specify organization name" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Category of Organization -->
                            <div class="form-group">
                                <label for="apiMetaCategoryOrg" class="form-label">Category of Organization*</label>
                                <select id="apiMetaCategoryOrg" name="categoryOfOrg" class="form-input" required>
                                    <option value="">Select Category</option>
                                    <option value="Central Ministry/Department">Central Ministry/Department</option>
                                    <option value="Organization under Government Department">Organization under Government Department</option>
                                    <option value="Private Sector" selected>Private Sector</option>
                                    <option value="Public sector organisations">Public sector organisations</option>
                                    <option value="State Government Department">State Government Department</option>
                                </select>
                            </div>

                            <!-- Sector of Organization -->
                            <div class="form-group">
                                <label for="apiMetaSectorOrg" class="form-label">Sector of Organization*</label>
                                <select id="apiMetaSectorOrg" name="sectorOfOrg" class="form-input" required onchange="updateApiSubSectorOptions()">
                                    <option value="">Select Sector</option>
                                    <option value="Agriculture">Agriculture</option>
                                    <option value="Defence">Defence</option>
                                    <option value="Education">Education</option>
                                    <option value="Energy">Energy</option>
                                    <option value="Finance" selected>Finance</option>
                                    <option value="Healthcare">Healthcare</option>
                                    <option value="Information_and_Broadcasting">Information and Broadcasting</option>
                                    <option value="Information_and_Communication_Technology">Information and Communication Technology</option>
                                    <option value="Law_Enforcement_and_Security">Law Enforcement and Security</option>
                                    <option value="Public_Essential_Services_and_Utilities">Public Essential Services and Utilities</option>
                                    <option value="Space">Space</option>
                                    <option value="Transportation">Transportation</option>
                                </select>
                            </div>

                            <!-- Sub Sector -->
                            <div class="form-group">
                                <label for="apiMetaSubSector" class="form-label">Sub Sector*</label>
                                <select id="apiMetaSubSector" name="subSector" class="form-input" required>
                                    <option value="">Select Sector First</option>
                                </select>
                            </div>

                            <!-- Type of audit -->
                            <div class="form-group">
                                <label for="apiMetaTypeAudit" class="form-label">Type of Audit*</label>
                                <select id="apiMetaTypeAudit" name="typeOfAudit" class="form-input" required onchange="toggleVaptOtherField('apiMetaTypeAudit', 'apiMetaTypeAuditOther')">
                                    <option value="">Select Type</option>
                                    <option value="API Security Audit" selected>API Security Audit</option>
                                    <option value="Cloud Security Audit">Cloud Security Audit</option>
                                    <option value="Compliance to Standard/Framework/Policies Related Audit">Compliance to Standard/Framework/Policies Related Audit</option>
                                    <option value="Digital Forensic Readiness Assessment">Digital Forensic Readiness Assessment</option>
                                    <option value="Industrial Control Systems (ICS) / SCADA Audit">Industrial Control Systems (ICS) / SCADA Audit</option>
                                    <option value="IoT Security Assessment">IoT Security Assessment</option>
                                    <option value="Mobile Application Audit">Mobile Application Audit</option>
                                    <option value="Network Infrastructure Audits">Network Infrastructure Audits</option>
                                    <option value="Process Audit">Process Audit</option>
                                    <option value="Red Team Assessment">Red Team Assessment</option>
                                    <option value="Source Code Review">Source Code Review</option>
                                    <option value="VAPT-Infrastructure">VAPT-Infrastructure</option>
                                    <option value="VAPT-Application">VAPT-Application</option>
                                    <option value="Website /Web Application Audit">Website /Web Application Audit</option>
                                    <option value="Wireless security audit">Wireless security audit</option>
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="apiMetaTypeAuditOther" name="typeOfAuditOther" class="form-input" placeholder="Please specify type of audit" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Details of website/application/infrastructure -->
                            <div class="form-group">
                                <label for="apiMetaDetails" class="form-label">Details of web site/name of application/no. of servers, perimeter devices, other infrastructure*</label>
                                <textarea id="apiMetaDetails" name="detailsOfWebsite" class="form-input" placeholder="Enter details" required rows="3"></textarea>
                            </div>

                            <!-- Reason for conducting Audit -->
                            <div class="form-group">
                                <label for="apiMetaReason" class="form-label">Reason for conducting Audit*</label>
                                <select id="apiMetaReason" name="reasonForAudit" class="form-input" required>
                                    <option value="">Select Reason</option>
                                    <option value="Certificate of compliance like ISO 27001">Certificate of compliance like ISO 27001</option>
                                    <option value="Certificate of safe hosting">Certificate of safe hosting</option>
                                    <option value="Change in process or infrastructure">Change in process or infrastructure</option>
                                    <option value="Government directions">Government directions</option>
                                    <option value="Incident/ Breach in Organisation">Incident/ Breach in Organisation</option>
                                    <option value="Incident/ Breach in Sector">Incident/ Breach in Sector</option>
                                    <option value="New application/ Infrastructure">New application/ Infrastructure</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Periodic Audit as per Policy of organisation.">Periodic Audit as per Policy of organisation.</option>
                                    <option value="Regulatory directions" selected>Regulatory directions</option>
                                    <option value="Third Party Initiated">Third Party Initiated</option>
                                </select>
                            </div>

                            <!-- Standards Used for conducting Audit -->
                            <div class="form-group">
                                <label for="apiMetaStandards" class="form-label">Standards Used for conducting Audit*</label>
                                <input type="text" id="apiMetaStandards" name="standardsUsed" class="form-input" placeholder="Enter standards" required>
                            </div>

                            <!-- Challenges in conducting Audits -->
                            <div class="form-group">
                                <label for="apiMetaChallenges" class="form-label">Challenges in conducting Audits*</label>
                                <textarea id="apiMetaChallenges" name="challenges" class="form-input" placeholder="Enter challenges" required rows="3"></textarea>
                            </div>

                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Compliance Questions</h4>
                            </div>

                            <!-- Compliance questions -->
                            <div class="form-group">
                                <label for="apiMetaCompFinancial" class="form-label">Compliance to financial sector regulatory bodies guidelines/circulars/directions like from RBI, IRDAI, SEBI, NPCI*</label>
                                <select id="apiMetaCompFinancial" name="complianceFinancial" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="apiMetaCompRegulatory" class="form-label">Compliance to regulatory bodies guidelines/circulars/directions like from UIDAI, CCA, DoT, TRAI*</label>
                                <select id="apiMetaCompRegulatory" name="complianceRegulatory" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="apiMetaCompCertIn" class="form-label">Compliance to CERT-In directions under sub-section (6) of section 70B of the IT Act, 2000 dated 28 April, 2022*</label>
                                <select id="apiMetaCompCertIn" name="complianceCertIn" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="apiMetaCompCEA" class="form-label">Compliance to CEA (Cyber Security in Power Sector) guidelines 2021*</label>
                                <select id="apiMetaCompCEA" name="complianceCEA" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="apiMetaCompOther" class="form-label">Any other domestic regulation, directions, guidelines (Please Specify)*</label>
                                <select id="apiMetaCompOther" name="complianceOther" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No" selected>No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <!-- Type of Audit Report -->
                            <div class="form-group">
                                <label for="apiMetaTypeReport" class="form-label">Type of Audit Report*</label>
                                <select id="apiMetaTypeReport" name="typeOfAuditReport" class="form-input" required>
                                    <option value="">Select Type</option>
                                    <option value="First Audit Report" selected>First Audit Report</option>
                                    <option value="Follow up Audit Report">Follow up Audit Report</option>
                                </select>
                            </div>

                            <!-- No. of vulnerabilities -->
                            <div class="form-group">
                                <label for="apiMetaNumVuln" class="form-label">No. of vulnerabilities/ security issues reported during FIRST Audit*</label>
                                <input type="number" id="apiMetaNumVuln" name="numVulnerabilities" class="form-input" placeholder="Enter number" min="0" required>
                            </div>

                            <!-- No. of days taken to patch -->
                            <div class="form-group">
                                <label for="apiMetaDaysPatch" class="form-label">No. of days taken by Client to patch the vulnerabilities after submission of Audit report*</label>
                                <select id="apiMetaDaysPatch" name="numDaysToPatch" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Follow up audit not performed" selected>Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- Duration between audits -->
                            <div class="form-group">
                                <label for="apiMetaDuration" class="form-label">Durations (in days) between end of FIRST audit and start of FOLLOW-UP/SECOND audit*</label>
                                <select id="apiMetaDuration" name="durationBetweenAudits" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed" selected>Follow up audit not performed</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- No. of open issues -->
                            <div class="form-group">
                                <label for="apiMetaOpenIssues" class="form-label">No. of open issues after follow-up audits*</label>
                                <select id="apiMetaOpenIssues" name="numOpenIssues" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed" selected>Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="0">0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="101">101</option>
                                    <option value="102">102</option>
                                    <option value="103">103</option>
                                    <option value="104">104</option>
                                    <option value="105">105</option>
                                    <option value="106">106</option>
                                    <option value="107">107</option>
                                    <option value="108">108</option>
                                    <option value="109">109</option>
                                    <option value="110">110</option>
                                    <option value="111">111</option>
                                    <option value="112">112</option>
                                    <option value="113">113</option>
                                    <option value="114">114</option>
                                    <option value="115">115</option>
                                    <option value="116">116</option>
                                    <option value="117">117</option>
                                    <option value="118">118</option>
                                    <option value="119">119</option>
                                    <option value="120">120</option>
                                    <option value="121">121</option>
                                    <option value="122">122</option>
                                    <option value="123">123</option>
                                    <option value="124">124</option>
                                    <option value="125">125</option>
                                    <option value="126">126</option>
                                    <option value="127">127</option>
                                    <option value="128">128</option>
                                    <option value="129">129</option>
                                    <option value="130">130</option>
                                    <option value="131">131</option>
                                    <option value="132">132</option>
                                    <option value="133">133</option>
                                    <option value="134">134</option>
                                    <option value="135">135</option>
                                    <option value="136">136</option>
                                    <option value="137">137</option>
                                    <option value="138">138</option>
                                    <option value="139">139</option>
                                    <option value="140">140</option>
                                    <option value="141">141</option>
                                    <option value="142">142</option>
                                    <option value="143">143</option>
                                    <option value="144">144</option>
                                    <option value="145">145</option>
                                    <option value="146">146</option>
                                    <option value="147">147</option>
                                    <option value="148">148</option>
                                    <option value="149">149</option>
                                    <option value="150">150</option>
                                    <option value="151">151</option>
                                    <option value="152">152</option>
                                    <option value="153">153</option>
                                    <option value="154">154</option>
                                    <option value="155">155</option>
                                    <option value="156">156</option>
                                    <option value="157">157</option>
                                    <option value="158">158</option>
                                    <option value="159">159</option>
                                    <option value="160">160</option>
                                    <option value="161">161</option>
                                    <option value="162">162</option>
                                    <option value="163">163</option>
                                    <option value="164">164</option>
                                    <option value="165">165</option>
                                    <option value="166">166</option>
                                    <option value="167">167</option>
                                    <option value="168">168</option>
                                    <option value="169">169</option>
                                    <option value="170">170</option>
                                    <option value="171">171</option>
                                    <option value="172">172</option>
                                    <option value="173">173</option>
                                    <option value="174">174</option>
                                    <option value="175">175</option>
                                    <option value="176">176</option>
                                    <option value="177">177</option>
                                    <option value="178">178</option>
                                    <option value="179">179</option>
                                    <option value="180">180</option>
                                    <option value="More than 180">More than 180</option>
                                </select>
                            </div>

                            <!-- Geographical detail -->
                            <div class="form-group">
                                <label for="apiMetaGeoState" class="form-label">Geographical detail of Client (State/UT)*</label>
                                <select id="apiMetaGeoState" name="geographicalState" class="form-input" required>
                                    <option value="">Select State/UT</option>
                                    <option value="Andhra Pradesh">Andhra Pradesh</option>
                                    <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                    <option value="Assam">Assam</option>
                                    <option value="Bihar">Bihar</option>
                                    <option value="Chhattisgarh">Chhattisgarh</option>
                                    <option value="Goa">Goa</option>
                                    <option value="Gujarat">Gujarat</option>
                                    <option value="Haryana">Haryana</option>
                                    <option value="Himachal Pradesh">Himachal Pradesh</option>
                                    <option value="Jharkhand">Jharkhand</option>
                                    <option value="Karnataka">Karnataka</option>
                                    <option value="Kerala">Kerala</option>
                                    <option value="Madhya Pradesh">Madhya Pradesh</option>
                                    <option value="Maharashtra">Maharashtra</option>
                                    <option value="Manipur">Manipur</option>
                                    <option value="Meghalaya">Meghalaya</option>
                                    <option value="Mizoram">Mizoram</option>
                                    <option value="Nagaland">Nagaland</option>
                                    <option value="Odisha">Odisha</option>
                                    <option value="Punjab">Punjab</option>
                                    <option value="Rajasthan">Rajasthan</option>
                                    <option value="Sikkim">Sikkim</option>
                                    <option value="Tamil Nadu">Tamil Nadu</option>
                                    <option value="Telangana">Telangana</option>
                                    <option value="Tripura">Tripura</option>
                                    <option value="Uttar Pradesh">Uttar Pradesh</option>
                                    <option value="Uttarakhand">Uttarakhand</option>
                                    <option value="West Bengal">West Bengal</option>

                                    <!-- Union Territories -->
                                    <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                    <option value="Chandigarh">Chandigarh</option>
                                    <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                    <option value="Delhi">Delhi</option>
                                    <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                    <option value="Ladakh">Ladakh</option>
                                    <option value="Lakshadweep">Lakshadweep</option>
                                    <option value="Puducherry">Puducherry</option>

                                </select>
                            </div>

                            <!-- Date of Audit Completion -->
                            <div class="form-group">
                                <label for="apiMetaDateCompletion" class="form-label">Date of Audit Completion*</label>
                                <input type="date" id="apiMetaDateCompletion" name="dateAuditCompletion" class="form-input" required>
                            </div>

                            <!-- Date of last audit -->
                            <div class="form-group">
                                <label for="apiMetaDateLastAuditType" class="form-label">Date of last audit of same infrastructure*</label>
                                <select id="apiMetaDateLastAuditType" name="dateLastAuditType" class="form-input" required onchange="toggleVaptLastAuditDateInput('apiMetaDateLastAuditType', 'apiMetaDateLastAudit')">
                                    <option value="">Select</option>
                                    <option value="NA" selected>NA</option>
                                    <option value="EnterDate">Enter Date</option>
                                </select>
                                <input type="date" id="apiMetaDateLastAudit" class="form-input" style="display: none; margin-top: 10px;">
                                <input type="hidden" id="apiMetaDateLastAuditValue" name="dateLastAudit" value="NA">
                            </div>

                            <!-- Vulnerability Status Radio Buttons -->
                            <div class="form-group">
                                <label class="form-label" style="margin-bottom: 10px;">Vulnerability Status*</label>
                                <div style="display: flex; gap: 30px; margin-top: 10px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="0" required onchange="toggleApiVulnerabilitySection()" style="width: auto;">
                                        <span>0 Vulnerability</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="has" required onchange="toggleApiVulnerabilitySection()" style="width: auto;">
                                        <span>Has Vulnerability</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Vulnerability Details Section -->
                            <div id="apiVulnerabilitySection" style="display: none;">
                                <div class="form-group">
                                    <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                        Audited Infrastructure Details
                                        <button type="button" class="submit-btn" onclick="addApiVulnerabilityEntry()" style="float: right; margin-top: -5px;">
                                            <i class="fas fa-plus"></i> Add Entry
                                        </button>
                                    </h4>
                                </div>

                                <div id="apiVulnerabilityContainer">
                                <!-- First vulnerability entry -->
                                <div class="vulnerability-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Audited infrastructure details*</label>
                                        <input type="text" name="vuln_0_infrastructure" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                                        <input type="text" name="vuln_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CVE/CWE Reference Number*</label>
                                        <input type="text" name="vuln_0_cve" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Severity of Issue*</label>
                                        <select name="vuln_0_severity" class="form-input" required>
                                            <option value="">Select Severity</option>
                                            <option value="Critical">Critical</option>
                                            <option value="High">High</option>
                                            <option value="Medium">Medium</option>
                                            <option value="Low">Low</option>
                                            <option value="Informational">Informational</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                                        <input type="number" name="vuln_0_count" class="form-input" min="0" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Attributing Factor*</label>
                                        <select name="vuln_0_factor" class="form-input" required>
                                            <option value="">Select Factor</option>
                                            <option value="Coding Error">Coding Error</option>
                                            <option value="Configuration Error">Configuration Error</option>
                                            <option value="Deployment Error">Deployment Error</option>
                                            <option value="Design Error">Design Error</option>
                                            <option value="Operation Error">Operation Error</option>
                                            <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            </div>

                            <!-- Employee Details Section -->
                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                    Employee Details
                                    <button type="button" class="submit-btn" onclick="addApiEmployeeEntry()" style="float: right; margin-top: -5px;">
                                        <i class="fas fa-plus"></i> Add Employee
                                    </button>
                                </h4>
                            </div>

                            <div id="apiEmployeeContainer">
                                <!-- First employee entry -->
                                <div class="employee-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Name of employee*</label>
                                        <input type="text" name="emp_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">E-mail ID*</label>
                                        <input type="email" name="emp_0_email" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISSP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cissp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cissp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cisa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cisa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISM*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cism" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cism" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">ISO*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_iso" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_iso" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">DISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_disa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_disa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">OSCP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_oscp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_oscp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CEH*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_ceh" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_ceh" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Others</label>
                                        <input type="text" name="emp_0_others" class="form-input" placeholder="Specify other certifications">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                                        <input type="number" name="emp_0_experience" class="form-input" min="0" step="0.5" required>
                                    </div>
                                </div>
                            </div>

                            <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                                <button type="button" class="btn btn-secondary" onclick="closeVaptModal('apiFirstAuditMetaDataModal')">Cancel</button>
                                <button type="submit" class="btn btn-primary" id="apiFirstAuditMetaDataSubmitBtn">
                                    <i class="fas fa-check"></i> Submit
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            

<!-- Public IP First Audit MetaData Modal -->
            <div id="publicIpFirstAuditMetaDataModal" class="modal">
                <div class="modal-content" style="max-width: 1000px;">
                    <div class="modal-header">
                        <h3>Public IP First Audit MetaData</h3>
                        <span class="close-modal" onclick="closeVaptModal('publicIpFirstAuditMetaDataModal')">&times;</span>
                    </div>
                    <div class="modal-body scrollable-content">
                        <form id="publicIpFirstAuditMetaDataForm" method="POST" onsubmit="handlePublicIpFirstAuditMetaDataSubmit(event)">
                            
                            <!-- Audit Dates -->
                            <div class="form-group">
                                <label for="publicIpMetaStartDate" class="form-label">Start Audit Date*</label>
                                <input type="date" id="publicIpMetaStartDate" name="startAuditDate" class="form-input" required>
                            </div>

                            <div class="form-group">
                                <label for="publicIpMetaEndDate" class="form-label">End Audit Date*</label>
                                <input type="date" id="publicIpMetaEndDate" name="endAuditDate" class="form-input" required>
                            </div>

                            <!-- Name of Auditee organization -->
                            <div class="form-group">
                                <label for="publicIpMetaAuditeeOrg" class="form-label">Name of Auditee Organization*</label>
                                <select id="publicIpMetaAuditeeOrg" name="nameOfAuditeeOrg" class="form-input" required onchange="togglePublicIpVaptOtherField('publicIpMetaAuditeeOrg', 'publicIpMetaAuditeeOrgOther')">
                                    <option value="">Select Organization</option>
                                    <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                    <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                    <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                    <option value="Megasoft Limited">Megasoft Limited</option>
                                    <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                    <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                    <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                    <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                    <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                    <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                    <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                    <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                    <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                    <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                    <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                    <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                    <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                    <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                    <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                    <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                    <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                    <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                    <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                    <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                    <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                    <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                    <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                    <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                    <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                    <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                    <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                    <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                    <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                    <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                    <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                    <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                    <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                    <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                    <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                    <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                    
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="publicIpMetaAuditeeOrgOther" name="nameOfAuditeeOrgOther" class="form-input" placeholder="Specify organization name" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Category of Organization -->
                            <div class="form-group">
                                <label for="publicIpMetaCategoryOrg" class="form-label">Category of Organization*</label>
                                <select id="publicIpMetaCategoryOrg" name="categoryOfOrg" class="form-input" required>
                                    <option value="">Select Category</option>
                                    <option value="Central Ministry/Department">Central Ministry/Department</option>
                                    <option value="Organization under Government Department">Organization under Government Department</option>
                                    <option value="Private Sector" selected>Private Sector</option>
                                    <option value="Public sector organisations">Public sector organisations</option>
                                    <option value="State Government Department">State Government Department</option>
                                </select>
                            </div>

                            <!-- Sector of Organization -->
                            <div class="form-group">
                                <label for="publicIpMetaSectorOrg" class="form-label">Sector of Organization*</label>
                                <select id="publicIpMetaSectorOrg" name="sectorOfOrg" class="form-input" required onchange="updatePublicIpVaptSubSectorOptions()">
                                    <option value="">Select Sector</option>
                                    <option value="Agriculture">Agriculture</option>
                                    <option value="Defence">Defence</option>
                                    <option value="Education">Education</option>
                                    <option value="Energy">Energy</option>
                                    <option value="Finance" selected>Finance</option>
                                    <option value="Healthcare">Healthcare</option>
                                    <option value="Information_and_Broadcasting">Information and Broadcasting</option>
                                    <option value="Information_and_Communication_Technology">Information and Communication Technology</option>
                                    <option value="Law_Enforcement_and_Security">Law Enforcement and Security</option>
                                    <option value="Public_Essential_Services_and_Utilities">Public Essential Services and Utilities</option>
                                    <option value="Space">Space</option>
                                    <option value="Transportation">Transportation</option>
                                </select>
                            </div>

                            <!-- Sub Sector -->
                            <div class="form-group">
                                <label for="publicIpMetaSubSector" class="form-label">Sub Sector*</label>
                                <select id="publicIpMetaSubSector" name="subSector" class="form-input" required>
                                    <option value="">Select Sector First</option>
                                </select>
                            </div>

                            <!-- Type of audit -->
                            <div class="form-group">
                                <label for="publicIpMetaTypeAudit" class="form-label">Type of Audit*</label>
                                <select id="publicIpMetaTypeAudit" name="typeOfAudit" class="form-input" required onchange="togglePublicIpVaptOtherField('publicIpMetaTypeAudit', 'publicIpMetaTypeAuditOther')">
                                    <option value="">Select Type</option>
                                    <option value="API Security Audit">API Security Audit</option>
                                    <option value="Cloud Security Audit">Cloud Security Audit</option>
                                    <option value="Compliance to Standard/Framework/Policies Related Audit">Compliance to Standard/Framework/Policies Related Audit</option>
                                    <option value="Digital Forensic Readiness Assessment">Digital Forensic Readiness Assessment</option>
                                    <option value="Industrial Control Systems (ICS) / SCADA Audit">Industrial Control Systems (ICS) / SCADA Audit</option>
                                    <option value="IoT Security Assessment">IoT Security Assessment</option>
                                    <option value="Mobile Application Audit">Mobile Application Audit</option>
                                    <option value="Network Infrastructure Audits">Network Infrastructure Audits</option>
                                    <option value="Process Audit">Process Audit</option>
                                    <option value="Red Team Assessment">Red Team Assessment</option>
                                    <option value="Source Code Review">Source Code Review</option>
                                    <option value="VAPT-Infrastructure" selected>VAPT-Infrastructure</option>
                                    <option value="VAPT-Application">VAPT-Application</option>
                                    <option value="Website /Web Application Audit">Website /Web Application Audit</option>
                                    <option value="Wireless security audit">Wireless security audit</option>
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="publicIpMetaTypeAuditOther" name="typeOfAuditOther" class="form-input" placeholder="Please specify type of audit" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Details of website/application/infrastructure -->
                            <div class="form-group">
                                <label for="publicIpMetaDetails" class="form-label">Details of web site/name of application/no. of servers, perimeter devices, other infrastructure*</label>
                                <textarea id="publicIpMetaDetails" name="detailsOfWebsite" class="form-input" placeholder="Enter details" required rows="3"></textarea>
                            </div>

                            <!-- Reason for conducting Audit -->
                            <div class="form-group">
                                <label for="publicIpMetaReason" class="form-label">Reason for conducting Audit*</label>
                                <select id="publicIpMetaReason" name="reasonForAudit" class="form-input" required>
                                    <option value="">Select Reason</option>
                                    <option value="Certificate of compliance like ISO 27001">Certificate of compliance like ISO 27001</option>
                                    <option value="Certificate of safe hosting">Certificate of safe hosting</option>
                                    <option value="Change in process or infrastructure">Change in process or infrastructure</option>
                                    <option value="Government directions">Government directions</option>
                                    <option value="Incident/ Breach in Organisation">Incident/ Breach in Organisation</option>
                                    <option value="Incident/ Breach in Sector">Incident/ Breach in Sector</option>
                                    <option value="New application/ Infrastructure">New application/ Infrastructure</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Periodic Audit as per Policy of organisation.">Periodic Audit as per Policy of organisation.</option>
                                    <option value="Regulatory directions" selected>Regulatory directions</option>
                                    <option value="Third Party Initiated">Third Party Initiated</option>
                                </select>
                            </div>

                            <!-- Standards Used for conducting Audit -->
                            <div class="form-group">
                                <label for="publicIpMetaStandards" class="form-label">Standards Used for conducting Audit*</label>
                                <input type="text" id="publicIpMetaStandards" name="standardsUsed" class="form-input" placeholder="Enter standards" required>
                            </div>

                            <!-- Challenges in conducting Audits -->
                            <div class="form-group">
                                <label for="publicIpMetaChallenges" class="form-label">Challenges in conducting Audits*</label>
                                <textarea id="publicIpMetaChallenges" name="challenges" class="form-input" placeholder="Enter challenges" required rows="3"></textarea>
                            </div>

                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Compliance Questions</h4>
                            </div>

                            <!-- Compliance questions -->
                            <div class="form-group">
                                <label for="publicIpMetaCompFinancial" class="form-label">Compliance to financial sector regulatory bodies guidelines/circulars/directions like from RBI, IRDAI, SEBI, NPCI*</label>
                                <select id="publicIpMetaCompFinancial" name="complianceFinancial" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="publicIpMetaCompRegulatory" class="form-label">Compliance to regulatory bodies guidelines/circulars/directions like from UIDAI, CCA, DoT, TRAI*</label>
                                <select id="publicIpMetaCompRegulatory" name="complianceRegulatory" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="publicIpMetaCompCertIn" class="form-label">Compliance to CERT-In directions under sub-section (6) of section 70B of the IT Act, 2000 dated 28 April, 2022*</label>
                                <select id="publicIpMetaCompCertIn" name="complianceCertIn" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="publicIpMetaCompCEA" class="form-label">Compliance to CEA (Cyber Security in Power Sector) guidelines 2021*</label>
                                <select id="publicIpMetaCompCEA" name="complianceCEA" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="publicIpMetaCompOther" class="form-label">Any other domestic regulation, directions, guidelines (Please Specify)*</label>
                                <select id="publicIpMetaCompOther" name="complianceOther" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No" selected>No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <!-- Type of Audit Report -->
                            <div class="form-group">
                                <label for="publicIpMetaTypeReport" class="form-label">Type of Audit Report*</label>
                                <select id="publicIpMetaTypeReport" name="typeOfAuditReport" class="form-input" required>
                                    <option value="">Select Type</option>
                                    <option value="First Audit Report" selected>First Audit Report</option>
                                    <option value="Follow up Audit Report">Follow up Audit Report</option>
                                </select>
                            </div>

                            <!-- No. of vulnerabilities -->
                            <div class="form-group">
                                <label for="publicIpMetaNumVuln" class="form-label">No. of vulnerabilities/ security issues reported during FIRST Audit*</label>
                                <input type="number" id="publicIpMetaNumVuln" name="numVulnerabilities" class="form-input" placeholder="Enter number" min="0" required>
                            </div>

                            <!-- No. of days taken to patch -->
                            <div class="form-group">
                                <label for="publicIpMetaDaysPatch" class="form-label">No. of days taken by Client to patch the vulnerabilities after submission of Audit report*</label>
                                <select id="publicIpMetaDaysPatch" name="numDaysToPatch" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Follow up audit not performed" selected>Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- Duration between audits -->
                            <div class="form-group">
                                <label for="publicIpMetaDuration" class="form-label">Durations (in days) between end of FIRST audit and start of FOLLOW-UP/SECOND audit*</label>
                                <select id="publicIpMetaDuration" name="durationBetweenAudits" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed" selected>Follow up audit not performed</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- No. of open issues -->
                            <div class="form-group">
                                <label for="publicIpMetaOpenIssues" class="form-label">No. of open issues after follow-up audits*</label>
                                <select id="publicIpMetaOpenIssues" name="numOpenIssues" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed" selected>Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="0">0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="101">101</option>
                                    <option value="102">102</option>
                                    <option value="103">103</option>
                                    <option value="104">104</option>
                                    <option value="105">105</option>
                                    <option value="106">106</option>
                                    <option value="107">107</option>
                                    <option value="108">108</option>
                                    <option value="109">109</option>
                                    <option value="110">110</option>
                                    <option value="111">111</option>
                                    <option value="112">112</option>
                                    <option value="113">113</option>
                                    <option value="114">114</option>
                                    <option value="115">115</option>
                                    <option value="116">116</option>
                                    <option value="117">117</option>
                                    <option value="118">118</option>
                                    <option value="119">119</option>
                                    <option value="120">120</option>
                                    <option value="121">121</option>
                                    <option value="122">122</option>
                                    <option value="123">123</option>
                                    <option value="124">124</option>
                                    <option value="125">125</option>
                                    <option value="126">126</option>
                                    <option value="127">127</option>
                                    <option value="128">128</option>
                                    <option value="129">129</option>
                                    <option value="130">130</option>
                                    <option value="131">131</option>
                                    <option value="132">132</option>
                                    <option value="133">133</option>
                                    <option value="134">134</option>
                                    <option value="135">135</option>
                                    <option value="136">136</option>
                                    <option value="137">137</option>
                                    <option value="138">138</option>
                                    <option value="139">139</option>
                                    <option value="140">140</option>
                                    <option value="141">141</option>
                                    <option value="142">142</option>
                                    <option value="143">143</option>
                                    <option value="144">144</option>
                                    <option value="145">145</option>
                                    <option value="146">146</option>
                                    <option value="147">147</option>
                                    <option value="148">148</option>
                                    <option value="149">149</option>
                                    <option value="150">150</option>
                                    <option value="151">151</option>
                                    <option value="152">152</option>
                                    <option value="153">153</option>
                                    <option value="154">154</option>
                                    <option value="155">155</option>
                                    <option value="156">156</option>
                                    <option value="157">157</option>
                                    <option value="158">158</option>
                                    <option value="159">159</option>
                                    <option value="160">160</option>
                                    <option value="161">161</option>
                                    <option value="162">162</option>
                                    <option value="163">163</option>
                                    <option value="164">164</option>
                                    <option value="165">165</option>
                                    <option value="166">166</option>
                                    <option value="167">167</option>
                                    <option value="168">168</option>
                                    <option value="169">169</option>
                                    <option value="170">170</option>
                                    <option value="171">171</option>
                                    <option value="172">172</option>
                                    <option value="173">173</option>
                                    <option value="174">174</option>
                                    <option value="175">175</option>
                                    <option value="176">176</option>
                                    <option value="177">177</option>
                                    <option value="178">178</option>
                                    <option value="179">179</option>
                                    <option value="180">180</option>
                                    <option value="More than 180">More than 180</option>
                                </select>
                            </div>

                            <!-- Geographical detail -->
                            <div class="form-group">
                                <label for="publicIpMetaGeoState" class="form-label">Geographical detail of Client (State/UT)*</label>
                                <select id="publicIpMetaGeoState" name="geographicalState" class="form-input" required>
                                    <option value="">Select State/UT</option>
                                    <option value="Andhra Pradesh">Andhra Pradesh</option>
                                    <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                    <option value="Assam">Assam</option>
                                    <option value="Bihar">Bihar</option>
                                    <option value="Chhattisgarh">Chhattisgarh</option>
                                    <option value="Goa">Goa</option>
                                    <option value="Gujarat">Gujarat</option>
                                    <option value="Haryana">Haryana</option>
                                    <option value="Himachal Pradesh">Himachal Pradesh</option>
                                    <option value="Jharkhand">Jharkhand</option>
                                    <option value="Karnataka">Karnataka</option>
                                    <option value="Kerala">Kerala</option>
                                    <option value="Madhya Pradesh">Madhya Pradesh</option>
                                    <option value="Maharashtra">Maharashtra</option>
                                    <option value="Manipur">Manipur</option>
                                    <option value="Meghalaya">Meghalaya</option>
                                    <option value="Mizoram">Mizoram</option>
                                    <option value="Nagaland">Nagaland</option>
                                    <option value="Odisha">Odisha</option>
                                    <option value="Punjab">Punjab</option>
                                    <option value="Rajasthan">Rajasthan</option>
                                    <option value="Sikkim">Sikkim</option>
                                    <option value="Tamil Nadu">Tamil Nadu</option>
                                    <option value="Telangana">Telangana</option>
                                    <option value="Tripura">Tripura</option>
                                    <option value="Uttar Pradesh">Uttar Pradesh</option>
                                    <option value="Uttarakhand">Uttarakhand</option>
                                    <option value="West Bengal">West Bengal</option>

                                    <!-- Union Territories -->
                                    <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                    <option value="Chandigarh">Chandigarh</option>
                                    <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                    <option value="Delhi">Delhi</option>
                                    <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                    <option value="Ladakh">Ladakh</option>
                                    <option value="Lakshadweep">Lakshadweep</option>
                                    <option value="Puducherry">Puducherry</option>

                                </select>
                            </div>

                            <!-- Date of Audit Completion -->
                            <div class="form-group">
                                <label for="publicIpMetaDateCompletion" class="form-label">Date of Audit Completion*</label>
                                <input type="date" id="publicIpMetaDateCompletion" name="dateAuditCompletion" class="form-input" required>
                            </div>

                            <!-- Date of last audit -->
                            <div class="form-group">
                                <label for="publicIpMetaDateLastAuditType" class="form-label">Date of last audit of same infrastructure*</label>
                                <select id="publicIpMetaDateLastAuditType" name="dateLastAuditType" class="form-input" required onchange="togglePublicIpVaptLastAuditDateInput('publicIpMetaDateLastAuditType', 'publicIpMetaDateLastAudit')">
                                    <option value="">Select</option>
                                    <option value="NA" selected>NA</option>
                                    <option value="EnterDate">Enter Date</option>
                                </select>
                                <input type="date" id="publicIpMetaDateLastAudit" class="form-input" style="display: none; margin-top: 10px;">
                                <input type="hidden" id="publicIpMetaDateLastAuditValue" name="dateLastAudit" value="NA">
                            </div>

                            <!-- Vulnerability Status Radio Buttons -->
                            <div class="form-group">
                                <label class="form-label" style="margin-bottom: 10px;">Vulnerability Status*</label>
                                <div style="display: flex; gap: 30px; margin-top: 10px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="0" required onchange="togglePublicIpVulnerabilitySection()" style="width: auto;">
                                        <span>0 Vulnerability</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="has" required onchange="togglePublicIpVulnerabilitySection()" style="width: auto;">
                                        <span>Has Vulnerability</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Vulnerability Details Section -->
                            <div id="publicIpVulnerabilitySection" style="display: none;">
                                <div class="form-group">
                                    <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                        Audited Infrastructure Details
                                        <button type="button" class="submit-btn" onclick="addPublicIpVulnerabilityEntry()" style="float: right; margin-top: -5px;">
                                            <i class="fas fa-plus"></i> Add Entry
                                        </button>
                                    </h4>
                                </div>

                                <div id="publicIpVulnerabilityContainer">
                                <!-- First vulnerability entry -->
                                <div class="vulnerability-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Audited infrastructure details*</label>
                                        <input type="text" name="vuln_0_infrastructure" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                                        <input type="text" name="vuln_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CVE/CWE Reference Number*</label>
                                        <input type="text" name="vuln_0_cve" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Severity of Issue*</label>
                                        <select name="vuln_0_severity" class="form-input" required>
                                            <option value="">Select Severity</option>
                                            <option value="Critical">Critical</option>
                                            <option value="High">High</option>
                                            <option value="Medium">Medium</option>
                                            <option value="Low">Low</option>
                                            <option value="Informational">Informational</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                                        <input type="number" name="vuln_0_count" class="form-input" min="0" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Attributing Factor*</label>
                                        <select name="vuln_0_factor" class="form-input" required>
                                            <option value="">Select Factor</option>
                                            <option value="Coding Error">Coding Error</option>
                                            <option value="Configuration Error">Configuration Error</option>
                                            <option value="Deployment Error">Deployment Error</option>
                                            <option value="Design Error">Design Error</option>
                                            <option value="Operation Error">Operation Error</option>
                                            <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            </div>

                            <!-- Employee Details Section -->
                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                    Employee Details
                                    <button type="button" class="submit-btn" onclick="addPublicIpEmployeeEntry()" style="float: right; margin-top: -5px;">
                                        <i class="fas fa-plus"></i> Add Employee
                                    </button>
                                </h4>
                            </div>

                            <div id="publicIpEmployeeContainer">
                                <!-- First employee entry -->
                                <div class="employee-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Name of employee*</label>
                                        <input type="text" name="emp_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">E-mail ID*</label>
                                        <input type="email" name="emp_0_email" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISSP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cissp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cissp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cisa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cisa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISM*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cism" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cism" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">ISO*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_iso" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_iso" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">DISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_disa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_disa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">OSCP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_oscp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_oscp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CEH*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_ceh" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_ceh" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Others</label>
                                        <input type="text" name="emp_0_others" class="form-input" placeholder="Specify other certifications">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                                        <input type="number" name="emp_0_experience" class="form-input" min="0" step="0.5" required>
                                    </div>
                                </div>
                            </div>

                            <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                                <button type="button" class="btn btn-secondary" onclick="closeVaptModal('publicIpFirstAuditMetaDataModal')">Cancel</button>
                                <button type="submit" class="btn btn-primary" id="publicIpFirstAuditMetaDataSubmitBtn">
                                    <i class="fas fa-check"></i> Submit
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Infrastructure Follow Up Audit MetaData Modal -->
            <div id="vaptFollowUpAuditMetaDataModal" class="modal">
                <div class="modal-content" style="max-width: 1000px;">
                    <div class="modal-header">
                        <h3>Follow Up Audit MetaData</h3>
                        <span class="close-modal" onclick="closeVaptModal('vaptFollowUpAuditMetaDataModal')">&times;</span>
                    </div>
                    <div class="modal-body scrollable-content">
                        <form id="vaptFollowUpAuditMetaDataForm" method="POST" onsubmit="handleVaptFollowUpAuditMetaDataSubmit(event)">
                            
                            <!-- Audit Dates -->
                            <div class="form-group">
                                <label for="vaptFollowUpMetaStartDate" class="form-label">Start Audit Date*</label>
                                <input type="date" id="vaptFollowUpMetaStartDate" name="startAuditDate" class="form-input" required>
                            </div>

                            <div class="form-group">
                                <label for="vaptFollowUpMetaEndDate" class="form-label">End Audit Date*</label>
                                <input type="date" id="vaptFollowUpMetaEndDate" name="endAuditDate" class="form-input" required>
                            </div>

                            <!-- Name of Auditee organization -->
                            <div class="form-group">
                                <label for="vaptFollowUpMetaAuditeeOrg" class="form-label">Name of Auditee Organization*</label>
                                <select id="vaptFollowUpMetaAuditeeOrg" name="nameOfAuditeeOrg" class="form-input" required onchange="toggleVaptOtherField('vaptFollowUpMetaAuditeeOrg', 'vaptFollowUpMetaAuditeeOrgOther')">
                                    <option value="">Select Organization</option>
                                    <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                    <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                    <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                    <option value="Megasoft Limited">Megasoft Limited</option>
                                    <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                    <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                    <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                    <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                    <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                    <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                    <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                    <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                    <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                    <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                    <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                    <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                    <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                    <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                    <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                    <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                    <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                    <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                    <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                    <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                    <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                    <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                    <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                    <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                    <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                    <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                    <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                    <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                    <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                    <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                    <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                    <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                    <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                    <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                    <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                    <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                    
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="vaptFollowUpMetaAuditeeOrgOther" name="nameOfAuditeeOrgOther" class="form-input" placeholder="Specify organization name" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Category of Organization -->
                            <div class="form-group">
                                <label for="vaptFollowUpMetaCategoryOrg" class="form-label">Category of Organization*</label>
                                <select id="vaptFollowUpMetaCategoryOrg" name="categoryOfOrg" class="form-input" required>
                                    <option value="">Select Category</option>
                                    <option value="Central Ministry/Department">Central Ministry/Department</option>
                                    <option value="Organization under Government Department">Organization under Government Department</option>
                                    <option value="Private Sector" selected>Private Sector</option>
                                    <option value="Public sector organisations">Public sector organisations</option>
                                    <option value="State Government Department">State Government Department</option>
                                </select>
                            </div>

                            <!-- Sector of Organization -->
                            <div class="form-group">
                                <label for="vaptFollowUpMetaSectorOrg" class="form-label">Sector of Organization*</label>
                                <select id="vaptFollowUpMetaSectorOrg" name="sectorOfOrg" class="form-input" required onchange="updateVaptFollowUpSubSectorOptions()">
                                    <option value="">Select Sector</option>
                                    <option value="Agriculture">Agriculture</option>
                                    <option value="Defence">Defence</option>
                                    <option value="Education">Education</option>
                                    <option value="Energy">Energy</option>
                                    <option value="Finance" selected>Finance</option>
                                    <option value="Healthcare">Healthcare</option>
                                    <option value="Information_and_Broadcasting">Information and Broadcasting</option>
                                    <option value="Information_and_Communication_Technology">Information and Communication Technology</option>
                                    <option value="Law_Enforcement_and_Security">Law Enforcement and Security</option>
                                    <option value="Public_Essential_Services_and_Utilities">Public Essential Services and Utilities</option>
                                    <option value="Space">Space</option>
                                    <option value="Transportation">Transportation</option>
                                </select>
                            </div>

                            <!-- Sub Sector -->
                            <div class="form-group">
                                <label for="vaptFollowUpMetaSubSector" class="form-label">Sub Sector*</label>
                                <select id="vaptFollowUpMetaSubSector" name="subSector" class="form-input" required>
                                    <option value="">Select Sector First</option>
                                </select>
                            </div>

                            <!-- Type of audit -->
                            <div class="form-group">
                                <label for="vaptFollowUpMetaTypeAudit" class="form-label">Type of Audit*</label>
                                <select id="vaptFollowUpMetaTypeAudit" name="typeOfAudit" class="form-input" required onchange="toggleVaptOtherField('vaptFollowUpMetaTypeAudit', 'vaptFollowUpMetaTypeAuditOther')">
                                    <option value="">Select Type</option>
                                    <option value="API Security Audit">API Security Audit</option>
                                    <option value="Cloud Security Audit">Cloud Security Audit</option>
                                    <option value="Compliance to Standard/Framework/Policies Related Audit">Compliance to Standard/Framework/Policies Related Audit</option>
                                    <option value="Digital Forensic Readiness Assessment">Digital Forensic Readiness Assessment</option>
                                    <option value="Industrial Control Systems (ICS) / SCADA Audit">Industrial Control Systems (ICS) / SCADA Audit</option>
                                    <option value="IoT Security Assessment">IoT Security Assessment</option>
                                    <option value="Mobile Application Audit">Mobile Application Audit</option>
                                    <option value="Network Infrastructure Audits">Network Infrastructure Audits</option>
                                    <option value="Process Audit">Process Audit</option>
                                    <option value="Red Team Assessment">Red Team Assessment</option>
                                    <option value="Source Code Review">Source Code Review</option>
                                    <option value="VAPT-Infrastructure" selected>VAPT-Infrastructure</option>
                                    <option value="VAPT-Application">VAPT-Application</option>
                                    <option value="Website /Web Application Audit">Website /Web Application Audit</option>
                                    <option value="Wireless security audit">Wireless security audit</option>
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="vaptFollowUpMetaTypeAuditOther" name="typeOfAuditOther" class="form-input" placeholder="Please specify type of audit" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Details of website/application/infrastructure -->
                            <div class="form-group">
                                <label for="vaptFollowUpMetaDetails" class="form-label">Details of web site/name of application/no. of servers, perimeter devices, other infrastructure*</label>
                                <textarea id="vaptFollowUpMetaDetails" name="detailsOfWebsite" class="form-input" placeholder="Enter details" required rows="3"></textarea>
                            </div>

                            <!-- Reason for conducting Audit -->
                            <div class="form-group">
                                <label for="vaptFollowUpMetaReason" class="form-label">Reason for conducting Audit*</label>
                                <select id="vaptFollowUpMetaReason" name="reasonForAudit" class="form-input" required>
                                    <option value="">Select Reason</option>
                                    <option value="Certificate of compliance like ISO 27001">Certificate of compliance like ISO 27001</option>
                                    <option value="Certificate of safe hosting">Certificate of safe hosting</option>
                                    <option value="Change in process or infrastructure">Change in process or infrastructure</option>
                                    <option value="Government directions">Government directions</option>
                                    <option value="Incident/ Breach in Organisation">Incident/ Breach in Organisation</option>
                                    <option value="Incident/ Breach in Sector">Incident/ Breach in Sector</option>
                                    <option value="New application/ Infrastructure">New application/ Infrastructure</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Periodic Audit as per Policy of organisation.">Periodic Audit as per Policy of organisation.</option>
                                    <option value="Regulatory directions" selected>Regulatory directions</option>
                                    <option value="Third Party Initiated">Third Party Initiated</option>
                                </select>
                            </div>

                            <!-- Standards Used for conducting Audit -->
                            <div class="form-group">
                                <label for="vaptFollowUpMetaStandards" class="form-label">Standards Used for conducting Audit*</label>
                                <input type="text" id="vaptFollowUpMetaStandards" name="standardsUsed" class="form-input" placeholder="Enter standards" required>
                            </div>

                            <!-- Challenges in conducting Audits -->
                            <div class="form-group">
                                <label for="vaptFollowUpMetaChallenges" class="form-label">Challenges in conducting Audits*</label>
                                <textarea id="vaptFollowUpMetaChallenges" name="challenges" class="form-input" placeholder="Enter challenges" required rows="3"></textarea>
                            </div>

                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Compliance Questions</h4>
                            </div>

                            <!-- Compliance questions -->
                            <div class="form-group">
                                <label for="vaptFollowUpMetaCompFinancial" class="form-label">Compliance to financial sector regulatory bodies guidelines/circulars/directions like from RBI, IRDAI, SEBI, NPCI*</label>
                                <select id="vaptFollowUpMetaCompFinancial" name="complianceFinancial" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="vaptFollowUpMetaCompRegulatory" class="form-label">Compliance to regulatory bodies guidelines/circulars/directions like from UIDAI, CCA, DoT, TRAI*</label>
                                <select id="vaptFollowUpMetaCompRegulatory" name="complianceRegulatory" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="vaptFollowUpMetaCompCertIn" class="form-label">Compliance to CERT-In directions under sub-section (6) of section 70B of the IT Act, 2000 dated 28 April, 2022*</label>
                                <select id="vaptFollowUpMetaCompCertIn" name="complianceCertIn" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="vaptFollowUpMetaCompCEA" class="form-label">Compliance to CEA (Cyber Security in Power Sector) guidelines 2021*</label>
                                <select id="vaptFollowUpMetaCompCEA" name="complianceCEA" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="vaptFollowUpMetaCompOther" class="form-label">Any other domestic regulation, directions, guidelines (Please Specify)*</label>
                                <select id="vaptFollowUpMetaCompOther" name="complianceOther" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No" selected>No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <!-- Type of Audit Report -->
                            <div class="form-group">
                                <label for="vaptFollowUpMetaTypeReport" class="form-label">Type of Audit Report*</label>
                                <select id="vaptFollowUpMetaTypeReport" name="typeOfAuditReport" class="form-input" required>
                                    <option value="">Select Type</option>
                                    <option value="First Audit Report">First Audit Report</option>
                                    <option value="Follow up Audit Report" selected>Follow up Audit Report</option>
                                </select>
                            </div>

                            <!-- No. of vulnerabilities -->
                            <div class="form-group">
                                <label for="vaptFollowUpMetaNumVuln" class="form-label">No. of vulnerabilities/ security issues reported during FIRST Audit*</label>
                                <input type="number" id="vaptFollowUpMetaNumVuln" name="numVulnerabilities" class="form-input" placeholder="Enter number" min="0" required>
                            </div>

                            <!-- No. of days taken to patch -->
                            <div class="form-group">
                                <label for="vaptFollowUpMetaDaysPatch" class="form-label">No. of days taken by Client to patch the vulnerabilities after submission of Audit report*</label>
                                <select id="vaptFollowUpMetaDaysPatch" name="numDaysToPatch" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Follow up audit not performed">Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- Duration between audits -->
                            <div class="form-group">
                                <label for="vaptFollowUpMetaDuration" class="form-label">Durations (in days) between end of FIRST audit and start of FOLLOW-UP/SECOND audit*</label>
                                <select id="vaptFollowUpMetaDuration" name="durationBetweenAudits" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed">Follow up audit not performed</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- No. of open issues -->
                            <div class="form-group">
                                <label for="vaptFollowUpMetaOpenIssues" class="form-label">No. of open issues after follow-up audits*</label>
                                <select id="vaptFollowUpMetaOpenIssues" name="numOpenIssues" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed">Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="0">0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="101">101</option>
                                    <option value="102">102</option>
                                    <option value="103">103</option>
                                    <option value="104">104</option>
                                    <option value="105">105</option>
                                    <option value="106">106</option>
                                    <option value="107">107</option>
                                    <option value="108">108</option>
                                    <option value="109">109</option>
                                    <option value="110">110</option>
                                    <option value="111">111</option>
                                    <option value="112">112</option>
                                    <option value="113">113</option>
                                    <option value="114">114</option>
                                    <option value="115">115</option>
                                    <option value="116">116</option>
                                    <option value="117">117</option>
                                    <option value="118">118</option>
                                    <option value="119">119</option>
                                    <option value="120">120</option>
                                    <option value="121">121</option>
                                    <option value="122">122</option>
                                    <option value="123">123</option>
                                    <option value="124">124</option>
                                    <option value="125">125</option>
                                    <option value="126">126</option>
                                    <option value="127">127</option>
                                    <option value="128">128</option>
                                    <option value="129">129</option>
                                    <option value="130">130</option>
                                    <option value="131">131</option>
                                    <option value="132">132</option>
                                    <option value="133">133</option>
                                    <option value="134">134</option>
                                    <option value="135">135</option>
                                    <option value="136">136</option>
                                    <option value="137">137</option>
                                    <option value="138">138</option>
                                    <option value="139">139</option>
                                    <option value="140">140</option>
                                    <option value="141">141</option>
                                    <option value="142">142</option>
                                    <option value="143">143</option>
                                    <option value="144">144</option>
                                    <option value="145">145</option>
                                    <option value="146">146</option>
                                    <option value="147">147</option>
                                    <option value="148">148</option>
                                    <option value="149">149</option>
                                    <option value="150">150</option>
                                    <option value="151">151</option>
                                    <option value="152">152</option>
                                    <option value="153">153</option>
                                    <option value="154">154</option>
                                    <option value="155">155</option>
                                    <option value="156">156</option>
                                    <option value="157">157</option>
                                    <option value="158">158</option>
                                    <option value="159">159</option>
                                    <option value="160">160</option>
                                    <option value="161">161</option>
                                    <option value="162">162</option>
                                    <option value="163">163</option>
                                    <option value="164">164</option>
                                    <option value="165">165</option>
                                    <option value="166">166</option>
                                    <option value="167">167</option>
                                    <option value="168">168</option>
                                    <option value="169">169</option>
                                    <option value="170">170</option>
                                    <option value="171">171</option>
                                    <option value="172">172</option>
                                    <option value="173">173</option>
                                    <option value="174">174</option>
                                    <option value="175">175</option>
                                    <option value="176">176</option>
                                    <option value="177">177</option>
                                    <option value="178">178</option>
                                    <option value="179">179</option>
                                    <option value="180">180</option>
                                    <option value="More than 180">More than 180</option>
                                </select>
                            </div>

                            <!-- Geographical detail -->
                            <div class="form-group">
                                <label for="vaptFollowUpMetaGeoState" class="form-label">Geographical detail of Client (State/UT)*</label>
                                <select id="vaptFollowUpMetaGeoState" name="geographicalState" class="form-input" required>
                                    <option value="">Select State/UT</option>
                                    <option value="Andhra Pradesh">Andhra Pradesh</option>
                                    <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                    <option value="Assam">Assam</option>
                                    <option value="Bihar">Bihar</option>
                                    <option value="Chhattisgarh">Chhattisgarh</option>
                                    <option value="Goa">Goa</option>
                                    <option value="Gujarat">Gujarat</option>
                                    <option value="Haryana">Haryana</option>
                                    <option value="Himachal Pradesh">Himachal Pradesh</option>
                                    <option value="Jharkhand">Jharkhand</option>
                                    <option value="Karnataka">Karnataka</option>
                                    <option value="Kerala">Kerala</option>
                                    <option value="Madhya Pradesh">Madhya Pradesh</option>
                                    <option value="Maharashtra">Maharashtra</option>
                                    <option value="Manipur">Manipur</option>
                                    <option value="Meghalaya">Meghalaya</option>
                                    <option value="Mizoram">Mizoram</option>
                                    <option value="Nagaland">Nagaland</option>
                                    <option value="Odisha">Odisha</option>
                                    <option value="Punjab">Punjab</option>
                                    <option value="Rajasthan">Rajasthan</option>
                                    <option value="Sikkim">Sikkim</option>
                                    <option value="Tamil Nadu">Tamil Nadu</option>
                                    <option value="Telangana">Telangana</option>
                                    <option value="Tripura">Tripura</option>
                                    <option value="Uttar Pradesh">Uttar Pradesh</option>
                                    <option value="Uttarakhand">Uttarakhand</option>
                                    <option value="West Bengal">West Bengal</option>

                                    <!-- Union Territories -->
                                    <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                    <option value="Chandigarh">Chandigarh</option>
                                    <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                    <option value="Delhi">Delhi</option>
                                    <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                    <option value="Ladakh">Ladakh</option>
                                    <option value="Lakshadweep">Lakshadweep</option>
                                    <option value="Puducherry">Puducherry</option>

                                </select>
                            </div>

                            <!-- Date of Audit Completion -->
                            <div class="form-group">
                                <label for="vaptFollowUpMetaDateCompletion" class="form-label">Date of Audit Completion*</label>
                                <input type="date" id="vaptFollowUpMetaDateCompletion" name="dateAuditCompletion" class="form-input" required>
                            </div>

                            <!-- Date of last audit -->
                            <div class="form-group">
                                <label for="vaptFollowUpMetaDateLastAudit" class="form-label">Date of last audit of same infrastructure*</label>
                                <input type="date" id="vaptFollowUpMetaDateLastAudit" name="dateLastAudit" class="form-input" required>
                            </div>

                            <!-- Vulnerability Status Radio Buttons -->
                            <div class="form-group">
                                <label class="form-label" style="margin-bottom: 10px;">Vulnerability Status*</label>
                                <div style="display: flex; gap: 30px; margin-top: 10px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="0" required onchange="toggleVaptFollowUpVulnerabilitySection()" style="width: auto;">
                                        <span>0 Vulnerability</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="has" required onchange="toggleVaptFollowUpVulnerabilitySection()" style="width: auto;">
                                        <span>Has Vulnerability</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Vulnerability Details Section -->
                            <div id="vaptFollowUpVulnerabilitySection" style="display: none;">
                                <div class="form-group">
                                    <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                        Audited Infrastructure Details
                                        <button type="button" class="submit-btn" onclick="addVaptFollowUpVulnerabilityEntry()" style="float: right; margin-top: -5px;">
                                            <i class="fas fa-plus"></i> Add Entry
                                        </button>
                                    </h4>
                                </div>

                                <div id="vaptFollowUpVulnerabilityContainer">
                                <!-- First vulnerability entry -->
                                <div class="vulnerability-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Audited infrastructure details*</label>
                                        <input type="text" name="vuln_0_infrastructure" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                                        <input type="text" name="vuln_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CVE/CWE Reference Number*</label>
                                        <input type="text" name="vuln_0_cve" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Severity of Issue*</label>
                                        <select name="vuln_0_severity" class="form-input" required>
                                            <option value="">Select Severity</option>
                                            <option value="Critical">Critical</option>
                                            <option value="High">High</option>
                                            <option value="Medium">Medium</option>
                                            <option value="Low">Low</option>
                                            <option value="Informational">Informational</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                                        <input type="number" name="vuln_0_count" class="form-input" min="0" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Attributing Factor*</label>
                                        <select name="vuln_0_factor" class="form-input" required>
                                            <option value="">Select Factor</option>
                                            <option value="Coding Error">Coding Error</option>
                                            <option value="Configuration Error">Configuration Error</option>
                                            <option value="Deployment Error">Deployment Error</option>
                                            <option value="Design Error">Design Error</option>
                                            <option value="Operation Error">Operation Error</option>
                                            <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            </div>

                            <!-- Employee Details Section -->
                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                    Employee Details
                                    <button type="button" class="submit-btn" onclick="addVaptFollowUpEmployeeEntry()" style="float: right; margin-top: -5px;">
                                        <i class="fas fa-plus"></i> Add Employee
                                    </button>
                                </h4>
                            </div>

                            <div id="vaptFollowUpEmployeeContainer">
                                <!-- First employee entry -->
                                <div class="employee-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Name of employee*</label>
                                        <input type="text" name="emp_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">E-mail ID*</label>
                                        <input type="email" name="emp_0_email" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISSP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cissp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cissp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cisa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cisa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISM*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cism" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cism" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">ISO*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_iso" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_iso" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">DISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_disa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_disa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">OSCP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_oscp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_oscp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CEH*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_ceh" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_ceh" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Others</label>
                                        <input type="text" name="emp_0_others" class="form-input" placeholder="Specify other certifications">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                                        <input type="number" name="emp_0_experience" class="form-input" min="0" step="0.5" required>
                                    </div>
                                </div>
                            </div>

                            <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                                <button type="button" class="btn btn-secondary" onclick="closeVaptModal('vaptFollowUpAuditMetaDataModal')">Cancel</button>
                                <button type="submit" class="btn btn-primary" id="vaptFollowUpAuditMetaDataSubmitBtn">
                                    <i class="fas fa-check"></i> Submit
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Web Application Follow Up Audit MetaData Modal -->
            <div id="webAppVaptFollowUpAuditMetaDataModal" class="modal">
                <div class="modal-content" style="max-width: 1000px;">
                    <div class="modal-header">
                        <h3> Web Application Follow Up Audit MetaData</h3>
                        <span class="close-modal" onclick="closeVaptModal('webAppVaptFollowUpAuditMetaDataModal')">&times;</span>
                    </div>
                    <div class="modal-body scrollable-content">
                        <form id="webAppVaptFollowUpAuditMetaDataForm" method="POST" onsubmit="handleWebAppVaptFollowUpAuditMetaDataSubmit(event)">
                            
                            <!-- Audit Dates -->
                            <div class="form-group">
                                <label for="webAppVaptFollowUpMetaStartDate" class="form-label">Start Audit Date*</label>
                                <input type="date" id="webAppVaptFollowUpMetaStartDate" name="startAuditDate" class="form-input" required>
                            </div>

                            <div class="form-group">
                                <label for="webAppVaptFollowUpMetaEndDate" class="form-label">End Audit Date*</label>
                                <input type="date" id="webAppVaptFollowUpMetaEndDate" name="endAuditDate" class="form-input" required>
                            </div>

                            <!-- Name of Auditee organization -->
                            <div class="form-group">
                                <label for="webAppVaptFollowUpMetaAuditeeOrg" class="form-label">Name of Auditee Organization*</label>
                                <select id="webAppVaptFollowUpMetaAuditeeOrg" name="nameOfAuditeeOrg" class="form-input" required onchange="toggleWebAppVaptFollowUpOtherField('webAppVaptFollowUpMetaAuditeeOrg', 'webAppVaptFollowUpMetaAuditeeOrgOther')">
                                    <option value="">Select Organization</option>
                                    <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                    <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                    <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                    <option value="Megasoft Limited">Megasoft Limited</option>
                                    <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                    <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                    <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                    <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                    <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                    <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                    <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                    <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                    <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                    <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                    <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                    <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                    <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                    <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                    <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                    <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                    <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                    <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                    <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                    <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                    <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                    <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                    <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                    <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                    <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                    <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                    <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                    <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                    <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                    <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                    <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                    <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                    <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                    <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                    <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                    <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                    
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="webAppVaptFollowUpMetaAuditeeOrgOther" name="nameOfAuditeeOrgOther" class="form-input" placeholder="Specify organization name" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Category of Organization -->
                            <div class="form-group">
                                <label for="webAppVaptFollowUpMetaCategoryOrg" class="form-label">Category of Organization*</label>
                                <select id="webAppVaptFollowUpMetaCategoryOrg" name="categoryOfOrg" class="form-input" required>
                                    <option value="">Select Category</option>
                                    <option value="Central Ministry/Department">Central Ministry/Department</option>
                                    <option value="Organization under Government Department">Organization under Government Department</option>
                                    <option value="Private Sector" selected>Private Sector</option>
                                    <option value="Public sector organisations">Public sector organisations</option>
                                    <option value="State Government Department">State Government Department</option>
                                </select>
                            </div>

                            <!-- Sector of Organization -->
                            <div class="form-group">
                                <label for="webAppVaptFollowUpMetaSectorOrg" class="form-label">Sector of Organization*</label>
                                <select id="webAppVaptFollowUpMetaSectorOrg" name="sectorOfOrg" class="form-input" required onchange="updateWebAppVaptFollowUpSubSectorOptions()">
                                    <option value="">Select Sector</option>
                                    <option value="Agriculture">Agriculture</option>
                                    <option value="Defence">Defence</option>
                                    <option value="Education">Education</option>
                                    <option value="Energy">Energy</option>
                                    <option value="Finance" selected>Finance</option>
                                    <option value="Healthcare">Healthcare</option>
                                    <option value="Information_and_Broadcasting">Information and Broadcasting</option>
                                    <option value="Information_and_Communication_Technology">Information and Communication Technology</option>
                                    <option value="Law_Enforcement_and_Security">Law Enforcement and Security</option>
                                    <option value="Public_Essential_Services_and_Utilities">Public Essential Services and Utilities</option>
                                    <option value="Space">Space</option>
                                    <option value="Transportation">Transportation</option>
                                </select>
                            </div>

                            <!-- Sub Sector -->
                            <div class="form-group">
                                <label for="webAppVaptFollowUpMetaSubSector" class="form-label">Sub Sector*</label>
                                <select id="webAppVaptFollowUpMetaSubSector" name="subSector" class="form-input" required>
                                    <option value="">Select Sector First</option>
                                </select>
                            </div>

                            <!-- Type of audit -->
                            <div class="form-group">
                                <label for="webAppVaptFollowUpMetaTypeAudit" class="form-label">Type of Audit*</label>
                                <select id="webAppVaptFollowUpMetaTypeAudit" name="typeOfAudit" class="form-input" required onchange="toggleWebAppVaptFollowUpOtherField('webAppVaptFollowUpMetaTypeAudit', 'webAppVaptFollowUpMetaTypeAuditOther')">
                                    <option value="">Select Type</option>
                                    <option value="API Security Audit">API Security Audit</option>
                                    <option value="Cloud Security Audit">Cloud Security Audit</option>
                                    <option value="Compliance to Standard/Framework/Policies Related Audit">Compliance to Standard/Framework/Policies Related Audit</option>
                                    <option value="Digital Forensic Readiness Assessment">Digital Forensic Readiness Assessment</option>
                                    <option value="Industrial Control Systems (ICS) / SCADA Audit">Industrial Control Systems (ICS) / SCADA Audit</option>
                                    <option value="IoT Security Assessment">IoT Security Assessment</option>
                                    <option value="Mobile Application Audit">Mobile Application Audit</option>
                                    <option value="Network Infrastructure Audits">Network Infrastructure Audits</option>
                                    <option value="Process Audit">Process Audit</option>
                                    <option value="Red Team Assessment">Red Team Assessment</option>
                                    <option value="Source Code Review">Source Code Review</option>
                                    <option value="VAPT-Infrastructure" selected>VAPT-Infrastructure</option>
                                    <option value="VAPT-Application">VAPT-Application</option>
                                    <option value="Website /Web Application Audit">Website /Web Application Audit</option>
                                    <option value="Wireless security audit">Wireless security audit</option>
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="webAppVaptFollowUpMetaTypeAuditOther" name="typeOfAuditOther" class="form-input" placeholder="Please specify type of audit" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Details of website/application/infrastructure -->
                            <div class="form-group">
                                <label for="webAppVaptFollowUpMetaDetails" class="form-label">Details of web site/name of application/no. of servers, perimeter devices, other infrastructure*</label>
                                <textarea id="webAppVaptFollowUpMetaDetails" name="detailsOfWebsite" class="form-input" placeholder="Enter details" required rows="3"></textarea>
                            </div>

                            <!-- Reason for conducting Audit -->
                            <div class="form-group">
                                <label for="webAppVaptFollowUpMetaReason" class="form-label">Reason for conducting Audit*</label>
                                <select id="webAppVaptFollowUpMetaReason" name="reasonForAudit" class="form-input" required>
                                    <option value="">Select Reason</option>
                                    <option value="Certificate of compliance like ISO 27001">Certificate of compliance like ISO 27001</option>
                                    <option value="Certificate of safe hosting">Certificate of safe hosting</option>
                                    <option value="Change in process or infrastructure">Change in process or infrastructure</option>
                                    <option value="Government directions">Government directions</option>
                                    <option value="Incident/ Breach in Organisation">Incident/ Breach in Organisation</option>
                                    <option value="Incident/ Breach in Sector">Incident/ Breach in Sector</option>
                                    <option value="New application/ Infrastructure">New application/ Infrastructure</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Periodic Audit as per Policy of organisation.">Periodic Audit as per Policy of organisation.</option>
                                    <option value="Regulatory directions" selected>Regulatory directions</option>
                                    <option value="Third Party Initiated">Third Party Initiated</option>
                                </select>
                            </div>

                            <!-- Standards Used for conducting Audit -->
                            <div class="form-group">
                                <label for="webAppVaptFollowUpMetaStandards" class="form-label">Standards Used for conducting Audit*</label>
                                <input type="text" id="webAppVaptFollowUpMetaStandards" name="standardsUsed" class="form-input" placeholder="Enter standards" required>
                            </div>

                            <!-- Challenges in conducting Audits -->
                            <div class="form-group">
                                <label for="webAppVaptFollowUpMetaChallenges" class="form-label">Challenges in conducting Audits*</label>
                                <textarea id="webAppVaptFollowUpMetaChallenges" name="challenges" class="form-input" placeholder="Enter challenges" required rows="3"></textarea>
                            </div>

                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Compliance Questions</h4>
                            </div>

                            <!-- Compliance questions -->
                            <div class="form-group">
                                <label for="webAppVaptFollowUpMetaCompFinancial" class="form-label">Compliance to financial sector regulatory bodies guidelines/circulars/directions like from RBI, IRDAI, SEBI, NPCI*</label>
                                <select id="webAppVaptFollowUpMetaCompFinancial" name="complianceFinancial" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="webAppVaptFollowUpMetaCompRegulatory" class="form-label">Compliance to regulatory bodies guidelines/circulars/directions like from UIDAI, CCA, DoT, TRAI*</label>
                                <select id="webAppVaptFollowUpMetaCompRegulatory" name="complianceRegulatory" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="webAppVaptFollowUpMetaCompCertIn" class="form-label">Compliance to CERT-In directions under sub-section (6) of section 70B of the IT Act, 2000 dated 28 April, 2022*</label>
                                <select id="webAppVaptFollowUpMetaCompCertIn" name="complianceCertIn" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="webAppVaptFollowUpMetaCompCEA" class="form-label">Compliance to CEA (Cyber Security in Power Sector) guidelines 2021*</label>
                                <select id="webAppVaptFollowUpMetaCompCEA" name="complianceCEA" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="webAppVaptFollowUpMetaCompOther" class="form-label">Any other domestic regulation, directions, guidelines (Please Specify)*</label>
                                <select id="webAppVaptFollowUpMetaCompOther" name="complianceOther" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No" selected>No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <!-- Type of Audit Report -->
                            <div class="form-group">
                                <label for="webAppVaptFollowUpMetaTypeReport" class="form-label">Type of Audit Report*</label>
                                <select id="webAppVaptFollowUpMetaTypeReport" name="typeOfAuditReport" class="form-input" required>
                                    <option value="">Select Type</option>
                                    <option value="First Audit Report">First Audit Report</option>
                                    <option value="Follow up Audit Report" selected>Follow up Audit Report</option>
                                </select>
                            </div>

                            <!-- No. of vulnerabilities -->
                            <div class="form-group">
                                <label for="webAppVaptFollowUpMetaNumVuln" class="form-label">No. of vulnerabilities/ security issues reported during FIRST Audit*</label>
                                <input type="number" id="webAppVaptFollowUpMetaNumVuln" name="numVulnerabilities" class="form-input" placeholder="Enter number" min="0" required>
                            </div>

                            <!-- No. of days taken to patch -->
                            <div class="form-group">
                                <label for="webAppVaptFollowUpMetaDaysPatch" class="form-label">No. of days taken by Client to patch the vulnerabilities after submission of Audit report*</label>
                                <select id="webAppVaptFollowUpMetaDaysPatch" name="numDaysToPatch" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Follow up audit not performed">Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- Duration between audits -->
                            <div class="form-group">
                                <label for="webAppVaptFollowUpMetaDuration" class="form-label">Durations (in days) between end of FIRST audit and start of FOLLOW-UP/SECOND audit*</label>
                                <select id="webAppVaptFollowUpMetaDuration" name="durationBetweenAudits" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed">Follow up audit not performed</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- No. of open issues -->
                            <div class="form-group">
                                <label for="webAppVaptFollowUpMetaOpenIssues" class="form-label">No. of open issues after follow-up audits*</label>
                                <select id="webAppVaptFollowUpMetaOpenIssues" name="numOpenIssues" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed">Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="0">0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="101">101</option>
                                    <option value="102">102</option>
                                    <option value="103">103</option>
                                    <option value="104">104</option>
                                    <option value="105">105</option>
                                    <option value="106">106</option>
                                    <option value="107">107</option>
                                    <option value="108">108</option>
                                    <option value="109">109</option>
                                    <option value="110">110</option>
                                    <option value="111">111</option>
                                    <option value="112">112</option>
                                    <option value="113">113</option>
                                    <option value="114">114</option>
                                    <option value="115">115</option>
                                    <option value="116">116</option>
                                    <option value="117">117</option>
                                    <option value="118">118</option>
                                    <option value="119">119</option>
                                    <option value="120">120</option>
                                    <option value="121">121</option>
                                    <option value="122">122</option>
                                    <option value="123">123</option>
                                    <option value="124">124</option>
                                    <option value="125">125</option>
                                    <option value="126">126</option>
                                    <option value="127">127</option>
                                    <option value="128">128</option>
                                    <option value="129">129</option>
                                    <option value="130">130</option>
                                    <option value="131">131</option>
                                    <option value="132">132</option>
                                    <option value="133">133</option>
                                    <option value="134">134</option>
                                    <option value="135">135</option>
                                    <option value="136">136</option>
                                    <option value="137">137</option>
                                    <option value="138">138</option>
                                    <option value="139">139</option>
                                    <option value="140">140</option>
                                    <option value="141">141</option>
                                    <option value="142">142</option>
                                    <option value="143">143</option>
                                    <option value="144">144</option>
                                    <option value="145">145</option>
                                    <option value="146">146</option>
                                    <option value="147">147</option>
                                    <option value="148">148</option>
                                    <option value="149">149</option>
                                    <option value="150">150</option>
                                    <option value="151">151</option>
                                    <option value="152">152</option>
                                    <option value="153">153</option>
                                    <option value="154">154</option>
                                    <option value="155">155</option>
                                    <option value="156">156</option>
                                    <option value="157">157</option>
                                    <option value="158">158</option>
                                    <option value="159">159</option>
                                    <option value="160">160</option>
                                    <option value="161">161</option>
                                    <option value="162">162</option>
                                    <option value="163">163</option>
                                    <option value="164">164</option>
                                    <option value="165">165</option>
                                    <option value="166">166</option>
                                    <option value="167">167</option>
                                    <option value="168">168</option>
                                    <option value="169">169</option>
                                    <option value="170">170</option>
                                    <option value="171">171</option>
                                    <option value="172">172</option>
                                    <option value="173">173</option>
                                    <option value="174">174</option>
                                    <option value="175">175</option>
                                    <option value="176">176</option>
                                    <option value="177">177</option>
                                    <option value="178">178</option>
                                    <option value="179">179</option>
                                    <option value="180">180</option>
                                    <option value="More than 180">More than 180</option>
                                </select>
                            </div>

                            <!-- Geographical detail -->
                            <div class="form-group">
                                <label for="webAppVaptFollowUpMetaGeoState" class="form-label">Geographical detail of Client (State/UT)*</label>
                                <select id="webAppVaptFollowUpMetaGeoState" name="geographicalState" class="form-input" required>
                                    <option value="">Select State/UT</option>
                                    <option value="Andhra Pradesh">Andhra Pradesh</option>
                                    <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                    <option value="Assam">Assam</option>
                                    <option value="Bihar">Bihar</option>
                                    <option value="Chhattisgarh">Chhattisgarh</option>
                                    <option value="Goa">Goa</option>
                                    <option value="Gujarat">Gujarat</option>
                                    <option value="Haryana">Haryana</option>
                                    <option value="Himachal Pradesh">Himachal Pradesh</option>
                                    <option value="Jharkhand">Jharkhand</option>
                                    <option value="Karnataka">Karnataka</option>
                                    <option value="Kerala">Kerala</option>
                                    <option value="Madhya Pradesh">Madhya Pradesh</option>
                                    <option value="Maharashtra">Maharashtra</option>
                                    <option value="Manipur">Manipur</option>
                                    <option value="Meghalaya">Meghalaya</option>
                                    <option value="Mizoram">Mizoram</option>
                                    <option value="Nagaland">Nagaland</option>
                                    <option value="Odisha">Odisha</option>
                                    <option value="Punjab">Punjab</option>
                                    <option value="Rajasthan">Rajasthan</option>
                                    <option value="Sikkim">Sikkim</option>
                                    <option value="Tamil Nadu">Tamil Nadu</option>
                                    <option value="Telangana">Telangana</option>
                                    <option value="Tripura">Tripura</option>
                                    <option value="Uttar Pradesh">Uttar Pradesh</option>
                                    <option value="Uttarakhand">Uttarakhand</option>
                                    <option value="West Bengal">West Bengal</option>

                                    <!-- Union Territories -->
                                    <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                    <option value="Chandigarh">Chandigarh</option>
                                    <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                    <option value="Delhi">Delhi</option>
                                    <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                    <option value="Ladakh">Ladakh</option>
                                    <option value="Lakshadweep">Lakshadweep</option>
                                    <option value="Puducherry">Puducherry</option>

                                </select>
                            </div>

                            <!-- Date of Audit Completion -->
                            <div class="form-group">
                                <label for="webAppVaptFollowUpMetaDateCompletion" class="form-label">Date of Audit Completion*</label>
                                <input type="date" id="webAppVaptFollowUpMetaDateCompletion" name="dateAuditCompletion" class="form-input" required>
                            </div>

                            <!-- Date of last audit -->
                            <div class="form-group">
                                <label for="webAppVaptFollowUpMetaDateLastAudit" class="form-label">Date of last audit of same infrastructure*</label>
                                <input type="date" id="webAppVaptFollowUpMetaDateLastAudit" name="dateLastAudit" class="form-input" required>
                            </div>

                            <!-- Vulnerability Status Radio Buttons -->
                            <div class="form-group">
                                <label class="form-label" style="margin-bottom: 10px;">Vulnerability Status*</label>
                                <div style="display: flex; gap: 30px; margin-top: 10px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="0" required onchange="toggleWebAppVaptFollowUpVulnerabilitySection()" style="width: auto;">
                                        <span>0 Vulnerability</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="has" required onchange="toggleWebAppVaptFollowUpVulnerabilitySection()" style="width: auto;">
                                        <span>Has Vulnerability</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Vulnerability Details Section -->
                            <div id="webAppVaptFollowUpVulnerabilitySection" style="display: none;">
                                <div class="form-group">
                                    <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                        Audited Infrastructure Details
                                        <button type="button" class="submit-btn" onclick="addWebAppVaptFollowUpVulnerabilityEntry()" style="float: right; margin-top: -5px;">
                                            <i class="fas fa-plus"></i> Add Entry
                                        </button>
                                    </h4>
                                </div>

                                <div id="webAppVaptFollowUpVulnerabilityContainer">
                                <!-- First vulnerability entry -->
                                <div class="vulnerability-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Audited infrastructure details*</label>
                                        <input type="text" name="vuln_0_infrastructure" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                                        <input type="text" name="vuln_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CVE/CWE Reference Number*</label>
                                        <input type="text" name="vuln_0_cve" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Severity of Issue*</label>
                                        <select name="vuln_0_severity" class="form-input" required>
                                            <option value="">Select Severity</option>
                                            <option value="Critical">Critical</option>
                                            <option value="High">High</option>
                                            <option value="Medium">Medium</option>
                                            <option value="Low">Low</option>
                                            <option value="Informational">Informational</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                                        <input type="number" name="vuln_0_count" class="form-input" min="0" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Attributing Factor*</label>
                                        <select name="vuln_0_factor" class="form-input" required>
                                            <option value="">Select Factor</option>
                                            <option value="Coding Error">Coding Error</option>
                                            <option value="Configuration Error">Configuration Error</option>
                                            <option value="Deployment Error">Deployment Error</option>
                                            <option value="Design Error">Design Error</option>
                                            <option value="Operation Error">Operation Error</option>
                                            <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            </div>

                            <!-- Employee Details Section -->
                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                    Employee Details
                                    <button type="button" class="submit-btn" onclick="addWebAppVaptFollowUpEmployeeEntry()" style="float: right; margin-top: -5px;">
                                        <i class="fas fa-plus"></i> Add Employee
                                    </button>
                                </h4>
                            </div>

                            <div id="webAppVaptFollowUpEmployeeContainer">
                                <!-- First employee entry -->
                                <div class="employee-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Name of employee*</label>
                                        <input type="text" name="emp_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">E-mail ID*</label>
                                        <input type="email" name="emp_0_email" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISSP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cissp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cissp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cisa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cisa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISM*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cism" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cism" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">ISO*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_iso" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_iso" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">DISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_disa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_disa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">OSCP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_oscp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_oscp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CEH*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_ceh" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_ceh" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Others</label>
                                        <input type="text" name="emp_0_others" class="form-input" placeholder="Specify other certifications">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                                        <input type="number" name="emp_0_experience" class="form-input" min="0" step="0.5" required>
                                    </div>
                                </div>
                            </div>

                            <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                                <button type="button" class="btn btn-secondary" onclick="closeVaptModal('webAppVaptFollowUpAuditMetaDataModal')">Cancel</button>
                                <button type="submit" class="btn btn-primary" id="webAppVaptFollowUpAuditMetaDataSubmitBtn">
                                    <i class="fas fa-check"></i> Submit
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Android Mobile Application Follow Up Audit MetaData Modal -->
            <div id="androidVaptFollowUpAuditMetaDataModal" class="modal">
                <div class="modal-content" style="max-width: 1000px;">
                    <div class="modal-header">
                        <h3>Anroid Mobile Application Follow Up Audit MetaData</h3>
                        <span class="close-modal" onclick="closeVaptModal('androidVaptFollowUpAuditMetaDataModal')">&times;</span>
                    </div>
                    <div class="modal-body scrollable-content">
                        <form id="androidVaptFollowUpAuditMetaDataForm" method="POST" onsubmit="handleAndroidVaptFollowUpAuditMetaDataSubmit(event)">
                            
                            <!-- Audit Dates -->
                            <div class="form-group">
                                <label for="androidVaptFollowUpMetaStartDate" class="form-label">Start Audit Date*</label>
                                <input type="date" id="androidVaptFollowUpMetaStartDate" name="startAuditDate" class="form-input" required>
                            </div>

                            <div class="form-group">
                                <label for="androidVaptFollowUpMetaEndDate" class="form-label">End Audit Date*</label>
                                <input type="date" id="androidVaptFollowUpMetaEndDate" name="endAuditDate" class="form-input" required>
                            </div>

                            <!-- Name of Auditee organization -->
                            <div class="form-group">
                                <label for="androidVaptFollowUpMetaAuditeeOrg" class="form-label">Name of Auditee Organization*</label>
                                <select id="androidVaptFollowUpMetaAuditeeOrg" name="nameOfAuditeeOrg" class="form-input" required onchange="toggleAndroidVaptFollowUpOtherField('androidVaptFollowUpMetaAuditeeOrg', 'androidVaptFollowUpMetaAuditeeOrgOther')">
                                    <option value="">Select Organization</option>
                                    <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                    <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                    <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                    <option value="Megasoft Limited">Megasoft Limited</option>
                                    <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                    <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                    <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                    <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                    <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                    <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                    <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                    <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                    <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                    <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                    <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                    <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                    <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                    <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                    <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                    <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                    <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                    <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                    <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                    <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                    <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                    <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                    <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                    <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                    <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                    <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                    <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                    <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                    <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                    <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                    <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                    <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                    <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                    <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                    <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                    <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                    
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="androidVaptFollowUpMetaAuditeeOrgOther" name="nameOfAuditeeOrgOther" class="form-input" placeholder="Specify organization name" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Category of Organization -->
                            <div class="form-group">
                                <label for="androidVaptFollowUpMetaCategoryOrg" class="form-label">Category of Organization*</label>
                                <select id="androidVaptFollowUpMetaCategoryOrg" name="categoryOfOrg" class="form-input" required>
                                    <option value="">Select Category</option>
                                    <option value="Central Ministry/Department">Central Ministry/Department</option>
                                    <option value="Organization under Government Department">Organization under Government Department</option>
                                    <option value="Private Sector" selected>Private Sector</option>
                                    <option value="Public sector organisations">Public sector organisations</option>
                                    <option value="State Government Department">State Government Department</option>
                                </select>
                            </div>

                            <!-- Sector of Organization -->
                            <div class="form-group">
                                <label for="androidVaptFollowUpMetaSectorOrg" class="form-label">Sector of Organization*</label>
                                <select id="androidVaptFollowUpMetaSectorOrg" name="sectorOfOrg" class="form-input" required onchange="updateAndroidVaptFollowUpSubSectorOptions()">
                                    <option value="">Select Sector</option>
                                    <option value="Agriculture">Agriculture</option>
                                    <option value="Defence">Defence</option>
                                    <option value="Education">Education</option>
                                    <option value="Energy">Energy</option>
                                    <option value="Finance" selected>Finance</option>
                                    <option value="Healthcare">Healthcare</option>
                                    <option value="Information_and_Broadcasting">Information and Broadcasting</option>
                                    <option value="Information_and_Communication_Technology">Information and Communication Technology</option>
                                    <option value="Law_Enforcement_and_Security">Law Enforcement and Security</option>
                                    <option value="Public_Essential_Services_and_Utilities">Public Essential Services and Utilities</option>
                                    <option value="Space">Space</option>
                                    <option value="Transportation">Transportation</option>
                                </select>
                            </div>

                            <!-- Sub Sector -->
                            <div class="form-group">
                                <label for="androidVaptFollowUpMetaSubSector" class="form-label">Sub Sector*</label>
                                <select id="androidVaptFollowUpMetaSubSector" name="subSector" class="form-input" required>
                                    <option value="">Select Sector First</option>
                                </select>
                            </div>

                            <!-- Type of audit -->
                            <div class="form-group">
                                <label for="androidVaptFollowUpMetaTypeAudit" class="form-label">Type of Audit*</label>
                                <select id="androidVaptFollowUpMetaTypeAudit" name="typeOfAudit" class="form-input" required onchange="toggleAndroidVaptFollowUpOtherField('androidVaptFollowUpMetaTypeAudit', 'androidVaptFollowUpMetaTypeAuditOther')">
                                    <option value="">Select Type</option>
                                    <option value="API Security Audit">API Security Audit</option>
                                    <option value="Cloud Security Audit">Cloud Security Audit</option>
                                    <option value="Compliance to Standard/Framework/Policies Related Audit">Compliance to Standard/Framework/Policies Related Audit</option>
                                    <option value="Digital Forensic Readiness Assessment">Digital Forensic Readiness Assessment</option>
                                    <option value="Industrial Control Systems (ICS) / SCADA Audit">Industrial Control Systems (ICS) / SCADA Audit</option>
                                    <option value="IoT Security Assessment">IoT Security Assessment</option>
                                    <option value="Mobile Application Audit">Mobile Application Audit</option>
                                    <option value="Network Infrastructure Audits">Network Infrastructure Audits</option>
                                    <option value="Process Audit">Process Audit</option>
                                    <option value="Red Team Assessment">Red Team Assessment</option>
                                    <option value="Source Code Review">Source Code Review</option>
                                    <option value="VAPT-Infrastructure" selected>VAPT-Infrastructure</option>
                                    <option value="VAPT-Application">VAPT-Application</option>
                                    <option value="Website /Web Application Audit">Website /Web Application Audit</option>
                                    <option value="Wireless security audit">Wireless security audit</option>
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="androidVaptFollowUpMetaTypeAuditOther" name="typeOfAuditOther" class="form-input" placeholder="Please specify type of audit" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Details of website/application/infrastructure -->
                            <div class="form-group">
                                <label for="androidVaptFollowUpMetaDetails" class="form-label">Details of web site/name of application/no. of servers, perimeter devices, other infrastructure*</label>
                                <textarea id="androidVaptFollowUpMetaDetails" name="detailsOfWebsite" class="form-input" placeholder="Enter details" required rows="3"></textarea>
                            </div>

                            <!-- Reason for conducting Audit -->
                            <div class="form-group">
                                <label for="androidVaptFollowUpMetaReason" class="form-label">Reason for conducting Audit*</label>
                                <select id="androidVaptFollowUpMetaReason" name="reasonForAudit" class="form-input" required>
                                    <option value="">Select Reason</option>
                                    <option value="Certificate of compliance like ISO 27001">Certificate of compliance like ISO 27001</option>
                                    <option value="Certificate of safe hosting">Certificate of safe hosting</option>
                                    <option value="Change in process or infrastructure">Change in process or infrastructure</option>
                                    <option value="Government directions">Government directions</option>
                                    <option value="Incident/ Breach in Organisation">Incident/ Breach in Organisation</option>
                                    <option value="Incident/ Breach in Sector">Incident/ Breach in Sector</option>
                                    <option value="New application/ Infrastructure">New application/ Infrastructure</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Periodic Audit as per Policy of organisation.">Periodic Audit as per Policy of organisation.</option>
                                    <option value="Regulatory directions" selected>Regulatory directions</option>
                                    <option value="Third Party Initiated">Third Party Initiated</option>
                                </select>
                            </div>

                            <!-- Standards Used for conducting Audit -->
                            <div class="form-group">
                                <label for="androidVaptFollowUpMetaStandards" class="form-label">Standards Used for conducting Audit*</label>
                                <input type="text" id="androidVaptFollowUpMetaStandards" name="standardsUsed" class="form-input" placeholder="Enter standards" required>
                            </div>

                            <!-- Challenges in conducting Audits -->
                            <div class="form-group">
                                <label for="androidVaptFollowUpMetaChallenges" class="form-label">Challenges in conducting Audits*</label>
                                <textarea id="androidVaptFollowUpMetaChallenges" name="challenges" class="form-input" placeholder="Enter challenges" required rows="3"></textarea>
                            </div>

                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Compliance Questions</h4>
                            </div>

                            <!-- Compliance questions -->
                            <div class="form-group">
                                <label for="androidVaptFollowUpMetaCompFinancial" class="form-label">Compliance to financial sector regulatory bodies guidelines/circulars/directions like from RBI, IRDAI, SEBI, NPCI*</label>
                                <select id="androidVaptFollowUpMetaCompFinancial" name="complianceFinancial" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="androidVaptFollowUpMetaCompRegulatory" class="form-label">Compliance to regulatory bodies guidelines/circulars/directions like from UIDAI, CCA, DoT, TRAI*</label>
                                <select id="androidVaptFollowUpMetaCompRegulatory" name="complianceRegulatory" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="androidVaptFollowUpMetaCompCertIn" class="form-label">Compliance to CERT-In directions under sub-section (6) of section 70B of the IT Act, 2000 dated 28 April, 2022*</label>
                                <select id="androidVaptFollowUpMetaCompCertIn" name="complianceCertIn" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="androidVaptFollowUpMetaCompCEA" class="form-label">Compliance to CEA (Cyber Security in Power Sector) guidelines 2021*</label>
                                <select id="androidVaptFollowUpMetaCompCEA" name="complianceCEA" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="androidVaptFollowUpMetaCompOther" class="form-label">Any other domestic regulation, directions, guidelines (Please Specify)*</label>
                                <select id="androidVaptFollowUpMetaCompOther" name="complianceOther" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No" selected>No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <!-- Type of Audit Report -->
                            <div class="form-group">
                                <label for="androidVaptFollowUpMetaTypeReport" class="form-label">Type of Audit Report*</label>
                                <select id="androidVaptFollowUpMetaTypeReport" name="typeOfAuditReport" class="form-input" required>
                                    <option value="">Select Type</option>
                                    <option value="First Audit Report">First Audit Report</option>
                                    <option value="Follow up Audit Report" selected>Follow up Audit Report</option>
                                </select>
                            </div>

                            <!-- No. of vulnerabilities -->
                            <div class="form-group">
                                <label for="androidVaptFollowUpMetaNumVuln" class="form-label">No. of vulnerabilities/ security issues reported during FIRST Audit*</label>
                                <input type="number" id="androidVaptFollowUpMetaNumVuln" name="numVulnerabilities" class="form-input" placeholder="Enter number" min="0" required>
                            </div>

                            <!-- No. of days taken to patch -->
                            <div class="form-group">
                                <label for="androidVaptFollowUpMetaDaysPatch" class="form-label">No. of days taken by Client to patch the vulnerabilities after submission of Audit report*</label>
                                <select id="androidVaptFollowUpMetaDaysPatch" name="numDaysToPatch" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Follow up audit not performed">Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- Duration between audits -->
                            <div class="form-group">
                                <label for="androidVaptFollowUpMetaDuration" class="form-label">Durations (in days) between end of FIRST audit and start of FOLLOW-UP/SECOND audit*</label>
                                <select id="androidVaptFollowUpMetaDuration" name="durationBetweenAudits" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed">Follow up audit not performed</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- No. of open issues -->
                            <div class="form-group">
                                <label for="androidVaptFollowUpMetaOpenIssues" class="form-label">No. of open issues after follow-up audits*</label>
                                <select id="androidVaptFollowUpMetaOpenIssues" name="numOpenIssues" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed">Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="0">0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="101">101</option>
                                    <option value="102">102</option>
                                    <option value="103">103</option>
                                    <option value="104">104</option>
                                    <option value="105">105</option>
                                    <option value="106">106</option>
                                    <option value="107">107</option>
                                    <option value="108">108</option>
                                    <option value="109">109</option>
                                    <option value="110">110</option>
                                    <option value="111">111</option>
                                    <option value="112">112</option>
                                    <option value="113">113</option>
                                    <option value="114">114</option>
                                    <option value="115">115</option>
                                    <option value="116">116</option>
                                    <option value="117">117</option>
                                    <option value="118">118</option>
                                    <option value="119">119</option>
                                    <option value="120">120</option>
                                    <option value="121">121</option>
                                    <option value="122">122</option>
                                    <option value="123">123</option>
                                    <option value="124">124</option>
                                    <option value="125">125</option>
                                    <option value="126">126</option>
                                    <option value="127">127</option>
                                    <option value="128">128</option>
                                    <option value="129">129</option>
                                    <option value="130">130</option>
                                    <option value="131">131</option>
                                    <option value="132">132</option>
                                    <option value="133">133</option>
                                    <option value="134">134</option>
                                    <option value="135">135</option>
                                    <option value="136">136</option>
                                    <option value="137">137</option>
                                    <option value="138">138</option>
                                    <option value="139">139</option>
                                    <option value="140">140</option>
                                    <option value="141">141</option>
                                    <option value="142">142</option>
                                    <option value="143">143</option>
                                    <option value="144">144</option>
                                    <option value="145">145</option>
                                    <option value="146">146</option>
                                    <option value="147">147</option>
                                    <option value="148">148</option>
                                    <option value="149">149</option>
                                    <option value="150">150</option>
                                    <option value="151">151</option>
                                    <option value="152">152</option>
                                    <option value="153">153</option>
                                    <option value="154">154</option>
                                    <option value="155">155</option>
                                    <option value="156">156</option>
                                    <option value="157">157</option>
                                    <option value="158">158</option>
                                    <option value="159">159</option>
                                    <option value="160">160</option>
                                    <option value="161">161</option>
                                    <option value="162">162</option>
                                    <option value="163">163</option>
                                    <option value="164">164</option>
                                    <option value="165">165</option>
                                    <option value="166">166</option>
                                    <option value="167">167</option>
                                    <option value="168">168</option>
                                    <option value="169">169</option>
                                    <option value="170">170</option>
                                    <option value="171">171</option>
                                    <option value="172">172</option>
                                    <option value="173">173</option>
                                    <option value="174">174</option>
                                    <option value="175">175</option>
                                    <option value="176">176</option>
                                    <option value="177">177</option>
                                    <option value="178">178</option>
                                    <option value="179">179</option>
                                    <option value="180">180</option>
                                    <option value="More than 180">More than 180</option>
                                </select>
                            </div>

                            <!-- Geographical detail -->
                            <div class="form-group">
                                <label for="androidVaptFollowUpMetaGeoState" class="form-label">Geographical detail of Client (State/UT)*</label>
                                <select id="androidVaptFollowUpMetaGeoState" name="geographicalState" class="form-input" required>
                                    <option value="">Select State/UT</option>
                                    <option value="Andhra Pradesh">Andhra Pradesh</option>
                                    <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                    <option value="Assam">Assam</option>
                                    <option value="Bihar">Bihar</option>
                                    <option value="Chhattisgarh">Chhattisgarh</option>
                                    <option value="Goa">Goa</option>
                                    <option value="Gujarat">Gujarat</option>
                                    <option value="Haryana">Haryana</option>
                                    <option value="Himachal Pradesh">Himachal Pradesh</option>
                                    <option value="Jharkhand">Jharkhand</option>
                                    <option value="Karnataka">Karnataka</option>
                                    <option value="Kerala">Kerala</option>
                                    <option value="Madhya Pradesh">Madhya Pradesh</option>
                                    <option value="Maharashtra">Maharashtra</option>
                                    <option value="Manipur">Manipur</option>
                                    <option value="Meghalaya">Meghalaya</option>
                                    <option value="Mizoram">Mizoram</option>
                                    <option value="Nagaland">Nagaland</option>
                                    <option value="Odisha">Odisha</option>
                                    <option value="Punjab">Punjab</option>
                                    <option value="Rajasthan">Rajasthan</option>
                                    <option value="Sikkim">Sikkim</option>
                                    <option value="Tamil Nadu">Tamil Nadu</option>
                                    <option value="Telangana">Telangana</option>
                                    <option value="Tripura">Tripura</option>
                                    <option value="Uttar Pradesh">Uttar Pradesh</option>
                                    <option value="Uttarakhand">Uttarakhand</option>
                                    <option value="West Bengal">West Bengal</option>

                                    <!-- Union Territories -->
                                    <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                    <option value="Chandigarh">Chandigarh</option>
                                    <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                    <option value="Delhi">Delhi</option>
                                    <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                    <option value="Ladakh">Ladakh</option>
                                    <option value="Lakshadweep">Lakshadweep</option>
                                    <option value="Puducherry">Puducherry</option>

                                </select>
                            </div>

                            <!-- Date of Audit Completion -->
                            <div class="form-group">
                                <label for="androidVaptFollowUpMetaDateCompletion" class="form-label">Date of Audit Completion*</label>
                                <input type="date" id="androidVaptFollowUpMetaDateCompletion" name="dateAuditCompletion" class="form-input" required>
                            </div>

                            <!-- Date of last audit -->
                            <div class="form-group">
                                <label for="androidVaptFollowUpMetaDateLastAudit" class="form-label">Date of last audit of same infrastructure*</label>
                                <input type="date" id="androidVaptFollowUpMetaDateLastAudit" name="dateLastAudit" class="form-input" required>
                            </div>

                            <!-- Vulnerability Status Radio Buttons -->
                            <div class="form-group">
                                <label class="form-label" style="margin-bottom: 10px;">Vulnerability Status*</label>
                                <div style="display: flex; gap: 30px; margin-top: 10px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="0" required onchange="toggleAndroidVaptFollowUpVulnerabilitySection()" style="width: auto;">
                                        <span>0 Vulnerability</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="has" required onchange="toggleAndroidVaptFollowUpVulnerabilitySection()" style="width: auto;">
                                        <span>Has Vulnerability</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Vulnerability Details Section -->
                            <div id="androidVaptFollowUpVulnerabilitySection" style="display: none;">
                                <div class="form-group">
                                    <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                        Audited Infrastructure Details
                                        <button type="button" class="submit-btn" onclick="addAndroidVaptFollowUpVulnerabilityEntry()" style="float: right; margin-top: -5px;">
                                            <i class="fas fa-plus"></i> Add Entry
                                        </button>
                                    </h4>
                                </div>

                                <div id="androidVaptFollowUpVulnerabilityContainer">
                                <!-- First vulnerability entry -->
                                <div class="vulnerability-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Audited infrastructure details*</label>
                                        <input type="text" name="vuln_0_infrastructure" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                                        <input type="text" name="vuln_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CVE/CWE Reference Number*</label>
                                        <input type="text" name="vuln_0_cve" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Severity of Issue*</label>
                                        <select name="vuln_0_severity" class="form-input" required>
                                            <option value="">Select Severity</option>
                                            <option value="Critical">Critical</option>
                                            <option value="High">High</option>
                                            <option value="Medium">Medium</option>
                                            <option value="Low">Low</option>
                                            <option value="Informational">Informational</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                                        <input type="number" name="vuln_0_count" class="form-input" min="0" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Attributing Factor*</label>
                                        <select name="vuln_0_factor" class="form-input" required>
                                            <option value="">Select Factor</option>
                                            <option value="Coding Error">Coding Error</option>
                                            <option value="Configuration Error">Configuration Error</option>
                                            <option value="Deployment Error">Deployment Error</option>
                                            <option value="Design Error">Design Error</option>
                                            <option value="Operation Error">Operation Error</option>
                                            <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            </div>

                            <!-- Employee Details Section -->
                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                    Employee Details
                                    <button type="button" class="submit-btn" onclick="addAndroidVaptFollowUpEmployeeEntry()" style="float: right; margin-top: -5px;">
                                        <i class="fas fa-plus"></i> Add Employee
                                    </button>
                                </h4>
                            </div>

                            <div id="androidVaptFollowUpEmployeeContainer">
                                <!-- First employee entry -->
                                <div class="employee-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Name of employee*</label>
                                        <input type="text" name="emp_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">E-mail ID*</label>
                                        <input type="email" name="emp_0_email" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISSP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cissp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cissp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cisa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cisa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISM*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cism" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cism" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">ISO*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_iso" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_iso" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">DISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_disa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_disa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">OSCP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_oscp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_oscp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CEH*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_ceh" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_ceh" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Others</label>
                                        <input type="text" name="emp_0_others" class="form-input" placeholder="Specify other certifications">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                                        <input type="number" name="emp_0_experience" class="form-input" min="0" step="0.5" required>
                                    </div>
                                </div>
                            </div>

                            <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                                <button type="button" class="btn btn-secondary" onclick="closeVaptModal('androidVaptFollowUpAuditMetaDataModal')">Cancel</button>
                                <button type="submit" class="btn btn-primary" id="androidVaptFollowUpAuditMetaDataSubmitBtn">
                                    <i class="fas fa-check"></i> Submit
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- IOS Mobile Application Follow Up Audit MetaData Modal -->
            <div id="iosVaptFollowUpAuditMetaDataModal" class="modal">
                <div class="modal-content" style="max-width: 1000px;">
                    <div class="modal-header">
                        <h3>IOS Mobile Application Follow Up Audit MetaData</h3>
                        <span class="close-modal" onclick="closeVaptModal('iosVaptFollowUpAuditMetaDataModal')">&times;</span>
                    </div>
                    <div class="modal-body scrollable-content">
                        <form id="iosVaptFollowUpAuditMetaDataForm" method="POST" onsubmit="handleIosVaptFollowUpAuditMetaDataSubmit(event)">
                            
                            <!-- Audit Dates -->
                            <div class="form-group">
                                <label for="iosVaptFollowUpMetaStartDate" class="form-label">Start Audit Date*</label>
                                <input type="date" id="iosVaptFollowUpMetaStartDate" name="startAuditDate" class="form-input" required>
                            </div>

                            <div class="form-group">
                                <label for="iosVaptFollowUpMetaEndDate" class="form-label">End Audit Date*</label>
                                <input type="date" id="iosVaptFollowUpMetaEndDate" name="endAuditDate" class="form-input" required>
                            </div>

                            <!-- Name of Auditee organization -->
                            <div class="form-group">
                                <label for="iosVaptFollowUpMetaAuditeeOrg" class="form-label">Name of Auditee Organization*</label>
                                <select id="iosVaptFollowUpMetaAuditeeOrg" name="nameOfAuditeeOrg" class="form-input" required onchange="toggleIosVaptFollowUpOtherField('iosVaptFollowUpMetaAuditeeOrg', 'iosVaptFollowUpMetaAuditeeOrgOther')">
                                    <option value="">Select Organization</option>
                                    <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                    <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                    <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                    <option value="Megasoft Limited">Megasoft Limited</option>
                                    <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                    <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                    <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                    <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                    <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                    <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                    <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                    <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                    <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                    <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                    <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                    <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                    <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                    <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                    <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                    <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                    <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                    <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                    <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                    <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                    <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                    <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                    <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                    <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                    <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                    <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                    <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                    <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                    <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                    <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                    <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                    <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                    <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                    <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                    <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                    <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                    
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="iosVaptFollowUpMetaAuditeeOrgOther" name="nameOfAuditeeOrgOther" class="form-input" placeholder="Specify organization name" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Category of Organization -->
                            <div class="form-group">
                                <label for="iosVaptFollowUpMetaCategoryOrg" class="form-label">Category of Organization*</label>
                                <select id="iosVaptFollowUpMetaCategoryOrg" name="categoryOfOrg" class="form-input" required>
                                    <option value="">Select Category</option>
                                    <option value="Central Ministry/Department">Central Ministry/Department</option>
                                    <option value="Organization under Government Department">Organization under Government Department</option>
                                    <option value="Private Sector" selected>Private Sector</option>
                                    <option value="Public sector organisations">Public sector organisations</option>
                                    <option value="State Government Department">State Government Department</option>
                                </select>
                            </div>

                            <!-- Sector of Organization -->
                            <div class="form-group">
                                <label for="iosVaptFollowUpMetaSectorOrg" class="form-label">Sector of Organization*</label>
                                <select id="iosVaptFollowUpMetaSectorOrg" name="sectorOfOrg" class="form-input" required onchange="updateIosVaptFollowUpSubSectorOptions()">
                                    <option value="">Select Sector</option>
                                    <option value="Agriculture">Agriculture</option>
                                    <option value="Defence">Defence</option>
                                    <option value="Education">Education</option>
                                    <option value="Energy">Energy</option>
                                    <option value="Finance" selected>Finance</option>
                                    <option value="Healthcare">Healthcare</option>
                                    <option value="Information_and_Broadcasting">Information and Broadcasting</option>
                                    <option value="Information_and_Communication_Technology">Information and Communication Technology</option>
                                    <option value="Law_Enforcement_and_Security">Law Enforcement and Security</option>
                                    <option value="Public_Essential_Services_and_Utilities">Public Essential Services and Utilities</option>
                                    <option value="Space">Space</option>
                                    <option value="Transportation">Transportation</option>
                                </select>
                            </div>

                            <!-- Sub Sector -->
                            <div class="form-group">
                                <label for="iosVaptFollowUpMetaSubSector" class="form-label">Sub Sector*</label>
                                <select id="iosVaptFollowUpMetaSubSector" name="subSector" class="form-input" required>
                                    <option value="">Select Sector First</option>
                                </select>
                            </div>

                            <!-- Type of audit -->
                            <div class="form-group">
                                <label for="iosVaptFollowUpMetaTypeAudit" class="form-label">Type of Audit*</label>
                                <select id="iosVaptFollowUpMetaTypeAudit" name="typeOfAudit" class="form-input" required onchange="toggleIosVaptFollowUpOtherField('iosVaptFollowUpMetaTypeAudit', 'iosVaptFollowUpMetaTypeAuditOther')">
                                    <option value="">Select Type</option>
                                    <option value="API Security Audit">API Security Audit</option>
                                    <option value="Cloud Security Audit">Cloud Security Audit</option>
                                    <option value="Compliance to Standard/Framework/Policies Related Audit">Compliance to Standard/Framework/Policies Related Audit</option>
                                    <option value="Digital Forensic Readiness Assessment">Digital Forensic Readiness Assessment</option>
                                    <option value="Industrial Control Systems (ICS) / SCADA Audit">Industrial Control Systems (ICS) / SCADA Audit</option>
                                    <option value="IoT Security Assessment">IoT Security Assessment</option>
                                    <option value="Mobile Application Audit">Mobile Application Audit</option>
                                    <option value="Network Infrastructure Audits">Network Infrastructure Audits</option>
                                    <option value="Process Audit">Process Audit</option>
                                    <option value="Red Team Assessment">Red Team Assessment</option>
                                    <option value="Source Code Review">Source Code Review</option>
                                    <option value="VAPT-Infrastructure" selected>VAPT-Infrastructure</option>
                                    <option value="VAPT-Application">VAPT-Application</option>
                                    <option value="Website /Web Application Audit">Website /Web Application Audit</option>
                                    <option value="Wireless security audit">Wireless security audit</option>
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="iosVaptFollowUpMetaTypeAuditOther" name="typeOfAuditOther" class="form-input" placeholder="Please specify type of audit" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Details of website/application/infrastructure -->
                            <div class="form-group">
                                <label for="iosVaptFollowUpMetaDetails" class="form-label">Details of web site/name of application/no. of servers, perimeter devices, other infrastructure*</label>
                                <textarea id="iosVaptFollowUpMetaDetails" name="detailsOfWebsite" class="form-input" placeholder="Enter details" required rows="3"></textarea>
                            </div>

                            <!-- Reason for conducting Audit -->
                            <div class="form-group">
                                <label for="iosVaptFollowUpMetaReason" class="form-label">Reason for conducting Audit*</label>
                                <select id="iosVaptFollowUpMetaReason" name="reasonForAudit" class="form-input" required>
                                    <option value="">Select Reason</option>
                                    <option value="Certificate of compliance like ISO 27001">Certificate of compliance like ISO 27001</option>
                                    <option value="Certificate of safe hosting">Certificate of safe hosting</option>
                                    <option value="Change in process or infrastructure">Change in process or infrastructure</option>
                                    <option value="Government directions">Government directions</option>
                                    <option value="Incident/ Breach in Organisation">Incident/ Breach in Organisation</option>
                                    <option value="Incident/ Breach in Sector">Incident/ Breach in Sector</option>
                                    <option value="New application/ Infrastructure">New application/ Infrastructure</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Periodic Audit as per Policy of organisation.">Periodic Audit as per Policy of organisation.</option>
                                    <option value="Regulatory directions" selected>Regulatory directions</option>
                                    <option value="Third Party Initiated">Third Party Initiated</option>
                                </select>
                            </div>

                            <!-- Standards Used for conducting Audit -->
                            <div class="form-group">
                                <label for="iosVaptFollowUpMetaStandards" class="form-label">Standards Used for conducting Audit*</label>
                                <input type="text" id="iosVaptFollowUpMetaStandards" name="standardsUsed" class="form-input" placeholder="Enter standards" required>
                            </div>

                            <!-- Challenges in conducting Audits -->
                            <div class="form-group">
                                <label for="iosVaptFollowUpMetaChallenges" class="form-label">Challenges in conducting Audits*</label>
                                <textarea id="iosVaptFollowUpMetaChallenges" name="challenges" class="form-input" placeholder="Enter challenges" required rows="3"></textarea>
                            </div>

                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Compliance Questions</h4>
                            </div>

                            <!-- Compliance questions -->
                            <div class="form-group">
                                <label for="iosVaptFollowUpMetaCompFinancial" class="form-label">Compliance to financial sector regulatory bodies guidelines/circulars/directions like from RBI, IRDAI, SEBI, NPCI*</label>
                                <select id="iosVaptFollowUpMetaCompFinancial" name="complianceFinancial" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="iosVaptFollowUpMetaCompRegulatory" class="form-label">Compliance to regulatory bodies guidelines/circulars/directions like from UIDAI, CCA, DoT, TRAI*</label>
                                <select id="iosVaptFollowUpMetaCompRegulatory" name="complianceRegulatory" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="iosVaptFollowUpMetaCompCertIn" class="form-label">Compliance to CERT-In directions under sub-section (6) of section 70B of the IT Act, 2000 dated 28 April, 2022*</label>
                                <select id="iosVaptFollowUpMetaCompCertIn" name="complianceCertIn" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="iosVaptFollowUpMetaCompCEA" class="form-label">Compliance to CEA (Cyber Security in Power Sector) guidelines 2021*</label>
                                <select id="iosVaptFollowUpMetaCompCEA" name="complianceCEA" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="iosVaptFollowUpMetaCompOther" class="form-label">Any other domestic regulation, directions, guidelines (Please Specify)*</label>
                                <select id="iosVaptFollowUpMetaCompOther" name="complianceOther" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No" selected>No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <!-- Type of Audit Report -->
                            <div class="form-group">
                                <label for="iosVaptFollowUpMetaTypeReport" class="form-label">Type of Audit Report*</label>
                                <select id="iosVaptFollowUpMetaTypeReport" name="typeOfAuditReport" class="form-input" required>
                                    <option value="">Select Type</option>
                                    <option value="First Audit Report">First Audit Report</option>
                                    <option value="Follow up Audit Report" selected>Follow up Audit Report</option>
                                </select>
                            </div>

                            <!-- No. of vulnerabilities -->
                            <div class="form-group">
                                <label for="iosVaptFollowUpMetaNumVuln" class="form-label">No. of vulnerabilities/ security issues reported during FIRST Audit*</label>
                                <input type="number" id="iosVaptFollowUpMetaNumVuln" name="numVulnerabilities" class="form-input" placeholder="Enter number" min="0" required>
                            </div>

                            <!-- No. of days taken to patch -->
                            <div class="form-group">
                                <label for="iosVaptFollowUpMetaDaysPatch" class="form-label">No. of days taken by Client to patch the vulnerabilities after submission of Audit report*</label>
                                <select id="iosVaptFollowUpMetaDaysPatch" name="numDaysToPatch" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Follow up audit not performed">Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- Duration between audits -->
                            <div class="form-group">
                                <label for="iosVaptFollowUpMetaDuration" class="form-label">Durations (in days) between end of FIRST audit and start of FOLLOW-UP/SECOND audit*</label>
                                <select id="iosVaptFollowUpMetaDuration" name="durationBetweenAudits" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed">Follow up audit not performed</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- No. of open issues -->
                            <div class="form-group">
                                <label for="iosVaptFollowUpMetaOpenIssues" class="form-label">No. of open issues after follow-up audits*</label>
                                <select id="iosVaptFollowUpMetaOpenIssues" name="numOpenIssues" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed">Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="0">0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="101">101</option>
                                    <option value="102">102</option>
                                    <option value="103">103</option>
                                    <option value="104">104</option>
                                    <option value="105">105</option>
                                    <option value="106">106</option>
                                    <option value="107">107</option>
                                    <option value="108">108</option>
                                    <option value="109">109</option>
                                    <option value="110">110</option>
                                    <option value="111">111</option>
                                    <option value="112">112</option>
                                    <option value="113">113</option>
                                    <option value="114">114</option>
                                    <option value="115">115</option>
                                    <option value="116">116</option>
                                    <option value="117">117</option>
                                    <option value="118">118</option>
                                    <option value="119">119</option>
                                    <option value="120">120</option>
                                    <option value="121">121</option>
                                    <option value="122">122</option>
                                    <option value="123">123</option>
                                    <option value="124">124</option>
                                    <option value="125">125</option>
                                    <option value="126">126</option>
                                    <option value="127">127</option>
                                    <option value="128">128</option>
                                    <option value="129">129</option>
                                    <option value="130">130</option>
                                    <option value="131">131</option>
                                    <option value="132">132</option>
                                    <option value="133">133</option>
                                    <option value="134">134</option>
                                    <option value="135">135</option>
                                    <option value="136">136</option>
                                    <option value="137">137</option>
                                    <option value="138">138</option>
                                    <option value="139">139</option>
                                    <option value="140">140</option>
                                    <option value="141">141</option>
                                    <option value="142">142</option>
                                    <option value="143">143</option>
                                    <option value="144">144</option>
                                    <option value="145">145</option>
                                    <option value="146">146</option>
                                    <option value="147">147</option>
                                    <option value="148">148</option>
                                    <option value="149">149</option>
                                    <option value="150">150</option>
                                    <option value="151">151</option>
                                    <option value="152">152</option>
                                    <option value="153">153</option>
                                    <option value="154">154</option>
                                    <option value="155">155</option>
                                    <option value="156">156</option>
                                    <option value="157">157</option>
                                    <option value="158">158</option>
                                    <option value="159">159</option>
                                    <option value="160">160</option>
                                    <option value="161">161</option>
                                    <option value="162">162</option>
                                    <option value="163">163</option>
                                    <option value="164">164</option>
                                    <option value="165">165</option>
                                    <option value="166">166</option>
                                    <option value="167">167</option>
                                    <option value="168">168</option>
                                    <option value="169">169</option>
                                    <option value="170">170</option>
                                    <option value="171">171</option>
                                    <option value="172">172</option>
                                    <option value="173">173</option>
                                    <option value="174">174</option>
                                    <option value="175">175</option>
                                    <option value="176">176</option>
                                    <option value="177">177</option>
                                    <option value="178">178</option>
                                    <option value="179">179</option>
                                    <option value="180">180</option>
                                    <option value="More than 180">More than 180</option>
                                </select>
                            </div>

                            <!-- Geographical detail -->
                            <div class="form-group">
                                <label for="iosVaptFollowUpMetaGeoState" class="form-label">Geographical detail of Client (State/UT)*</label>
                                <select id="iosVaptFollowUpMetaGeoState" name="geographicalState" class="form-input" required>
                                    <option value="">Select State/UT</option>
                                    <option value="Andhra Pradesh">Andhra Pradesh</option>
                                    <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                    <option value="Assam">Assam</option>
                                    <option value="Bihar">Bihar</option>
                                    <option value="Chhattisgarh">Chhattisgarh</option>
                                    <option value="Goa">Goa</option>
                                    <option value="Gujarat">Gujarat</option>
                                    <option value="Haryana">Haryana</option>
                                    <option value="Himachal Pradesh">Himachal Pradesh</option>
                                    <option value="Jharkhand">Jharkhand</option>
                                    <option value="Karnataka">Karnataka</option>
                                    <option value="Kerala">Kerala</option>
                                    <option value="Madhya Pradesh">Madhya Pradesh</option>
                                    <option value="Maharashtra">Maharashtra</option>
                                    <option value="Manipur">Manipur</option>
                                    <option value="Meghalaya">Meghalaya</option>
                                    <option value="Mizoram">Mizoram</option>
                                    <option value="Nagaland">Nagaland</option>
                                    <option value="Odisha">Odisha</option>
                                    <option value="Punjab">Punjab</option>
                                    <option value="Rajasthan">Rajasthan</option>
                                    <option value="Sikkim">Sikkim</option>
                                    <option value="Tamil Nadu">Tamil Nadu</option>
                                    <option value="Telangana">Telangana</option>
                                    <option value="Tripura">Tripura</option>
                                    <option value="Uttar Pradesh">Uttar Pradesh</option>
                                    <option value="Uttarakhand">Uttarakhand</option>
                                    <option value="West Bengal">West Bengal</option>

                                    <!-- Union Territories -->
                                    <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                    <option value="Chandigarh">Chandigarh</option>
                                    <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                    <option value="Delhi">Delhi</option>
                                    <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                    <option value="Ladakh">Ladakh</option>
                                    <option value="Lakshadweep">Lakshadweep</option>
                                    <option value="Puducherry">Puducherry</option>

                                </select>
                            </div>

                            <!-- Date of Audit Completion -->
                            <div class="form-group">
                                <label for="iosVaptFollowUpMetaDateCompletion" class="form-label">Date of Audit Completion*</label>
                                <input type="date" id="iosVaptFollowUpMetaDateCompletion" name="dateAuditCompletion" class="form-input" required>
                            </div>

                            <!-- Date of last audit -->
                            <div class="form-group">
                                <label for="iosVaptFollowUpMetaDateLastAudit" class="form-label">Date of last audit of same infrastructure*</label>
                                <input type="date" id="iosVaptFollowUpMetaDateLastAudit" name="dateLastAudit" class="form-input" required>
                            </div>

                            <!-- Vulnerability Status Radio Buttons -->
                            <div class="form-group">
                                <label class="form-label" style="margin-bottom: 10px;">Vulnerability Status*</label>
                                <div style="display: flex; gap: 30px; margin-top: 10px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="0" required onchange="toggleIosVaptFollowUpVulnerabilitySection()" style="width: auto;">
                                        <span>0 Vulnerability</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="has" required onchange="toggleIosVaptFollowUpVulnerabilitySection()" style="width: auto;">
                                        <span>Has Vulnerability</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Vulnerability Details Section -->
                            <div id="iosVaptFollowUpVulnerabilitySection" style="display: none;">
                                <div class="form-group">
                                    <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                        Audited Infrastructure Details
                                        <button type="button" class="submit-btn" onclick="addIosVaptFollowUpVulnerabilityEntry()" style="float: right; margin-top: -5px;">
                                            <i class="fas fa-plus"></i> Add Entry
                                        </button>
                                    </h4>
                                </div>

                                <div id="iosVaptFollowUpVulnerabilityContainer">
                                <!-- First vulnerability entry -->
                                <div class="vulnerability-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Audited infrastructure details*</label>
                                        <input type="text" name="vuln_0_infrastructure" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                                        <input type="text" name="vuln_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CVE/CWE Reference Number*</label>
                                        <input type="text" name="vuln_0_cve" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Severity of Issue*</label>
                                        <select name="vuln_0_severity" class="form-input" required>
                                            <option value="">Select Severity</option>
                                            <option value="Critical">Critical</option>
                                            <option value="High">High</option>
                                            <option value="Medium">Medium</option>
                                            <option value="Low">Low</option>
                                            <option value="Informational">Informational</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                                        <input type="number" name="vuln_0_count" class="form-input" min="0" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Attributing Factor*</label>
                                        <select name="vuln_0_factor" class="form-input" required>
                                            <option value="">Select Factor</option>
                                            <option value="Coding Error">Coding Error</option>
                                            <option value="Configuration Error">Configuration Error</option>
                                            <option value="Deployment Error">Deployment Error</option>
                                            <option value="Design Error">Design Error</option>
                                            <option value="Operation Error">Operation Error</option>
                                            <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            </div>

                            <!-- Employee Details Section -->
                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                    Employee Details
                                    <button type="button" class="submit-btn" onclick="addIosVaptFollowUpEmployeeEntry()" style="float: right; margin-top: -5px;">
                                        <i class="fas fa-plus"></i> Add Employee
                                    </button>
                                </h4>
                            </div>

                            <div id="iosVaptFollowUpEmployeeContainer">
                                <!-- First employee entry -->
                                <div class="employee-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Name of employee*</label>
                                        <input type="text" name="emp_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">E-mail ID*</label>
                                        <input type="email" name="emp_0_email" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISSP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cissp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cissp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cisa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cisa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISM*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cism" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cism" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">ISO*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_iso" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_iso" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">DISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_disa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_disa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">OSCP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_oscp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_oscp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CEH*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_ceh" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_ceh" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Others</label>
                                        <input type="text" name="emp_0_others" class="form-input" placeholder="Specify other certifications">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                                        <input type="number" name="emp_0_experience" class="form-input" min="0" step="0.5" required>
                                    </div>
                                </div>
                            </div>

                            <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                                <button type="button" class="btn btn-secondary" onclick="closeVaptModal('iosVaptFollowUpAuditMetaDataModal')">Cancel</button>
                                <button type="submit" class="btn btn-primary" id="iosVaptFollowUpAuditMetaDataSubmitBtn">
                                    <i class="fas fa-check"></i> Submit
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Public IP Follow Up Audit MetaData Modal -->
            <div id="publicIpFollowUpAuditMetaDataModal" class="modal">
                <div class="modal-content" style="max-width: 1000px;">
                    <div class="modal-header">
                        <h3>Public IP Follow Up Audit MetaData</h3>
                        <span class="close-modal" onclick="closeVaptModal('publicIpFollowUpAuditMetaDataModal')">&times;</span>
                    </div>
                    <div class="modal-body scrollable-content">
                        <form id="publicIpFollowUpAuditMetaDataForm" method="POST" onsubmit="handlePublicIpFollowUpAuditMetaDataSubmit(event)">
                            
                            <!-- Audit Dates -->
                            <div class="form-group">
                                <label for="publicIpFollowUpMetaStartDate" class="form-label">Start Audit Date*</label>
                                <input type="date" id="publicIpFollowUpMetaStartDate" name="startAuditDate" class="form-input" required>
                            </div>

                            <div class="form-group">
                                <label for="publicIpFollowUpMetaEndDate" class="form-label">End Audit Date*</label>
                                <input type="date" id="publicIpFollowUpMetaEndDate" name="endAuditDate" class="form-input" required>
                            </div>

                            <!-- Name of Auditee organization -->
                            <div class="form-group">
                                <label for="publicIpFollowUpMetaAuditeeOrg" class="form-label">Name of Auditee Organization*</label>
                                <select id="publicIpFollowUpMetaAuditeeOrg" name="nameOfAuditeeOrg" class="form-input" required onchange="toggleVaptOtherField('publicIpFollowUpMetaAuditeeOrg', 'publicIpFollowUpMetaAuditeeOrgOther')">
                                    <option value="">Select Organization</option>
                                    <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                    <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                    <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                    <option value="Megasoft Limited">Megasoft Limited</option>
                                    <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                    <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                    <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                    <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                    <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                    <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                    <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                    <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                    <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                    <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                    <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                    <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                    <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                    <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                    <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                    <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                    <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                    <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                    <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                    <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                    <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                    <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                    <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                    <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                    <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                    <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                    <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                    <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                    <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                    <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                    <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                    <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                    <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                    <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                    <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                    <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                    
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="publicIpFollowUpMetaAuditeeOrgOther" name="nameOfAuditeeOrgOther" class="form-input" placeholder="Specify organization name" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Category of Organization -->
                            <div class="form-group">
                                <label for="publicIpFollowUpMetaCategoryOrg" class="form-label">Category of Organization*</label>
                                <select id="publicIpFollowUpMetaCategoryOrg" name="categoryOfOrg" class="form-input" required>
                                    <option value="">Select Category</option>
                                    <option value="Central Ministry/Department">Central Ministry/Department</option>
                                    <option value="Organization under Government Department">Organization under Government Department</option>
                                    <option value="Private Sector" selected>Private Sector</option>
                                    <option value="Public sector organisations">Public sector organisations</option>
                                    <option value="State Government Department">State Government Department</option>
                                </select>
                            </div>

                            <!-- Sector of Organization -->
                            <div class="form-group">
                                <label for="publicIpFollowUpMetaSectorOrg" class="form-label">Sector of Organization*</label>
                                <select id="publicIpFollowUpMetaSectorOrg" name="sectorOfOrg" class="form-input" required onchange="updatePublicIpFollowUpSubSectorOptions()">
                                    <option value="">Select Sector</option>
                                    <option value="Agriculture">Agriculture</option>
                                    <option value="Defence">Defence</option>
                                    <option value="Education">Education</option>
                                    <option value="Energy">Energy</option>
                                    <option value="Finance" selected>Finance</option>
                                    <option value="Healthcare">Healthcare</option>
                                    <option value="Information_and_Broadcasting">Information and Broadcasting</option>
                                    <option value="Information_and_Communication_Technology">Information and Communication Technology</option>
                                    <option value="Law_Enforcement_and_Security">Law Enforcement and Security</option>
                                    <option value="Public_Essential_Services_and_Utilities">Public Essential Services and Utilities</option>
                                    <option value="Space">Space</option>
                                    <option value="Transportation">Transportation</option>
                                </select>
                            </div>

                            <!-- Sub Sector -->
                            <div class="form-group">
                                <label for="publicIpFollowUpMetaSubSector" class="form-label">Sub Sector*</label>
                                <select id="publicIpFollowUpMetaSubSector" name="subSector" class="form-input" required>
                                    <option value="">Select Sector First</option>
                                </select>
                            </div>

                            <!-- Type of audit -->
                            <div class="form-group">
                                <label for="publicIpFollowUpMetaTypeAudit" class="form-label">Type of Audit*</label>
                                <select id="publicIpFollowUpMetaTypeAudit" name="typeOfAudit" class="form-input" required onchange="toggleVaptOtherField('publicIpFollowUpMetaTypeAudit', 'publicIpFollowUpMetaTypeAuditOther')">
                                    <option value="">Select Type</option>
                                    <option value="API Security Audit">API Security Audit</option>
                                    <option value="Cloud Security Audit">Cloud Security Audit</option>
                                    <option value="Compliance to Standard/Framework/Policies Related Audit">Compliance to Standard/Framework/Policies Related Audit</option>
                                    <option value="Digital Forensic Readiness Assessment">Digital Forensic Readiness Assessment</option>
                                    <option value="Industrial Control Systems (ICS) / SCADA Audit">Industrial Control Systems (ICS) / SCADA Audit</option>
                                    <option value="IoT Security Assessment">IoT Security Assessment</option>
                                    <option value="Mobile Application Audit">Mobile Application Audit</option>
                                    <option value="Network Infrastructure Audits">Network Infrastructure Audits</option>
                                    <option value="Process Audit">Process Audit</option>
                                    <option value="Red Team Assessment">Red Team Assessment</option>
                                    <option value="Source Code Review">Source Code Review</option>
                                    <option value="VAPT-Infrastructure" selected>VAPT-Infrastructure</option>
                                    <option value="VAPT-Application">VAPT-Application</option>
                                    <option value="Website /Web Application Audit">Website /Web Application Audit</option>
                                    <option value="Wireless security audit">Wireless security audit</option>
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="publicIpFollowUpMetaTypeAuditOther" name="typeOfAuditOther" class="form-input" placeholder="Please specify type of audit" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Details of website/application/infrastructure -->
                            <div class="form-group">
                                <label for="publicIpFollowUpMetaDetails" class="form-label">Details of web site/name of application/no. of servers, perimeter devices, other infrastructure*</label>
                                <textarea id="publicIpFollowUpMetaDetails" name="detailsOfWebsite" class="form-input" placeholder="Enter details" required rows="3"></textarea>
                            </div>

                            <!-- Reason for conducting Audit -->
                            <div class="form-group">
                                <label for="publicIpFollowUpMetaReason" class="form-label">Reason for conducting Audit*</label>
                                <select id="publicIpFollowUpMetaReason" name="reasonForAudit" class="form-input" required>
                                    <option value="">Select Reason</option>
                                    <option value="Certificate of compliance like ISO 27001">Certificate of compliance like ISO 27001</option>
                                    <option value="Certificate of safe hosting">Certificate of safe hosting</option>
                                    <option value="Change in process or infrastructure">Change in process or infrastructure</option>
                                    <option value="Government directions">Government directions</option>
                                    <option value="Incident/ Breach in Organisation">Incident/ Breach in Organisation</option>
                                    <option value="Incident/ Breach in Sector">Incident/ Breach in Sector</option>
                                    <option value="New application/ Infrastructure">New application/ Infrastructure</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Periodic Audit as per Policy of organisation.">Periodic Audit as per Policy of organisation.</option>
                                    <option value="Regulatory directions" selected>Regulatory directions</option>
                                    <option value="Third Party Initiated">Third Party Initiated</option>
                                </select>
                            </div>

                            <!-- Standards Used for conducting Audit -->
                            <div class="form-group">
                                <label for="publicIpFollowUpMetaStandards" class="form-label">Standards Used for conducting Audit*</label>
                                <input type="text" id="publicIpFollowUpMetaStandards" name="standardsUsed" class="form-input" placeholder="Enter standards" required>
                            </div>

                            <!-- Challenges in conducting Audits -->
                            <div class="form-group">
                                <label for="publicIpFollowUpMetaChallenges" class="form-label">Challenges in conducting Audits*</label>
                                <textarea id="publicIpFollowUpMetaChallenges" name="challenges" class="form-input" placeholder="Enter challenges" required rows="3"></textarea>
                            </div>

                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Compliance Questions</h4>
                            </div>

                            <!-- Compliance questions -->
                            <div class="form-group">
                                <label for="publicIpFollowUpMetaCompFinancial" class="form-label">Compliance to financial sector regulatory bodies guidelines/circulars/directions like from RBI, IRDAI, SEBI, NPCI*</label>
                                <select id="publicIpFollowUpMetaCompFinancial" name="complianceFinancial" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="publicIpFollowUpMetaCompRegulatory" class="form-label">Compliance to regulatory bodies guidelines/circulars/directions like from UIDAI, CCA, DoT, TRAI*</label>
                                <select id="publicIpFollowUpMetaCompRegulatory" name="complianceRegulatory" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="publicIpFollowUpMetaCompCertIn" class="form-label">Compliance to CERT-In directions under sub-section (6) of section 70B of the IT Act, 2000 dated 28 April, 2022*</label>
                                <select id="publicIpFollowUpMetaCompCertIn" name="complianceCertIn" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="publicIpFollowUpMetaCompCEA" class="form-label">Compliance to CEA (Cyber Security in Power Sector) guidelines 2021*</label>
                                <select id="publicIpFollowUpMetaCompCEA" name="complianceCEA" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="publicIpFollowUpMetaCompOther" class="form-label">Any other domestic regulation, directions, guidelines (Please Specify)*</label>
                                <select id="publicIpFollowUpMetaCompOther" name="complianceOther" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No" selected>No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <!-- Type of Audit Report -->
                            <div class="form-group">
                                <label for="publicIpFollowUpMetaTypeReport" class="form-label">Type of Audit Report*</label>
                                <select id="publicIpFollowUpMetaTypeReport" name="typeOfAuditReport" class="form-input" required>
                                    <option value="">Select Type</option>
                                    <option value="First Audit Report">First Audit Report</option>
                                    <option value="Follow up Audit Report" selected>Follow up Audit Report</option>
                                </select>
                            </div>

                            <!-- No. of vulnerabilities -->
                            <div class="form-group">
                                <label for="publicIpFollowUpMetaNumVuln" class="form-label">No. of vulnerabilities/ security issues reported during FIRST Audit*</label>
                                <input type="number" id="publicIpFollowUpMetaNumVuln" name="numVulnerabilities" class="form-input" placeholder="Enter number" min="0" required>
                            </div>

                            <!-- No. of days taken to patch -->
                            <div class="form-group">
                                <label for="publicIpFollowUpMetaDaysPatch" class="form-label">No. of days taken by Client to patch the vulnerabilities after submission of Audit report*</label>
                                <select id="publicIpFollowUpMetaDaysPatch" name="numDaysToPatch" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Follow up audit not performed">Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- Duration between audits -->
                            <div class="form-group">
                                <label for="publicIpFollowUpMetaDuration" class="form-label">Durations (in days) between end of FIRST audit and start of FOLLOW-UP/SECOND audit*</label>
                                <select id="publicIpFollowUpMetaDuration" name="durationBetweenAudits" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed">Follow up audit not performed</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- No. of open issues -->
                            <div class="form-group">
                                <label for="publicIpFollowUpMetaOpenIssues" class="form-label">No. of open issues after follow-up audits*</label>
                                <select id="publicIpFollowUpMetaOpenIssues" name="numOpenIssues" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed">Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="0">0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="101">101</option>
                                    <option value="102">102</option>
                                    <option value="103">103</option>
                                    <option value="104">104</option>
                                    <option value="105">105</option>
                                    <option value="106">106</option>
                                    <option value="107">107</option>
                                    <option value="108">108</option>
                                    <option value="109">109</option>
                                    <option value="110">110</option>
                                    <option value="111">111</option>
                                    <option value="112">112</option>
                                    <option value="113">113</option>
                                    <option value="114">114</option>
                                    <option value="115">115</option>
                                    <option value="116">116</option>
                                    <option value="117">117</option>
                                    <option value="118">118</option>
                                    <option value="119">119</option>
                                    <option value="120">120</option>
                                    <option value="121">121</option>
                                    <option value="122">122</option>
                                    <option value="123">123</option>
                                    <option value="124">124</option>
                                    <option value="125">125</option>
                                    <option value="126">126</option>
                                    <option value="127">127</option>
                                    <option value="128">128</option>
                                    <option value="129">129</option>
                                    <option value="130">130</option>
                                    <option value="131">131</option>
                                    <option value="132">132</option>
                                    <option value="133">133</option>
                                    <option value="134">134</option>
                                    <option value="135">135</option>
                                    <option value="136">136</option>
                                    <option value="137">137</option>
                                    <option value="138">138</option>
                                    <option value="139">139</option>
                                    <option value="140">140</option>
                                    <option value="141">141</option>
                                    <option value="142">142</option>
                                    <option value="143">143</option>
                                    <option value="144">144</option>
                                    <option value="145">145</option>
                                    <option value="146">146</option>
                                    <option value="147">147</option>
                                    <option value="148">148</option>
                                    <option value="149">149</option>
                                    <option value="150">150</option>
                                    <option value="151">151</option>
                                    <option value="152">152</option>
                                    <option value="153">153</option>
                                    <option value="154">154</option>
                                    <option value="155">155</option>
                                    <option value="156">156</option>
                                    <option value="157">157</option>
                                    <option value="158">158</option>
                                    <option value="159">159</option>
                                    <option value="160">160</option>
                                    <option value="161">161</option>
                                    <option value="162">162</option>
                                    <option value="163">163</option>
                                    <option value="164">164</option>
                                    <option value="165">165</option>
                                    <option value="166">166</option>
                                    <option value="167">167</option>
                                    <option value="168">168</option>
                                    <option value="169">169</option>
                                    <option value="170">170</option>
                                    <option value="171">171</option>
                                    <option value="172">172</option>
                                    <option value="173">173</option>
                                    <option value="174">174</option>
                                    <option value="175">175</option>
                                    <option value="176">176</option>
                                    <option value="177">177</option>
                                    <option value="178">178</option>
                                    <option value="179">179</option>
                                    <option value="180">180</option>
                                    <option value="More than 180">More than 180</option>
                                </select>
                            </div>

                            <!-- Geographical detail -->
                            <div class="form-group">
                                <label for="publicIpFollowUpMetaGeoState" class="form-label">Geographical detail of Client (State/UT)*</label>
                                <select id="publicIpFollowUpMetaGeoState" name="geographicalState" class="form-input" required>
                                    <option value="">Select State/UT</option>
                                    <option value="Andhra Pradesh">Andhra Pradesh</option>
                                    <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                    <option value="Assam">Assam</option>
                                    <option value="Bihar">Bihar</option>
                                    <option value="Chhattisgarh">Chhattisgarh</option>
                                    <option value="Goa">Goa</option>
                                    <option value="Gujarat">Gujarat</option>
                                    <option value="Haryana">Haryana</option>
                                    <option value="Himachal Pradesh">Himachal Pradesh</option>
                                    <option value="Jharkhand">Jharkhand</option>
                                    <option value="Karnataka">Karnataka</option>
                                    <option value="Kerala">Kerala</option>
                                    <option value="Madhya Pradesh">Madhya Pradesh</option>
                                    <option value="Maharashtra">Maharashtra</option>
                                    <option value="Manipur">Manipur</option>
                                    <option value="Meghalaya">Meghalaya</option>
                                    <option value="Mizoram">Mizoram</option>
                                    <option value="Nagaland">Nagaland</option>
                                    <option value="Odisha">Odisha</option>
                                    <option value="Punjab">Punjab</option>
                                    <option value="Rajasthan">Rajasthan</option>
                                    <option value="Sikkim">Sikkim</option>
                                    <option value="Tamil Nadu">Tamil Nadu</option>
                                    <option value="Telangana">Telangana</option>
                                    <option value="Tripura">Tripura</option>
                                    <option value="Uttar Pradesh">Uttar Pradesh</option>
                                    <option value="Uttarakhand">Uttarakhand</option>
                                    <option value="West Bengal">West Bengal</option>

                                    <!-- Union Territories -->
                                    <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                    <option value="Chandigarh">Chandigarh</option>
                                    <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                    <option value="Delhi">Delhi</option>
                                    <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                    <option value="Ladakh">Ladakh</option>
                                    <option value="Lakshadweep">Lakshadweep</option>
                                    <option value="Puducherry">Puducherry</option>

                                </select>
                            </div>

                            <!-- Date of Audit Completion -->
                            <div class="form-group">
                                <label for="publicIpFollowUpMetaDateCompletion" class="form-label">Date of Audit Completion*</label>
                                <input type="date" id="publicIpFollowUpMetaDateCompletion" name="dateAuditCompletion" class="form-input" required>
                            </div>

                            <!-- Date of last audit -->
                            <div class="form-group">
                                <label for="publicIpFollowUpMetaDateLastAudit" class="form-label">Date of last audit of same infrastructure*</label>
                                <input type="date" id="publicIpFollowUpMetaDateLastAudit" name="dateLastAudit" class="form-input" required>
                            </div>

                            <!-- Vulnerability Status Radio Buttons -->
                            <div class="form-group">
                                <label class="form-label" style="margin-bottom: 10px;">Vulnerability Status*</label>
                                <div style="display: flex; gap: 30px; margin-top: 10px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="0" required onchange="togglePublicIpFollowUpVulnerabilitySection()" style="width: auto;">
                                        <span>0 Vulnerability</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="has" required onchange="togglePublicIpFollowUpVulnerabilitySection()" style="width: auto;">
                                        <span>Has Vulnerability</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Vulnerability Details Section -->
                            <div id="publicIpFollowUpVulnerabilitySection" style="display: none;">
                                <div class="form-group">
                                    <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                        Audited Infrastructure Details
                                        <button type="button" class="submit-btn" onclick="addPublicIpFollowUpVulnerabilityEntry()" style="float: right; margin-top: -5px;">
                                            <i class="fas fa-plus"></i> Add Entry
                                        </button>
                                    </h4>
                                </div>

                                <div id="publicIpFollowUpVulnerabilityContainer">
                                <!-- First vulnerability entry -->
                                <div class="vulnerability-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Audited infrastructure details*</label>
                                        <input type="text" name="vuln_0_infrastructure" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                                        <input type="text" name="vuln_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CVE/CWE Reference Number*</label>
                                        <input type="text" name="vuln_0_cve" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Severity of Issue*</label>
                                        <select name="vuln_0_severity" class="form-input" required>
                                            <option value="">Select Severity</option>
                                            <option value="Critical">Critical</option>
                                            <option value="High">High</option>
                                            <option value="Medium">Medium</option>
                                            <option value="Low">Low</option>
                                            <option value="Informational">Informational</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                                        <input type="number" name="vuln_0_count" class="form-input" min="0" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Attributing Factor*</label>
                                        <select name="vuln_0_factor" class="form-input" required>
                                            <option value="">Select Factor</option>
                                            <option value="Coding Error">Coding Error</option>
                                            <option value="Configuration Error">Configuration Error</option>
                                            <option value="Deployment Error">Deployment Error</option>
                                            <option value="Design Error">Design Error</option>
                                            <option value="Operation Error">Operation Error</option>
                                            <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            </div>

                            <!-- Employee Details Section -->
                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                    Employee Details
                                    <button type="button" class="submit-btn" onclick="addPublicIpFollowUpEmployeeEntry()" style="float: right; margin-top: -5px;">
                                        <i class="fas fa-plus"></i> Add Employee
                                    </button>
                                </h4>
                            </div>

                            <div id="publicIpFollowUpEmployeeContainer">
                                <!-- First employee entry -->
                                <div class="employee-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Name of employee*</label>
                                        <input type="text" name="emp_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">E-mail ID*</label>
                                        <input type="email" name="emp_0_email" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISSP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cissp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cissp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cisa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cisa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISM*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cism" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cism" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">ISO*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_iso" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_iso" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">DISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_disa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_disa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">OSCP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_oscp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_oscp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CEH*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_ceh" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_ceh" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Others</label>
                                        <input type="text" name="emp_0_others" class="form-input" placeholder="Specify other certifications">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                                        <input type="number" name="emp_0_experience" class="form-input" min="0" step="0.5" required>
                                    </div>
                                </div>
                            </div>

                            <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                                <button type="button" class="btn btn-secondary" onclick="closeVaptModal('publicIpFollowUpAuditMetaDataModal')">Cancel</button>
                                <button type="submit" class="btn btn-primary" id="publicIpFollowUpAuditMetaDataSubmitBtn">
                                    <i class="fas fa-check"></i> Submit
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- API Follow Up Audit MetaData Modal -->
            <div id="apiFollowUpAuditMetaDataModal" class="modal">
                <div class="modal-content" style="max-width: 1000px;">
                    <div class="modal-header">
                        <h3>API Follow Up Audit MetaData</h3>
                        <span class="close-modal" onclick="closeVaptModal('apiFollowUpAuditMetaDataModal')">&times;</span>
                    </div>
                    <div class="modal-body scrollable-content">
                        <form id="apiFollowUpAuditMetaDataForm" method="POST" onsubmit="handleApiFollowUpAuditMetaDataSubmit(event)">
                            
                            <!-- Audit Dates -->
                            <div class="form-group">
                                <label for="apiFollowUpMetaStartDate" class="form-label">Start Audit Date*</label>
                                <input type="date" id="apiFollowUpMetaStartDate" name="startAuditDate" class="form-input" required>
                            </div>

                            <div class="form-group">
                                <label for="apiFollowUpMetaEndDate" class="form-label">End Audit Date*</label>
                                <input type="date" id="apiFollowUpMetaEndDate" name="endAuditDate" class="form-input" required>
                            </div>

                            <!-- Name of Auditee organization -->
                            <div class="form-group">
                                <label for="apiFollowUpMetaAuditeeOrg" class="form-label">Name of Auditee Organization*</label>
                                <select id="apiFollowUpMetaAuditeeOrg" name="nameOfAuditeeOrg" class="form-input" required onchange="toggleVaptOtherField('apiFollowUpMetaAuditeeOrg', 'apiFollowUpMetaAuditeeOrgOther')">
                                    <option value="">Select Organization</option>
                                    <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                    <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                    <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                    <option value="Megasoft Limited">Megasoft Limited</option>
                                    <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                    <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                    <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                    <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                    <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                    <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                    <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                    <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                    <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                    <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                    <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                    <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                    <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                    <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                    <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                    <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                    <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                    <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                    <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                    <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                    <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                    <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                    <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                    <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                    <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                    <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                    <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                    <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                    <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                    <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                    <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                    <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                    <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                    <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                    <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                    <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                    
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="apiFollowUpMetaAuditeeOrgOther" name="nameOfAuditeeOrgOther" class="form-input" placeholder="Specify organization name" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Category of Organization -->
                            <div class="form-group">
                                <label for="apiFollowUpMetaCategoryOrg" class="form-label">Category of Organization*</label>
                                <select id="apiFollowUpMetaCategoryOrg" name="categoryOfOrg" class="form-input" required>
                                    <option value="">Select Category</option>
                                    <option value="Central Ministry/Department">Central Ministry/Department</option>
                                    <option value="Organization under Government Department">Organization under Government Department</option>
                                    <option value="Private Sector" selected>Private Sector</option>
                                    <option value="Public sector organisations">Public sector organisations</option>
                                    <option value="State Government Department">State Government Department</option>
                                </select>
                            </div>

                            <!-- Sector of Organization -->
                            <div class="form-group">
                                <label for="apiFollowUpMetaSectorOrg" class="form-label">Sector of Organization*</label>
                                <select id="apiFollowUpMetaSectorOrg" name="sectorOfOrg" class="form-input" required onchange="updateApiFollowUpSubSectorOptions()">
                                    <option value="">Select Sector</option>
                                    <option value="Agriculture">Agriculture</option>
                                    <option value="Defence">Defence</option>
                                    <option value="Education">Education</option>
                                    <option value="Energy">Energy</option>
                                    <option value="Finance" selected>Finance</option>
                                    <option value="Healthcare">Healthcare</option>
                                    <option value="Information_and_Broadcasting">Information and Broadcasting</option>
                                    <option value="Information_and_Communication_Technology">Information and Communication Technology</option>
                                    <option value="Law_Enforcement_and_Security">Law Enforcement and Security</option>
                                    <option value="Public_Essential_Services_and_Utilities">Public Essential Services and Utilities</option>
                                    <option value="Space">Space</option>
                                    <option value="Transportation">Transportation</option>
                                </select>
                            </div>

                            <!-- Sub Sector -->
                            <div class="form-group">
                                <label for="apiFollowUpMetaSubSector" class="form-label">Sub Sector*</label>
                                <select id="apiFollowUpMetaSubSector" name="subSector" class="form-input" required>
                                    <option value="">Select Sector First</option>
                                </select>
                            </div>

                            <!-- Type of audit -->
                            <div class="form-group">
                                <label for="apiFollowUpMetaTypeAudit" class="form-label">Type of Audit*</label>
                                <select id="apiFollowUpMetaTypeAudit" name="typeOfAudit" class="form-input" required onchange="toggleVaptOtherField('apiFollowUpMetaTypeAudit', 'apiFollowUpMetaTypeAuditOther')">
                                    <option value="">Select Type</option>
                                    <option value="API Security Audit" selected>API Security Audit</option>
                                    <option value="Cloud Security Audit">Cloud Security Audit</option>
                                    <option value="Compliance to Standard/Framework/Policies Related Audit">Compliance to Standard/Framework/Policies Related Audit</option>
                                    <option value="Digital Forensic Readiness Assessment">Digital Forensic Readiness Assessment</option>
                                    <option value="Industrial Control Systems (ICS) / SCADA Audit">Industrial Control Systems (ICS) / SCADA Audit</option>
                                    <option value="IoT Security Assessment">IoT Security Assessment</option>
                                    <option value="Mobile Application Audit">Mobile Application Audit</option>
                                    <option value="Network Infrastructure Audits">Network Infrastructure Audits</option>
                                    <option value="Process Audit">Process Audit</option>
                                    <option value="Red Team Assessment">Red Team Assessment</option>
                                    <option value="Source Code Review">Source Code Review</option>
                                    <option value="VAPT-Infrastructure">VAPT-Infrastructure</option>
                                    <option value="VAPT-Application">VAPT-Application</option>
                                    <option value="Website /Web Application Audit">Website /Web Application Audit</option>
                                    <option value="Wireless security audit">Wireless security audit</option>
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="apiFollowUpMetaTypeAuditOther" name="typeOfAuditOther" class="form-input" placeholder="Please specify type of audit" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Details of website/application/infrastructure -->
                            <div class="form-group">
                                <label for="apiFollowUpMetaDetails" class="form-label">Details of web site/name of application/no. of servers, perimeter devices, other infrastructure*</label>
                                <textarea id="apiFollowUpMetaDetails" name="detailsOfWebsite" class="form-input" placeholder="Enter details" required rows="3"></textarea>
                            </div>

                            <!-- Reason for conducting Audit -->
                            <div class="form-group">
                                <label for="apiFollowUpMetaReason" class="form-label">Reason for conducting Audit*</label>
                                <select id="apiFollowUpMetaReason" name="reasonForAudit" class="form-input" required>
                                    <option value="">Select Reason</option>
                                    <option value="Certificate of compliance like ISO 27001">Certificate of compliance like ISO 27001</option>
                                    <option value="Certificate of safe hosting">Certificate of safe hosting</option>
                                    <option value="Change in process or infrastructure">Change in process or infrastructure</option>
                                    <option value="Government directions">Government directions</option>
                                    <option value="Incident/ Breach in Organisation">Incident/ Breach in Organisation</option>
                                    <option value="Incident/ Breach in Sector">Incident/ Breach in Sector</option>
                                    <option value="New application/ Infrastructure">New application/ Infrastructure</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Periodic Audit as per Policy of organisation.">Periodic Audit as per Policy of organisation.</option>
                                    <option value="Regulatory directions" selected>Regulatory directions</option>
                                    <option value="Third Party Initiated">Third Party Initiated</option>
                                </select>
                            </div>

                            <!-- Standards Used for conducting Audit -->
                            <div class="form-group">
                                <label for="apiFollowUpMetaStandards" class="form-label">Standards Used for conducting Audit*</label>
                                <input type="text" id="apiFollowUpMetaStandards" name="standardsUsed" class="form-input" placeholder="Enter standards" required>
                            </div>

                            <!-- Challenges in conducting Audits -->
                            <div class="form-group">
                                <label for="apiFollowUpMetaChallenges" class="form-label">Challenges in conducting Audits*</label>
                                <textarea id="apiFollowUpMetaChallenges" name="challenges" class="form-input" placeholder="Enter challenges" required rows="3"></textarea>
                            </div>

                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Compliance Questions</h4>
                            </div>

                            <!-- Compliance questions -->
                            <div class="form-group">
                                <label for="apiFollowUpMetaCompFinancial" class="form-label">Compliance to financial sector regulatory bodies guidelines/circulars/directions like from RBI, IRDAI, SEBI, NPCI*</label>
                                <select id="apiFollowUpMetaCompFinancial" name="complianceFinancial" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="apiFollowUpMetaCompRegulatory" class="form-label">Compliance to regulatory bodies guidelines/circulars/directions like from UIDAI, CCA, DoT, TRAI*</label>
                                <select id="apiFollowUpMetaCompRegulatory" name="complianceRegulatory" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="apiFollowUpMetaCompCertIn" class="form-label">Compliance to CERT-In directions under sub-section (6) of section 70B of the IT Act, 2000 dated 28 April, 2022*</label>
                                <select id="apiFollowUpMetaCompCertIn" name="complianceCertIn" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="apiFollowUpMetaCompCEA" class="form-label">Compliance to CEA (Cyber Security in Power Sector) guidelines 2021*</label>
                                <select id="apiFollowUpMetaCompCEA" name="complianceCEA" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="apiFollowUpMetaCompOther" class="form-label">Any other domestic regulation, directions, guidelines (Please Specify)*</label>
                                <select id="apiFollowUpMetaCompOther" name="complianceOther" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No" selected>No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <!-- Type of Audit Report -->
                            <div class="form-group">
                                <label for="apiFollowUpMetaTypeReport" class="form-label">Type of Audit Report*</label>
                                <select id="apiFollowUpMetaTypeReport" name="typeOfAuditReport" class="form-input" required>
                                    <option value="">Select Type</option>
                                    <option value="First Audit Report">First Audit Report</option>
                                    <option value="Follow up Audit Report" selected>Follow up Audit Report</option>
                                </select>
                            </div>

                            <!-- No. of vulnerabilities -->
                            <div class="form-group">
                                <label for="apiFollowUpMetaNumVuln" class="form-label">No. of vulnerabilities/ security issues reported during FIRST Audit*</label>
                                <input type="number" id="apiFollowUpMetaNumVuln" name="numVulnerabilities" class="form-input" placeholder="Enter number" min="0" required>
                            </div>

                            <!-- No. of days taken to patch -->
                            <div class="form-group">
                                <label for="apiFollowUpMetaDaysPatch" class="form-label">No. of days taken by Client to patch the vulnerabilities after submission of Audit report*</label>
                                <select id="apiFollowUpMetaDaysPatch" name="numDaysToPatch" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Follow up audit not performed">Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- Duration between audits -->
                            <div class="form-group">
                                <label for="apiFollowUpMetaDuration" class="form-label">Durations (in days) between end of FIRST audit and start of FOLLOW-UP/SECOND audit*</label>
                                <select id="apiFollowUpMetaDuration" name="durationBetweenAudits" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed">Follow up audit not performed</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- No. of open issues -->
                            <div class="form-group">
                                <label for="apiFollowUpMetaOpenIssues" class="form-label">No. of open issues after follow-up audits*</label>
                                <select id="apiFollowUpMetaOpenIssues" name="numOpenIssues" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed">Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="0">0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="101">101</option>
                                    <option value="102">102</option>
                                    <option value="103">103</option>
                                    <option value="104">104</option>
                                    <option value="105">105</option>
                                    <option value="106">106</option>
                                    <option value="107">107</option>
                                    <option value="108">108</option>
                                    <option value="109">109</option>
                                    <option value="110">110</option>
                                    <option value="111">111</option>
                                    <option value="112">112</option>
                                    <option value="113">113</option>
                                    <option value="114">114</option>
                                    <option value="115">115</option>
                                    <option value="116">116</option>
                                    <option value="117">117</option>
                                    <option value="118">118</option>
                                    <option value="119">119</option>
                                    <option value="120">120</option>
                                    <option value="121">121</option>
                                    <option value="122">122</option>
                                    <option value="123">123</option>
                                    <option value="124">124</option>
                                    <option value="125">125</option>
                                    <option value="126">126</option>
                                    <option value="127">127</option>
                                    <option value="128">128</option>
                                    <option value="129">129</option>
                                    <option value="130">130</option>
                                    <option value="131">131</option>
                                    <option value="132">132</option>
                                    <option value="133">133</option>
                                    <option value="134">134</option>
                                    <option value="135">135</option>
                                    <option value="136">136</option>
                                    <option value="137">137</option>
                                    <option value="138">138</option>
                                    <option value="139">139</option>
                                    <option value="140">140</option>
                                    <option value="141">141</option>
                                    <option value="142">142</option>
                                    <option value="143">143</option>
                                    <option value="144">144</option>
                                    <option value="145">145</option>
                                    <option value="146">146</option>
                                    <option value="147">147</option>
                                    <option value="148">148</option>
                                    <option value="149">149</option>
                                    <option value="150">150</option>
                                    <option value="151">151</option>
                                    <option value="152">152</option>
                                    <option value="153">153</option>
                                    <option value="154">154</option>
                                    <option value="155">155</option>
                                    <option value="156">156</option>
                                    <option value="157">157</option>
                                    <option value="158">158</option>
                                    <option value="159">159</option>
                                    <option value="160">160</option>
                                    <option value="161">161</option>
                                    <option value="162">162</option>
                                    <option value="163">163</option>
                                    <option value="164">164</option>
                                    <option value="165">165</option>
                                    <option value="166">166</option>
                                    <option value="167">167</option>
                                    <option value="168">168</option>
                                    <option value="169">169</option>
                                    <option value="170">170</option>
                                    <option value="171">171</option>
                                    <option value="172">172</option>
                                    <option value="173">173</option>
                                    <option value="174">174</option>
                                    <option value="175">175</option>
                                    <option value="176">176</option>
                                    <option value="177">177</option>
                                    <option value="178">178</option>
                                    <option value="179">179</option>
                                    <option value="180">180</option>
                                    <option value="More than 180">More than 180</option>
                                </select>
                            </div>

                            <!-- Geographical detail -->
                            <div class="form-group">
                                <label for="apiFollowUpMetaGeoState" class="form-label">Geographical detail of Client (State/UT)*</label>
                                <select id="apiFollowUpMetaGeoState" name="geographicalState" class="form-input" required>
                                    <option value="">Select State/UT</option>
                                    <option value="Andhra Pradesh">Andhra Pradesh</option>
                                    <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                    <option value="Assam">Assam</option>
                                    <option value="Bihar">Bihar</option>
                                    <option value="Chhattisgarh">Chhattisgarh</option>
                                    <option value="Goa">Goa</option>
                                    <option value="Gujarat">Gujarat</option>
                                    <option value="Haryana">Haryana</option>
                                    <option value="Himachal Pradesh">Himachal Pradesh</option>
                                    <option value="Jharkhand">Jharkhand</option>
                                    <option value="Karnataka">Karnataka</option>
                                    <option value="Kerala">Kerala</option>
                                    <option value="Madhya Pradesh">Madhya Pradesh</option>
                                    <option value="Maharashtra">Maharashtra</option>
                                    <option value="Manipur">Manipur</option>
                                    <option value="Meghalaya">Meghalaya</option>
                                    <option value="Mizoram">Mizoram</option>
                                    <option value="Nagaland">Nagaland</option>
                                    <option value="Odisha">Odisha</option>
                                    <option value="Punjab">Punjab</option>
                                    <option value="Rajasthan">Rajasthan</option>
                                    <option value="Sikkim">Sikkim</option>
                                    <option value="Tamil Nadu">Tamil Nadu</option>
                                    <option value="Telangana">Telangana</option>
                                    <option value="Tripura">Tripura</option>
                                    <option value="Uttar Pradesh">Uttar Pradesh</option>
                                    <option value="Uttarakhand">Uttarakhand</option>
                                    <option value="West Bengal">West Bengal</option>

                                    <!-- Union Territories -->
                                    <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                    <option value="Chandigarh">Chandigarh</option>
                                    <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                    <option value="Delhi">Delhi</option>
                                    <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                    <option value="Ladakh">Ladakh</option>
                                    <option value="Lakshadweep">Lakshadweep</option>
                                    <option value="Puducherry">Puducherry</option>

                                </select>
                            </div>

                            <!-- Date of Audit Completion -->
                            <div class="form-group">
                                <label for="apiFollowUpMetaDateCompletion" class="form-label">Date of Audit Completion*</label>
                                <input type="date" id="apiFollowUpMetaDateCompletion" name="dateAuditCompletion" class="form-input" required>
                            </div>

                            <!-- Date of last audit -->
                            <div class="form-group">
                                <label for="apiFollowUpMetaDateLastAudit" class="form-label">Date of last audit of same infrastructure*</label>
                                <input type="date" id="apiFollowUpMetaDateLastAudit" name="dateLastAudit" class="form-input" required>
                            </div>

                            <!-- Vulnerability Status Radio Buttons -->
                            <div class="form-group">
                                <label class="form-label" style="margin-bottom: 10px;">Vulnerability Status*</label>
                                <div style="display: flex; gap: 30px; margin-top: 10px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="0" required onchange="toggleApiFollowUpVulnerabilitySection()" style="width: auto;">
                                        <span>0 Vulnerability</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="has" required onchange="toggleApiFollowUpVulnerabilitySection()" style="width: auto;">
                                        <span>Has Vulnerability</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Vulnerability Details Section -->
                            <div id="apiFollowUpVulnerabilitySection" style="display: none;">
                                <div class="form-group">
                                    <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                        Audited Infrastructure Details
                                        <button type="button" class="submit-btn" onclick="addApiFollowUpVulnerabilityEntry()" style="float: right; margin-top: -5px;">
                                            <i class="fas fa-plus"></i> Add Entry
                                        </button>
                                    </h4>
                                </div>

                                <div id="apiFollowUpVulnerabilityContainer">
                                <!-- First vulnerability entry -->
                                <div class="vulnerability-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Audited infrastructure details*</label>
                                        <input type="text" name="vuln_0_infrastructure" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                                        <input type="text" name="vuln_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CVE/CWE Reference Number*</label>
                                        <input type="text" name="vuln_0_cve" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Severity of Issue*</label>
                                        <select name="vuln_0_severity" class="form-input" required>
                                            <option value="">Select Severity</option>
                                            <option value="Critical">Critical</option>
                                            <option value="High">High</option>
                                            <option value="Medium">Medium</option>
                                            <option value="Low">Low</option>
                                            <option value="Informational">Informational</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                                        <input type="number" name="vuln_0_count" class="form-input" min="0" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Attributing Factor*</label>
                                        <select name="vuln_0_factor" class="form-input" required>
                                            <option value="">Select Factor</option>
                                            <option value="Coding Error">Coding Error</option>
                                            <option value="Configuration Error">Configuration Error</option>
                                            <option value="Deployment Error">Deployment Error</option>
                                            <option value="Design Error">Design Error</option>
                                            <option value="Operation Error">Operation Error</option>
                                            <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            </div>

                            <!-- Employee Details Section -->
                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                    Employee Details
                                    <button type="button" class="submit-btn" onclick="addApiFollowUpEmployeeEntry()" style="float: right; margin-top: -5px;">
                                        <i class="fas fa-plus"></i> Add Employee
                                    </button>
                                </h4>
                            </div>

                            <div id="apiFollowUpEmployeeContainer">
                                <!-- First employee entry -->
                                <div class="employee-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Name of employee*</label>
                                        <input type="text" name="emp_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">E-mail ID*</label>
                                        <input type="email" name="emp_0_email" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISSP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cissp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cissp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cisa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cisa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISM*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cism" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cism" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">ISO*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_iso" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_iso" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">DISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_disa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_disa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">OSCP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_oscp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_oscp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CEH*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_ceh" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_ceh" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Others</label>
                                        <input type="text" name="emp_0_others" class="form-input" placeholder="Specify other certifications">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                                        <input type="number" name="emp_0_experience" class="form-input" min="0" step="0.5" required>
                                    </div>
                                </div>
                            </div>

                            <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                                <button type="button" class="btn btn-secondary" onclick="closeVaptModal('apiFollowUpAuditMetaDataModal')">Cancel</button>
                                <button type="submit" class="btn btn-primary" id="apiFollowUpAuditMetaDataSubmitBtn">
                                    <i class="fas fa-check"></i> Submit
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Website VAPT Follow Up Audit MetaData Modal -->
            <div id="websiteVaptFollowUpAuditMetaDataModal" class="modal">
                <div class="modal-content" style="max-width: 1000px;">
                    <div class="modal-header">
                        <h3>Website Follow Up Audit MetaData</h3>
                        <span class="close-modal" onclick="closeVaptModal('websiteVaptFollowUpAuditMetaDataModal')">&times;</span>
                    </div>
                    <div class="modal-body scrollable-content">
                        <form id="websiteVaptFollowUpAuditMetaDataForm" method="POST" onsubmit="handleWebsiteVaptFollowUpAuditMetaDataSubmit(event)">
                            
                            <!-- Audit Dates -->
                            <div class="form-group">
                                <label for="websiteVaptFollowUpMetaStartDate" class="form-label">Start Audit Date*</label>
                                <input type="date" id="websiteVaptFollowUpMetaStartDate" name="startAuditDate" class="form-input" required>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpMetaEndDate" class="form-label">End Audit Date*</label>
                                <input type="date" id="websiteVaptFollowUpMetaEndDate" name="endAuditDate" class="form-input" required>
                            </div>

                            <!-- Name of Auditee organization -->
                            <div class="form-group">
                                <label for="websiteVaptFollowUpMetaAuditeeOrg" class="form-label">Name of Auditee Organization*</label>
                                <select id="websiteVaptFollowUpMetaAuditeeOrg" name="nameOfAuditeeOrg" class="form-input" required onchange="toggleWebsiteVaptOtherField('websiteVaptFollowUpMetaAuditeeOrg', 'websiteVaptFollowUpMetaAuditeeOrgOther')">
                                    <option value="">Select Organization</option>
                                    <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                    <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                    <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                    <option value="Megasoft Limited">Megasoft Limited</option>
                                    <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                    <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                    <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                    <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                    <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                    <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                    <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                    <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                    <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                    <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                    <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                    <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                    <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                    <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                    <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                    <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                    <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                    <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                    <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                    <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                    <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                    <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                    <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                    <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                    <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                    <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                    <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                    <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                    <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                    <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                    <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                    <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                    <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                    <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                    <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                    <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                    
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="websiteVaptFollowUpMetaAuditeeOrgOther" name="nameOfAuditeeOrgOther" class="form-input" placeholder="Specify organization name" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Category of Organization -->
                            <div class="form-group">
                                <label for="websiteVaptFollowUpMetaCategoryOrg" class="form-label">Category of Organization*</label>
                                <select id="websiteVaptFollowUpMetaCategoryOrg" name="categoryOfOrg" class="form-input" required>
                                    <option value="">Select Category</option>
                                    <option value="Central Ministry/Department">Central Ministry/Department</option>
                                    <option value="Organization under Government Department">Organization under Government Department</option>
                                    <option value="Private Sector" selected>Private Sector</option>
                                    <option value="Public sector organisations">Public sector organisations</option>
                                    <option value="State Government Department">State Government Department</option>
                                </select>
                            </div>

                            <!-- Sector of Organization -->
                            <div class="form-group">
                                <label for="websiteVaptFollowUpMetaSectorOrg" class="form-label">Sector of Organization*</label>
                                <select id="websiteVaptFollowUpMetaSectorOrg" name="sectorOfOrg" class="form-input" required onchange="updateWebsiteVaptFollowUpSubSectorOptions()">
                                    <option value="">Select Sector</option>
                                    <option value="Agriculture">Agriculture</option>
                                    <option value="Defence">Defence</option>
                                    <option value="Education">Education</option>
                                    <option value="Energy">Energy</option>
                                    <option value="Finance" selected>Finance</option>
                                    <option value="Healthcare">Healthcare</option>
                                    <option value="Information_and_Broadcasting">Information and Broadcasting</option>
                                    <option value="Information_and_Communication_Technology">Information and Communication Technology</option>
                                    <option value="Law_Enforcement_and_Security">Law Enforcement and Security</option>
                                    <option value="Public_Essential_Services_and_Utilities">Public Essential Services and Utilities</option>
                                    <option value="Space">Space</option>
                                    <option value="Transportation">Transportation</option>
                                </select>
                            </div>

                            <!-- Sub Sector -->
                            <div class="form-group">
                                <label for="websiteVaptFollowUpMetaSubSector" class="form-label">Sub Sector*</label>
                                <select id="websiteVaptFollowUpMetaSubSector" name="subSector" class="form-input" required>
                                    <option value="">Select Sector First</option>
                                </select>
                            </div>

                            <!-- Type of audit -->
                            <div class="form-group">
                                <label for="websiteVaptFollowUpMetaTypeAudit" class="form-label">Type of Audit*</label>
                                <select id="websiteVaptFollowUpMetaTypeAudit" name="typeOfAudit" class="form-input" required onchange="toggleWebsiteVaptOtherField('websiteVaptFollowUpMetaTypeAudit', 'websiteVaptFollowUpMetaTypeAuditOther')">
                                    <option value="">Select Type</option>
                                    <option value="API Security Audit">API Security Audit</option>
                                    <option value="Cloud Security Audit">Cloud Security Audit</option>
                                    <option value="Compliance to Standard/Framework/Policies Related Audit">Compliance to Standard/Framework/Policies Related Audit</option>
                                    <option value="Digital Forensic Readiness Assessment">Digital Forensic Readiness Assessment</option>
                                    <option value="Industrial Control Systems (ICS) / SCADA Audit">Industrial Control Systems (ICS) / SCADA Audit</option>
                                    <option value="IoT Security Assessment">IoT Security Assessment</option>
                                    <option value="Mobile Application Audit">Mobile Application Audit</option>
                                    <option value="Network Infrastructure Audits">Network Infrastructure Audits</option>
                                    <option value="Process Audit">Process Audit</option>
                                    <option value="Red Team Assessment">Red Team Assessment</option>
                                    <option value="Source Code Review">Source Code Review</option>
                                    <option value="Website /Web Application Audit" selected>Website /Web Application Audit</option>
                                    <option value="VAPT-Application">VAPT-Application</option>
                                    <option value="VAPT-Infrastructure">VAPT-Infrastructure</option>
                                    <option value="Wireless security audit">Wireless security audit</option>
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="websiteVaptFollowUpMetaTypeAuditOther" name="typeOfAuditOther" class="form-input" placeholder="Please specify type of audit" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Details of website/application/infrastructure -->
                            <div class="form-group">
                                <label for="websiteVaptFollowUpMetaDetails" class="form-label">Details of web site/name of application/no. of servers, perimeter devices, other infrastructure*</label>
                                <textarea id="websiteVaptFollowUpMetaDetails" name="detailsOfWebsite" class="form-input" placeholder="Enter details" required rows="3"></textarea>
                            </div>

                            <!-- Reason for conducting Audit -->
                            <div class="form-group">
                                <label for="websiteVaptFollowUpMetaReason" class="form-label">Reason for conducting Audit*</label>
                                <select id="websiteVaptFollowUpMetaReason" name="reasonForAudit" class="form-input" required>
                                    <option value="">Select Reason</option>
                                    <option value="Certificate of compliance like ISO 27001">Certificate of compliance like ISO 27001</option>
                                    <option value="Certificate of safe hosting">Certificate of safe hosting</option>
                                    <option value="Change in process or infrastructure">Change in process or infrastructure</option>
                                    <option value="Government directions">Government directions</option>
                                    <option value="Incident/ Breach in Organisation">Incident/ Breach in Organisation</option>
                                    <option value="Incident/ Breach in Sector">Incident/ Breach in Sector</option>
                                    <option value="New application/ Infrastructure">New application/ Infrastructure</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Periodic Audit as per Policy of organisation.">Periodic Audit as per Policy of organisation.</option>
                                    <option value="Regulatory directions" selected>Regulatory directions</option>
                                    <option value="Third Party Initiated">Third Party Initiated</option>
                                </select>
                            </div>

                            <!-- Standards Used for conducting Audit -->
                            <div class="form-group">
                                <label for="websiteVaptFollowUpMetaStandards" class="form-label">Standards Used for conducting Audit*</label>
                                <input type="text" id="websiteVaptFollowUpMetaStandards" name="standardsUsed" class="form-input" placeholder="Enter standards" required>
                            </div>

                            <!-- Challenges in conducting Audits -->
                            <div class="form-group">
                                <label for="websiteVaptFollowUpMetaChallenges" class="form-label">Challenges in conducting Audits*</label>
                                <textarea id="websiteVaptFollowUpMetaChallenges" name="challenges" class="form-input" placeholder="Enter challenges" required rows="3"></textarea>
                            </div>

                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Compliance Questions</h4>
                            </div>

                            <!-- Compliance questions -->
                            <div class="form-group">
                                <label for="websiteVaptFollowUpMetaCompFinancial" class="form-label">Compliance to financial sector regulatory bodies guidelines/circulars/directions like from RBI, IRDAI, SEBI, NPCI*</label>
                                <select id="websiteVaptFollowUpMetaCompFinancial" name="complianceFinancial" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpMetaCompRegulatory" class="form-label">Compliance to regulatory bodies guidelines/circulars/directions like from UIDAI, CCA, DoT, TRAI*</label>
                                <select id="websiteVaptFollowUpMetaCompRegulatory" name="complianceRegulatory" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpMetaCompCertIn" class="form-label">Compliance to CERT-In directions under sub-section (6) of section 70B of the IT Act, 2000 dated 28 April, 2022*</label>
                                <select id="websiteVaptFollowUpMetaCompCertIn" name="complianceCertIn" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpMetaCompCEA" class="form-label">Compliance to CEA (Cyber Security in Power Sector) guidelines 2021*</label>
                                <select id="websiteVaptFollowUpMetaCompCEA" name="complianceCEA" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpMetaCompOther" class="form-label">Any other domestic regulation, directions, guidelines (Please Specify)*</label>
                                <select id="websiteVaptFollowUpMetaCompOther" name="complianceOther" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No" selected>No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <!-- Type of Audit Report -->
                            <div class="form-group">
                                <label for="websiteVaptFollowUpMetaTypeReport" class="form-label">Type of Audit Report*</label>
                                <select id="websiteVaptFollowUpMetaTypeReport" name="typeOfAuditReport" class="form-input" required>
                                    <option value="">Select Type</option>
                                    <option value="First Audit Report">First Audit Report</option>
                                    <option value="Follow up Audit Report" selected>Follow up Audit Report</option>
                                </select>
                            </div>

                            <!-- No. of vulnerabilities -->
                            <div class="form-group">
                                <label for="websiteVaptFollowUpMetaNumVuln" class="form-label">No. of vulnerabilities/ security issues reported during FIRST Audit*</label>
                                <input type="number" id="websiteVaptFollowUpMetaNumVuln" name="numVulnerabilities" class="form-input" placeholder="Enter number" min="0" required>
                            </div>

                            <!-- No. of days taken to patch -->
                            <div class="form-group">
                                <label for="websiteVaptFollowUpMetaDaysPatch" class="form-label">No. of days taken by Client to patch the vulnerabilities after submission of Audit report*</label>
                                <select id="websiteVaptFollowUpMetaDaysPatch" name="numDaysToPatch" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Follow up audit not performed">Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- Duration between audits -->
                            <div class="form-group">
                                <label for="websiteVaptFollowUpMetaDuration" class="form-label">Durations (in days) between end of FIRST audit and start of FOLLOW-UP/SECOND audit*</label>
                                <select id="websiteVaptFollowUpMetaDuration" name="durationBetweenAudits" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed">Follow up audit not performed</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- No. of open issues -->
                            <div class="form-group">
                                <label for="websiteVaptFollowUpMetaOpenIssues" class="form-label">No. of open issues after follow-up audits*</label>
                                <select id="websiteVaptFollowUpMetaOpenIssues" name="numOpenIssues" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed">Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="0">0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="101">101</option>
                                    <option value="102">102</option>
                                    <option value="103">103</option>
                                    <option value="104">104</option>
                                    <option value="105">105</option>
                                    <option value="106">106</option>
                                    <option value="107">107</option>
                                    <option value="108">108</option>
                                    <option value="109">109</option>
                                    <option value="110">110</option>
                                    <option value="111">111</option>
                                    <option value="112">112</option>
                                    <option value="113">113</option>
                                    <option value="114">114</option>
                                    <option value="115">115</option>
                                    <option value="116">116</option>
                                    <option value="117">117</option>
                                    <option value="118">118</option>
                                    <option value="119">119</option>
                                    <option value="120">120</option>
                                    <option value="121">121</option>
                                    <option value="122">122</option>
                                    <option value="123">123</option>
                                    <option value="124">124</option>
                                    <option value="125">125</option>
                                    <option value="126">126</option>
                                    <option value="127">127</option>
                                    <option value="128">128</option>
                                    <option value="129">129</option>
                                    <option value="130">130</option>
                                    <option value="131">131</option>
                                    <option value="132">132</option>
                                    <option value="133">133</option>
                                    <option value="134">134</option>
                                    <option value="135">135</option>
                                    <option value="136">136</option>
                                    <option value="137">137</option>
                                    <option value="138">138</option>
                                    <option value="139">139</option>
                                    <option value="140">140</option>
                                    <option value="141">141</option>
                                    <option value="142">142</option>
                                    <option value="143">143</option>
                                    <option value="144">144</option>
                                    <option value="145">145</option>
                                    <option value="146">146</option>
                                    <option value="147">147</option>
                                    <option value="148">148</option>
                                    <option value="149">149</option>
                                    <option value="150">150</option>
                                    <option value="151">151</option>
                                    <option value="152">152</option>
                                    <option value="153">153</option>
                                    <option value="154">154</option>
                                    <option value="155">155</option>
                                    <option value="156">156</option>
                                    <option value="157">157</option>
                                    <option value="158">158</option>
                                    <option value="159">159</option>
                                    <option value="160">160</option>
                                    <option value="161">161</option>
                                    <option value="162">162</option>
                                    <option value="163">163</option>
                                    <option value="164">164</option>
                                    <option value="165">165</option>
                                    <option value="166">166</option>
                                    <option value="167">167</option>
                                    <option value="168">168</option>
                                    <option value="169">169</option>
                                    <option value="170">170</option>
                                    <option value="171">171</option>
                                    <option value="172">172</option>
                                    <option value="173">173</option>
                                    <option value="174">174</option>
                                    <option value="175">175</option>
                                    <option value="176">176</option>
                                    <option value="177">177</option>
                                    <option value="178">178</option>
                                    <option value="179">179</option>
                                    <option value="180">180</option>
                                    <option value="More than 180">More than 180</option>
                                </select>
                            </div>

                            <!-- Geographical detail -->
                            <div class="form-group">
                                <label for="websiteVaptFollowUpMetaGeoState" class="form-label">Geographical detail of Client (State/UT)*</label>
                                <select id="websiteVaptFollowUpMetaGeoState" name="geographicalState" class="form-input" required>
                                    <option value="">Select State/UT</option>
                                    <option value="Andhra Pradesh">Andhra Pradesh</option>
                                    <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                    <option value="Assam">Assam</option>
                                    <option value="Bihar">Bihar</option>
                                    <option value="Chhattisgarh">Chhattisgarh</option>
                                    <option value="Goa">Goa</option>
                                    <option value="Gujarat">Gujarat</option>
                                    <option value="Haryana">Haryana</option>
                                    <option value="Himachal Pradesh">Himachal Pradesh</option>
                                    <option value="Jharkhand">Jharkhand</option>
                                    <option value="Karnataka">Karnataka</option>
                                    <option value="Kerala">Kerala</option>
                                    <option value="Madhya Pradesh">Madhya Pradesh</option>
                                    <option value="Maharashtra">Maharashtra</option>
                                    <option value="Manipur">Manipur</option>
                                    <option value="Meghalaya">Meghalaya</option>
                                    <option value="Mizoram">Mizoram</option>
                                    <option value="Nagaland">Nagaland</option>
                                    <option value="Odisha">Odisha</option>
                                    <option value="Punjab">Punjab</option>
                                    <option value="Rajasthan">Rajasthan</option>
                                    <option value="Sikkim">Sikkim</option>
                                    <option value="Tamil Nadu">Tamil Nadu</option>
                                    <option value="Telangana">Telangana</option>
                                    <option value="Tripura">Tripura</option>
                                    <option value="Uttar Pradesh">Uttar Pradesh</option>
                                    <option value="Uttarakhand">Uttarakhand</option>
                                    <option value="West Bengal">West Bengal</option>

                                    <!-- Union Territories -->
                                    <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                    <option value="Chandigarh">Chandigarh</option>
                                    <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                    <option value="Delhi">Delhi</option>
                                    <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                    <option value="Ladakh">Ladakh</option>
                                    <option value="Lakshadweep">Lakshadweep</option>
                                    <option value="Puducherry">Puducherry</option>

                                </select>
                            </div>

                            <!-- Date of Audit Completion -->
                            <div class="form-group">
                                <label for="websiteVaptFollowUpMetaDateCompletion" class="form-label">Date of Audit Completion*</label>
                                <input type="date" id="websiteVaptFollowUpMetaDateCompletion" name="dateAuditCompletion" class="form-input" required>
                            </div>

                            <!-- Date of last audit -->
                            <div class="form-group">
                                <label for="websiteVaptFollowUpMetaDateLastAudit" class="form-label">Date of last audit of same infrastructure*</label>
                                <input type="date" id="websiteVaptFollowUpMetaDateLastAudit" name="dateLastAudit" class="form-input" required>
                            </div>

                            <!-- Vulnerability Status Radio Buttons -->
                            <div class="form-group">
                                <label class="form-label" style="margin-bottom: 10px;">Vulnerability Status*</label>
                                <div style="display: flex; gap: 30px; margin-top: 10px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="0" required onchange="toggleWebsiteVaptFollowUpVulnerabilitySection()" style="width: auto;">
                                        <span>0 Vulnerability</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="has" required onchange="toggleWebsiteVaptFollowUpVulnerabilitySection()" style="width: auto;">
                                        <span>Has Vulnerability</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Vulnerability Details Section -->
                            <div id="websiteVaptFollowUpVulnerabilitySection" style="display: none;">
                                <div class="form-group">
                                    <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                        Audited Infrastructure Details
                                        <button type="button" class="submit-btn" onclick="addWebsiteVaptFollowUpVulnerabilityEntry()" style="float: right; margin-top: -5px;">
                                            <i class="fas fa-plus"></i> Add Entry
                                        </button>
                                    </h4>
                                </div>

                                <div id="websiteVaptFollowUpVulnerabilityContainer">
                                <!-- First vulnerability entry -->
                                <div class="vulnerability-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Audited infrastructure details*</label>
                                        <input type="text" name="vuln_0_infrastructure" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                                        <input type="text" name="vuln_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CVE/CWE Reference Number*</label>
                                        <input type="text" name="vuln_0_cve" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Severity of Issue*</label>
                                        <select name="vuln_0_severity" class="form-input" required>
                                            <option value="">Select Severity</option>
                                            <option value="Critical">Critical</option>
                                            <option value="High">High</option>
                                            <option value="Medium">Medium</option>
                                            <option value="Low">Low</option>
                                            <option value="Informational">Informational</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                                        <input type="number" name="vuln_0_count" class="form-input" min="0" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Attributing Factor*</label>
                                        <select name="vuln_0_factor" class="form-input" required>
                                            <option value="">Select Factor</option>
                                            <option value="Coding Error">Coding Error</option>
                                            <option value="Configuration Error">Configuration Error</option>
                                            <option value="Deployment Error">Deployment Error</option>
                                            <option value="Design Error">Design Error</option>
                                            <option value="Operation Error">Operation Error</option>
                                            <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            </div>

                            <!-- Employee Details Section -->
                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                    Employee Details
                                    <button type="button" class="submit-btn" onclick="addWebsiteVaptFollowUpEmployeeEntry()" style="float: right; margin-top: -5px;">
                                        <i class="fas fa-plus"></i> Add Employee
                                    </button>
                                </h4>
                            </div>

                            <div id="websiteVaptFollowUpEmployeeContainer">
                                <!-- First employee entry -->
                                <div class="employee-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Name of employee*</label>
                                        <input type="text" name="emp_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">E-mail ID*</label>
                                        <input type="email" name="emp_0_email" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISSP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cissp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cissp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cisa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cisa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISM*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cism" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cism" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">ISO*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_iso" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_iso" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">DISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_disa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_disa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">OSCP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_oscp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_oscp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CEH*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_ceh" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_ceh" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Others</label>
                                        <input type="text" name="emp_0_others" class="form-input" placeholder="Specify other certifications">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                                        <input type="number" name="emp_0_experience" class="form-input" min="0" step="0.5" required>
                                    </div>
                                </div>
                            </div>

                            <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                                <button type="button" class="btn btn-secondary" onclick="closeVaptModal('websiteVaptFollowUpAuditMetaDataModal')">Cancel</button>
                                <button type="submit" class="btn btn-primary" id="websiteVaptFollowUpAuditMetaDataSubmitBtn">
                                    <i class="fas fa-check"></i> Submit
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>


            <!-- Website VAPT First Audit MetaData Modal -->
            <div id="websiteVaptFirstAuditMetaDataModal" class="modal">
                <div class="modal-content" style="max-width: 1000px;">
                    <div class="modal-header">
                        <h3>Website First Audit MetaData</h3>
                        <span class="close-modal" onclick="closeVaptModal('websiteVaptFirstAuditMetaDataModal')">&times;</span>
                    </div>
                    <div class="modal-body scrollable-content">
                        <form id="websiteVaptFirstAuditMetaDataForm" method="POST" onsubmit="handleWebsiteVaptFirstAuditMetaDataSubmit(event)">
                            
                            <!-- Audit Dates -->
                            <div class="form-group">
                                <label for="websiteVaptMetaStartDate" class="form-label">Start Audit Date*</label>
                                <input type="date" id="websiteVaptMetaStartDate" name="startAuditDate" class="form-input" required>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptMetaEndDate" class="form-label">End Audit Date*</label>
                                <input type="date" id="websiteVaptMetaEndDate" name="endAuditDate" class="form-input" required>
                            </div>

                            <!-- Name of Auditee organization -->
                            <div class="form-group">
                                <label for="websiteVaptMetaAuditeeOrg" class="form-label">Name of Auditee Organization*</label>
                                <select id="websiteVaptMetaAuditeeOrg" name="nameOfAuditeeOrg" class="form-input" required onchange="toggleWebsiteVaptOtherField('websiteVaptMetaAuditeeOrg', 'websiteVaptMetaAuditeeOrgOther')">
                                    <option value="">Select Organization</option>
                                    <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                    <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                    <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                    <option value="Megasoft Limited">Megasoft Limited</option>
                                    <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                    <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                    <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                    <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                    <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                    <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                    <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                    <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                    <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                    <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                    <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                    <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                    <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                    <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                    <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                    <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                    <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                    <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                    <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                    <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                    <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                    <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                    <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                    <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                    <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                    <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                    <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                    <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                    <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                    <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                    <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                    <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                    <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                    <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                    <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                    <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                    
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="websiteVaptMetaAuditeeOrgOther" name="nameOfAuditeeOrgOther" class="form-input" placeholder="Specify organization name" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Category of Organization -->
                            <div class="form-group">
                                <label for="websiteVaptMetaCategoryOrg" class="form-label">Category of Organization*</label>
                                <select id="websiteVaptMetaCategoryOrg" name="categoryOfOrg" class="form-input" required>
                                    <option value="">Select Category</option>
                                    <option value="Central Ministry/Department">Central Ministry/Department</option>
                                    <option value="Organization under Government Department">Organization under Government Department</option>
                                    <option value="Private Sector" selected>Private Sector</option>
                                    <option value="Public sector organisations">Public sector organisations</option>
                                    <option value="State Government Department">State Government Department</option>
                                </select>
                            </div>

                            <!-- Sector of Organization -->
                            <div class="form-group">
                                <label for="websiteVaptMetaSectorOrg" class="form-label">Sector of Organization*</label>
                                <select id="websiteVaptMetaSectorOrg" name="sectorOfOrg" class="form-input" required onchange="updateWebsiteVaptSubSectorOptions()">
                                    <option value="">Select Sector</option>
                                    <option value="Agriculture">Agriculture</option>
                                    <option value="Defence">Defence</option>
                                    <option value="Education">Education</option>
                                    <option value="Energy">Energy</option>
                                    <option value="Finance" selected>Finance</option>
                                    <option value="Healthcare">Healthcare</option>
                                    <option value="Information_and_Broadcasting">Information and Broadcasting</option>
                                    <option value="Information_and_Communication_Technology">Information and Communication Technology</option>
                                    <option value="Law_Enforcement_and_Security">Law Enforcement and Security</option>
                                    <option value="Public_Essential_Services_and_Utilities">Public Essential Services and Utilities</option>
                                    <option value="Space">Space</option>
                                    <option value="Transportation">Transportation</option>
                                </select>
                            </div>

                            <!-- Sub Sector -->
                            <div class="form-group">
                                <label for="websiteVaptMetaSubSector" class="form-label">Sub Sector*</label>
                                <select id="websiteVaptMetaSubSector" name="subSector" class="form-input" required>
                                    <option value="">Select Sector First</option>
                                </select>
                            </div>

                            <!-- Type of audit -->
                            <div class="form-group">
                                <label for="websiteVaptMetaTypeAudit" class="form-label">Type of Audit*</label>
                                <select id="websiteVaptMetaTypeAudit" name="typeOfAudit" class="form-input" required onchange="toggleWebsiteVaptOtherField('websiteVaptMetaTypeAudit', 'websiteVaptMetaTypeAuditOther')">
                                    <option value="">Select Type</option>
                                    <option value="API Security Audit">API Security Audit</option>
                                    <option value="Cloud Security Audit">Cloud Security Audit</option>
                                    <option value="Compliance to Standard/Framework/Policies Related Audit">Compliance to Standard/Framework/Policies Related Audit</option>
                                    <option value="Digital Forensic Readiness Assessment">Digital Forensic Readiness Assessment</option>
                                    <option value="Industrial Control Systems (ICS) / SCADA Audit">Industrial Control Systems (ICS) / SCADA Audit</option>
                                    <option value="IoT Security Assessment">IoT Security Assessment</option>
                                    <option value="Mobile Application Audit">Mobile Application Audit</option>
                                    <option value="Network Infrastructure Audits">Network Infrastructure Audits</option>
                                    <option value="Process Audit">Process Audit</option>
                                    <option value="Red Team Assessment">Red Team Assessment</option>
                                    <option value="Source Code Review">Source Code Review</option>
                                    <option value="VAPT-Infrastructure">VAPT-Infrastructure</option>
                                    <option value="VAPT-Application">VAPT-Application</option>
                                    <option value="Website /Web Application Audit" selected>Website /Web Application Audit</option>
                                    <option value="Wireless security audit">Wireless security audit</option>
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="websiteVaptMetaTypeAuditOther" name="typeOfAuditOther" class="form-input" placeholder="Please specify type of audit" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Details of website/application/infrastructure -->
                            <div class="form-group">
                                <label for="websiteVaptMetaDetails" class="form-label">Details of web site/name of application/no. of servers, perimeter devices, other infrastructure*</label>
                                <textarea id="websiteVaptMetaDetails" name="detailsOfWebsite" class="form-input" placeholder="Enter details" required rows="3"></textarea>
                            </div>

                            <!-- Reason for conducting Audit -->
                            <div class="form-group">
                                <label for="websiteVaptMetaReason" class="form-label">Reason for conducting Audit*</label>
                                <select id="websiteVaptMetaReason" name="reasonForAudit" class="form-input" required>
                                    <option value="">Select Reason</option>
                                    <option value="Certificate of compliance like ISO 27001">Certificate of compliance like ISO 27001</option>
                                    <option value="Certificate of safe hosting">Certificate of safe hosting</option>
                                    <option value="Change in process or infrastructure">Change in process or infrastructure</option>
                                    <option value="Government directions">Government directions</option>
                                    <option value="Incident/ Breach in Organisation">Incident/ Breach in Organisation</option>
                                    <option value="Incident/ Breach in Sector">Incident/ Breach in Sector</option>
                                    <option value="New application/ Infrastructure">New application/ Infrastructure</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Periodic Audit as per Policy of organisation.">Periodic Audit as per Policy of organisation.</option>
                                    <option value="Regulatory directions" selected>Regulatory directions</option>
                                    <option value="Third Party Initiated">Third Party Initiated</option>
                                </select>
                            </div>

                            <!-- Standards Used for conducting Audit -->
                            <div class="form-group">
                                <label for="websiteVaptMetaStandards" class="form-label">Standards Used for conducting Audit*</label>
                                <input type="text" id="websiteVaptMetaStandards" name="standardsUsed" class="form-input" placeholder="Enter standards" required>
                            </div>

                            <!-- Challenges in conducting Audits -->
                            <div class="form-group">
                                <label for="websiteVaptMetaChallenges" class="form-label">Challenges in conducting Audits*</label>
                                <textarea id="websiteVaptMetaChallenges" name="challenges" class="form-input" placeholder="Enter challenges" required rows="3"></textarea>
                            </div>

                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Compliance Questions</h4>
                            </div>

                            <!-- Compliance questions -->
                            <div class="form-group">
                                <label for="websiteVaptMetaCompFinancial" class="form-label">Compliance to financial sector regulatory bodies guidelines/circulars/directions like from RBI, IRDAI, SEBI, NPCI*</label>
                                <select id="websiteVaptMetaCompFinancial" name="complianceFinancial" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptMetaCompRegulatory" class="form-label">Compliance to regulatory bodies guidelines/circulars/directions like from UIDAI, CCA, DoT, TRAI*</label>
                                <select id="websiteVaptMetaCompRegulatory" name="complianceRegulatory" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptMetaCompCertIn" class="form-label">Compliance to CERT-In directions under sub-section (6) of section 70B of the IT Act, 2000 dated 28 April, 2022*</label>
                                <select id="websiteVaptMetaCompCertIn" name="complianceCertIn" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptMetaCompCEA" class="form-label">Compliance to CEA (Cyber Security in Power Sector) guidelines 2021*</label>
                                <select id="websiteVaptMetaCompCEA" name="complianceCEA" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptMetaCompOther" class="form-label">Any other domestic regulation, directions, guidelines (Please Specify)*</label>
                                <select id="websiteVaptMetaCompOther" name="complianceOther" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No" selected>No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <!-- Type of Audit Report -->
                            <div class="form-group">
                                <label for="websiteVaptMetaTypeReport" class="form-label">Type of Audit Report*</label>
                                <select id="websiteVaptMetaTypeReport" name="typeOfAuditReport" class="form-input" required>
                                    <option value="">Select Type</option>
                                    <option value="First Audit Report" selected>First Audit Report</option>
                                    <option value="Follow up Audit Report">Follow up Audit Report</option>
                                </select>
                            </div>

                            <!-- No. of vulnerabilities -->
                            <div class="form-group">
                                <label for="websiteVaptMetaNumVuln" class="form-label">No. of vulnerabilities/ security issues reported during FIRST Audit*</label>
                                <input type="number" id="websiteVaptMetaNumVuln" name="numVulnerabilities" class="form-input" placeholder="Enter number" min="0" required>
                            </div>

                            <!-- No. of days taken to patch -->
                            <div class="form-group">
                                <label for="websiteVaptMetaDaysPatch" class="form-label">No. of days taken by Client to patch the vulnerabilities after submission of Audit report*</label>
                                <select id="websiteVaptMetaDaysPatch" name="numDaysToPatch" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Follow up audit not performed" selected>Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- Duration between audits -->
                            <div class="form-group">
                                <label for="websiteVaptMetaDuration" class="form-label">Durations (in days) between end of FIRST audit and start of FOLLOW-UP/SECOND audit*</label>
                                <select id="websiteVaptMetaDuration" name="durationBetweenAudits" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed" selected>Follow up audit not performed</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- No. of open issues -->
                            <div class="form-group">
                                <label for="websiteVaptMetaOpenIssues" class="form-label">No. of open issues after follow-up audits*</label>
                                <select id="websiteVaptMetaOpenIssues" name="numOpenIssues" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed" selected>Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="0">0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="101">101</option>
                                    <option value="102">102</option>
                                    <option value="103">103</option>
                                    <option value="104">104</option>
                                    <option value="105">105</option>
                                    <option value="106">106</option>
                                    <option value="107">107</option>
                                    <option value="108">108</option>
                                    <option value="109">109</option>
                                    <option value="110">110</option>
                                    <option value="111">111</option>
                                    <option value="112">112</option>
                                    <option value="113">113</option>
                                    <option value="114">114</option>
                                    <option value="115">115</option>
                                    <option value="116">116</option>
                                    <option value="117">117</option>
                                    <option value="118">118</option>
                                    <option value="119">119</option>
                                    <option value="120">120</option>
                                    <option value="121">121</option>
                                    <option value="122">122</option>
                                    <option value="123">123</option>
                                    <option value="124">124</option>
                                    <option value="125">125</option>
                                    <option value="126">126</option>
                                    <option value="127">127</option>
                                    <option value="128">128</option>
                                    <option value="129">129</option>
                                    <option value="130">130</option>
                                    <option value="131">131</option>
                                    <option value="132">132</option>
                                    <option value="133">133</option>
                                    <option value="134">134</option>
                                    <option value="135">135</option>
                                    <option value="136">136</option>
                                    <option value="137">137</option>
                                    <option value="138">138</option>
                                    <option value="139">139</option>
                                    <option value="140">140</option>
                                    <option value="141">141</option>
                                    <option value="142">142</option>
                                    <option value="143">143</option>
                                    <option value="144">144</option>
                                    <option value="145">145</option>
                                    <option value="146">146</option>
                                    <option value="147">147</option>
                                    <option value="148">148</option>
                                    <option value="149">149</option>
                                    <option value="150">150</option>
                                    <option value="151">151</option>
                                    <option value="152">152</option>
                                    <option value="153">153</option>
                                    <option value="154">154</option>
                                    <option value="155">155</option>
                                    <option value="156">156</option>
                                    <option value="157">157</option>
                                    <option value="158">158</option>
                                    <option value="159">159</option>
                                    <option value="160">160</option>
                                    <option value="161">161</option>
                                    <option value="162">162</option>
                                    <option value="163">163</option>
                                    <option value="164">164</option>
                                    <option value="165">165</option>
                                    <option value="166">166</option>
                                    <option value="167">167</option>
                                    <option value="168">168</option>
                                    <option value="169">169</option>
                                    <option value="170">170</option>
                                    <option value="171">171</option>
                                    <option value="172">172</option>
                                    <option value="173">173</option>
                                    <option value="174">174</option>
                                    <option value="175">175</option>
                                    <option value="176">176</option>
                                    <option value="177">177</option>
                                    <option value="178">178</option>
                                    <option value="179">179</option>
                                    <option value="180">180</option>
                                    <option value="More than 180">More than 180</option>
                                </select>
                            </div>

                            <!-- Geographical detail -->
                            <div class="form-group">
                                <label for="websiteVaptMetaGeoState" class="form-label">Geographical detail of Client (State/UT)*</label>
                                <select id="websiteVaptMetaGeoState" name="geographicalState" class="form-input" required>
                                    <option value="">Select State/UT</option>
                                    <option value="Andhra Pradesh">Andhra Pradesh</option>
                                    <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                    <option value="Assam">Assam</option>
                                    <option value="Bihar">Bihar</option>
                                    <option value="Chhattisgarh">Chhattisgarh</option>
                                    <option value="Goa">Goa</option>
                                    <option value="Gujarat">Gujarat</option>
                                    <option value="Haryana">Haryana</option>
                                    <option value="Himachal Pradesh">Himachal Pradesh</option>
                                    <option value="Jharkhand">Jharkhand</option>
                                    <option value="Karnataka">Karnataka</option>
                                    <option value="Kerala">Kerala</option>
                                    <option value="Madhya Pradesh">Madhya Pradesh</option>
                                    <option value="Maharashtra">Maharashtra</option>
                                    <option value="Manipur">Manipur</option>
                                    <option value="Meghalaya">Meghalaya</option>
                                    <option value="Mizoram">Mizoram</option>
                                    <option value="Nagaland">Nagaland</option>
                                    <option value="Odisha">Odisha</option>
                                    <option value="Punjab">Punjab</option>
                                    <option value="Rajasthan">Rajasthan</option>
                                    <option value="Sikkim">Sikkim</option>
                                    <option value="Tamil Nadu">Tamil Nadu</option>
                                    <option value="Telangana">Telangana</option>
                                    <option value="Tripura">Tripura</option>
                                    <option value="Uttar Pradesh">Uttar Pradesh</option>
                                    <option value="Uttarakhand">Uttarakhand</option>
                                    <option value="West Bengal">West Bengal</option>

                                    <!-- Union Territories -->
                                    <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                    <option value="Chandigarh">Chandigarh</option>
                                    <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                    <option value="Delhi">Delhi</option>
                                    <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                    <option value="Ladakh">Ladakh</option>
                                    <option value="Lakshadweep">Lakshadweep</option>
                                    <option value="Puducherry">Puducherry</option>

                                </select>
                            </div>

                            <!-- Date of Audit Completion -->
                            <div class="form-group">
                                <label for="websiteVaptMetaDateCompletion" class="form-label">Date of Audit Completion*</label>
                                <input type="date" id="websiteVaptMetaDateCompletion" name="dateAuditCompletion" class="form-input" required>
                            </div>

                            <!-- Date of last audit -->
                            <div class="form-group">
                                <label for="websiteVaptMetaDateLastAuditType" class="form-label">Date of last audit of same infrastructure*</label>
                                <select id="websiteVaptMetaDateLastAuditType" name="dateLastAuditType" class="form-input" required onchange="toggleWebsiteVaptLastAuditDateInput('websiteVaptMetaDateLastAuditType', 'websiteVaptMetaDateLastAudit')">
                                    <option value="">Select</option>
                                    <option value="NA" selected>NA</option>
                                    <option value="EnterDate">Enter Date</option>
                                </select>
                                <input type="date" id="websiteVaptMetaDateLastAudit" class="form-input" style="display: none; margin-top: 10px;">
                                <input type="hidden" id="websiteVaptMetaDateLastAuditValue" name="dateLastAudit" value="NA">
                            </div>

                            <!-- Vulnerability Status Radio Buttons -->
                            <div class="form-group">
                                <label class="form-label" style="margin-bottom: 10px;">Vulnerability Status*</label>
                                <div style="display: flex; gap: 30px; margin-top: 10px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="0" required onchange="toggleWebsiteVaptVulnerabilitySection()" style="width: auto;">
                                        <span>0 Vulnerability</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="has" required onchange="toggleWebsiteVaptVulnerabilitySection()" style="width: auto;">
                                        <span>Has Vulnerability</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Vulnerability Details Section -->
                            <div id="websiteVaptVulnerabilitySection" style="display: none;">
                                <div class="form-group">
                                    <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                        Audited Infrastructure Details
                                        <button type="button" class="submit-btn" onclick="addWebsiteVaptVulnerabilityEntry()" style="float: right; margin-top: -5px;">
                                            <i class="fas fa-plus"></i> Add Entry
                                        </button>
                                    </h4>
                                </div>

                                <div id="websiteVaptVulnerabilityContainer">
                                <!-- First vulnerability entry -->
                                <div class="vulnerability-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Audited infrastructure details*</label>
                                        <input type="text" name="vuln_0_infrastructure" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                                        <input type="text" name="vuln_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CVE/CWE Reference Number*</label>
                                        <input type="text" name="vuln_0_cve" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Severity of Issue*</label>
                                        <select name="vuln_0_severity" class="form-input" required>
                                            <option value="">Select Severity</option>
                                            <option value="Critical">Critical</option>
                                            <option value="High">High</option>
                                            <option value="Medium">Medium</option>
                                            <option value="Low">Low</option>
                                            <option value="Informational">Informational</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                                        <input type="number" name="vuln_0_count" class="form-input" min="0" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Attributing Factor*</label>
                                        <select name="vuln_0_factor" class="form-input" required>
                                            <option value="">Select Factor</option>
                                            <option value="Coding Error">Coding Error</option>
                                            <option value="Configuration Error">Configuration Error</option>
                                            <option value="Deployment Error">Deployment Error</option>
                                            <option value="Design Error">Design Error</option>
                                            <option value="Operation Error">Operation Error</option>
                                            <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            </div>

                            <!-- Employee Details Section -->
                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                    Employee Details
                                    <button type="button" class="submit-btn" onclick="addWebsiteVaptEmployeeEntry()" style="float: right; margin-top: -5px;">
                                        <i class="fas fa-plus"></i> Add Employee
                                    </button>
                                </h4>
                            </div>

                            <div id="websiteVaptEmployeeContainer">
                                <!-- First employee entry -->
                                <div class="employee-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Name of employee*</label>
                                        <input type="text" name="emp_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">E-mail ID*</label>
                                        <input type="email" name="emp_0_email" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISSP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cissp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cissp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cisa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cisa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISM*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cism" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cism" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">ISO*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_iso" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_iso" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">DISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_disa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_disa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">OSCP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_oscp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_oscp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CEH*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_ceh" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_ceh" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Others</label>
                                        <input type="text" name="emp_0_others" class="form-input" placeholder="Specify other certifications">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                                        <input type="number" name="emp_0_experience" class="form-input" min="0" step="0.5" required>
                                    </div>
                                </div>
                            </div>

                            <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                                <button type="button" class="btn btn-secondary" onclick="closeVaptModal('websiteVaptFirstAuditMetaDataModal')">Cancel</button>
                                <button type="submit" class="btn btn-primary" id="websiteVaptFirstAuditMetaDataSubmitBtn">
                                    <i class="fas fa-check"></i> Submit
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Web Application VAPT First Audit MetaData Modal -->
            <div id="webAppVaptFirstAuditMetaDataModal" class="modal">
                <div class="modal-content" style="max-width: 1000px;">
                    <div class="modal-header">
                        <h3>Web Application First Audit MetaData</h3>
                        <span class="close-modal" onclick="closeVaptModal('webAppVaptFirstAuditMetaDataModal')">&times;</span>
                    </div>
                    <div class="modal-body scrollable-content">
                        <form id="webAppVaptFirstAuditMetaDataForm" method="POST" onsubmit="handleWebAppVaptFirstAuditMetaDataSubmit(event)">
                            
                            <!-- Audit Dates -->
                            <div class="form-group">
                                <label for="webAppVaptMetaStartDate" class="form-label">Start Audit Date*</label>
                                <input type="date" id="webAppVaptMetaStartDate" name="startAuditDate" class="form-input" required>
                            </div>

                            <div class="form-group">
                                <label for="webAppVaptMetaEndDate" class="form-label">End Audit Date*</label>
                                <input type="date" id="webAppVaptMetaEndDate" name="endAuditDate" class="form-input" required>
                            </div>

                            <!-- Name of Auditee organization -->
                            <div class="form-group">
                                <label for="webAppVaptMetaAuditeeOrg" class="form-label">Name of Auditee Organization*</label>
                                <select id="webAppVaptMetaAuditeeOrg" name="nameOfAuditeeOrg" class="form-input" required onchange="toggleWebAppVaptOtherField('webAppVaptMetaAuditeeOrg', 'webAppVaptMetaAuditeeOrgOther')">
                                    <option value="">Select Organization</option>
                                    <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                    <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                    <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                    <option value="Megasoft Limited">Megasoft Limited</option>
                                    <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                    <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                    <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                    <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                    <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                    <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                    <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                    <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                    <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                    <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                    <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                    <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                    <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                    <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                    <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                    <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                    <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                    <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                    <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                    <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                    <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                    <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                    <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                    <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                    <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                    <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                    <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                    <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                    <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                    <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                    <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                    <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                    <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                    <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                    <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                    <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                    
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="webAppVaptMetaAuditeeOrgOther" name="nameOfAuditeeOrgOther" class="form-input" placeholder="Specify organization name" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Category of Organization -->
                            <div class="form-group">
                                <label for="webAppVaptMetaCategoryOrg" class="form-label">Category of Organization*</label>
                                <select id="webAppVaptMetaCategoryOrg" name="categoryOfOrg" class="form-input" required>
                                    <option value="">Select Category</option>
                                    <option value="Central Ministry/Department">Central Ministry/Department</option>
                                    <option value="Organization under Government Department">Organization under Government Department</option>
                                    <option value="Private Sector" selected>Private Sector</option>
                                    <option value="Public sector organisations">Public sector organisations</option>
                                    <option value="State Government Department">State Government Department</option>
                                </select>
                            </div>

                            <!-- Sector of Organization -->
                            <div class="form-group">
                                <label for="webAppVaptMetaSectorOrg" class="form-label">Sector of Organization*</label>
                                <select id="webAppVaptMetaSectorOrg" name="sectorOfOrg" class="form-input" required onchange="updateWebAppVaptSubSectorOptions()">
                                    <option value="">Select Sector</option>
                                    <option value="Agriculture">Agriculture</option>
                                    <option value="Defence">Defence</option>
                                    <option value="Education">Education</option>
                                    <option value="Energy">Energy</option>
                                    <option value="Finance" selected>Finance</option>
                                    <option value="Healthcare">Healthcare</option>
                                    <option value="Information_and_Broadcasting">Information and Broadcasting</option>
                                    <option value="Information_and_Communication_Technology">Information and Communication Technology</option>
                                    <option value="Law_Enforcement_and_Security">Law Enforcement and Security</option>
                                    <option value="Public_Essential_Services_and_Utilities">Public Essential Services and Utilities</option>
                                    <option value="Space">Space</option>
                                    <option value="Transportation">Transportation</option>
                                </select>
                            </div>

                            <!-- Sub Sector -->
                            <div class="form-group">
                                <label for="webAppVaptMetaSubSector" class="form-label">Sub Sector*</label>
                                <select id="webAppVaptMetaSubSector" name="subSector" class="form-input" required>
                                    <option value="">Select Sector First</option>
                                </select>
                            </div>

                            <!-- Type of audit -->
                            <div class="form-group">
                                <label for="webAppVaptMetaTypeAudit" class="form-label">Type of Audit*</label>
                                <select id="webAppVaptMetaTypeAudit" name="typeOfAudit" class="form-input" required onchange="toggleWebAppVaptOtherField('webAppVaptMetaTypeAudit', 'webAppVaptMetaTypeAuditOther')">
                                    <option value="">Select Type</option>
                                    <option value="API Security Audit">API Security Audit</option>
                                    <option value="Cloud Security Audit">Cloud Security Audit</option>
                                    <option value="Compliance to Standard/Framework/Policies Related Audit">Compliance to Standard/Framework/Policies Related Audit</option>
                                    <option value="Digital Forensic Readiness Assessment">Digital Forensic Readiness Assessment</option>
                                    <option value="Industrial Control Systems (ICS) / SCADA Audit">Industrial Control Systems (ICS) / SCADA Audit</option>
                                    <option value="IoT Security Assessment">IoT Security Assessment</option>
                                    <option value="Mobile Application Audit">Mobile Application Audit</option>
                                    <option value="Network Infrastructure Audits">Network Infrastructure Audits</option>
                                    <option value="Process Audit">Process Audit</option>
                                    <option value="Red Team Assessment">Red Team Assessment</option>
                                    <option value="Source Code Review">Source Code Review</option>
                                    <option value="VAPT-Infrastructure">VAPT-Infrastructure</option>
                                    <option value="VAPT-Application">VAPT-Application</option>
                                    <option value="Website /Web Application Audit" selected>Website /Web Application Audit</option>
                                    <option value="Wireless security audit">Wireless security audit</option>
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="webAppVaptMetaTypeAuditOther" name="typeOfAuditOther" class="form-input" placeholder="Please specify type of audit" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Details of website/application/infrastructure -->
                            <div class="form-group">
                                <label for="webAppVaptMetaDetails" class="form-label">Details of web site/name of application/no. of servers, perimeter devices, other infrastructure*</label>
                                <textarea id="webAppVaptMetaDetails" name="detailsOfWebsite" class="form-input" placeholder="Enter details" required rows="3"></textarea>
                            </div>

                            <!-- Reason for conducting Audit -->
                            <div class="form-group">
                                <label for="webAppVaptMetaReason" class="form-label">Reason for conducting Audit*</label>
                                <select id="webAppVaptMetaReason" name="reasonForAudit" class="form-input" required>
                                    <option value="">Select Reason</option>
                                    <option value="Certificate of compliance like ISO 27001">Certificate of compliance like ISO 27001</option>
                                    <option value="Certificate of safe hosting">Certificate of safe hosting</option>
                                    <option value="Change in process or infrastructure">Change in process or infrastructure</option>
                                    <option value="Government directions">Government directions</option>
                                    <option value="Incident/ Breach in Organisation">Incident/ Breach in Organisation</option>
                                    <option value="Incident/ Breach in Sector">Incident/ Breach in Sector</option>
                                    <option value="New application/ Infrastructure">New application/ Infrastructure</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Periodic Audit as per Policy of organisation.">Periodic Audit as per Policy of organisation.</option>
                                    <option value="Regulatory directions" selected>Regulatory directions</option>
                                    <option value="Third Party Initiated">Third Party Initiated</option>
                                </select>
                            </div>

                            <!-- Standards Used for conducting Audit -->
                            <div class="form-group">
                                <label for="webAppVaptMetaStandards" class="form-label">Standards Used for conducting Audit*</label>
                                <input type="text" id="webAppVaptMetaStandards" name="standardsUsed" class="form-input" placeholder="Enter standards" required>
                            </div>

                            <!-- Challenges in conducting Audits -->
                            <div class="form-group">
                                <label for="webAppVaptMetaChallenges" class="form-label">Challenges in conducting Audits*</label>
                                <textarea id="webAppVaptMetaChallenges" name="challenges" class="form-input" placeholder="Enter challenges" required rows="3"></textarea>
                            </div>

                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Compliance Questions</h4>
                            </div>

                            <!-- Compliance questions -->
                            <div class="form-group">
                                <label for="webAppVaptMetaCompFinancial" class="form-label">Compliance to financial sector regulatory bodies guidelines/circulars/directions like from RBI, IRDAI, SEBI, NPCI*</label>
                                <select id="webAppVaptMetaCompFinancial" name="complianceFinancial" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="webAppVaptMetaCompRegulatory" class="form-label">Compliance to regulatory bodies guidelines/circulars/directions like from UIDAI, CCA, DoT, TRAI*</label>
                                <select id="webAppVaptMetaCompRegulatory" name="complianceRegulatory" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="webAppVaptMetaCompCertIn" class="form-label">Compliance to CERT-In directions under sub-section (6) of section 70B of the IT Act, 2000 dated 28 April, 2022*</label>
                                <select id="webAppVaptMetaCompCertIn" name="complianceCertIn" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="webAppVaptMetaCompCEA" class="form-label">Compliance to CEA (Cyber Security in Power Sector) guidelines 2021*</label>
                                <select id="webAppVaptMetaCompCEA" name="complianceCEA" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="webAppVaptMetaCompOther" class="form-label">Any other domestic regulation, directions, guidelines (Please Specify)*</label>
                                <select id="webAppVaptMetaCompOther" name="complianceOther" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No" selected>No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <!-- Type of Audit Report -->
                            <div class="form-group">
                                <label for="webAppVaptMetaTypeReport" class="form-label">Type of Audit Report*</label>
                                <select id="webAppVaptMetaTypeReport" name="typeOfAuditReport" class="form-input" required>
                                    <option value="">Select Type</option>
                                    <option value="First Audit Report" selected>First Audit Report</option>
                                    <option value="Follow up Audit Report">Follow up Audit Report</option>
                                </select>
                            </div>

                            <!-- No. of vulnerabilities -->
                            <div class="form-group">
                                <label for="webAppVaptMetaNumVuln" class="form-label">No. of vulnerabilities/ security issues reported during FIRST Audit*</label>
                                <input type="number" id="webAppVaptMetaNumVuln" name="numVulnerabilities" class="form-input" placeholder="Enter number" min="0" required>
                            </div>

                            <!-- No. of days taken to patch -->
                            <div class="form-group">
                                <label for="webAppVaptMetaDaysPatch" class="form-label">No. of days taken by Client to patch the vulnerabilities after submission of Audit report*</label>
                                <select id="webAppVaptMetaDaysPatch" name="numDaysToPatch" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Follow up audit not performed" selected>Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- Duration between audits -->
                            <div class="form-group">
                                <label for="webAppVaptMetaDuration" class="form-label">Durations (in days) between end of FIRST audit and start of FOLLOW-UP/SECOND audit*</label>
                                <select id="webAppVaptMetaDuration" name="durationBetweenAudits" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed" selected>Follow up audit not performed</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- No. of open issues -->
                            <div class="form-group">
                                <label for="webAppVaptMetaOpenIssues" class="form-label">No. of open issues after follow-up audits*</label>
                                <select id="webAppVaptMetaOpenIssues" name="numOpenIssues" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed" selected>Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="0">0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="101">101</option>
                                    <option value="102">102</option>
                                    <option value="103">103</option>
                                    <option value="104">104</option>
                                    <option value="105">105</option>
                                    <option value="106">106</option>
                                    <option value="107">107</option>
                                    <option value="108">108</option>
                                    <option value="109">109</option>
                                    <option value="110">110</option>
                                    <option value="111">111</option>
                                    <option value="112">112</option>
                                    <option value="113">113</option>
                                    <option value="114">114</option>
                                    <option value="115">115</option>
                                    <option value="116">116</option>
                                    <option value="117">117</option>
                                    <option value="118">118</option>
                                    <option value="119">119</option>
                                    <option value="120">120</option>
                                    <option value="121">121</option>
                                    <option value="122">122</option>
                                    <option value="123">123</option>
                                    <option value="124">124</option>
                                    <option value="125">125</option>
                                    <option value="126">126</option>
                                    <option value="127">127</option>
                                    <option value="128">128</option>
                                    <option value="129">129</option>
                                    <option value="130">130</option>
                                    <option value="131">131</option>
                                    <option value="132">132</option>
                                    <option value="133">133</option>
                                    <option value="134">134</option>
                                    <option value="135">135</option>
                                    <option value="136">136</option>
                                    <option value="137">137</option>
                                    <option value="138">138</option>
                                    <option value="139">139</option>
                                    <option value="140">140</option>
                                    <option value="141">141</option>
                                    <option value="142">142</option>
                                    <option value="143">143</option>
                                    <option value="144">144</option>
                                    <option value="145">145</option>
                                    <option value="146">146</option>
                                    <option value="147">147</option>
                                    <option value="148">148</option>
                                    <option value="149">149</option>
                                    <option value="150">150</option>
                                    <option value="151">151</option>
                                    <option value="152">152</option>
                                    <option value="153">153</option>
                                    <option value="154">154</option>
                                    <option value="155">155</option>
                                    <option value="156">156</option>
                                    <option value="157">157</option>
                                    <option value="158">158</option>
                                    <option value="159">159</option>
                                    <option value="160">160</option>
                                    <option value="161">161</option>
                                    <option value="162">162</option>
                                    <option value="163">163</option>
                                    <option value="164">164</option>
                                    <option value="165">165</option>
                                    <option value="166">166</option>
                                    <option value="167">167</option>
                                    <option value="168">168</option>
                                    <option value="169">169</option>
                                    <option value="170">170</option>
                                    <option value="171">171</option>
                                    <option value="172">172</option>
                                    <option value="173">173</option>
                                    <option value="174">174</option>
                                    <option value="175">175</option>
                                    <option value="176">176</option>
                                    <option value="177">177</option>
                                    <option value="178">178</option>
                                    <option value="179">179</option>
                                    <option value="180">180</option>
                                    <option value="More than 180">More than 180</option>
                                </select>
                            </div>

                            <!-- Geographical detail -->
                            <div class="form-group">
                                <label for="webAppVaptMetaGeoState" class="form-label">Geographical detail of Client (State/UT)*</label>
                                <select id="webAppVaptMetaGeoState" name="geographicalState" class="form-input" required>
                                    <option value="">Select State/UT</option>
                                    <option value="Andhra Pradesh">Andhra Pradesh</option>
                                    <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                    <option value="Assam">Assam</option>
                                    <option value="Bihar">Bihar</option>
                                    <option value="Chhattisgarh">Chhattisgarh</option>
                                    <option value="Goa">Goa</option>
                                    <option value="Gujarat">Gujarat</option>
                                    <option value="Haryana">Haryana</option>
                                    <option value="Himachal Pradesh">Himachal Pradesh</option>
                                    <option value="Jharkhand">Jharkhand</option>
                                    <option value="Karnataka">Karnataka</option>
                                    <option value="Kerala">Kerala</option>
                                    <option value="Madhya Pradesh">Madhya Pradesh</option>
                                    <option value="Maharashtra">Maharashtra</option>
                                    <option value="Manipur">Manipur</option>
                                    <option value="Meghalaya">Meghalaya</option>
                                    <option value="Mizoram">Mizoram</option>
                                    <option value="Nagaland">Nagaland</option>
                                    <option value="Odisha">Odisha</option>
                                    <option value="Punjab">Punjab</option>
                                    <option value="Rajasthan">Rajasthan</option>
                                    <option value="Sikkim">Sikkim</option>
                                    <option value="Tamil Nadu">Tamil Nadu</option>
                                    <option value="Telangana">Telangana</option>
                                    <option value="Tripura">Tripura</option>
                                    <option value="Uttar Pradesh">Uttar Pradesh</option>
                                    <option value="Uttarakhand">Uttarakhand</option>
                                    <option value="West Bengal">West Bengal</option>

                                    <!-- Union Territories -->
                                    <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                    <option value="Chandigarh">Chandigarh</option>
                                    <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                    <option value="Delhi">Delhi</option>
                                    <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                    <option value="Ladakh">Ladakh</option>
                                    <option value="Lakshadweep">Lakshadweep</option>
                                    <option value="Puducherry">Puducherry</option>

                                </select>
                            </div>

                            <!-- Date of Audit Completion -->
                            <div class="form-group">
                                <label for="webAppVaptMetaDateCompletion" class="form-label">Date of Audit Completion*</label>
                                <input type="date" id="webAppVaptMetaDateCompletion" name="dateAuditCompletion" class="form-input" required>
                            </div>

                            <!-- Date of last audit -->
                            <div class="form-group">
                                <label for="webAppVaptMetaDateLastAuditType" class="form-label">Date of last audit of same infrastructure*</label>
                                <select id="webAppVaptMetaDateLastAuditType" name="dateLastAuditType" class="form-input" required onchange="toggleWebAppVaptLastAuditDateInput('webAppVaptMetaDateLastAuditType', 'webAppVaptMetaDateLastAudit')">
                                    <option value="">Select</option>
                                    <option value="NA" selected>NA</option>
                                    <option value="EnterDate">Enter Date</option>
                                </select>
                                <input type="date" id="webAppVaptMetaDateLastAudit" class="form-input" style="display: none; margin-top: 10px;">
                                <input type="hidden" id="webAppVaptMetaDateLastAuditValue" name="dateLastAudit" value="NA">
                            </div>

                            <!-- Vulnerability Status Radio Buttons -->
                            <div class="form-group">
                                <label class="form-label" style="margin-bottom: 10px;">Vulnerability Status*</label>
                                <div style="display: flex; gap: 30px; margin-top: 10px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="0" required onchange="toggleWebAppVaptVulnerabilitySection()" style="width: auto;">
                                        <span>0 Vulnerability</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="has" required onchange="toggleWebAppVaptVulnerabilitySection()" style="width: auto;">
                                        <span>Has Vulnerability</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Vulnerability Details Section -->
                            <div id="webAppVaptVulnerabilitySection" style="display: none;">
                                <div class="form-group">
                                    <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                        Audited Infrastructure Details
                                        <button type="button" class="submit-btn" onclick="addWebAppVaptVulnerabilityEntry()" style="float: right; margin-top: -5px;">
                                            <i class="fas fa-plus"></i> Add Entry
                                        </button>
                                    </h4>
                                </div>

                                <div id="webAppVaptVulnerabilityContainer">
                                <!-- First vulnerability entry -->
                                <div class="vulnerability-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Audited infrastructure details*</label>
                                        <input type="text" name="vuln_0_infrastructure" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                                        <input type="text" name="vuln_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CVE/CWE Reference Number*</label>
                                        <input type="text" name="vuln_0_cve" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Severity of Issue*</label>
                                        <select name="vuln_0_severity" class="form-input" required>
                                            <option value="">Select Severity</option>
                                            <option value="Critical">Critical</option>
                                            <option value="High">High</option>
                                            <option value="Medium">Medium</option>
                                            <option value="Low">Low</option>
                                            <option value="Informational">Informational</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                                        <input type="number" name="vuln_0_count" class="form-input" min="0" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Attributing Factor*</label>
                                        <select name="vuln_0_factor" class="form-input" required>
                                            <option value="">Select Factor</option>
                                            <option value="Coding Error">Coding Error</option>
                                            <option value="Configuration Error">Configuration Error</option>
                                            <option value="Deployment Error">Deployment Error</option>
                                            <option value="Design Error">Design Error</option>
                                            <option value="Operation Error">Operation Error</option>
                                            <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            </div>

                            <!-- Employee Details Section -->
                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                    Employee Details
                                    <button type="button" class="submit-btn" onclick="addWebAppVaptEmployeeEntry()" style="float: right; margin-top: -5px;">
                                        <i class="fas fa-plus"></i> Add Employee
                                    </button>
                                </h4>
                            </div>

                            <div id="webAppVaptEmployeeContainer">
                                <!-- First employee entry -->
                                <div class="employee-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Name of employee*</label>
                                        <input type="text" name="emp_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">E-mail ID*</label>
                                        <input type="email" name="emp_0_email" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISSP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cissp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cissp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cisa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cisa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISM*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cism" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cism" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">ISO*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_iso" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_iso" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">DISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_disa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_disa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">OSCP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_oscp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_oscp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CEH*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_ceh" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_ceh" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Others</label>
                                        <input type="text" name="emp_0_others" class="form-input" placeholder="Specify other certifications">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                                        <input type="number" name="emp_0_experience" class="form-input" min="0" step="0.5" required>
                                    </div>
                                </div>
                            </div>

                            <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                                <button type="button" class="btn btn-secondary" onclick="closeVaptModal('webAppVaptFirstAuditMetaDataModal')">Cancel</button>
                                <button type="submit" class="btn btn-primary" id="webAppVaptFirstAuditMetaDataSubmitBtn">
                                    <i class="fas fa-check"></i> Submit
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Android Mobile Application VAPT First Audit MetaData Modal -->
            <div id="androidVaptFirstAuditMetaDataModal" class="modal">
                <div class="modal-content" style="max-width: 1000px;">
                    <div class="modal-header">
                        <h3>Android Mobile Application First Audit MetaData</h3>
                        <span class="close-modal" onclick="closeVaptModal('androidVaptFirstAuditMetaDataModal')">&times;</span>
                    </div>
                    <div class="modal-body scrollable-content">
                        <form id="androidVaptFirstAuditMetaDataForm" method="POST" onsubmit="handleAndroidVaptFirstAuditMetaDataSubmit(event)">
                            
                            <!-- Audit Dates -->
                            <div class="form-group">
                                <label for="androidVaptMetaStartDate" class="form-label">Start Audit Date*</label>
                                <input type="date" id="androidVaptMetaStartDate" name="startAuditDate" class="form-input" required>
                            </div>

                            <div class="form-group">
                                <label for="androidVaptMetaEndDate" class="form-label">End Audit Date*</label>
                                <input type="date" id="androidVaptMetaEndDate" name="endAuditDate" class="form-input" required>
                            </div>

                            <!-- Name of Auditee organization -->
                            <div class="form-group">
                                <label for="androidVaptMetaAuditeeOrg" class="form-label">Name of Auditee Organization*</label>
                                <select id="androidVaptMetaAuditeeOrg" name="nameOfAuditeeOrg" class="form-input" required onchange="toggleAndroidVaptOtherField('androidVaptMetaAuditeeOrg', 'androidVaptMetaAuditeeOrgOther')">
                                    <option value="">Select Organization</option>
                                    <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                    <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                    <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                    <option value="Megasoft Limited">Megasoft Limited</option>
                                    <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                    <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                    <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                    <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                    <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                    <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                    <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                    <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                    <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                    <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                    <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                    <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                    <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                    <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                    <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                    <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                    <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                    <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                    <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                    <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                    <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                    <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                    <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                    <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                    <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                    <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                    <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                    <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                    <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                    <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                    <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                    <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                    <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                    <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                    <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                    <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                    
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="androidVaptMetaAuditeeOrgOther" name="nameOfAuditeeOrgOther" class="form-input" placeholder="Specify organization name" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Category of Organization -->
                            <div class="form-group">
                                <label for="androidVaptMetaCategoryOrg" class="form-label">Category of Organization*</label>
                                <select id="androidVaptMetaCategoryOrg" name="categoryOfOrg" class="form-input" required>
                                    <option value="">Select Category</option>
                                    <option value="Central Ministry/Department">Central Ministry/Department</option>
                                    <option value="Organization under Government Department">Organization under Government Department</option>
                                    <option value="Private Sector" selected>Private Sector</option>
                                    <option value="Public sector organisations">Public sector organisations</option>
                                    <option value="State Government Department">State Government Department</option>
                                </select>
                            </div>

                            <!-- Sector of Organization -->
                            <div class="form-group">
                                <label for="androidVaptMetaSectorOrg" class="form-label">Sector of Organization*</label>
                                <select id="androidVaptMetaSectorOrg" name="sectorOfOrg" class="form-input" required onchange="updateAndroidVaptSubSectorOptions()">
                                    <option value="">Select Sector</option>
                                    <option value="Agriculture">Agriculture</option>
                                    <option value="Defence">Defence</option>
                                    <option value="Education">Education</option>
                                    <option value="Energy">Energy</option>
                                    <option value="Finance" selected>Finance</option>
                                    <option value="Healthcare">Healthcare</option>
                                    <option value="Information_and_Broadcasting">Information and Broadcasting</option>
                                    <option value="Information_and_Communication_Technology">Information and Communication Technology</option>
                                    <option value="Law_Enforcement_and_Security">Law Enforcement and Security</option>
                                    <option value="Public_Essential_Services_and_Utilities">Public Essential Services and Utilities</option>
                                    <option value="Space">Space</option>
                                    <option value="Transportation">Transportation</option>
                                </select>
                            </div>

                            <!-- Sub Sector -->
                            <div class="form-group">
                                <label for="androidVaptMetaSubSector" class="form-label">Sub Sector*</label>
                                <select id="androidVaptMetaSubSector" name="subSector" class="form-input" required>
                                    <option value="">Select Sector First</option>
                                </select>
                            </div>

                            <!-- Type of audit -->
                            <div class="form-group">
                                <label for="androidVaptMetaTypeAudit" class="form-label">Type of Audit*</label>
                                <select id="androidVaptMetaTypeAudit" name="typeOfAudit" class="form-input" required onchange="toggleAndroidVaptOtherField('androidVaptMetaTypeAudit', 'androidVaptMetaTypeAuditOther')">
                                    <option value="">Select Type</option>
                                    <option value="API Security Audit">API Security Audit</option>
                                    <option value="Cloud Security Audit">Cloud Security Audit</option>
                                    <option value="Compliance to Standard/Framework/Policies Related Audit">Compliance to Standard/Framework/Policies Related Audit</option>
                                    <option value="Digital Forensic Readiness Assessment">Digital Forensic Readiness Assessment</option>
                                    <option value="Industrial Control Systems (ICS) / SCADA Audit">Industrial Control Systems (ICS) / SCADA Audit</option>
                                    <option value="IoT Security Assessment">IoT Security Assessment</option>
                                    <option value="Mobile Application Audit">Mobile Application Audit</option>
                                    <option value="Network Infrastructure Audits">Network Infrastructure Audits</option>
                                    <option value="Process Audit">Process Audit</option>
                                    <option value="Red Team Assessment">Red Team Assessment</option>
                                    <option value="Source Code Review">Source Code Review</option>
                                    <option value="VAPT-Infrastructure">VAPT-Infrastructure</option>
                                    <option value="VAPT-Application">VAPT-Application</option>
                                    <option value="Website /Android Mobile Application Audit" selected>Website /Android Mobile Application Audit</option>
                                    <option value="Wireless security audit">Wireless security audit</option>
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="androidVaptMetaTypeAuditOther" name="typeOfAuditOther" class="form-input" placeholder="Please specify type of audit" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Details of website/application/infrastructure -->
                            <div class="form-group">
                                <label for="androidVaptMetaDetails" class="form-label">Details of web site/name of application/no. of servers, perimeter devices, other infrastructure*</label>
                                <textarea id="androidVaptMetaDetails" name="detailsOfWebsite" class="form-input" placeholder="Enter details" required rows="3"></textarea>
                            </div>

                            <!-- Reason for conducting Audit -->
                            <div class="form-group">
                                <label for="androidVaptMetaReason" class="form-label">Reason for conducting Audit*</label>
                                <select id="androidVaptMetaReason" name="reasonForAudit" class="form-input" required>
                                    <option value="">Select Reason</option>
                                    <option value="Certificate of compliance like ISO 27001">Certificate of compliance like ISO 27001</option>
                                    <option value="Certificate of safe hosting">Certificate of safe hosting</option>
                                    <option value="Change in process or infrastructure">Change in process or infrastructure</option>
                                    <option value="Government directions">Government directions</option>
                                    <option value="Incident/ Breach in Organisation">Incident/ Breach in Organisation</option>
                                    <option value="Incident/ Breach in Sector">Incident/ Breach in Sector</option>
                                    <option value="New application/ Infrastructure">New application/ Infrastructure</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Periodic Audit as per Policy of organisation.">Periodic Audit as per Policy of organisation.</option>
                                    <option value="Regulatory directions" selected>Regulatory directions</option>
                                    <option value="Third Party Initiated">Third Party Initiated</option>
                                </select>
                            </div>

                            <!-- Standards Used for conducting Audit -->
                            <div class="form-group">
                                <label for="androidVaptMetaStandards" class="form-label">Standards Used for conducting Audit*</label>
                                <input type="text" id="androidVaptMetaStandards" name="standardsUsed" class="form-input" placeholder="Enter standards" required>
                            </div>

                            <!-- Challenges in conducting Audits -->
                            <div class="form-group">
                                <label for="androidVaptMetaChallenges" class="form-label">Challenges in conducting Audits*</label>
                                <textarea id="androidVaptMetaChallenges" name="challenges" class="form-input" placeholder="Enter challenges" required rows="3"></textarea>
                            </div>

                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Compliance Questions</h4>
                            </div>

                            <!-- Compliance questions -->
                            <div class="form-group">
                                <label for="androidVaptMetaCompFinancial" class="form-label">Compliance to financial sector regulatory bodies guidelines/circulars/directions like from RBI, IRDAI, SEBI, NPCI*</label>
                                <select id="androidVaptMetaCompFinancial" name="complianceFinancial" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="androidVaptMetaCompRegulatory" class="form-label">Compliance to regulatory bodies guidelines/circulars/directions like from UIDAI, CCA, DoT, TRAI*</label>
                                <select id="androidVaptMetaCompRegulatory" name="complianceRegulatory" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="androidVaptMetaCompCertIn" class="form-label">Compliance to CERT-In directions under sub-section (6) of section 70B of the IT Act, 2000 dated 28 April, 2022*</label>
                                <select id="androidVaptMetaCompCertIn" name="complianceCertIn" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="androidVaptMetaCompCEA" class="form-label">Compliance to CEA (Cyber Security in Power Sector) guidelines 2021*</label>
                                <select id="androidVaptMetaCompCEA" name="complianceCEA" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="androidVaptMetaCompOther" class="form-label">Any other domestic regulation, directions, guidelines (Please Specify)*</label>
                                <select id="androidVaptMetaCompOther" name="complianceOther" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No" selected>No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <!-- Type of Audit Report -->
                            <div class="form-group">
                                <label for="androidVaptMetaTypeReport" class="form-label">Type of Audit Report*</label>
                                <select id="androidVaptMetaTypeReport" name="typeOfAuditReport" class="form-input" required>
                                    <option value="">Select Type</option>
                                    <option value="First Audit Report" selected>First Audit Report</option>
                                    <option value="Follow up Audit Report">Follow up Audit Report</option>
                                </select>
                            </div>

                            <!-- No. of vulnerabilities -->
                            <div class="form-group">
                                <label for="androidVaptMetaNumVuln" class="form-label">No. of vulnerabilities/ security issues reported during FIRST Audit*</label>
                                <input type="number" id="androidVaptMetaNumVuln" name="numVulnerabilities" class="form-input" placeholder="Enter number" min="0" required>
                            </div>

                            <!-- No. of days taken to patch -->
                            <div class="form-group">
                                <label for="androidVaptMetaDaysPatch" class="form-label">No. of days taken by Client to patch the vulnerabilities after submission of Audit report*</label>
                                <select id="androidVaptMetaDaysPatch" name="numDaysToPatch" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Follow up audit not performed" selected>Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- Duration between audits -->
                            <div class="form-group">
                                <label for="androidVaptMetaDuration" class="form-label">Durations (in days) between end of FIRST audit and start of FOLLOW-UP/SECOND audit*</label>
                                <select id="androidVaptMetaDuration" name="durationBetweenAudits" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed" selected>Follow up audit not performed</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- No. of open issues -->
                            <div class="form-group">
                                <label for="androidVaptMetaOpenIssues" class="form-label">No. of open issues after follow-up audits*</label>
                                <select id="androidVaptMetaOpenIssues" name="numOpenIssues" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed" selected>Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="0">0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="101">101</option>
                                    <option value="102">102</option>
                                    <option value="103">103</option>
                                    <option value="104">104</option>
                                    <option value="105">105</option>
                                    <option value="106">106</option>
                                    <option value="107">107</option>
                                    <option value="108">108</option>
                                    <option value="109">109</option>
                                    <option value="110">110</option>
                                    <option value="111">111</option>
                                    <option value="112">112</option>
                                    <option value="113">113</option>
                                    <option value="114">114</option>
                                    <option value="115">115</option>
                                    <option value="116">116</option>
                                    <option value="117">117</option>
                                    <option value="118">118</option>
                                    <option value="119">119</option>
                                    <option value="120">120</option>
                                    <option value="121">121</option>
                                    <option value="122">122</option>
                                    <option value="123">123</option>
                                    <option value="124">124</option>
                                    <option value="125">125</option>
                                    <option value="126">126</option>
                                    <option value="127">127</option>
                                    <option value="128">128</option>
                                    <option value="129">129</option>
                                    <option value="130">130</option>
                                    <option value="131">131</option>
                                    <option value="132">132</option>
                                    <option value="133">133</option>
                                    <option value="134">134</option>
                                    <option value="135">135</option>
                                    <option value="136">136</option>
                                    <option value="137">137</option>
                                    <option value="138">138</option>
                                    <option value="139">139</option>
                                    <option value="140">140</option>
                                    <option value="141">141</option>
                                    <option value="142">142</option>
                                    <option value="143">143</option>
                                    <option value="144">144</option>
                                    <option value="145">145</option>
                                    <option value="146">146</option>
                                    <option value="147">147</option>
                                    <option value="148">148</option>
                                    <option value="149">149</option>
                                    <option value="150">150</option>
                                    <option value="151">151</option>
                                    <option value="152">152</option>
                                    <option value="153">153</option>
                                    <option value="154">154</option>
                                    <option value="155">155</option>
                                    <option value="156">156</option>
                                    <option value="157">157</option>
                                    <option value="158">158</option>
                                    <option value="159">159</option>
                                    <option value="160">160</option>
                                    <option value="161">161</option>
                                    <option value="162">162</option>
                                    <option value="163">163</option>
                                    <option value="164">164</option>
                                    <option value="165">165</option>
                                    <option value="166">166</option>
                                    <option value="167">167</option>
                                    <option value="168">168</option>
                                    <option value="169">169</option>
                                    <option value="170">170</option>
                                    <option value="171">171</option>
                                    <option value="172">172</option>
                                    <option value="173">173</option>
                                    <option value="174">174</option>
                                    <option value="175">175</option>
                                    <option value="176">176</option>
                                    <option value="177">177</option>
                                    <option value="178">178</option>
                                    <option value="179">179</option>
                                    <option value="180">180</option>
                                    <option value="More than 180">More than 180</option>
                                </select>
                            </div>

                            <!-- Geographical detail -->
                            <div class="form-group">
                                <label for="androidVaptMetaGeoState" class="form-label">Geographical detail of Client (State/UT)*</label>
                                <select id="androidVaptMetaGeoState" name="geographicalState" class="form-input" required>
                                    <option value="">Select State/UT</option>
                                    <option value="Andhra Pradesh">Andhra Pradesh</option>
                                    <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                    <option value="Assam">Assam</option>
                                    <option value="Bihar">Bihar</option>
                                    <option value="Chhattisgarh">Chhattisgarh</option>
                                    <option value="Goa">Goa</option>
                                    <option value="Gujarat">Gujarat</option>
                                    <option value="Haryana">Haryana</option>
                                    <option value="Himachal Pradesh">Himachal Pradesh</option>
                                    <option value="Jharkhand">Jharkhand</option>
                                    <option value="Karnataka">Karnataka</option>
                                    <option value="Kerala">Kerala</option>
                                    <option value="Madhya Pradesh">Madhya Pradesh</option>
                                    <option value="Maharashtra">Maharashtra</option>
                                    <option value="Manipur">Manipur</option>
                                    <option value="Meghalaya">Meghalaya</option>
                                    <option value="Mizoram">Mizoram</option>
                                    <option value="Nagaland">Nagaland</option>
                                    <option value="Odisha">Odisha</option>
                                    <option value="Punjab">Punjab</option>
                                    <option value="Rajasthan">Rajasthan</option>
                                    <option value="Sikkim">Sikkim</option>
                                    <option value="Tamil Nadu">Tamil Nadu</option>
                                    <option value="Telangana">Telangana</option>
                                    <option value="Tripura">Tripura</option>
                                    <option value="Uttar Pradesh">Uttar Pradesh</option>
                                    <option value="Uttarakhand">Uttarakhand</option>
                                    <option value="West Bengal">West Bengal</option>

                                    <!-- Union Territories -->
                                    <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                    <option value="Chandigarh">Chandigarh</option>
                                    <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                    <option value="Delhi">Delhi</option>
                                    <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                    <option value="Ladakh">Ladakh</option>
                                    <option value="Lakshadweep">Lakshadweep</option>
                                    <option value="Puducherry">Puducherry</option>

                                </select>
                            </div>

                            <!-- Date of Audit Completion -->
                            <div class="form-group">
                                <label for="androidVaptMetaDateCompletion" class="form-label">Date of Audit Completion*</label>
                                <input type="date" id="androidVaptMetaDateCompletion" name="dateAuditCompletion" class="form-input" required>
                            </div>

                            <!-- Date of last audit -->
                            <div class="form-group">
                                <label for="androidVaptMetaDateLastAuditType" class="form-label">Date of last audit of same infrastructure*</label>
                                <select id="androidVaptMetaDateLastAuditType" name="dateLastAuditType" class="form-input" required onchange="toggleAndroidVaptLastAuditDateInput('androidVaptMetaDateLastAuditType', 'androidVaptMetaDateLastAudit')">
                                    <option value="">Select</option>
                                    <option value="NA" selected>NA</option>
                                    <option value="EnterDate">Enter Date</option>
                                </select>
                                <input type="date" id="androidVaptMetaDateLastAudit" class="form-input" style="display: none; margin-top: 10px;">
                                <input type="hidden" id="androidVaptMetaDateLastAuditValue" name="dateLastAudit" value="NA">
                            </div>

                            <!-- Vulnerability Status Radio Buttons -->
                            <div class="form-group">
                                <label class="form-label" style="margin-bottom: 10px;">Vulnerability Status*</label>
                                <div style="display: flex; gap: 30px; margin-top: 10px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="0" required onchange="toggleAndroidVaptVulnerabilitySection()" style="width: auto;">
                                        <span>0 Vulnerability</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="has" required onchange="toggleAndroidVaptVulnerabilitySection()" style="width: auto;">
                                        <span>Has Vulnerability</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Vulnerability Details Section -->
                            <div id="androidVaptVulnerabilitySection" style="display: none;">
                                <div class="form-group">
                                    <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                        Audited Infrastructure Details
                                        <button type="button" class="submit-btn" onclick="addAndroidVaptVulnerabilityEntry()" style="float: right; margin-top: -5px;">
                                            <i class="fas fa-plus"></i> Add Entry
                                        </button>
                                    </h4>
                                </div>

                                <div id="androidVaptVulnerabilityContainer">
                                <!-- First vulnerability entry -->
                                <div class="vulnerability-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Audited infrastructure details*</label>
                                        <input type="text" name="vuln_0_infrastructure" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                                        <input type="text" name="vuln_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CVE/CWE Reference Number*</label>
                                        <input type="text" name="vuln_0_cve" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Severity of Issue*</label>
                                        <select name="vuln_0_severity" class="form-input" required>
                                            <option value="">Select Severity</option>
                                            <option value="Critical">Critical</option>
                                            <option value="High">High</option>
                                            <option value="Medium">Medium</option>
                                            <option value="Low">Low</option>
                                            <option value="Informational">Informational</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                                        <input type="number" name="vuln_0_count" class="form-input" min="0" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Attributing Factor*</label>
                                        <select name="vuln_0_factor" class="form-input" required>
                                            <option value="">Select Factor</option>
                                            <option value="Coding Error">Coding Error</option>
                                            <option value="Configuration Error">Configuration Error</option>
                                            <option value="Deployment Error">Deployment Error</option>
                                            <option value="Design Error">Design Error</option>
                                            <option value="Operation Error">Operation Error</option>
                                            <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            </div>

                            <!-- Employee Details Section -->
                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                    Employee Details
                                    <button type="button" class="submit-btn" onclick="addAndroidVaptEmployeeEntry()" style="float: right; margin-top: -5px;">
                                        <i class="fas fa-plus"></i> Add Employee
                                    </button>
                                </h4>
                            </div>

                            <div id="androidVaptEmployeeContainer">
                                <!-- First employee entry -->
                                <div class="employee-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Name of employee*</label>
                                        <input type="text" name="emp_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">E-mail ID*</label>
                                        <input type="email" name="emp_0_email" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISSP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cissp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cissp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cisa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cisa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISM*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cism" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cism" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">ISO*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_iso" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_iso" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">DISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_disa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_disa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">OSCP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_oscp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_oscp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CEH*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_ceh" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_ceh" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Others</label>
                                        <input type="text" name="emp_0_others" class="form-input" placeholder="Specify other certifications">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                                        <input type="number" name="emp_0_experience" class="form-input" min="0" step="0.5" required>
                                    </div>
                                </div>
                            </div>

                            <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                                <button type="button" class="btn btn-secondary" onclick="closeVaptModal('androidVaptFirstAuditMetaDataModal')">Cancel</button>
                                <button type="submit" class="btn btn-primary" id="androidVaptFirstAuditMetaDataSubmitBtn">
                                    <i class="fas fa-check"></i> Submit
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- IOS Mobile Application VAPT First Audit MetaData Modal -->
            <div id="iosVaptFirstAuditMetaDataModal" class="modal">
                <div class="modal-content" style="max-width: 1000px;">
                    <div class="modal-header">
                        <h3>IOS Mobile Application First Audit MetaData</h3>
                        <span class="close-modal" onclick="closeVaptModal('iosVaptFirstAuditMetaDataModal')">&times;</span>
                    </div>
                    <div class="modal-body scrollable-content">
                        <form id="iosVaptFirstAuditMetaDataForm" method="POST" onsubmit="handleIosVaptFirstAuditMetaDataSubmit(event)">
                            
                            <!-- Audit Dates -->
                            <div class="form-group">
                                <label for="iosVaptMetaStartDate" class="form-label">Start Audit Date*</label>
                                <input type="date" id="iosVaptMetaStartDate" name="startAuditDate" class="form-input" required>
                            </div>

                            <div class="form-group">
                                <label for="iosVaptMetaEndDate" class="form-label">End Audit Date*</label>
                                <input type="date" id="iosVaptMetaEndDate" name="endAuditDate" class="form-input" required>
                            </div>

                            <!-- Name of Auditee organization -->
                            <div class="form-group">
                                <label for="iosVaptMetaAuditeeOrg" class="form-label">Name of Auditee Organization*</label>
                                <select id="iosVaptMetaAuditeeOrg" name="nameOfAuditeeOrg" class="form-input" required onchange="toggleIosVaptOtherField('iosVaptMetaAuditeeOrg', 'iosVaptMetaAuditeeOrgOther')">
                                    <option value="">Select Organization</option>
                                    <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                    <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                    <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                    <option value="Megasoft Limited">Megasoft Limited</option>
                                    <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                    <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                    <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                    <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                    <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                    <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                    <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                    <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                    <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                    <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                    <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                    <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                    <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                    <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                    <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                    <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                    <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                    <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                    <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                    <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                    <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                    <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                    <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                    <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                    <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                    <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                    <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                    <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                    <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                    <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                    <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                    <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                    <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                    <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                    <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                    <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                    
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="iosVaptMetaAuditeeOrgOther" name="nameOfAuditeeOrgOther" class="form-input" placeholder="Specify organization name" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Category of Organization -->
                            <div class="form-group">
                                <label for="iosVaptMetaCategoryOrg" class="form-label">Category of Organization*</label>
                                <select id="iosVaptMetaCategoryOrg" name="categoryOfOrg" class="form-input" required>
                                    <option value="">Select Category</option>
                                    <option value="Central Ministry/Department">Central Ministry/Department</option>
                                    <option value="Organization under Government Department">Organization under Government Department</option>
                                    <option value="Private Sector" selected>Private Sector</option>
                                    <option value="Public sector organisations">Public sector organisations</option>
                                    <option value="State Government Department">State Government Department</option>
                                </select>
                            </div>

                            <!-- Sector of Organization -->
                            <div class="form-group">
                                <label for="iosVaptMetaSectorOrg" class="form-label">Sector of Organization*</label>
                                <select id="iosVaptMetaSectorOrg" name="sectorOfOrg" class="form-input" required onchange="updateIosVaptSubSectorOptions()">
                                    <option value="">Select Sector</option>
                                    <option value="Agriculture">Agriculture</option>
                                    <option value="Defence">Defence</option>
                                    <option value="Education">Education</option>
                                    <option value="Energy">Energy</option>
                                    <option value="Finance" selected>Finance</option>
                                    <option value="Healthcare">Healthcare</option>
                                    <option value="Information_and_Broadcasting">Information and Broadcasting</option>
                                    <option value="Information_and_Communication_Technology">Information and Communication Technology</option>
                                    <option value="Law_Enforcement_and_Security">Law Enforcement and Security</option>
                                    <option value="Public_Essential_Services_and_Utilities">Public Essential Services and Utilities</option>
                                    <option value="Space">Space</option>
                                    <option value="Transportation">Transportation</option>
                                </select>
                            </div>

                            <!-- Sub Sector -->
                            <div class="form-group">
                                <label for="iosVaptMetaSubSector" class="form-label">Sub Sector*</label>
                                <select id="iosVaptMetaSubSector" name="subSector" class="form-input" required>
                                    <option value="">Select Sector First</option>
                                </select>
                            </div>

                            <!-- Type of audit -->
                            <div class="form-group">
                                <label for="iosVaptMetaTypeAudit" class="form-label">Type of Audit*</label>
                                <select id="iosVaptMetaTypeAudit" name="typeOfAudit" class="form-input" required onchange="toggleIosVaptOtherField('iosVaptMetaTypeAudit', 'iosVaptMetaTypeAuditOther')">
                                    <option value="">Select Type</option>
                                    <option value="API Security Audit">API Security Audit</option>
                                    <option value="Cloud Security Audit">Cloud Security Audit</option>
                                    <option value="Compliance to Standard/Framework/Policies Related Audit">Compliance to Standard/Framework/Policies Related Audit</option>
                                    <option value="Digital Forensic Readiness Assessment">Digital Forensic Readiness Assessment</option>
                                    <option value="Industrial Control Systems (ICS) / SCADA Audit">Industrial Control Systems (ICS) / SCADA Audit</option>
                                    <option value="IoT Security Assessment">IoT Security Assessment</option>
                                    <option value="Mobile Application Audit">Mobile Application Audit</option>
                                    <option value="Network Infrastructure Audits">Network Infrastructure Audits</option>
                                    <option value="Process Audit">Process Audit</option>
                                    <option value="Red Team Assessment">Red Team Assessment</option>
                                    <option value="Source Code Review">Source Code Review</option>
                                    <option value="VAPT-Infrastructure">VAPT-Infrastructure</option>
                                    <option value="VAPT-Application">VAPT-Application</option>
                                    <option value="Website /IOS Mobile Application Audit" selected>Website /IOS Mobile Application Audit</option>
                                    <option value="Wireless security audit">Wireless security audit</option>
                                    <option value="Other">Other (Specify)</option>
                                </select>
                                <input type="text" id="iosVaptMetaTypeAuditOther" name="typeOfAuditOther" class="form-input" placeholder="Please specify type of audit" style="display: none; margin-top: 10px;">
                            </div>

                            <!-- Details of website/application/infrastructure -->
                            <div class="form-group">
                                <label for="iosVaptMetaDetails" class="form-label">Details of web site/name of application/no. of servers, perimeter devices, other infrastructure*</label>
                                <textarea id="iosVaptMetaDetails" name="detailsOfWebsite" class="form-input" placeholder="Enter details" required rows="3"></textarea>
                            </div>

                            <!-- Reason for conducting Audit -->
                            <div class="form-group">
                                <label for="iosVaptMetaReason" class="form-label">Reason for conducting Audit*</label>
                                <select id="iosVaptMetaReason" name="reasonForAudit" class="form-input" required>
                                    <option value="">Select Reason</option>
                                    <option value="Certificate of compliance like ISO 27001">Certificate of compliance like ISO 27001</option>
                                    <option value="Certificate of safe hosting">Certificate of safe hosting</option>
                                    <option value="Change in process or infrastructure">Change in process or infrastructure</option>
                                    <option value="Government directions">Government directions</option>
                                    <option value="Incident/ Breach in Organisation">Incident/ Breach in Organisation</option>
                                    <option value="Incident/ Breach in Sector">Incident/ Breach in Sector</option>
                                    <option value="New application/ Infrastructure">New application/ Infrastructure</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Periodic Audit as per Policy of organisation.">Periodic Audit as per Policy of organisation.</option>
                                    <option value="Regulatory directions" selected>Regulatory directions</option>
                                    <option value="Third Party Initiated">Third Party Initiated</option>
                                </select>
                            </div>

                            <!-- Standards Used for conducting Audit -->
                            <div class="form-group">
                                <label for="iosVaptMetaStandards" class="form-label">Standards Used for conducting Audit*</label>
                                <input type="text" id="iosVaptMetaStandards" name="standardsUsed" class="form-input" placeholder="Enter standards" required>
                            </div>

                            <!-- Challenges in conducting Audits -->
                            <div class="form-group">
                                <label for="iosVaptMetaChallenges" class="form-label">Challenges in conducting Audits*</label>
                                <textarea id="iosVaptMetaChallenges" name="challenges" class="form-input" placeholder="Enter challenges" required rows="3"></textarea>
                            </div>

                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Compliance Questions</h4>
                            </div>

                            <!-- Compliance questions -->
                            <div class="form-group">
                                <label for="iosVaptMetaCompFinancial" class="form-label">Compliance to financial sector regulatory bodies guidelines/circulars/directions like from RBI, IRDAI, SEBI, NPCI*</label>
                                <select id="iosVaptMetaCompFinancial" name="complianceFinancial" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="iosVaptMetaCompRegulatory" class="form-label">Compliance to regulatory bodies guidelines/circulars/directions like from UIDAI, CCA, DoT, TRAI*</label>
                                <select id="iosVaptMetaCompRegulatory" name="complianceRegulatory" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="iosVaptMetaCompCertIn" class="form-label">Compliance to CERT-In directions under sub-section (6) of section 70B of the IT Act, 2000 dated 28 April, 2022*</label>
                                <select id="iosVaptMetaCompCertIn" name="complianceCertIn" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="iosVaptMetaCompCEA" class="form-label">Compliance to CEA (Cyber Security in Power Sector) guidelines 2021*</label>
                                <select id="iosVaptMetaCompCEA" name="complianceCEA" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="iosVaptMetaCompOther" class="form-label">Any other domestic regulation, directions, guidelines (Please Specify)*</label>
                                <select id="iosVaptMetaCompOther" name="complianceOther" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No" selected>No</option>
                                    <option value="Not applicable">Not applicable</option>
                                </select>
                            </div>

                            <!-- Type of Audit Report -->
                            <div class="form-group">
                                <label for="iosVaptMetaTypeReport" class="form-label">Type of Audit Report*</label>
                                <select id="iosVaptMetaTypeReport" name="typeOfAuditReport" class="form-input" required>
                                    <option value="">Select Type</option>
                                    <option value="First Audit Report" selected>First Audit Report</option>
                                    <option value="Follow up Audit Report">Follow up Audit Report</option>
                                </select>
                            </div>

                            <!-- No. of vulnerabilities -->
                            <div class="form-group">
                                <label for="iosVaptMetaNumVuln" class="form-label">No. of vulnerabilities/ security issues reported during FIRST Audit*</label>
                                <input type="number" id="iosVaptMetaNumVuln" name="numVulnerabilities" class="form-input" placeholder="Enter number" min="0" required>
                            </div>

                            <!-- No. of days taken to patch -->
                            <div class="form-group">
                                <label for="iosVaptMetaDaysPatch" class="form-label">No. of days taken by Client to patch the vulnerabilities after submission of Audit report*</label>
                                <select id="iosVaptMetaDaysPatch" name="numDaysToPatch" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Not Known">Not Known</option>
                                    <option value="Follow up audit not performed" selected>Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- Duration between audits -->
                            <div class="form-group">
                                <label for="iosVaptMetaDuration" class="form-label">Durations (in days) between end of FIRST audit and start of FOLLOW-UP/SECOND audit*</label>
                                <select id="iosVaptMetaDuration" name="durationBetweenAudits" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed" selected>Follow up audit not performed</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="More than 100">More than 100</option>
                                </select>
                            </div>

                            <!-- No. of open issues -->
                            <div class="form-group">
                                <label for="iosVaptMetaOpenIssues" class="form-label">No. of open issues after follow-up audits*</label>
                                <select id="iosVaptMetaOpenIssues" name="numOpenIssues" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Follow up audit not performed" selected>Follow up audit not performed</option>
                                    <option value="NA">NA</option>
                                    <option value="0">0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                    <option value="32">32</option>
                                    <option value="33">33</option>
                                    <option value="34">34</option>
                                    <option value="35">35</option>
                                    <option value="36">36</option>
                                    <option value="37">37</option>
                                    <option value="38">38</option>
                                    <option value="39">39</option>
                                    <option value="40">40</option>
                                    <option value="41">41</option>
                                    <option value="42">42</option>
                                    <option value="43">43</option>
                                    <option value="44">44</option>
                                    <option value="45">45</option>
                                    <option value="46">46</option>
                                    <option value="47">47</option>
                                    <option value="48">48</option>
                                    <option value="49">49</option>
                                    <option value="50">50</option>
                                    <option value="51">51</option>
                                    <option value="52">52</option>
                                    <option value="53">53</option>
                                    <option value="54">54</option>
                                    <option value="55">55</option>
                                    <option value="56">56</option>
                                    <option value="57">57</option>
                                    <option value="58">58</option>
                                    <option value="59">59</option>
                                    <option value="60">60</option>
                                    <option value="61">61</option>
                                    <option value="62">62</option>
                                    <option value="63">63</option>
                                    <option value="64">64</option>
                                    <option value="65">65</option>
                                    <option value="66">66</option>
                                    <option value="67">67</option>
                                    <option value="68">68</option>
                                    <option value="69">69</option>
                                    <option value="70">70</option>
                                    <option value="71">71</option>
                                    <option value="72">72</option>
                                    <option value="73">73</option>
                                    <option value="74">74</option>
                                    <option value="75">75</option>
                                    <option value="76">76</option>
                                    <option value="77">77</option>
                                    <option value="78">78</option>
                                    <option value="79">79</option>
                                    <option value="80">80</option>
                                    <option value="81">81</option>
                                    <option value="82">82</option>
                                    <option value="83">83</option>
                                    <option value="84">84</option>
                                    <option value="85">85</option>
                                    <option value="86">86</option>
                                    <option value="87">87</option>
                                    <option value="88">88</option>
                                    <option value="89">89</option>
                                    <option value="90">90</option>
                                    <option value="91">91</option>
                                    <option value="92">92</option>
                                    <option value="93">93</option>
                                    <option value="94">94</option>
                                    <option value="95">95</option>
                                    <option value="96">96</option>
                                    <option value="97">97</option>
                                    <option value="98">98</option>
                                    <option value="99">99</option>
                                    <option value="100">100</option>
                                    <option value="101">101</option>
                                    <option value="102">102</option>
                                    <option value="103">103</option>
                                    <option value="104">104</option>
                                    <option value="105">105</option>
                                    <option value="106">106</option>
                                    <option value="107">107</option>
                                    <option value="108">108</option>
                                    <option value="109">109</option>
                                    <option value="110">110</option>
                                    <option value="111">111</option>
                                    <option value="112">112</option>
                                    <option value="113">113</option>
                                    <option value="114">114</option>
                                    <option value="115">115</option>
                                    <option value="116">116</option>
                                    <option value="117">117</option>
                                    <option value="118">118</option>
                                    <option value="119">119</option>
                                    <option value="120">120</option>
                                    <option value="121">121</option>
                                    <option value="122">122</option>
                                    <option value="123">123</option>
                                    <option value="124">124</option>
                                    <option value="125">125</option>
                                    <option value="126">126</option>
                                    <option value="127">127</option>
                                    <option value="128">128</option>
                                    <option value="129">129</option>
                                    <option value="130">130</option>
                                    <option value="131">131</option>
                                    <option value="132">132</option>
                                    <option value="133">133</option>
                                    <option value="134">134</option>
                                    <option value="135">135</option>
                                    <option value="136">136</option>
                                    <option value="137">137</option>
                                    <option value="138">138</option>
                                    <option value="139">139</option>
                                    <option value="140">140</option>
                                    <option value="141">141</option>
                                    <option value="142">142</option>
                                    <option value="143">143</option>
                                    <option value="144">144</option>
                                    <option value="145">145</option>
                                    <option value="146">146</option>
                                    <option value="147">147</option>
                                    <option value="148">148</option>
                                    <option value="149">149</option>
                                    <option value="150">150</option>
                                    <option value="151">151</option>
                                    <option value="152">152</option>
                                    <option value="153">153</option>
                                    <option value="154">154</option>
                                    <option value="155">155</option>
                                    <option value="156">156</option>
                                    <option value="157">157</option>
                                    <option value="158">158</option>
                                    <option value="159">159</option>
                                    <option value="160">160</option>
                                    <option value="161">161</option>
                                    <option value="162">162</option>
                                    <option value="163">163</option>
                                    <option value="164">164</option>
                                    <option value="165">165</option>
                                    <option value="166">166</option>
                                    <option value="167">167</option>
                                    <option value="168">168</option>
                                    <option value="169">169</option>
                                    <option value="170">170</option>
                                    <option value="171">171</option>
                                    <option value="172">172</option>
                                    <option value="173">173</option>
                                    <option value="174">174</option>
                                    <option value="175">175</option>
                                    <option value="176">176</option>
                                    <option value="177">177</option>
                                    <option value="178">178</option>
                                    <option value="179">179</option>
                                    <option value="180">180</option>
                                    <option value="More than 180">More than 180</option>
                                </select>
                            </div>

                            <!-- Geographical detail -->
                            <div class="form-group">
                                <label for="iosVaptMetaGeoState" class="form-label">Geographical detail of Client (State/UT)*</label>
                                <select id="iosVaptMetaGeoState" name="geographicalState" class="form-input" required>
                                    <option value="">Select State/UT</option>
                                    <option value="Andhra Pradesh">Andhra Pradesh</option>
                                    <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                    <option value="Assam">Assam</option>
                                    <option value="Bihar">Bihar</option>
                                    <option value="Chhattisgarh">Chhattisgarh</option>
                                    <option value="Goa">Goa</option>
                                    <option value="Gujarat">Gujarat</option>
                                    <option value="Haryana">Haryana</option>
                                    <option value="Himachal Pradesh">Himachal Pradesh</option>
                                    <option value="Jharkhand">Jharkhand</option>
                                    <option value="Karnataka">Karnataka</option>
                                    <option value="Kerala">Kerala</option>
                                    <option value="Madhya Pradesh">Madhya Pradesh</option>
                                    <option value="Maharashtra">Maharashtra</option>
                                    <option value="Manipur">Manipur</option>
                                    <option value="Meghalaya">Meghalaya</option>
                                    <option value="Mizoram">Mizoram</option>
                                    <option value="Nagaland">Nagaland</option>
                                    <option value="Odisha">Odisha</option>
                                    <option value="Punjab">Punjab</option>
                                    <option value="Rajasthan">Rajasthan</option>
                                    <option value="Sikkim">Sikkim</option>
                                    <option value="Tamil Nadu">Tamil Nadu</option>
                                    <option value="Telangana">Telangana</option>
                                    <option value="Tripura">Tripura</option>
                                    <option value="Uttar Pradesh">Uttar Pradesh</option>
                                    <option value="Uttarakhand">Uttarakhand</option>
                                    <option value="West Bengal">West Bengal</option>

                                    <!-- Union Territories -->
                                    <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                    <option value="Chandigarh">Chandigarh</option>
                                    <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                    <option value="Delhi">Delhi</option>
                                    <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                    <option value="Ladakh">Ladakh</option>
                                    <option value="Lakshadweep">Lakshadweep</option>
                                    <option value="Puducherry">Puducherry</option>

                                </select>
                            </div>

                            <!-- Date of Audit Completion -->
                            <div class="form-group">
                                <label for="iosVaptMetaDateCompletion" class="form-label">Date of Audit Completion*</label>
                                <input type="date" id="iosVaptMetaDateCompletion" name="dateAuditCompletion" class="form-input" required>
                            </div>

                            <!-- Date of last audit -->
                            <div class="form-group">
                                <label for="iosVaptMetaDateLastAuditType" class="form-label">Date of last audit of same infrastructure*</label>
                                <select id="iosVaptMetaDateLastAuditType" name="dateLastAuditType" class="form-input" required onchange="toggleIosVaptLastAuditDateInput('iosVaptMetaDateLastAuditType', 'iosVaptMetaDateLastAudit')">
                                    <option value="">Select</option>
                                    <option value="NA" selected>NA</option>
                                    <option value="EnterDate">Enter Date</option>
                                </select>
                                <input type="date" id="iosVaptMetaDateLastAudit" class="form-input" style="display: none; margin-top: 10px;">
                                <input type="hidden" id="iosVaptMetaDateLastAuditValue" name="dateLastAudit" value="NA">
                            </div>

                            <!-- Vulnerability Status Radio Buttons -->
                            <div class="form-group">
                                <label class="form-label" style="margin-bottom: 10px;">Vulnerability Status*</label>
                                <div style="display: flex; gap: 30px; margin-top: 10px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="0" required onchange="toggleIosVaptVulnerabilitySection()" style="width: auto;">
                                        <span>0 Vulnerability</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="vulnerabilityStatus" value="has" required onchange="toggleIosVaptVulnerabilitySection()" style="width: auto;">
                                        <span>Has Vulnerability</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Vulnerability Details Section -->
                            <div id="iosVaptVulnerabilitySection" style="display: none;">
                                <div class="form-group">
                                    <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                        Audited Infrastructure Details
                                        <button type="button" class="submit-btn" onclick="addIosVaptVulnerabilityEntry()" style="float: right; margin-top: -5px;">
                                            <i class="fas fa-plus"></i> Add Entry
                                        </button>
                                    </h4>
                                </div>

                                <div id="iosVaptVulnerabilityContainer">
                                <!-- First vulnerability entry -->
                                <div class="vulnerability-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Audited infrastructure details*</label>
                                        <input type="text" name="vuln_0_infrastructure" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                                        <input type="text" name="vuln_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CVE/CWE Reference Number*</label>
                                        <input type="text" name="vuln_0_cve" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Severity of Issue*</label>
                                        <select name="vuln_0_severity" class="form-input" required>
                                            <option value="">Select Severity</option>
                                            <option value="Critical">Critical</option>
                                            <option value="High">High</option>
                                            <option value="Medium">Medium</option>
                                            <option value="Low">Low</option>
                                            <option value="Informational">Informational</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                                        <input type="number" name="vuln_0_count" class="form-input" min="0" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Attributing Factor*</label>
                                        <select name="vuln_0_factor" class="form-input" required>
                                            <option value="">Select Factor</option>
                                            <option value="Coding Error">Coding Error</option>
                                            <option value="Configuration Error">Configuration Error</option>
                                            <option value="Deployment Error">Deployment Error</option>
                                            <option value="Design Error">Design Error</option>
                                            <option value="Operation Error">Operation Error</option>
                                            <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            </div>

                            <!-- Employee Details Section -->
                            <div class="form-group">
                                <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                                    Employee Details
                                    <button type="button" class="submit-btn" onclick="addIosVaptEmployeeEntry()" style="float: right; margin-top: -5px;">
                                        <i class="fas fa-plus"></i> Add Employee
                                    </button>
                                </h4>
                            </div>

                            <div id="iosVaptEmployeeContainer">
                                <!-- First employee entry -->
                                <div class="employee-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                                    <div class="form-group">
                                        <label class="form-label">Name of employee*</label>
                                        <input type="text" name="emp_0_name" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">E-mail ID*</label>
                                        <input type="email" name="emp_0_email" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISSP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cissp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cissp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cisa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cisa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CISM*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_cism" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_cism" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">ISO*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_iso" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_iso" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">DISA*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_disa" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_disa" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">OSCP*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_oscp" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_oscp" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CEH*</label>
                                        <div style="display: flex; gap: 20px;">
                                            <label><input type="radio" name="emp_0_ceh" value="Yes" required> Yes</label>
                                            <label><input type="radio" name="emp_0_ceh" value="No" required> No</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Others</label>
                                        <input type="text" name="emp_0_others" class="form-input" placeholder="Specify other certifications">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                                        <input type="number" name="emp_0_experience" class="form-input" min="0" step="0.5" required>
                                    </div>
                                </div>
                            </div>

                            <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                                <button type="button" class="btn btn-secondary" onclick="closeVaptModal('iosVaptFirstAuditMetaDataModal')">Cancel</button>
                                <button type="submit" class="btn btn-primary" id="iosVaptFirstAuditMetaDataSubmitBtn">
                                    <i class="fas fa-check"></i> Submit
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Infrastructure VAPT First Audit Certificate Modal -->
            <div id="vaptFirstAuditCertificateModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Infrastructure VAPT First Audit Completion Certificate</h3>
                        <span class="close-modal" onclick="closeVaptModal('vaptFirstAuditCertificateModal')">&times;</span>
                    </div>
                    <div class="modal-body">
                        <form id="vaptFirstAuditCertificateForm" action="/process_vapt_first_audit_certificate" method="POST">
                            <div class="form-group">
                                <label for="vaptFirstAuditCertificateOrganizationName">Organization Name*</label>
                                <div class="combo-input">
                                    <select id="vaptFirstAuditCertificateOrganizationName" name="organizationName" required onchange="toggleVaptOtherInput('vaptFirstAuditCertificateOrganizationName', 'vaptFirstAuditCertificateOtherOrganizationName')">
                                        <option value="">Select Organization</option>
                                        <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                        <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                        <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                        <option value="Megasoft Limited">Megasoft Limited</option>
                                        <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                        <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                        <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                        <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                        <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                        <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                        <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                        <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                        <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                        <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                        <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                        <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                        <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                        <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                        <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                        <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                        <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                        <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                        <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                        <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                        <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                        <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                        <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                        <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                        <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                        <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                        <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                        <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                        <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                        <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                        <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                        <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                        <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                        <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                        <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                        <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                        
                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="vaptFirstAuditCertificateOtherOrganizationName" name="otherOrganizationName" class="hidden" placeholder="Enter Organization Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="vaptFirstAuditCertificateCity">City*</label>
                                <div class="combo-input">
                                    <select id="vaptFirstAuditCertificateCity" name="city" required onchange="toggleVaptOtherInput('vaptFirstAuditCertificateCity', 'vaptFirstAuditCertificateOtherCity')">
                                        <option value="">Select City</option>
                                        <!-- Gujarat -->
                                        <option value="Ahmedabad">Ahmedabad</option>
                                        <option value="Amreli">Amreli</option>
                                        <option value="Anand">Anand</option>
                                        <option value="Aravalli">Aravalli</option>
                                        <option value="Banaskantha">Banaskantha</option>
                                        <option value="Bharuch">Bharuch</option>
                                        <option value="Bhavnagar">Bhavnagar</option>
                                        <option value="Botad">Botad</option>
                                        <option value="Chhota Udaipur">Chhota Udaipur</option>
                                        <option value="Dahod">Dahod</option>
                                        <option value="Dang">Dang</option>
                                        <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                        <option value="Gandhinagar">Gandhinagar</option>
                                        <option value="Gir Somnath">Gir Somnath</option>
                                        <option value="Jamnagar">Jamnagar</option>
                                        <option value="Junagadh">Junagadh</option>
                                        <option value="Kheda">Kheda</option>
                                        <option value="Kutch">Kutch</option>
                                        <option value="Mahisagar">Mahisagar</option>
                                        <option value="Mehsana">Mehsana</option>
                                        <option value="Morbi">Morbi</option>
                                        <option value="Narmada">Narmada</option>
                                        <option value="Navsari">Navsari</option>
                                        <option value="Patan">Patan</option>
                                        <option value="Panchmahal">Panchmahal</option>
                                        <option value="Porbandar">Porbandar</option>
                                        <option value="Rajkot">Rajkot</option>
                                        <option value="Sabarkantha">Sabarkantha</option>
                                        <option value="Surat">Surat</option>
                                        <option value="Surendranagar">Surendranagar</option>
                                        <option value="Tapi">Tapi</option>
                                        <option value="Vadodara">Vadodara</option>
                                        <option value="Valsad">Valsad</option>

                                        <!-- Rajasthan -->
                                        <option value="Ajmer">Ajmer</option>
                                        <option value="Alwar">Alwar</option>
                                        <option value="Banswara">Banswara</option>
                                        <option value="Baran">Baran</option>
                                        <option value="Barmer">Barmer</option>
                                        <option value="Bharatpur">Bharatpur</option>
                                        <option value="Bhilwara">Bhilwara</option>
                                        <option value="Bikaner">Bikaner</option>
                                        <option value="Bundi">Bundi</option>
                                        <option value="Chittorgarh">Chittorgarh</option>
                                        <option value="Churu">Churu</option>
                                        <option value="Dausa">Dausa</option>
                                        <option value="Dholpur">Dholpur</option>
                                        <option value="Dungarpur">Dungarpur</option>
                                        <option value="Hanumangarh">Hanumangarh</option>
                                        <option value="Jaipur">Jaipur</option>
                                        <option value="Jaisalmer">Jaisalmer</option>
                                        <option value="Jalore">Jalore</option>
                                        <option value="Jhalawar">Jhalawar</option>
                                        <option value="Jhunjhunu">Jhunjhunu</option>
                                        <option value="Jodhpur">Jodhpur</option>
                                        <option value="Karauli">Karauli</option>
                                        <option value="Kota">Kota</option>
                                        <option value="Nagaur">Nagaur</option>
                                        <option value="Pali">Pali</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rajsamand">Rajsamand</option>
                                        <option value="Sikar">Sikar</option>
                                        <option value="Sirohi">Sirohi</option>
                                        <option value="Sri Ganganagar">Sri Ganganagar</option>
                                        <option value="Tonk">Tonk</option>
                                        <option value="Udaipur">Udaipur</option>

                                        <!-- Maharashtra -->
                                        <option value="Ahmednagar">Ahmednagar</option>
                                        <option value="Akola">Akola</option>
                                        <option value="Amravati">Amravati</option>
                                        <option value="Aurangabad">Aurangabad</option>
                                        <option value="Beed">Beed</option>
                                        <option value="Bhandara">Bhandara</option>
                                        <option value="Chandrapur">Chandrapur</option>
                                        <option value="Dhule">Dhule</option>
                                        <option value="Gadchiroli">Gadchiroli</option>
                                        <option value="Gondia">Gondia</option>
                                        <option value="Hingoli">Hingoli</option>
                                        <option value="Jalgaon">Jalgaon</option>
                                        <option value="Jalna">Jalna</option>
                                        <option value="Kolhapur">Kolhapur</option>
                                        <option value="Latur">Latur</option>
                                        <option value="Mumbai City">Mumbai City</option>
                                        <option value="Mumbai Suburban">Mumbai Suburban</option>
                                        <option value="Nagpur">Nagpur</option>
                                        <option value="Nanded">Nanded</option>
                                        <option value="Nandurbar">Nandurbar</option>
                                        <option value="Nashik">Nashik</option>
                                        <option value="Osmanabad">Osmanabad</option>
                                        <option value="Palghar">Palghar</option>
                                        <option value="Parbhani">Parbhani</option>
                                        <option value="Pune">Pune</option>
                                        <option value="Raigad">Raigad</option>
                                        <option value="Ratnagiri">Ratnagiri</option>
                                        <option value="Sangli">Sangli</option>
                                        <option value="Satara">Satara</option>
                                        <option value="Sindhudurg">Sindhudurg</option>
                                        <option value="Solapur">Solapur</option>
                                        <option value="Thane">Thane</option>
                                        <option value="Wardha">Wardha</option>
                                        <option value="Washim">Washim</option>
                                        <option value="Yavatmal">Yavatmal</option>

                                        <!-- Uttar Pradesh -->
                                        <option value="Agra">Agra</option>
                                        <option value="Aligarh">Aligarh</option>
                                        <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                        <option value="Amethi">Amethi</option>
                                        <option value="Amroha">Amroha</option>
                                        <option value="Auraiya">Auraiya</option>
                                        <option value="Ayodhya">Ayodhya</option>
                                        <option value="Azamgarh">Azamgarh</option>
                                        <option value="Bagpat">Bagpat</option>
                                        <option value="Bahraich">Bahraich</option>
                                        <option value="Ballia">Ballia</option>
                                        <option value="Balrampur">Balrampur</option>
                                        <option value="Banda">Banda</option>
                                        <option value="Barabanki">Barabanki</option>
                                        <option value="Bareilly">Bareilly</option>
                                        <option value="Basti">Basti</option>
                                        <option value="Bhadohi">Bhadohi</option>
                                        <option value="Bijnor">Bijnor</option>
                                        <option value="Bulandshahr">Bulandshahr</option>
                                        <option value="Chandauli">Chandauli</option>
                                        <option value="Chitrakoot">Chitrakoot</option>
                                        <option value="Deoria">Deoria</option>
                                        <option value="Etah">Etah</option>
                                        <option value="Etawah">Etawah</option>
                                        <option value="Farrukhabad">Farrukhabad</option>
                                        <option value="Fatehpur">Fatehpur</option>
                                        <option value="Firozabad">Firozabad</option>
                                        <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                        <option value="Ghaziabad">Ghaziabad</option>
                                        <option value="Ghazipur">Ghazipur</option>
                                        <option value="Gonda">Gonda</option>
                                        <option value="Gorakhpur">Gorakhpur</option>
                                        <option value="Hamirpur">Hamirpur</option>
                                        <option value="Hapur">Hapur</option>
                                        <option value="Hardoi">Hardoi</option>
                                        <option value="Hathras">Hathras</option>
                                        <option value="Jalaun">Jalaun</option>
                                        <option value="Jaunpur">Jaunpur</option>
                                        <option value="Jhansi">Jhansi</option>
                                        <option value="Kannauj">Kannauj</option>
                                        <option value="Kanpur Dehat">Kanpur Dehat</option>
                                        <option value="Kanpur Nagar">Kanpur Nagar</option>
                                        <option value="Kasganj">Kasganj</option>
                                        <option value="Kaushambi">Kaushambi</option>
                                        <option value="Kushinagar">Kushinagar</option>
                                        <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                        <option value="Lalitpur">Lalitpur</option>
                                        <option value="Lucknow">Lucknow</option>
                                        <option value="Maharajganj">Maharajganj</option>
                                        <option value="Mahoba">Mahoba</option>
                                        <option value="Mainpuri">Mainpuri</option>
                                        <option value="Mathura">Mathura</option>
                                        <option value="Mau">Mau</option>
                                        <option value="Meerut">Meerut</option>
                                        <option value="Mirzapur">Mirzapur</option>
                                        <option value="Moradabad">Moradabad</option>
                                        <option value="Muzaffarnagar">Muzaffarnagar</option>
                                        <option value="Pilibhit">Pilibhit</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rae Bareli">Rae Bareli</option>
                                        <option value="Rampur">Rampur</option>
                                        <option value="Saharanpur">Saharanpur</option>
                                        <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                        <option value="Shahjahanpur">Shahjahanpur</option>
                                        <option value="Shravasti">Shravasti</option>
                                        <option value="Siddharthnagar">Siddharthnagar</option>
                                        <option value="Sitapur">Sitapur</option>
                                        <option value="Sonbhadra">Sonbhadra</option>
                                        <option value="Sultanpur">Sultanpur</option>
                                        <option value="Unnao">Unnao</option>
                                        <option value="Varanasi">Varanasi</option>

                                        <!-- Uttarakhand -->
                                        <option value="Almora">Almora</option>
                                        <option value="Bageshwar">Bageshwar</option>
                                        <option value="Chamoli">Chamoli</option>
                                        <option value="Champawat">Champawat</option>
                                        <option value="Dehradun">Dehradun</option>
                                        <option value="Haridwar">Haridwar</option>
                                        <option value="Nainital">Nainital</option>
                                        <option value="Pauri Garhwal">Pauri Garhwal</option>
                                        <option value="Pithoragarh">Pithoragarh</option>
                                        <option value="Rudraprayag">Rudraprayag</option>
                                        <option value="Tehri Garhwal">Tehri Garhwal</option>
                                        <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                        <option value="Uttarkashi">Uttarkashi</option>

                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="vaptFirstAuditCertificateOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="vaptFirstAuditCertificateState">State*</label>
                                <div class="combo-input">
                                    <select id="vaptFirstAuditCertificateState" name="state" required onchange="toggleVaptOtherInput('vaptFirstAuditCertificateState', 'vaptFirstAuditCertificateOtherState')">
                                        <option value="">Select State</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                        <option value="Assam">Assam</option>
                                        <option value="Bihar">Bihar</option>
                                        <option value="Chhattisgarh">Chhattisgarh</option>
                                        <option value="Goa">Goa</option>
                                        <option value="Gujarat">Gujarat</option>
                                        <option value="Haryana">Haryana</option>
                                        <option value="Himachal Pradesh">Himachal Pradesh</option>
                                        <option value="Jharkhand">Jharkhand</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Kerala">Kerala</option>
                                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Manipur">Manipur</option>
                                        <option value="Meghalaya">Meghalaya</option>
                                        <option value="Mizoram">Mizoram</option>
                                        <option value="Nagaland">Nagaland</option>
                                        <option value="Odisha">Odisha</option>
                                        <option value="Punjab">Punjab</option>
                                        <option value="Rajasthan">Rajasthan</option>
                                        <option value="Sikkim">Sikkim</option>
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="Telangana">Telangana</option>
                                        <option value="Tripura">Tripura</option>
                                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                                        <option value="Uttarakhand">Uttarakhand</option>
                                        <option value="West Bengal">West Bengal</option>

                                        <!-- Union Territories -->
                                        <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                        <option value="Chandigarh">Chandigarh</option>
                                        <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                        <option value="Delhi">Delhi</option>
                                        <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                        <option value="Ladakh">Ladakh</option>
                                        <option value="Lakshadweep">Lakshadweep</option>
                                        <option value="Puducherry">Puducherry</option>

                                    </select>
                                    <input type="text" id="vaptFirstAuditCertificateOtherState" name="otherState" class="hidden" placeholder="Enter State Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="vaptFirstAuditCertificateAuditeeDesignation">Designation of the Auditee Person (Submitted To)*</label>
                                <input type="text" id="vaptFirstAuditCertificateAuditeeDesignation" name="auditeeDesignation" required placeholder="Enter auditee designation">
                            </div>

                            <div class="form-group">
                                <label for="vaptFirstAuditCertificateScope">Scope*</label>
                                <input type="text" id="vaptFirstAuditCertificateScope" name="scope" required placeholder="Enter scope details">
                            </div>

                            <div class="form-group">
                                <label for="vaptFirstAuditCertificateStartAuditDate">Start Audit Date*</label>
                                <input type="date" id="vaptFirstAuditCertificateStartAuditDate" name="startAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="vaptFirstAuditCertificateEndAuditDate">End Audit Date*</label>
                                <input type="date" id="vaptFirstAuditCertificateEndAuditDate" name="endAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="vaptFirstAuditCertificateReportId">Report ID*</label>
                                <input type="text" id="vaptFirstAuditCertificateReportId" name="reportId" required placeholder="Enter report ID">
                            </div>

                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('vaptFirstAuditCertificateModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Certificate</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Website VAPT First Audit Completion Certificate Modal -->
            <div id="websiteVaptFirstAuditCertificateModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Website VAPT First Audit Completion Certificate</h3>
                        <span class="close-modal" onclick="closeVaptModal('websiteVaptFirstAuditCertificateModal')">&times;</span>
                    </div>
                    <div class="modal-body">
                        <form id="websiteVaptFirstAuditCertificateForm" action="/process_website_vapt_first_audit_certificate" method="POST">
                            <div class="form-group">
                                <label for="websiteVaptFirstAuditCertificateOrganizationName">Organization Name*</label>
                                <div class="combo-input">
                                    <select id="websiteVaptFirstAuditCertificateOrganizationName" name="organizationName" required onchange="toggleVaptOtherInput('websiteVaptFirstAuditCertificateOrganizationName', 'websiteVaptFirstAuditCertificateOtherOrganizationName')">
                                        <option value="">Select Organization</option>
                                        <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                        <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                        <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                        <option value="Megasoft Limited">Megasoft Limited</option>
                                        <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                        <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                        <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                        <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                        <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                        <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                        <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                        <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                        <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                        <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                        <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                        <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                        <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                        <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                        <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                        <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                        <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                        <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                        <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                        <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                        <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                        <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                        <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                        <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                        <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                        <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                        <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                        <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                        <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                        <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                        <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                        <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                        <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                        <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                        <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                        <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                        
                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="websiteVaptFirstAuditCertificateOtherOrganizationName" name="otherOrganizationName" class="hidden" placeholder="Enter Organization Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFirstAuditCertificateCity">City*</label>
                                <div class="combo-input">
                                    <select id="websiteVaptFirstAuditCertificateCity" name="city" required onchange="toggleVaptOtherInput('websiteVaptFirstAuditCertificateCity', 'websiteVaptFirstAuditCertificateOtherCity')">
                                        <option value="">Select City</option>
                                        <!-- Gujarat -->
                                        <option value="Ahmedabad">Ahmedabad</option>
                                        <option value="Amreli">Amreli</option>
                                        <option value="Anand">Anand</option>
                                        <option value="Aravalli">Aravalli</option>
                                        <option value="Banaskantha">Banaskantha</option>
                                        <option value="Bharuch">Bharuch</option>
                                        <option value="Bhavnagar">Bhavnagar</option>
                                        <option value="Botad">Botad</option>
                                        <option value="Chhota Udaipur">Chhota Udaipur</option>
                                        <option value="Dahod">Dahod</option>
                                        <option value="Dang">Dang</option>
                                        <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                        <option value="Gandhinagar">Gandhinagar</option>
                                        <option value="Gir Somnath">Gir Somnath</option>
                                        <option value="Jamnagar">Jamnagar</option>
                                        <option value="Junagadh">Junagadh</option>
                                        <option value="Kheda">Kheda</option>
                                        <option value="Kutch">Kutch</option>
                                        <option value="Mahisagar">Mahisagar</option>
                                        <option value="Mehsana">Mehsana</option>
                                        <option value="Morbi">Morbi</option>
                                        <option value="Narmada">Narmada</option>
                                        <option value="Navsari">Navsari</option>
                                        <option value="Patan">Patan</option>
                                        <option value="Panchmahal">Panchmahal</option>
                                        <option value="Porbandar">Porbandar</option>
                                        <option value="Rajkot">Rajkot</option>
                                        <option value="Sabarkantha">Sabarkantha</option>
                                        <option value="Surat">Surat</option>
                                        <option value="Surendranagar">Surendranagar</option>
                                        <option value="Tapi">Tapi</option>
                                        <option value="Vadodara">Vadodara</option>
                                        <option value="Valsad">Valsad</option>

                                        <!-- Rajasthan -->
                                        <option value="Ajmer">Ajmer</option>
                                        <option value="Alwar">Alwar</option>
                                        <option value="Banswara">Banswara</option>
                                        <option value="Baran">Baran</option>
                                        <option value="Barmer">Barmer</option>
                                        <option value="Bharatpur">Bharatpur</option>
                                        <option value="Bhilwara">Bhilwara</option>
                                        <option value="Bikaner">Bikaner</option>
                                        <option value="Bundi">Bundi</option>
                                        <option value="Chittorgarh">Chittorgarh</option>
                                        <option value="Churu">Churu</option>
                                        <option value="Dausa">Dausa</option>
                                        <option value="Dholpur">Dholpur</option>
                                        <option value="Dungarpur">Dungarpur</option>
                                        <option value="Hanumangarh">Hanumangarh</option>
                                        <option value="Jaipur">Jaipur</option>
                                        <option value="Jaisalmer">Jaisalmer</option>
                                        <option value="Jalore">Jalore</option>
                                        <option value="Jhalawar">Jhalawar</option>
                                        <option value="Jhunjhunu">Jhunjhunu</option>
                                        <option value="Jodhpur">Jodhpur</option>
                                        <option value="Karauli">Karauli</option>
                                        <option value="Kota">Kota</option>
                                        <option value="Nagaur">Nagaur</option>
                                        <option value="Pali">Pali</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rajsamand">Rajsamand</option>
                                        <option value="Sikar">Sikar</option>
                                        <option value="Sirohi">Sirohi</option>
                                        <option value="Sri Ganganagar">Sri Ganganagar</option>
                                        <option value="Tonk">Tonk</option>
                                        <option value="Udaipur">Udaipur</option>

                                        <!-- Maharashtra -->
                                        <option value="Ahmednagar">Ahmednagar</option>
                                        <option value="Akola">Akola</option>
                                        <option value="Amravati">Amravati</option>
                                        <option value="Aurangabad">Aurangabad</option>
                                        <option value="Beed">Beed</option>
                                        <option value="Bhandara">Bhandara</option>
                                        <option value="Chandrapur">Chandrapur</option>
                                        <option value="Dhule">Dhule</option>
                                        <option value="Gadchiroli">Gadchiroli</option>
                                        <option value="Gondia">Gondia</option>
                                        <option value="Hingoli">Hingoli</option>
                                        <option value="Jalgaon">Jalgaon</option>
                                        <option value="Jalna">Jalna</option>
                                        <option value="Kolhapur">Kolhapur</option>
                                        <option value="Latur">Latur</option>
                                        <option value="Mumbai City">Mumbai City</option>
                                        <option value="Mumbai Suburban">Mumbai Suburban</option>
                                        <option value="Nagpur">Nagpur</option>
                                        <option value="Nanded">Nanded</option>
                                        <option value="Nandurbar">Nandurbar</option>
                                        <option value="Nashik">Nashik</option>
                                        <option value="Osmanabad">Osmanabad</option>
                                        <option value="Palghar">Palghar</option>
                                        <option value="Parbhani">Parbhani</option>
                                        <option value="Pune">Pune</option>
                                        <option value="Raigad">Raigad</option>
                                        <option value="Ratnagiri">Ratnagiri</option>
                                        <option value="Sangli">Sangli</option>
                                        <option value="Satara">Satara</option>
                                        <option value="Sindhudurg">Sindhudurg</option>
                                        <option value="Solapur">Solapur</option>
                                        <option value="Thane">Thane</option>
                                        <option value="Wardha">Wardha</option>
                                        <option value="Washim">Washim</option>
                                        <option value="Yavatmal">Yavatmal</option>

                                        <!-- Uttar Pradesh -->
                                        <option value="Agra">Agra</option>
                                        <option value="Aligarh">Aligarh</option>
                                        <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                        <option value="Amethi">Amethi</option>
                                        <option value="Amroha">Amroha</option>
                                        <option value="Auraiya">Auraiya</option>
                                        <option value="Ayodhya">Ayodhya</option>
                                        <option value="Azamgarh">Azamgarh</option>
                                        <option value="Bagpat">Bagpat</option>
                                        <option value="Bahraich">Bahraich</option>
                                        <option value="Ballia">Ballia</option>
                                        <option value="Balrampur">Balrampur</option>
                                        <option value="Banda">Banda</option>
                                        <option value="Barabanki">Barabanki</option>
                                        <option value="Bareilly">Bareilly</option>
                                        <option value="Basti">Basti</option>
                                        <option value="Bhadohi">Bhadohi</option>
                                        <option value="Bijnor">Bijnor</option>
                                        <option value="Bulandshahr">Bulandshahr</option>
                                        <option value="Chandauli">Chandauli</option>
                                        <option value="Chitrakoot">Chitrakoot</option>
                                        <option value="Deoria">Deoria</option>
                                        <option value="Etah">Etah</option>
                                        <option value="Etawah">Etawah</option>
                                        <option value="Farrukhabad">Farrukhabad</option>
                                        <option value="Fatehpur">Fatehpur</option>
                                        <option value="Firozabad">Firozabad</option>
                                        <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                        <option value="Ghaziabad">Ghaziabad</option>
                                        <option value="Ghazipur">Ghazipur</option>
                                        <option value="Gonda">Gonda</option>
                                        <option value="Gorakhpur">Gorakhpur</option>
                                        <option value="Hamirpur">Hamirpur</option>
                                        <option value="Hapur">Hapur</option>
                                        <option value="Hardoi">Hardoi</option>
                                        <option value="Hathras">Hathras</option>
                                        <option value="Jalaun">Jalaun</option>
                                        <option value="Jaunpur">Jaunpur</option>
                                        <option value="Jhansi">Jhansi</option>
                                        <option value="Kannauj">Kannauj</option>
                                        <option value="Kanpur Dehat">Kanpur Dehat</option>
                                        <option value="Kanpur Nagar">Kanpur Nagar</option>
                                        <option value="Kasganj">Kasganj</option>
                                        <option value="Kaushambi">Kaushambi</option>
                                        <option value="Kushinagar">Kushinagar</option>
                                        <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                        <option value="Lalitpur">Lalitpur</option>
                                        <option value="Lucknow">Lucknow</option>
                                        <option value="Maharajganj">Maharajganj</option>
                                        <option value="Mahoba">Mahoba</option>
                                        <option value="Mainpuri">Mainpuri</option>
                                        <option value="Mathura">Mathura</option>
                                        <option value="Mau">Mau</option>
                                        <option value="Meerut">Meerut</option>
                                        <option value="Mirzapur">Mirzapur</option>
                                        <option value="Moradabad">Moradabad</option>
                                        <option value="Muzaffarnagar">Muzaffarnagar</option>
                                        <option value="Pilibhit">Pilibhit</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rae Bareli">Rae Bareli</option>
                                        <option value="Rampur">Rampur</option>
                                        <option value="Saharanpur">Saharanpur</option>
                                        <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                        <option value="Shahjahanpur">Shahjahanpur</option>
                                        <option value="Shravasti">Shravasti</option>
                                        <option value="Siddharthnagar">Siddharthnagar</option>
                                        <option value="Sitapur">Sitapur</option>
                                        <option value="Sonbhadra">Sonbhadra</option>
                                        <option value="Sultanpur">Sultanpur</option>
                                        <option value="Unnao">Unnao</option>
                                        <option value="Varanasi">Varanasi</option>

                                        <!-- Uttarakhand -->
                                        <option value="Almora">Almora</option>
                                        <option value="Bageshwar">Bageshwar</option>
                                        <option value="Chamoli">Chamoli</option>
                                        <option value="Champawat">Champawat</option>
                                        <option value="Dehradun">Dehradun</option>
                                        <option value="Haridwar">Haridwar</option>
                                        <option value="Nainital">Nainital</option>
                                        <option value="Pauri Garhwal">Pauri Garhwal</option>
                                        <option value="Pithoragarh">Pithoragarh</option>
                                        <option value="Rudraprayag">Rudraprayag</option>
                                        <option value="Tehri Garhwal">Tehri Garhwal</option>
                                        <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                        <option value="Uttarkashi">Uttarkashi</option>

                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="websiteVaptFirstAuditCertificateOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFirstAuditCertificateState">State*</label>
                                <div class="combo-input">
                                    <select id="websiteVaptFirstAuditCertificateState" name="state" required onchange="toggleVaptOtherInput('websiteVaptFirstAuditCertificateState', 'websiteVaptFirstAuditCertificateOtherState')">
                                        <option value="">Select State</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                        <option value="Assam">Assam</option>
                                        <option value="Bihar">Bihar</option>
                                        <option value="Chhattisgarh">Chhattisgarh</option>
                                        <option value="Goa">Goa</option>
                                        <option value="Gujarat">Gujarat</option>
                                        <option value="Haryana">Haryana</option>
                                        <option value="Himachal Pradesh">Himachal Pradesh</option>
                                        <option value="Jharkhand">Jharkhand</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Kerala">Kerala</option>
                                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Manipur">Manipur</option>
                                        <option value="Meghalaya">Meghalaya</option>
                                        <option value="Mizoram">Mizoram</option>
                                        <option value="Nagaland">Nagaland</option>
                                        <option value="Odisha">Odisha</option>
                                        <option value="Punjab">Punjab</option>
                                        <option value="Rajasthan">Rajasthan</option>
                                        <option value="Sikkim">Sikkim</option>
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="Telangana">Telangana</option>
                                        <option value="Tripura">Tripura</option>
                                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                                        <option value="Uttarakhand">Uttarakhand</option>
                                        <option value="West Bengal">West Bengal</option>

                                        <!-- Union Territories -->
                                        <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                        <option value="Chandigarh">Chandigarh</option>
                                        <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                        <option value="Delhi">Delhi</option>
                                        <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                        <option value="Ladakh">Ladakh</option>
                                        <option value="Lakshadweep">Lakshadweep</option>
                                        <option value="Puducherry">Puducherry</option>

                                    </select>
                                    <input type="text" id="websiteVaptFirstAuditCertificateOtherState" name="otherState" class="hidden" placeholder="Enter State Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFirstAuditCertificateAuditeeDesignation">Designation of the Auditee Person (Submitted To)*</label>
                                <input type="text" id="websiteVaptFirstAuditCertificateAuditeeDesignation" name="auditeeDesignation" required placeholder="Enter auditee designation">
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFirstAuditCertificateScope">Scope*</label>
                                <input type="text" id="websiteVaptFirstAuditCertificateScope" name="scope" required placeholder="Enter scope details">
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFirstAuditCertificateStartAuditDate">Start Audit Date*</label>
                                <input type="date" id="websiteVaptFirstAuditCertificateStartAuditDate" name="startAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFirstAuditCertificateEndAuditDate">End Audit Date*</label>
                                <input type="date" id="websiteVaptFirstAuditCertificateEndAuditDate" name="endAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFirstAuditCertificateReportId">Report ID*</label>
                                <input type="text" id="websiteVaptFirstAuditCertificateReportId" name="reportId" required placeholder="Enter report ID">
                            </div>

                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('websiteVaptFirstAuditCertificateModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Certificate</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Website VAPT Follow Up Audit Completion Certificate Modal -->
            <div id="websiteVaptFollowUpAuditCertificateModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Website VAPT Follow Up Audit Completion Certificate</h3>
                        <span class="close-modal" onclick="closeVaptModal('websiteVaptFollowUpAuditCertificateModal')">&times;</span>
                    </div>
                    <div class="modal-body">
                        <form id="websiteVaptFollowUpAuditCertificateForm" action="/process_website_vapt_follow_up_audit_certificate" method="POST">
                            <div class="form-group">
                                <label for="websiteVaptFollowUpAuditCertificateOrganizationName">Organization Name*</label>
                                <div class="combo-input">
                                    <select id="websiteVaptFollowUpAuditCertificateOrganizationName" name="organizationName" required onchange="toggleVaptOtherInput('websiteVaptFollowUpAuditCertificateOrganizationName', 'websiteVaptFollowUpAuditCertificateOtherOrganizationName')">
                                        <option value="">Select Organization</option>
                                        <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                        <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                        <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                        <option value="Megasoft Limited">Megasoft Limited</option>
                                        <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                        <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                        <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                        <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                        <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                        <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                        <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                        <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                        <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                        <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                        <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                        <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                        <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                        <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                        <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                        <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                        <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                        <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                        <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                        <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                        <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                        <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                        <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                        <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                        <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                        <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                        <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                        <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                        <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                        <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                        <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                        <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                        <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                        <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                        <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                        <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                        
                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="websiteVaptFollowUpAuditCertificateOtherOrganizationName" name="otherOrganizationName" class="hidden" placeholder="Enter Organization Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpAuditCertificateCity">City*</label>
                                <div class="combo-input">
                                    <select id="websiteVaptFollowUpAuditCertificateCity" name="city" required onchange="toggleVaptOtherInput('websiteVaptFollowUpAuditCertificateCity', 'websiteVaptFollowUpAuditCertificateOtherCity')">
                                        <option value="">Select City</option>
                                        <!-- Gujarat -->
                                        <option value="Ahmedabad">Ahmedabad</option>
                                        <option value="Amreli">Amreli</option>
                                        <option value="Anand">Anand</option>
                                        <option value="Aravalli">Aravalli</option>
                                        <option value="Banaskantha">Banaskantha</option>
                                        <option value="Bharuch">Bharuch</option>
                                        <option value="Bhavnagar">Bhavnagar</option>
                                        <option value="Botad">Botad</option>
                                        <option value="Chhota Udaipur">Chhota Udaipur</option>
                                        <option value="Dahod">Dahod</option>
                                        <option value="Dang">Dang</option>
                                        <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                        <option value="Gandhinagar">Gandhinagar</option>
                                        <option value="Gir Somnath">Gir Somnath</option>
                                        <option value="Jamnagar">Jamnagar</option>
                                        <option value="Junagadh">Junagadh</option>
                                        <option value="Kheda">Kheda</option>
                                        <option value="Kutch">Kutch</option>
                                        <option value="Mahisagar">Mahisagar</option>
                                        <option value="Mehsana">Mehsana</option>
                                        <option value="Morbi">Morbi</option>
                                        <option value="Narmada">Narmada</option>
                                        <option value="Navsari">Navsari</option>
                                        <option value="Patan">Patan</option>
                                        <option value="Panchmahal">Panchmahal</option>
                                        <option value="Porbandar">Porbandar</option>
                                        <option value="Rajkot">Rajkot</option>
                                        <option value="Sabarkantha">Sabarkantha</option>
                                        <option value="Surat">Surat</option>
                                        <option value="Surendranagar">Surendranagar</option>
                                        <option value="Tapi">Tapi</option>
                                        <option value="Vadodara">Vadodara</option>
                                        <option value="Valsad">Valsad</option>

                                        <!-- Rajasthan -->
                                        <option value="Ajmer">Ajmer</option>
                                        <option value="Alwar">Alwar</option>
                                        <option value="Banswara">Banswara</option>
                                        <option value="Baran">Baran</option>
                                        <option value="Barmer">Barmer</option>
                                        <option value="Bharatpur">Bharatpur</option>
                                        <option value="Bhilwara">Bhilwara</option>
                                        <option value="Bikaner">Bikaner</option>
                                        <option value="Bundi">Bundi</option>
                                        <option value="Chittorgarh">Chittorgarh</option>
                                        <option value="Churu">Churu</option>
                                        <option value="Dausa">Dausa</option>
                                        <option value="Dholpur">Dholpur</option>
                                        <option value="Dungarpur">Dungarpur</option>
                                        <option value="Hanumangarh">Hanumangarh</option>
                                        <option value="Jaipur">Jaipur</option>
                                        <option value="Jaisalmer">Jaisalmer</option>
                                        <option value="Jalore">Jalore</option>
                                        <option value="Jhalawar">Jhalawar</option>
                                        <option value="Jhunjhunu">Jhunjhunu</option>
                                        <option value="Jodhpur">Jodhpur</option>
                                        <option value="Karauli">Karauli</option>
                                        <option value="Kota">Kota</option>
                                        <option value="Nagaur">Nagaur</option>
                                        <option value="Pali">Pali</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rajsamand">Rajsamand</option>
                                        <option value="Sikar">Sikar</option>
                                        <option value="Sirohi">Sirohi</option>
                                        <option value="Sri Ganganagar">Sri Ganganagar</option>
                                        <option value="Tonk">Tonk</option>
                                        <option value="Udaipur">Udaipur</option>

                                        <!-- Maharashtra -->
                                        <option value="Ahmednagar">Ahmednagar</option>
                                        <option value="Akola">Akola</option>
                                        <option value="Amravati">Amravati</option>
                                        <option value="Aurangabad">Aurangabad</option>
                                        <option value="Beed">Beed</option>
                                        <option value="Bhandara">Bhandara</option>
                                        <option value="Chandrapur">Chandrapur</option>
                                        <option value="Dhule">Dhule</option>
                                        <option value="Gadchiroli">Gadchiroli</option>
                                        <option value="Gondia">Gondia</option>
                                        <option value="Hingoli">Hingoli</option>
                                        <option value="Jalgaon">Jalgaon</option>
                                        <option value="Jalna">Jalna</option>
                                        <option value="Kolhapur">Kolhapur</option>
                                        <option value="Latur">Latur</option>
                                        <option value="Mumbai City">Mumbai City</option>
                                        <option value="Mumbai Suburban">Mumbai Suburban</option>
                                        <option value="Nagpur">Nagpur</option>
                                        <option value="Nanded">Nanded</option>
                                        <option value="Nandurbar">Nandurbar</option>
                                        <option value="Nashik">Nashik</option>
                                        <option value="Osmanabad">Osmanabad</option>
                                        <option value="Palghar">Palghar</option>
                                        <option value="Parbhani">Parbhani</option>
                                        <option value="Pune">Pune</option>
                                        <option value="Raigad">Raigad</option>
                                        <option value="Ratnagiri">Ratnagiri</option>
                                        <option value="Sangli">Sangli</option>
                                        <option value="Satara">Satara</option>
                                        <option value="Sindhudurg">Sindhudurg</option>
                                        <option value="Solapur">Solapur</option>
                                        <option value="Thane">Thane</option>
                                        <option value="Wardha">Wardha</option>
                                        <option value="Washim">Washim</option>
                                        <option value="Yavatmal">Yavatmal</option>

                                        <!-- Uttar Pradesh -->
                                        <option value="Agra">Agra</option>
                                        <option value="Aligarh">Aligarh</option>
                                        <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                        <option value="Amethi">Amethi</option>
                                        <option value="Amroha">Amroha</option>
                                        <option value="Auraiya">Auraiya</option>
                                        <option value="Ayodhya">Ayodhya</option>
                                        <option value="Azamgarh">Azamgarh</option>
                                        <option value="Bagpat">Bagpat</option>
                                        <option value="Bahraich">Bahraich</option>
                                        <option value="Ballia">Ballia</option>
                                        <option value="Balrampur">Balrampur</option>
                                        <option value="Banda">Banda</option>
                                        <option value="Barabanki">Barabanki</option>
                                        <option value="Bareilly">Bareilly</option>
                                        <option value="Basti">Basti</option>
                                        <option value="Bhadohi">Bhadohi</option>
                                        <option value="Bijnor">Bijnor</option>
                                        <option value="Bulandshahr">Bulandshahr</option>
                                        <option value="Chandauli">Chandauli</option>
                                        <option value="Chitrakoot">Chitrakoot</option>
                                        <option value="Deoria">Deoria</option>
                                        <option value="Etah">Etah</option>
                                        <option value="Etawah">Etawah</option>
                                        <option value="Farrukhabad">Farrukhabad</option>
                                        <option value="Fatehpur">Fatehpur</option>
                                        <option value="Firozabad">Firozabad</option>
                                        <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                        <option value="Ghaziabad">Ghaziabad</option>
                                        <option value="Ghazipur">Ghazipur</option>
                                        <option value="Gonda">Gonda</option>
                                        <option value="Gorakhpur">Gorakhpur</option>
                                        <option value="Hamirpur">Hamirpur</option>
                                        <option value="Hapur">Hapur</option>
                                        <option value="Hardoi">Hardoi</option>
                                        <option value="Hathras">Hathras</option>
                                        <option value="Jalaun">Jalaun</option>
                                        <option value="Jaunpur">Jaunpur</option>
                                        <option value="Jhansi">Jhansi</option>
                                        <option value="Kannauj">Kannauj</option>
                                        <option value="Kanpur Dehat">Kanpur Dehat</option>
                                        <option value="Kanpur Nagar">Kanpur Nagar</option>
                                        <option value="Kasganj">Kasganj</option>
                                        <option value="Kaushambi">Kaushambi</option>
                                        <option value="Kushinagar">Kushinagar</option>
                                        <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                        <option value="Lalitpur">Lalitpur</option>
                                        <option value="Lucknow">Lucknow</option>
                                        <option value="Maharajganj">Maharajganj</option>
                                        <option value="Mahoba">Mahoba</option>
                                        <option value="Mainpuri">Mainpuri</option>
                                        <option value="Mathura">Mathura</option>
                                        <option value="Mau">Mau</option>
                                        <option value="Meerut">Meerut</option>
                                        <option value="Mirzapur">Mirzapur</option>
                                        <option value="Moradabad">Moradabad</option>
                                        <option value="Muzaffarnagar">Muzaffarnagar</option>
                                        <option value="Pilibhit">Pilibhit</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rae Bareli">Rae Bareli</option>
                                        <option value="Rampur">Rampur</option>
                                        <option value="Saharanpur">Saharanpur</option>
                                        <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                        <option value="Shahjahanpur">Shahjahanpur</option>
                                        <option value="Shravasti">Shravasti</option>
                                        <option value="Siddharthnagar">Siddharthnagar</option>
                                        <option value="Sitapur">Sitapur</option>
                                        <option value="Sonbhadra">Sonbhadra</option>
                                        <option value="Sultanpur">Sultanpur</option>
                                        <option value="Unnao">Unnao</option>
                                        <option value="Varanasi">Varanasi</option>

                                        <!-- Uttarakhand -->
                                        <option value="Almora">Almora</option>
                                        <option value="Bageshwar">Bageshwar</option>
                                        <option value="Chamoli">Chamoli</option>
                                        <option value="Champawat">Champawat</option>
                                        <option value="Dehradun">Dehradun</option>
                                        <option value="Haridwar">Haridwar</option>
                                        <option value="Nainital">Nainital</option>
                                        <option value="Pauri Garhwal">Pauri Garhwal</option>
                                        <option value="Pithoragarh">Pithoragarh</option>
                                        <option value="Rudraprayag">Rudraprayag</option>
                                        <option value="Tehri Garhwal">Tehri Garhwal</option>
                                        <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                        <option value="Uttarkashi">Uttarkashi</option>

                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="websiteVaptFollowUpAuditCertificateOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpAuditCertificateState">State*</label>
                                <div class="combo-input">
                                    <select id="websiteVaptFollowUpAuditCertificateState" name="state" required onchange="toggleVaptOtherInput('websiteVaptFollowUpAuditCertificateState', 'websiteVaptFollowUpAuditCertificateOtherState')">
                                        <option value="">Select State</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                        <option value="Assam">Assam</option>
                                        <option value="Bihar">Bihar</option>
                                        <option value="Chhattisgarh">Chhattisgarh</option>
                                        <option value="Goa">Goa</option>
                                        <option value="Gujarat">Gujarat</option>
                                        <option value="Haryana">Haryana</option>
                                        <option value="Himachal Pradesh">Himachal Pradesh</option>
                                        <option value="Jharkhand">Jharkhand</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Kerala">Kerala</option>
                                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Manipur">Manipur</option>
                                        <option value="Meghalaya">Meghalaya</option>
                                        <option value="Mizoram">Mizoram</option>
                                        <option value="Nagaland">Nagaland</option>
                                        <option value="Odisha">Odisha</option>
                                        <option value="Punjab">Punjab</option>
                                        <option value="Rajasthan">Rajasthan</option>
                                        <option value="Sikkim">Sikkim</option>
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="Telangana">Telangana</option>
                                        <option value="Tripura">Tripura</option>
                                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                                        <option value="Uttarakhand">Uttarakhand</option>
                                        <option value="West Bengal">West Bengal</option>

                                        <!-- Union Territories -->
                                        <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                        <option value="Chandigarh">Chandigarh</option>
                                        <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                        <option value="Delhi">Delhi</option>
                                        <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                        <option value="Ladakh">Ladakh</option>
                                        <option value="Lakshadweep">Lakshadweep</option>
                                        <option value="Puducherry">Puducherry</option>

                                    </select>
                                    <input type="text" id="websiteVaptFollowUpAuditCertificateOtherState" name="otherState" class="hidden" placeholder="Enter State Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpAuditCertificateAuditeeDesignation">Designation of the Auditee Person (Submitted To)*</label>
                                <input type="text" id="websiteVaptFollowUpAuditCertificateAuditeeDesignation" name="auditeeDesignation" required placeholder="Enter auditee designation">
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpAuditCertificateScope">Scope*</label>
                                <input type="text" id="websiteVaptFollowUpAuditCertificateScope" name="scope" required placeholder="Enter scope details">
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpAuditCertificateStartAuditDate">Start Audit Date*</label>
                                <input type="date" id="websiteVaptFollowUpAuditCertificateStartAuditDate" name="startAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpAuditCertificateEndAuditDate">End Audit Date*</label>
                                <input type="date" id="websiteVaptFollowUpAuditCertificateEndAuditDate" name="endAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpAuditCertificateFirstReportId">First Audit Report ID*</label>
                                <input type="text" id="websiteVaptFollowUpAuditCertificateFirstReportId" name="firstReportId" required placeholder="Enter first audit report ID">
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpAuditCertificateReportId">Report ID*</label>
                                <input type="text" id="websiteVaptFollowUpAuditCertificateReportId" name="reportId" required placeholder="Enter report ID">
                            </div>

                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('websiteVaptFollowUpAuditCertificateModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Certificate</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Public IP VAPT Follow Up Audit Completion Certificate Modal -->
            <div id="publicIpVaptFollowUpAuditCertificateModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Public IP VAPT Follow Up Audit Completion Certificate</h3>
                        <span class="close-modal" onclick="closeVaptModal('publicIpVaptFollowUpAuditCertificateModal')">&times;</span>
                    </div>
                    <div class="modal-body">
                        <form id="publicIpVaptFollowUpAuditCertificateForm" action="/process_public_ip_vapt_follow_up_audit_certificate" method="POST">
                            <div class="form-group">
                                <label for="publicIpVaptFollowUpAuditCertificateOrganizationName">Organization Name*</label>
                                <div class="combo-input">
                                    <select id="publicIpVaptFollowUpAuditCertificateOrganizationName" name="organizationName" required onchange="toggleVaptOtherInput('publicIpVaptFollowUpAuditCertificateOrganizationName', 'publicIpVaptFollowUpAuditCertificateOtherOrganizationName')">
                                        <option value="">Select Organization</option>
                                        <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                        <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                        <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                        <option value="Megasoft Limited">Megasoft Limited</option>
                                        <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                        <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                        <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                        <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                        <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                        <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                        <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                        <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                        <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                        <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                        <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                        <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                        <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                        <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                        <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                        <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                        <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                        <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                        <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                        <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                        <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                        <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                        <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                        <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                        <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                        <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                        <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                        <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                        <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                        <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                        <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                        <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                        <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                        <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                        <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                        <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                        
                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="publicIpVaptFollowUpAuditCertificateOtherOrganizationName" name="otherOrganizationName" class="hidden" placeholder="Enter Organization Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="publicIpVaptFollowUpAuditCertificateCity">City*</label>
                                <div class="combo-input">
                                    <select id="publicIpVaptFollowUpAuditCertificateCity" name="city" required onchange="toggleVaptOtherInput('publicIpVaptFollowUpAuditCertificateCity', 'publicIpVaptFollowUpAuditCertificateOtherCity')">
                                        <option value="">Select City</option>
                                        <!-- Gujarat -->
                                        <option value="Ahmedabad">Ahmedabad</option>
                                        <option value="Amreli">Amreli</option>
                                        <option value="Anand">Anand</option>
                                        <option value="Aravalli">Aravalli</option>
                                        <option value="Banaskantha">Banaskantha</option>
                                        <option value="Bharuch">Bharuch</option>
                                        <option value="Bhavnagar">Bhavnagar</option>
                                        <option value="Botad">Botad</option>
                                        <option value="Chhota Udaipur">Chhota Udaipur</option>
                                        <option value="Dahod">Dahod</option>
                                        <option value="Dang">Dang</option>
                                        <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                        <option value="Gandhinagar">Gandhinagar</option>
                                        <option value="Gir Somnath">Gir Somnath</option>
                                        <option value="Jamnagar">Jamnagar</option>
                                        <option value="Junagadh">Junagadh</option>
                                        <option value="Kheda">Kheda</option>
                                        <option value="Kutch">Kutch</option>
                                        <option value="Mahisagar">Mahisagar</option>
                                        <option value="Mehsana">Mehsana</option>
                                        <option value="Morbi">Morbi</option>
                                        <option value="Narmada">Narmada</option>
                                        <option value="Navsari">Navsari</option>
                                        <option value="Patan">Patan</option>
                                        <option value="Panchmahal">Panchmahal</option>
                                        <option value="Porbandar">Porbandar</option>
                                        <option value="Rajkot">Rajkot</option>
                                        <option value="Sabarkantha">Sabarkantha</option>
                                        <option value="Surat">Surat</option>
                                        <option value="Surendranagar">Surendranagar</option>
                                        <option value="Tapi">Tapi</option>
                                        <option value="Vadodara">Vadodara</option>
                                        <option value="Valsad">Valsad</option>

                                        <!-- Rajasthan -->
                                        <option value="Ajmer">Ajmer</option>
                                        <option value="Alwar">Alwar</option>
                                        <option value="Banswara">Banswara</option>
                                        <option value="Baran">Baran</option>
                                        <option value="Barmer">Barmer</option>
                                        <option value="Bharatpur">Bharatpur</option>
                                        <option value="Bhilwara">Bhilwara</option>
                                        <option value="Bikaner">Bikaner</option>
                                        <option value="Bundi">Bundi</option>
                                        <option value="Chittorgarh">Chittorgarh</option>
                                        <option value="Churu">Churu</option>
                                        <option value="Dausa">Dausa</option>
                                        <option value="Dholpur">Dholpur</option>
                                        <option value="Dungarpur">Dungarpur</option>
                                        <option value="Hanumangarh">Hanumangarh</option>
                                        <option value="Jaipur">Jaipur</option>
                                        <option value="Jaisalmer">Jaisalmer</option>
                                        <option value="Jalore">Jalore</option>
                                        <option value="Jhalawar">Jhalawar</option>
                                        <option value="Jhunjhunu">Jhunjhunu</option>
                                        <option value="Jodhpur">Jodhpur</option>
                                        <option value="Karauli">Karauli</option>
                                        <option value="Kota">Kota</option>
                                        <option value="Nagaur">Nagaur</option>
                                        <option value="Pali">Pali</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rajsamand">Rajsamand</option>
                                        <option value="Sikar">Sikar</option>
                                        <option value="Sirohi">Sirohi</option>
                                        <option value="Sri Ganganagar">Sri Ganganagar</option>
                                        <option value="Tonk">Tonk</option>
                                        <option value="Udaipur">Udaipur</option>

                                        <!-- Maharashtra -->
                                        <option value="Ahmednagar">Ahmednagar</option>
                                        <option value="Akola">Akola</option>
                                        <option value="Amravati">Amravati</option>
                                        <option value="Aurangabad">Aurangabad</option>
                                        <option value="Beed">Beed</option>
                                        <option value="Bhandara">Bhandara</option>
                                        <option value="Chandrapur">Chandrapur</option>
                                        <option value="Dhule">Dhule</option>
                                        <option value="Gadchiroli">Gadchiroli</option>
                                        <option value="Gondia">Gondia</option>
                                        <option value="Hingoli">Hingoli</option>
                                        <option value="Jalgaon">Jalgaon</option>
                                        <option value="Jalna">Jalna</option>
                                        <option value="Kolhapur">Kolhapur</option>
                                        <option value="Latur">Latur</option>
                                        <option value="Mumbai City">Mumbai City</option>
                                        <option value="Mumbai Suburban">Mumbai Suburban</option>
                                        <option value="Nagpur">Nagpur</option>
                                        <option value="Nanded">Nanded</option>
                                        <option value="Nandurbar">Nandurbar</option>
                                        <option value="Nashik">Nashik</option>
                                        <option value="Osmanabad">Osmanabad</option>
                                        <option value="Palghar">Palghar</option>
                                        <option value="Parbhani">Parbhani</option>
                                        <option value="Pune">Pune</option>
                                        <option value="Raigad">Raigad</option>
                                        <option value="Ratnagiri">Ratnagiri</option>
                                        <option value="Sangli">Sangli</option>
                                        <option value="Satara">Satara</option>
                                        <option value="Sindhudurg">Sindhudurg</option>
                                        <option value="Solapur">Solapur</option>
                                        <option value="Thane">Thane</option>
                                        <option value="Wardha">Wardha</option>
                                        <option value="Washim">Washim</option>
                                        <option value="Yavatmal">Yavatmal</option>

                                        <!-- Uttar Pradesh -->
                                        <option value="Agra">Agra</option>
                                        <option value="Aligarh">Aligarh</option>
                                        <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                        <option value="Amethi">Amethi</option>
                                        <option value="Amroha">Amroha</option>
                                        <option value="Auraiya">Auraiya</option>
                                        <option value="Ayodhya">Ayodhya</option>
                                        <option value="Azamgarh">Azamgarh</option>
                                        <option value="Bagpat">Bagpat</option>
                                        <option value="Bahraich">Bahraich</option>
                                        <option value="Ballia">Ballia</option>
                                        <option value="Balrampur">Balrampur</option>
                                        <option value="Banda">Banda</option>
                                        <option value="Barabanki">Barabanki</option>
                                        <option value="Bareilly">Bareilly</option>
                                        <option value="Basti">Basti</option>
                                        <option value="Bhadohi">Bhadohi</option>
                                        <option value="Bijnor">Bijnor</option>
                                        <option value="Bulandshahr">Bulandshahr</option>
                                        <option value="Chandauli">Chandauli</option>
                                        <option value="Chitrakoot">Chitrakoot</option>
                                        <option value="Deoria">Deoria</option>
                                        <option value="Etah">Etah</option>
                                        <option value="Etawah">Etawah</option>
                                        <option value="Farrukhabad">Farrukhabad</option>
                                        <option value="Fatehpur">Fatehpur</option>
                                        <option value="Firozabad">Firozabad</option>
                                        <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                        <option value="Ghaziabad">Ghaziabad</option>
                                        <option value="Ghazipur">Ghazipur</option>
                                        <option value="Gonda">Gonda</option>
                                        <option value="Gorakhpur">Gorakhpur</option>
                                        <option value="Hamirpur">Hamirpur</option>
                                        <option value="Hapur">Hapur</option>
                                        <option value="Hardoi">Hardoi</option>
                                        <option value="Hathras">Hathras</option>
                                        <option value="Jalaun">Jalaun</option>
                                        <option value="Jaunpur">Jaunpur</option>
                                        <option value="Jhansi">Jhansi</option>
                                        <option value="Kannauj">Kannauj</option>
                                        <option value="Kanpur Dehat">Kanpur Dehat</option>
                                        <option value="Kanpur Nagar">Kanpur Nagar</option>
                                        <option value="Kasganj">Kasganj</option>
                                        <option value="Kaushambi">Kaushambi</option>
                                        <option value="Kushinagar">Kushinagar</option>
                                        <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                        <option value="Lalitpur">Lalitpur</option>
                                        <option value="Lucknow">Lucknow</option>
                                        <option value="Maharajganj">Maharajganj</option>
                                        <option value="Mahoba">Mahoba</option>
                                        <option value="Mainpuri">Mainpuri</option>
                                        <option value="Mathura">Mathura</option>
                                        <option value="Mau">Mau</option>
                                        <option value="Meerut">Meerut</option>
                                        <option value="Mirzapur">Mirzapur</option>
                                        <option value="Moradabad">Moradabad</option>
                                        <option value="Muzaffarnagar">Muzaffarnagar</option>
                                        <option value="Pilibhit">Pilibhit</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rae Bareli">Rae Bareli</option>
                                        <option value="Rampur">Rampur</option>
                                        <option value="Saharanpur">Saharanpur</option>
                                        <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                        <option value="Shahjahanpur">Shahjahanpur</option>
                                        <option value="Shravasti">Shravasti</option>
                                        <option value="Siddharthnagar">Siddharthnagar</option>
                                        <option value="Sitapur">Sitapur</option>
                                        <option value="Sonbhadra">Sonbhadra</option>
                                        <option value="Sultanpur">Sultanpur</option>
                                        <option value="Unnao">Unnao</option>
                                        <option value="Varanasi">Varanasi</option>

                                        <!-- Uttarakhand -->
                                        <option value="Almora">Almora</option>
                                        <option value="Bageshwar">Bageshwar</option>
                                        <option value="Chamoli">Chamoli</option>
                                        <option value="Champawat">Champawat</option>
                                        <option value="Dehradun">Dehradun</option>
                                        <option value="Haridwar">Haridwar</option>
                                        <option value="Nainital">Nainital</option>
                                        <option value="Pauri Garhwal">Pauri Garhwal</option>
                                        <option value="Pithoragarh">Pithoragarh</option>
                                        <option value="Rudraprayag">Rudraprayag</option>
                                        <option value="Tehri Garhwal">Tehri Garhwal</option>
                                        <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                        <option value="Uttarkashi">Uttarkashi</option>

                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="publicIpVaptFollowUpAuditCertificateOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="publicIpVaptFollowUpAuditCertificateState">State*</label>
                                <div class="combo-input">
                                    <select id="publicIpVaptFollowUpAuditCertificateState" name="state" required onchange="toggleVaptOtherInput('publicIpVaptFollowUpAuditCertificateState', 'publicIpVaptFollowUpAuditCertificateOtherState')">
                                        <option value="">Select State</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                        <option value="Assam">Assam</option>
                                        <option value="Bihar">Bihar</option>
                                        <option value="Chhattisgarh">Chhattisgarh</option>
                                        <option value="Goa">Goa</option>
                                        <option value="Gujarat">Gujarat</option>
                                        <option value="Haryana">Haryana</option>
                                        <option value="Himachal Pradesh">Himachal Pradesh</option>
                                        <option value="Jharkhand">Jharkhand</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Kerala">Kerala</option>
                                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Manipur">Manipur</option>
                                        <option value="Meghalaya">Meghalaya</option>
                                        <option value="Mizoram">Mizoram</option>
                                        <option value="Nagaland">Nagaland</option>
                                        <option value="Odisha">Odisha</option>
                                        <option value="Punjab">Punjab</option>
                                        <option value="Rajasthan">Rajasthan</option>
                                        <option value="Sikkim">Sikkim</option>
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="Telangana">Telangana</option>
                                        <option value="Tripura">Tripura</option>
                                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                                        <option value="Uttarakhand">Uttarakhand</option>
                                        <option value="West Bengal">West Bengal</option>

                                        <!-- Union Territories -->
                                        <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                        <option value="Chandigarh">Chandigarh</option>
                                        <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                        <option value="Delhi">Delhi</option>
                                        <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                        <option value="Ladakh">Ladakh</option>
                                        <option value="Lakshadweep">Lakshadweep</option>
                                        <option value="Puducherry">Puducherry</option>

                                    </select>
                                    <input type="text" id="publicIpVaptFollowUpAuditCertificateOtherState" name="otherState" class="hidden" placeholder="Enter State Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="publicIpVaptFollowUpAuditCertificateAuditeeDesignation">Designation of the Auditee Person (Submitted To)*</label>
                                <input type="text" id="publicIpVaptFollowUpAuditCertificateAuditeeDesignation" name="auditeeDesignation" required placeholder="Enter auditee designation">
                            </div>

                            <div class="form-group">
                                <label for="publicIpVaptFollowUpAuditCertificateScope">Scope*</label>
                                <input type="text" id="publicIpVaptFollowUpAuditCertificateScope" name="scope" required placeholder="Enter scope details">
                            </div>

                            <div class="form-group">
                                <label for="publicIpVaptFollowUpAuditCertificateStartAuditDate">Start Audit Date*</label>
                                <input type="date" id="publicIpVaptFollowUpAuditCertificateStartAuditDate" name="startAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="publicIpVaptFollowUpAuditCertificateEndAuditDate">End Audit Date*</label>
                                <input type="date" id="publicIpVaptFollowUpAuditCertificateEndAuditDate" name="endAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="publicIpVaptFollowUpAuditCertificateFirstReportId">First Audit Report ID*</label>
                                <input type="text" id="publicIpVaptFollowUpAuditCertificateFirstReportId" name="firstReportId" required placeholder="Enter first audit report ID">
                            </div>

                            <div class="form-group">
                                <label for="publicIpVaptFollowUpAuditCertificateReportId">Follow-up Report ID*</label>
                                <input type="text" id="publicIpVaptFollowUpAuditCertificateReportId" name="reportId" required placeholder="Enter follow-up report ID">
                            </div>

                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('publicIpVaptFollowUpAuditCertificateModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Certificate</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Web Application VAPT Follow Up Audit Completion Certificate Modal -->
            <div id="webAppVaptFollowUpAuditCertificateModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Web Application VAPT Follow Up Audit Completion Certificate</h3>
                        <span class="close-modal" onclick="closeVaptModal('webAppVaptFollowUpAuditCertificateModal')">&times;</span>
                    </div>
                    <div class="modal-body">
                        <form id="webAppVaptFollowUpAuditCertificateForm" action="/process_web_app_vapt_follow_up_audit_certificate" method="POST">
                            <div class="form-group">
                                <label for="webAppVaptFollowUpAuditCertificateOrganizationName">Organization Name*</label>
                                <div class="combo-input">
                                    <select id="webAppVaptFollowUpAuditCertificateOrganizationName" name="organizationName" required onchange="toggleVaptOtherInput('webAppVaptFollowUpAuditCertificateOrganizationName', 'webAppVaptFollowUpAuditCertificateOtherOrganizationName')">
                                        <option value="">Select Organization</option>
                                        <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                        <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                        <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                        <option value="Megasoft Limited">Megasoft Limited</option>
                                        <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                        <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                        <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                        <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                        <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                        <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                        <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                        <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                        <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                        <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                        <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                        <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                        <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                        <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                        <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                        <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                        <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                        <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                        <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                        <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                        <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                        <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                        <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                        <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                        <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                        <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                        <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                        <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                        <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                        <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                        <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                        <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                        <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                        <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                        <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                        <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                        
                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="webAppVaptFollowUpAuditCertificateOtherOrganizationName" name="otherOrganizationName" class="hidden" placeholder="Enter Organization Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="webAppVaptFollowUpAuditCertificateCity">City*</label>
                                <div class="combo-input">
                                    <select id="webAppVaptFollowUpAuditCertificateCity" name="city" required onchange="toggleVaptOtherInput('webAppVaptFollowUpAuditCertificateCity', 'webAppVaptFollowUpAuditCertificateOtherCity')">
                                        <option value="">Select City</option>
                                        <!-- Gujarat -->
                                        <option value="Ahmedabad">Ahmedabad</option>
                                        <option value="Amreli">Amreli</option>
                                        <option value="Anand">Anand</option>
                                        <option value="Aravalli">Aravalli</option>
                                        <option value="Banaskantha">Banaskantha</option>
                                        <option value="Bharuch">Bharuch</option>
                                        <option value="Bhavnagar">Bhavnagar</option>
                                        <option value="Botad">Botad</option>
                                        <option value="Chhota Udaipur">Chhota Udaipur</option>
                                        <option value="Dahod">Dahod</option>
                                        <option value="Dang">Dang</option>
                                        <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                        <option value="Gandhinagar">Gandhinagar</option>
                                        <option value="Gir Somnath">Gir Somnath</option>
                                        <option value="Jamnagar">Jamnagar</option>
                                        <option value="Junagadh">Junagadh</option>
                                        <option value="Kheda">Kheda</option>
                                        <option value="Kutch">Kutch</option>
                                        <option value="Mahisagar">Mahisagar</option>
                                        <option value="Mehsana">Mehsana</option>
                                        <option value="Morbi">Morbi</option>
                                        <option value="Narmada">Narmada</option>
                                        <option value="Navsari">Navsari</option>
                                        <option value="Patan">Patan</option>
                                        <option value="Panchmahal">Panchmahal</option>
                                        <option value="Porbandar">Porbandar</option>
                                        <option value="Rajkot">Rajkot</option>
                                        <option value="Sabarkantha">Sabarkantha</option>
                                        <option value="Surat">Surat</option>
                                        <option value="Surendranagar">Surendranagar</option>
                                        <option value="Tapi">Tapi</option>
                                        <option value="Vadodara">Vadodara</option>
                                        <option value="Valsad">Valsad</option>

                                        <!-- Rajasthan -->
                                        <option value="Ajmer">Ajmer</option>
                                        <option value="Alwar">Alwar</option>
                                        <option value="Banswara">Banswara</option>
                                        <option value="Baran">Baran</option>
                                        <option value="Barmer">Barmer</option>
                                        <option value="Bharatpur">Bharatpur</option>
                                        <option value="Bhilwara">Bhilwara</option>
                                        <option value="Bikaner">Bikaner</option>
                                        <option value="Bundi">Bundi</option>
                                        <option value="Chittorgarh">Chittorgarh</option>
                                        <option value="Churu">Churu</option>
                                        <option value="Dausa">Dausa</option>
                                        <option value="Dholpur">Dholpur</option>
                                        <option value="Dungarpur">Dungarpur</option>
                                        <option value="Hanumangarh">Hanumangarh</option>
                                        <option value="Jaipur">Jaipur</option>
                                        <option value="Jaisalmer">Jaisalmer</option>
                                        <option value="Jalore">Jalore</option>
                                        <option value="Jhalawar">Jhalawar</option>
                                        <option value="Jhunjhunu">Jhunjhunu</option>
                                        <option value="Jodhpur">Jodhpur</option>
                                        <option value="Karauli">Karauli</option>
                                        <option value="Kota">Kota</option>
                                        <option value="Nagaur">Nagaur</option>
                                        <option value="Pali">Pali</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rajsamand">Rajsamand</option>
                                        <option value="Sikar">Sikar</option>
                                        <option value="Sirohi">Sirohi</option>
                                        <option value="Sri Ganganagar">Sri Ganganagar</option>
                                        <option value="Tonk">Tonk</option>
                                        <option value="Udaipur">Udaipur</option>

                                        <!-- Maharashtra -->
                                        <option value="Ahmednagar">Ahmednagar</option>
                                        <option value="Akola">Akola</option>
                                        <option value="Amravati">Amravati</option>
                                        <option value="Aurangabad">Aurangabad</option>
                                        <option value="Beed">Beed</option>
                                        <option value="Bhandara">Bhandara</option>
                                        <option value="Chandrapur">Chandrapur</option>
                                        <option value="Dhule">Dhule</option>
                                        <option value="Gadchiroli">Gadchiroli</option>
                                        <option value="Gondia">Gondia</option>
                                        <option value="Hingoli">Hingoli</option>
                                        <option value="Jalgaon">Jalgaon</option>
                                        <option value="Jalna">Jalna</option>
                                        <option value="Kolhapur">Kolhapur</option>
                                        <option value="Latur">Latur</option>
                                        <option value="Mumbai City">Mumbai City</option>
                                        <option value="Mumbai Suburban">Mumbai Suburban</option>
                                        <option value="Nagpur">Nagpur</option>
                                        <option value="Nanded">Nanded</option>
                                        <option value="Nandurbar">Nandurbar</option>
                                        <option value="Nashik">Nashik</option>
                                        <option value="Osmanabad">Osmanabad</option>
                                        <option value="Palghar">Palghar</option>
                                        <option value="Parbhani">Parbhani</option>
                                        <option value="Pune">Pune</option>
                                        <option value="Raigad">Raigad</option>
                                        <option value="Ratnagiri">Ratnagiri</option>
                                        <option value="Sangli">Sangli</option>
                                        <option value="Satara">Satara</option>
                                        <option value="Sindhudurg">Sindhudurg</option>
                                        <option value="Solapur">Solapur</option>
                                        <option value="Thane">Thane</option>
                                        <option value="Wardha">Wardha</option>
                                        <option value="Washim">Washim</option>
                                        <option value="Yavatmal">Yavatmal</option>

                                        <!-- Uttar Pradesh -->
                                        <option value="Agra">Agra</option>
                                        <option value="Aligarh">Aligarh</option>
                                        <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                        <option value="Amethi">Amethi</option>
                                        <option value="Amroha">Amroha</option>
                                        <option value="Auraiya">Auraiya</option>
                                        <option value="Ayodhya">Ayodhya</option>
                                        <option value="Azamgarh">Azamgarh</option>
                                        <option value="Bagpat">Bagpat</option>
                                        <option value="Bahraich">Bahraich</option>
                                        <option value="Ballia">Ballia</option>
                                        <option value="Balrampur">Balrampur</option>
                                        <option value="Banda">Banda</option>
                                        <option value="Barabanki">Barabanki</option>
                                        <option value="Bareilly">Bareilly</option>
                                        <option value="Basti">Basti</option>
                                        <option value="Bhadohi">Bhadohi</option>
                                        <option value="Bijnor">Bijnor</option>
                                        <option value="Bulandshahr">Bulandshahr</option>
                                        <option value="Chandauli">Chandauli</option>
                                        <option value="Chitrakoot">Chitrakoot</option>
                                        <option value="Deoria">Deoria</option>
                                        <option value="Etah">Etah</option>
                                        <option value="Etawah">Etawah</option>
                                        <option value="Farrukhabad">Farrukhabad</option>
                                        <option value="Fatehpur">Fatehpur</option>
                                        <option value="Firozabad">Firozabad</option>
                                        <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                        <option value="Ghaziabad">Ghaziabad</option>
                                        <option value="Ghazipur">Ghazipur</option>
                                        <option value="Gonda">Gonda</option>
                                        <option value="Gorakhpur">Gorakhpur</option>
                                        <option value="Hamirpur">Hamirpur</option>
                                        <option value="Hapur">Hapur</option>
                                        <option value="Hardoi">Hardoi</option>
                                        <option value="Hathras">Hathras</option>
                                        <option value="Jalaun">Jalaun</option>
                                        <option value="Jaunpur">Jaunpur</option>
                                        <option value="Jhansi">Jhansi</option>
                                        <option value="Kannauj">Kannauj</option>
                                        <option value="Kanpur Dehat">Kanpur Dehat</option>
                                        <option value="Kanpur Nagar">Kanpur Nagar</option>
                                        <option value="Kasganj">Kasganj</option>
                                        <option value="Kaushambi">Kaushambi</option>
                                        <option value="Kushinagar">Kushinagar</option>
                                        <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                        <option value="Lalitpur">Lalitpur</option>
                                        <option value="Lucknow">Lucknow</option>
                                        <option value="Maharajganj">Maharajganj</option>
                                        <option value="Mahoba">Mahoba</option>
                                        <option value="Mainpuri">Mainpuri</option>
                                        <option value="Mathura">Mathura</option>
                                        <option value="Mau">Mau</option>
                                        <option value="Meerut">Meerut</option>
                                        <option value="Mirzapur">Mirzapur</option>
                                        <option value="Moradabad">Moradabad</option>
                                        <option value="Muzaffarnagar">Muzaffarnagar</option>
                                        <option value="Pilibhit">Pilibhit</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rae Bareli">Rae Bareli</option>
                                        <option value="Rampur">Rampur</option>
                                        <option value="Saharanpur">Saharanpur</option>
                                        <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                        <option value="Shahjahanpur">Shahjahanpur</option>
                                        <option value="Shravasti">Shravasti</option>
                                        <option value="Siddharthnagar">Siddharthnagar</option>
                                        <option value="Sitapur">Sitapur</option>
                                        <option value="Sonbhadra">Sonbhadra</option>
                                        <option value="Sultanpur">Sultanpur</option>
                                        <option value="Unnao">Unnao</option>
                                        <option value="Varanasi">Varanasi</option>

                                        <!-- Uttarakhand -->
                                        <option value="Almora">Almora</option>
                                        <option value="Bageshwar">Bageshwar</option>
                                        <option value="Chamoli">Chamoli</option>
                                        <option value="Champawat">Champawat</option>
                                        <option value="Dehradun">Dehradun</option>
                                        <option value="Haridwar">Haridwar</option>
                                        <option value="Nainital">Nainital</option>
                                        <option value="Pauri Garhwal">Pauri Garhwal</option>
                                        <option value="Pithoragarh">Pithoragarh</option>
                                        <option value="Rudraprayag">Rudraprayag</option>
                                        <option value="Tehri Garhwal">Tehri Garhwal</option>
                                        <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                        <option value="Uttarkashi">Uttarkashi</option>

                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="webAppVaptFollowUpAuditCertificateOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="webAppVaptFollowUpAuditCertificateState">State*</label>
                                <div class="combo-input">
                                    <select id="webAppVaptFollowUpAuditCertificateState" name="state" required onchange="toggleVaptOtherInput('webAppVaptFollowUpAuditCertificateState', 'webAppVaptFollowUpAuditCertificateOtherState')">
                                        <option value="">Select State</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                        <option value="Assam">Assam</option>
                                        <option value="Bihar">Bihar</option>
                                        <option value="Chhattisgarh">Chhattisgarh</option>
                                        <option value="Goa">Goa</option>
                                        <option value="Gujarat">Gujarat</option>
                                        <option value="Haryana">Haryana</option>
                                        <option value="Himachal Pradesh">Himachal Pradesh</option>
                                        <option value="Jharkhand">Jharkhand</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Kerala">Kerala</option>
                                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Manipur">Manipur</option>
                                        <option value="Meghalaya">Meghalaya</option>
                                        <option value="Mizoram">Mizoram</option>
                                        <option value="Nagaland">Nagaland</option>
                                        <option value="Odisha">Odisha</option>
                                        <option value="Punjab">Punjab</option>
                                        <option value="Rajasthan">Rajasthan</option>
                                        <option value="Sikkim">Sikkim</option>
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="Telangana">Telangana</option>
                                        <option value="Tripura">Tripura</option>
                                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                                        <option value="Uttarakhand">Uttarakhand</option>
                                        <option value="West Bengal">West Bengal</option>

                                        <!-- Union Territories -->
                                        <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                        <option value="Chandigarh">Chandigarh</option>
                                        <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                        <option value="Delhi">Delhi</option>
                                        <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                        <option value="Ladakh">Ladakh</option>
                                        <option value="Lakshadweep">Lakshadweep</option>
                                        <option value="Puducherry">Puducherry</option>

                                    </select>
                                    <input type="text" id="webAppVaptFollowUpAuditCertificateOtherState" name="otherState" class="hidden" placeholder="Enter State Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="webAppVaptFollowUpAuditCertificateAuditeeDesignation">Designation of the Auditee Person (Submitted To)*</label>
                                <input type="text" id="webAppVaptFollowUpAuditCertificateAuditeeDesignation" name="auditeeDesignation" required placeholder="Enter auditee designation">
                            </div>

                            <div class="form-group">
                                <label for="webAppVaptFollowUpAuditCertificateScope">Scope*</label>
                                <input type="text" id="webAppVaptFollowUpAuditCertificateScope" name="scope" required placeholder="Enter scope details">
                            </div>

                            <div class="form-group">
                                <label for="webAppVaptFollowUpAuditCertificateStartAuditDate">Start Audit Date*</label>
                                <input type="date" id="webAppVaptFollowUpAuditCertificateStartAuditDate" name="startAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="webAppVaptFollowUpAuditCertificateEndAuditDate">End Audit Date*</label>
                                <input type="date" id="webAppVaptFollowUpAuditCertificateEndAuditDate" name="endAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="webAppVaptFollowUpAuditCertificateFirstReportId">First Audit Report ID*</label>
                                <input type="text" id="webAppVaptFollowUpAuditCertificateFirstReportId" name="firstReportId" required placeholder="Enter first audit report ID">
                            </div>

                            <div class="form-group">
                                <label for="webAppVaptFollowUpAuditCertificateReportId">Follow-up Report ID*</label>
                                <input type="text" id="webAppVaptFollowUpAuditCertificateReportId" name="reportId" required placeholder="Enter follow-up report ID">
                            </div>

                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('webAppVaptFollowUpAuditCertificateModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Certificate</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Android Application VAPT Follow Up Audit Completion Certificate Modal -->
            <div id="androidAppVaptFollowUpAuditCertificateModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Android Mobile Application VAPT Follow Up Audit Completion Certificate</h3>
                        <span class="close-modal" onclick="closeVaptModal('androidAppVaptFollowUpAuditCertificateModal')">&times;</span>
                    </div>
                    <div class="modal-body">
                        <form id="androidAppVaptFollowUpAuditCertificateForm" action="/process_android_app_vapt_follow_up_audit_certificate" method="POST">
                            <div class="form-group">
                                <label for="androidAppVaptFollowUpAuditCertificateOrganizationName">Organization Name*</label>
                                <div class="combo-input">
                                    <select id="androidAppVaptFollowUpAuditCertificateOrganizationName" name="organizationName" required onchange="toggleVaptOtherInput('androidAppVaptFollowUpAuditCertificateOrganizationName', 'androidAppVaptFollowUpAuditCertificateOtherOrganizationName')">
                                        <option value="">Select Organization</option>
                                        <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                        <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                        <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                        <option value="Megasoft Limited">Megasoft Limited</option>
                                        <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                        <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                        <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                        <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                        <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                        <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                        <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                        <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                        <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                        <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                        <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                        <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                        <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                        <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                        <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                        <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                        <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                        <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                        <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                        <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                        <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                        <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                        <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                        <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                        <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                        <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                        <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                        <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                        <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                        <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                        <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                        <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                        <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                        <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                        <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                        <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                        
                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="androidAppVaptFollowUpAuditCertificateOtherOrganizationName" name="otherOrganizationName" class="hidden" placeholder="Enter Organization Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="androidAppVaptFollowUpAuditCertificateCity">City*</label>
                                <div class="combo-input">
                                    <select id="androidAppVaptFollowUpAuditCertificateCity" name="city" required onchange="toggleVaptOtherInput('androidAppVaptFollowUpAuditCertificateCity', 'androidAppVaptFollowUpAuditCertificateOtherCity')">
                                        <option value="">Select City</option>
                                        <!-- Gujarat -->
                                        <option value="Ahmedabad">Ahmedabad</option>
                                        <option value="Amreli">Amreli</option>
                                        <option value="Anand">Anand</option>
                                        <option value="Aravalli">Aravalli</option>
                                        <option value="Banaskantha">Banaskantha</option>
                                        <option value="Bharuch">Bharuch</option>
                                        <option value="Bhavnagar">Bhavnagar</option>
                                        <option value="Botad">Botad</option>
                                        <option value="Chhota Udaipur">Chhota Udaipur</option>
                                        <option value="Dahod">Dahod</option>
                                        <option value="Dang">Dang</option>
                                        <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                        <option value="Gandhinagar">Gandhinagar</option>
                                        <option value="Gir Somnath">Gir Somnath</option>
                                        <option value="Jamnagar">Jamnagar</option>
                                        <option value="Junagadh">Junagadh</option>
                                        <option value="Kheda">Kheda</option>
                                        <option value="Kutch">Kutch</option>
                                        <option value="Mahisagar">Mahisagar</option>
                                        <option value="Mehsana">Mehsana</option>
                                        <option value="Morbi">Morbi</option>
                                        <option value="Narmada">Narmada</option>
                                        <option value="Navsari">Navsari</option>
                                        <option value="Patan">Patan</option>
                                        <option value="Panchmahal">Panchmahal</option>
                                        <option value="Porbandar">Porbandar</option>
                                        <option value="Rajkot">Rajkot</option>
                                        <option value="Sabarkantha">Sabarkantha</option>
                                        <option value="Surat">Surat</option>
                                        <option value="Surendranagar">Surendranagar</option>
                                        <option value="Tapi">Tapi</option>
                                        <option value="Vadodara">Vadodara</option>
                                        <option value="Valsad">Valsad</option>

                                        <!-- Rajasthan -->
                                        <option value="Ajmer">Ajmer</option>
                                        <option value="Alwar">Alwar</option>
                                        <option value="Banswara">Banswara</option>
                                        <option value="Baran">Baran</option>
                                        <option value="Barmer">Barmer</option>
                                        <option value="Bharatpur">Bharatpur</option>
                                        <option value="Bhilwara">Bhilwara</option>
                                        <option value="Bikaner">Bikaner</option>
                                        <option value="Bundi">Bundi</option>
                                        <option value="Chittorgarh">Chittorgarh</option>
                                        <option value="Churu">Churu</option>
                                        <option value="Dausa">Dausa</option>
                                        <option value="Dholpur">Dholpur</option>
                                        <option value="Dungarpur">Dungarpur</option>
                                        <option value="Hanumangarh">Hanumangarh</option>
                                        <option value="Jaipur">Jaipur</option>
                                        <option value="Jaisalmer">Jaisalmer</option>
                                        <option value="Jalore">Jalore</option>
                                        <option value="Jhalawar">Jhalawar</option>
                                        <option value="Jhunjhunu">Jhunjhunu</option>
                                        <option value="Jodhpur">Jodhpur</option>
                                        <option value="Karauli">Karauli</option>
                                        <option value="Kota">Kota</option>
                                        <option value="Nagaur">Nagaur</option>
                                        <option value="Pali">Pali</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rajsamand">Rajsamand</option>
                                        <option value="Sikar">Sikar</option>
                                        <option value="Sirohi">Sirohi</option>
                                        <option value="Sri Ganganagar">Sri Ganganagar</option>
                                        <option value="Tonk">Tonk</option>
                                        <option value="Udaipur">Udaipur</option>

                                        <!-- Maharashtra -->
                                        <option value="Ahmednagar">Ahmednagar</option>
                                        <option value="Akola">Akola</option>
                                        <option value="Amravati">Amravati</option>
                                        <option value="Aurangabad">Aurangabad</option>
                                        <option value="Beed">Beed</option>
                                        <option value="Bhandara">Bhandara</option>
                                        <option value="Chandrapur">Chandrapur</option>
                                        <option value="Dhule">Dhule</option>
                                        <option value="Gadchiroli">Gadchiroli</option>
                                        <option value="Gondia">Gondia</option>
                                        <option value="Hingoli">Hingoli</option>
                                        <option value="Jalgaon">Jalgaon</option>
                                        <option value="Jalna">Jalna</option>
                                        <option value="Kolhapur">Kolhapur</option>
                                        <option value="Latur">Latur</option>
                                        <option value="Mumbai City">Mumbai City</option>
                                        <option value="Mumbai Suburban">Mumbai Suburban</option>
                                        <option value="Nagpur">Nagpur</option>
                                        <option value="Nanded">Nanded</option>
                                        <option value="Nandurbar">Nandurbar</option>
                                        <option value="Nashik">Nashik</option>
                                        <option value="Osmanabad">Osmanabad</option>
                                        <option value="Palghar">Palghar</option>
                                        <option value="Parbhani">Parbhani</option>
                                        <option value="Pune">Pune</option>
                                        <option value="Raigad">Raigad</option>
                                        <option value="Ratnagiri">Ratnagiri</option>
                                        <option value="Sangli">Sangli</option>
                                        <option value="Satara">Satara</option>
                                        <option value="Sindhudurg">Sindhudurg</option>
                                        <option value="Solapur">Solapur</option>
                                        <option value="Thane">Thane</option>
                                        <option value="Wardha">Wardha</option>
                                        <option value="Washim">Washim</option>
                                        <option value="Yavatmal">Yavatmal</option>

                                        <!-- Uttar Pradesh -->
                                        <option value="Agra">Agra</option>
                                        <option value="Aligarh">Aligarh</option>
                                        <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                        <option value="Amethi">Amethi</option>
                                        <option value="Amroha">Amroha</option>
                                        <option value="Auraiya">Auraiya</option>
                                        <option value="Ayodhya">Ayodhya</option>
                                        <option value="Azamgarh">Azamgarh</option>
                                        <option value="Bagpat">Bagpat</option>
                                        <option value="Bahraich">Bahraich</option>
                                        <option value="Ballia">Ballia</option>
                                        <option value="Balrampur">Balrampur</option>
                                        <option value="Banda">Banda</option>
                                        <option value="Barabanki">Barabanki</option>
                                        <option value="Bareilly">Bareilly</option>
                                        <option value="Basti">Basti</option>
                                        <option value="Bhadohi">Bhadohi</option>
                                        <option value="Bijnor">Bijnor</option>
                                        <option value="Bulandshahr">Bulandshahr</option>
                                        <option value="Chandauli">Chandauli</option>
                                        <option value="Chitrakoot">Chitrakoot</option>
                                        <option value="Deoria">Deoria</option>
                                        <option value="Etah">Etah</option>
                                        <option value="Etawah">Etawah</option>
                                        <option value="Farrukhabad">Farrukhabad</option>
                                        <option value="Fatehpur">Fatehpur</option>
                                        <option value="Firozabad">Firozabad</option>
                                        <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                        <option value="Ghaziabad">Ghaziabad</option>
                                        <option value="Ghazipur">Ghazipur</option>
                                        <option value="Gonda">Gonda</option>
                                        <option value="Gorakhpur">Gorakhpur</option>
                                        <option value="Hamirpur">Hamirpur</option>
                                        <option value="Hapur">Hapur</option>
                                        <option value="Hardoi">Hardoi</option>
                                        <option value="Hathras">Hathras</option>
                                        <option value="Jalaun">Jalaun</option>
                                        <option value="Jaunpur">Jaunpur</option>
                                        <option value="Jhansi">Jhansi</option>
                                        <option value="Kannauj">Kannauj</option>
                                        <option value="Kanpur Dehat">Kanpur Dehat</option>
                                        <option value="Kanpur Nagar">Kanpur Nagar</option>
                                        <option value="Kasganj">Kasganj</option>
                                        <option value="Kaushambi">Kaushambi</option>
                                        <option value="Kushinagar">Kushinagar</option>
                                        <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                        <option value="Lalitpur">Lalitpur</option>
                                        <option value="Lucknow">Lucknow</option>
                                        <option value="Maharajganj">Maharajganj</option>
                                        <option value="Mahoba">Mahoba</option>
                                        <option value="Mainpuri">Mainpuri</option>
                                        <option value="Mathura">Mathura</option>
                                        <option value="Mau">Mau</option>
                                        <option value="Meerut">Meerut</option>
                                        <option value="Mirzapur">Mirzapur</option>
                                        <option value="Moradabad">Moradabad</option>
                                        <option value="Muzaffarnagar">Muzaffarnagar</option>
                                        <option value="Pilibhit">Pilibhit</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rae Bareli">Rae Bareli</option>
                                        <option value="Rampur">Rampur</option>
                                        <option value="Saharanpur">Saharanpur</option>
                                        <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                        <option value="Shahjahanpur">Shahjahanpur</option>
                                        <option value="Shravasti">Shravasti</option>
                                        <option value="Siddharthnagar">Siddharthnagar</option>
                                        <option value="Sitapur">Sitapur</option>
                                        <option value="Sonbhadra">Sonbhadra</option>
                                        <option value="Sultanpur">Sultanpur</option>
                                        <option value="Unnao">Unnao</option>
                                        <option value="Varanasi">Varanasi</option>

                                        <!-- Uttarakhand -->
                                        <option value="Almora">Almora</option>
                                        <option value="Bageshwar">Bageshwar</option>
                                        <option value="Chamoli">Chamoli</option>
                                        <option value="Champawat">Champawat</option>
                                        <option value="Dehradun">Dehradun</option>
                                        <option value="Haridwar">Haridwar</option>
                                        <option value="Nainital">Nainital</option>
                                        <option value="Pauri Garhwal">Pauri Garhwal</option>
                                        <option value="Pithoragarh">Pithoragarh</option>
                                        <option value="Rudraprayag">Rudraprayag</option>
                                        <option value="Tehri Garhwal">Tehri Garhwal</option>
                                        <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                        <option value="Uttarkashi">Uttarkashi</option>

                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="androidAppVaptFollowUpAuditCertificateOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="androidAppVaptFollowUpAuditCertificateState">State*</label>
                                <div class="combo-input">
                                    <select id="androidAppVaptFollowUpAuditCertificateState" name="state" required onchange="toggleVaptOtherInput('androidAppVaptFollowUpAuditCertificateState', 'androidAppVaptFollowUpAuditCertificateOtherState')">
                                        <option value="">Select State</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                        <option value="Assam">Assam</option>
                                        <option value="Bihar">Bihar</option>
                                        <option value="Chhattisgarh">Chhattisgarh</option>
                                        <option value="Goa">Goa</option>
                                        <option value="Gujarat">Gujarat</option>
                                        <option value="Haryana">Haryana</option>
                                        <option value="Himachal Pradesh">Himachal Pradesh</option>
                                        <option value="Jharkhand">Jharkhand</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Kerala">Kerala</option>
                                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Manipur">Manipur</option>
                                        <option value="Meghalaya">Meghalaya</option>
                                        <option value="Mizoram">Mizoram</option>
                                        <option value="Nagaland">Nagaland</option>
                                        <option value="Odisha">Odisha</option>
                                        <option value="Punjab">Punjab</option>
                                        <option value="Rajasthan">Rajasthan</option>
                                        <option value="Sikkim">Sikkim</option>
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="Telangana">Telangana</option>
                                        <option value="Tripura">Tripura</option>
                                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                                        <option value="Uttarakhand">Uttarakhand</option>
                                        <option value="West Bengal">West Bengal</option>

                                        <!-- Union Territories -->
                                        <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                        <option value="Chandigarh">Chandigarh</option>
                                        <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                        <option value="Delhi">Delhi</option>
                                        <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                        <option value="Ladakh">Ladakh</option>
                                        <option value="Lakshadweep">Lakshadweep</option>
                                        <option value="Puducherry">Puducherry</option>

                                    </select>
                                    <input type="text" id="androidAppVaptFollowUpAuditCertificateOtherState" name="otherState" class="hidden" placeholder="Enter State Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="androidAppVaptFollowUpAuditCertificateAuditeeDesignation">Designation of the Auditee Person (Submitted To)*</label>
                                <input type="text" id="androidAppVaptFollowUpAuditCertificateAuditeeDesignation" name="auditeeDesignation" required placeholder="Enter auditee designation">
                            </div>

                            <div class="form-group">
                                <label for="androidAppVaptFollowUpAuditCertificateScope">Scope*</label>
                                <input type="text" id="androidAppVaptFollowUpAuditCertificateScope" name="scope" required placeholder="Enter scope details">
                            </div>

                            <div class="form-group">
                                <label for="androidAppVaptFollowUpAuditCertificateStartAuditDate">Start Audit Date*</label>
                                <input type="date" id="androidAppVaptFollowUpAuditCertificateStartAuditDate" name="startAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="androidAppVaptFollowUpAuditCertificateEndAuditDate">End Audit Date*</label>
                                <input type="date" id="androidAppVaptFollowUpAuditCertificateEndAuditDate" name="endAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="androidAppVaptFollowUpAuditCertificateFirstReportId">First Audit Report ID*</label>
                                <input type="text" id="androidAppVaptFollowUpAuditCertificateFirstReportId" name="firstReportId" required placeholder="Enter first audit report ID">
                            </div>

                            <div class="form-group">
                                <label for="androidAppVaptFollowUpAuditCertificateReportId">Follow-up Report ID*</label>
                                <input type="text" id="androidAppVaptFollowUpAuditCertificateReportId" name="reportId" required placeholder="Enter follow-up report ID">
                            </div>

                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('androidAppVaptFollowUpAuditCertificateModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Certificate</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- IOS Application VAPT Follow Up Audit Completion Certificate Modal -->
            <div id="iosAppVaptFollowUpAuditCertificateModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>IOS Mobile Application VAPT Follow Up Audit Completion Certificate</h3>
                        <span class="close-modal" onclick="closeVaptModal('iosAppVaptFollowUpAuditCertificateModal')">&times;</span>
                    </div>
                    <div class="modal-body">
                        <form id="iosAppVaptFollowUpAuditCertificateForm" action="/process_ios_app_vapt_follow_up_audit_certificate" method="POST">
                            <div class="form-group">
                                <label for="iosAppVaptFollowUpAuditCertificateOrganizationName">Organization Name*</label>
                                <div class="combo-input">
                                    <select id="iosAppVaptFollowUpAuditCertificateOrganizationName" name="organizationName" required onchange="toggleVaptOtherInput('iosAppVaptFollowUpAuditCertificateOrganizationName', 'iosAppVaptFollowUpAuditCertificateOtherOrganizationName')">
                                        <option value="">Select Organization</option>
                                        <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                        <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                        <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                        <option value="Megasoft Limited">Megasoft Limited</option>
                                        <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                        <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                        <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                        <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                        <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                        <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                        <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                        <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                        <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                        <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                        <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                        <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                        <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                        <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                        <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                        <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                        <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                        <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                        <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                        <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                        <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                        <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                        <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                        <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                        <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                        <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                        <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                        <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                        <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                        <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                        <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                        <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                        <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                        <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                        <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                        <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                        
                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="iosAppVaptFollowUpAuditCertificateOtherOrganizationName" name="otherOrganizationName" class="hidden" placeholder="Enter Organization Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="iosAppVaptFollowUpAuditCertificateCity">City*</label>
                                <div class="combo-input">
                                    <select id="iosAppVaptFollowUpAuditCertificateCity" name="city" required onchange="toggleVaptOtherInput('iosAppVaptFollowUpAuditCertificateCity', 'iosAppVaptFollowUpAuditCertificateOtherCity')">
                                        <option value="">Select City</option>
                                        <!-- Gujarat -->
                                        <option value="Ahmedabad">Ahmedabad</option>
                                        <option value="Amreli">Amreli</option>
                                        <option value="Anand">Anand</option>
                                        <option value="Aravalli">Aravalli</option>
                                        <option value="Banaskantha">Banaskantha</option>
                                        <option value="Bharuch">Bharuch</option>
                                        <option value="Bhavnagar">Bhavnagar</option>
                                        <option value="Botad">Botad</option>
                                        <option value="Chhota Udaipur">Chhota Udaipur</option>
                                        <option value="Dahod">Dahod</option>
                                        <option value="Dang">Dang</option>
                                        <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                        <option value="Gandhinagar">Gandhinagar</option>
                                        <option value="Gir Somnath">Gir Somnath</option>
                                        <option value="Jamnagar">Jamnagar</option>
                                        <option value="Junagadh">Junagadh</option>
                                        <option value="Kheda">Kheda</option>
                                        <option value="Kutch">Kutch</option>
                                        <option value="Mahisagar">Mahisagar</option>
                                        <option value="Mehsana">Mehsana</option>
                                        <option value="Morbi">Morbi</option>
                                        <option value="Narmada">Narmada</option>
                                        <option value="Navsari">Navsari</option>
                                        <option value="Patan">Patan</option>
                                        <option value="Panchmahal">Panchmahal</option>
                                        <option value="Porbandar">Porbandar</option>
                                        <option value="Rajkot">Rajkot</option>
                                        <option value="Sabarkantha">Sabarkantha</option>
                                        <option value="Surat">Surat</option>
                                        <option value="Surendranagar">Surendranagar</option>
                                        <option value="Tapi">Tapi</option>
                                        <option value="Vadodara">Vadodara</option>
                                        <option value="Valsad">Valsad</option>

                                        <!-- Rajasthan -->
                                        <option value="Ajmer">Ajmer</option>
                                        <option value="Alwar">Alwar</option>
                                        <option value="Banswara">Banswara</option>
                                        <option value="Baran">Baran</option>
                                        <option value="Barmer">Barmer</option>
                                        <option value="Bharatpur">Bharatpur</option>
                                        <option value="Bhilwara">Bhilwara</option>
                                        <option value="Bikaner">Bikaner</option>
                                        <option value="Bundi">Bundi</option>
                                        <option value="Chittorgarh">Chittorgarh</option>
                                        <option value="Churu">Churu</option>
                                        <option value="Dausa">Dausa</option>
                                        <option value="Dholpur">Dholpur</option>
                                        <option value="Dungarpur">Dungarpur</option>
                                        <option value="Hanumangarh">Hanumangarh</option>
                                        <option value="Jaipur">Jaipur</option>
                                        <option value="Jaisalmer">Jaisalmer</option>
                                        <option value="Jalore">Jalore</option>
                                        <option value="Jhalawar">Jhalawar</option>
                                        <option value="Jhunjhunu">Jhunjhunu</option>
                                        <option value="Jodhpur">Jodhpur</option>
                                        <option value="Karauli">Karauli</option>
                                        <option value="Kota">Kota</option>
                                        <option value="Nagaur">Nagaur</option>
                                        <option value="Pali">Pali</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rajsamand">Rajsamand</option>
                                        <option value="Sikar">Sikar</option>
                                        <option value="Sirohi">Sirohi</option>
                                        <option value="Sri Ganganagar">Sri Ganganagar</option>
                                        <option value="Tonk">Tonk</option>
                                        <option value="Udaipur">Udaipur</option>

                                        <!-- Maharashtra -->
                                        <option value="Ahmednagar">Ahmednagar</option>
                                        <option value="Akola">Akola</option>
                                        <option value="Amravati">Amravati</option>
                                        <option value="Aurangabad">Aurangabad</option>
                                        <option value="Beed">Beed</option>
                                        <option value="Bhandara">Bhandara</option>
                                        <option value="Chandrapur">Chandrapur</option>
                                        <option value="Dhule">Dhule</option>
                                        <option value="Gadchiroli">Gadchiroli</option>
                                        <option value="Gondia">Gondia</option>
                                        <option value="Hingoli">Hingoli</option>
                                        <option value="Jalgaon">Jalgaon</option>
                                        <option value="Jalna">Jalna</option>
                                        <option value="Kolhapur">Kolhapur</option>
                                        <option value="Latur">Latur</option>
                                        <option value="Mumbai City">Mumbai City</option>
                                        <option value="Mumbai Suburban">Mumbai Suburban</option>
                                        <option value="Nagpur">Nagpur</option>
                                        <option value="Nanded">Nanded</option>
                                        <option value="Nandurbar">Nandurbar</option>
                                        <option value="Nashik">Nashik</option>
                                        <option value="Osmanabad">Osmanabad</option>
                                        <option value="Palghar">Palghar</option>
                                        <option value="Parbhani">Parbhani</option>
                                        <option value="Pune">Pune</option>
                                        <option value="Raigad">Raigad</option>
                                        <option value="Ratnagiri">Ratnagiri</option>
                                        <option value="Sangli">Sangli</option>
                                        <option value="Satara">Satara</option>
                                        <option value="Sindhudurg">Sindhudurg</option>
                                        <option value="Solapur">Solapur</option>
                                        <option value="Thane">Thane</option>
                                        <option value="Wardha">Wardha</option>
                                        <option value="Washim">Washim</option>
                                        <option value="Yavatmal">Yavatmal</option>

                                        <!-- Uttar Pradesh -->
                                        <option value="Agra">Agra</option>
                                        <option value="Aligarh">Aligarh</option>
                                        <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                        <option value="Amethi">Amethi</option>
                                        <option value="Amroha">Amroha</option>
                                        <option value="Auraiya">Auraiya</option>
                                        <option value="Ayodhya">Ayodhya</option>
                                        <option value="Azamgarh">Azamgarh</option>
                                        <option value="Bagpat">Bagpat</option>
                                        <option value="Bahraich">Bahraich</option>
                                        <option value="Ballia">Ballia</option>
                                        <option value="Balrampur">Balrampur</option>
                                        <option value="Banda">Banda</option>
                                        <option value="Barabanki">Barabanki</option>
                                        <option value="Bareilly">Bareilly</option>
                                        <option value="Basti">Basti</option>
                                        <option value="Bhadohi">Bhadohi</option>
                                        <option value="Bijnor">Bijnor</option>
                                        <option value="Bulandshahr">Bulandshahr</option>
                                        <option value="Chandauli">Chandauli</option>
                                        <option value="Chitrakoot">Chitrakoot</option>
                                        <option value="Deoria">Deoria</option>
                                        <option value="Etah">Etah</option>
                                        <option value="Etawah">Etawah</option>
                                        <option value="Farrukhabad">Farrukhabad</option>
                                        <option value="Fatehpur">Fatehpur</option>
                                        <option value="Firozabad">Firozabad</option>
                                        <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                        <option value="Ghaziabad">Ghaziabad</option>
                                        <option value="Ghazipur">Ghazipur</option>
                                        <option value="Gonda">Gonda</option>
                                        <option value="Gorakhpur">Gorakhpur</option>
                                        <option value="Hamirpur">Hamirpur</option>
                                        <option value="Hapur">Hapur</option>
                                        <option value="Hardoi">Hardoi</option>
                                        <option value="Hathras">Hathras</option>
                                        <option value="Jalaun">Jalaun</option>
                                        <option value="Jaunpur">Jaunpur</option>
                                        <option value="Jhansi">Jhansi</option>
                                        <option value="Kannauj">Kannauj</option>
                                        <option value="Kanpur Dehat">Kanpur Dehat</option>
                                        <option value="Kanpur Nagar">Kanpur Nagar</option>
                                        <option value="Kasganj">Kasganj</option>
                                        <option value="Kaushambi">Kaushambi</option>
                                        <option value="Kushinagar">Kushinagar</option>
                                        <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                        <option value="Lalitpur">Lalitpur</option>
                                        <option value="Lucknow">Lucknow</option>
                                        <option value="Maharajganj">Maharajganj</option>
                                        <option value="Mahoba">Mahoba</option>
                                        <option value="Mainpuri">Mainpuri</option>
                                        <option value="Mathura">Mathura</option>
                                        <option value="Mau">Mau</option>
                                        <option value="Meerut">Meerut</option>
                                        <option value="Mirzapur">Mirzapur</option>
                                        <option value="Moradabad">Moradabad</option>
                                        <option value="Muzaffarnagar">Muzaffarnagar</option>
                                        <option value="Pilibhit">Pilibhit</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rae Bareli">Rae Bareli</option>
                                        <option value="Rampur">Rampur</option>
                                        <option value="Saharanpur">Saharanpur</option>
                                        <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                        <option value="Shahjahanpur">Shahjahanpur</option>
                                        <option value="Shravasti">Shravasti</option>
                                        <option value="Siddharthnagar">Siddharthnagar</option>
                                        <option value="Sitapur">Sitapur</option>
                                        <option value="Sonbhadra">Sonbhadra</option>
                                        <option value="Sultanpur">Sultanpur</option>
                                        <option value="Unnao">Unnao</option>
                                        <option value="Varanasi">Varanasi</option>

                                        <!-- Uttarakhand -->
                                        <option value="Almora">Almora</option>
                                        <option value="Bageshwar">Bageshwar</option>
                                        <option value="Chamoli">Chamoli</option>
                                        <option value="Champawat">Champawat</option>
                                        <option value="Dehradun">Dehradun</option>
                                        <option value="Haridwar">Haridwar</option>
                                        <option value="Nainital">Nainital</option>
                                        <option value="Pauri Garhwal">Pauri Garhwal</option>
                                        <option value="Pithoragarh">Pithoragarh</option>
                                        <option value="Rudraprayag">Rudraprayag</option>
                                        <option value="Tehri Garhwal">Tehri Garhwal</option>
                                        <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                        <option value="Uttarkashi">Uttarkashi</option>

                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="iosAppVaptFollowUpAuditCertificateOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="iosAppVaptFollowUpAuditCertificateState">State*</label>
                                <div class="combo-input">
                                    <select id="iosAppVaptFollowUpAuditCertificateState" name="state" required onchange="toggleVaptOtherInput('iosAppVaptFollowUpAuditCertificateState', 'iosAppVaptFollowUpAuditCertificateOtherState')">
                                        <option value="">Select State</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                        <option value="Assam">Assam</option>
                                        <option value="Bihar">Bihar</option>
                                        <option value="Chhattisgarh">Chhattisgarh</option>
                                        <option value="Goa">Goa</option>
                                        <option value="Gujarat">Gujarat</option>
                                        <option value="Haryana">Haryana</option>
                                        <option value="Himachal Pradesh">Himachal Pradesh</option>
                                        <option value="Jharkhand">Jharkhand</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Kerala">Kerala</option>
                                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Manipur">Manipur</option>
                                        <option value="Meghalaya">Meghalaya</option>
                                        <option value="Mizoram">Mizoram</option>
                                        <option value="Nagaland">Nagaland</option>
                                        <option value="Odisha">Odisha</option>
                                        <option value="Punjab">Punjab</option>
                                        <option value="Rajasthan">Rajasthan</option>
                                        <option value="Sikkim">Sikkim</option>
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="Telangana">Telangana</option>
                                        <option value="Tripura">Tripura</option>
                                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                                        <option value="Uttarakhand">Uttarakhand</option>
                                        <option value="West Bengal">West Bengal</option>

                                        <!-- Union Territories -->
                                        <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                        <option value="Chandigarh">Chandigarh</option>
                                        <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                        <option value="Delhi">Delhi</option>
                                        <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                        <option value="Ladakh">Ladakh</option>
                                        <option value="Lakshadweep">Lakshadweep</option>
                                        <option value="Puducherry">Puducherry</option>

                                    </select>
                                    <input type="text" id="iosAppVaptFollowUpAuditCertificateOtherState" name="otherState" class="hidden" placeholder="Enter State Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="iosAppVaptFollowUpAuditCertificateAuditeeDesignation">Designation of the Auditee Person (Submitted To)*</label>
                                <input type="text" id="iosAppVaptFollowUpAuditCertificateAuditeeDesignation" name="auditeeDesignation" required placeholder="Enter auditee designation">
                            </div>

                            <div class="form-group">
                                <label for="iosAppVaptFollowUpAuditCertificateScope">Scope*</label>
                                <input type="text" id="iosAppVaptFollowUpAuditCertificateScope" name="scope" required placeholder="Enter scope details">
                            </div>

                            <div class="form-group">
                                <label for="iosAppVaptFollowUpAuditCertificateStartAuditDate">Start Audit Date*</label>
                                <input type="date" id="iosAppVaptFollowUpAuditCertificateStartAuditDate" name="startAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="iosAppVaptFollowUpAuditCertificateEndAuditDate">End Audit Date*</label>
                                <input type="date" id="iosAppVaptFollowUpAuditCertificateEndAuditDate" name="endAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="iosAppVaptFollowUpAuditCertificateFirstReportId">First Audit Report ID*</label>
                                <input type="text" id="iosAppVaptFollowUpAuditCertificateFirstReportId" name="firstReportId" required placeholder="Enter first audit report ID">
                            </div>

                            <div class="form-group">
                                <label for="iosAppVaptFollowUpAuditCertificateReportId">Follow-up Report ID*</label>
                                <input type="text" id="iosAppVaptFollowUpAuditCertificateReportId" name="reportId" required placeholder="Enter follow-up report ID">
                            </div>

                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('iosAppVaptFollowUpAuditCertificateModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Certificate</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Website VAPT Follow Up Audit Completion Certificate Modal -->
            <div id="websiteVaptFollowUpAuditCertificateModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Website VAPT Follow Up Audit Completion Certificate</h3>
                        <span class="close-modal" onclick="closeVaptModal('websiteVaptFollowUpAuditCertificateModal')">&times;</span>
                    </div>
                    <div class="modal-body">
                        <form id="websiteVaptFollowUpAuditCertificateForm" action="/process_website_vapt_follow_up_audit_certificate" method="POST">
                            <div class="form-group">
                                <label for="websiteVaptFollowUpAuditCertificateOrganizationName">Organization Name*</label>
                                <div class="combo-input">
                                    <select id="websiteVaptFollowUpAuditCertificateOrganizationName" name="organizationName" required onchange="toggleVaptOtherInput('websiteVaptFollowUpAuditCertificateOrganizationName', 'websiteVaptFollowUpAuditCertificateOtherOrganizationName')">
                                        <option value="">Select Organization</option>
                                        <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                        <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                        <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                        <option value="Megasoft Limited">Megasoft Limited</option>
                                        <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                        <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                        <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                        <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                        <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                        <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                        <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                        <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                        <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                        <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                        <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                        <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                        <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                        <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                        <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                        <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                        <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                        <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                        <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                        <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                        <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                        <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                        <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                        <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                        <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                        <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                        <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                        <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                        <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                        <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                        <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                        <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                        <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                        <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                        <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                        <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                        
                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="websiteVaptFollowUpAuditCertificateOtherOrganizationName" name="otherOrganizationName" class="hidden" placeholder="Enter Organization Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpAuditCertificateCity">City*</label>
                                <div class="combo-input">
                                    <select id="websiteVaptFollowUpAuditCertificateCity" name="city" required onchange="toggleVaptOtherInput('websiteVaptFollowUpAuditCertificateCity', 'websiteVaptFollowUpAuditCertificateOtherCity')">
                                        <option value="">Select City</option>
                                        <!-- Gujarat -->
                                        <option value="Ahmedabad">Ahmedabad</option>
                                        <option value="Amreli">Amreli</option>
                                        <option value="Anand">Anand</option>
                                        <option value="Aravalli">Aravalli</option>
                                        <option value="Banaskantha">Banaskantha</option>
                                        <option value="Bharuch">Bharuch</option>
                                        <option value="Bhavnagar">Bhavnagar</option>
                                        <option value="Botad">Botad</option>
                                        <option value="Chhota Udaipur">Chhota Udaipur</option>
                                        <option value="Dahod">Dahod</option>
                                        <option value="Dang">Dang</option>
                                        <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                        <option value="Gandhinagar">Gandhinagar</option>
                                        <option value="Gir Somnath">Gir Somnath</option>
                                        <option value="Jamnagar">Jamnagar</option>
                                        <option value="Junagadh">Junagadh</option>
                                        <option value="Kheda">Kheda</option>
                                        <option value="Kutch">Kutch</option>
                                        <option value="Mahisagar">Mahisagar</option>
                                        <option value="Mehsana">Mehsana</option>
                                        <option value="Morbi">Morbi</option>
                                        <option value="Narmada">Narmada</option>
                                        <option value="Navsari">Navsari</option>
                                        <option value="Patan">Patan</option>
                                        <option value="Panchmahal">Panchmahal</option>
                                        <option value="Porbandar">Porbandar</option>
                                        <option value="Rajkot">Rajkot</option>
                                        <option value="Sabarkantha">Sabarkantha</option>
                                        <option value="Surat">Surat</option>
                                        <option value="Surendranagar">Surendranagar</option>
                                        <option value="Tapi">Tapi</option>
                                        <option value="Vadodara">Vadodara</option>
                                        <option value="Valsad">Valsad</option>

                                        <!-- Rajasthan -->
                                        <option value="Ajmer">Ajmer</option>
                                        <option value="Alwar">Alwar</option>
                                        <option value="Banswara">Banswara</option>
                                        <option value="Baran">Baran</option>
                                        <option value="Barmer">Barmer</option>
                                        <option value="Bharatpur">Bharatpur</option>
                                        <option value="Bhilwara">Bhilwara</option>
                                        <option value="Bikaner">Bikaner</option>
                                        <option value="Bundi">Bundi</option>
                                        <option value="Chittorgarh">Chittorgarh</option>
                                        <option value="Churu">Churu</option>
                                        <option value="Dausa">Dausa</option>
                                        <option value="Dholpur">Dholpur</option>
                                        <option value="Dungarpur">Dungarpur</option>
                                        <option value="Hanumangarh">Hanumangarh</option>
                                        <option value="Jaipur">Jaipur</option>
                                        <option value="Jaisalmer">Jaisalmer</option>
                                        <option value="Jalore">Jalore</option>
                                        <option value="Jhalawar">Jhalawar</option>
                                        <option value="Jhunjhunu">Jhunjhunu</option>
                                        <option value="Jodhpur">Jodhpur</option>
                                        <option value="Karauli">Karauli</option>
                                        <option value="Kota">Kota</option>
                                        <option value="Nagaur">Nagaur</option>
                                        <option value="Pali">Pali</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rajsamand">Rajsamand</option>
                                        <option value="Sikar">Sikar</option>
                                        <option value="Sirohi">Sirohi</option>
                                        <option value="Sri Ganganagar">Sri Ganganagar</option>
                                        <option value="Tonk">Tonk</option>
                                        <option value="Udaipur">Udaipur</option>

                                        <!-- Maharashtra -->
                                        <option value="Ahmednagar">Ahmednagar</option>
                                        <option value="Akola">Akola</option>
                                        <option value="Amravati">Amravati</option>
                                        <option value="Aurangabad">Aurangabad</option>
                                        <option value="Beed">Beed</option>
                                        <option value="Bhandara">Bhandara</option>
                                        <option value="Chandrapur">Chandrapur</option>
                                        <option value="Dhule">Dhule</option>
                                        <option value="Gadchiroli">Gadchiroli</option>
                                        <option value="Gondia">Gondia</option>
                                        <option value="Hingoli">Hingoli</option>
                                        <option value="Jalgaon">Jalgaon</option>
                                        <option value="Jalna">Jalna</option>
                                        <option value="Kolhapur">Kolhapur</option>
                                        <option value="Latur">Latur</option>
                                        <option value="Mumbai City">Mumbai City</option>
                                        <option value="Mumbai Suburban">Mumbai Suburban</option>
                                        <option value="Nagpur">Nagpur</option>
                                        <option value="Nanded">Nanded</option>
                                        <option value="Nandurbar">Nandurbar</option>
                                        <option value="Nashik">Nashik</option>
                                        <option value="Osmanabad">Osmanabad</option>
                                        <option value="Palghar">Palghar</option>
                                        <option value="Parbhani">Parbhani</option>
                                        <option value="Pune">Pune</option>
                                        <option value="Raigad">Raigad</option>
                                        <option value="Ratnagiri">Ratnagiri</option>
                                        <option value="Sangli">Sangli</option>
                                        <option value="Satara">Satara</option>
                                        <option value="Sindhudurg">Sindhudurg</option>
                                        <option value="Solapur">Solapur</option>
                                        <option value="Thane">Thane</option>
                                        <option value="Wardha">Wardha</option>
                                        <option value="Washim">Washim</option>
                                        <option value="Yavatmal">Yavatmal</option>

                                        <!-- Uttar Pradesh -->
                                        <option value="Agra">Agra</option>
                                        <option value="Aligarh">Aligarh</option>
                                        <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                        <option value="Amethi">Amethi</option>
                                        <option value="Amroha">Amroha</option>
                                        <option value="Auraiya">Auraiya</option>
                                        <option value="Ayodhya">Ayodhya</option>
                                        <option value="Azamgarh">Azamgarh</option>
                                        <option value="Bagpat">Bagpat</option>
                                        <option value="Bahraich">Bahraich</option>
                                        <option value="Ballia">Ballia</option>
                                        <option value="Balrampur">Balrampur</option>
                                        <option value="Banda">Banda</option>
                                        <option value="Barabanki">Barabanki</option>
                                        <option value="Bareilly">Bareilly</option>
                                        <option value="Basti">Basti</option>
                                        <option value="Bhadohi">Bhadohi</option>
                                        <option value="Bijnor">Bijnor</option>
                                        <option value="Bulandshahr">Bulandshahr</option>
                                        <option value="Chandauli">Chandauli</option>
                                        <option value="Chitrakoot">Chitrakoot</option>
                                        <option value="Deoria">Deoria</option>
                                        <option value="Etah">Etah</option>
                                        <option value="Etawah">Etawah</option>
                                        <option value="Farrukhabad">Farrukhabad</option>
                                        <option value="Fatehpur">Fatehpur</option>
                                        <option value="Firozabad">Firozabad</option>
                                        <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                        <option value="Ghaziabad">Ghaziabad</option>
                                        <option value="Ghazipur">Ghazipur</option>
                                        <option value="Gonda">Gonda</option>
                                        <option value="Gorakhpur">Gorakhpur</option>
                                        <option value="Hamirpur">Hamirpur</option>
                                        <option value="Hapur">Hapur</option>
                                        <option value="Hardoi">Hardoi</option>
                                        <option value="Hathras">Hathras</option>
                                        <option value="Jalaun">Jalaun</option>
                                        <option value="Jaunpur">Jaunpur</option>
                                        <option value="Jhansi">Jhansi</option>
                                        <option value="Kannauj">Kannauj</option>
                                        <option value="Kanpur Dehat">Kanpur Dehat</option>
                                        <option value="Kanpur Nagar">Kanpur Nagar</option>
                                        <option value="Kasganj">Kasganj</option>
                                        <option value="Kaushambi">Kaushambi</option>
                                        <option value="Kushinagar">Kushinagar</option>
                                        <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                        <option value="Lalitpur">Lalitpur</option>
                                        <option value="Lucknow">Lucknow</option>
                                        <option value="Maharajganj">Maharajganj</option>
                                        <option value="Mahoba">Mahoba</option>
                                        <option value="Mainpuri">Mainpuri</option>
                                        <option value="Mathura">Mathura</option>
                                        <option value="Mau">Mau</option>
                                        <option value="Meerut">Meerut</option>
                                        <option value="Mirzapur">Mirzapur</option>
                                        <option value="Moradabad">Moradabad</option>
                                        <option value="Muzaffarnagar">Muzaffarnagar</option>
                                        <option value="Pilibhit">Pilibhit</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rae Bareli">Rae Bareli</option>
                                        <option value="Rampur">Rampur</option>
                                        <option value="Saharanpur">Saharanpur</option>
                                        <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                        <option value="Shahjahanpur">Shahjahanpur</option>
                                        <option value="Shravasti">Shravasti</option>
                                        <option value="Siddharthnagar">Siddharthnagar</option>
                                        <option value="Sitapur">Sitapur</option>
                                        <option value="Sonbhadra">Sonbhadra</option>
                                        <option value="Sultanpur">Sultanpur</option>
                                        <option value="Unnao">Unnao</option>
                                        <option value="Varanasi">Varanasi</option>

                                        <!-- Uttarakhand -->
                                        <option value="Almora">Almora</option>
                                        <option value="Bageshwar">Bageshwar</option>
                                        <option value="Chamoli">Chamoli</option>
                                        <option value="Champawat">Champawat</option>
                                        <option value="Dehradun">Dehradun</option>
                                        <option value="Haridwar">Haridwar</option>
                                        <option value="Nainital">Nainital</option>
                                        <option value="Pauri Garhwal">Pauri Garhwal</option>
                                        <option value="Pithoragarh">Pithoragarh</option>
                                        <option value="Rudraprayag">Rudraprayag</option>
                                        <option value="Tehri Garhwal">Tehri Garhwal</option>
                                        <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                        <option value="Uttarkashi">Uttarkashi</option>

                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="websiteVaptFollowUpAuditCertificateOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpAuditCertificateState">State*</label>
                                <div class="combo-input">
                                    <select id="websiteVaptFollowUpAuditCertificateState" name="state" required onchange="toggleVaptOtherInput('websiteVaptFollowUpAuditCertificateState', 'websiteVaptFollowUpAuditCertificateOtherState')">
                                        <option value="">Select State</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                        <option value="Assam">Assam</option>
                                        <option value="Bihar">Bihar</option>
                                        <option value="Chhattisgarh">Chhattisgarh</option>
                                        <option value="Goa">Goa</option>
                                        <option value="Gujarat">Gujarat</option>
                                        <option value="Haryana">Haryana</option>
                                        <option value="Himachal Pradesh">Himachal Pradesh</option>
                                        <option value="Jharkhand">Jharkhand</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Kerala">Kerala</option>
                                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Manipur">Manipur</option>
                                        <option value="Meghalaya">Meghalaya</option>
                                        <option value="Mizoram">Mizoram</option>
                                        <option value="Nagaland">Nagaland</option>
                                        <option value="Odisha">Odisha</option>
                                        <option value="Punjab">Punjab</option>
                                        <option value="Rajasthan">Rajasthan</option>
                                        <option value="Sikkim">Sikkim</option>
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="Telangana">Telangana</option>
                                        <option value="Tripura">Tripura</option>
                                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                                        <option value="Uttarakhand">Uttarakhand</option>
                                        <option value="West Bengal">West Bengal</option>

                                        <!-- Union Territories -->
                                        <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                        <option value="Chandigarh">Chandigarh</option>
                                        <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                        <option value="Delhi">Delhi</option>
                                        <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                        <option value="Ladakh">Ladakh</option>
                                        <option value="Lakshadweep">Lakshadweep</option>
                                        <option value="Puducherry">Puducherry</option>

                                    </select>
                                    <input type="text" id="websiteVaptFollowUpAuditCertificateOtherState" name="otherState" class="hidden" placeholder="Enter State Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpAuditCertificateAuditeeDesignation">Designation of the Auditee Person (Submitted To)*</label>
                                <input type="text" id="websiteVaptFollowUpAuditCertificateAuditeeDesignation" name="auditeeDesignation" required placeholder="Enter auditee designation">
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpAuditCertificateScope">Scope*</label>
                                <input type="text" id="websiteVaptFollowUpAuditCertificateScope" name="scope" required placeholder="Enter scope details">
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpAuditCertificateStartAuditDate">Start Audit Date*</label>
                                <input type="date" id="websiteVaptFollowUpAuditCertificateStartAuditDate" name="startAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpAuditCertificateEndAuditDate">End Audit Date*</label>
                                <input type="date" id="websiteVaptFollowUpAuditCertificateEndAuditDate" name="endAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpAuditCertificateFirstReportId">First Audit Report ID*</label>
                                <input type="text" id="websiteVaptFollowUpAuditCertificateFirstReportId" name="firstReportId" required placeholder="Enter first audit report ID">
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpAuditCertificateReportId">Follow-up Report ID*</label>
                                <input type="text" id="websiteVaptFollowUpAuditCertificateReportId" name="reportId" required placeholder="Enter follow-up report ID">
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpAuditCertificateReleaseDate">Certificate Release Date*</label>
                                <input type="date" id="websiteVaptFollowUpAuditCertificateReleaseDate" name="certificateReleaseDate" required>
                            </div>

                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('websiteVaptFollowUpAuditCertificateModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Certificate</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>


            <!-- Public IP VAPT First Audit Completion Certificate Modal -->
            <div id="publicIpFirstAuditCertificateModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Public IP VAPT First Audit Completion Certificate</h3>
                        <span class="close-modal" onclick="closeVaptModal('publicIpFirstAuditCertificateModal')">&times;</span>
                    </div>
                    <div class="modal-body">
                        <form id="publicIpFirstAuditCertificateForm" action="/process_public_ip_vapt_first_audit_certificate" method="POST">
                            <div class="form-group">
                                <label for="publicIpFirstAuditCertificateOrganizationName">Organization Name*</label>
                                <div class="combo-input">
                                    <select id="publicIpFirstAuditCertificateOrganizationName" name="organizationName" required onchange="toggleVaptOtherInput('publicIpFirstAuditCertificateOrganizationName', 'publicIpFirstAuditCertificateOtherOrganizationName')">
                                        <option value="">Select Organization</option>
                                        <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                        <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                        <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                        <option value="Megasoft Limited">Megasoft Limited</option>
                                        <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                        <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                        <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                        <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                        <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                        <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                        <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                        <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                        <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                        <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                        <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                        <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                        <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                        <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                        <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                        <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                        <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                        <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                        <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                        <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                        <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                        <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                        <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                        <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                        <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                        <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                        <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                        <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                        <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                        <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                        <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                        <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                        <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                        <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                        <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                        <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                        
                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="publicIpFirstAuditCertificateOtherOrganizationName" name="otherOrganizationName" class="hidden" placeholder="Enter Organization Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="publicIpFirstAuditCertificateCity">City*</label>
                                <div class="combo-input">
                                    <select id="publicIpFirstAuditCertificateCity" name="city" required onchange="toggleVaptOtherInput('publicIpFirstAuditCertificateCity', 'publicIpFirstAuditCertificateOtherCity')">
                                        <option value="">Select City</option>
                                        <!-- Gujarat -->
                                        <option value="Ahmedabad">Ahmedabad</option>
                                        <option value="Amreli">Amreli</option>
                                        <option value="Anand">Anand</option>
                                        <option value="Aravalli">Aravalli</option>
                                        <option value="Banaskantha">Banaskantha</option>
                                        <option value="Bharuch">Bharuch</option>
                                        <option value="Bhavnagar">Bhavnagar</option>
                                        <option value="Botad">Botad</option>
                                        <option value="Chhota Udaipur">Chhota Udaipur</option>
                                        <option value="Dahod">Dahod</option>
                                        <option value="Dang">Dang</option>
                                        <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                        <option value="Gandhinagar">Gandhinagar</option>
                                        <option value="Gir Somnath">Gir Somnath</option>
                                        <option value="Jamnagar">Jamnagar</option>
                                        <option value="Junagadh">Junagadh</option>
                                        <option value="Kheda">Kheda</option>
                                        <option value="Kutch">Kutch</option>
                                        <option value="Mahisagar">Mahisagar</option>
                                        <option value="Mehsana">Mehsana</option>
                                        <option value="Morbi">Morbi</option>
                                        <option value="Narmada">Narmada</option>
                                        <option value="Navsari">Navsari</option>
                                        <option value="Patan">Patan</option>
                                        <option value="Panchmahal">Panchmahal</option>
                                        <option value="Porbandar">Porbandar</option>
                                        <option value="Rajkot">Rajkot</option>
                                        <option value="Sabarkantha">Sabarkantha</option>
                                        <option value="Surat">Surat</option>
                                        <option value="Surendranagar">Surendranagar</option>
                                        <option value="Tapi">Tapi</option>
                                        <option value="Vadodara">Vadodara</option>
                                        <option value="Valsad">Valsad</option>

                                        <!-- Rajasthan -->
                                        <option value="Ajmer">Ajmer</option>
                                        <option value="Alwar">Alwar</option>
                                        <option value="Banswara">Banswara</option>
                                        <option value="Baran">Baran</option>
                                        <option value="Barmer">Barmer</option>
                                        <option value="Bharatpur">Bharatpur</option>
                                        <option value="Bhilwara">Bhilwara</option>
                                        <option value="Bikaner">Bikaner</option>
                                        <option value="Bundi">Bundi</option>
                                        <option value="Chittorgarh">Chittorgarh</option>
                                        <option value="Churu">Churu</option>
                                        <option value="Dausa">Dausa</option>
                                        <option value="Dholpur">Dholpur</option>
                                        <option value="Dungarpur">Dungarpur</option>
                                        <option value="Hanumangarh">Hanumangarh</option>
                                        <option value="Jaipur">Jaipur</option>
                                        <option value="Jaisalmer">Jaisalmer</option>
                                        <option value="Jalore">Jalore</option>
                                        <option value="Jhalawar">Jhalawar</option>
                                        <option value="Jhunjhunu">Jhunjhunu</option>
                                        <option value="Jodhpur">Jodhpur</option>
                                        <option value="Karauli">Karauli</option>
                                        <option value="Kota">Kota</option>
                                        <option value="Nagaur">Nagaur</option>
                                        <option value="Pali">Pali</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rajsamand">Rajsamand</option>
                                        <option value="Sikar">Sikar</option>
                                        <option value="Sirohi">Sirohi</option>
                                        <option value="Sri Ganganagar">Sri Ganganagar</option>
                                        <option value="Tonk">Tonk</option>
                                        <option value="Udaipur">Udaipur</option>

                                        <!-- Maharashtra -->
                                        <option value="Ahmednagar">Ahmednagar</option>
                                        <option value="Akola">Akola</option>
                                        <option value="Amravati">Amravati</option>
                                        <option value="Aurangabad">Aurangabad</option>
                                        <option value="Beed">Beed</option>
                                        <option value="Bhandara">Bhandara</option>
                                        <option value="Chandrapur">Chandrapur</option>
                                        <option value="Dhule">Dhule</option>
                                        <option value="Gadchiroli">Gadchiroli</option>
                                        <option value="Gondia">Gondia</option>
                                        <option value="Hingoli">Hingoli</option>
                                        <option value="Jalgaon">Jalgaon</option>
                                        <option value="Jalna">Jalna</option>
                                        <option value="Kolhapur">Kolhapur</option>
                                        <option value="Latur">Latur</option>
                                        <option value="Mumbai City">Mumbai City</option>
                                        <option value="Mumbai Suburban">Mumbai Suburban</option>
                                        <option value="Nagpur">Nagpur</option>
                                        <option value="Nanded">Nanded</option>
                                        <option value="Nandurbar">Nandurbar</option>
                                        <option value="Nashik">Nashik</option>
                                        <option value="Osmanabad">Osmanabad</option>
                                        <option value="Palghar">Palghar</option>
                                        <option value="Parbhani">Parbhani</option>
                                        <option value="Pune">Pune</option>
                                        <option value="Raigad">Raigad</option>
                                        <option value="Ratnagiri">Ratnagiri</option>
                                        <option value="Sangli">Sangli</option>
                                        <option value="Satara">Satara</option>
                                        <option value="Sindhudurg">Sindhudurg</option>
                                        <option value="Solapur">Solapur</option>
                                        <option value="Thane">Thane</option>
                                        <option value="Wardha">Wardha</option>
                                        <option value="Washim">Washim</option>
                                        <option value="Yavatmal">Yavatmal</option>

                                        <!-- Uttar Pradesh -->
                                        <option value="Agra">Agra</option>
                                        <option value="Aligarh">Aligarh</option>
                                        <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                        <option value="Amethi">Amethi</option>
                                        <option value="Amroha">Amroha</option>
                                        <option value="Auraiya">Auraiya</option>
                                        <option value="Ayodhya">Ayodhya</option>
                                        <option value="Azamgarh">Azamgarh</option>
                                        <option value="Bagpat">Bagpat</option>
                                        <option value="Bahraich">Bahraich</option>
                                        <option value="Ballia">Ballia</option>
                                        <option value="Balrampur">Balrampur</option>
                                        <option value="Banda">Banda</option>
                                        <option value="Barabanki">Barabanki</option>
                                        <option value="Bareilly">Bareilly</option>
                                        <option value="Basti">Basti</option>
                                        <option value="Bhadohi">Bhadohi</option>
                                        <option value="Bijnor">Bijnor</option>
                                        <option value="Bulandshahr">Bulandshahr</option>
                                        <option value="Chandauli">Chandauli</option>
                                        <option value="Chitrakoot">Chitrakoot</option>
                                        <option value="Deoria">Deoria</option>
                                        <option value="Etah">Etah</option>
                                        <option value="Etawah">Etawah</option>
                                        <option value="Farrukhabad">Farrukhabad</option>
                                        <option value="Fatehpur">Fatehpur</option>
                                        <option value="Firozabad">Firozabad</option>
                                        <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                        <option value="Ghaziabad">Ghaziabad</option>
                                        <option value="Ghazipur">Ghazipur</option>
                                        <option value="Gonda">Gonda</option>
                                        <option value="Gorakhpur">Gorakhpur</option>
                                        <option value="Hamirpur">Hamirpur</option>
                                        <option value="Hapur">Hapur</option>
                                        <option value="Hardoi">Hardoi</option>
                                        <option value="Hathras">Hathras</option>
                                        <option value="Jalaun">Jalaun</option>
                                        <option value="Jaunpur">Jaunpur</option>
                                        <option value="Jhansi">Jhansi</option>
                                        <option value="Kannauj">Kannauj</option>
                                        <option value="Kanpur Dehat">Kanpur Dehat</option>
                                        <option value="Kanpur Nagar">Kanpur Nagar</option>
                                        <option value="Kasganj">Kasganj</option>
                                        <option value="Kaushambi">Kaushambi</option>
                                        <option value="Kushinagar">Kushinagar</option>
                                        <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                        <option value="Lalitpur">Lalitpur</option>
                                        <option value="Lucknow">Lucknow</option>
                                        <option value="Maharajganj">Maharajganj</option>
                                        <option value="Mahoba">Mahoba</option>
                                        <option value="Mainpuri">Mainpuri</option>
                                        <option value="Mathura">Mathura</option>
                                        <option value="Mau">Mau</option>
                                        <option value="Meerut">Meerut</option>
                                        <option value="Mirzapur">Mirzapur</option>
                                        <option value="Moradabad">Moradabad</option>
                                        <option value="Muzaffarnagar">Muzaffarnagar</option>
                                        <option value="Pilibhit">Pilibhit</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rae Bareli">Rae Bareli</option>
                                        <option value="Rampur">Rampur</option>
                                        <option value="Saharanpur">Saharanpur</option>
                                        <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                        <option value="Shahjahanpur">Shahjahanpur</option>
                                        <option value="Shravasti">Shravasti</option>
                                        <option value="Siddharthnagar">Siddharthnagar</option>
                                        <option value="Sitapur">Sitapur</option>
                                        <option value="Sonbhadra">Sonbhadra</option>
                                        <option value="Sultanpur">Sultanpur</option>
                                        <option value="Unnao">Unnao</option>
                                        <option value="Varanasi">Varanasi</option>

                                        <!-- Uttarakhand -->
                                        <option value="Almora">Almora</option>
                                        <option value="Bageshwar">Bageshwar</option>
                                        <option value="Chamoli">Chamoli</option>
                                        <option value="Champawat">Champawat</option>
                                        <option value="Dehradun">Dehradun</option>
                                        <option value="Haridwar">Haridwar</option>
                                        <option value="Nainital">Nainital</option>
                                        <option value="Pauri Garhwal">Pauri Garhwal</option>
                                        <option value="Pithoragarh">Pithoragarh</option>
                                        <option value="Rudraprayag">Rudraprayag</option>
                                        <option value="Tehri Garhwal">Tehri Garhwal</option>
                                        <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                        <option value="Uttarkashi">Uttarkashi</option>

                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="publicIpFirstAuditCertificateOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="publicIpFirstAuditCertificateState">State*</label>
                                <div class="combo-input">
                                    <select id="publicIpFirstAuditCertificateState" name="state" required onchange="toggleVaptOtherInput('publicIpFirstAuditCertificateState', 'publicIpFirstAuditCertificateOtherState')">
                                        <option value="">Select State</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                        <option value="Assam">Assam</option>
                                        <option value="Bihar">Bihar</option>
                                        <option value="Chhattisgarh">Chhattisgarh</option>
                                        <option value="Goa">Goa</option>
                                        <option value="Gujarat">Gujarat</option>
                                        <option value="Haryana">Haryana</option>
                                        <option value="Himachal Pradesh">Himachal Pradesh</option>
                                        <option value="Jharkhand">Jharkhand</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Kerala">Kerala</option>
                                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Manipur">Manipur</option>
                                        <option value="Meghalaya">Meghalaya</option>
                                        <option value="Mizoram">Mizoram</option>
                                        <option value="Nagaland">Nagaland</option>
                                        <option value="Odisha">Odisha</option>
                                        <option value="Punjab">Punjab</option>
                                        <option value="Rajasthan">Rajasthan</option>
                                        <option value="Sikkim">Sikkim</option>
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="Telangana">Telangana</option>
                                        <option value="Tripura">Tripura</option>
                                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                                        <option value="Uttarakhand">Uttarakhand</option>
                                        <option value="West Bengal">West Bengal</option>

                                        <!-- Union Territories -->
                                        <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                        <option value="Chandigarh">Chandigarh</option>
                                        <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                        <option value="Delhi">Delhi</option>
                                        <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                        <option value="Ladakh">Ladakh</option>
                                        <option value="Lakshadweep">Lakshadweep</option>
                                        <option value="Puducherry">Puducherry</option>

                                    </select>
                                    <input type="text" id="publicIpFirstAuditCertificateOtherState" name="otherState" class="hidden" placeholder="Enter State Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="publicIpFirstAuditCertificateAuditeeDesignation">Designation of the Auditee Person (Submitted To)*</label>
                                <input type="text" id="publicIpFirstAuditCertificateAuditeeDesignation" name="auditeeDesignation" required placeholder="Enter auditee designation">
                            </div>

                            <div class="form-group">
                                <label for="publicIpFirstAuditCertificateScope">Scope*</label>
                                <input type="text" id="publicIpFirstAuditCertificateScope" name="scope" required placeholder="Enter scope details">
                            </div>

                            <div class="form-group">
                                <label for="publicIpFirstAuditCertificateStartAuditDate">Start Audit Date*</label>
                                <input type="date" id="publicIpFirstAuditCertificateStartAuditDate" name="startAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="publicIpFirstAuditCertificateEndAuditDate">End Audit Date*</label>
                                <input type="date" id="publicIpFirstAuditCertificateEndAuditDate" name="endAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="publicIpFirstAuditCertificateReportId">Report ID*</label>
                                <input type="text" id="publicIpFirstAuditCertificateReportId" name="reportId" required placeholder="Enter report ID">
                            </div>

                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('publicIpFirstAuditCertificateModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Certificate</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>


            <!-- Web Application VAPT First Audit Completion Certificate Modal -->
            <div id="webAppVaptFirstAuditCertificateModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Web Application VAPT First Audit Completion Certificate</h3>
                        <span class="close-modal" onclick="closeVaptModal('webAppVaptFirstAuditCertificateModal')">&times;</span>
                    </div>
                    <div class="modal-body">
                        <form id="webAppVaptFirstAuditCertificateForm" action="/process_web_app_vapt_first_audit_certificate" method="POST">
                            <div class="form-group">
                                <label for="webAppVaptFirstAuditCertificateOrganizationName">Organization Name*</label>
                                <div class="combo-input">
                                    <select id="webAppVaptFirstAuditCertificateOrganizationName" name="organizationName" required onchange="toggleVaptOtherInput('webAppVaptFirstAuditCertificateOrganizationName', 'webAppVaptFirstAuditCertificateOtherOrganizationName')">
                                        <option value="">Select Organization</option>
                                        <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                        <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                        <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                        <option value="Megasoft Limited">Megasoft Limited</option>
                                        <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                        <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                        <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                        <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                        <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                        <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                        <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                        <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                        <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                        <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                        <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                        <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                        <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                        <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                        <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                        <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                        <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                        <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                        <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                        <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                        <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                        <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                        <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                        <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                        <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                        <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                        <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                        <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                        <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                        <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                        <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                        <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                        <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                        <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                        <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                        <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                        
                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="webAppVaptFirstAuditCertificateOtherOrganizationName" name="otherOrganizationName" class="hidden" placeholder="Enter Organization Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="webAppVaptFirstAuditCertificateCity">City*</label>
                                <div class="combo-input">
                                    <select id="webAppVaptFirstAuditCertificateCity" name="city" required onchange="toggleVaptOtherInput('webAppVaptFirstAuditCertificateCity', 'webAppVaptFirstAuditCertificateOtherCity')">
                                        <option value="">Select City</option>
                                        <!-- Gujarat -->
                                        <option value="Ahmedabad">Ahmedabad</option>
                                        <option value="Amreli">Amreli</option>
                                        <option value="Anand">Anand</option>
                                        <option value="Aravalli">Aravalli</option>
                                        <option value="Banaskantha">Banaskantha</option>
                                        <option value="Bharuch">Bharuch</option>
                                        <option value="Bhavnagar">Bhavnagar</option>
                                        <option value="Botad">Botad</option>
                                        <option value="Chhota Udaipur">Chhota Udaipur</option>
                                        <option value="Dahod">Dahod</option>
                                        <option value="Dang">Dang</option>
                                        <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                        <option value="Gandhinagar">Gandhinagar</option>
                                        <option value="Gir Somnath">Gir Somnath</option>
                                        <option value="Jamnagar">Jamnagar</option>
                                        <option value="Junagadh">Junagadh</option>
                                        <option value="Kheda">Kheda</option>
                                        <option value="Kutch">Kutch</option>
                                        <option value="Mahisagar">Mahisagar</option>
                                        <option value="Mehsana">Mehsana</option>
                                        <option value="Morbi">Morbi</option>
                                        <option value="Narmada">Narmada</option>
                                        <option value="Navsari">Navsari</option>
                                        <option value="Patan">Patan</option>
                                        <option value="Panchmahal">Panchmahal</option>
                                        <option value="Porbandar">Porbandar</option>
                                        <option value="Rajkot">Rajkot</option>
                                        <option value="Sabarkantha">Sabarkantha</option>
                                        <option value="Surat">Surat</option>
                                        <option value="Surendranagar">Surendranagar</option>
                                        <option value="Tapi">Tapi</option>
                                        <option value="Vadodara">Vadodara</option>
                                        <option value="Valsad">Valsad</option>

                                        <!-- Rajasthan -->
                                        <option value="Ajmer">Ajmer</option>
                                        <option value="Alwar">Alwar</option>
                                        <option value="Banswara">Banswara</option>
                                        <option value="Baran">Baran</option>
                                        <option value="Barmer">Barmer</option>
                                        <option value="Bharatpur">Bharatpur</option>
                                        <option value="Bhilwara">Bhilwara</option>
                                        <option value="Bikaner">Bikaner</option>
                                        <option value="Bundi">Bundi</option>
                                        <option value="Chittorgarh">Chittorgarh</option>
                                        <option value="Churu">Churu</option>
                                        <option value="Dausa">Dausa</option>
                                        <option value="Dholpur">Dholpur</option>
                                        <option value="Dungarpur">Dungarpur</option>
                                        <option value="Hanumangarh">Hanumangarh</option>
                                        <option value="Jaipur">Jaipur</option>
                                        <option value="Jaisalmer">Jaisalmer</option>
                                        <option value="Jalore">Jalore</option>
                                        <option value="Jhalawar">Jhalawar</option>
                                        <option value="Jhunjhunu">Jhunjhunu</option>
                                        <option value="Jodhpur">Jodhpur</option>
                                        <option value="Karauli">Karauli</option>
                                        <option value="Kota">Kota</option>
                                        <option value="Nagaur">Nagaur</option>
                                        <option value="Pali">Pali</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rajsamand">Rajsamand</option>
                                        <option value="Sikar">Sikar</option>
                                        <option value="Sirohi">Sirohi</option>
                                        <option value="Sri Ganganagar">Sri Ganganagar</option>
                                        <option value="Tonk">Tonk</option>
                                        <option value="Udaipur">Udaipur</option>

                                        <!-- Maharashtra -->
                                        <option value="Ahmednagar">Ahmednagar</option>
                                        <option value="Akola">Akola</option>
                                        <option value="Amravati">Amravati</option>
                                        <option value="Aurangabad">Aurangabad</option>
                                        <option value="Beed">Beed</option>
                                        <option value="Bhandara">Bhandara</option>
                                        <option value="Chandrapur">Chandrapur</option>
                                        <option value="Dhule">Dhule</option>
                                        <option value="Gadchiroli">Gadchiroli</option>
                                        <option value="Gondia">Gondia</option>
                                        <option value="Hingoli">Hingoli</option>
                                        <option value="Jalgaon">Jalgaon</option>
                                        <option value="Jalna">Jalna</option>
                                        <option value="Kolhapur">Kolhapur</option>
                                        <option value="Latur">Latur</option>
                                        <option value="Mumbai City">Mumbai City</option>
                                        <option value="Mumbai Suburban">Mumbai Suburban</option>
                                        <option value="Nagpur">Nagpur</option>
                                        <option value="Nanded">Nanded</option>
                                        <option value="Nandurbar">Nandurbar</option>
                                        <option value="Nashik">Nashik</option>
                                        <option value="Osmanabad">Osmanabad</option>
                                        <option value="Palghar">Palghar</option>
                                        <option value="Parbhani">Parbhani</option>
                                        <option value="Pune">Pune</option>
                                        <option value="Raigad">Raigad</option>
                                        <option value="Ratnagiri">Ratnagiri</option>
                                        <option value="Sangli">Sangli</option>
                                        <option value="Satara">Satara</option>
                                        <option value="Sindhudurg">Sindhudurg</option>
                                        <option value="Solapur">Solapur</option>
                                        <option value="Thane">Thane</option>
                                        <option value="Wardha">Wardha</option>
                                        <option value="Washim">Washim</option>
                                        <option value="Yavatmal">Yavatmal</option>

                                        <!-- Uttar Pradesh -->
                                        <option value="Agra">Agra</option>
                                        <option value="Aligarh">Aligarh</option>
                                        <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                        <option value="Amethi">Amethi</option>
                                        <option value="Amroha">Amroha</option>
                                        <option value="Auraiya">Auraiya</option>
                                        <option value="Ayodhya">Ayodhya</option>
                                        <option value="Azamgarh">Azamgarh</option>
                                        <option value="Bagpat">Bagpat</option>
                                        <option value="Bahraich">Bahraich</option>
                                        <option value="Ballia">Ballia</option>
                                        <option value="Balrampur">Balrampur</option>
                                        <option value="Banda">Banda</option>
                                        <option value="Barabanki">Barabanki</option>
                                        <option value="Bareilly">Bareilly</option>
                                        <option value="Basti">Basti</option>
                                        <option value="Bhadohi">Bhadohi</option>
                                        <option value="Bijnor">Bijnor</option>
                                        <option value="Bulandshahr">Bulandshahr</option>
                                        <option value="Chandauli">Chandauli</option>
                                        <option value="Chitrakoot">Chitrakoot</option>
                                        <option value="Deoria">Deoria</option>
                                        <option value="Etah">Etah</option>
                                        <option value="Etawah">Etawah</option>
                                        <option value="Farrukhabad">Farrukhabad</option>
                                        <option value="Fatehpur">Fatehpur</option>
                                        <option value="Firozabad">Firozabad</option>
                                        <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                        <option value="Ghaziabad">Ghaziabad</option>
                                        <option value="Ghazipur">Ghazipur</option>
                                        <option value="Gonda">Gonda</option>
                                        <option value="Gorakhpur">Gorakhpur</option>
                                        <option value="Hamirpur">Hamirpur</option>
                                        <option value="Hapur">Hapur</option>
                                        <option value="Hardoi">Hardoi</option>
                                        <option value="Hathras">Hathras</option>
                                        <option value="Jalaun">Jalaun</option>
                                        <option value="Jaunpur">Jaunpur</option>
                                        <option value="Jhansi">Jhansi</option>
                                        <option value="Kannauj">Kannauj</option>
                                        <option value="Kanpur Dehat">Kanpur Dehat</option>
                                        <option value="Kanpur Nagar">Kanpur Nagar</option>
                                        <option value="Kasganj">Kasganj</option>
                                        <option value="Kaushambi">Kaushambi</option>
                                        <option value="Kushinagar">Kushinagar</option>
                                        <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                        <option value="Lalitpur">Lalitpur</option>
                                        <option value="Lucknow">Lucknow</option>
                                        <option value="Maharajganj">Maharajganj</option>
                                        <option value="Mahoba">Mahoba</option>
                                        <option value="Mainpuri">Mainpuri</option>
                                        <option value="Mathura">Mathura</option>
                                        <option value="Mau">Mau</option>
                                        <option value="Meerut">Meerut</option>
                                        <option value="Mirzapur">Mirzapur</option>
                                        <option value="Moradabad">Moradabad</option>
                                        <option value="Muzaffarnagar">Muzaffarnagar</option>
                                        <option value="Pilibhit">Pilibhit</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rae Bareli">Rae Bareli</option>
                                        <option value="Rampur">Rampur</option>
                                        <option value="Saharanpur">Saharanpur</option>
                                        <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                        <option value="Shahjahanpur">Shahjahanpur</option>
                                        <option value="Shravasti">Shravasti</option>
                                        <option value="Siddharthnagar">Siddharthnagar</option>
                                        <option value="Sitapur">Sitapur</option>
                                        <option value="Sonbhadra">Sonbhadra</option>
                                        <option value="Sultanpur">Sultanpur</option>
                                        <option value="Unnao">Unnao</option>
                                        <option value="Varanasi">Varanasi</option>

                                        <!-- Uttarakhand -->
                                        <option value="Almora">Almora</option>
                                        <option value="Bageshwar">Bageshwar</option>
                                        <option value="Chamoli">Chamoli</option>
                                        <option value="Champawat">Champawat</option>
                                        <option value="Dehradun">Dehradun</option>
                                        <option value="Haridwar">Haridwar</option>
                                        <option value="Nainital">Nainital</option>
                                        <option value="Pauri Garhwal">Pauri Garhwal</option>
                                        <option value="Pithoragarh">Pithoragarh</option>
                                        <option value="Rudraprayag">Rudraprayag</option>
                                        <option value="Tehri Garhwal">Tehri Garhwal</option>
                                        <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                        <option value="Uttarkashi">Uttarkashi</option>

                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="webAppVaptFirstAuditCertificateOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="webAppVaptFirstAuditCertificateState">State*</label>
                                <div class="combo-input">
                                    <select id="webAppVaptFirstAuditCertificateState" name="state" required onchange="toggleVaptOtherInput('webAppVaptFirstAuditCertificateState', 'webAppVaptFirstAuditCertificateOtherState')">
                                        <option value="">Select State</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                        <option value="Assam">Assam</option>
                                        <option value="Bihar">Bihar</option>
                                        <option value="Chhattisgarh">Chhattisgarh</option>
                                        <option value="Goa">Goa</option>
                                        <option value="Gujarat">Gujarat</option>
                                        <option value="Haryana">Haryana</option>
                                        <option value="Himachal Pradesh">Himachal Pradesh</option>
                                        <option value="Jharkhand">Jharkhand</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Kerala">Kerala</option>
                                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Manipur">Manipur</option>
                                        <option value="Meghalaya">Meghalaya</option>
                                        <option value="Mizoram">Mizoram</option>
                                        <option value="Nagaland">Nagaland</option>
                                        <option value="Odisha">Odisha</option>
                                        <option value="Punjab">Punjab</option>
                                        <option value="Rajasthan">Rajasthan</option>
                                        <option value="Sikkim">Sikkim</option>
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="Telangana">Telangana</option>
                                        <option value="Tripura">Tripura</option>
                                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                                        <option value="Uttarakhand">Uttarakhand</option>
                                        <option value="West Bengal">West Bengal</option>

                                        <!-- Union Territories -->
                                        <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                        <option value="Chandigarh">Chandigarh</option>
                                        <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                        <option value="Delhi">Delhi</option>
                                        <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                        <option value="Ladakh">Ladakh</option>
                                        <option value="Lakshadweep">Lakshadweep</option>
                                        <option value="Puducherry">Puducherry</option>

                                    </select>
                                    <input type="text" id="webAppVaptFirstAuditCertificateOtherState" name="otherState" class="hidden" placeholder="Enter State Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="webAppVaptFirstAuditCertificateAuditeeDesignation">Designation of the Auditee Person (Submitted To)*</label>
                                <input type="text" id="webAppVaptFirstAuditCertificateAuditeeDesignation" name="auditeeDesignation" required placeholder="Enter auditee designation">
                            </div>

                            <div class="form-group">
                                <label for="webAppVaptFirstAuditCertificateScope">Scope*</label>
                                <input type="text" id="webAppVaptFirstAuditCertificateScope" name="scope" required placeholder="Enter scope details">
                            </div>

                            <div class="form-group">
                                <label for="webAppVaptFirstAuditCertificateStartAuditDate">Start Audit Date*</label>
                                <input type="date" id="webAppVaptFirstAuditCertificateStartAuditDate" name="startAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="webAppVaptFirstAuditCertificateEndAuditDate">End Audit Date*</label>
                                <input type="date" id="webAppVaptFirstAuditCertificateEndAuditDate" name="endAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="webAppVaptFirstAuditCertificateReportId">Report ID*</label>
                                <input type="text" id="webAppVaptFirstAuditCertificateReportId" name="reportId" required placeholder="Enter report ID">
                            </div>

                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('webAppVaptFirstAuditCertificateModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Certificate</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>


            <!-- Android Mobile Application VAPT First Audit Completion Certificate Modal -->
            <div id="androidAppVaptFirstAuditCertificateModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Android Mobile Application VAPT First Audit Completion Certificate</h3>
                        <span class="close-modal" onclick="closeVaptModal('androidAppVaptFirstAuditCertificateModal')">&times;</span>
                    </div>
                    <div class="modal-body">
                        <form id="androidAppVaptFirstAuditCertificateForm" action="/process_android_app_vapt_first_audit_certificate" method="POST">
                            <div class="form-group">
                                <label for="androidAppVaptFirstAuditCertificateOrganizationName">Organization Name*</label>
                                <div class="combo-input">
                                    <select id="androidAppVaptFirstAuditCertificateOrganizationName" name="organizationName" required onchange="toggleVaptOtherInput('androidAppVaptFirstAuditCertificateOrganizationName', 'androidAppVaptFirstAuditCertificateOtherOrganizationName')">
                                        <option value="">Select Organization</option>
                                        <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                        <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                        <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                        <option value="Megasoft Limited">Megasoft Limited</option>
                                        <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                        <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                        <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                        <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                        <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                        <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                        <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                        <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                        <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                        <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                        <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                        <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                        <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                        <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                        <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                        <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                        <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                        <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                        <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                        <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                        <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                        <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                        <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                        <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                        <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                        <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                        <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                        <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                        <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                        <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                        <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                        <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                        <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                        <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                        <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                        <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                        
                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="androidAppVaptFirstAuditCertificateOtherOrganizationName" name="otherOrganizationName" class="hidden" placeholder="Enter Organization Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="androidAppVaptFirstAuditCertificateCity">City*</label>
                                <div class="combo-input">
                                    <select id="androidAppVaptFirstAuditCertificateCity" name="city" required onchange="toggleVaptOtherInput('androidAppVaptFirstAuditCertificateCity', 'androidAppVaptFirstAuditCertificateOtherCity')">
                                        <option value="">Select City</option>
                                        <!-- Gujarat -->
                                        <option value="Ahmedabad">Ahmedabad</option>
                                        <option value="Amreli">Amreli</option>
                                        <option value="Anand">Anand</option>
                                        <option value="Aravalli">Aravalli</option>
                                        <option value="Banaskantha">Banaskantha</option>
                                        <option value="Bharuch">Bharuch</option>
                                        <option value="Bhavnagar">Bhavnagar</option>
                                        <option value="Botad">Botad</option>
                                        <option value="Chhota Udaipur">Chhota Udaipur</option>
                                        <option value="Dahod">Dahod</option>
                                        <option value="Dang">Dang</option>
                                        <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                        <option value="Gandhinagar">Gandhinagar</option>
                                        <option value="Gir Somnath">Gir Somnath</option>
                                        <option value="Jamnagar">Jamnagar</option>
                                        <option value="Junagadh">Junagadh</option>
                                        <option value="Kheda">Kheda</option>
                                        <option value="Kutch">Kutch</option>
                                        <option value="Mahisagar">Mahisagar</option>
                                        <option value="Mehsana">Mehsana</option>
                                        <option value="Morbi">Morbi</option>
                                        <option value="Narmada">Narmada</option>
                                        <option value="Navsari">Navsari</option>
                                        <option value="Patan">Patan</option>
                                        <option value="Panchmahal">Panchmahal</option>
                                        <option value="Porbandar">Porbandar</option>
                                        <option value="Rajkot">Rajkot</option>
                                        <option value="Sabarkantha">Sabarkantha</option>
                                        <option value="Surat">Surat</option>
                                        <option value="Surendranagar">Surendranagar</option>
                                        <option value="Tapi">Tapi</option>
                                        <option value="Vadodara">Vadodara</option>
                                        <option value="Valsad">Valsad</option>

                                        <!-- Rajasthan -->
                                        <option value="Ajmer">Ajmer</option>
                                        <option value="Alwar">Alwar</option>
                                        <option value="Banswara">Banswara</option>
                                        <option value="Baran">Baran</option>
                                        <option value="Barmer">Barmer</option>
                                        <option value="Bharatpur">Bharatpur</option>
                                        <option value="Bhilwara">Bhilwara</option>
                                        <option value="Bikaner">Bikaner</option>
                                        <option value="Bundi">Bundi</option>
                                        <option value="Chittorgarh">Chittorgarh</option>
                                        <option value="Churu">Churu</option>
                                        <option value="Dausa">Dausa</option>
                                        <option value="Dholpur">Dholpur</option>
                                        <option value="Dungarpur">Dungarpur</option>
                                        <option value="Hanumangarh">Hanumangarh</option>
                                        <option value="Jaipur">Jaipur</option>
                                        <option value="Jaisalmer">Jaisalmer</option>
                                        <option value="Jalore">Jalore</option>
                                        <option value="Jhalawar">Jhalawar</option>
                                        <option value="Jhunjhunu">Jhunjhunu</option>
                                        <option value="Jodhpur">Jodhpur</option>
                                        <option value="Karauli">Karauli</option>
                                        <option value="Kota">Kota</option>
                                        <option value="Nagaur">Nagaur</option>
                                        <option value="Pali">Pali</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rajsamand">Rajsamand</option>
                                        <option value="Sikar">Sikar</option>
                                        <option value="Sirohi">Sirohi</option>
                                        <option value="Sri Ganganagar">Sri Ganganagar</option>
                                        <option value="Tonk">Tonk</option>
                                        <option value="Udaipur">Udaipur</option>

                                        <!-- Maharashtra -->
                                        <option value="Ahmednagar">Ahmednagar</option>
                                        <option value="Akola">Akola</option>
                                        <option value="Amravati">Amravati</option>
                                        <option value="Aurangabad">Aurangabad</option>
                                        <option value="Beed">Beed</option>
                                        <option value="Bhandara">Bhandara</option>
                                        <option value="Chandrapur">Chandrapur</option>
                                        <option value="Dhule">Dhule</option>
                                        <option value="Gadchiroli">Gadchiroli</option>
                                        <option value="Gondia">Gondia</option>
                                        <option value="Hingoli">Hingoli</option>
                                        <option value="Jalgaon">Jalgaon</option>
                                        <option value="Jalna">Jalna</option>
                                        <option value="Kolhapur">Kolhapur</option>
                                        <option value="Latur">Latur</option>
                                        <option value="Mumbai City">Mumbai City</option>
                                        <option value="Mumbai Suburban">Mumbai Suburban</option>
                                        <option value="Nagpur">Nagpur</option>
                                        <option value="Nanded">Nanded</option>
                                        <option value="Nandurbar">Nandurbar</option>
                                        <option value="Nashik">Nashik</option>
                                        <option value="Osmanabad">Osmanabad</option>
                                        <option value="Palghar">Palghar</option>
                                        <option value="Parbhani">Parbhani</option>
                                        <option value="Pune">Pune</option>
                                        <option value="Raigad">Raigad</option>
                                        <option value="Ratnagiri">Ratnagiri</option>
                                        <option value="Sangli">Sangli</option>
                                        <option value="Satara">Satara</option>
                                        <option value="Sindhudurg">Sindhudurg</option>
                                        <option value="Solapur">Solapur</option>
                                        <option value="Thane">Thane</option>
                                        <option value="Wardha">Wardha</option>
                                        <option value="Washim">Washim</option>
                                        <option value="Yavatmal">Yavatmal</option>

                                        <!-- Uttar Pradesh -->
                                        <option value="Agra">Agra</option>
                                        <option value="Aligarh">Aligarh</option>
                                        <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                        <option value="Amethi">Amethi</option>
                                        <option value="Amroha">Amroha</option>
                                        <option value="Auraiya">Auraiya</option>
                                        <option value="Ayodhya">Ayodhya</option>
                                        <option value="Azamgarh">Azamgarh</option>
                                        <option value="Bagpat">Bagpat</option>
                                        <option value="Bahraich">Bahraich</option>
                                        <option value="Ballia">Ballia</option>
                                        <option value="Balrampur">Balrampur</option>
                                        <option value="Banda">Banda</option>
                                        <option value="Barabanki">Barabanki</option>
                                        <option value="Bareilly">Bareilly</option>
                                        <option value="Basti">Basti</option>
                                        <option value="Bhadohi">Bhadohi</option>
                                        <option value="Bijnor">Bijnor</option>
                                        <option value="Bulandshahr">Bulandshahr</option>
                                        <option value="Chandauli">Chandauli</option>
                                        <option value="Chitrakoot">Chitrakoot</option>
                                        <option value="Deoria">Deoria</option>
                                        <option value="Etah">Etah</option>
                                        <option value="Etawah">Etawah</option>
                                        <option value="Farrukhabad">Farrukhabad</option>
                                        <option value="Fatehpur">Fatehpur</option>
                                        <option value="Firozabad">Firozabad</option>
                                        <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                        <option value="Ghaziabad">Ghaziabad</option>
                                        <option value="Ghazipur">Ghazipur</option>
                                        <option value="Gonda">Gonda</option>
                                        <option value="Gorakhpur">Gorakhpur</option>
                                        <option value="Hamirpur">Hamirpur</option>
                                        <option value="Hapur">Hapur</option>
                                        <option value="Hardoi">Hardoi</option>
                                        <option value="Hathras">Hathras</option>
                                        <option value="Jalaun">Jalaun</option>
                                        <option value="Jaunpur">Jaunpur</option>
                                        <option value="Jhansi">Jhansi</option>
                                        <option value="Kannauj">Kannauj</option>
                                        <option value="Kanpur Dehat">Kanpur Dehat</option>
                                        <option value="Kanpur Nagar">Kanpur Nagar</option>
                                        <option value="Kasganj">Kasganj</option>
                                        <option value="Kaushambi">Kaushambi</option>
                                        <option value="Kushinagar">Kushinagar</option>
                                        <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                        <option value="Lalitpur">Lalitpur</option>
                                        <option value="Lucknow">Lucknow</option>
                                        <option value="Maharajganj">Maharajganj</option>
                                        <option value="Mahoba">Mahoba</option>
                                        <option value="Mainpuri">Mainpuri</option>
                                        <option value="Mathura">Mathura</option>
                                        <option value="Mau">Mau</option>
                                        <option value="Meerut">Meerut</option>
                                        <option value="Mirzapur">Mirzapur</option>
                                        <option value="Moradabad">Moradabad</option>
                                        <option value="Muzaffarnagar">Muzaffarnagar</option>
                                        <option value="Pilibhit">Pilibhit</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rae Bareli">Rae Bareli</option>
                                        <option value="Rampur">Rampur</option>
                                        <option value="Saharanpur">Saharanpur</option>
                                        <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                        <option value="Shahjahanpur">Shahjahanpur</option>
                                        <option value="Shravasti">Shravasti</option>
                                        <option value="Siddharthnagar">Siddharthnagar</option>
                                        <option value="Sitapur">Sitapur</option>
                                        <option value="Sonbhadra">Sonbhadra</option>
                                        <option value="Sultanpur">Sultanpur</option>
                                        <option value="Unnao">Unnao</option>
                                        <option value="Varanasi">Varanasi</option>

                                        <!-- Uttarakhand -->
                                        <option value="Almora">Almora</option>
                                        <option value="Bageshwar">Bageshwar</option>
                                        <option value="Chamoli">Chamoli</option>
                                        <option value="Champawat">Champawat</option>
                                        <option value="Dehradun">Dehradun</option>
                                        <option value="Haridwar">Haridwar</option>
                                        <option value="Nainital">Nainital</option>
                                        <option value="Pauri Garhwal">Pauri Garhwal</option>
                                        <option value="Pithoragarh">Pithoragarh</option>
                                        <option value="Rudraprayag">Rudraprayag</option>
                                        <option value="Tehri Garhwal">Tehri Garhwal</option>
                                        <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                        <option value="Uttarkashi">Uttarkashi</option>

                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="androidAppVaptFirstAuditCertificateOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="androidAppVaptFirstAuditCertificateState">State*</label>
                                <div class="combo-input">
                                    <select id="androidAppVaptFirstAuditCertificateState" name="state" required onchange="toggleVaptOtherInput('androidAppVaptFirstAuditCertificateState', 'androidAppVaptFirstAuditCertificateOtherState')">
                                        <option value="">Select State</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                        <option value="Assam">Assam</option>
                                        <option value="Bihar">Bihar</option>
                                        <option value="Chhattisgarh">Chhattisgarh</option>
                                        <option value="Goa">Goa</option>
                                        <option value="Gujarat">Gujarat</option>
                                        <option value="Haryana">Haryana</option>
                                        <option value="Himachal Pradesh">Himachal Pradesh</option>
                                        <option value="Jharkhand">Jharkhand</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Kerala">Kerala</option>
                                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Manipur">Manipur</option>
                                        <option value="Meghalaya">Meghalaya</option>
                                        <option value="Mizoram">Mizoram</option>
                                        <option value="Nagaland">Nagaland</option>
                                        <option value="Odisha">Odisha</option>
                                        <option value="Punjab">Punjab</option>
                                        <option value="Rajasthan">Rajasthan</option>
                                        <option value="Sikkim">Sikkim</option>
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="Telangana">Telangana</option>
                                        <option value="Tripura">Tripura</option>
                                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                                        <option value="Uttarakhand">Uttarakhand</option>
                                        <option value="West Bengal">West Bengal</option>

                                        <!-- Union Territories -->
                                        <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                        <option value="Chandigarh">Chandigarh</option>
                                        <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                        <option value="Delhi">Delhi</option>
                                        <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                        <option value="Ladakh">Ladakh</option>
                                        <option value="Lakshadweep">Lakshadweep</option>
                                        <option value="Puducherry">Puducherry</option>

                                    </select>
                                    <input type="text" id="androidAppVaptFirstAuditCertificateOtherState" name="otherState" class="hidden" placeholder="Enter State Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="androidAppVaptFirstAuditCertificateAuditeeDesignation">Designation of the Auditee Person (Submitted To)*</label>
                                <input type="text" id="androidAppVaptFirstAuditCertificateAuditeeDesignation" name="auditeeDesignation" required placeholder="Enter auditee designation">
                            </div>

                            <div class="form-group">
                                <label for="androidAppVaptFirstAuditCertificateScope">Scope*</label>
                                <input type="text" id="androidAppVaptFirstAuditCertificateScope" name="scope" required placeholder="Enter scope details">
                            </div>

                            <div class="form-group">
                                <label for="androidAppVaptFirstAuditCertificateStartAuditDate">Start Audit Date*</label>
                                <input type="date" id="androidAppVaptFirstAuditCertificateStartAuditDate" name="startAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="androidAppVaptFirstAuditCertificateEndAuditDate">End Audit Date*</label>
                                <input type="date" id="androidAppVaptFirstAuditCertificateEndAuditDate" name="endAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="androidAppVaptFirstAuditCertificateReportId">Report ID*</label>
                                <input type="text" id="androidAppVaptFirstAuditCertificateReportId" name="reportId" required placeholder="Enter report ID">
                            </div>

                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('androidAppVaptFirstAuditCertificateModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Certificate</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>


            <!-- IOS Mobile Application VAPT First Audit Completion Certificate Modal -->
            <div id="iosAppVaptFirstAuditCertificateModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>IOS Mobile Application VAPT First Audit Completion Certificate</h3>
                        <span class="close-modal" onclick="closeVaptModal('iosAppVaptFirstAuditCertificateModal')">&times;</span>
                    </div>
                    <div class="modal-body">
                        <form id="iosAppVaptFirstAuditCertificateForm" action="/process_ios_app_vapt_first_audit_certificate" method="POST">
                            <div class="form-group">
                                <label for="iosAppVaptFirstAuditCertificateOrganizationName">Organization Name*</label>
                                <div class="combo-input">
                                    <select id="iosAppVaptFirstAuditCertificateOrganizationName" name="organizationName" required onchange="toggleVaptOtherInput('iosAppVaptFirstAuditCertificateOrganizationName', 'iosAppVaptFirstAuditCertificateOtherOrganizationName')">
                                        <option value="">Select Organization</option>
                                        <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                        <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                        <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                        <option value="Megasoft Limited">Megasoft Limited</option>
                                        <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                        <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                        <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                        <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                        <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                        <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                        <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                        <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                        <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                        <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                        <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                        <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                        <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                        <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                        <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                        <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                        <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                        <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                        <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                        <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                        <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                        <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                        <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                        <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                        <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                        <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                        <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                        <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                        <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                        <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                        <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                        <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                        <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                        <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                        <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                        <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                        
                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="iosAppVaptFirstAuditCertificateOtherOrganizationName" name="otherOrganizationName" class="hidden" placeholder="Enter Organization Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="iosAppVaptFirstAuditCertificateCity">City*</label>
                                <div class="combo-input">
                                    <select id="iosAppVaptFirstAuditCertificateCity" name="city" required onchange="toggleVaptOtherInput('iosAppVaptFirstAuditCertificateCity', 'iosAppVaptFirstAuditCertificateOtherCity')">
                                        <option value="">Select City</option>
                                        <!-- Gujarat -->
                                        <option value="Ahmedabad">Ahmedabad</option>
                                        <option value="Amreli">Amreli</option>
                                        <option value="Anand">Anand</option>
                                        <option value="Aravalli">Aravalli</option>
                                        <option value="Banaskantha">Banaskantha</option>
                                        <option value="Bharuch">Bharuch</option>
                                        <option value="Bhavnagar">Bhavnagar</option>
                                        <option value="Botad">Botad</option>
                                        <option value="Chhota Udaipur">Chhota Udaipur</option>
                                        <option value="Dahod">Dahod</option>
                                        <option value="Dang">Dang</option>
                                        <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                        <option value="Gandhinagar">Gandhinagar</option>
                                        <option value="Gir Somnath">Gir Somnath</option>
                                        <option value="Jamnagar">Jamnagar</option>
                                        <option value="Junagadh">Junagadh</option>
                                        <option value="Kheda">Kheda</option>
                                        <option value="Kutch">Kutch</option>
                                        <option value="Mahisagar">Mahisagar</option>
                                        <option value="Mehsana">Mehsana</option>
                                        <option value="Morbi">Morbi</option>
                                        <option value="Narmada">Narmada</option>
                                        <option value="Navsari">Navsari</option>
                                        <option value="Patan">Patan</option>
                                        <option value="Panchmahal">Panchmahal</option>
                                        <option value="Porbandar">Porbandar</option>
                                        <option value="Rajkot">Rajkot</option>
                                        <option value="Sabarkantha">Sabarkantha</option>
                                        <option value="Surat">Surat</option>
                                        <option value="Surendranagar">Surendranagar</option>
                                        <option value="Tapi">Tapi</option>
                                        <option value="Vadodara">Vadodara</option>
                                        <option value="Valsad">Valsad</option>

                                        <!-- Rajasthan -->
                                        <option value="Ajmer">Ajmer</option>
                                        <option value="Alwar">Alwar</option>
                                        <option value="Banswara">Banswara</option>
                                        <option value="Baran">Baran</option>
                                        <option value="Barmer">Barmer</option>
                                        <option value="Bharatpur">Bharatpur</option>
                                        <option value="Bhilwara">Bhilwara</option>
                                        <option value="Bikaner">Bikaner</option>
                                        <option value="Bundi">Bundi</option>
                                        <option value="Chittorgarh">Chittorgarh</option>
                                        <option value="Churu">Churu</option>
                                        <option value="Dausa">Dausa</option>
                                        <option value="Dholpur">Dholpur</option>
                                        <option value="Dungarpur">Dungarpur</option>
                                        <option value="Hanumangarh">Hanumangarh</option>
                                        <option value="Jaipur">Jaipur</option>
                                        <option value="Jaisalmer">Jaisalmer</option>
                                        <option value="Jalore">Jalore</option>
                                        <option value="Jhalawar">Jhalawar</option>
                                        <option value="Jhunjhunu">Jhunjhunu</option>
                                        <option value="Jodhpur">Jodhpur</option>
                                        <option value="Karauli">Karauli</option>
                                        <option value="Kota">Kota</option>
                                        <option value="Nagaur">Nagaur</option>
                                        <option value="Pali">Pali</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rajsamand">Rajsamand</option>
                                        <option value="Sikar">Sikar</option>
                                        <option value="Sirohi">Sirohi</option>
                                        <option value="Sri Ganganagar">Sri Ganganagar</option>
                                        <option value="Tonk">Tonk</option>
                                        <option value="Udaipur">Udaipur</option>

                                        <!-- Maharashtra -->
                                        <option value="Ahmednagar">Ahmednagar</option>
                                        <option value="Akola">Akola</option>
                                        <option value="Amravati">Amravati</option>
                                        <option value="Aurangabad">Aurangabad</option>
                                        <option value="Beed">Beed</option>
                                        <option value="Bhandara">Bhandara</option>
                                        <option value="Chandrapur">Chandrapur</option>
                                        <option value="Dhule">Dhule</option>
                                        <option value="Gadchiroli">Gadchiroli</option>
                                        <option value="Gondia">Gondia</option>
                                        <option value="Hingoli">Hingoli</option>
                                        <option value="Jalgaon">Jalgaon</option>
                                        <option value="Jalna">Jalna</option>
                                        <option value="Kolhapur">Kolhapur</option>
                                        <option value="Latur">Latur</option>
                                        <option value="Mumbai City">Mumbai City</option>
                                        <option value="Mumbai Suburban">Mumbai Suburban</option>
                                        <option value="Nagpur">Nagpur</option>
                                        <option value="Nanded">Nanded</option>
                                        <option value="Nandurbar">Nandurbar</option>
                                        <option value="Nashik">Nashik</option>
                                        <option value="Osmanabad">Osmanabad</option>
                                        <option value="Palghar">Palghar</option>
                                        <option value="Parbhani">Parbhani</option>
                                        <option value="Pune">Pune</option>
                                        <option value="Raigad">Raigad</option>
                                        <option value="Ratnagiri">Ratnagiri</option>
                                        <option value="Sangli">Sangli</option>
                                        <option value="Satara">Satara</option>
                                        <option value="Sindhudurg">Sindhudurg</option>
                                        <option value="Solapur">Solapur</option>
                                        <option value="Thane">Thane</option>
                                        <option value="Wardha">Wardha</option>
                                        <option value="Washim">Washim</option>
                                        <option value="Yavatmal">Yavatmal</option>

                                        <!-- Uttar Pradesh -->
                                        <option value="Agra">Agra</option>
                                        <option value="Aligarh">Aligarh</option>
                                        <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                        <option value="Amethi">Amethi</option>
                                        <option value="Amroha">Amroha</option>
                                        <option value="Auraiya">Auraiya</option>
                                        <option value="Ayodhya">Ayodhya</option>
                                        <option value="Azamgarh">Azamgarh</option>
                                        <option value="Bagpat">Bagpat</option>
                                        <option value="Bahraich">Bahraich</option>
                                        <option value="Ballia">Ballia</option>
                                        <option value="Balrampur">Balrampur</option>
                                        <option value="Banda">Banda</option>
                                        <option value="Barabanki">Barabanki</option>
                                        <option value="Bareilly">Bareilly</option>
                                        <option value="Basti">Basti</option>
                                        <option value="Bhadohi">Bhadohi</option>
                                        <option value="Bijnor">Bijnor</option>
                                        <option value="Bulandshahr">Bulandshahr</option>
                                        <option value="Chandauli">Chandauli</option>
                                        <option value="Chitrakoot">Chitrakoot</option>
                                        <option value="Deoria">Deoria</option>
                                        <option value="Etah">Etah</option>
                                        <option value="Etawah">Etawah</option>
                                        <option value="Farrukhabad">Farrukhabad</option>
                                        <option value="Fatehpur">Fatehpur</option>
                                        <option value="Firozabad">Firozabad</option>
                                        <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                        <option value="Ghaziabad">Ghaziabad</option>
                                        <option value="Ghazipur">Ghazipur</option>
                                        <option value="Gonda">Gonda</option>
                                        <option value="Gorakhpur">Gorakhpur</option>
                                        <option value="Hamirpur">Hamirpur</option>
                                        <option value="Hapur">Hapur</option>
                                        <option value="Hardoi">Hardoi</option>
                                        <option value="Hathras">Hathras</option>
                                        <option value="Jalaun">Jalaun</option>
                                        <option value="Jaunpur">Jaunpur</option>
                                        <option value="Jhansi">Jhansi</option>
                                        <option value="Kannauj">Kannauj</option>
                                        <option value="Kanpur Dehat">Kanpur Dehat</option>
                                        <option value="Kanpur Nagar">Kanpur Nagar</option>
                                        <option value="Kasganj">Kasganj</option>
                                        <option value="Kaushambi">Kaushambi</option>
                                        <option value="Kushinagar">Kushinagar</option>
                                        <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                        <option value="Lalitpur">Lalitpur</option>
                                        <option value="Lucknow">Lucknow</option>
                                        <option value="Maharajganj">Maharajganj</option>
                                        <option value="Mahoba">Mahoba</option>
                                        <option value="Mainpuri">Mainpuri</option>
                                        <option value="Mathura">Mathura</option>
                                        <option value="Mau">Mau</option>
                                        <option value="Meerut">Meerut</option>
                                        <option value="Mirzapur">Mirzapur</option>
                                        <option value="Moradabad">Moradabad</option>
                                        <option value="Muzaffarnagar">Muzaffarnagar</option>
                                        <option value="Pilibhit">Pilibhit</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rae Bareli">Rae Bareli</option>
                                        <option value="Rampur">Rampur</option>
                                        <option value="Saharanpur">Saharanpur</option>
                                        <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                        <option value="Shahjahanpur">Shahjahanpur</option>
                                        <option value="Shravasti">Shravasti</option>
                                        <option value="Siddharthnagar">Siddharthnagar</option>
                                        <option value="Sitapur">Sitapur</option>
                                        <option value="Sonbhadra">Sonbhadra</option>
                                        <option value="Sultanpur">Sultanpur</option>
                                        <option value="Unnao">Unnao</option>
                                        <option value="Varanasi">Varanasi</option>

                                        <!-- Uttarakhand -->
                                        <option value="Almora">Almora</option>
                                        <option value="Bageshwar">Bageshwar</option>
                                        <option value="Chamoli">Chamoli</option>
                                        <option value="Champawat">Champawat</option>
                                        <option value="Dehradun">Dehradun</option>
                                        <option value="Haridwar">Haridwar</option>
                                        <option value="Nainital">Nainital</option>
                                        <option value="Pauri Garhwal">Pauri Garhwal</option>
                                        <option value="Pithoragarh">Pithoragarh</option>
                                        <option value="Rudraprayag">Rudraprayag</option>
                                        <option value="Tehri Garhwal">Tehri Garhwal</option>
                                        <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                        <option value="Uttarkashi">Uttarkashi</option>

                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="iosAppVaptFirstAuditCertificateOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="iosAppVaptFirstAuditCertificateState">State*</label>
                                <div class="combo-input">
                                    <select id="iosAppVaptFirstAuditCertificateState" name="state" required onchange="toggleVaptOtherInput('iosAppVaptFirstAuditCertificateState', 'iosAppVaptFirstAuditCertificateOtherState')">
                                        <option value="">Select State</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                        <option value="Assam">Assam</option>
                                        <option value="Bihar">Bihar</option>
                                        <option value="Chhattisgarh">Chhattisgarh</option>
                                        <option value="Goa">Goa</option>
                                        <option value="Gujarat">Gujarat</option>
                                        <option value="Haryana">Haryana</option>
                                        <option value="Himachal Pradesh">Himachal Pradesh</option>
                                        <option value="Jharkhand">Jharkhand</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Kerala">Kerala</option>
                                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Manipur">Manipur</option>
                                        <option value="Meghalaya">Meghalaya</option>
                                        <option value="Mizoram">Mizoram</option>
                                        <option value="Nagaland">Nagaland</option>
                                        <option value="Odisha">Odisha</option>
                                        <option value="Punjab">Punjab</option>
                                        <option value="Rajasthan">Rajasthan</option>
                                        <option value="Sikkim">Sikkim</option>
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="Telangana">Telangana</option>
                                        <option value="Tripura">Tripura</option>
                                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                                        <option value="Uttarakhand">Uttarakhand</option>
                                        <option value="West Bengal">West Bengal</option>

                                        <!-- Union Territories -->
                                        <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                        <option value="Chandigarh">Chandigarh</option>
                                        <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                        <option value="Delhi">Delhi</option>
                                        <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                        <option value="Ladakh">Ladakh</option>
                                        <option value="Lakshadweep">Lakshadweep</option>
                                        <option value="Puducherry">Puducherry</option>

                                    </select>
                                    <input type="text" id="iosAppVaptFirstAuditCertificateOtherState" name="otherState" class="hidden" placeholder="Enter State Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="iosAppVaptFirstAuditCertificateAuditeeDesignation">Designation of the Auditee Person (Submitted To)*</label>
                                <input type="text" id="iosAppVaptFirstAuditCertificateAuditeeDesignation" name="auditeeDesignation" required placeholder="Enter auditee designation">
                            </div>

                            <div class="form-group">
                                <label for="iosAppVaptFirstAuditCertificateScope">Scope*</label>
                                <input type="text" id="iosAppVaptFirstAuditCertificateScope" name="scope" required placeholder="Enter scope details">
                            </div>

                            <div class="form-group">
                                <label for="iosAppVaptFirstAuditCertificateStartAuditDate">Start Audit Date*</label>
                                <input type="date" id="iosAppVaptFirstAuditCertificateStartAuditDate" name="startAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="iosAppVaptFirstAuditCertificateEndAuditDate">End Audit Date*</label>
                                <input type="date" id="iosAppVaptFirstAuditCertificateEndAuditDate" name="endAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="iosAppVaptFirstAuditCertificateReportId">Report ID*</label>
                                <input type="text" id="iosAppVaptFirstAuditCertificateReportId" name="reportId" required placeholder="Enter report ID">
                            </div>

                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('iosAppVaptFirstAuditCertificateModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Certificate</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Infrastructure VAPT Follow Up Audit Certificate Modal -->
            <div id="vaptFollowUpAuditCertificateModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Infrastructure VAPT Follow Up Audit Completion Certificate</h3>
                        <span class="close-modal" onclick="closeVaptModal('vaptFollowUpAuditCertificateModal')">&times;</span>
                    </div>
                    <div class="modal-body">
                        <form id="vaptFollowUpAuditCertificateForm" action="/process_vapt_follow_up_audit_certificate" method="POST">
                            <div class="form-group">
                                <label for="vaptFollowUpAuditCertificateOrganizationName">Organization Name*</label>
                                <div class="combo-input">
                                    <select id="vaptFollowUpAuditCertificateOrganizationName" name="organizationName" required onchange="toggleVaptOtherInput('vaptFollowUpAuditCertificateOrganizationName', 'vaptFollowUpAuditCertificateOtherOrganizationName')">
                                        <option value="">Select Organization</option>
                                        <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                        <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                        <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                        <option value="Megasoft Limited">Megasoft Limited</option>
                                        <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                        <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                        <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                        <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                        <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                        <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                        <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                        <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                        <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                        <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                        <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                        <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                        <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                        <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                        <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                        <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                        <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                        <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                        <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                        <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                        <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                        <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                        <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                        <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                        <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                        <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                        <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                        <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                        <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                        <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                        <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                        <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                        <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                        <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                        <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                        <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                        
                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="vaptFollowUpAuditCertificateOtherOrganizationName" name="otherOrganizationName" class="hidden" placeholder="Enter Organization Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="vaptFollowUpAuditCertificateCity">City*</label>
                                <div class="combo-input">
                                    <select id="vaptFollowUpAuditCertificateCity" name="city" required onchange="toggleVaptOtherInput('vaptFollowUpAuditCertificateCity', 'vaptFollowUpAuditCertificateOtherCity')">
                                        <option value="">Select City</option>
                                        <!-- Gujarat -->
                                        <option value="Ahmedabad">Ahmedabad</option>
                                        <option value="Amreli">Amreli</option>
                                        <option value="Anand">Anand</option>
                                        <option value="Aravalli">Aravalli</option>
                                        <option value="Banaskantha">Banaskantha</option>
                                        <option value="Bharuch">Bharuch</option>
                                        <option value="Bhavnagar">Bhavnagar</option>
                                        <option value="Botad">Botad</option>
                                        <option value="Chhota Udaipur">Chhota Udaipur</option>
                                        <option value="Dahod">Dahod</option>
                                        <option value="Dang">Dang</option>
                                        <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                        <option value="Gandhinagar">Gandhinagar</option>
                                        <option value="Gir Somnath">Gir Somnath</option>
                                        <option value="Jamnagar">Jamnagar</option>
                                        <option value="Junagadh">Junagadh</option>
                                        <option value="Kheda">Kheda</option>
                                        <option value="Kutch">Kutch</option>
                                        <option value="Mahisagar">Mahisagar</option>
                                        <option value="Mehsana">Mehsana</option>
                                        <option value="Morbi">Morbi</option>
                                        <option value="Narmada">Narmada</option>
                                        <option value="Navsari">Navsari</option>
                                        <option value="Patan">Patan</option>
                                        <option value="Panchmahal">Panchmahal</option>
                                        <option value="Porbandar">Porbandar</option>
                                        <option value="Rajkot">Rajkot</option>
                                        <option value="Sabarkantha">Sabarkantha</option>
                                        <option value="Surat">Surat</option>
                                        <option value="Surendranagar">Surendranagar</option>
                                        <option value="Tapi">Tapi</option>
                                        <option value="Vadodara">Vadodara</option>
                                        <option value="Valsad">Valsad</option>

                                        <!-- Rajasthan -->
                                        <option value="Ajmer">Ajmer</option>
                                        <option value="Alwar">Alwar</option>
                                        <option value="Banswara">Banswara</option>
                                        <option value="Baran">Baran</option>
                                        <option value="Barmer">Barmer</option>
                                        <option value="Bharatpur">Bharatpur</option>
                                        <option value="Bhilwara">Bhilwara</option>
                                        <option value="Bikaner">Bikaner</option>
                                        <option value="Bundi">Bundi</option>
                                        <option value="Chittorgarh">Chittorgarh</option>
                                        <option value="Churu">Churu</option>
                                        <option value="Dausa">Dausa</option>
                                        <option value="Dholpur">Dholpur</option>
                                        <option value="Dungarpur">Dungarpur</option>
                                        <option value="Hanumangarh">Hanumangarh</option>
                                        <option value="Jaipur">Jaipur</option>
                                        <option value="Jaisalmer">Jaisalmer</option>
                                        <option value="Jalore">Jalore</option>
                                        <option value="Jhalawar">Jhalawar</option>
                                        <option value="Jhunjhunu">Jhunjhunu</option>
                                        <option value="Jodhpur">Jodhpur</option>
                                        <option value="Karauli">Karauli</option>
                                        <option value="Kota">Kota</option>
                                        <option value="Nagaur">Nagaur</option>
                                        <option value="Pali">Pali</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rajsamand">Rajsamand</option>
                                        <option value="Sikar">Sikar</option>
                                        <option value="Sirohi">Sirohi</option>
                                        <option value="Sri Ganganagar">Sri Ganganagar</option>
                                        <option value="Tonk">Tonk</option>
                                        <option value="Udaipur">Udaipur</option>

                                        <!-- Maharashtra -->
                                        <option value="Ahmednagar">Ahmednagar</option>
                                        <option value="Akola">Akola</option>
                                        <option value="Amravati">Amravati</option>
                                        <option value="Aurangabad">Aurangabad</option>
                                        <option value="Beed">Beed</option>
                                        <option value="Bhandara">Bhandara</option>
                                        <option value="Chandrapur">Chandrapur</option>
                                        <option value="Dhule">Dhule</option>
                                        <option value="Gadchiroli">Gadchiroli</option>
                                        <option value="Gondia">Gondia</option>
                                        <option value="Hingoli">Hingoli</option>
                                        <option value="Jalgaon">Jalgaon</option>
                                        <option value="Jalna">Jalna</option>
                                        <option value="Kolhapur">Kolhapur</option>
                                        <option value="Latur">Latur</option>
                                        <option value="Mumbai City">Mumbai City</option>
                                        <option value="Mumbai Suburban">Mumbai Suburban</option>
                                        <option value="Nagpur">Nagpur</option>
                                        <option value="Nanded">Nanded</option>
                                        <option value="Nandurbar">Nandurbar</option>
                                        <option value="Nashik">Nashik</option>
                                        <option value="Osmanabad">Osmanabad</option>
                                        <option value="Palghar">Palghar</option>
                                        <option value="Parbhani">Parbhani</option>
                                        <option value="Pune">Pune</option>
                                        <option value="Raigad">Raigad</option>
                                        <option value="Ratnagiri">Ratnagiri</option>
                                        <option value="Sangli">Sangli</option>
                                        <option value="Satara">Satara</option>
                                        <option value="Sindhudurg">Sindhudurg</option>
                                        <option value="Solapur">Solapur</option>
                                        <option value="Thane">Thane</option>
                                        <option value="Wardha">Wardha</option>
                                        <option value="Washim">Washim</option>
                                        <option value="Yavatmal">Yavatmal</option>

                                        <!-- Uttar Pradesh -->
                                        <option value="Agra">Agra</option>
                                        <option value="Aligarh">Aligarh</option>
                                        <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                        <option value="Amethi">Amethi</option>
                                        <option value="Amroha">Amroha</option>
                                        <option value="Auraiya">Auraiya</option>
                                        <option value="Ayodhya">Ayodhya</option>
                                        <option value="Azamgarh">Azamgarh</option>
                                        <option value="Bagpat">Bagpat</option>
                                        <option value="Bahraich">Bahraich</option>
                                        <option value="Ballia">Ballia</option>
                                        <option value="Balrampur">Balrampur</option>
                                        <option value="Banda">Banda</option>
                                        <option value="Barabanki">Barabanki</option>
                                        <option value="Bareilly">Bareilly</option>
                                        <option value="Basti">Basti</option>
                                        <option value="Bhadohi">Bhadohi</option>
                                        <option value="Bijnor">Bijnor</option>
                                        <option value="Bulandshahr">Bulandshahr</option>
                                        <option value="Chandauli">Chandauli</option>
                                        <option value="Chitrakoot">Chitrakoot</option>
                                        <option value="Deoria">Deoria</option>
                                        <option value="Etah">Etah</option>
                                        <option value="Etawah">Etawah</option>
                                        <option value="Farrukhabad">Farrukhabad</option>
                                        <option value="Fatehpur">Fatehpur</option>
                                        <option value="Firozabad">Firozabad</option>
                                        <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                        <option value="Ghaziabad">Ghaziabad</option>
                                        <option value="Ghazipur">Ghazipur</option>
                                        <option value="Gonda">Gonda</option>
                                        <option value="Gorakhpur">Gorakhpur</option>
                                        <option value="Hamirpur">Hamirpur</option>
                                        <option value="Hapur">Hapur</option>
                                        <option value="Hardoi">Hardoi</option>
                                        <option value="Hathras">Hathras</option>
                                        <option value="Jalaun">Jalaun</option>
                                        <option value="Jaunpur">Jaunpur</option>
                                        <option value="Jhansi">Jhansi</option>
                                        <option value="Kannauj">Kannauj</option>
                                        <option value="Kanpur Dehat">Kanpur Dehat</option>
                                        <option value="Kanpur Nagar">Kanpur Nagar</option>
                                        <option value="Kasganj">Kasganj</option>
                                        <option value="Kaushambi">Kaushambi</option>
                                        <option value="Kushinagar">Kushinagar</option>
                                        <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                        <option value="Lalitpur">Lalitpur</option>
                                        <option value="Lucknow">Lucknow</option>
                                        <option value="Maharajganj">Maharajganj</option>
                                        <option value="Mahoba">Mahoba</option>
                                        <option value="Mainpuri">Mainpuri</option>
                                        <option value="Mathura">Mathura</option>
                                        <option value="Mau">Mau</option>
                                        <option value="Meerut">Meerut</option>
                                        <option value="Mirzapur">Mirzapur</option>
                                        <option value="Moradabad">Moradabad</option>
                                        <option value="Muzaffarnagar">Muzaffarnagar</option>
                                        <option value="Pilibhit">Pilibhit</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rae Bareli">Rae Bareli</option>
                                        <option value="Rampur">Rampur</option>
                                        <option value="Saharanpur">Saharanpur</option>
                                        <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                        <option value="Shahjahanpur">Shahjahanpur</option>
                                        <option value="Shravasti">Shravasti</option>
                                        <option value="Siddharthnagar">Siddharthnagar</option>
                                        <option value="Sitapur">Sitapur</option>
                                        <option value="Sonbhadra">Sonbhadra</option>
                                        <option value="Sultanpur">Sultanpur</option>
                                        <option value="Unnao">Unnao</option>
                                        <option value="Varanasi">Varanasi</option>

                                        <!-- Uttarakhand -->
                                        <option value="Almora">Almora</option>
                                        <option value="Bageshwar">Bageshwar</option>
                                        <option value="Chamoli">Chamoli</option>
                                        <option value="Champawat">Champawat</option>
                                        <option value="Dehradun">Dehradun</option>
                                        <option value="Haridwar">Haridwar</option>
                                        <option value="Nainital">Nainital</option>
                                        <option value="Pauri Garhwal">Pauri Garhwal</option>
                                        <option value="Pithoragarh">Pithoragarh</option>
                                        <option value="Rudraprayag">Rudraprayag</option>
                                        <option value="Tehri Garhwal">Tehri Garhwal</option>
                                        <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                        <option value="Uttarkashi">Uttarkashi</option>

                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="vaptFollowUpAuditCertificateOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="vaptFollowUpAuditCertificateState">State*</label>
                                <div class="combo-input">
                                    <select id="vaptFollowUpAuditCertificateState" name="state" required onchange="toggleVaptOtherInput('vaptFollowUpAuditCertificateState', 'vaptFollowUpAuditCertificateOtherState')">
                                        <option value="">Select State</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                        <option value="Assam">Assam</option>
                                        <option value="Bihar">Bihar</option>
                                        <option value="Chhattisgarh">Chhattisgarh</option>
                                        <option value="Goa">Goa</option>
                                        <option value="Gujarat">Gujarat</option>
                                        <option value="Haryana">Haryana</option>
                                        <option value="Himachal Pradesh">Himachal Pradesh</option>
                                        <option value="Jharkhand">Jharkhand</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Kerala">Kerala</option>
                                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Manipur">Manipur</option>
                                        <option value="Meghalaya">Meghalaya</option>
                                        <option value="Mizoram">Mizoram</option>
                                        <option value="Nagaland">Nagaland</option>
                                        <option value="Odisha">Odisha</option>
                                        <option value="Punjab">Punjab</option>
                                        <option value="Rajasthan">Rajasthan</option>
                                        <option value="Sikkim">Sikkim</option>
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="Telangana">Telangana</option>
                                        <option value="Tripura">Tripura</option>
                                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                                        <option value="Uttarakhand">Uttarakhand</option>
                                        <option value="West Bengal">West Bengal</option>

                                        <!-- Union Territories -->
                                        <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                        <option value="Chandigarh">Chandigarh</option>
                                        <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                        <option value="Delhi">Delhi</option>
                                        <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                        <option value="Ladakh">Ladakh</option>
                                        <option value="Lakshadweep">Lakshadweep</option>
                                        <option value="Puducherry">Puducherry</option>

                                    </select>
                                    <input type="text" id="vaptFollowUpAuditCertificateOtherState" name="otherState" class="hidden" placeholder="Enter State Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="vaptFollowUpAuditCertificateAuditeeDesignation">Designation of the Auditee Person (Submitted To)*</label>
                                <input type="text" id="vaptFollowUpAuditCertificateAuditeeDesignation" name="auditeeDesignation" required placeholder="Enter auditee designation">
                            </div>

                            <div class="form-group">
                                <label for="vaptFollowUpAuditCertificateScope">Scope*</label>
                                <input type="text" id="vaptFollowUpAuditCertificateScope" name="scope" required placeholder="Enter scope details">
                            </div>

                            <div class="form-group">
                                <label for="vaptFollowUpAuditCertificateStartAuditDate">Start Audit Date*</label>
                                <input type="date" id="vaptFollowUpAuditCertificateStartAuditDate" name="startAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="vaptFollowUpAuditCertificateEndAuditDate">End Audit Date*</label>
                                <input type="date" id="vaptFollowUpAuditCertificateEndAuditDate" name="endAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="vaptFollowUpAuditCertificateFirstReportId">First Audit Report ID*</label>
                                <input type="text" id="vaptFollowUpAuditCertificateFirstReportId" name="firstReportId" required placeholder="Enter first audit report ID">
                            </div>

                            <div class="form-group">
                                <label for="vaptFollowUpAuditCertificateReportId">Report ID*</label>
                                <input type="text" id="vaptFollowUpAuditCertificateReportId" name="reportId" required placeholder="Enter report ID">
                            </div>

                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('vaptFollowUpAuditCertificateModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Certificate</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- API VAPT First Audit Completion Certificate Modal -->
            <div id="apiVaptFirstAuditCertificateModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>API VAPT First Audit Completion Certificate</h3>
                        <span class="close-modal" onclick="closeVaptModal('apiVaptFirstAuditCertificateModal')">&times;</span>
                    </div>
                    <div class="modal-body">
                        <form id="apiVaptFirstAuditCertificateForm" action="/process_api_vapt_first_audit_certificate" method="POST">
                            <div class="form-group">
                                <label for="apiVaptFirstAuditCertificateOrganizationName">Organization Name*</label>
                                <div class="combo-input">
                                    <select id="apiVaptFirstAuditCertificateOrganizationName" name="organizationName" required onchange="toggleVaptOtherInput('apiVaptFirstAuditCertificateOrganizationName', 'apiVaptFirstAuditCertificateOtherOrganizationName')">
                                        <option value="">Select Organization</option>
                                        <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                        <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                        <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                        <option value="Megasoft Limited">Megasoft Limited</option>
                                        <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                        <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                        <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                        <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                        <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                        <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                        <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                        <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                        <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                        <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                        <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                        <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                        <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                        <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                        <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                        <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                        <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                        <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                        <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                        <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                        <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                        <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                        <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                        <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                        <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                        <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                        <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                        <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                        <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                        <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                        <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                        <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                        <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                        <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                        <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                        <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                        
                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="apiVaptFirstAuditCertificateOtherOrganizationName" name="otherOrganizationName" class="hidden" placeholder="Enter Organization Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="apiVaptFirstAuditCertificateCity">City*</label>
                                <div class="combo-input">
                                    <select id="apiVaptFirstAuditCertificateCity" name="city" required onchange="toggleVaptOtherInput('apiVaptFirstAuditCertificateCity', 'apiVaptFirstAuditCertificateOtherCity')">
                                        <option value="">Select City</option>
                                        <!-- Gujarat -->
                                        <option value="Ahmedabad">Ahmedabad</option>
                                        <option value="Amreli">Amreli</option>
                                        <option value="Anand">Anand</option>
                                        <option value="Aravalli">Aravalli</option>
                                        <option value="Banaskantha">Banaskantha</option>
                                        <option value="Bharuch">Bharuch</option>
                                        <option value="Bhavnagar">Bhavnagar</option>
                                        <option value="Botad">Botad</option>
                                        <option value="Chhota Udaipur">Chhota Udaipur</option>
                                        <option value="Dahod">Dahod</option>
                                        <option value="Dang">Dang</option>
                                        <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                        <option value="Gandhinagar">Gandhinagar</option>
                                        <option value="Gir Somnath">Gir Somnath</option>
                                        <option value="Jamnagar">Jamnagar</option>
                                        <option value="Junagadh">Junagadh</option>
                                        <option value="Kheda">Kheda</option>
                                        <option value="Kutch">Kutch</option>
                                        <option value="Mahisagar">Mahisagar</option>
                                        <option value="Mehsana">Mehsana</option>
                                        <option value="Morbi">Morbi</option>
                                        <option value="Narmada">Narmada</option>
                                        <option value="Navsari">Navsari</option>
                                        <option value="Patan">Patan</option>
                                        <option value="Panchmahal">Panchmahal</option>
                                        <option value="Porbandar">Porbandar</option>
                                        <option value="Rajkot">Rajkot</option>
                                        <option value="Sabarkantha">Sabarkantha</option>
                                        <option value="Surat">Surat</option>
                                        <option value="Surendranagar">Surendranagar</option>
                                        <option value="Tapi">Tapi</option>
                                        <option value="Vadodara">Vadodara</option>
                                        <option value="Valsad">Valsad</option>

                                        <!-- Rajasthan -->
                                        <option value="Ajmer">Ajmer</option>
                                        <option value="Alwar">Alwar</option>
                                        <option value="Banswara">Banswara</option>
                                        <option value="Baran">Baran</option>
                                        <option value="Barmer">Barmer</option>
                                        <option value="Bharatpur">Bharatpur</option>
                                        <option value="Bhilwara">Bhilwara</option>
                                        <option value="Bikaner">Bikaner</option>
                                        <option value="Bundi">Bundi</option>
                                        <option value="Chittorgarh">Chittorgarh</option>
                                        <option value="Churu">Churu</option>
                                        <option value="Dausa">Dausa</option>
                                        <option value="Dholpur">Dholpur</option>
                                        <option value="Dungarpur">Dungarpur</option>
                                        <option value="Hanumangarh">Hanumangarh</option>
                                        <option value="Jaipur">Jaipur</option>
                                        <option value="Jaisalmer">Jaisalmer</option>
                                        <option value="Jalore">Jalore</option>
                                        <option value="Jhalawar">Jhalawar</option>
                                        <option value="Jhunjhunu">Jhunjhunu</option>
                                        <option value="Jodhpur">Jodhpur</option>
                                        <option value="Karauli">Karauli</option>
                                        <option value="Kota">Kota</option>
                                        <option value="Nagaur">Nagaur</option>
                                        <option value="Pali">Pali</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rajsamand">Rajsamand</option>
                                        <option value="Sikar">Sikar</option>
                                        <option value="Sirohi">Sirohi</option>
                                        <option value="Sri Ganganagar">Sri Ganganagar</option>
                                        <option value="Tonk">Tonk</option>
                                        <option value="Udaipur">Udaipur</option>

                                        <!-- Maharashtra -->
                                        <option value="Ahmednagar">Ahmednagar</option>
                                        <option value="Akola">Akola</option>
                                        <option value="Amravati">Amravati</option>
                                        <option value="Aurangabad">Aurangabad</option>
                                        <option value="Beed">Beed</option>
                                        <option value="Bhandara">Bhandara</option>
                                        <option value="Chandrapur">Chandrapur</option>
                                        <option value="Dhule">Dhule</option>
                                        <option value="Gadchiroli">Gadchiroli</option>
                                        <option value="Gondia">Gondia</option>
                                        <option value="Hingoli">Hingoli</option>
                                        <option value="Jalgaon">Jalgaon</option>
                                        <option value="Jalna">Jalna</option>
                                        <option value="Kolhapur">Kolhapur</option>
                                        <option value="Latur">Latur</option>
                                        <option value="Mumbai City">Mumbai City</option>
                                        <option value="Mumbai Suburban">Mumbai Suburban</option>
                                        <option value="Nagpur">Nagpur</option>
                                        <option value="Nanded">Nanded</option>
                                        <option value="Nandurbar">Nandurbar</option>
                                        <option value="Nashik">Nashik</option>
                                        <option value="Osmanabad">Osmanabad</option>
                                        <option value="Palghar">Palghar</option>
                                        <option value="Parbhani">Parbhani</option>
                                        <option value="Pune">Pune</option>
                                        <option value="Raigad">Raigad</option>
                                        <option value="Ratnagiri">Ratnagiri</option>
                                        <option value="Sangli">Sangli</option>
                                        <option value="Satara">Satara</option>
                                        <option value="Sindhudurg">Sindhudurg</option>
                                        <option value="Solapur">Solapur</option>
                                        <option value="Thane">Thane</option>
                                        <option value="Wardha">Wardha</option>
                                        <option value="Washim">Washim</option>
                                        <option value="Yavatmal">Yavatmal</option>

                                        <!-- Uttar Pradesh -->
                                        <option value="Agra">Agra</option>
                                        <option value="Aligarh">Aligarh</option>
                                        <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                        <option value="Amethi">Amethi</option>
                                        <option value="Amroha">Amroha</option>
                                        <option value="Auraiya">Auraiya</option>
                                        <option value="Ayodhya">Ayodhya</option>
                                        <option value="Azamgarh">Azamgarh</option>
                                        <option value="Bagpat">Bagpat</option>
                                        <option value="Bahraich">Bahraich</option>
                                        <option value="Ballia">Ballia</option>
                                        <option value="Balrampur">Balrampur</option>
                                        <option value="Banda">Banda</option>
                                        <option value="Barabanki">Barabanki</option>
                                        <option value="Bareilly">Bareilly</option>
                                        <option value="Basti">Basti</option>
                                        <option value="Bhadohi">Bhadohi</option>
                                        <option value="Bijnor">Bijnor</option>
                                        <option value="Bulandshahr">Bulandshahr</option>
                                        <option value="Chandauli">Chandauli</option>
                                        <option value="Chitrakoot">Chitrakoot</option>
                                        <option value="Deoria">Deoria</option>
                                        <option value="Etah">Etah</option>
                                        <option value="Etawah">Etawah</option>
                                        <option value="Farrukhabad">Farrukhabad</option>
                                        <option value="Fatehpur">Fatehpur</option>
                                        <option value="Firozabad">Firozabad</option>
                                        <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                        <option value="Ghaziabad">Ghaziabad</option>
                                        <option value="Ghazipur">Ghazipur</option>
                                        <option value="Gonda">Gonda</option>
                                        <option value="Gorakhpur">Gorakhpur</option>
                                        <option value="Hamirpur">Hamirpur</option>
                                        <option value="Hapur">Hapur</option>
                                        <option value="Hardoi">Hardoi</option>
                                        <option value="Hathras">Hathras</option>
                                        <option value="Jalaun">Jalaun</option>
                                        <option value="Jaunpur">Jaunpur</option>
                                        <option value="Jhansi">Jhansi</option>
                                        <option value="Kannauj">Kannauj</option>
                                        <option value="Kanpur Dehat">Kanpur Dehat</option>
                                        <option value="Kanpur Nagar">Kanpur Nagar</option>
                                        <option value="Kasganj">Kasganj</option>
                                        <option value="Kaushambi">Kaushambi</option>
                                        <option value="Kushinagar">Kushinagar</option>
                                        <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                        <option value="Lalitpur">Lalitpur</option>
                                        <option value="Lucknow">Lucknow</option>
                                        <option value="Maharajganj">Maharajganj</option>
                                        <option value="Mahoba">Mahoba</option>
                                        <option value="Mainpuri">Mainpuri</option>
                                        <option value="Mathura">Mathura</option>
                                        <option value="Mau">Mau</option>
                                        <option value="Meerut">Meerut</option>
                                        <option value="Mirzapur">Mirzapur</option>
                                        <option value="Moradabad">Moradabad</option>
                                        <option value="Muzaffarnagar">Muzaffarnagar</option>
                                        <option value="Pilibhit">Pilibhit</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rae Bareli">Rae Bareli</option>
                                        <option value="Rampur">Rampur</option>
                                        <option value="Saharanpur">Saharanpur</option>
                                        <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                        <option value="Shahjahanpur">Shahjahanpur</option>
                                        <option value="Shravasti">Shravasti</option>
                                        <option value="Siddharthnagar">Siddharthnagar</option>
                                        <option value="Sitapur">Sitapur</option>
                                        <option value="Sonbhadra">Sonbhadra</option>
                                        <option value="Sultanpur">Sultanpur</option>
                                        <option value="Unnao">Unnao</option>
                                        <option value="Varanasi">Varanasi</option>

                                        <!-- Uttarakhand -->
                                        <option value="Uttarkashi">Uttarkashi</option>

                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="websiteVaptFollowUpAuditCertificateOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpAuditCertificateState">State*</label>
                                <div class="combo-input">
                                    <select id="websiteVaptFollowUpAuditCertificateState" name="state" required onchange="toggleVaptOtherInput('websiteVaptFollowUpAuditCertificateState', 'websiteVaptFollowUpAuditCertificateOtherState')">
                                        <option value="">Select State</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                        <option value="Assam">Assam</option>
                                        <option value="Bihar">Bihar</option>
                                        <option value="Chhattisgarh">Chhattisgarh</option>
                                        <option value="Goa">Goa</option>
                                        <option value="Gujarat">Gujarat</option>
                                        <option value="Haryana">Haryana</option>
                                        <option value="Himachal Pradesh">Himachal Pradesh</option>
                                        <option value="Jharkhand">Jharkhand</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Kerala">Kerala</option>
                                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Manipur">Manipur</option>
                                        <option value="Meghalaya">Meghalaya</option>
                                        <option value="Mizoram">Mizoram</option>
                                        <option value="Nagaland">Nagaland</option>
                                        <option value="Odisha">Odisha</option>
                                        <option value="Punjab">Punjab</option>
                                        <option value="Rajasthan">Rajasthan</option>
                                        <option value="Sikkim">Sikkim</option>
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="Telangana">Telangana</option>
                                        <option value="Tripura">Tripura</option>
                                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                                        <option value="Uttarakhand">Uttarakhand</option>
                                        <option value="West Bengal">West Bengal</option>

                                        <!-- Union Territories -->
                                        <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                        <option value="Chandigarh">Chandigarh</option>
                                        <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                        <option value="Delhi">Delhi</option>
                                        <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                        <option value="Ladakh">Ladakh</option>
                                        <option value="Lakshadweep">Lakshadweep</option>
                                        <option value="Puducherry">Puducherry</option>

                                    </select>
                                    <input type="text" id="websiteVaptFollowUpAuditCertificateOtherState" name="otherState" class="hidden" placeholder="Enter State Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpAuditCertificateAuditeeDesignation">Designation of the Auditee Person (Submitted To)*</label>
                                <input type="text" id="websiteVaptFollowUpAuditCertificateAuditeeDesignation" name="auditeeDesignation" required placeholder="Enter auditee designation">
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpAuditCertificateScope">Scope*</label>
                                <input type="text" id="websiteVaptFollowUpAuditCertificateScope" name="scope" required placeholder="Enter scope details">
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpAuditCertificateStartAuditDate">Start Audit Date*</label>
                                <input type="date" id="websiteVaptFollowUpAuditCertificateStartAuditDate" name="startAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpAuditCertificateEndAuditDate">End Audit Date*</label>
                                <input type="date" id="websiteVaptFollowUpAuditCertificateEndAuditDate" name="endAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpAuditCertificateReportId">Report ID*</label>
                                <input type="text" id="websiteVaptFollowUpAuditCertificateReportId" name="reportId" required placeholder="Enter report ID">
                            </div>

                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('websiteVaptFollowUpAuditCertificateModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Certificate</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- API VAPT Follow Up Audit Completion Certificate Modal -->
            <div id="apiVaptFollowUpAuditCertificateModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>API VAPT Follow Up Audit Completion Certificate</h3>
                        <span class="close-modal" onclick="closeVaptModal('apiVaptFollowUpAuditCertificateModal')">&times;</span>
                    </div>
                    <div class="modal-body">
                        <form id="apiVaptFollowUpAuditCertificateForm" action="/process_api_vapt_follow_up_audit_certificate" method="POST">
                            <div class="form-group">
                                <label for="apiVaptFollowUpAuditCertificateOrganizationName">Organization Name*</label>
                                <div class="combo-input">
                                    <select id="apiVaptFollowUpAuditCertificateOrganizationName" name="organizationName" required onchange="toggleVaptOtherInput('apiVaptFollowUpAuditCertificateOrganizationName', 'apiVaptFollowUpAuditCertificateOtherOrganizationName')">
                                        <option value="">Select Organization</option>
                                        <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                        <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                        <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                        <option value="Megasoft Limited">Megasoft Limited</option>
                                        <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                        <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                        <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                        <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                        <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                        <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                        <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                        <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                        <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                        <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                        <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                        <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                        <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                        <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                        <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                        <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                        <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                        <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                        <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                        <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                        <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                        <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                        <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                        <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                        <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                        <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                        <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                        <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                        <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                        <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                        <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                        <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                        <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                        <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                        <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                        <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                        
                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="apiVaptFollowUpAuditCertificateOtherOrganizationName" name="otherOrganizationName" class="hidden" placeholder="Enter Organization Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="apiVaptFollowUpAuditCertificateCity">City*</label>
                                <div class="combo-input">
                                    <select id="apiVaptFollowUpAuditCertificateCity" name="city" required onchange="toggleVaptOtherInput('apiVaptFollowUpAuditCertificateCity', 'apiVaptFollowUpAuditCertificateOtherCity')">
                                        <option value="">Select City</option>
                                        <!-- Gujarat -->
                                        <option value="Ahmedabad">Ahmedabad</option>
                                        <option value="Amreli">Amreli</option>
                                        <option value="Anand">Anand</option>
                                        <option value="Aravalli">Aravalli</option>
                                        <option value="Banaskantha">Banaskantha</option>
                                        <option value="Bharuch">Bharuch</option>
                                        <option value="Bhavnagar">Bhavnagar</option>
                                        <option value="Botad">Botad</option>
                                        <option value="Chhota Udaipur">Chhota Udaipur</option>
                                        <option value="Dahod">Dahod</option>
                                        <option value="Dang">Dang</option>
                                        <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                        <option value="Gandhinagar">Gandhinagar</option>
                                        <option value="Gir Somnath">Gir Somnath</option>
                                        <option value="Jamnagar">Jamnagar</option>
                                        <option value="Junagadh">Junagadh</option>
                                        <option value="Kheda">Kheda</option>
                                        <option value="Kutch">Kutch</option>
                                        <option value="Mahisagar">Mahisagar</option>
                                        <option value="Mehsana">Mehsana</option>
                                        <option value="Morbi">Morbi</option>
                                        <option value="Narmada">Narmada</option>
                                        <option value="Navsari">Navsari</option>
                                        <option value="Patan">Patan</option>
                                        <option value="Panchmahal">Panchmahal</option>
                                        <option value="Porbandar">Porbandar</option>
                                        <option value="Rajkot">Rajkot</option>
                                        <option value="Sabarkantha">Sabarkantha</option>
                                        <option value="Surat">Surat</option>
                                        <option value="Surendranagar">Surendranagar</option>
                                        <option value="Tapi">Tapi</option>
                                        <option value="Vadodara">Vadodara</option>
                                        <option value="Valsad">Valsad</option>

                                        <!-- Rajasthan -->
                                        <option value="Ajmer">Ajmer</option>
                                        <option value="Alwar">Alwar</option>
                                        <option value="Banswara">Banswara</option>
                                        <option value="Baran">Baran</option>
                                        <option value="Barmer">Barmer</option>
                                        <option value="Bharatpur">Bharatpur</option>
                                        <option value="Bhilwara">Bhilwara</option>
                                        <option value="Bikaner">Bikaner</option>
                                        <option value="Bundi">Bundi</option>
                                        <option value="Chittorgarh">Chittorgarh</option>
                                        <option value="Churu">Churu</option>
                                        <option value="Dausa">Dausa</option>
                                        <option value="Dholpur">Dholpur</option>
                                        <option value="Dungarpur">Dungarpur</option>
                                        <option value="Hanumangarh">Hanumangarh</option>
                                        <option value="Jaipur">Jaipur</option>
                                        <option value="Jaisalmer">Jaisalmer</option>
                                        <option value="Jalore">Jalore</option>
                                        <option value="Jhalawar">Jhalawar</option>
                                        <option value="Jhunjhunu">Jhunjhunu</option>
                                        <option value="Jodhpur">Jodhpur</option>
                                        <option value="Karauli">Karauli</option>
                                        <option value="Kota">Kota</option>
                                        <option value="Nagaur">Nagaur</option>
                                        <option value="Pali">Pali</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rajsamand">Rajsamand</option>
                                        <option value="Sikar">Sikar</option>
                                        <option value="Sirohi">Sirohi</option>
                                        <option value="Sri Ganganagar">Sri Ganganagar</option>
                                        <option value="Tonk">Tonk</option>
                                        <option value="Udaipur">Udaipur</option>

                                        <!-- Maharashtra -->
                                        <option value="Ahmednagar">Ahmednagar</option>
                                        <option value="Akola">Akola</option>
                                        <option value="Amravati">Amravati</option>
                                        <option value="Aurangabad">Aurangabad</option>
                                        <option value="Beed">Beed</option>
                                        <option value="Bhandara">Bhandara</option>
                                        <option value="Chandrapur">Chandrapur</option>
                                        <option value="Dhule">Dhule</option>
                                        <option value="Gadchiroli">Gadchiroli</option>
                                        <option value="Gondia">Gondia</option>
                                        <option value="Hingoli">Hingoli</option>
                                        <option value="Jalgaon">Jalgaon</option>
                                        <option value="Jalna">Jalna</option>
                                        <option value="Kolhapur">Kolhapur</option>
                                        <option value="Latur">Latur</option>
                                        <option value="Mumbai City">Mumbai City</option>
                                        <option value="Mumbai Suburban">Mumbai Suburban</option>
                                        <option value="Nagpur">Nagpur</option>
                                        <option value="Nanded">Nanded</option>
                                        <option value="Nandurbar">Nandurbar</option>
                                        <option value="Nashik">Nashik</option>
                                        <option value="Osmanabad">Osmanabad</option>
                                        <option value="Palghar">Palghar</option>
                                        <option value="Parbhani">Parbhani</option>
                                        <option value="Pune">Pune</option>
                                        <option value="Raigad">Raigad</option>
                                        <option value="Ratnagiri">Ratnagiri</option>
                                        <option value="Sangli">Sangli</option>
                                        <option value="Satara">Satara</option>
                                        <option value="Sindhudurg">Sindhudurg</option>
                                        <option value="Solapur">Solapur</option>
                                        <option value="Thane">Thane</option>
                                        <option value="Wardha">Wardha</option>
                                        <option value="Washim">Washim</option>
                                        <option value="Yavatmal">Yavatmal</option>

                                        <!-- Uttar Pradesh -->
                                        <option value="Agra">Agra</option>
                                        <option value="Aligarh">Aligarh</option>
                                        <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                        <option value="Amethi">Amethi</option>
                                        <option value="Amroha">Amroha</option>
                                        <option value="Auraiya">Auraiya</option>
                                        <option value="Ayodhya">Ayodhya</option>
                                        <option value="Azamgarh">Azamgarh</option>
                                        <option value="Bagpat">Bagpat</option>
                                        <option value="Bahraich">Bahraich</option>
                                        <option value="Ballia">Ballia</option>
                                        <option value="Balrampur">Balrampur</option>
                                        <option value="Banda">Banda</option>
                                        <option value="Barabanki">Barabanki</option>
                                        <option value="Bareilly">Bareilly</option>
                                        <option value="Basti">Basti</option>
                                        <option value="Bhadohi">Bhadohi</option>
                                        <option value="Bijnor">Bijnor</option>
                                        <option value="Bulandshahr">Bulandshahr</option>
                                        <option value="Chandauli">Chandauli</option>
                                        <option value="Chitrakoot">Chitrakoot</option>
                                        <option value="Deoria">Deoria</option>
                                        <option value="Etah">Etah</option>
                                        <option value="Etawah">Etawah</option>
                                        <option value="Farrukhabad">Farrukhabad</option>
                                        <option value="Fatehpur">Fatehpur</option>
                                        <option value="Firozabad">Firozabad</option>
                                        <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                        <option value="Ghaziabad">Ghaziabad</option>
                                        <option value="Ghazipur">Ghazipur</option>
                                        <option value="Gonda">Gonda</option>
                                        <option value="Gorakhpur">Gorakhpur</option>
                                        <option value="Hamirpur">Hamirpur</option>
                                        <option value="Hapur">Hapur</option>
                                        <option value="Hardoi">Hardoi</option>
                                        <option value="Hathras">Hathras</option>
                                        <option value="Jalaun">Jalaun</option>
                                        <option value="Jaunpur">Jaunpur</option>
                                        <option value="Jhansi">Jhansi</option>
                                        <option value="Kannauj">Kannauj</option>
                                        <option value="Kanpur Dehat">Kanpur Dehat</option>
                                        <option value="Kanpur Nagar">Kanpur Nagar</option>
                                        <option value="Kasganj">Kasganj</option>
                                        <option value="Kaushambi">Kaushambi</option>
                                        <option value="Kushinagar">Kushinagar</option>
                                        <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                        <option value="Lalitpur">Lalitpur</option>
                                        <option value="Lucknow">Lucknow</option>
                                        <option value="Maharajganj">Maharajganj</option>
                                        <option value="Mahoba">Mahoba</option>
                                        <option value="Mainpuri">Mainpuri</option>
                                        <option value="Mathura">Mathura</option>
                                        <option value="Mau">Mau</option>
                                        <option value="Meerut">Meerut</option>
                                        <option value="Mirzapur">Mirzapur</option>
                                        <option value="Moradabad">Moradabad</option>
                                        <option value="Muzaffarnagar">Muzaffarnagar</option>
                                        <option value="Pilibhit">Pilibhit</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rae Bareli">Rae Bareli</option>
                                        <option value="Rampur">Rampur</option>
                                        <option value="Saharanpur">Saharanpur</option>
                                        <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                        <option value="Shahjahanpur">Shahjahanpur</option>
                                        <option value="Shravasti">Shravasti</option>
                                        <option value="Siddharthnagar">Siddharthnagar</option>
                                        <option value="Sitapur">Sitapur</option>
                                        <option value="Sonbhadra">Sonbhadra</option>
                                        <option value="Sultanpur">Sultanpur</option>
                                        <option value="Unnao">Unnao</option>
                                        <option value="Varanasi">Varanasi</option>

                                        <!-- Uttarakhand -->
                                        <option value="Almora">Almora</option>
                                        <option value="Bageshwar">Bageshwar</option>
                                        <option value="Chamoli">Chamoli</option>
                                        <option value="Champawat">Champawat</option>
                                        <option value="Dehradun">Dehradun</option>
                                        <option value="Haridwar">Haridwar</option>
                                        <option value="Nainital">Nainital</option>
                                        <option value="Pauri Garhwal">Pauri Garhwal</option>
                                        <option value="Pithoragarh">Pithoragarh</option>
                                        <option value="Rudraprayag">Rudraprayag</option>
                                        <option value="Tehri Garhwal">Tehri Garhwal</option>
                                        <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                        <option value="Uttarkashi">Uttarkashi</option>

                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="apiVaptFollowUpAuditCertificateOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="apiVaptFollowUpAuditCertificateState">State*</label>
                                <div class="combo-input">
                                    <select id="apiVaptFollowUpAuditCertificateState" name="state" required onchange="toggleVaptOtherInput('apiVaptFollowUpAuditCertificateState', 'apiVaptFollowUpAuditCertificateOtherState')">
                                        <option value="">Select State</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                        <option value="Assam">Assam</option>
                                        <option value="Bihar">Bihar</option>
                                        <option value="Chhattisgarh">Chhattisgarh</option>
                                        <option value="Goa">Goa</option>
                                        <option value="Gujarat">Gujarat</option>
                                        <option value="Haryana">Haryana</option>
                                        <option value="Himachal Pradesh">Himachal Pradesh</option>
                                        <option value="Jharkhand">Jharkhand</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Kerala">Kerala</option>
                                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Manipur">Manipur</option>
                                        <option value="Meghalaya">Meghalaya</option>
                                        <option value="Mizoram">Mizoram</option>
                                        <option value="Nagaland">Nagaland</option>
                                        <option value="Odisha">Odisha</option>
                                        <option value="Punjab">Punjab</option>
                                        <option value="Rajasthan">Rajasthan</option>
                                        <option value="Sikkim">Sikkim</option>
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="Telangana">Telangana</option>
                                        <option value="Tripura">Tripura</option>
                                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                                        <option value="Uttarakhand">Uttarakhand</option>
                                        <option value="West Bengal">West Bengal</option>

                                        <!-- Union Territories -->
                                        <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                        <option value="Chandigarh">Chandigarh</option>
                                        <option value="Dadra and Nagar Haveli and Daman &amp; Diu">Dadra and Nagar Haveli and Daman &amp; Diu</option>
                                        <option value="Delhi">Delhi</option>
                                        <option value="Jammu &amp; Kashmir">Jammu &amp; Kashmir</option>
                                        <option value="Ladakh">Ladakh</option>
                                        <option value="Lakshadweep">Lakshadweep</option>
                                        <option value="Puducherry">Puducherry</option>

                                    </select>
                                    <input type="text" id="apiVaptFollowUpAuditCertificateOtherState" name="otherState" class="hidden" placeholder="Enter State Name">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="apiVaptFollowUpAuditCertificateAuditeeDesignation">Designation of the Auditee Person (Submitted To)*</label>
                                <input type="text" id="apiVaptFollowUpAuditCertificateAuditeeDesignation" name="auditeeDesignation" required placeholder="Enter auditee designation">
                            </div>

                            <div class="form-group">
                                <label for="apiVaptFollowUpAuditCertificateScope">Scope*</label>
                                <input type="text" id="apiVaptFollowUpAuditCertificateScope" name="scope" required placeholder="Enter scope details">
                            </div>

                            <div class="form-group">
                                <label for="apiVaptFollowUpAuditCertificateStartAuditDate">Start Audit Date*</label>
                                <input type="date" id="apiVaptFollowUpAuditCertificateStartAuditDate" name="startAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="apiVaptFollowUpAuditCertificateEndAuditDate">End Audit Date*</label>
                                <input type="date" id="apiVaptFollowUpAuditCertificateEndAuditDate" name="endAuditDate" required>
                            </div>

                            <div class="form-group">
                                <label for="apiVaptFollowUpAuditCertificateFirstReportId">First Audit Report ID*</label>
                                <input type="text" id="apiVaptFollowUpAuditCertificateFirstReportId" name="firstReportId" required placeholder="Enter first audit report ID">
                            </div>

                            <div class="form-group">
                                <label for="apiVaptFollowUpAuditCertificateReportId">Follow-up Report ID*</label>
                                <input type="text" id="apiVaptFollowUpAuditCertificateReportId" name="reportId" required placeholder="Enter follow-up report ID">
                            </div>

                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('apiVaptFollowUpAuditCertificateModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Certificate</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>


            <!-- Website VAPT First Audit Modal -->
            <div id="websiteVaptFirstAuditModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Website VAPT First Audit Details</h3>
                        <span class="close-modal" onclick="closeVaptModal('websiteVaptFirstAuditModal')">&times;</span>
                    </div>
                    <div class="modal-body scrollable-content">
                        <form id="websiteVaptFirstAuditForm" action="/process_website_vapt_first_audit_report" method="POST" enctype="multipart/form-data">
                            <!-- Organization Section -->
                            <div class="form-group">
                                <label for="websiteVaptOrganization">Organization Name*</label>
                                <div class="combo-input">
                                    <select id="websiteVaptOrganization" name="organization" required onchange="toggleVaptOtherInput('websiteVaptOrganization', 'websiteVaptOtherOrganization')">
                                        <option value="">Select Organization</option>
                                        <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                        <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                        <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                        <option value="Megasoft Limited">Megasoft Limited</option>
                                        <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                        <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                        <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                        <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                        <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                        <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                        <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                        <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                        <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                        <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                        <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                        <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                        <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                        <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                        <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                        <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                        <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                        <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                        <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                        <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                        <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                        <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                        <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                        <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                        <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                        <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                        <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                        <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                        <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                        <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                        <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                        <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                        <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                        <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                        <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                        <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                        
            
                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="websiteVaptOtherOrganization" name="otherOrganization" class="hidden" placeholder="Enter Organization Name">
                                </div>
                            </div>

                            <!-- Location Section -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="websiteVaptCity">City*</label>
                                    <div class="combo-input">
                                        <select id="websiteVaptCity" name="city" required onchange="toggleVaptOtherInput('websiteVaptCity', 'websiteVaptOtherCity')">
                                            <option value="">Select City</option>
                                            <option value="Ahmedabad">Ahmedabad</option>
                                            <option value="Amreli">Amreli</option>
                                            <option value="Anand">Anand</option>
                                            <option value="Aravalli">Aravalli</option>
                                            <option value="Banaskantha">Banaskantha</option>
                                            <option value="Bharuch">Bharuch</option>
                                            <option value="Bhavnagar">Bhavnagar</option>
                                            <option value="Botad">Botad</option>
                                            <option value="Chhota Udaipur">Chhota Udaipur</option>
                                            <option value="Dahod">Dahod</option>
                                            <option value="Dang">Dang</option>
                                            <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                            <option value="Gandhinagar">Gandhinagar</option>
                                            <option value="Gir Somnath">Gir Somnath</option>
                                            <option value="Jamnagar">Jamnagar</option>
                                            <option value="Junagadh">Junagadh</option>
                                            <option value="Kheda">Kheda</option>
                                            <option value="Kutch">Kutch</option>
                                            <option value="Mahisagar">Mahisagar</option>
                                            <option value="Mehsana">Mehsana</option>
                                            <option value="Morbi">Morbi</option>
                                            <option value="Narmada">Narmada</option>
                                            <option value="Navsari">Navsari</option>
                                            <option value="Patan">Patan</option>
                                            <option value="Panchmahal">Panchmahal</option>
                                            <option value="Porbandar">Porbandar</option>
                                            <option value="Rajkot">Rajkot</option>
                                            <option value="Sabarkantha">Sabarkantha</option>
                                            <option value="Surat">Surat</option>
                                            <option value="Surendranagar">Surendranagar</option>
                                            <option value="Tapi">Tapi</option>
                                            <option value="Vadodara">Vadodara</option>
                                            <option value="Valsad">Valsad</option>
                
                                            <!-- Rajasthan -->
                                            <option value="Ajmer">Ajmer</option>
                                            <option value="Alwar">Alwar</option>
                                            <option value="Banswara">Banswara</option>
                                            <option value="Baran">Baran</option>
                                            <option value="Barmer">Barmer</option>
                                            <option value="Bharatpur">Bharatpur</option>
                                            <option value="Bhilwara">Bhilwara</option>
                                            <option value="Bikaner">Bikaner</option>
                                            <option value="Bundi">Bundi</option>
                                            <option value="Chittorgarh">Chittorgarh</option>
                                            <option value="Churu">Churu</option>
                                            <option value="Dausa">Dausa</option>
                                            <option value="Dholpur">Dholpur</option>
                                            <option value="Dungarpur">Dungarpur</option>
                                            <option value="Hanumangarh">Hanumangarh</option>
                                            <option value="Jaipur">Jaipur</option>
                                            <option value="Jaisalmer">Jaisalmer</option>
                                            <option value="Jalore">Jalore</option>
                                            <option value="Jhalawar">Jhalawar</option>
                                            <option value="Jhunjhunu">Jhunjhunu</option>
                                            <option value="Jodhpur">Jodhpur</option>
                                            <option value="Karauli">Karauli</option>
                                            <option value="Kota">Kota</option>
                                            <option value="Nagaur">Nagaur</option>
                                            <option value="Pali">Pali</option>
                                            <option value="Pratapgarh">Pratapgarh</option>
                                            <option value="Rajsamand">Rajsamand</option>
                                            <option value="Sikar">Sikar</option>
                                            <option value="Sirohi">Sirohi</option>
                                            <option value="Sri Ganganagar">Sri Ganganagar</option>
                                            <option value="Tonk">Tonk</option>
                                            <option value="Udaipur">Udaipur</option>
                
                                            <!-- Maharashtra -->
                                            <option value="Ahmednagar">Ahmednagar</option>
                                            <option value="Akola">Akola</option>
                                            <option value="Amravati">Amravati</option>
                                            <option value="Aurangabad">Aurangabad</option>
                                            <option value="Beed">Beed</option>
                                            <option value="Bhandara">Bhandara</option>
                                            <option value="Chandrapur">Chandrapur</option>
                                            <option value="Dhule">Dhule</option>
                                            <option value="Gadchiroli">Gadchiroli</option>
                                            <option value="Gondia">Gondia</option>
                                            <option value="Hingoli">Hingoli</option>
                                            <option value="Jalgaon">Jalgaon</option>
                                            <option value="Jalna">Jalna</option>
                                            <option value="Kolhapur">Kolhapur</option>
                                            <option value="Latur">Latur</option>
                                            <option value="Mumbai City">Mumbai City</option>
                                            <option value="Mumbai Suburban">Mumbai Suburban</option>
                                            <option value="Nagpur">Nagpur</option>
                                            <option value="Nanded">Nanded</option>
                                            <option value="Nandurbar">Nandurbar</option>
                                            <option value="Nashik">Nashik</option>
                                            <option value="Osmanabad">Osmanabad</option>
                                            <option value="Palghar">Palghar</option>
                                            <option value="Parbhani">Parbhani</option>
                                            <option value="Pune">Pune</option>
                                            <option value="Raigad">Raigad</option>
                                            <option value="Ratnagiri">Ratnagiri</option>
                                            <option value="Sangli">Sangli</option>
                                            <option value="Satara">Satara</option>
                                            <option value="Sindhudurg">Sindhudurg</option>
                                            <option value="Solapur">Solapur</option>
                                            <option value="Thane">Thane</option>
                                            <option value="Wardha">Wardha</option>
                                            <option value="Washim">Washim</option>
                                            <option value="Yavatmal">Yavatmal</option>
                
                                            <!-- Uttar Pradesh -->
                                            <option value="Agra">Agra</option>
                                            <option value="Aligarh">Aligarh</option>
                                            <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                            <option value="Amethi">Amethi</option>
                                            <option value="Amroha">Amroha</option>
                                            <option value="Auraiya">Auraiya</option>
                                            <option value="Ayodhya">Ayodhya</option>
                                            <option value="Azamgarh">Azamgarh</option>
                                            <option value="Bagpat">Bagpat</option>
                                            <option value="Bahraich">Bahraich</option>
                                            <option value="Ballia">Ballia</option>
                                            <option value="Balrampur">Balrampur</option>
                                            <option value="Banda">Banda</option>
                                            <option value="Barabanki">Barabanki</option>
                                            <option value="Bareilly">Bareilly</option>
                                            <option value="Basti">Basti</option>
                                            <option value="Bhadohi">Bhadohi</option>
                                            <option value="Bijnor">Bijnor</option>
                                            <option value="Bulandshahr">Bulandshahr</option>
                                            <option value="Chandauli">Chandauli</option>
                                            <option value="Chitrakoot">Chitrakoot</option>
                                            <option value="Deoria">Deoria</option>
                                            <option value="Etah">Etah</option>
                                            <option value="Etawah">Etawah</option>
                                            <option value="Farrukhabad">Farrukhabad</option>
                                            <option value="Fatehpur">Fatehpur</option>
                                            <option value="Firozabad">Firozabad</option>
                                            <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                            <option value="Ghaziabad">Ghaziabad</option>
                                            <option value="Ghazipur">Ghazipur</option>
                                            <option value="Gonda">Gonda</option>
                                            <option value="Gorakhpur">Gorakhpur</option>
                                            <option value="Hamirpur">Hamirpur</option>
                                            <option value="Hapur">Hapur</option>
                                            <option value="Hardoi">Hardoi</option>
                                            <option value="Hathras">Hathras</option>
                                            <option value="Jalaun">Jalaun</option>
                                            <option value="Jaunpur">Jaunpur</option>
                                            <option value="Jhansi">Jhansi</option>
                                            <option value="Kannauj">Kannauj</option>
                                            <option value="Kanpur Dehat">Kanpur Dehat</option>
                                            <option value="Kanpur Nagar">Kanpur Nagar</option>
                                            <option value="Kasganj">Kasganj</option>
                                            <option value="Kaushambi">Kaushambi</option>
                                            <option value="Kushinagar">Kushinagar</option>
                                            <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                            <option value="Lalitpur">Lalitpur</option>
                                            <option value="Lucknow">Lucknow</option>
                                            <option value="Maharajganj">Maharajganj</option>
                                            <option value="Mahoba">Mahoba</option>
                                            <option value="Mainpuri">Mainpuri</option>
                                            <option value="Mathura">Mathura</option>
                                            <option value="Mau">Mau</option>
                                            <option value="Meerut">Meerut</option>
                                            <option value="Mirzapur">Mirzapur</option>
                                            <option value="Moradabad">Moradabad</option>
                                            <option value="Muzaffarnagar">Muzaffarnagar</option>
                                            <option value="Pilibhit">Pilibhit</option>
                                            <option value="Pratapgarh">Pratapgarh</option>
                                            <option value="Rae Bareli">Rae Bareli</option>
                                            <option value="Rampur">Rampur</option>
                                            <option value="Saharanpur">Saharanpur</option>
                                            <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                            <option value="Shahjahanpur">Shahjahanpur</option>
                                            <option value="Shravasti">Shravasti</option>
                                            <option value="Siddharthnagar">Siddharthnagar</option>
                                            <option value="Sitapur">Sitapur</option>
                                            <option value="Sonbhadra">Sonbhadra</option>
                                            <option value="Sultanpur">Sultanpur</option>
                                            <option value="Unnao">Unnao</option>
                                            <option value="Varanasi">Varanasi</option>
                
                                            <!-- Uttarakhand -->
                                            <option value="Almora">Almora</option>
                                            <option value="Bageshwar">Bageshwar</option>
                                            <option value="Chamoli">Chamoli</option>
                                            <option value="Champawat">Champawat</option>
                                            <option value="Dehradun">Dehradun</option>
                                            <option value="Haridwar">Haridwar</option>
                                            <option value="Nainital">Nainital</option>
                                            <option value="Pauri Garhwal">Pauri Garhwal</option>
                                            <option value="Pithoragarh">Pithoragarh</option>
                                            <option value="Rudraprayag">Rudraprayag</option>
                                            <option value="Tehri Garhwal">Tehri Garhwal</option>
                                            <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                            <option value="Uttarkashi">Uttarkashi</option>
                                                            <option value="other">Other (Please specify)</option>
                                        </select>
                                        <input type="text" id="websiteVaptOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="websiteVaptState">State*</label>
                                    <select id="websiteVaptState" name="state" required>
                                        <option value="">Select State</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                        <option value="Assam">Assam</option>
                                        <option value="Bihar">Bihar</option>
                                        <option value="Chhattisgarh">Chhattisgarh</option>
                                        <option value="Goa">Goa</option>
                                        <option value="Gujarat">Gujarat</option>
                                        <option value="Haryana">Haryana</option>
                                        <option value="Himachal Pradesh">Himachal Pradesh</option>
                                        <option value="Jharkhand">Jharkhand</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Kerala">Kerala</option>
                                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Manipur">Manipur</option>
                                        <option value="Meghalaya">Meghalaya</option>
                                        <option value="Mizoram">Mizoram</option>
                                        <option value="Nagaland">Nagaland</option>
                                        <option value="Odisha">Odisha</option>
                                        <option value="Punjab">Punjab</option>
                                        <option value="Rajasthan">Rajasthan</option>
                                        <option value="Sikkim">Sikkim</option>
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="Telangana">Telangana</option>
                                        <option value="Tripura">Tripura</option>
                                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                                        <option value="Uttarakhand">Uttarakhand</option>
                                        <option value="West Bengal">West Bengal</option>
                                        <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                        <option value="Chandigarh">Chandigarh</option>
                                        <option value="Dadra and Nagar Haveli and Daman and Diu">Dadra and Nagar Haveli and Daman and Diu</option>
                                        <option value="Delhi">Delhi</option>
                                        <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                                        <option value="Ladakh">Ladakh</option>
                                        <option value="Lakshadweep">Lakshadweep</option>
                                        <option value="Puducherry">Puducherry</option>
                                        
                                    </select>
                                </div>
                            </div>

                            <!-- Audit Dates -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="websiteVaptStartDate">Start Audit Date*</label>
                                    <input type="date" id="websiteVaptStartDate" name="startDate" required>
                                </div>
                                <div class="form-group">
                                    <label for="websiteVaptEndDate">Finish Audit Date*</label>
                                    <input type="date" id="websiteVaptEndDate" name="endDate" required>
                                </div>
                            </div>

                            <!-- Report Prepared By -->
                            <div class="form-group">
                                <label>Report Prepared By*</label>
                                <div class="name-input">
                                    <select class="title-select" name="preparedByTitle" required>
                                        <option value="Mr.">Mr.</option>
                                        <option value="Ms.">Ms.</option>
                                        <option value="Mrs.">Mrs.</option>
                                        <option value="Dr.">Dr.</option>
                                    </select>
                                    <input type="text" placeholder="Full Name" name="preparedByName" required>
                                </div>
                            </div>

                            <!-- Auditee Details -->
                            <div class="form-group">
                                <label>Name of Auditee Organization Person*</label>
                                <div class="name-input">
                                    <select class="title-select" name="auditeeTitle" required>
                                        <option value="Mr.">Mr.</option>
                                        <option value="Ms.">Ms.</option>
                                        <option value="Mrs.">Mrs.</option>
                                        <option value="Dr.">Dr.</option>
                                    </select>
                                    <input type="text" placeholder="Full Name" name="auditeeName" required>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptDesignation">Designation of the Person*</label>
                                <input type="text" id="websiteVaptDesignation" name="designation" required>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptBankEmail">Email ID of the Organization*</label>
                                <div id="websiteVaptEmailContainer">
                                    <input type="email" name="bankEmail[]" placeholder="Email Address" required>
                                </div>
                                <button type="button" class="add-member-btn" id="websiteVaptAddEmailBtn" style="margin-top: 10px;">+ Add Another Email</button>
                            </div>

                            <!-- Auditing Team -->
                            <div class="form-group">
                                <label>Details of Auditing Team* (At least 1 required, max 8)</label>
                                <div id="websiteVaptAuditTeamContainer">
                                    <div class="team-member" data-index="0">
                                        <div class="form-row">
                                            <div class="form-group">
                                                <input type="text" name="teamName[]" placeholder="Name*" required>
                                            </div>
                                            <div class="form-group">
                                                <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                                            </div>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                                            </div>
                                            <div class="form-group">
                                                <input type="text" name="teamQualification[]" placeholder="Qualification/Certification*" required>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label>Certified (Yes/No)*</label>
                                            <div class="radio-group">
                                                <label><input type="radio" name="teamCertified[0]" value="yes" required> Yes</label>
                                                <label><input type="radio" name="teamCertified[0]" value="no"> No</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <button type="button" class="add-member-btn" id="websiteVaptAddMemberBtn">+ Add Team Member</button>
                            </div>

                            <!-- File Uploads -->
                            <div class="form-group">
                                <label>File Uploads*</label>
                                
                                <div class="file-upload-group">
                                    <label for="websiteVaptNmapFiles">Nmap Zip Files</label>
                                    <input type="file" id="websiteVaptNmapFiles" name="nmapFiles" accept=".zip" required>
                                    <small class="file-help" style="color: brown;">All Nmap files must be placed directly in the ZIP file (no nested folders) and must be in CSV format.</small>
                                </div>
                                
                                <div class="file-upload-group">
                                    <label for="websiteVaptNessusFiles">Nessus Zip Files</label>
                                    <input type="file" id="websiteVaptNessusFiles" name="nessusFiles" accept=".zip" required>
                                    <small class="file-help" style="color: brown;">All Nessus files must be placed directly inside a single ZIP file with no nested folders.</small>
                                </div>
                                
                                <div class="file-upload-group">
                                    <label for="websiteVaptEvidenceFiles">Evidences Zip Files</label>
                                    <input type="file" id="websiteVaptEvidenceFiles" name="evidenceFiles" accept=".zip">
                                    <small class="file-help" style="color: brown;">The evidence ZIP file must include a folder named "ALL POC" containing evidence images. File names must exactly match vulnerability names.</small>
                                </div>
                            </div>

                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('websiteVaptFirstAuditModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Submit Report</button>
                            </div>
                            <br>
                            <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>  
                            </small>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Website VAPT Word Report Modal -->
            <div id="websiteVaptFirstAuditWordModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Website VAPT First Audit Word Report</h3>
                        <span class="close-modal" onclick="closeVaptModal('websiteVaptFirstAuditWordModal')">&times;</span>
                    </div>
                    <div class="modal-body scrollable-content">
                        <form id="websiteVaptFirstAuditWordForm" action="/process_website_vapt_first_audit_word_report" method="POST" enctype="multipart/form-data">
                            <div class="form-group">
                                <label for="websiteVaptWordStartDate">Start Audit Date*</label>
                                <input type="date" id="websiteVaptWordStartDate" name="startDate" required>
                            </div>
                            <div class="form-group">
                                <label for="websiteVaptWordEndDate">Finish Audit Date*</label>
                                <input type="date" id="websiteVaptWordEndDate" name="endDate" required>
                            </div>
                            <div class="form-group">
                                <label for="websiteVaptWordExcelFile">Upload Excel File*</label>
                                <input type="file" id="websiteVaptWordExcelFile" name="excelFile" accept=".xlsx" required>
                                <small class="file-help" style="color: brown;">Upload the Excel report generated from the first audit.</small>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('websiteVaptFirstAuditWordModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Generate Word Report</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Website VAPT Follow-up Audit Modal -->
            <div id="websiteVaptFollowUpAuditModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Website VAPT Follow Up Audit Details</h3>
                        <span class="close-modal" onclick="closeVaptModal('websiteVaptFollowUpAuditModal')">&times;</span>
                    </div>
                    <div class="modal-body scrollable-content">
                        <form id="websiteVaptFollowUpAuditForm" action="/process_website_vapt_follow_up_audit_report" method="POST" enctype="multipart/form-data">
                            <!-- Organization Section -->
                            <div class="form-group">
                                <label for="websiteVaptFollowUpOrganization">Organization Name*</label>
                                <div class="combo-input">
                                    <select id="websiteVaptFollowUpOrganization" name="organization" required onchange="toggleVaptOtherInput('websiteVaptFollowUpOrganization', 'websiteVaptFollowUpOtherOrganization')">
                                        <option value="">Select Organization</option>
                                        <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                        <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                        <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                        <option value="Megasoft Limited">Megasoft Limited</option>
                                        <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                        <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                        <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                        <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                        <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                        <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                        <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                        <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                        <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                        <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                        <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                        <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                        <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                        <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                        <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                        <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                        <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                        <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                        <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                        <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                        <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                        <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                        <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                        <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                        <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                        <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                        <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                        <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                        <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                        <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                        <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                        <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                        <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                        <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                        <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                        <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                        
            
                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="websiteVaptFollowUpOtherOrganization" name="otherOrganization" class="hidden" placeholder="Enter Organization Name">
                                </div>
                            </div>

                            <!-- Location Section -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="websiteVaptFollowUpCity">City*</label>
                                    <div class="combo-input">
                                        <select id="websiteVaptFollowUpCity" name="city" required onchange="toggleVaptOtherInput('websiteVaptFollowUpCity', 'websiteVaptFollowUpOtherCity')">
                                            <option value="">Select City</option>
                                            <option value="Ahmedabad">Ahmedabad</option>
                                            <option value="Amreli">Amreli</option>
                                            <option value="Anand">Anand</option>
                                            <option value="Aravalli">Aravalli</option>
                                            <option value="Banaskantha">Banaskantha</option>
                                            <option value="Bharuch">Bharuch</option>
                                            <option value="Bhavnagar">Bhavnagar</option>
                                            <option value="Botad">Botad</option>
                                            <option value="Chhota Udaipur">Chhota Udaipur</option>
                                            <option value="Dahod">Dahod</option>
                                            <option value="Dang">Dang</option>
                                            <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                            <option value="Gandhinagar">Gandhinagar</option>
                                            <option value="Gir Somnath">Gir Somnath</option>
                                            <option value="Jamnagar">Jamnagar</option>
                                            <option value="Junagadh">Junagadh</option>
                                            <option value="Kheda">Kheda</option>
                                            <option value="Kutch">Kutch</option>
                                            <option value="Mahisagar">Mahisagar</option>
                                            <option value="Mehsana">Mehsana</option>
                                            <option value="Morbi">Morbi</option>
                                            <option value="Narmada">Narmada</option>
                                            <option value="Navsari">Navsari</option>
                                            <option value="Patan">Patan</option>
                                            <option value="Panchmahal">Panchmahal</option>
                                            <option value="Porbandar">Porbandar</option>
                                            <option value="Rajkot">Rajkot</option>
                                            <option value="Sabarkantha">Sabarkantha</option>
                                            <option value="Surat">Surat</option>
                                            <option value="Surendranagar">Surendranagar</option>
                                            <option value="Tapi">Tapi</option>
                                            <option value="Vadodara">Vadodara</option>
                                            <option value="Valsad">Valsad</option>
                
                                            <!-- Rajasthan -->
                                            <option value="Ajmer">Ajmer</option>
                                            <option value="Alwar">Alwar</option>
                                            <option value="Banswara">Banswara</option>
                                            <option value="Baran">Baran</option>
                                            <option value="Barmer">Barmer</option>
                                            <option value="Bharatpur">Bharatpur</option>
                                            <option value="Bhilwara">Bhilwara</option>
                                            <option value="Bikaner">Bikaner</option>
                                            <option value="Bundi">Bundi</option>
                                            <option value="Chittorgarh">Chittorgarh</option>
                                            <option value="Churu">Churu</option>
                                            <option value="Dausa">Dausa</option>
                                            <option value="Dholpur">Dholpur</option>
                                            <option value="Dungarpur">Dungarpur</option>
                                            <option value="Hanumangarh">Hanumangarh</option>
                                            <option value="Jaipur">Jaipur</option>
                                            <option value="Jaisalmer">Jaisalmer</option>
                                            <option value="Jalore">Jalore</option>
                                            <option value="Jhalawar">Jhalawar</option>
                                            <option value="Jhunjhunu">Jhunjhunu</option>
                                            <option value="Jodhpur">Jodhpur</option>
                                            <option value="Karauli">Karauli</option>
                                            <option value="Kota">Kota</option>
                                            <option value="Nagaur">Nagaur</option>
                                            <option value="Pali">Pali</option>
                                            <option value="Pratapgarh">Pratapgarh</option>
                                            <option value="Rajsamand">Rajsamand</option>
                                            <option value="Sikar">Sikar</option>
                                            <option value="Sirohi">Sirohi</option>
                                            <option value="Sri Ganganagar">Sri Ganganagar</option>
                                            <option value="Tonk">Tonk</option>
                                            <option value="Udaipur">Udaipur</option>
                
                                            <!-- Maharashtra -->
                                            <option value="Ahmednagar">Ahmednagar</option>
                                            <option value="Akola">Akola</option>
                                            <option value="Amravati">Amravati</option>
                                            <option value="Aurangabad">Aurangabad</option>
                                            <option value="Beed">Beed</option>
                                            <option value="Bhandara">Bhandara</option>
                                            <option value="Chandrapur">Chandrapur</option>
                                            <option value="Dhule">Dhule</option>
                                            <option value="Gadchiroli">Gadchiroli</option>
                                            <option value="Gondia">Gondia</option>
                                            <option value="Hingoli">Hingoli</option>
                                            <option value="Jalgaon">Jalgaon</option>
                                            <option value="Jalna">Jalna</option>
                                            <option value="Kolhapur">Kolhapur</option>
                                            <option value="Latur">Latur</option>
                                            <option value="Mumbai City">Mumbai City</option>
                                            <option value="Mumbai Suburban">Mumbai Suburban</option>
                                            <option value="Nagpur">Nagpur</option>
                                            <option value="Nanded">Nanded</option>
                                            <option value="Nandurbar">Nandurbar</option>
                                            <option value="Nashik">Nashik</option>
                                            <option value="Osmanabad">Osmanabad</option>
                                            <option value="Palghar">Palghar</option>
                                            <option value="Parbhani">Parbhani</option>
                                            <option value="Pune">Pune</option>
                                            <option value="Raigad">Raigad</option>
                                            <option value="Ratnagiri">Ratnagiri</option>
                                            <option value="Sangli">Sangli</option>
                                            <option value="Satara">Satara</option>
                                            <option value="Sindhudurg">Sindhudurg</option>
                                            <option value="Solapur">Solapur</option>
                                            <option value="Thane">Thane</option>
                                            <option value="Wardha">Wardha</option>
                                            <option value="Washim">Washim</option>
                                            <option value="Yavatmal">Yavatmal</option>
                
                                            <!-- Uttar Pradesh -->
                                            <option value="Agra">Agra</option>
                                            <option value="Aligarh">Aligarh</option>
                                            <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                            <option value="Amethi">Amethi</option>
                                            <option value="Amroha">Amroha</option>
                                            <option value="Auraiya">Auraiya</option>
                                            <option value="Ayodhya">Ayodhya</option>
                                            <option value="Azamgarh">Azamgarh</option>
                                            <option value="Bagpat">Bagpat</option>
                                            <option value="Bahraich">Bahraich</option>
                                            <option value="Ballia">Ballia</option>
                                            <option value="Balrampur">Balrampur</option>
                                            <option value="Banda">Banda</option>
                                            <option value="Barabanki">Barabanki</option>
                                            <option value="Bareilly">Bareilly</option>
                                            <option value="Basti">Basti</option>
                                            <option value="Bhadohi">Bhadohi</option>
                                            <option value="Bijnor">Bijnor</option>
                                            <option value="Bulandshahr">Bulandshahr</option>
                                            <option value="Chandauli">Chandauli</option>
                                            <option value="Chitrakoot">Chitrakoot</option>
                                            <option value="Deoria">Deoria</option>
                                            <option value="Etah">Etah</option>
                                            <option value="Etawah">Etawah</option>
                                            <option value="Farrukhabad">Farrukhabad</option>
                                            <option value="Fatehpur">Fatehpur</option>
                                            <option value="Firozabad">Firozabad</option>
                                            <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                            <option value="Ghaziabad">Ghaziabad</option>
                                            <option value="Ghazipur">Ghazipur</option>
                                            <option value="Gonda">Gonda</option>
                                            <option value="Gorakhpur">Gorakhpur</option>
                                            <option value="Hamirpur">Hamirpur</option>
                                            <option value="Hapur">Hapur</option>
                                            <option value="Hardoi">Hardoi</option>
                                            <option value="Hathras">Hathras</option>
                                            <option value="Jalaun">Jalaun</option>
                                            <option value="Jaunpur">Jaunpur</option>
                                            <option value="Jhansi">Jhansi</option>
                                            <option value="Kannauj">Kannauj</option>
                                            <option value="Kanpur Dehat">Kanpur Dehat</option>
                                            <option value="Kanpur Nagar">Kanpur Nagar</option>
                                            <option value="Kasganj">Kasganj</option>
                                            <option value="Kaushambi">Kaushambi</option>
                                            <option value="Kushinagar">Kushinagar</option>
                                            <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                            <option value="Lalitpur">Lalitpur</option>
                                            <option value="Lucknow">Lucknow</option>
                                            <option value="Maharajganj">Maharajganj</option>
                                            <option value="Mahoba">Mahoba</option>
                                            <option value="Mainpuri">Mainpuri</option>
                                            <option value="Mathura">Mathura</option>
                                            <option value="Mau">Mau</option>
                                            <option value="Meerut">Meerut</option>
                                            <option value="Mirzapur">Mirzapur</option>
                                            <option value="Moradabad">Moradabad</option>
                                            <option value="Muzaffarnagar">Muzaffarnagar</option>
                                            <option value="Pilibhit">Pilibhit</option>
                                            <option value="Pratapgarh">Pratapgarh</option>
                                            <option value="Rae Bareli">Rae Bareli</option>
                                            <option value="Rampur">Rampur</option>
                                            <option value="Saharanpur">Saharanpur</option>
                                            <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                            <option value="Shahjahanpur">Shahjahanpur</option>
                                            <option value="Shravasti">Shravasti</option>
                                            <option value="Siddharthnagar">Siddharthnagar</option>
                                            <option value="Sitapur">Sitapur</option>
                                            <option value="Sonbhadra">Sonbhadra</option>
                                            <option value="Sultanpur">Sultanpur</option>
                                            <option value="Unnao">Unnao</option>
                                            <option value="Varanasi">Varanasi</option>
                
                                            <!-- Uttarakhand -->
                                            <option value="Almora">Almora</option>
                                            <option value="Bageshwar">Bageshwar</option>
                                            <option value="Chamoli">Chamoli</option>
                                            <option value="Champawat">Champawat</option>
                                            <option value="Dehradun">Dehradun</option>
                                            <option value="Haridwar">Haridwar</option>
                                            <option value="Nainital">Nainital</option>
                                            <option value="Pauri Garhwal">Pauri Garhwal</option>
                                            <option value="Pithoragarh">Pithoragarh</option>
                                            <option value="Rudraprayag">Rudraprayag</option>
                                            <option value="Tehri Garhwal">Tehri Garhwal</option>
                                            <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                            <option value="Uttarkashi">Uttarkashi</option>
                                                            <option value="other">Other (Please specify)</option>
                                        </select>
                                        <input type="text" id="websiteVaptFollowUpOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="websiteVaptFollowUpState">State*</label>
                                    <select id="websiteVaptFollowUpState" name="state" required>
                                        <option value="">Select State</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                        <option value="Assam">Assam</option>
                                        <option value="Bihar">Bihar</option>
                                        <option value="Chhattisgarh">Chhattisgarh</option>
                                        <option value="Goa">Goa</option>
                                        <option value="Gujarat">Gujarat</option>
                                        <option value="Haryana">Haryana</option>
                                        <option value="Himachal Pradesh">Himachal Pradesh</option>
                                        <option value="Jharkhand">Jharkhand</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Kerala">Kerala</option>
                                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Manipur">Manipur</option>
                                        <option value="Meghalaya">Meghalaya</option>
                                        <option value="Mizoram">Mizoram</option>
                                        <option value="Nagaland">Nagaland</option>
                                        <option value="Odisha">Odisha</option>
                                        <option value="Punjab">Punjab</option>
                                        <option value="Rajasthan">Rajasthan</option>
                                        <option value="Sikkim">Sikkim</option>
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="Telangana">Telangana</option>
                                        <option value="Tripura">Tripura</option>
                                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                                        <option value="Uttarakhand">Uttarakhand</option>
                                        <option value="West Bengal">West Bengal</option>
                                        <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                        <option value="Chandigarh">Chandigarh</option>
                                        <option value="Dadra and Nagar Haveli and Daman and Diu">Dadra and Nagar Haveli and Daman and Diu</option>
                                        <option value="Delhi">Delhi</option>
                                        <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                                        <option value="Ladakh">Ladakh</option>
                                        <option value="Lakshadweep">Lakshadweep</option>
                                        <option value="Puducherry">Puducherry</option>
                                        
                                    </select>
                                </div>
                            </div>

                            <!-- First Audit Report Details -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="websiteVaptFollowUpFirstAuditReportId">First Audit Report ID*</label>
                                    <input type="text" id="websiteVaptFollowUpFirstAuditReportId" name="firstAuditReportId" placeholder="Enter First Audit Report ID" required>
                                </div>
                                <div class="form-group">
                                    <label for="websiteVaptFollowUpFirstAuditReportDate">First Audit Report Release Date*</label>
                                    <input type="date" id="websiteVaptFollowUpFirstAuditReportDate" name="firstAuditReportDate" required>
                                </div>
                            </div>

                            <!-- Audit Dates -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="websiteVaptFollowUpStartDate">Start Audit Date*</label>
                                    <input type="date" id="websiteVaptFollowUpStartDate" name="startDate" required>
                                </div>
                                <div class="form-group">
                                    <label for="websiteVaptFollowUpEndDate">Finish Audit Date*</label>
                                    <input type="date" id="websiteVaptFollowUpEndDate" name="endDate" required>
                                </div>
                            </div>

                            <!-- Report Prepared By -->
                            <div class="form-group">
                                <label>Report Prepared By*</label>
                                <div class="name-input">
                                    <select class="title-select" name="preparedByTitle" required>
                                        <option value="Mr.">Mr.</option>
                                        <option value="Ms.">Ms.</option>
                                        <option value="Mrs.">Mrs.</option>
                                        <option value="Dr.">Dr.</option>
                                    </select>
                                    <input type="text" placeholder="Full Name" name="preparedByName" required>
                                </div>
                            </div>

                            <!-- Auditee Details -->
                            <div class="form-group">
                                <label>Name of Auditee Organization Person*</label>
                                <div class="name-input">
                                    <select class="title-select" name="auditeeTitle" required>
                                        <option value="Mr.">Mr.</option>
                                        <option value="Ms.">Ms.</option>
                                        <option value="Mrs.">Mrs.</option>
                                        <option value="Dr.">Dr.</option>
                                    </select>
                                    <input type="text" placeholder="Full Name" name="auditeeName" required>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpDesignation">Designation of the Person*</label>
                                <input type="text" id="websiteVaptFollowUpDesignation" name="designation" required>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpBankEmail">Email ID of the Organization*</label>
                                <div id="websiteVaptFollowUpEmailContainer">
                                    <input type="email" name="bankEmail[]" placeholder="Email Address" required>
                                </div>
                                <button type="button" class="add-member-btn" id="websiteVaptAddFollowUpEmailBtn" style="margin-top: 10px;">+ Add Another Email</button>
                            </div>

                            <!-- Auditing Team -->
                            <div class="form-group">
                                <label>Details of Auditing Team* (At least 1 required, max 8)</label>
                                <div id="websiteVaptFollowUpAuditTeamContainer">
                                    <div class="team-member" data-index="0">
                                        <div class="form-row">
                                            <div class="form-group">
                                                <input type="text" name="teamName[]" placeholder="Name*" required>
                                            </div>
                                            <div class="form-group">
                                                <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                                            </div>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                                            </div>
                                            <div class="form-group">
                                                <input type="text" name="teamQualification[]" placeholder="Qualification/Certification*" required>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label>Certified (Yes/No)*</label>
                                            <div class="radio-group">
                                                <label><input type="radio" name="teamCertified[0]" value="yes" required> Yes</label>
                                                <label><input type="radio" name="teamCertified[0]" value="no"> No</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <button type="button" class="add-member-btn" id="websiteVaptAddFollowUpMemberBtn">+ Add Team Member</button>
                            </div>

                            <!-- Old Excel File Upload -->
                            <div class="form-group">
                                <label for="websiteVaptFollowUpOldExcelFile">Old Excel File (First Audit)*</label>
                                <input type="file" id="websiteVaptFollowUpOldExcelFile" name="userExcelFile" accept=".xlsx" required>
                                <small class="file-help" style="color: brown;">Upload the Excel file from the First Audit to carry forward resolved vulnerabilities and their evidence.</small>
                            </div>

                            <!-- File Uploads -->
                            <div class="form-group">
                                <label>File Uploads*</label>
                                
                                <div class="file-upload-group">
                                    <label for="websiteVaptFollowUpNmapFiles">Nmap Zip Files</label>
                                    <input type="file" id="websiteVaptFollowUpNmapFiles" name="nmapFiles" accept=".zip" required>
                                    <small class="file-help" style="color: brown;">All Nmap files must be placed directly in the ZIP file (no nested folders) and must be in CSV format.</small>
                                </div>
                                
                                <div class="file-upload-group">
                                    <label for="websiteVaptFollowUpNessusFiles">Nessus Zip Files</label>
                                    <input type="file" id="websiteVaptFollowUpNessusFiles" name="nessusFiles" accept=".zip" required>
                                    <small class="file-help" style="color: brown;">All Nessus files must be placed directly inside a single ZIP file with no nested folders.</small>
                                </div>
                                
                                <div class="file-upload-group">
                                    <label for="websiteVaptFollowUpEvidenceFiles">New Evidences Zip Files</label>
                                    <input type="file" id="websiteVaptFollowUpEvidenceFiles" name="evidenceFiles" accept=".zip" required>
                                    <small class="file-help" style="color: brown;">Upload new evidence for current follow-up audit vulnerabilities.</small>
                                </div>
                            </div>

                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('websiteVaptFollowUpAuditModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Submit Report</button>
                            </div>
                            <br>
                            <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>  
                            </small>
                        </form>
                    </div>
                </div>
            </div>

            <section id="chat-section" class="dashboard-section">
                <h1><i class="fas fa-comments"></i> AI Chat Board</h1>
                <div class="chat-container">
                    <div class="chat-messages">
                        <div class="message ai-message">
                            <p>Hello! How can I assist you with your VAPT tasks today?</p>
                        </div>
                    </div>
                    <div class="chat-input">
                        <select id="prompt-select">
                            <option value="">Select a prompt...</option>
                            <option value="correct-grammar">Correct grammar in this text</option>
                            <option value="professional-email">Write a professional email</option>
                            <option value="audit-checklist">Generate audit checklist</option>
                            <option value="risk-assessment">Help with risk assessment</option>
                            <option value="compliance-query">Compliance query</option>
                            <option value="report-template">Need report template</option>
                            <option value="data-analysis">Help with data analysis</option>
                            <option value="presentation-tips">Presentation tips</option>
                            <option value="meeting-agenda">Create meeting agenda</option>
                            <option value="time-management">Time management tips</option>
                        </select>
                        <input type="text" placeholder="Type your message...">
                        <button><i class="fas fa-paper-plane"></i></button>
                    </div>
                </div>
            </section>

            <section id="work-section" class="dashboard-section">
                <h1><i class="fas fa-tasks"></i> Update Your Work</h1>
                <div class="work-cards" style="display: flex; flex-direction: column; align-items: center; gap: 40px;">
                    <!-- First Row: 4 cards -->
                    <div style="display: flex; justify-content: center; gap: 30px; flex-wrap: wrap; width: 100%;">
                        <div class="work-card" id="workPlanCard" onclick="openWorkPlanModal()" style="cursor: pointer; width: 180px; height: 180px; padding: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; box-sizing: border-box;">
                            <i class="fas fa-calendar-plus"></i>
                            <h3>Submit Today's Work Plan</h3>
                        </div>
                        <div class="work-card" id="updateWorkCard" onclick="openUpdateWorkModal()" style="cursor: pointer; width: 180px; height: 180px; padding: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; box-sizing: border-box;">
                            <i class="fas fa-edit"></i>
                            <h3>Update Today's Work</h3>
                        </div>
                        <div class="work-card" id="sprintPlanCard" onclick="openSprintPlanModal()" style="cursor: pointer; width: 180px; height: 180px; padding: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; box-sizing: border-box;">
                            <i class="fas fa-calendar-week"></i>
                            <h3>Submit Sprint Plan</h3>
                        </div>
                        <div class="work-card" id="lastWeekSprintCard" onclick="openLastWeekSprintModal()" style="cursor: pointer; width: 180px; height: 180px; padding: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; box-sizing: border-box;">
                            <i class="fas fa-calendar-check"></i>
                            <h3>Submit Last Week Sprint</h3>
                        </div>
                    </div>
                    
                    <!-- Second Row: 3 cards -->
                    <div style="display: flex; justify-content: center; gap: 30px; flex-wrap: wrap; width: 100%;">
                        <div class="work-card" id="extraWorkCard" onclick="openExtraWorkModal()" style="cursor: pointer; width: 180px; height: 180px; padding: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; box-sizing: border-box;">
                            <i class="fas fa-plus-circle"></i>
                            <h3>Extra Work</h3>
                        </div>
                        <div class="work-card" id="leaveApprovalCard" onclick="openLeaveApprovalModal()" style="cursor: pointer; width: 180px; height: 180px; padding: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; box-sizing: border-box;">
                            <i class="fas fa-umbrella-beach"></i>
                            <h3>Leave Approval Request</h3>
                        </div>
                        <div class="work-card" id="complaintCard" onclick="openComplaintModal()" style="cursor: pointer; width: 180px; height: 180px; padding: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; box-sizing: border-box;">
                            <i class="fas fa-exclamation-triangle"></i>
                            <h3>Complaint About Team</h3>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>
    


            <!-- Website VAPT First Audit Modal -->
            <div id="websiteVaptFirstAuditModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Website VAPT First Audit Details</h3>
                        <span class="close-modal" onclick="closeVaptModal('websiteVaptFirstAuditModal')">&times;</span>
                    </div>
                    <div class="modal-body scrollable-content">
                        <form id="websiteVaptFirstAuditForm" action="/process_website_vapt_first_audit_report" method="POST" enctype="multipart/form-data">
                            <!-- Organization Section -->
                            <div class="form-group">
                                <label for="websiteVaptOrganization">Organization Name*</label>
                                <div class="combo-input">
                                    <select id="websiteVaptOrganization" name="organization" required onchange="toggleVaptOtherInput('websiteVaptOrganization', 'websiteVaptOtherOrganization')">
                                        <option value="">Select Organization</option>
                                        <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                        <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                        <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                        <option value="Megasoft Limited">Megasoft Limited</option>
                                        <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                        <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                        <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                        <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                        <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                        <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                        <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                        <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                        <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                        <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                        <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                        <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                        <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                        <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                        <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                        <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                        <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                        <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                        <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                        <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                        <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                        <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                        <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                        <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                        <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                        <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                        <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                        <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                        <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                        <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                        <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                        <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                        <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                        <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                        <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                        <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                        
            
                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="websiteVaptOtherOrganization" name="otherOrganization" class="hidden" placeholder="Enter Organization Name">
                                </div>
                            </div>

                            <!-- Location Section -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="websiteVaptCity">City*</label>
                                    <div class="combo-input">
                                        <select id="websiteVaptCity" name="city" required onchange="toggleVaptOtherInput('websiteVaptCity', 'websiteVaptOtherCity')">
                                            <option value="">Select City</option>
                                            <option value="Ahmedabad">Ahmedabad</option>
                                            <option value="Amreli">Amreli</option>
                                            <option value="Anand">Anand</option>
                                            <option value="Aravalli">Aravalli</option>
                                            <option value="Banaskantha">Banaskantha</option>
                                            <option value="Bharuch">Bharuch</option>
                                            <option value="Bhavnagar">Bhavnagar</option>
                                            <option value="Botad">Botad</option>
                                            <option value="Chhota Udaipur">Chhota Udaipur</option>
                                            <option value="Dahod">Dahod</option>
                                            <option value="Dang">Dang</option>
                                            <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                            <option value="Gandhinagar">Gandhinagar</option>
                                            <option value="Gir Somnath">Gir Somnath</option>
                                            <option value="Jamnagar">Jamnagar</option>
                                            <option value="Junagadh">Junagadh</option>
                                            <option value="Kheda">Kheda</option>
                                            <option value="Kutch">Kutch</option>
                                            <option value="Mahisagar">Mahisagar</option>
                                            <option value="Mehsana">Mehsana</option>
                                            <option value="Morbi">Morbi</option>
                                            <option value="Narmada">Narmada</option>
                                            <option value="Navsari">Navsari</option>
                                            <option value="Patan">Patan</option>
                                            <option value="Panchmahal">Panchmahal</option>
                                            <option value="Porbandar">Porbandar</option>
                                            <option value="Rajkot">Rajkot</option>
                                            <option value="Sabarkantha">Sabarkantha</option>
                                            <option value="Surat">Surat</option>
                                            <option value="Surendranagar">Surendranagar</option>
                                            <option value="Tapi">Tapi</option>
                                            <option value="Vadodara">Vadodara</option>
                                            <option value="Valsad">Valsad</option>
                
                                            <!-- Rajasthan -->
                                            <option value="Ajmer">Ajmer</option>
                                            <option value="Alwar">Alwar</option>
                                            <option value="Banswara">Banswara</option>
                                            <option value="Baran">Baran</option>
                                            <option value="Barmer">Barmer</option>
                                            <option value="Bharatpur">Bharatpur</option>
                                            <option value="Bhilwara">Bhilwara</option>
                                            <option value="Bikaner">Bikaner</option>
                                            <option value="Bundi">Bundi</option>
                                            <option value="Chittorgarh">Chittorgarh</option>
                                            <option value="Churu">Churu</option>
                                            <option value="Dausa">Dausa</option>
                                            <option value="Dholpur">Dholpur</option>
                                            <option value="Dungarpur">Dungarpur</option>
                                            <option value="Hanumangarh">Hanumangarh</option>
                                            <option value="Jaipur">Jaipur</option>
                                            <option value="Jaisalmer">Jaisalmer</option>
                                            <option value="Jalore">Jalore</option>
                                            <option value="Jhalawar">Jhalawar</option>
                                            <option value="Jhunjhunu">Jhunjhunu</option>
                                            <option value="Jodhpur">Jodhpur</option>
                                            <option value="Karauli">Karauli</option>
                                            <option value="Kota">Kota</option>
                                            <option value="Nagaur">Nagaur</option>
                                            <option value="Pali">Pali</option>
                                            <option value="Pratapgarh">Pratapgarh</option>
                                            <option value="Rajsamand">Rajsamand</option>
                                            <option value="Sikar">Sikar</option>
                                            <option value="Sirohi">Sirohi</option>
                                            <option value="Sri Ganganagar">Sri Ganganagar</option>
                                            <option value="Tonk">Tonk</option>
                                            <option value="Udaipur">Udaipur</option>
                
                                            <!-- Maharashtra -->
                                            <option value="Ahmednagar">Ahmednagar</option>
                                            <option value="Akola">Akola</option>
                                            <option value="Amravati">Amravati</option>
                                            <option value="Aurangabad">Aurangabad</option>
                                            <option value="Beed">Beed</option>
                                            <option value="Bhandara">Bhandara</option>
                                            <option value="Chandrapur">Chandrapur</option>
                                            <option value="Dhule">Dhule</option>
                                            <option value="Gadchiroli">Gadchiroli</option>
                                            <option value="Gondia">Gondia</option>
                                            <option value="Hingoli">Hingoli</option>
                                            <option value="Jalgaon">Jalgaon</option>
                                            <option value="Jalna">Jalna</option>
                                            <option value="Kolhapur">Kolhapur</option>
                                            <option value="Latur">Latur</option>
                                            <option value="Mumbai City">Mumbai City</option>
                                            <option value="Mumbai Suburban">Mumbai Suburban</option>
                                            <option value="Nagpur">Nagpur</option>
                                            <option value="Nanded">Nanded</option>
                                            <option value="Nandurbar">Nandurbar</option>
                                            <option value="Nashik">Nashik</option>
                                            <option value="Osmanabad">Osmanabad</option>
                                            <option value="Palghar">Palghar</option>
                                            <option value="Parbhani">Parbhani</option>
                                            <option value="Pune">Pune</option>
                                            <option value="Raigad">Raigad</option>
                                            <option value="Ratnagiri">Ratnagiri</option>
                                            <option value="Sangli">Sangli</option>
                                            <option value="Satara">Satara</option>
                                            <option value="Sindhudurg">Sindhudurg</option>
                                            <option value="Solapur">Solapur</option>
                                            <option value="Thane">Thane</option>
                                            <option value="Wardha">Wardha</option>
                                            <option value="Washim">Washim</option>
                                            <option value="Yavatmal">Yavatmal</option>
                
                                            <!-- Uttar Pradesh -->
                                            <option value="Agra">Agra</option>
                                            <option value="Aligarh">Aligarh</option>
                                            <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                            <option value="Amethi">Amethi</option>
                                            <option value="Amroha">Amroha</option>
                                            <option value="Auraiya">Auraiya</option>
                                            <option value="Ayodhya">Ayodhya</option>
                                            <option value="Azamgarh">Azamgarh</option>
                                            <option value="Bagpat">Bagpat</option>
                                            <option value="Bahraich">Bahraich</option>
                                            <option value="Ballia">Ballia</option>
                                            <option value="Balrampur">Balrampur</option>
                                            <option value="Banda">Banda</option>
                                            <option value="Barabanki">Barabanki</option>
                                            <option value="Bareilly">Bareilly</option>
                                            <option value="Basti">Basti</option>
                                            <option value="Bhadohi">Bhadohi</option>
                                            <option value="Bijnor">Bijnor</option>
                                            <option value="Bulandshahr">Bulandshahr</option>
                                            <option value="Chandauli">Chandauli</option>
                                            <option value="Chitrakoot">Chitrakoot</option>
                                            <option value="Deoria">Deoria</option>
                                            <option value="Etah">Etah</option>
                                            <option value="Etawah">Etawah</option>
                                            <option value="Farrukhabad">Farrukhabad</option>
                                            <option value="Fatehpur">Fatehpur</option>
                                            <option value="Firozabad">Firozabad</option>
                                            <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                            <option value="Ghaziabad">Ghaziabad</option>
                                            <option value="Ghazipur">Ghazipur</option>
                                            <option value="Gonda">Gonda</option>
                                            <option value="Gorakhpur">Gorakhpur</option>
                                            <option value="Hamirpur">Hamirpur</option>
                                            <option value="Hapur">Hapur</option>
                                            <option value="Hardoi">Hardoi</option>
                                            <option value="Hathras">Hathras</option>
                                            <option value="Jalaun">Jalaun</option>
                                            <option value="Jaunpur">Jaunpur</option>
                                            <option value="Jhansi">Jhansi</option>
                                            <option value="Kannauj">Kannauj</option>
                                            <option value="Kanpur Dehat">Kanpur Dehat</option>
                                            <option value="Kanpur Nagar">Kanpur Nagar</option>
                                            <option value="Kasganj">Kasganj</option>
                                            <option value="Kaushambi">Kaushambi</option>
                                            <option value="Kushinagar">Kushinagar</option>
                                            <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                            <option value="Lalitpur">Lalitpur</option>
                                            <option value="Lucknow">Lucknow</option>
                                            <option value="Maharajganj">Maharajganj</option>
                                            <option value="Mahoba">Mahoba</option>
                                            <option value="Mainpuri">Mainpuri</option>
                                            <option value="Mathura">Mathura</option>
                                            <option value="Mau">Mau</option>
                                            <option value="Meerut">Meerut</option>
                                            <option value="Mirzapur">Mirzapur</option>
                                            <option value="Moradabad">Moradabad</option>
                                            <option value="Muzaffarnagar">Muzaffarnagar</option>
                                            <option value="Pilibhit">Pilibhit</option>
                                            <option value="Pratapgarh">Pratapgarh</option>
                                            <option value="Rae Bareli">Rae Bareli</option>
                                            <option value="Rampur">Rampur</option>
                                            <option value="Saharanpur">Saharanpur</option>
                                            <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                            <option value="Shahjahanpur">Shahjahanpur</option>
                                            <option value="Shravasti">Shravasti</option>
                                            <option value="Siddharthnagar">Siddharthnagar</option>
                                            <option value="Sitapur">Sitapur</option>
                                            <option value="Sonbhadra">Sonbhadra</option>
                                            <option value="Sultanpur">Sultanpur</option>
                                            <option value="Unnao">Unnao</option>
                                            <option value="Varanasi">Varanasi</option>
                
                                            <!-- Uttarakhand -->
                                            <option value="Almora">Almora</option>
                                            <option value="Bageshwar">Bageshwar</option>
                                            <option value="Chamoli">Chamoli</option>
                                            <option value="Champawat">Champawat</option>
                                            <option value="Dehradun">Dehradun</option>
                                            <option value="Haridwar">Haridwar</option>
                                            <option value="Nainital">Nainital</option>
                                            <option value="Pauri Garhwal">Pauri Garhwal</option>
                                            <option value="Pithoragarh">Pithoragarh</option>
                                            <option value="Rudraprayag">Rudraprayag</option>
                                            <option value="Tehri Garhwal">Tehri Garhwal</option>
                                            <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                            <option value="Uttarkashi">Uttarkashi</option>
                                                            <option value="other">Other (Please specify)</option>
                                        </select>
                                        <input type="text" id="websiteVaptOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="websiteVaptState">State*</label>
                                    <select id="websiteVaptState" name="state" required>
                                        <option value="">Select State</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                        <option value="Assam">Assam</option>
                                        <option value="Bihar">Bihar</option>
                                        <option value="Chhattisgarh">Chhattisgarh</option>
                                        <option value="Goa">Goa</option>
                                        <option value="Gujarat">Gujarat</option>
                                        <option value="Haryana">Haryana</option>
                                        <option value="Himachal Pradesh">Himachal Pradesh</option>
                                        <option value="Jharkhand">Jharkhand</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Kerala">Kerala</option>
                                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Manipur">Manipur</option>
                                        <option value="Meghalaya">Meghalaya</option>
                                        <option value="Mizoram">Mizoram</option>
                                        <option value="Nagaland">Nagaland</option>
                                        <option value="Odisha">Odisha</option>
                                        <option value="Punjab">Punjab</option>
                                        <option value="Rajasthan">Rajasthan</option>
                                        <option value="Sikkim">Sikkim</option>
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="Telangana">Telangana</option>
                                        <option value="Tripura">Tripura</option>
                                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                                        <option value="Uttarakhand">Uttarakhand</option>
                                        <option value="West Bengal">West Bengal</option>
                                        <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                        <option value="Chandigarh">Chandigarh</option>
                                        <option value="Dadra and Nagar Haveli and Daman and Diu">Dadra and Nagar Haveli and Daman and Diu</option>
                                        <option value="Delhi">Delhi</option>
                                        <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                                        <option value="Ladakh">Ladakh</option>
                                        <option value="Lakshadweep">Lakshadweep</option>
                                        <option value="Puducherry">Puducherry</option>
                                        
                                    </select>
                                </div>
                            </div>

                            <!-- Audit Dates -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="websiteVaptStartDate">Start Audit Date*</label>
                                    <input type="date" id="websiteVaptStartDate" name="startDate" required>
                                </div>
                                <div class="form-group">
                                    <label for="websiteVaptEndDate">Finish Audit Date*</label>
                                    <input type="date" id="websiteVaptEndDate" name="endDate" required>
                                </div>
                            </div>

                            <!-- Report Prepared By -->
                            <div class="form-group">
                                <label>Report Prepared By*</label>
                                <div class="name-input">
                                    <select class="title-select" name="preparedByTitle" required>
                                        <option value="Mr.">Mr.</option>
                                        <option value="Ms.">Ms.</option>
                                        <option value="Mrs.">Mrs.</option>
                                        <option value="Dr.">Dr.</option>
                                    </select>
                                    <input type="text" placeholder="Full Name" name="preparedByName" required>
                                </div>
                            </div>

                            <!-- Auditee Details -->
                            <div class="form-group">
                                <label>Name of Auditee Organization Person*</label>
                                <div class="name-input">
                                    <select class="title-select" name="auditeeTitle" required>
                                        <option value="Mr.">Mr.</option>
                                        <option value="Ms.">Ms.</option>
                                        <option value="Mrs.">Mrs.</option>
                                        <option value="Dr.">Dr.</option>
                                    </select>
                                    <input type="text" placeholder="Full Name" name="auditeeName" required>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptDesignation">Designation of the Person*</label>
                                <input type="text" id="websiteVaptDesignation" name="designation" required>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptBankEmail">Email ID of the Organization*</label>
                                <div id="websiteVaptEmailContainer">
                                    <input type="email" name="bankEmail[]" placeholder="Email Address" required>
                                </div>
                                <button type="button" class="add-member-btn" id="websiteVaptAddEmailBtn" style="margin-top: 10px;">+ Add Another Email</button>
                            </div>

                            <!-- Auditing Team -->
                            <div class="form-group">
                                <label>Details of Auditing Team* (At least 1 required, max 8)</label>
                                <div id="websiteVaptAuditTeamContainer">
                                    <div class="team-member" data-index="0">
                                        <div class="form-row">
                                            <div class="form-group">
                                                <input type="text" name="teamName[]" placeholder="Name*" required>
                                            </div>
                                            <div class="form-group">
                                                <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                                            </div>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                                            </div>
                                            <div class="form-group">
                                                <input type="text" name="teamQualification[]" placeholder="Qualification/Certification*" required>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label>Certified (Yes/No)*</label>
                                            <div class="radio-group">
                                                <label><input type="radio" name="teamCertified[0]" value="yes" required> Yes</label>
                                                <label><input type="radio" name="teamCertified[0]" value="no"> No</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <button type="button" class="add-member-btn" id="websiteVaptAddMemberBtn">+ Add Team Member</button>
                            </div>

                            <!-- File Uploads -->
                            <div class="form-group">
                                <label>File Uploads*</label>
                                
                                <div class="file-upload-group">
                                    <label for="websiteVaptNmapFiles">Nmap Zip Files</label>
                                    <input type="file" id="websiteVaptNmapFiles" name="nmapFiles" accept=".zip" required>
                                    <small class="file-help" style="color: brown;">All Nmap files must be placed directly in the ZIP file (no nested folders) and must be in CSV format.</small>
                                </div>
                                
                                <div class="file-upload-group">
                                    <label for="websiteVaptNessusFiles">Nessus Zip Files</label>
                                    <input type="file" id="websiteVaptNessusFiles" name="nessusFiles" accept=".zip" required>
                                    <small class="file-help" style="color: brown;">All Nessus files must be placed directly inside a single ZIP file with no nested folders.</small>
                                </div>
                                
                                <div class="file-upload-group">
                                    <label for="websiteVaptEvidenceFiles">Evidences Zip Files</label>
                                    <input type="file" id="websiteVaptEvidenceFiles" name="evidenceFiles" accept=".zip">
                                    <small class="file-help" style="color: brown;">The evidence ZIP file must include a folder named "ALL POC" containing evidence images. File names must exactly match vulnerability names.</small>
                                </div>
                            </div>

                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('websiteVaptFirstAuditModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Submit Report</button>
                            </div>
                            <br>
                            <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>  
                            </small>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Website VAPT Follow-up Audit Modal -->
            <div id="websiteVaptFollowUpAuditModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Website VAPT Follow Up Audit Details</h3>
                        <span class="close-modal" onclick="closeVaptModal('websiteVaptFollowUpAuditModal')">&times;</span>
                    </div>
                    <div class="modal-body scrollable-content">
                        <form id="websiteVaptFollowUpAuditForm" action="/process_website_vapt_follow_up_audit_report" method="POST" enctype="multipart/form-data">
                            <!-- Organization Section -->
                            <div class="form-group">
                                <label for="websiteVaptFollowUpOrganization">Organization Name*</label>
                                <div class="combo-input">
                                    <select id="websiteVaptFollowUpOrganization" name="organization" required onchange="toggleVaptOtherInput('websiteVaptFollowUpOrganization', 'websiteVaptFollowUpOtherOrganization')">
                                        <option value="">Select Organization</option>
                                        <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                        <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                        <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                        <option value="Megasoft Limited">Megasoft Limited</option>
                                        <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                        <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                        <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                        <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                        <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                        <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                        <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                        <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                        <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                        <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                        <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                        <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                        <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                        <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                        <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                        <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                        <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                        <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                        <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                        <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                        <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                        <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                        <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                        <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                        <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                        <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                        <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                        <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                        <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                        <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                        <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                        <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                        <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                        <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                        <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                        <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                        
            
                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="websiteVaptFollowUpOtherOrganization" name="otherOrganization" class="hidden" placeholder="Enter Organization Name">
                                </div>
                            </div>

                            <!-- Location Section -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="websiteVaptFollowUpCity">City*</label>
                                    <div class="combo-input">
                                        <select id="websiteVaptFollowUpCity" name="city" required onchange="toggleVaptOtherInput('websiteVaptFollowUpCity', 'websiteVaptFollowUpOtherCity')">
                                            <option value="">Select City</option>
                                            <option value="Ahmedabad">Ahmedabad</option>
                                            <option value="Amreli">Amreli</option>
                                            <option value="Anand">Anand</option>
                                            <option value="Aravalli">Aravalli</option>
                                            <option value="Banaskantha">Banaskantha</option>
                                            <option value="Bharuch">Bharuch</option>
                                            <option value="Bhavnagar">Bhavnagar</option>
                                            <option value="Botad">Botad</option>
                                            <option value="Chhota Udaipur">Chhota Udaipur</option>
                                            <option value="Dahod">Dahod</option>
                                            <option value="Dang">Dang</option>
                                            <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                            <option value="Gandhinagar">Gandhinagar</option>
                                            <option value="Gir Somnath">Gir Somnath</option>
                                            <option value="Jamnagar">Jamnagar</option>
                                            <option value="Junagadh">Junagadh</option>
                                            <option value="Kheda">Kheda</option>
                                            <option value="Kutch">Kutch</option>
                                            <option value="Mahisagar">Mahisagar</option>
                                            <option value="Mehsana">Mehsana</option>
                                            <option value="Morbi">Morbi</option>
                                            <option value="Narmada">Narmada</option>
                                            <option value="Navsari">Navsari</option>
                                            <option value="Patan">Patan</option>
                                            <option value="Panchmahal">Panchmahal</option>
                                            <option value="Porbandar">Porbandar</option>
                                            <option value="Rajkot">Rajkot</option>
                                            <option value="Sabarkantha">Sabarkantha</option>
                                            <option value="Surat">Surat</option>
                                            <option value="Surendranagar">Surendranagar</option>
                                            <option value="Tapi">Tapi</option>
                                            <option value="Vadodara">Vadodara</option>
                                            <option value="Valsad">Valsad</option>
                
                                            <!-- Rajasthan -->
                                            <option value="Ajmer">Ajmer</option>
                                            <option value="Alwar">Alwar</option>
                                            <option value="Banswara">Banswara</option>
                                            <option value="Baran">Baran</option>
                                            <option value="Barmer">Barmer</option>
                                            <option value="Bharatpur">Bharatpur</option>
                                            <option value="Bhilwara">Bhilwara</option>
                                            <option value="Bikaner">Bikaner</option>
                                            <option value="Bundi">Bundi</option>
                                            <option value="Chittorgarh">Chittorgarh</option>
                                            <option value="Churu">Churu</option>
                                            <option value="Dausa">Dausa</option>
                                            <option value="Dholpur">Dholpur</option>
                                            <option value="Dungarpur">Dungarpur</option>
                                            <option value="Hanumangarh">Hanumangarh</option>
                                            <option value="Jaipur">Jaipur</option>
                                            <option value="Jaisalmer">Jaisalmer</option>
                                            <option value="Jalore">Jalore</option>
                                            <option value="Jhalawar">Jhalawar</option>
                                            <option value="Jhunjhunu">Jhunjhunu</option>
                                            <option value="Jodhpur">Jodhpur</option>
                                            <option value="Karauli">Karauli</option>
                                            <option value="Kota">Kota</option>
                                            <option value="Nagaur">Nagaur</option>
                                            <option value="Pali">Pali</option>
                                            <option value="Pratapgarh">Pratapgarh</option>
                                            <option value="Rajsamand">Rajsamand</option>
                                            <option value="Sikar">Sikar</option>
                                            <option value="Sirohi">Sirohi</option>
                                            <option value="Sri Ganganagar">Sri Ganganagar</option>
                                            <option value="Tonk">Tonk</option>
                                            <option value="Udaipur">Udaipur</option>
                
                                            <!-- Maharashtra -->
                                            <option value="Ahmednagar">Ahmednagar</option>
                                            <option value="Akola">Akola</option>
                                            <option value="Amravati">Amravati</option>
                                            <option value="Aurangabad">Aurangabad</option>
                                            <option value="Beed">Beed</option>
                                            <option value="Bhandara">Bhandara</option>
                                            <option value="Chandrapur">Chandrapur</option>
                                            <option value="Dhule">Dhule</option>
                                            <option value="Gadchiroli">Gadchiroli</option>
                                            <option value="Gondia">Gondia</option>
                                            <option value="Hingoli">Hingoli</option>
                                            <option value="Jalgaon">Jalgaon</option>
                                            <option value="Jalna">Jalna</option>
                                            <option value="Kolhapur">Kolhapur</option>
                                            <option value="Latur">Latur</option>
                                            <option value="Mumbai City">Mumbai City</option>
                                            <option value="Mumbai Suburban">Mumbai Suburban</option>
                                            <option value="Nagpur">Nagpur</option>
                                            <option value="Nanded">Nanded</option>
                                            <option value="Nandurbar">Nandurbar</option>
                                            <option value="Nashik">Nashik</option>
                                            <option value="Osmanabad">Osmanabad</option>
                                            <option value="Palghar">Palghar</option>
                                            <option value="Parbhani">Parbhani</option>
                                            <option value="Pune">Pune</option>
                                            <option value="Raigad">Raigad</option>
                                            <option value="Ratnagiri">Ratnagiri</option>
                                            <option value="Sangli">Sangli</option>
                                            <option value="Satara">Satara</option>
                                            <option value="Sindhudurg">Sindhudurg</option>
                                            <option value="Solapur">Solapur</option>
                                            <option value="Thane">Thane</option>
                                            <option value="Wardha">Wardha</option>
                                            <option value="Washim">Washim</option>
                                            <option value="Yavatmal">Yavatmal</option>
                
                                            <!-- Uttar Pradesh -->
                                            <option value="Agra">Agra</option>
                                            <option value="Aligarh">Aligarh</option>
                                            <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                            <option value="Amethi">Amethi</option>
                                            <option value="Amroha">Amroha</option>
                                            <option value="Auraiya">Auraiya</option>
                                            <option value="Ayodhya">Ayodhya</option>
                                            <option value="Azamgarh">Azamgarh</option>
                                            <option value="Bagpat">Bagpat</option>
                                            <option value="Bahraich">Bahraich</option>
                                            <option value="Ballia">Ballia</option>
                                            <option value="Balrampur">Balrampur</option>
                                            <option value="Banda">Banda</option>
                                            <option value="Barabanki">Barabanki</option>
                                            <option value="Bareilly">Bareilly</option>
                                            <option value="Basti">Basti</option>
                                            <option value="Bhadohi">Bhadohi</option>
                                            <option value="Bijnor">Bijnor</option>
                                            <option value="Bulandshahr">Bulandshahr</option>
                                            <option value="Chandauli">Chandauli</option>
                                            <option value="Chitrakoot">Chitrakoot</option>
                                            <option value="Deoria">Deoria</option>
                                            <option value="Etah">Etah</option>
                                            <option value="Etawah">Etawah</option>
                                            <option value="Farrukhabad">Farrukhabad</option>
                                            <option value="Fatehpur">Fatehpur</option>
                                            <option value="Firozabad">Firozabad</option>
                                            <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                            <option value="Ghaziabad">Ghaziabad</option>
                                            <option value="Ghazipur">Ghazipur</option>
                                            <option value="Gonda">Gonda</option>
                                            <option value="Gorakhpur">Gorakhpur</option>
                                            <option value="Hamirpur">Hamirpur</option>
                                            <option value="Hapur">Hapur</option>
                                            <option value="Hardoi">Hardoi</option>
                                            <option value="Hathras">Hathras</option>
                                            <option value="Jalaun">Jalaun</option>
                                            <option value="Jaunpur">Jaunpur</option>
                                            <option value="Jhansi">Jhansi</option>
                                            <option value="Kannauj">Kannauj</option>
                                            <option value="Kanpur Dehat">Kanpur Dehat</option>
                                            <option value="Kanpur Nagar">Kanpur Nagar</option>
                                            <option value="Kasganj">Kasganj</option>
                                            <option value="Kaushambi">Kaushambi</option>
                                            <option value="Kushinagar">Kushinagar</option>
                                            <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                            <option value="Lalitpur">Lalitpur</option>
                                            <option value="Lucknow">Lucknow</option>
                                            <option value="Maharajganj">Maharajganj</option>
                                            <option value="Mahoba">Mahoba</option>
                                            <option value="Mainpuri">Mainpuri</option>
                                            <option value="Mathura">Mathura</option>
                                            <option value="Mau">Mau</option>
                                            <option value="Meerut">Meerut</option>
                                            <option value="Mirzapur">Mirzapur</option>
                                            <option value="Moradabad">Moradabad</option>
                                            <option value="Muzaffarnagar">Muzaffarnagar</option>
                                            <option value="Pilibhit">Pilibhit</option>
                                            <option value="Pratapgarh">Pratapgarh</option>
                                            <option value="Rae Bareli">Rae Bareli</option>
                                            <option value="Rampur">Rampur</option>
                                            <option value="Saharanpur">Saharanpur</option>
                                            <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                            <option value="Shahjahanpur">Shahjahanpur</option>
                                            <option value="Shravasti">Shravasti</option>
                                            <option value="Siddharthnagar">Siddharthnagar</option>
                                            <option value="Sitapur">Sitapur</option>
                                            <option value="Sonbhadra">Sonbhadra</option>
                                            <option value="Sultanpur">Sultanpur</option>
                                            <option value="Unnao">Unnao</option>
                                            <option value="Varanasi">Varanasi</option>
                
                                            <!-- Uttarakhand -->
                                            <option value="Almora">Almora</option>
                                            <option value="Bageshwar">Bageshwar</option>
                                            <option value="Chamoli">Chamoli</option>
                                            <option value="Champawat">Champawat</option>
                                            <option value="Dehradun">Dehradun</option>
                                            <option value="Haridwar">Haridwar</option>
                                            <option value="Nainital">Nainital</option>
                                            <option value="Pauri Garhwal">Pauri Garhwal</option>
                                            <option value="Pithoragarh">Pithoragarh</option>
                                            <option value="Rudraprayag">Rudraprayag</option>
                                            <option value="Tehri Garhwal">Tehri Garhwal</option>
                                            <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                            <option value="Uttarkashi">Uttarkashi</option>
                                                            <option value="other">Other (Please specify)</option>
                                        </select>
                                        <input type="text" id="websiteVaptFollowUpOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="websiteVaptFollowUpState">State*</label>
                                    <select id="websiteVaptFollowUpState" name="state" required>
                                        <option value="">Select State</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                        <option value="Assam">Assam</option>
                                        <option value="Bihar">Bihar</option>
                                        <option value="Chhattisgarh">Chhattisgarh</option>
                                        <option value="Goa">Goa</option>
                                        <option value="Gujarat">Gujarat</option>
                                        <option value="Haryana">Haryana</option>
                                        <option value="Himachal Pradesh">Himachal Pradesh</option>
                                        <option value="Jharkhand">Jharkhand</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Kerala">Kerala</option>
                                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Manipur">Manipur</option>
                                        <option value="Meghalaya">Meghalaya</option>
                                        <option value="Mizoram">Mizoram</option>
                                        <option value="Nagaland">Nagaland</option>
                                        <option value="Odisha">Odisha</option>
                                        <option value="Punjab">Punjab</option>
                                        <option value="Rajasthan">Rajasthan</option>
                                        <option value="Sikkim">Sikkim</option>
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="Telangana">Telangana</option>
                                        <option value="Tripura">Tripura</option>
                                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                                        <option value="Uttarakhand">Uttarakhand</option>
                                        <option value="West Bengal">West Bengal</option>
                                        <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                        <option value="Chandigarh">Chandigarh</option>
                                        <option value="Dadra and Nagar Haveli and Daman and Diu">Dadra and Nagar Haveli and Daman and Diu</option>
                                        <option value="Delhi">Delhi</option>
                                        <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                                        <option value="Ladakh">Ladakh</option>
                                        <option value="Lakshadweep">Lakshadweep</option>
                                        <option value="Puducherry">Puducherry</option>
                                        
                                    </select>
                                </div>
                            </div>

                            <!-- First Audit Report Details -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="websiteVaptFollowUpFirstAuditReportId">First Audit Report ID*</label>
                                    <input type="text" id="websiteVaptFollowUpFirstAuditReportId" name="firstAuditReportId" placeholder="Enter First Audit Report ID" required>
                                </div>
                                <div class="form-group">
                                    <label for="websiteVaptFollowUpFirstAuditReportDate">First Audit Report Release Date*</label>
                                    <input type="date" id="websiteVaptFollowUpFirstAuditReportDate" name="firstAuditReportDate" required>
                                </div>
                            </div>

                            <!-- Audit Dates -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="websiteVaptFollowUpStartDate">Start Audit Date*</label>
                                    <input type="date" id="websiteVaptFollowUpStartDate" name="startDate" required>
                                </div>
                                <div class="form-group">
                                    <label for="websiteVaptFollowUpEndDate">Finish Audit Date*</label>
                                    <input type="date" id="websiteVaptFollowUpEndDate" name="endDate" required>
                                </div>
                            </div>

                            <!-- Report Prepared By -->
                            <div class="form-group">
                                <label>Report Prepared By*</label>
                                <div class="name-input">
                                    <select class="title-select" name="preparedByTitle" required>
                                        <option value="Mr.">Mr.</option>
                                        <option value="Ms.">Ms.</option>
                                        <option value="Mrs.">Mrs.</option>
                                        <option value="Dr.">Dr.</option>
                                    </select>
                                    <input type="text" placeholder="Full Name" name="preparedByName" required>
                                </div>
                            </div>

                            <!-- Auditee Details -->
                            <div class="form-group">
                                <label>Name of Auditee Organization Person*</label>
                                <div class="name-input">
                                    <select class="title-select" name="auditeeTitle" required>
                                        <option value="Mr.">Mr.</option>
                                        <option value="Ms.">Ms.</option>
                                        <option value="Mrs.">Mrs.</option>
                                        <option value="Dr.">Dr.</option>
                                    </select>
                                    <input type="text" placeholder="Full Name" name="auditeeName" required>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpDesignation">Designation of the Person*</label>
                                <input type="text" id="websiteVaptFollowUpDesignation" name="designation" required>
                            </div>

                            <div class="form-group">
                                <label for="websiteVaptFollowUpBankEmail">Email ID of the Organization*</label>
                                <div id="websiteVaptFollowUpEmailContainer">
                                    <input type="email" name="bankEmail[]" placeholder="Email Address" required>
                                </div>
                                <button type="button" class="add-member-btn" id="websiteVaptAddFollowUpEmailBtn" style="margin-top: 10px;">+ Add Another Email</button>
                            </div>

                            <!-- Auditing Team -->
                            <div class="form-group">
                                <label>Details of Auditing Team* (At least 1 required, max 8)</label>
                                <div id="websiteVaptFollowUpAuditTeamContainer">
                                    <div class="team-member" data-index="0">
                                        <div class="form-row">
                                            <div class="form-group">
                                                <input type="text" name="teamName[]" placeholder="Name*" required>
                                            </div>
                                            <div class="form-group">
                                                <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                                            </div>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group">
                                                <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                                            </div>
                                            <div class="form-group">
                                                <input type="text" name="teamQualification[]" placeholder="Qualification/Certification*" required>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label>Certified (Yes/No)*</label>
                                            <div class="radio-group">
                                                <label><input type="radio" name="teamCertified[0]" value="yes" required> Yes</label>
                                                <label><input type="radio" name="teamCertified[0]" value="no"> No</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <button type="button" class="add-member-btn" id="websiteVaptAddFollowUpMemberBtn">+ Add Team Member</button>
                            </div>

                            <!-- Old Excel File Upload -->
                            <div class="form-group">
                                <label for="websiteVaptFollowUpOldExcelFile">Old Excel File (First Audit)*</label>
                                <input type="file" id="websiteVaptFollowUpOldExcelFile" name="userExcelFile" accept=".xlsx" required>
                                <small class="file-help" style="color: brown;">Upload the Excel file from the First Audit to carry forward resolved vulnerabilities and their evidence.</small>
                            </div>

                            <!-- File Uploads -->
                            <div class="form-group">
                                <label>File Uploads*</label>
                                
                                <div class="file-upload-group">
                                    <label for="websiteVaptFollowUpNmapFiles">Nmap Zip Files</label>
                                    <input type="file" id="websiteVaptFollowUpNmapFiles" name="nmapFiles" accept=".zip" required>
                                    <small class="file-help" style="color: brown;">All Nmap files must be placed directly in the ZIP file (no nested folders) and must be in CSV format.</small>
                                </div>
                                
                                <div class="file-upload-group">
                                    <label for="websiteVaptFollowUpNessusFiles">Nessus Zip Files</label>
                                    <input type="file" id="websiteVaptFollowUpNessusFiles" name="nessusFiles" accept=".zip" required>
                                    <small class="file-help" style="color: brown;">All Nessus files must be placed directly inside a single ZIP file with no nested folders.</small>
                                </div>
                                
                                <div class="file-upload-group">
                                    <label for="websiteVaptFollowUpEvidenceFiles">New Evidences Zip Files</label>
                                    <input type="file" id="websiteVaptFollowUpEvidenceFiles" name="evidenceFiles" accept=".zip" required>
                                    <small class="file-help" style="color: brown;">Upload new evidence for current follow-up audit vulnerabilities.</small>
                                </div>
                            </div>

                            <div class="form-actions">
                                <button type="button" class="cancel-btn" onclick="closeVaptModal('websiteVaptFollowUpAuditModal')">Cancel</button>
                                <button type="submit" class="submit-btn">Submit Report</button>
                            </div>
                            <br>
                            <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>  
                            </small>
                        </form>
                    </div>
                </div>
            </div>


        </div>
    </div>
    
    <!-- Public IP VAPT First Audit Modal -->
    <div id="publicIpFirstAuditModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Public IP VAPT First Audit Details</h3>
                <span class="close-modal" onclick="closeVaptModal('publicIpFirstAuditModal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="publicIpFirstAuditForm" action="/process_public_ip_vapt_first_audit_report" method="POST" enctype="multipart/form-data">
                    <!-- Organization Section -->
                    <div class="form-group">
                        <label for="publicIpOrganization">Organization Name*</label>
                        <div class="combo-input">
                            <select id="publicIpOrganization" name="organization" required onchange="toggleVaptOtherInput('publicIpOrganization', 'publicIpOtherOrganization')">
                                <option value="">Select Organization</option>
                                <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                <option value="Megasoft Limited">Megasoft Limited</option>
                                <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                
    
                                <option value="other">Other (Please specify)</option>
                            </select>
                            <input type="text" id="publicIpOtherOrganization" name="otherOrganization" class="hidden" placeholder="Enter Organization Name">
                        </div>
                    </div>

                    <!-- Location Section -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="publicIpCity">City*</label>
                            <div class="combo-input">
                                <select id="publicIpCity" name="city" required onchange="toggleVaptOtherInput('publicIpCity', 'publicIpOtherCity')">
                                    <option value="">Select City</option>
                                    <option value="Ahmedabad">Ahmedabad</option>
                                    <option value="Amreli">Amreli</option>
                                    <option value="Anand">Anand</option>
                                    <option value="Aravalli">Aravalli</option>
                                    <option value="Banaskantha">Banaskantha</option>
                                    <option value="Bharuch">Bharuch</option>
                                    <option value="Bhavnagar">Bhavnagar</option>
                                    <option value="Botad">Botad</option>
                                    <option value="Chhota Udaipur">Chhota Udaipur</option>
                                    <option value="Dahod">Dahod</option>
                                    <option value="Dang">Dang</option>
                                    <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                    <option value="Gandhinagar">Gandhinagar</option>
                                    <option value="Gir Somnath">Gir Somnath</option>
                                    <option value="Jamnagar">Jamnagar</option>
                                    <option value="Junagadh">Junagadh</option>
                                    <option value="Kheda">Kheda</option>
                                    <option value="Kutch">Kutch</option>
                                    <option value="Mahisagar">Mahisagar</option>
                                    <option value="Mehsana">Mehsana</option>
                                    <option value="Morbi">Morbi</option>
                                    <option value="Narmada">Narmada</option>
                                    <option value="Navsari">Navsari</option>
                                    <option value="Patan">Patan</option>
                                    <option value="Panchmahal">Panchmahal</option>
                                    <option value="Porbandar">Porbandar</option>
                                    <option value="Rajkot">Rajkot</option>
                                    <option value="Sabarkantha">Sabarkantha</option>
                                    <option value="Surat">Surat</option>
                                    <option value="Surendranagar">Surendranagar</option>
                                    <option value="Tapi">Tapi</option>
                                    <option value="Vadodara">Vadodara</option>
                                    <option value="Valsad">Valsad</option>
        
                                    <!-- Rajasthan -->
                                    <option value="Ajmer">Ajmer</option>
                                    <option value="Alwar">Alwar</option>
                                    <option value="Banswara">Banswara</option>
                                    <option value="Baran">Baran</option>
                                    <option value="Barmer">Barmer</option>
                                    <option value="Bharatpur">Bharatpur</option>
                                    <option value="Bhilwara">Bhilwara</option>
                                    <option value="Bikaner">Bikaner</option>
                                    <option value="Bundi">Bundi</option>
                                    <option value="Chittorgarh">Chittorgarh</option>
                                    <option value="Churu">Churu</option>
                                    <option value="Dausa">Dausa</option>
                                    <option value="Dholpur">Dholpur</option>
                                    <option value="Dungarpur">Dungarpur</option>
                                    <option value="Hanumangarh">Hanumangarh</option>
                                    <option value="Jaipur">Jaipur</option>
                                    <option value="Jaisalmer">Jaisalmer</option>
                                    <option value="Jalore">Jalore</option>
                                    <option value="Jhalawar">Jhalawar</option>
                                    <option value="Jhunjhunu">Jhunjhunu</option>
                                    <option value="Jodhpur">Jodhpur</option>
                                    <option value="Karauli">Karauli</option>
                                    <option value="Kota">Kota</option>
                                    <option value="Nagaur">Nagaur</option>
                                    <option value="Pali">Pali</option>
                                    <option value="Pratapgarh">Pratapgarh</option>
                                    <option value="Rajsamand">Rajsamand</option>
                                    <option value="Sikar">Sikar</option>
                                    <option value="Sirohi">Sirohi</option>
                                    <option value="Sri Ganganagar">Sri Ganganagar</option>
                                    <option value="Tonk">Tonk</option>
                                    <option value="Udaipur">Udaipur</option>
        
                                    <!-- Maharashtra -->
                                    <option value="Ahmednagar">Ahmednagar</option>
                                    <option value="Akola">Akola</option>
                                    <option value="Amravati">Amravati</option>
                                    <option value="Aurangabad">Aurangabad</option>
                                    <option value="Beed">Beed</option>
                                    <option value="Bhandara">Bhandara</option>
                                    <option value="Chandrapur">Chandrapur</option>
                                    <option value="Dhule">Dhule</option>
                                    <option value="Gadchiroli">Gadchiroli</option>
                                    <option value="Gondia">Gondia</option>
                                    <option value="Hingoli">Hingoli</option>
                                    <option value="Jalgaon">Jalgaon</option>
                                    <option value="Jalna">Jalna</option>
                                    <option value="Kolhapur">Kolhapur</option>
                                    <option value="Latur">Latur</option>
                                    <option value="Mumbai City">Mumbai City</option>
                                    <option value="Mumbai Suburban">Mumbai Suburban</option>
                                    <option value="Nagpur">Nagpur</option>
                                    <option value="Nanded">Nanded</option>
                                    <option value="Nandurbar">Nandurbar</option>
                                    <option value="Nashik">Nashik</option>
                                    <option value="Osmanabad">Osmanabad</option>
                                    <option value="Palghar">Palghar</option>
                                    <option value="Parbhani">Parbhani</option>
                                    <option value="Pune">Pune</option>
                                    <option value="Raigad">Raigad</option>
                                    <option value="Ratnagiri">Ratnagiri</option>
                                    <option value="Sangli">Sangli</option>
                                    <option value="Satara">Satara</option>
                                    <option value="Sindhudurg">Sindhudurg</option>
                                    <option value="Solapur">Solapur</option>
                                    <option value="Thane">Thane</option>
                                    <option value="Wardha">Wardha</option>
                                    <option value="Washim">Washim</option>
                                    <option value="Yavatmal">Yavatmal</option>
        
                                    <!-- Uttar Pradesh -->
                                    <option value="Agra">Agra</option>
                                    <option value="Aligarh">Aligarh</option>
                                    <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                    <option value="Amethi">Amethi</option>
                                    <option value="Amroha">Amroha</option>
                                    <option value="Auraiya">Auraiya</option>
                                    <option value="Ayodhya">Ayodhya</option>
                                    <option value="Azamgarh">Azamgarh</option>
                                    <option value="Bagpat">Bagpat</option>
                                    <option value="Bahraich">Bahraich</option>
                                    <option value="Ballia">Ballia</option>
                                    <option value="Balrampur">Balrampur</option>
                                    <option value="Banda">Banda</option>
                                    <option value="Barabanki">Barabanki</option>
                                    <option value="Bareilly">Bareilly</option>
                                    <option value="Basti">Basti</option>
                                    <option value="Bhadohi">Bhadohi</option>
                                    <option value="Bijnor">Bijnor</option>
                                    <option value="Bulandshahr">Bulandshahr</option>
                                    <option value="Chandauli">Chandauli</option>
                                    <option value="Chitrakoot">Chitrakoot</option>
                                    <option value="Deoria">Deoria</option>
                                    <option value="Etah">Etah</option>
                                    <option value="Etawah">Etawah</option>
                                    <option value="Farrukhabad">Farrukhabad</option>
                                    <option value="Fatehpur">Fatehpur</option>
                                    <option value="Firozabad">Firozabad</option>
                                    <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                    <option value="Ghaziabad">Ghaziabad</option>
                                    <option value="Ghazipur">Ghazipur</option>
                                    <option value="Gonda">Gonda</option>
                                    <option value="Gorakhpur">Gorakhpur</option>
                                    <option value="Hamirpur">Hamirpur</option>
                                    <option value="Hapur">Hapur</option>
                                    <option value="Hardoi">Hardoi</option>
                                    <option value="Hathras">Hathras</option>
                                    <option value="Jalaun">Jalaun</option>
                                    <option value="Jaunpur">Jaunpur</option>
                                    <option value="Jhansi">Jhansi</option>
                                    <option value="Kannauj">Kannauj</option>
                                    <option value="Kanpur Dehat">Kanpur Dehat</option>
                                    <option value="Kanpur Nagar">Kanpur Nagar</option>
                                    <option value="Kasganj">Kasganj</option>
                                    <option value="Kaushambi">Kaushambi</option>
                                    <option value="Kushinagar">Kushinagar</option>
                                    <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                    <option value="Lalitpur">Lalitpur</option>
                                    <option value="Lucknow">Lucknow</option>
                                    <option value="Maharajganj">Maharajganj</option>
                                    <option value="Mahoba">Mahoba</option>
                                    <option value="Mainpuri">Mainpuri</option>
                                    <option value="Mathura">Mathura</option>
                                    <option value="Mau">Mau</option>
                                    <option value="Meerut">Meerut</option>
                                    <option value="Mirzapur">Mirzapur</option>
                                    <option value="Moradabad">Moradabad</option>
                                    <option value="Muzaffarnagar">Muzaffarnagar</option>
                                    <option value="Pilibhit">Pilibhit</option>
                                    <option value="Pratapgarh">Pratapgarh</option>
                                    <option value="Rae Bareli">Rae Bareli</option>
                                    <option value="Rampur">Rampur</option>
                                    <option value="Saharanpur">Saharanpur</option>
                                    <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                    <option value="Shahjahanpur">Shahjahanpur</option>
                                    <option value="Shravasti">Shravasti</option>
                                    <option value="Siddharthnagar">Siddharthnagar</option>
                                    <option value="Sitapur">Sitapur</option>
                                    <option value="Sonbhadra">Sonbhadra</option>
                                    <option value="Sultanpur">Sultanpur</option>
                                    <option value="Unnao">Unnao</option>
                                    <option value="Varanasi">Varanasi</option>
        
                                    <!-- Uttarakhand -->
                                    <option value="Almora">Almora</option>
                                    <option value="Bageshwar">Bageshwar</option>
                                    <option value="Chamoli">Chamoli</option>
                                    <option value="Champawat">Champawat</option>
                                    <option value="Dehradun">Dehradun</option>
                                    <option value="Haridwar">Haridwar</option>
                                    <option value="Nainital">Nainital</option>
                                    <option value="Pauri Garhwal">Pauri Garhwal</option>
                                    <option value="Pithoragarh">Pithoragarh</option>
                                    <option value="Rudraprayag">Rudraprayag</option>
                                    <option value="Tehri Garhwal">Tehri Garhwal</option>
                                    <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                    <option value="Uttarkashi">Uttarkashi</option>
                                            <option value="other">Other (Please specify)</option>
                                </select>
                                <input type="text" id="publicIpOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="publicIpState">State*</label>
                            <select id="publicIpState" name="state" required>
                                <option value="">Select State</option>
                                <option value="Andhra Pradesh">Andhra Pradesh</option>
                                <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                <option value="Assam">Assam</option>
                                <option value="Bihar">Bihar</option>
                                <option value="Chhattisgarh">Chhattisgarh</option>
                                <option value="Goa">Goa</option>
                                <option value="Gujarat">Gujarat</option>
                                <option value="Haryana">Haryana</option>
                                <option value="Himachal Pradesh">Himachal Pradesh</option>
                                <option value="Jharkhand">Jharkhand</option>
                                <option value="Karnataka">Karnataka</option>
                                <option value="Kerala">Kerala</option>
                                <option value="Madhya Pradesh">Madhya Pradesh</option>
                                <option value="Maharashtra">Maharashtra</option>
                                <option value="Manipur">Manipur</option>
                                <option value="Meghalaya">Meghalaya</option>
                                <option value="Mizoram">Mizoram</option>
                                <option value="Nagaland">Nagaland</option>
                                <option value="Odisha">Odisha</option>
                                <option value="Punjab">Punjab</option>
                                <option value="Rajasthan">Rajasthan</option>
                                <option value="Sikkim">Sikkim</option>
                                <option value="Tamil Nadu">Tamil Nadu</option>
                                <option value="Telangana">Telangana</option>
                                <option value="Tripura">Tripura</option>
                                <option value="Uttar Pradesh">Uttar Pradesh</option>
                                <option value="Uttarakhand">Uttarakhand</option>
                                <option value="West Bengal">West Bengal</option>
                                <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                <option value="Chandigarh">Chandigarh</option>
                                <option value="Dadra and Nagar Haveli and Daman and Diu">Dadra and Nagar Haveli and Daman and Diu</option>
                                <option value="Delhi">Delhi</option>
                                <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                                <option value="Ladakh">Ladakh</option>
                                <option value="Lakshadweep">Lakshadweep</option>
                                <option value="Puducherry">Puducherry</option>
                                
                            </select>
                        </div>
                    </div>

                    <!-- Audit Dates -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="publicIpStartDate">Start Audit Date*</label>
                            <input type="date" id="publicIpStartDate" name="startDate" required>
                        </div>
                        <div class="form-group">
                            <label for="publicIpEndDate">Finish Audit Date*</label>
                            <input type="date" id="publicIpEndDate" name="endDate" required>
                        </div>
                    </div>

                    <!-- Report Prepared By -->
                    <div class="form-group">
                        <label>Report Prepared By*</label>
                        <div class="name-input">
                            <select class="title-select" name="preparedByTitle" required>
                                <option value="Mr.">Mr.</option>
                                <option value="Ms.">Ms.</option>
                                <option value="Mrs.">Mrs.</option>
                                <option value="Dr.">Dr.</option>
                            </select>
                            <input type="text" placeholder="Full Name" name="preparedByName" required>
                        </div>
                    </div>

                    <!-- Auditee Details -->
                    <div class="form-group">
                        <label>Name of Auditee Organization Person*</label>
                        <div class="name-input">
                            <select class="title-select" name="auditeeTitle" required>
                                <option value="Mr.">Mr.</option>
                                <option value="Ms.">Ms.</option>
                                <option value="Mrs.">Mrs.</option>
                                <option value="Dr.">Dr.</option>
                            </select>
                            <input type="text" placeholder="Full Name" name="auditeeName" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="publicIpDesignation">Designation of the Person*</label>
                        <input type="text" id="publicIpDesignation" name="designation" required>
                    </div>

                    <div class="form-group">
                        <label for="publicIpBankEmail">Email ID of the Organization*</label>
                        <div id="publicIpEmailContainer">
                            <input type="email" name="bankEmail[]" placeholder="Email Address" required>
                        </div>
                        <button type="button" class="add-member-btn" id="publicIpAddEmailBtn" style="margin-top: 10px;">+ Add Another Email</button>
                    </div>

                    <!-- Auditing Team -->
                    <div class="form-group">
                        <label>Details of Auditing Team* (At least 1 required, max 8)</label>
                        <div id="publicIpAuditTeamContainer">
                            <div class="team-member" data-index="0">
                                <div class="form-row">
                                    <div class="form-group">
                                        <input type="text" name="teamName[]" placeholder="Name*" required>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" name="teamQualification[]" placeholder="Qualification/Certification*" required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Certified (Yes/No)*</label>
                                    <div class="radio-group">
                                        <label><input type="radio" name="teamCertified[0]" value="yes" required> Yes</label>
                                        <label><input type="radio" name="teamCertified[0]" value="no"> No</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="add-member-btn" id="publicIpAddMemberBtn">+ Add Team Member</button>
                    </div>

                    <!-- File Uploads -->
                    <div class="form-group">
                        <label>File Uploads*</label>
                        
                        <div class="file-upload-group">
                            <label for="publicIpNmapFiles">Nmap Zip Files</label>
                            <input type="file" id="publicIpNmapFiles" name="nmapFiles" accept=".zip" required>
                            <small class="file-help" style="color: brown;">All Nmap files must be placed directly in the ZIP file (no nested folders) and must be in CSV format.</small>
                        </div>
                        
                        <div class="file-upload-group">
                            <label for="publicIpNessusFiles">Nessus Zip Files</label>
                            <input type="file" id="publicIpNessusFiles" name="nessusFiles" accept=".zip" required>
                            <small class="file-help" style="color: brown;">All Nessus files must be placed directly inside a single ZIP file with no nested folders.</small>
                        </div>
                        
                        <div class="file-upload-group">
                            <label for="publicIpEvidenceFiles">Evidences Zip Files</label>
                            <input type="file" id="publicIpEvidenceFiles" name="evidenceFiles" accept=".zip">
                            <small class="file-help" style="color: brown;">The evidence ZIP file must include a folder named "ALL POC" containing evidence images. File names must exactly match vulnerability names.</small>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeVaptModal('publicIpFirstAuditModal')">Cancel</button>
                        <button type="submit" class="submit-btn">Submit Report</button>
                    </div>
                    <br>
                    <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>  
                    </small>
                </form>
            </div>
        </div>
    </div>

    <!-- Web Application Follow-Up Audit Word Report Modal -->
    <div id="webAppFollowUpAuditWordModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Web Application Follow-up Audit Word Report</h3>
                <span class="close-modal" onclick="closeVaptModal('webAppFollowUpAuditWordModal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="webAppFollowUpAuditWordForm" action="/process_web_app_follow_up_audit_word_report" method="POST" enctype="multipart/form-data">
                    <!-- Organization Section -->
                    <div class="form-group">
                        <label for="webAppFollowUpWordOrganization">Organization Name*</label>
                        <div class="combo-input">
                            <select id="webAppFollowUpWordOrganization" name="organization" required onchange="toggleVaptOtherInput('webAppFollowUpWordOrganization', 'webAppFollowUpWordOtherOrganization')">
                                <option value="">Select Organization</option>
                                <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                <option value="Megasoft Limited">Megasoft Limited</option>
                                <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                <option value="other">Other (Please specify)</option>
                            </select>
                            <input type="text" id="webAppFollowUpWordOtherOrganization" name="otherOrganization" class="hidden" placeholder="Enter Organization Name">
                        </div>
                    </div>

                    <!-- Location Section -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="webAppFollowUpWordCity">City*</label>
                            <div class="combo-input">
                                <select id="webAppFollowUpWordCity" name="city" required onchange="toggleVaptOtherInput('webAppFollowUpWordCity', 'webAppFollowUpWordOtherCity')">
                                    <option value="">Select City</option>
                                    <option value="Ahmedabad">Ahmedabad</option>
                                    <option value="Mumbai">Mumbai</option>
                                    <option value="Delhi">Delhi</option>
                                    <option value="Bangalore">Bangalore</option>
                                    <option value="Chennai">Chennai</option>
                                    <option value="Kolkata">Kolkata</option>
                                    <option value="Hyderabad">Hyderabad</option>
                                    <option value="Pune">Pune</option>
                                    <option value="other">Other (Please specify)</option>
                                </select>
                                <input type="text" id="webAppFollowUpWordOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="webAppFollowUpWordState">State*</label>
                            <select id="webAppFollowUpWordState" name="state" required>
                                <option value="">Select State</option>
                                <option value="Gujarat">Gujarat</option>
                                <option value="Maharashtra">Maharashtra</option>
                                <option value="Rajasthan">Rajasthan</option>
                                <option value="Uttar Pradesh">Uttar Pradesh</option>
                                <option value="Uttarakhand">Uttarakhand</option>
                                <option value="Andhra Pradesh">Andhra Pradesh</option>
                                <option value="Karnataka">Karnataka</option>
                                <option value="Tamil Nadu">Tamil Nadu</option>
                                <option value="West Bengal">West Bengal</option>
                                <option value="Delhi">Delhi</option>
                            </select>
                        </div>
                    </div>

                    <!-- First Audit Report Details -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="webAppFollowUpWordFirstAuditReportId">First Audit Report ID*</label>
                            <input type="text" id="webAppFollowUpWordFirstAuditReportId" name="firstAuditReportId" required>
                        </div>
                        <div class="form-group">
                            <label for="webAppFollowUpWordFirstAuditReportDate">First Audit Report Release Date*</label>
                            <input type="date" id="webAppFollowUpWordFirstAuditReportDate" name="firstAuditReportDate" required>
                        </div>
                    </div>

                    <!-- Audit Dates -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="webAppFollowUpWordStartDate">Start Audit Date*</label>
                            <input type="date" id="webAppFollowUpWordStartDate" name="startDate" required>
                        </div>
                        <div class="form-group">
                            <label for="webAppFollowUpWordEndDate">Finish Audit Date*</label>
                            <input type="date" id="webAppFollowUpWordEndDate" name="endDate" required>
                        </div>
                    </div>

                    <!-- Application Type -->
                    <div class="form-group">
                        <label>Application Type*</label>
                        <div class="radio-group">
                            <label><input type="radio" name="applicationType" value="Internal" checked> Internal</label>
                            <label><input type="radio" name="applicationType" value="External"> External</label>
                        </div>
                    </div>

                    <!-- Asset Details -->
                    <div class="form-group">
                        <label>Asset Details* (At least 1 required, max 8)</label>
                        <div id="webAppFollowUpWordAssetContainer">
                            <div class="asset-entry" data-asset-index="0">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="webAppFollowUpWordAssetDescription_0">Asset Description*</label>
                                        <input type="text" id="webAppFollowUpWordAssetDescription_0" name="assetDescription[]" placeholder="Enter asset description" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="webAppFollowUpWordAssetCriticality_0">Criticality of Asset*</label>
                                        <input type="text" id="webAppFollowUpWordAssetCriticality_0" name="assetCriticality[]" placeholder="Enter criticality" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="webAppFollowUpWordAssetIp_0"><span class="webAppFollowUpWordAssetIpLabel">Internal IP Addresses*</span></label>
                                        <input type="text" id="webAppFollowUpWordAssetIp_0" name="assetInternalIp[]" class="webAppFollowUpWordAssetIpInput" placeholder="Enter internal IP addresses" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="webAppFollowUpWordAssetUrl_0">URL*</label>
                                        <input type="text" id="webAppFollowUpWordAssetUrl_0" name="assetUrl[]" placeholder="Enter URL" required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="webAppFollowUpWordAssetVersion_0">Version*</label>
                                    <input type="text" id="webAppFollowUpWordAssetVersion_0" name="assetVersion[]" placeholder="Enter version" required>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="add-member-btn" id="webAppFollowUpWordAddAssetBtn">+ Add Asset</button>
                    </div>

                    <!-- Report Prepared By -->
                    <div class="form-group">
                        <label>Report Prepared By*</label>
                        <div class="name-input">
                            <select class="title-select" name="preparedByTitle" required>
                                <option value="Mr.">Mr.</option>
                                <option value="Ms.">Ms.</option>
                                <option value="Mrs.">Mrs.</option>
                                <option value="Dr.">Dr.</option>
                            </select>
                            <input type="text" placeholder="Full Name" name="preparedByName" required>
                        </div>
                    </div>

                    <!-- Auditee Details -->
                    <div class="form-group">
                        <label>Name of Auditee Organization Person*</label>
                        <div class="name-input">
                            <select class="title-select" name="auditeeTitle" required>
                                <option value="Mr.">Mr.</option>
                                <option value="Ms.">Ms.</option>
                                <option value="Mrs.">Mrs.</option>
                                <option value="Dr.">Dr.</option>
                            </select>
                            <input type="text" placeholder="Full Name" name="auditeeName" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="webAppFollowUpWordDesignation">Designation of the Person*</label>
                        <input type="text" id="webAppFollowUpWordDesignation" name="designation" required>
                    </div>

                    <div class="form-group">
                        <label for="webAppFollowUpWordBankEmail">Email ID of the Organization*</label>
                        <div id="webAppFollowUpWordEmailContainer">
                            <input type="email" name="bankEmail[]" placeholder="Email Address" required>
                        </div>
                        <button type="button" class="add-member-btn" id="webAppFollowUpWordAddEmailBtn" style="margin-top: 10px;">+ Add Another Email</button>
                    </div>

                    <!-- Auditing Team -->
                    <div class="form-group">
                        <label>Details of Auditing Team* (At least 1 required, max 8)</label>
                        <div id="webAppFollowUpWordAuditTeamContainer">
                            <div class="team-member" data-index="0">
                                <div class="form-row">
                                    <div class="form-group">
                                        <input type="text" name="teamName[]" placeholder="Name*" required>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" name="teamQualification[]" placeholder="Qualification*" required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Certified (Yes/No)*</label>
                                    <div class="radio-group">
                                        <label><input type="radio" name="teamCertified[0]" value="yes" required> Yes</label>
                                        <label><input type="radio" name="teamCertified[0]" value="no"> No</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="add-member-btn" id="webAppFollowUpWordAddMemberBtn">+ Add Team Member</button>
                    </div>

                    <!-- Excel File Upload -->
                    <div class="form-group">
                        <label for="webAppFollowUpWordExcelFile">Upload Excel File (.xlsx)*</label>
                        <input type="file" id="webAppFollowUpWordExcelFile" name="followUpExcelFile" accept=".xlsx" required>
                        <small class="file-help" style="color: brown;">
                            Please select an Excel file (.xlsx) generated via this tool or matching the required format.
                            After generating the Word report, refresh the index page in Word to update page numbers.
                        </small>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeVaptModal('webAppFollowUpAuditWordModal')">Cancel</button>
                        <button type="submit" class="submit-btn">Generate Word Report</button>
                    </div>
                    <br>
                    <small class="file-help" style="color: red; font-weight: bold;">
                        <center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>
                    </small>
                </form>
            </div>
        </div>
    </div>


    <!-- Public IP VAPT Follow Up Audit Modal -->
    <div id="publicIpFollowUpAuditModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Public IP VAPT Follow Up Audit Details</h3>
                <span class="close-modal" onclick="closeVaptModal('publicIpFollowUpAuditModal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="publicIpFollowUpAuditForm" action="/process_public_ip_vapt_follow_up_audit_report" method="POST" enctype="multipart/form-data">
                    <!-- Organization Section -->
                    <div class="form-group">
                        <label for="publicIpFollowUpOrganization">Organization Name*</label>
                        <div class="combo-input">
                            <select id="publicIpFollowUpOrganization" name="organization" required onchange="toggleVaptOtherInput('publicIpFollowUpOrganization', 'publicIpFollowUpOtherOrganization')">
                                <option value="">Select Organization</option>
                                <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                <option value="Megasoft Limited">Megasoft Limited</option>
                                <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                
    
                                <option value="other">Other (Please specify)</option>
                            </select>
                            <input type="text" id="publicIpFollowUpOtherOrganization" name="otherOrganization" class="hidden" placeholder="Enter Organization Name">
                        </div>
                    </div>

                    <!-- Location Section -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="publicIpFollowUpCity">City*</label>
                            <div class="combo-input">
                                <select id="publicIpFollowUpCity" name="city" required onchange="toggleVaptOtherInput('publicIpFollowUpCity', 'publicIpFollowUpOtherCity')">
                                    <option value="">Select City</option>
                                    <option value="Ahmedabad">Ahmedabad</option>
                                    <option value="Amreli">Amreli</option>
                                    <option value="Anand">Anand</option>
                                    <option value="Aravalli">Aravalli</option>
                                    <option value="Banaskantha">Banaskantha</option>
                                    <option value="Bharuch">Bharuch</option>
                                    <option value="Bhavnagar">Bhavnagar</option>
                                    <option value="Botad">Botad</option>
                                    <option value="Chhota Udaipur">Chhota Udaipur</option>
                                    <option value="Dahod">Dahod</option>
                                    <option value="Dang">Dang</option>
                                    <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                    <option value="Gandhinagar">Gandhinagar</option>
                                    <option value="Gir Somnath">Gir Somnath</option>
                                    <option value="Jamnagar">Jamnagar</option>
                                    <option value="Junagadh">Junagadh</option>
                                    <option value="Kheda">Kheda</option>
                                    <option value="Kutch">Kutch</option>
                                    <option value="Mahisagar">Mahisagar</option>
                                    <option value="Mehsana">Mehsana</option>
                                    <option value="Morbi">Morbi</option>
                                    <option value="Narmada">Narmada</option>
                                    <option value="Navsari">Navsari</option>
                                    <option value="Patan">Patan</option>
                                    <option value="Panchmahal">Panchmahal</option>
                                    <option value="Porbandar">Porbandar</option>
                                    <option value="Rajkot">Rajkot</option>
                                    <option value="Sabarkantha">Sabarkantha</option>
                                    <option value="Surat">Surat</option>
                                    <option value="Surendranagar">Surendranagar</option>
                                    <option value="Tapi">Tapi</option>
                                    <option value="Vadodara">Vadodara</option>
                                    <option value="Valsad">Valsad</option>
        
                                    <!-- Rajasthan -->
                                    <option value="Ajmer">Ajmer</option>
                                    <option value="Alwar">Alwar</option>
                                    <option value="Banswara">Banswara</option>
                                    <option value="Baran">Baran</option>
                                    <option value="Barmer">Barmer</option>
                                    <option value="Bharatpur">Bharatpur</option>
                                    <option value="Bhilwara">Bhilwara</option>
                                    <option value="Bikaner">Bikaner</option>
                                    <option value="Bundi">Bundi</option>
                                    <option value="Chittorgarh">Chittorgarh</option>
                                    <option value="Churu">Churu</option>
                                    <option value="Dausa">Dausa</option>
                                    <option value="Dholpur">Dholpur</option>
                                    <option value="Dungarpur">Dungarpur</option>
                                    <option value="Hanumangarh">Hanumangarh</option>
                                    <option value="Jaipur">Jaipur</option>
                                    <option value="Jaisalmer">Jaisalmer</option>
                                    <option value="Jalore">Jalore</option>
                                    <option value="Jhalawar">Jhalawar</option>
                                    <option value="Jhunjhunu">Jhunjhunu</option>
                                    <option value="Jodhpur">Jodhpur</option>
                                    <option value="Karauli">Karauli</option>
                                    <option value="Kota">Kota</option>
                                    <option value="Nagaur">Nagaur</option>
                                    <option value="Pali">Pali</option>
                                    <option value="Pratapgarh">Pratapgarh</option>
                                    <option value="Rajsamand">Rajsamand</option>
                                    <option value="Sikar">Sikar</option>
                                    <option value="Sirohi">Sirohi</option>
                                    <option value="Sri Ganganagar">Sri Ganganagar</option>
                                    <option value="Tonk">Tonk</option>
                                    <option value="Udaipur">Udaipur</option>
        
                                    <!-- Maharashtra -->
                                    <option value="Ahmednagar">Ahmednagar</option>
                                    <option value="Akola">Akola</option>
                                    <option value="Amravati">Amravati</option>
                                    <option value="Aurangabad">Aurangabad</option>
                                    <option value="Beed">Beed</option>
                                    <option value="Bhandara">Bhandara</option>
                                    <option value="Chandrapur">Chandrapur</option>
                                    <option value="Dhule">Dhule</option>
                                    <option value="Gadchiroli">Gadchiroli</option>
                                    <option value="Gondia">Gondia</option>
                                    <option value="Hingoli">Hingoli</option>
                                    <option value="Jalgaon">Jalgaon</option>
                                    <option value="Jalna">Jalna</option>
                                    <option value="Kolhapur">Kolhapur</option>
                                    <option value="Latur">Latur</option>
                                    <option value="Mumbai City">Mumbai City</option>
                                    <option value="Mumbai Suburban">Mumbai Suburban</option>
                                    <option value="Nagpur">Nagpur</option>
                                    <option value="Nanded">Nanded</option>
                                    <option value="Nandurbar">Nandurbar</option>
                                    <option value="Nashik">Nashik</option>
                                    <option value="Osmanabad">Osmanabad</option>
                                    <option value="Palghar">Palghar</option>
                                    <option value="Parbhani">Parbhani</option>
                                    <option value="Pune">Pune</option>
                                    <option value="Raigad">Raigad</option>
                                    <option value="Ratnagiri">Ratnagiri</option>
                                    <option value="Sangli">Sangli</option>
                                    <option value="Satara">Satara</option>
                                    <option value="Sindhudurg">Sindhudurg</option>
                                    <option value="Solapur">Solapur</option>
                                    <option value="Thane">Thane</option>
                                    <option value="Wardha">Wardha</option>
                                    <option value="Washim">Washim</option>
                                    <option value="Yavatmal">Yavatmal</option>
        
                                    <!-- Uttar Pradesh -->
                                    <option value="Agra">Agra</option>
                                    <option value="Aligarh">Aligarh</option>
                                    <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                    <option value="Amethi">Amethi</option>
                                    <option value="Amroha">Amroha</option>
                                    <option value="Auraiya">Auraiya</option>
                                    <option value="Ayodhya">Ayodhya</option>
                                    <option value="Azamgarh">Azamgarh</option>
                                    <option value="Bagpat">Bagpat</option>
                                    <option value="Bahraich">Bahraich</option>
                                    <option value="Ballia">Ballia</option>
                                    <option value="Balrampur">Balrampur</option>
                                    <option value="Banda">Banda</option>
                                    <option value="Barabanki">Barabanki</option>
                                    <option value="Bareilly">Bareilly</option>
                                    <option value="Basti">Basti</option>
                                    <option value="Bhadohi">Bhadohi</option>
                                    <option value="Bijnor">Bijnor</option>
                                    <option value="Bulandshahr">Bulandshahr</option>
                                    <option value="Chandauli">Chandauli</option>
                                    <option value="Chitrakoot">Chitrakoot</option>
                                    <option value="Deoria">Deoria</option>
                                    <option value="Etah">Etah</option>
                                    <option value="Etawah">Etawah</option>
                                    <option value="Farrukhabad">Farrukhabad</option>
                                    <option value="Fatehpur">Fatehpur</option>
                                    <option value="Firozabad">Firozabad</option>
                                    <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                    <option value="Ghaziabad">Ghaziabad</option>
                                    <option value="Ghazipur">Ghazipur</option>
                                    <option value="Gonda">Gonda</option>
                                    <option value="Gorakhpur">Gorakhpur</option>
                                    <option value="Hamirpur">Hamirpur</option>
                                    <option value="Hapur">Hapur</option>
                                    <option value="Hardoi">Hardoi</option>
                                    <option value="Hathras">Hathras</option>
                                    <option value="Jalaun">Jalaun</option>
                                    <option value="Jaunpur">Jaunpur</option>
                                    <option value="Jhansi">Jhansi</option>
                                    <option value="Kannauj">Kannauj</option>
                                    <option value="Kanpur Dehat">Kanpur Dehat</option>
                                    <option value="Kanpur Nagar">Kanpur Nagar</option>
                                    <option value="Kasganj">Kasganj</option>
                                    <option value="Kaushambi">Kaushambi</option>
                                    <option value="Kushinagar">Kushinagar</option>
                                    <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                    <option value="Lalitpur">Lalitpur</option>
                                    <option value="Lucknow">Lucknow</option>
                                    <option value="Maharajganj">Maharajganj</option>
                                    <option value="Mahoba">Mahoba</option>
                                    <option value="Mainpuri">Mainpuri</option>
                                    <option value="Mathura">Mathura</option>
                                    <option value="Mau">Mau</option>
                                    <option value="Meerut">Meerut</option>
                                    <option value="Mirzapur">Mirzapur</option>
                                    <option value="Moradabad">Moradabad</option>
                                    <option value="Muzaffarnagar">Muzaffarnagar</option>
                                    <option value="Pilibhit">Pilibhit</option>
                                    <option value="Pratapgarh">Pratapgarh</option>
                                    <option value="Rae Bareli">Rae Bareli</option>
                                    <option value="Rampur">Rampur</option>
                                    <option value="Saharanpur">Saharanpur</option>
                                    <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                    <option value="Shahjahanpur">Shahjahanpur</option>
                                    <option value="Shravasti">Shravasti</option>
                                    <option value="Siddharthnagar">Siddharthnagar</option>
                                    <option value="Sitapur">Sitapur</option>
                                    <option value="Sonbhadra">Sonbhadra</option>
                                    <option value="Sultanpur">Sultanpur</option>
                                    <option value="Unnao">Unnao</option>
                                    <option value="Varanasi">Varanasi</option>
        
                                    <!-- Uttarakhand -->
                                    <option value="Almora">Almora</option>
                                    <option value="Bageshwar">Bageshwar</option>
                                    <option value="Chamoli">Chamoli</option>
                                    <option value="Champawat">Champawat</option>
                                    <option value="Dehradun">Dehradun</option>
                                    <option value="Haridwar">Haridwar</option>
                                    <option value="Nainital">Nainital</option>
                                    <option value="Pauri Garhwal">Pauri Garhwal</option>
                                    <option value="Pithoragarh">Pithoragarh</option>
                                    <option value="Rudraprayag">Rudraprayag</option>
                                    <option value="Tehri Garhwal">Tehri Garhwal</option>
                                    <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                    <option value="Uttarkashi">Uttarkashi</option>
                                            <option value="other">Other (Please specify)</option>
                                </select>
                                <input type="text" id="publicIpFollowUpOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="publicIpFollowUpState">State*</label>
                            <select id="publicIpFollowUpState" name="state" required>
                                <option value="">Select State</option>
                                <option value="Andhra Pradesh">Andhra Pradesh</option>
                                <option value="Andhra Pradesh">Andhra Pradesh</option>
                                <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                <option value="Assam">Assam</option>
                                <option value="Bihar">Bihar</option>
                                <option value="Chhattisgarh">Chhattisgarh</option>
                                <option value="Goa">Goa</option>
                                <option value="Gujarat">Gujarat</option>
                                <option value="Haryana">Haryana</option>
                                <option value="Himachal Pradesh">Himachal Pradesh</option>
                                <option value="Jharkhand">Jharkhand</option>
                                <option value="Karnataka">Karnataka</option>
                                <option value="Kerala">Kerala</option>
                                <option value="Madhya Pradesh">Madhya Pradesh</option>
                                <option value="Maharashtra">Maharashtra</option>
                                <option value="Manipur">Manipur</option>
                                <option value="Meghalaya">Meghalaya</option>
                                <option value="Mizoram">Mizoram</option>
                                <option value="Nagaland">Nagaland</option>
                                <option value="Odisha">Odisha</option>
                                <option value="Punjab">Punjab</option>
                                <option value="Rajasthan">Rajasthan</option>
                                <option value="Sikkim">Sikkim</option>
                                <option value="Tamil Nadu">Tamil Nadu</option>
                                <option value="Telangana">Telangana</option>
                                <option value="Tripura">Tripura</option>
                                <option value="Uttar Pradesh">Uttar Pradesh</option>
                                <option value="Uttarakhand">Uttarakhand</option>
                                <option value="West Bengal">West Bengal</option>
                                <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                <option value="Chandigarh">Chandigarh</option>
                                <option value="Dadra and Nagar Haveli and Daman and Diu">Dadra and Nagar Haveli and Daman and Diu</option>
                                <option value="Delhi">Delhi</option>
                                <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                                <option value="Ladakh">Ladakh</option>
                                <option value="Lakshadweep">Lakshadweep</option>
                                <option value="Puducherry">Puducherry</option>
                                
                            </select>
                        </div>
                    </div>

                    <!-- First Audit Report Details -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="publicIpFollowUpFirstAuditReportId">First Audit Report ID*</label>
                            <input type="text" id="publicIpFollowUpFirstAuditReportId" name="firstAuditReportId" placeholder="Enter First Audit Report ID" required>
                        </div>
                        <div class="form-group">
                            <label for="publicIpFollowUpFirstAuditReportDate">First Audit Report Release Date*</label>
                            <input type="date" id="publicIpFollowUpFirstAuditReportDate" name="firstAuditReportDate" required>
                        </div>
                    </div>

                    <!-- Audit Dates -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="publicIpFollowUpStartDate">Start Audit Date*</label>
                            <input type="date" id="publicIpFollowUpStartDate" name="startDate" required>
                        </div>
                        <div class="form-group">
                            <label for="publicIpFollowUpEndDate">Finish Audit Date*</label>
                            <input type="date" id="publicIpFollowUpEndDate" name="endDate" required>
                        </div>
                    </div>

                    <!-- Report Prepared By -->
                    <div class="form-group">
                        <label>Report Prepared By*</label>
                        <div class="name-input">
                            <select class="title-select" name="preparedByTitle" required>
                                <option value="Mr.">Mr.</option>
                                <option value="Ms.">Ms.</option>
                                <option value="Mrs.">Mrs.</option>
                                <option value="Dr.">Dr.</option>
                            </select>
                            <input type="text" placeholder="Full Name" name="preparedByName" required>
                        </div>
                    </div>

                    <!-- Auditee Details -->
                    <div class="form-group">
                        <label>Name of Auditee Organization Person*</label>
                        <div class="name-input">
                            <select class="title-select" name="auditeeTitle" required>
                                <option value="Mr.">Mr.</option>
                                <option value="Ms.">Ms.</option>
                                <option value="Mrs.">Mrs.</option>
                                <option value="Dr.">Dr.</option>
                            </select>
                            <input type="text" placeholder="Full Name" name="auditeeName" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="publicIpFollowUpDesignation">Designation of the Person*</label>
                        <input type="text" id="publicIpFollowUpDesignation" name="designation" required>
                    </div>

                    <div class="form-group">
                        <label for="publicIpFollowUpBankEmail">Email ID of the Organization*</label>
                        <div id="publicIpFollowUpEmailContainer">
                            <input type="email" name="bankEmail[]" placeholder="Email Address" required>
                        </div>
                        <button type="button" class="add-member-btn" id="publicIpAddFollowUpEmailBtn" style="margin-top: 10px;">+ Add Another Email</button>
                    </div>

                    <!-- Auditing Team -->
                    <div class="form-group">
                        <label>Details of Auditing Team* (At least 1 required, max 8)</label>
                        <div id="publicIpFollowUpAuditTeamContainer">
                            <div class="team-member" data-index="0">
                                <div class="form-row">
                                    <div class="form-group">
                                        <input type="text" name="teamName[]" placeholder="Name*" required>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" name="teamQualification[]" placeholder="Qualification/Certification*" required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Certified (Yes/No)*</label>
                                    <div class="radio-group">
                                        <label><input type="radio" name="teamCertified[0]" value="yes" required> Yes</label>
                                        <label><input type="radio" name="teamCertified[0]" value="no"> No</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="add-member-btn" id="publicIpAddFollowUpMemberBtn">+ Add Team Member</button>
                    </div>

                    <!-- Old Excel File Upload -->
                    <div class="form-group">
                        <label for="publicIpFollowUpOldExcelFile">Old Excel File (First Audit)*</label>
                        <input type="file" id="publicIpFollowUpOldExcelFile" name="userExcelFile" accept=".xlsx" required>
                        <small class="file-help" style="color: brown;">Upload the Excel file from the First Audit to carry forward resolved vulnerabilities and their evidence.</small>
                    </div>

                    <!-- File Uploads -->
                    <div class="form-group">
                        <label>File Uploads*</label>
                        
                        <div class="file-upload-group">
                            <label for="publicIpFollowUpNmapFiles">Nmap Zip Files</label>
                            <input type="file" id="publicIpFollowUpNmapFiles" name="nmapFiles" accept=".zip" required>
                            <small class="file-help" style="color: brown;">All Nmap files must be placed directly in the ZIP file (no nested folders) and must be in CSV format.</small>
                        </div>
                        
                        <div class="file-upload-group">
                            <label for="publicIpFollowUpNessusFiles">Nessus Zip Files</label>
                            <input type="file" id="publicIpFollowUpNessusFiles" name="nessusFiles" accept=".zip" required>
                            <small class="file-help" style="color: brown;">All Nessus files must be placed directly inside a single ZIP file with no nested folders.</small>
                        </div>
                        
                        <div class="file-upload-group">
                            <label for="publicIpFollowUpEvidenceFiles">New Evidences Zip Files</label>
                            <input type="file" id="publicIpFollowUpEvidenceFiles" name="evidenceFiles" accept=".zip" required>
                            <small class="file-help" style="color: brown;">Upload new evidence for current follow-up audit vulnerabilities.</small>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeVaptModal('publicIpFollowUpAuditModal')">Cancel</button>
                        <button type="submit" class="submit-btn">Submit Report</button>
                    </div>
                    <br>
                    <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>  
                    </small>
                </form>
            </div>
        </div>
    </div>

    <!-- Public IP VAPT Follow-Up Audit Word Report Modal -->
    <div id="publicIpFollowUpAuditWordModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Public IP Follow-Up Audit Word Report</h3>
                <span class="close-modal" onclick="closeVaptModal('publicIpFollowUpAuditWordModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="publicIpFollowUpAuditWordForm" action="/process_public_ip_vapt_follow_up_audit_word_report" method="POST" enctype="multipart/form-data">
                    <div class="form-group">
                        <label for="publicIpFollowUpWordExcelFile">Upload Excel File (.xlsx)*</label>
                        <input type="file" id="publicIpFollowUpWordExcelFile" name="publicIpFollowUpExcelFile" accept=".xlsx" required>
                        <small class="file-help" style="color: brown;">Please select an Excel file (.xlsx) to generate the Word report. The Excel file should be generated through the "Public IP Follow-up Audit Report Excel" tool and must contain a "Public_IP_VAPT" worksheet with the required columns including Status, Old POC, and POC columns.
                           <br> <br>After generating the Word report, you must manually update the index page numbers by refreshing the table.
                        </small>
                        <br>
                        <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>  
                        </small>
                    </div>
                     
                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeVaptModal('publicIpFollowUpAuditWordModal')">Cancel</button>
                        <button type="submit" class="submit-btn">Generate Word Report</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Web Application VAPT First Audit Modal -->
    <div id="webAppFirstAuditModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Web Application VAPT First Audit Details</h3>
                <span class="close-modal" onclick="closeVaptModal('webAppFirstAuditModal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="webAppFirstAuditForm" action="/process_web_app_vapt_first_audit_report" method="POST" enctype="multipart/form-data">
                    <!-- Organization Section -->
                    <div class="form-group">
                        <label for="webAppOrganization">Organization Name*</label>
                        <div class="combo-input">
                            <select id="webAppOrganization" name="organization" required onchange="toggleVaptOtherInput('webAppOrganization', 'webAppOtherOrganization')">
                                <option value="">Select Organization</option>
                                <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                <option value="Megasoft Limited">Megasoft Limited</option>
                                <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                
    
                                <option value="other">Other (Please specify)</option>
                            </select>
                            <input type="text" id="webAppOtherOrganization" name="otherOrganization" class="hidden" placeholder="Enter Organization Name">
                        </div>
                    </div>

                    <!-- Location Section -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="webAppCity">City*</label>
                            <div class="combo-input">
                                <select id="webAppCity" name="city" required onchange="toggleVaptOtherInput('webAppCity', 'webAppOtherCity')">
                                    <option value="">Select City</option>
                                    <option value="Ahmedabad">Ahmedabad</option>
                                    <option value="Amreli">Amreli</option>
                                    <option value="Anand">Anand</option>
                                    <option value="Aravalli">Aravalli</option>
                                    <option value="Banaskantha">Banaskantha</option>
                                    <option value="Bharuch">Bharuch</option>
                                    <option value="Bhavnagar">Bhavnagar</option>
                                    <option value="Botad">Botad</option>
                                    <option value="Chhota Udaipur">Chhota Udaipur</option>
                                    <option value="Dahod">Dahod</option>
                                    <option value="Dang">Dang</option>
                                    <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                    <option value="Gandhinagar">Gandhinagar</option>
                                    <option value="Gir Somnath">Gir Somnath</option>
                                    <option value="Jamnagar">Jamnagar</option>
                                    <option value="Junagadh">Junagadh</option>
                                    <option value="Kheda">Kheda</option>
                                    <option value="Kutch">Kutch</option>
                                    <option value="Mahisagar">Mahisagar</option>
                                    <option value="Mehsana">Mehsana</option>
                                    <option value="Morbi">Morbi</option>
                                    <option value="Narmada">Narmada</option>
                                    <option value="Navsari">Navsari</option>
                                    <option value="Patan">Patan</option>
                                    <option value="Panchmahal">Panchmahal</option>
                                    <option value="Porbandar">Porbandar</option>
                                    <option value="Rajkot">Rajkot</option>
                                    <option value="Sabarkantha">Sabarkantha</option>
                                    <option value="Surat">Surat</option>
                                    <option value="Surendranagar">Surendranagar</option>
                                    <option value="Tapi">Tapi</option>
                                    <option value="Vadodara">Vadodara</option>
                                    <option value="Valsad">Valsad</option>
        
                                    <!-- Rajasthan -->
                                    <option value="Ajmer">Ajmer</option>
                                    <option value="Alwar">Alwar</option>
                                    <option value="Banswara">Banswara</option>
                                    <option value="Baran">Baran</option>
                                    <option value="Barmer">Barmer</option>
                                    <option value="Bharatpur">Bharatpur</option>
                                    <option value="Bhilwara">Bhilwara</option>
                                    <option value="Bikaner">Bikaner</option>
                                    <option value="Bundi">Bundi</option>
                                    <option value="Chittorgarh">Chittorgarh</option>
                                    <option value="Churu">Churu</option>
                                    <option value="Dausa">Dausa</option>
                                    <option value="Dholpur">Dholpur</option>
                                    <option value="Dungarpur">Dungarpur</option>
                                    <option value="Hanumangarh">Hanumangarh</option>
                                    <option value="Jaipur">Jaipur</option>
                                    <option value="Jaisalmer">Jaisalmer</option>
                                    <option value="Jalore">Jalore</option>
                                    <option value="Jhalawar">Jhalawar</option>
                                    <option value="Jhunjhunu">Jhunjhunu</option>
                                    <option value="Jodhpur">Jodhpur</option>
                                    <option value="Karauli">Karauli</option>
                                    <option value="Kota">Kota</option>
                                    <option value="Nagaur">Nagaur</option>
                                    <option value="Pali">Pali</option>
                                    <option value="Pratapgarh">Pratapgarh</option>
                                    <option value="Rajsamand">Rajsamand</option>
                                    <option value="Sikar">Sikar</option>
                                    <option value="Sirohi">Sirohi</option>
                                    <option value="Sri Ganganagar">Sri Ganganagar</option>
                                    <option value="Tonk">Tonk</option>
                                    <option value="Udaipur">Udaipur</option>
        
                                    <!-- Maharashtra -->
                                    <option value="Ahmednagar">Ahmednagar</option>
                                    <option value="Akola">Akola</option>
                                    <option value="Amravati">Amravati</option>
                                    <option value="Aurangabad">Aurangabad</option>
                                    <option value="Beed">Beed</option>
                                    <option value="Bhandara">Bhandara</option>
                                    <option value="Chandrapur">Chandrapur</option>
                                    <option value="Dhule">Dhule</option>
                                    <option value="Gadchiroli">Gadchiroli</option>
                                    <option value="Gondia">Gondia</option>
                                    <option value="Hingoli">Hingoli</option>
                                    <option value="Jalgaon">Jalgaon</option>
                                    <option value="Jalna">Jalna</option>
                                    <option value="Kolhapur">Kolhapur</option>
                                    <option value="Latur">Latur</option>
                                    <option value="Mumbai City">Mumbai City</option>
                                    <option value="Mumbai Suburban">Mumbai Suburban</option>
                                    <option value="Nagpur">Nagpur</option>
                                    <option value="Nanded">Nanded</option>
                                    <option value="Nandurbar">Nandurbar</option>
                                    <option value="Nashik">Nashik</option>
                                    <option value="Osmanabad">Osmanabad</option>
                                    <option value="Palghar">Palghar</option>
                                    <option value="Parbhani">Parbhani</option>
                                    <option value="Pune">Pune</option>
                                    <option value="Raigad">Raigad</option>
                                    <option value="Ratnagiri">Ratnagiri</option>
                                    <option value="Sangli">Sangli</option>
                                    <option value="Satara">Satara</option>
                                    <option value="Sindhudurg">Sindhudurg</option>
                                    <option value="Solapur">Solapur</option>
                                    <option value="Thane">Thane</option>
                                    <option value="Wardha">Wardha</option>
                                    <option value="Washim">Washim</option>
                                    <option value="Yavatmal">Yavatmal</option>
        
                                    <!-- Uttar Pradesh -->
                                    <option value="Agra">Agra</option>
                                    <option value="Aligarh">Aligarh</option>
                                    <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                    <option value="Amethi">Amethi</option>
                                    <option value="Amroha">Amroha</option>
                                    <option value="Auraiya">Auraiya</option>
                                    <option value="Ayodhya">Ayodhya</option>
                                    <option value="Azamgarh">Azamgarh</option>
                                    <option value="Bagpat">Bagpat</option>
                                    <option value="Bahraich">Bahraich</option>
                                    <option value="Ballia">Ballia</option>
                                    <option value="Balrampur">Balrampur</option>
                                    <option value="Banda">Banda</option>
                                    <option value="Barabanki">Barabanki</option>
                                    <option value="Bareilly">Bareilly</option>
                                    <option value="Basti">Basti</option>
                                    <option value="Bhadohi">Bhadohi</option>
                                    <option value="Bijnor">Bijnor</option>
                                    <option value="Bulandshahr">Bulandshahr</option>
                                    <option value="Chandauli">Chandauli</option>
                                    <option value="Chitrakoot">Chitrakoot</option>
                                    <option value="Deoria">Deoria</option>
                                    <option value="Etah">Etah</option>
                                    <option value="Etawah">Etawah</option>
                                    <option value="Farrukhabad">Farrukhabad</option>
                                    <option value="Fatehpur">Fatehpur</option>
                                    <option value="Firozabad">Firozabad</option>
                                    <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                    <option value="Ghaziabad">Ghaziabad</option>
                                    <option value="Ghazipur">Ghazipur</option>
                                    <option value="Gonda">Gonda</option>
                                    <option value="Gorakhpur">Gorakhpur</option>
                                    <option value="Hamirpur">Hamirpur</option>
                                    <option value="Hapur">Hapur</option>
                                    <option value="Hardoi">Hardoi</option>
                                    <option value="Hathras">Hathras</option>
                                    <option value="Jalaun">Jalaun</option>
                                    <option value="Jaunpur">Jaunpur</option>
                                    <option value="Jhansi">Jhansi</option>
                                    <option value="Kannauj">Kannauj</option>
                                    <option value="Kanpur Dehat">Kanpur Dehat</option>
                                    <option value="Kanpur Nagar">Kanpur Nagar</option>
                                    <option value="Kasganj">Kasganj</option>
                                    <option value="Kaushambi">Kaushambi</option>
                                    <option value="Kushinagar">Kushinagar</option>
                                    <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                    <option value="Lalitpur">Lalitpur</option>
                                    <option value="Lucknow">Lucknow</option>
                                    <option value="Maharajganj">Maharajganj</option>
                                    <option value="Mahoba">Mahoba</option>
                                    <option value="Mainpuri">Mainpuri</option>
                                    <option value="Mathura">Mathura</option>
                                    <option value="Mau">Mau</option>
                                    <option value="Meerut">Meerut</option>
                                    <option value="Mirzapur">Mirzapur</option>
                                    <option value="Moradabad">Moradabad</option>
                                    <option value="Muzaffarnagar">Muzaffarnagar</option>
                                    <option value="Pilibhit">Pilibhit</option>
                                    <option value="Pratapgarh">Pratapgarh</option>
                                    <option value="Rae Bareli">Rae Bareli</option>
                                    <option value="Rampur">Rampur</option>
                                    <option value="Saharanpur">Saharanpur</option>
                                    <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                    <option value="Shahjahanpur">Shahjahanpur</option>
                                    <option value="Shravasti">Shravasti</option>
                                    <option value="Siddharthnagar">Siddharthnagar</option>
                                    <option value="Sitapur">Sitapur</option>
                                    <option value="Sonbhadra">Sonbhadra</option>
                                    <option value="Sultanpur">Sultanpur</option>
                                    <option value="Unnao">Unnao</option>
                                    <option value="Varanasi">Varanasi</option>
        
                                    <!-- Uttarakhand -->
                                    <option value="Almora">Almora</option>
                                    <option value="Bageshwar">Bageshwar</option>
                                    <option value="Chamoli">Chamoli</option>
                                    <option value="Champawat">Champawat</option>
                                    <option value="Dehradun">Dehradun</option>
                                    <option value="Haridwar">Haridwar</option>
                                    <option value="Nainital">Nainital</option>
                                    <option value="Pauri Garhwal">Pauri Garhwal</option>
                                    <option value="Pithoragarh">Pithoragarh</option>
                                    <option value="Rudraprayag">Rudraprayag</option>
                                    <option value="Tehri Garhwal">Tehri Garhwal</option>
                                    <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                    <option value="Uttarkashi">Uttarkashi</option>
                                            <option value="other">Other (Please specify)</option>
                                </select>
                                <input type="text" id="webAppOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="webAppState">State*</label>
                            <select id="webAppState" name="state" required>
                                <option value="">Select State</option>
                                <option value="Andhra Pradesh">Andhra Pradesh</option>
                                <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                <option value="Assam">Assam</option>
                                <option value="Bihar">Bihar</option>
                                <option value="Chhattisgarh">Chhattisgarh</option>
                                <option value="Goa">Goa</option>
                                <option value="Gujarat">Gujarat</option>
                                <option value="Haryana">Haryana</option>
                                <option value="Himachal Pradesh">Himachal Pradesh</option>
                                <option value="Jharkhand">Jharkhand</option>
                                <option value="Karnataka">Karnataka</option>
                                <option value="Kerala">Kerala</option>
                                <option value="Madhya Pradesh">Madhya Pradesh</option>
                                <option value="Maharashtra">Maharashtra</option>
                                <option value="Manipur">Manipur</option>
                                <option value="Meghalaya">Meghalaya</option>
                                <option value="Mizoram">Mizoram</option>
                                <option value="Nagaland">Nagaland</option>
                                <option value="Odisha">Odisha</option>
                                <option value="Punjab">Punjab</option>
                                <option value="Rajasthan">Rajasthan</option>
                                <option value="Sikkim">Sikkim</option>
                                <option value="Tamil Nadu">Tamil Nadu</option>
                                <option value="Telangana">Telangana</option>
                                <option value="Tripura">Tripura</option>
                                <option value="Uttar Pradesh">Uttar Pradesh</option>
                                <option value="Uttarakhand">Uttarakhand</option>
                                <option value="West Bengal">West Bengal</option>
                                <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                <option value="Chandigarh">Chandigarh</option>
                                <option value="Dadra and Nagar Haveli and Daman and Diu">Dadra and Nagar Haveli and Daman and Diu</option>
                                <option value="Delhi">Delhi</option>
                                <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                                <option value="Ladakh">Ladakh</option>
                                <option value="Lakshadweep">Lakshadweep</option>
                                <option value="Puducherry">Puducherry</option>
                                
                            </select>
                        </div>
                    </div>

                    <!-- Audit Dates -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="webAppStartDate">Start Audit Date*</label>
                            <input type="date" id="webAppStartDate" name="startDate" required>
                        </div>
                        <div class="form-group">
                            <label for="webAppEndDate">Finish Audit Date*</label>
                            <input type="date" id="webAppEndDate" name="endDate" required>
                        </div>
                    </div>

                    <!-- Report Prepared By -->
                    <div class="form-group">
                        <label>Report Prepared By*</label>
                        <div class="name-input">
                            <select class="title-select" name="preparedByTitle" required>
                                <option value="Mr.">Mr.</option>
                                <option value="Ms.">Ms.</option>
                                <option value="Mrs.">Mrs.</option>
                                <option value="Dr.">Dr.</option>
                            </select>
                            <input type="text" placeholder="Full Name" name="preparedByName" required>
                        </div>
                    </div>


                    <!-- Application Type -->
                    <div class="form-group">
                        <label>Application Type*</label>
                        <div class="radio-group">
                            <label><input type="radio" name="applicationType" value="Internal" id="webAppApplicationTypeInternal" checked> Internal</label>
                            <label><input type="radio" name="applicationType" value="External" id="webAppApplicationTypeExternal"> External</label>
                        </div>
                    </div>

                    <!-- Asset Details -->
                    <div class="form-group">
                        <label>Asset Details* (At least 1 required, max 8)</label>
                        <div id="webAppAssetContainer">
                            <div class="asset-entry" data-asset-index="0">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="webAppAssetDescription_0">Asset Description*</label>
                                        <input type="text" id="webAppAssetDescription_0" name="assetDescription[]" placeholder="Enter asset description" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="webAppAssetCriticality_0">Criticality of Asset*</label>
                                        <input type="text" id="webAppAssetCriticality_0" name="assetCriticality[]" placeholder="Enter criticality" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="webAppAssetIp_0"><span class="webAppAssetIpLabel">Internal IP Addresses*</span></label>
                                        <input type="text" id="webAppAssetIp_0" name="assetInternalIp[]" class="webAppAssetIpInput" placeholder="Enter internal IP addresses" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="webAppAssetUrl_0">URL*</label>
                                        <input type="text" id="webAppAssetUrl_0" name="assetUrl[]" placeholder="Enter URL" required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="webAppAssetVersion_0">Version*</label>
                                    <input type="text" id="webAppAssetVersion_0" name="assetVersion[]" placeholder="Enter version" required>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="add-member-btn" id="webAppAddAssetBtn">+ Add Asset</button>
                    </div>
                    <!-- Auditee Details -->
                    <div class="form-group">
                        <label>Name of Auditee Organization Person*</label>
                        <div class="name-input">
                            <select class="title-select" name="auditeeTitle" required>
                                <option value="Mr.">Mr.</option>
                                <option value="Ms.">Ms.</option>
                                <option value="Mrs.">Mrs.</option>
                                <option value="Dr.">Dr.</option>
                            </select>
                            <input type="text" placeholder="Full Name" name="auditeeName" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="webAppDesignation">Designation of the Person*</label>
                        <input type="text" id="webAppDesignation" name="designation" required>
                    </div>

                    <div class="form-group">
                        <label for="webAppBankEmail">Email ID of the Organization*</label>
                        <div id="webAppEmailContainer">
                            <input type="email" name="bankEmail[]" placeholder="Email Address" required>
                        </div>
                        <button type="button" class="add-member-btn" id="webAppAddEmailBtn" style="margin-top: 10px;">+ Add Another Email</button>
                    </div>

                    <!-- Auditing Team -->
                    <div class="form-group">
                        <label>Details of Auditing Team* (At least 1 required, max 8)</label>
                        <div id="webAppAuditTeamContainer">
                            <div class="team-member" data-index="0">
                                <div class="form-row">
                                    <div class="form-group">
                                        <input type="text" name="teamName[]" placeholder="Name*" required>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" name="teamQualification[]" placeholder="Qualification/Certification*" required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Certified (Yes/No)*</label>
                                    <div class="radio-group">
                                        <label><input type="radio" name="teamCertified[0]" value="yes" required> Yes</label>
                                        <label><input type="radio" name="teamCertified[0]" value="no"> No</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="add-member-btn" id="webAppAddMemberBtn">+ Add Team Member</button>
                    </div>

                    <!-- Vulnerability Status Radio Buttons -->
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid #ddd;">
                    <div class="form-group">
                        <label class="form-label" style="margin-bottom: 10px;">Vulnerability Status*</label>
                        <div style="display: flex; gap: 30px; margin-top: 10px;">
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="radio" name="webAppVulnerabilityStatus" value="0" required onchange="toggleWebAppFirstAuditVulnerabilitySection()" style="width: auto;">
                                <span>0 Vulnerabilities</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="radio" name="webAppVulnerabilityStatus" value="has" required onchange="toggleWebAppFirstAuditVulnerabilitySection()" style="width: auto;">
                                <span>Has Vulnerability</span>
                            </label>
                        </div>
                    </div>

                    <!-- Vulnerability Details Section -->
                    <div id="webAppFirstAuditVulnerabilitySection" style="display: none;">
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid #ddd;">
                    <div class="form-group">
                        <h3 style="margin-bottom: 15px;">Vulnerability Details</h3>
                        
                        <div id="webAppVulnerabilityContainer">
                            <div class="vulnerability-entry" data-vuln-index="0">
                                <h4 style="color: #2c3e50; margin-bottom: 10px;">Vulnerability 1</h4>
                                
                                <div class="form-group">
                                    <label for="webAppVulnVulnerabilities_0">Vulnerabilities*</label>
                                    <textarea id="webAppVulnVulnerabilities_0" name="vulnVulnerabilities[]" placeholder="Enter vulnerabilities" rows="3" required></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="webAppVulnName_0">Name of Vulnerability*</label>
                                    <input type="text" id="webAppVulnName_0" name="vulnName[]" placeholder="Enter vulnerability name" required>
                                </div>

                                <div class="form-group">
                                    <label for="webAppVulnRiskFactor_0">Risk Factor*</label>
                                    <select id="webAppVulnRiskFactor_0" name="vulnRiskFactor[]" required>
                                        <option value="">Select Risk Factor</option>
                                        <option value="Critical">Critical</option>
                                        <option value="High">High</option>
                                        <option value="Medium">Medium</option>
                                        <option value="Low">Low</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="webAppVulnCVE_0">CVE ID</label>
                                    <input type="text" id="webAppVulnCVE_0" name="vulnCVE[]" placeholder="Enter CVE ID (optional)">
                                </div>

                                <div class="form-group">
                                    <label for="webAppVulnCVSS_0">CVSS</label>
                                    <input type="text" id="webAppVulnCVSS_0" name="vulnCVSS[]" placeholder="Enter CVSS score (optional)">
                                </div>

                                <div class="form-group">
                                    <label for="webAppVulnObservation_0">Audit Observation*</label>
                                    <textarea id="webAppVulnObservation_0" name="vulnObservation[]" rows="3" placeholder="Enter audit observation" required></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="webAppVulnImpact_0">Impact*</label>
                                    <textarea id="webAppVulnImpact_0" name="vulnImpact[]" rows="3" placeholder="Enter impact description" required></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="webAppVulnRecommendation_0">Recommendation / Countermeasure*</label>
                                    <textarea id="webAppVulnRecommendation_0" name="vulnRecommendation[]" rows="3" placeholder="Enter recommendation" required></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="webAppVulnReference_0">Reference Link</label>
                                    <textarea id="webAppVulnReference_0" name="vulnReference[]" placeholder="Enter reference URL (optional)" rows="2"></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="webAppVulnAffectedSystem_0">Affected Systems*</label>
                                    <input type="text" id="webAppVulnAffectedSystem_0" name="vulnAffectedSystem[]" placeholder="Enter affected systems" required>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="add-member-btn" id="webAppAddVulnerabilityBtn" style="margin-top: 15px;">+ Add New Vulnerability</button>
                    </div>

                    <!-- File Upload -->
                    <div class="form-group">
                        <label>File Upload*</label>
                        
                        <div class="file-upload-group">
                            <label for="webAppEvidenceFiles">Evidences Zip Files</label>
                            <input type="file" id="webAppEvidenceFiles" name="evidenceFiles" accept=".zip" required>
                            <small class="file-help" style="color: brown;">Upload evidence ZIP file containing vulnerability proofs.</small>
                        </div>
                    </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeVaptModal('webAppFirstAuditModal')">Cancel</button>
                        <button type="submit" class="submit-btn">Submit Report</button>
                    </div>
                    <br>
                    <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>  
                    </small>
                </form>
            </div>
        </div>
    </div>

    <!-- Android Mobile Application VAPT First Audit Modal -->
    <div id="androidAppFirstAuditModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Android Mobile Application VAPT First Audit Details</h3>
                <span class="close-modal" onclick="closeVaptModal('androidAppFirstAuditModal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="androidAppFirstAuditForm" action="/process_android_app_vapt_first_audit_report" method="POST" enctype="multipart/form-data">
                    <!-- Organization Section -->
                    <div class="form-group">
                        <label for="androidAppOrganization">Organization Name*</label>
                        <div class="combo-input">
                            <select id="androidAppOrganization" name="organization" required onchange="toggleVaptOtherInput('androidAppOrganization', 'androidAppOtherOrganization')">
                                <option value="">Select Organization</option>
                                <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                <option value="Megasoft Limited">Megasoft Limited</option>
                                <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                
    
                                <option value="other">Other (Please specify)</option>
                            </select>
                            <input type="text" id="androidAppOtherOrganization" name="otherOrganization" class="hidden" placeholder="Enter Organization Name">
                        </div>
                    </div>

                    <!-- Location Section -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="androidAppCity">City*</label>
                            <div class="combo-input">
                                <select id="androidAppCity" name="city" required onchange="toggleVaptOtherInput('androidAppCity', 'androidAppOtherCity')">
                                    <option value="">Select City</option>
                                    <option value="Ahmedabad">Ahmedabad</option>
                                    <option value="Amreli">Amreli</option>
                                    <option value="Anand">Anand</option>
                                    <option value="Aravalli">Aravalli</option>
                                    <option value="Banaskantha">Banaskantha</option>
                                    <option value="Bharuch">Bharuch</option>
                                    <option value="Bhavnagar">Bhavnagar</option>
                                    <option value="Botad">Botad</option>
                                    <option value="Chhota Udaipur">Chhota Udaipur</option>
                                    <option value="Dahod">Dahod</option>
                                    <option value="Dang">Dang</option>
                                    <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                    <option value="Gandhinagar">Gandhinagar</option>
                                    <option value="Gir Somnath">Gir Somnath</option>
                                    <option value="Jamnagar">Jamnagar</option>
                                    <option value="Junagadh">Junagadh</option>
                                    <option value="Kheda">Kheda</option>
                                    <option value="Kutch">Kutch</option>
                                    <option value="Mahisagar">Mahisagar</option>
                                    <option value="Mehsana">Mehsana</option>
                                    <option value="Morbi">Morbi</option>
                                    <option value="Narmada">Narmada</option>
                                    <option value="Navsari">Navsari</option>
                                    <option value="Patan">Patan</option>
                                    <option value="Panchmahal">Panchmahal</option>
                                    <option value="Porbandar">Porbandar</option>
                                    <option value="Rajkot">Rajkot</option>
                                    <option value="Sabarkantha">Sabarkantha</option>
                                    <option value="Surat">Surat</option>
                                    <option value="Surendranagar">Surendranagar</option>
                                    <option value="Tapi">Tapi</option>
                                    <option value="Vadodara">Vadodara</option>
                                    <option value="Valsad">Valsad</option>
        
                                    <!-- Rajasthan -->
                                    <option value="Ajmer">Ajmer</option>
                                    <option value="Alwar">Alwar</option>
                                    <option value="Banswara">Banswara</option>
                                    <option value="Baran">Baran</option>
                                    <option value="Barmer">Barmer</option>
                                    <option value="Bharatpur">Bharatpur</option>
                                    <option value="Bhilwara">Bhilwara</option>
                                    <option value="Bikaner">Bikaner</option>
                                    <option value="Bundi">Bundi</option>
                                    <option value="Chittorgarh">Chittorgarh</option>
                                    <option value="Churu">Churu</option>
                                    <option value="Dausa">Dausa</option>
                                    <option value="Dholpur">Dholpur</option>
                                    <option value="Dungarpur">Dungarpur</option>
                                    <option value="Hanumangarh">Hanumangarh</option>
                                    <option value="Jaipur">Jaipur</option>
                                    <option value="Jaisalmer">Jaisalmer</option>
                                    <option value="Jalore">Jalore</option>
                                    <option value="Jhalawar">Jhalawar</option>
                                    <option value="Jhunjhunu">Jhunjhunu</option>
                                    <option value="Jodhpur">Jodhpur</option>
                                    <option value="Karauli">Karauli</option>
                                    <option value="Kota">Kota</option>
                                    <option value="Nagaur">Nagaur</option>
                                    <option value="Pali">Pali</option>
                                    <option value="Pratapgarh">Pratapgarh</option>
                                    <option value="Rajsamand">Rajsamand</option>
                                    <option value="Sikar">Sikar</option>
                                    <option value="Sirohi">Sirohi</option>
                                    <option value="Sri Ganganagar">Sri Ganganagar</option>
                                    <option value="Tonk">Tonk</option>
                                    <option value="Udaipur">Udaipur</option>
        
                                    <!-- Maharashtra -->
                                    <option value="Ahmednagar">Ahmednagar</option>
                                    <option value="Akola">Akola</option>
                                    <option value="Amravati">Amravati</option>
                                    <option value="Aurangabad">Aurangabad</option>
                                    <option value="Beed">Beed</option>
                                    <option value="Bhandara">Bhandara</option>
                                    <option value="Chandrapur">Chandrapur</option>
                                    <option value="Dhule">Dhule</option>
                                    <option value="Gadchiroli">Gadchiroli</option>
                                    <option value="Gondia">Gondia</option>
                                    <option value="Hingoli">Hingoli</option>
                                    <option value="Jalgaon">Jalgaon</option>
                                    <option value="Jalna">Jalna</option>
                                    <option value="Kolhapur">Kolhapur</option>
                                    <option value="Latur">Latur</option>
                                    <option value="Mumbai City">Mumbai City</option>
                                    <option value="Mumbai Suburban">Mumbai Suburban</option>
                                    <option value="Nagpur">Nagpur</option>
                                    <option value="Nanded">Nanded</option>
                                    <option value="Nandurbar">Nandurbar</option>
                                    <option value="Nashik">Nashik</option>
                                    <option value="Osmanabad">Osmanabad</option>
                                    <option value="Palghar">Palghar</option>
                                    <option value="Parbhani">Parbhani</option>
                                    <option value="Pune">Pune</option>
                                    <option value="Raigad">Raigad</option>
                                    <option value="Ratnagiri">Ratnagiri</option>
                                    <option value="Sangli">Sangli</option>
                                    <option value="Satara">Satara</option>
                                    <option value="Sindhudurg">Sindhudurg</option>
                                    <option value="Solapur">Solapur</option>
                                    <option value="Thane">Thane</option>
                                    <option value="Wardha">Wardha</option>
                                    <option value="Washim">Washim</option>
                                    <option value="Yavatmal">Yavatmal</option>
        
                                    <!-- Uttar Pradesh -->
                                    <option value="Agra">Agra</option>
                                    <option value="Aligarh">Aligarh</option>
                                    <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                    <option value="Amethi">Amethi</option>
                                    <option value="Amroha">Amroha</option>
                                    <option value="Auraiya">Auraiya</option>
                                    <option value="Ayodhya">Ayodhya</option>
                                    <option value="Azamgarh">Azamgarh</option>
                                    <option value="Bagpat">Bagpat</option>
                                    <option value="Bahraich">Bahraich</option>
                                    <option value="Ballia">Ballia</option>
                                    <option value="Balrampur">Balrampur</option>
                                    <option value="Banda">Banda</option>
                                    <option value="Barabanki">Barabanki</option>
                                    <option value="Bareilly">Bareilly</option>
                                    <option value="Basti">Basti</option>
                                    <option value="Bhadohi">Bhadohi</option>
                                    <option value="Bijnor">Bijnor</option>
                                    <option value="Bulandshahr">Bulandshahr</option>
                                    <option value="Chandauli">Chandauli</option>
                                    <option value="Chitrakoot">Chitrakoot</option>
                                    <option value="Deoria">Deoria</option>
                                    <option value="Etah">Etah</option>
                                    <option value="Etawah">Etawah</option>
                                    <option value="Farrukhabad">Farrukhabad</option>
                                    <option value="Fatehpur">Fatehpur</option>
                                    <option value="Firozabad">Firozabad</option>
                                    <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                    <option value="Ghaziabad">Ghaziabad</option>
                                    <option value="Ghazipur">Ghazipur</option>
                                    <option value="Gonda">Gonda</option>
                                    <option value="Gorakhpur">Gorakhpur</option>
                                    <option value="Hamirpur">Hamirpur</option>
                                    <option value="Hapur">Hapur</option>
                                    <option value="Hardoi">Hardoi</option>
                                    <option value="Hathras">Hathras</option>
                                    <option value="Jalaun">Jalaun</option>
                                    <option value="Jaunpur">Jaunpur</option>
                                    <option value="Jhansi">Jhansi</option>
                                    <option value="Kannauj">Kannauj</option>
                                    <option value="Kanpur Dehat">Kanpur Dehat</option>
                                    <option value="Kanpur Nagar">Kanpur Nagar</option>
                                    <option value="Kasganj">Kasganj</option>
                                    <option value="Kaushambi">Kaushambi</option>
                                    <option value="Kushinagar">Kushinagar</option>
                                    <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                    <option value="Lalitpur">Lalitpur</option>
                                    <option value="Lucknow">Lucknow</option>
                                    <option value="Maharajganj">Maharajganj</option>
                                    <option value="Mahoba">Mahoba</option>
                                    <option value="Mainpuri">Mainpuri</option>
                                    <option value="Mathura">Mathura</option>
                                    <option value="Mau">Mau</option>
                                    <option value="Meerut">Meerut</option>
                                    <option value="Mirzapur">Mirzapur</option>
                                    <option value="Moradabad">Moradabad</option>
                                    <option value="Muzaffarnagar">Muzaffarnagar</option>
                                    <option value="Pilibhit">Pilibhit</option>
                                    <option value="Pratapgarh">Pratapgarh</option>
                                    <option value="Rae Bareli">Rae Bareli</option>
                                    <option value="Rampur">Rampur</option>
                                    <option value="Saharanpur">Saharanpur</option>
                                    <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                    <option value="Shahjahanpur">Shahjahanpur</option>
                                    <option value="Shravasti">Shravasti</option>
                                    <option value="Siddharthnagar">Siddharthnagar</option>
                                    <option value="Sitapur">Sitapur</option>
                                    <option value="Sonbhadra">Sonbhadra</option>
                                    <option value="Sultanpur">Sultanpur</option>
                                    <option value="Unnao">Unnao</option>
                                    <option value="Varanasi">Varanasi</option>
        
                                    <!-- Uttarakhand -->
                                    <option value="Almora">Almora</option>
                                    <option value="Bageshwar">Bageshwar</option>
                                    <option value="Chamoli">Chamoli</option>
                                    <option value="Champawat">Champawat</option>
                                    <option value="Dehradun">Dehradun</option>
                                    <option value="Haridwar">Haridwar</option>
                                    <option value="Nainital">Nainital</option>
                                    <option value="Pauri Garhwal">Pauri Garhwal</option>
                                    <option value="Pithoragarh">Pithoragarh</option>
                                    <option value="Rudraprayag">Rudraprayag</option>
                                    <option value="Tehri Garhwal">Tehri Garhwal</option>
                                    <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                    <option value="Uttarkashi">Uttarkashi</option>
                                            <option value="other">Other (Please specify)</option>
                                </select>
                                <input type="text" id="androidAppOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="androidAppState">State*</label>
                            <select id="androidAppState" name="state" required>
                                <option value="">Select State</option>
                                <option value="Andhra Pradesh">Andhra Pradesh</option>
                                <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                <option value="Assam">Assam</option>
                                <option value="Bihar">Bihar</option>
                                <option value="Chhattisgarh">Chhattisgarh</option>
                                <option value="Goa">Goa</option>
                                <option value="Gujarat">Gujarat</option>
                                <option value="Haryana">Haryana</option>
                                <option value="Himachal Pradesh">Himachal Pradesh</option>
                                <option value="Jharkhand">Jharkhand</option>
                                <option value="Karnataka">Karnataka</option>
                                <option value="Kerala">Kerala</option>
                                <option value="Madhya Pradesh">Madhya Pradesh</option>
                                <option value="Maharashtra">Maharashtra</option>
                                <option value="Manipur">Manipur</option>
                                <option value="Meghalaya">Meghalaya</option>
                                <option value="Mizoram">Mizoram</option>
                                <option value="Nagaland">Nagaland</option>
                                <option value="Odisha">Odisha</option>
                                <option value="Punjab">Punjab</option>
                                <option value="Rajasthan">Rajasthan</option>
                                <option value="Sikkim">Sikkim</option>
                                <option value="Tamil Nadu">Tamil Nadu</option>
                                <option value="Telangana">Telangana</option>
                                <option value="Tripura">Tripura</option>
                                <option value="Uttar Pradesh">Uttar Pradesh</option>
                                <option value="Uttarakhand">Uttarakhand</option>
                                <option value="West Bengal">West Bengal</option>
                                <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                <option value="Chandigarh">Chandigarh</option>
                                <option value="Dadra and Nagar Haveli and Daman and Diu">Dadra and Nagar Haveli and Daman and Diu</option>
                                <option value="Delhi">Delhi</option>
                                <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                                <option value="Ladakh">Ladakh</option>
                                <option value="Lakshadweep">Lakshadweep</option>
                                <option value="Puducherry">Puducherry</option>
                                
                            </select>
                        </div>
                    </div>

                    <!-- Audit Dates -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="androidAppStartDate">Start Audit Date*</label>
                            <input type="date" id="androidAppStartDate" name="startDate" required>
                        </div>
                        <div class="form-group">
                            <label for="androidAppEndDate">Finish Audit Date*</label>
                            <input type="date" id="androidAppEndDate" name="endDate" required>
                        </div>
                    </div>

                    <!-- Report Prepared By -->
                    <div class="form-group">
                        <label>Report Prepared By*</label>
                        <div class="name-input">
                            <select class="title-select" name="preparedByTitle" required>
                                <option value="Mr.">Mr.</option>
                                <option value="Ms.">Ms.</option>
                                <option value="Mrs.">Mrs.</option>
                                <option value="Dr.">Dr.</option>
                            </select>
                            <input type="text" placeholder="Full Name" name="preparedByName" required>
                        </div>
                    </div>


                    <!-- Asset Details -->
                    <div class="form-group">
                        <label>Asset Details* (At least 1 required, max 8)</label>
                        <div id="androidAppAssetContainer">
                            <div class="asset-entry android-asset-entry" data-asset-index="0">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="androidAppAssetDescription_0">Asset Description*</label>
                                        <input type="text" id="androidAppAssetDescription_0" name="assetDescription[]" placeholder="Enter asset description" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="androidAppAssetCriticality_0">Criticality of Asset*</label>
                                        <input type="text" id="androidAppAssetCriticality_0" name="assetCriticality[]" placeholder="Enter criticality" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="androidAppAssetHash_0">Hash Value*</label>
                                        <input type="text" id="androidAppAssetHash_0" name="assetHash[]" placeholder="Enter hash value" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="androidAppAssetVersion_0">Version*</label>
                                        <input type="text" id="androidAppAssetVersion_0" name="assetVersion[]" placeholder="Enter version" required>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="add-member-btn" id="androidAppAddAssetBtn">+ Add Asset</button>
                    </div>
                    <!-- Auditee Details -->
                    <div class="form-group">
                        <label>Name of Auditee Organization Person*</label>
                        <div class="name-input">
                            <select class="title-select" name="auditeeTitle" required>
                                <option value="Mr.">Mr.</option>
                                <option value="Ms.">Ms.</option>
                                <option value="Mrs.">Mrs.</option>
                                <option value="Dr.">Dr.</option>
                            </select>
                            <input type="text" placeholder="Full Name" name="auditeeName" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="androidAppDesignation">Designation of the Person*</label>
                        <input type="text" id="androidAppDesignation" name="designation" required>
                    </div>

                    <div class="form-group">
                        <label for="androidAppBankEmail">Email ID of the Organization*</label>
                        <div id="androidAppEmailContainer">
                            <input type="email" name="bankEmail[]" placeholder="Email Address" required>
                        </div>
                        <button type="button" class="add-member-btn" id="androidAppAddEmailBtn" style="margin-top: 10px;">+ Add Another Email</button>
                    </div>

                    <!-- Auditing Team -->
                    <div class="form-group">
                        <label>Details of Auditing Team* (At least 1 required, max 8)</label>
                        <div id="androidAppAuditTeamContainer">
                            <div class="team-member" data-index="0">
                                <div class="form-row">
                                    <div class="form-group">
                                        <input type="text" name="teamName[]" placeholder="Name*" required>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" name="teamQualification[]" placeholder="Qualification/Certification*" required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Certified (Yes/No)*</label>
                                    <div class="radio-group">
                                        <label><input type="radio" name="teamCertified[0]" value="yes" required> Yes</label>
                                        <label><input type="radio" name="teamCertified[0]" value="no"> No</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="add-member-btn" id="androidAppAddMemberBtn">+ Add Team Member</button>
                    </div>

                    <!-- Vulnerability Status Radio Buttons -->
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid #ddd;">
                    <div class="form-group">
                        <label class="form-label" style="margin-bottom: 10px;">Vulnerability Status*</label>
                        <div style="display: flex; gap: 30px; margin-top: 10px;">
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="radio" name="androidAppVulnerabilityStatus" value="0" required onchange="toggleAndroidAppFirstAuditVulnerabilitySection()" style="width: auto;">
                                <span>0 Vulnerabilities</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="radio" name="androidAppVulnerabilityStatus" value="has" required onchange="toggleAndroidAppFirstAuditVulnerabilitySection()" style="width: auto;">
                                <span>Has Vulnerability</span>
                            </label>
                        </div>
                    </div>

                    <!-- Vulnerability Details Section -->
                    <div id="androidAppFirstAuditVulnerabilitySection" style="display: none;">
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid #ddd;">
                    <div class="form-group">
                        <h3 style="margin-bottom: 15px;">Vulnerability Details</h3>
                        
                        <div id="androidAppVulnerabilityContainer">
                            <div class="vulnerability-entry" data-vuln-index="0">
                                <h4 style="color: #2c3e50; margin-bottom: 10px;">Vulnerability 1</h4>
                                
                                <div class="form-group">
                                    <label for="androidAppVulnVulnerabilities_0">Vulnerabilities*</label>
                                    <textarea id="androidAppVulnVulnerabilities_0" name="vulnVulnerabilities[]" placeholder="Enter vulnerabilities" rows="3" required></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="androidAppVulnName_0">Name of Vulnerability*</label>
                                    <input type="text" id="androidAppVulnName_0" name="vulnName[]" placeholder="Enter vulnerability name" required>
                                </div>

                                <div class="form-group">
                                    <label for="androidAppVulnRiskFactor_0">Risk Factor*</label>
                                    <select id="androidAppVulnRiskFactor_0" name="vulnRiskFactor[]" required>
                                        <option value="">Select Risk Factor</option>
                                        <option value="Critical">Critical</option>
                                        <option value="High">High</option>
                                        <option value="Medium">Medium</option>
                                        <option value="Low">Low</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="androidAppVulnCVE_0">CVE ID</label>
                                    <input type="text" id="androidAppVulnCVE_0" name="vulnCVE[]" placeholder="Enter CVE ID (optional)">
                                </div>

                                <div class="form-group">
                                    <label for="androidAppVulnCVSS_0">CVSS</label>
                                    <input type="text" id="androidAppVulnCVSS_0" name="vulnCVSS[]" placeholder="Enter CVSS score (optional)">
                                </div>

                                <div class="form-group">
                                    <label for="androidAppVulnObservation_0">Audit Observation*</label>
                                    <textarea id="androidAppVulnObservation_0" name="vulnObservation[]" rows="3" placeholder="Enter audit observation" required></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="androidAppVulnImpact_0">Impact*</label>
                                    <textarea id="androidAppVulnImpact_0" name="vulnImpact[]" rows="3" placeholder="Enter impact description" required></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="androidAppVulnRecommendation_0">Recommendation / Countermeasure*</label>
                                    <textarea id="androidAppVulnRecommendation_0" name="vulnRecommendation[]" rows="3" placeholder="Enter recommendation" required></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="androidAppVulnReference_0">Reference Link</label>
                                    <textarea id="androidAppVulnReference_0" name="vulnReference[]" placeholder="Enter reference URL (optional)" rows="2"></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="androidAppVulnAffectedSystem_0">Affected Systems*</label>
                                    <input type="text" id="androidAppVulnAffectedSystem_0" name="vulnAffectedSystem[]" placeholder="Enter affected systems" required>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="add-member-btn" id="androidAppAddVulnerabilityBtn" style="margin-top: 15px;">+ Add New Vulnerability</button>
                    </div>

                    <!-- File Upload -->
                    <div class="form-group">
                        <label>File Upload*</label>
                        
                        <div class="file-upload-group">
                            <label for="androidAppEvidenceFiles">Evidences Zip Files</label>
                            <input type="file" id="androidAppEvidenceFiles" name="evidenceFiles" accept=".zip" required>
                            <small class="file-help" style="color: brown;">Upload evidence ZIP file containing vulnerability proofs.</small>
                        </div>
                    </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeVaptModal('androidAppFirstAuditModal')">Cancel</button>
                        <button type="submit" class="submit-btn">Submit Report</button>
                    </div>
                    <br>
                    <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>  
                    </small>
                </form>
            </div>
        </div>
    </div>

    <!-- IOS Mobile Application VAPT First Audit Modal -->
    <div id="iosAppFirstAuditModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>IOS Mobile Application VAPT First Audit Details</h3>
                <span class="close-modal" onclick="closeVaptModal('iosAppFirstAuditModal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="iosAppFirstAuditForm" action="/process_ios_app_vapt_first_audit_report" method="POST" enctype="multipart/form-data">
                    <!-- Organization Section -->
                    <div class="form-group">
                        <label for="iosAppOrganization">Organization Name*</label>
                        <div class="combo-input">
                            <select id="iosAppOrganization" name="organization" required onchange="toggleVaptOtherInput('iosAppOrganization', 'iosAppOtherOrganization')">
                                <option value="">Select Organization</option>
                                <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                <option value="Megasoft Limited">Megasoft Limited</option>
                                <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                
    
                                <option value="other">Other (Please specify)</option>
                            </select>
                            <input type="text" id="iosAppOtherOrganization" name="otherOrganization" class="hidden" placeholder="Enter Organization Name">
                        </div>
                    </div>

                    <!-- Location Section -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="iosAppCity">City*</label>
                            <div class="combo-input">
                                <select id="iosAppCity" name="city" required onchange="toggleVaptOtherInput('iosAppCity', 'iosAppOtherCity')">
                                    <option value="">Select City</option>
                                    <option value="Ahmedabad">Ahmedabad</option>
                                    <option value="Amreli">Amreli</option>
                                    <option value="Anand">Anand</option>
                                    <option value="Aravalli">Aravalli</option>
                                    <option value="Banaskantha">Banaskantha</option>
                                    <option value="Bharuch">Bharuch</option>
                                    <option value="Bhavnagar">Bhavnagar</option>
                                    <option value="Botad">Botad</option>
                                    <option value="Chhota Udaipur">Chhota Udaipur</option>
                                    <option value="Dahod">Dahod</option>
                                    <option value="Dang">Dang</option>
                                    <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                    <option value="Gandhinagar">Gandhinagar</option>
                                    <option value="Gir Somnath">Gir Somnath</option>
                                    <option value="Jamnagar">Jamnagar</option>
                                    <option value="Junagadh">Junagadh</option>
                                    <option value="Kheda">Kheda</option>
                                    <option value="Kutch">Kutch</option>
                                    <option value="Mahisagar">Mahisagar</option>
                                    <option value="Mehsana">Mehsana</option>
                                    <option value="Morbi">Morbi</option>
                                    <option value="Narmada">Narmada</option>
                                    <option value="Navsari">Navsari</option>
                                    <option value="Patan">Patan</option>
                                    <option value="Panchmahal">Panchmahal</option>
                                    <option value="Porbandar">Porbandar</option>
                                    <option value="Rajkot">Rajkot</option>
                                    <option value="Sabarkantha">Sabarkantha</option>
                                    <option value="Surat">Surat</option>
                                    <option value="Surendranagar">Surendranagar</option>
                                    <option value="Tapi">Tapi</option>
                                    <option value="Vadodara">Vadodara</option>
                                    <option value="Valsad">Valsad</option>
        
                                    <!-- Rajasthan -->
                                    <option value="Ajmer">Ajmer</option>
                                    <option value="Alwar">Alwar</option>
                                    <option value="Banswara">Banswara</option>
                                    <option value="Baran">Baran</option>
                                    <option value="Barmer">Barmer</option>
                                    <option value="Bharatpur">Bharatpur</option>
                                    <option value="Bhilwara">Bhilwara</option>
                                    <option value="Bikaner">Bikaner</option>
                                    <option value="Bundi">Bundi</option>
                                    <option value="Chittorgarh">Chittorgarh</option>
                                    <option value="Churu">Churu</option>
                                    <option value="Dausa">Dausa</option>
                                    <option value="Dholpur">Dholpur</option>
                                    <option value="Dungarpur">Dungarpur</option>
                                    <option value="Hanumangarh">Hanumangarh</option>
                                    <option value="Jaipur">Jaipur</option>
                                    <option value="Jaisalmer">Jaisalmer</option>
                                    <option value="Jalore">Jalore</option>
                                    <option value="Jhalawar">Jhalawar</option>
                                    <option value="Jhunjhunu">Jhunjhunu</option>
                                    <option value="Jodhpur">Jodhpur</option>
                                    <option value="Karauli">Karauli</option>
                                    <option value="Kota">Kota</option>
                                    <option value="Nagaur">Nagaur</option>
                                    <option value="Pali">Pali</option>
                                    <option value="Pratapgarh">Pratapgarh</option>
                                    <option value="Rajsamand">Rajsamand</option>
                                    <option value="Sikar">Sikar</option>
                                    <option value="Sirohi">Sirohi</option>
                                    <option value="Sri Ganganagar">Sri Ganganagar</option>
                                    <option value="Tonk">Tonk</option>
                                    <option value="Udaipur">Udaipur</option>
        
                                    <!-- Maharashtra -->
                                    <option value="Ahmednagar">Ahmednagar</option>
                                    <option value="Akola">Akola</option>
                                    <option value="Amravati">Amravati</option>
                                    <option value="Aurangabad">Aurangabad</option>
                                    <option value="Beed">Beed</option>
                                    <option value="Bhandara">Bhandara</option>
                                    <option value="Chandrapur">Chandrapur</option>
                                    <option value="Dhule">Dhule</option>
                                    <option value="Gadchiroli">Gadchiroli</option>
                                    <option value="Gondia">Gondia</option>
                                    <option value="Hingoli">Hingoli</option>
                                    <option value="Jalgaon">Jalgaon</option>
                                    <option value="Jalna">Jalna</option>
                                    <option value="Kolhapur">Kolhapur</option>
                                    <option value="Latur">Latur</option>
                                    <option value="Mumbai City">Mumbai City</option>
                                    <option value="Mumbai Suburban">Mumbai Suburban</option>
                                    <option value="Nagpur">Nagpur</option>
                                    <option value="Nanded">Nanded</option>
                                    <option value="Nandurbar">Nandurbar</option>
                                    <option value="Nashik">Nashik</option>
                                    <option value="Osmanabad">Osmanabad</option>
                                    <option value="Palghar">Palghar</option>
                                    <option value="Parbhani">Parbhani</option>
                                    <option value="Pune">Pune</option>
                                    <option value="Raigad">Raigad</option>
                                    <option value="Ratnagiri">Ratnagiri</option>
                                    <option value="Sangli">Sangli</option>
                                    <option value="Satara">Satara</option>
                                    <option value="Sindhudurg">Sindhudurg</option>
                                    <option value="Solapur">Solapur</option>
                                    <option value="Thane">Thane</option>
                                    <option value="Wardha">Wardha</option>
                                    <option value="Washim">Washim</option>
                                    <option value="Yavatmal">Yavatmal</option>
        
                                    <!-- Uttar Pradesh -->
                                    <option value="Agra">Agra</option>
                                    <option value="Aligarh">Aligarh</option>
                                    <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                    <option value="Amethi">Amethi</option>
                                    <option value="Amroha">Amroha</option>
                                    <option value="Auraiya">Auraiya</option>
                                    <option value="Ayodhya">Ayodhya</option>
                                    <option value="Azamgarh">Azamgarh</option>
                                    <option value="Bagpat">Bagpat</option>
                                    <option value="Bahraich">Bahraich</option>
                                    <option value="Ballia">Ballia</option>
                                    <option value="Balrampur">Balrampur</option>
                                    <option value="Banda">Banda</option>
                                    <option value="Barabanki">Barabanki</option>
                                    <option value="Bareilly">Bareilly</option>
                                    <option value="Basti">Basti</option>
                                    <option value="Bhadohi">Bhadohi</option>
                                    <option value="Bijnor">Bijnor</option>
                                    <option value="Bulandshahr">Bulandshahr</option>
                                    <option value="Chandauli">Chandauli</option>
                                    <option value="Chitrakoot">Chitrakoot</option>
                                    <option value="Deoria">Deoria</option>
                                    <option value="Etah">Etah</option>
                                    <option value="Etawah">Etawah</option>
                                    <option value="Farrukhabad">Farrukhabad</option>
                                    <option value="Fatehpur">Fatehpur</option>
                                    <option value="Firozabad">Firozabad</option>
                                    <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                    <option value="Ghaziabad">Ghaziabad</option>
                                    <option value="Ghazipur">Ghazipur</option>
                                    <option value="Gonda">Gonda</option>
                                    <option value="Gorakhpur">Gorakhpur</option>
                                    <option value="Hamirpur">Hamirpur</option>
                                    <option value="Hapur">Hapur</option>
                                    <option value="Hardoi">Hardoi</option>
                                    <option value="Hathras">Hathras</option>
                                    <option value="Jalaun">Jalaun</option>
                                    <option value="Jaunpur">Jaunpur</option>
                                    <option value="Jhansi">Jhansi</option>
                                    <option value="Kannauj">Kannauj</option>
                                    <option value="Kanpur Dehat">Kanpur Dehat</option>
                                    <option value="Kanpur Nagar">Kanpur Nagar</option>
                                    <option value="Kasganj">Kasganj</option>
                                    <option value="Kaushambi">Kaushambi</option>
                                    <option value="Kushinagar">Kushinagar</option>
                                    <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                    <option value="Lalitpur">Lalitpur</option>
                                    <option value="Lucknow">Lucknow</option>
                                    <option value="Maharajganj">Maharajganj</option>
                                    <option value="Mahoba">Mahoba</option>
                                    <option value="Mainpuri">Mainpuri</option>
                                    <option value="Mathura">Mathura</option>
                                    <option value="Mau">Mau</option>
                                    <option value="Meerut">Meerut</option>
                                    <option value="Mirzapur">Mirzapur</option>
                                    <option value="Moradabad">Moradabad</option>
                                    <option value="Muzaffarnagar">Muzaffarnagar</option>
                                    <option value="Pilibhit">Pilibhit</option>
                                    <option value="Pratapgarh">Pratapgarh</option>
                                    <option value="Rae Bareli">Rae Bareli</option>
                                    <option value="Rampur">Rampur</option>
                                    <option value="Saharanpur">Saharanpur</option>
                                    <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                    <option value="Shahjahanpur">Shahjahanpur</option>
                                    <option value="Shravasti">Shravasti</option>
                                    <option value="Siddharthnagar">Siddharthnagar</option>
                                    <option value="Sitapur">Sitapur</option>
                                    <option value="Sonbhadra">Sonbhadra</option>
                                    <option value="Sultanpur">Sultanpur</option>
                                    <option value="Unnao">Unnao</option>
                                    <option value="Varanasi">Varanasi</option>
        
                                    <!-- Uttarakhand -->
                                    <option value="Almora">Almora</option>
                                    <option value="Bageshwar">Bageshwar</option>
                                    <option value="Chamoli">Chamoli</option>
                                    <option value="Champawat">Champawat</option>
                                    <option value="Dehradun">Dehradun</option>
                                    <option value="Haridwar">Haridwar</option>
                                    <option value="Nainital">Nainital</option>
                                    <option value="Pauri Garhwal">Pauri Garhwal</option>
                                    <option value="Pithoragarh">Pithoragarh</option>
                                    <option value="Rudraprayag">Rudraprayag</option>
                                    <option value="Tehri Garhwal">Tehri Garhwal</option>
                                    <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                    <option value="Uttarkashi">Uttarkashi</option>
                                            <option value="other">Other (Please specify)</option>
                                </select>
                                <input type="text" id="iosAppOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="iosAppState">State*</label>
                            <select id="iosAppState" name="state" required>
                                <option value="">Select State</option>
                                <option value="Andhra Pradesh">Andhra Pradesh</option>
                                <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                <option value="Assam">Assam</option>
                                <option value="Bihar">Bihar</option>
                                <option value="Chhattisgarh">Chhattisgarh</option>
                                <option value="Goa">Goa</option>
                                <option value="Gujarat">Gujarat</option>
                                <option value="Haryana">Haryana</option>
                                <option value="Himachal Pradesh">Himachal Pradesh</option>
                                <option value="Jharkhand">Jharkhand</option>
                                <option value="Karnataka">Karnataka</option>
                                <option value="Kerala">Kerala</option>
                                <option value="Madhya Pradesh">Madhya Pradesh</option>
                                <option value="Maharashtra">Maharashtra</option>
                                <option value="Manipur">Manipur</option>
                                <option value="Meghalaya">Meghalaya</option>
                                <option value="Mizoram">Mizoram</option>
                                <option value="Nagaland">Nagaland</option>
                                <option value="Odisha">Odisha</option>
                                <option value="Punjab">Punjab</option>
                                <option value="Rajasthan">Rajasthan</option>
                                <option value="Sikkim">Sikkim</option>
                                <option value="Tamil Nadu">Tamil Nadu</option>
                                <option value="Telangana">Telangana</option>
                                <option value="Tripura">Tripura</option>
                                <option value="Uttar Pradesh">Uttar Pradesh</option>
                                <option value="Uttarakhand">Uttarakhand</option>
                                <option value="West Bengal">West Bengal</option>
                                <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                <option value="Chandigarh">Chandigarh</option>
                                <option value="Dadra and Nagar Haveli and Daman and Diu">Dadra and Nagar Haveli and Daman and Diu</option>
                                <option value="Delhi">Delhi</option>
                                <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                                <option value="Ladakh">Ladakh</option>
                                <option value="Lakshadweep">Lakshadweep</option>
                                <option value="Puducherry">Puducherry</option>
                                
                            </select>
                        </div>
                    </div>

                    <!-- Audit Dates -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="iosAppStartDate">Start Audit Date*</label>
                            <input type="date" id="iosAppStartDate" name="startDate" required>
                        </div>
                        <div class="form-group">
                            <label for="iosAppEndDate">Finish Audit Date*</label>
                            <input type="date" id="iosAppEndDate" name="endDate" required>
                        </div>
                    </div>

                    <!-- Report Prepared By -->
                    <div class="form-group">
                        <label>Report Prepared By*</label>
                        <div class="name-input">
                            <select class="title-select" name="preparedByTitle" required>
                                <option value="Mr.">Mr.</option>
                                <option value="Ms.">Ms.</option>
                                <option value="Mrs.">Mrs.</option>
                                <option value="Dr.">Dr.</option>
                            </select>
                            <input type="text" placeholder="Full Name" name="preparedByName" required>
                        </div>
                    </div>

                    <!-- Asset Details -->
                    <div class="form-group">
                        <label>Asset Details* (At least 1 required, max 8)</label>
                        <div id="iosAppAssetContainer">
                            <div class="asset-entry ios-asset-entry" data-asset-index="0">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="iosAppAssetDescription_0">Asset Description*</label>
                                        <input type="text" id="iosAppAssetDescription_0" name="assetDescription[]" placeholder="Enter asset description" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="iosAppAssetCriticality_0">Criticality of Asset*</label>
                                        <input type="text" id="iosAppAssetCriticality_0" name="assetCriticality[]" placeholder="Enter criticality" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="iosAppAssetHash_0">Hash Value*</label>
                                        <input type="text" id="iosAppAssetHash_0" name="assetHash[]" placeholder="Enter hash value" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="iosAppAssetVersion_0">Version*</label>
                                        <input type="text" id="iosAppAssetVersion_0" name="assetVersion[]" placeholder="Enter version" required>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="add-member-btn" id="iosAppAddAssetBtn">+ Add Asset</button>
                    </div>
                    <!-- Auditee Details -->
                    <div class="form-group">
                        <label>Name of Auditee Organization Person*</label>
                        <div class="name-input">
                            <select class="title-select" name="auditeeTitle" required>
                                <option value="Mr.">Mr.</option>
                                <option value="Ms.">Ms.</option>
                                <option value="Mrs.">Mrs.</option>
                                <option value="Dr.">Dr.</option>
                            </select>
                            <input type="text" placeholder="Full Name" name="auditeeName" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="iosAppDesignation">Designation of the Person*</label>
                        <input type="text" id="iosAppDesignation" name="designation" required>
                    </div>

                    <div class="form-group">
                        <label for="iosAppBankEmail">Email ID of the Organization*</label>
                        <div id="iosAppEmailContainer">
                            <input type="email" name="bankEmail[]" placeholder="Email Address" required>
                        </div>
                        <button type="button" class="add-member-btn" id="iosAppAddEmailBtn" style="margin-top: 10px;">+ Add Another Email</button>
                    </div>

                    <!-- Auditing Team -->
                    <div class="form-group">
                        <label>Details of Auditing Team* (At least 1 required, max 8)</label>
                        <div id="iosAppAuditTeamContainer">
                            <div class="team-member" data-index="0">
                                <div class="form-row">
                                    <div class="form-group">
                                        <input type="text" name="teamName[]" placeholder="Name*" required>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" name="teamQualification[]" placeholder="Qualification/Certification*" required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Certified (Yes/No)*</label>
                                    <div class="radio-group">
                                        <label><input type="radio" name="teamCertified[0]" value="yes" required> Yes</label>
                                        <label><input type="radio" name="teamCertified[0]" value="no"> No</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="add-member-btn" id="iosAppAddMemberBtn">+ Add Team Member</button>
                    </div>

                    <!-- Vulnerability Status Radio Buttons -->
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid #ddd;">
                    <div class="form-group">
                        <label class="form-label" style="margin-bottom: 10px;">Vulnerability Status*</label>
                        <div style="display: flex; gap: 30px; margin-top: 10px;">
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="radio" name="iosAppVulnerabilityStatus" value="0" required onchange="toggleIosAppFirstAuditVulnerabilitySection()" style="width: auto;">
                                <span>0 Vulnerabilities</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="radio" name="iosAppVulnerabilityStatus" value="has" required onchange="toggleIosAppFirstAuditVulnerabilitySection()" style="width: auto;">
                                <span>Has Vulnerability</span>
                            </label>
                        </div>
                    </div>

                    <!-- Vulnerability Details Section -->
                    <div id="iosAppFirstAuditVulnerabilitySection" style="display: none;">
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid #ddd;">
                    <div class="form-group">
                        <h3 style="margin-bottom: 15px;">Vulnerability Details</h3>
                        
                        <div id="iosAppVulnerabilityContainer">
                            <div class="vulnerability-entry" data-vuln-index="0">
                                <h4 style="color: #2c3e50; margin-bottom: 10px;">Vulnerability 1</h4>
                                
                                <div class="form-group">
                                    <label for="iosAppVulnVulnerabilities_0">Vulnerabilities*</label>
                                    <textarea id="iosAppVulnVulnerabilities_0" name="vulnVulnerabilities[]" placeholder="Enter vulnerabilities" rows="3" required></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="iosAppVulnName_0">Name of Vulnerability*</label>
                                    <input type="text" id="iosAppVulnName_0" name="vulnName[]" placeholder="Enter vulnerability name" required>
                                </div>

                                <div class="form-group">
                                    <label for="iosAppVulnRiskFactor_0">Risk Factor*</label>
                                    <select id="iosAppVulnRiskFactor_0" name="vulnRiskFactor[]" required>
                                        <option value="">Select Risk Factor</option>
                                        <option value="Critical">Critical</option>
                                        <option value="High">High</option>
                                        <option value="Medium">Medium</option>
                                        <option value="Low">Low</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="iosAppVulnCVE_0">CVE ID</label>
                                    <input type="text" id="iosAppVulnCVE_0" name="vulnCVE[]" placeholder="Enter CVE ID (optional)">
                                </div>

                                <div class="form-group">
                                    <label for="iosAppVulnCVSS_0">CVSS</label>
                                    <input type="text" id="iosAppVulnCVSS_0" name="vulnCVSS[]" placeholder="Enter CVSS score (optional)">
                                </div>

                                <div class="form-group">
                                    <label for="iosAppVulnObservation_0">Audit Observation*</label>
                                    <textarea id="iosAppVulnObservation_0" name="vulnObservation[]" rows="3" placeholder="Enter audit observation" required></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="iosAppVulnImpact_0">Impact*</label>
                                    <textarea id="iosAppVulnImpact_0" name="vulnImpact[]" rows="3" placeholder="Enter impact description" required></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="iosAppVulnRecommendation_0">Recommendation / Countermeasure*</label>
                                    <textarea id="iosAppVulnRecommendation_0" name="vulnRecommendation[]" rows="3" placeholder="Enter recommendation" required></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="iosAppVulnReference_0">Reference Link</label>
                                    <textarea id="iosAppVulnReference_0" name="vulnReference[]" placeholder="Enter reference URL (optional)" rows="2"></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="iosAppVulnAffectedSystem_0">Affected Systems*</label>
                                    <input type="text" id="iosAppVulnAffectedSystem_0" name="vulnAffectedSystem[]" placeholder="Enter affected systems" required>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="add-member-btn" id="iosAppAddVulnerabilityBtn" style="margin-top: 15px;">+ Add New Vulnerability</button>
                    </div>

                    <!-- File Upload -->
                    <div class="form-group">
                        <label>File Upload*</label>
                        
                        <div class="file-upload-group">
                            <label for="iosAppEvidenceFiles">Evidences Zip Files</label>
                            <input type="file" id="iosAppEvidenceFiles" name="evidenceFiles" accept=".zip" required>
                            <small class="file-help" style="color: brown;">Upload evidence ZIP file containing vulnerability proofs.</small>
                        </div>
                    </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeVaptModal('iosAppFirstAuditModal')">Cancel</button>
                        <button type="submit" class="submit-btn">Submit Report</button>
                    </div>
                    <br>
                    <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>  
                    </small>
                </form>
            </div>
        </div>
    </div>

    <!-- API VAPT First Audit Modal -->
    <div id="apiFirstAuditModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>API VAPT First Audit Details</h3>
                <span class="close-modal" onclick="closeVaptModal('apiFirstAuditModal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="apiFirstAuditForm" action="/process_api_vapt_first_audit_report" method="POST" enctype="multipart/form-data">
                    <!-- Organization Section -->
                    <div class="form-group">
                        <label for="apiOrganization">Organization Name*</label>
                        <div class="combo-input">
                            <select id="apiOrganization" name="organization" required onchange="toggleVaptOtherInput('apiOrganization', 'apiOtherOrganization')">
                                <option value="">Select Organization</option>
                                <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                <option value="Megasoft Limited">Megasoft Limited</option>
                                <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                
    
                                <option value="other">Other (Please specify)</option>
                            </select>
                            <input type="text" id="apiOtherOrganization" name="otherOrganization" class="hidden" placeholder="Enter Organization Name">
                        </div>
                    </div>

                    <!-- Location Section -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="apiCity">City*</label>
                            <div class="combo-input">
                                <select id="apiCity" name="city" required onchange="toggleVaptOtherInput('apiCity', 'apiOtherCity')">
                                    <option value="">Select City</option>
                                    <option value="Ahmedabad">Ahmedabad</option>
                                    <option value="Amreli">Amreli</option>
                                    <option value="Anand">Anand</option>
                                    <option value="Aravalli">Aravalli</option>
                                    <option value="Banaskantha">Banaskantha</option>
                                    <option value="Bharuch">Bharuch</option>
                                    <option value="Bhavnagar">Bhavnagar</option>
                                    <option value="Botad">Botad</option>
                                    <option value="Chhota Udaipur">Chhota Udaipur</option>
                                    <option value="Dahod">Dahod</option>
                                    <option value="Dang">Dang</option>
                                    <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                    <option value="Gandhinagar">Gandhinagar</option>
                                    <option value="Gir Somnath">Gir Somnath</option>
                                    <option value="Jamnagar">Jamnagar</option>
                                    <option value="Junagadh">Junagadh</option>
                                    <option value="Kheda">Kheda</option>
                                    <option value="Kutch">Kutch</option>
                                    <option value="Mahisagar">Mahisagar</option>
                                    <option value="Mehsana">Mehsana</option>
                                    <option value="Morbi">Morbi</option>
                                    <option value="Narmada">Narmada</option>
                                    <option value="Navsari">Navsari</option>
                                    <option value="Patan">Patan</option>
                                    <option value="Panchmahal">Panchmahal</option>
                                    <option value="Porbandar">Porbandar</option>
                                    <option value="Rajkot">Rajkot</option>
                                    <option value="Sabarkantha">Sabarkantha</option>
                                    <option value="Surat">Surat</option>
                                    <option value="Surendranagar">Surendranagar</option>
                                    <option value="Tapi">Tapi</option>
                                    <option value="Vadodara">Vadodara</option>
                                    <option value="Valsad">Valsad</option>
        
                                    <!-- Rajasthan -->
                                    <option value="Ajmer">Ajmer</option>
                                    <option value="Alwar">Alwar</option>
                                    <option value="Banswara">Banswara</option>
                                    <option value="Baran">Baran</option>
                                    <option value="Barmer">Barmer</option>
                                    <option value="Bharatpur">Bharatpur</option>
                                    <option value="Bhilwara">Bhilwara</option>
                                    <option value="Bikaner">Bikaner</option>
                                    <option value="Bundi">Bundi</option>
                                    <option value="Chittorgarh">Chittorgarh</option>
                                    <option value="Churu">Churu</option>
                                    <option value="Dausa">Dausa</option>
                                    <option value="Dholpur">Dholpur</option>
                                    <option value="Dungarpur">Dungarpur</option>
                                    <option value="Hanumangarh">Hanumangarh</option>
                                    <option value="Jaipur">Jaipur</option>
                                    <option value="Jaisalmer">Jaisalmer</option>
                                    <option value="Jalore">Jalore</option>
                                    <option value="Jhalawar">Jhalawar</option>
                                    <option value="Jhunjhunu">Jhunjhunu</option>
                                    <option value="Jodhpur">Jodhpur</option>
                                    <option value="Karauli">Karauli</option>
                                    <option value="Kota">Kota</option>
                                    <option value="Nagaur">Nagaur</option>
                                    <option value="Pali">Pali</option>
                                    <option value="Pratapgarh">Pratapgarh</option>
                                    <option value="Rajsamand">Rajsamand</option>
                                    <option value="Sikar">Sikar</option>
                                    <option value="Sirohi">Sirohi</option>
                                    <option value="Sri Ganganagar">Sri Ganganagar</option>
                                    <option value="Tonk">Tonk</option>
                                    <option value="Udaipur">Udaipur</option>
        
                                    <!-- Maharashtra -->
                                    <option value="Ahmednagar">Ahmednagar</option>
                                    <option value="Akola">Akola</option>
                                    <option value="Amravati">Amravati</option>
                                    <option value="Aurangabad">Aurangabad</option>
                                    <option value="Beed">Beed</option>
                                    <option value="Bhandara">Bhandara</option>
                                    <option value="Chandrapur">Chandrapur</option>
                                    <option value="Dhule">Dhule</option>
                                    <option value="Gadchiroli">Gadchiroli</option>
                                    <option value="Gondia">Gondia</option>
                                    <option value="Hingoli">Hingoli</option>
                                    <option value="Jalgaon">Jalgaon</option>
                                    <option value="Jalna">Jalna</option>
                                    <option value="Kolhapur">Kolhapur</option>
                                    <option value="Latur">Latur</option>
                                    <option value="Mumbai City">Mumbai City</option>
                                    <option value="Mumbai Suburban">Mumbai Suburban</option>
                                    <option value="Nagpur">Nagpur</option>
                                    <option value="Nanded">Nanded</option>
                                    <option value="Nandurbar">Nandurbar</option>
                                    <option value="Nashik">Nashik</option>
                                    <option value="Osmanabad">Osmanabad</option>
                                    <option value="Palghar">Palghar</option>
                                    <option value="Parbhani">Parbhani</option>
                                    <option value="Pune">Pune</option>
                                    <option value="Raigad">Raigad</option>
                                    <option value="Ratnagiri">Ratnagiri</option>
                                    <option value="Sangli">Sangli</option>
                                    <option value="Satara">Satara</option>
                                    <option value="Sindhudurg">Sindhudurg</option>
                                    <option value="Solapur">Solapur</option>
                                    <option value="Thane">Thane</option>
                                    <option value="Wardha">Wardha</option>
                                    <option value="Washim">Washim</option>
                                    <option value="Yavatmal">Yavatmal</option>
        
                                    <!-- Uttar Pradesh -->
                                    <option value="Agra">Agra</option>
                                    <option value="Aligarh">Aligarh</option>
                                    <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                    <option value="Amethi">Amethi</option>
                                    <option value="Amroha">Amroha</option>
                                    <option value="Auraiya">Auraiya</option>
                                    <option value="Ayodhya">Ayodhya</option>
                                    <option value="Azamgarh">Azamgarh</option>
                                    <option value="Bagpat">Bagpat</option>
                                    <option value="Bahraich">Bahraich</option>
                                    <option value="Ballia">Ballia</option>
                                    <option value="Balrampur">Balrampur</option>
                                    <option value="Banda">Banda</option>
                                    <option value="Barabanki">Barabanki</option>
                                    <option value="Bareilly">Bareilly</option>
                                    <option value="Basti">Basti</option>
                                    <option value="Bhadohi">Bhadohi</option>
                                    <option value="Bijnor">Bijnor</option>
                                    <option value="Bulandshahr">Bulandshahr</option>
                                    <option value="Chandauli">Chandauli</option>
                                    <option value="Chitrakoot">Chitrakoot</option>
                                    <option value="Deoria">Deoria</option>
                                    <option value="Etah">Etah</option>
                                    <option value="Etawah">Etawah</option>
                                    <option value="Farrukhabad">Farrukhabad</option>
                                    <option value="Fatehpur">Fatehpur</option>
                                    <option value="Firozabad">Firozabad</option>
                                    <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                    <option value="Ghaziabad">Ghaziabad</option>
                                    <option value="Ghazipur">Ghazipur</option>
                                    <option value="Gonda">Gonda</option>
                                    <option value="Gorakhpur">Gorakhpur</option>
                                    <option value="Hamirpur">Hamirpur</option>
                                    <option value="Hapur">Hapur</option>
                                    <option value="Hardoi">Hardoi</option>
                                    <option value="Hathras">Hathras</option>
                                    <option value="Jalaun">Jalaun</option>
                                    <option value="Jaunpur">Jaunpur</option>
                                    <option value="Jhansi">Jhansi</option>
                                    <option value="Kannauj">Kannauj</option>
                                    <option value="Kanpur Dehat">Kanpur Dehat</option>
                                    <option value="Kanpur Nagar">Kanpur Nagar</option>
                                    <option value="Kasganj">Kasganj</option>
                                    <option value="Kaushambi">Kaushambi</option>
                                    <option value="Kushinagar">Kushinagar</option>
                                    <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                    <option value="Lalitpur">Lalitpur</option>
                                    <option value="Lucknow">Lucknow</option>
                                    <option value="Maharajganj">Maharajganj</option>
                                    <option value="Mahoba">Mahoba</option>
                                    <option value="Mainpuri">Mainpuri</option>
                                    <option value="Mathura">Mathura</option>
                                    <option value="Mau">Mau</option>
                                    <option value="Meerut">Meerut</option>
                                    <option value="Mirzapur">Mirzapur</option>
                                    <option value="Moradabad">Moradabad</option>
                                    <option value="Muzaffarnagar">Muzaffarnagar</option>
                                    <option value="Pilibhit">Pilibhit</option>
                                    <option value="Pratapgarh">Pratapgarh</option>
                                    <option value="Rae Bareli">Rae Bareli</option>
                                    <option value="Rampur">Rampur</option>
                                    <option value="Saharanpur">Saharanpur</option>
                                    <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                    <option value="Shahjahanpur">Shahjahanpur</option>
                                    <option value="Shravasti">Shravasti</option>
                                    <option value="Siddharthnagar">Siddharthnagar</option>
                                    <option value="Sitapur">Sitapur</option>
                                    <option value="Sonbhadra">Sonbhadra</option>
                                    <option value="Sultanpur">Sultanpur</option>
                                    <option value="Unnao">Unnao</option>
                                    <option value="Varanasi">Varanasi</option>
        
                                    <!-- Uttarakhand -->
                                    <option value="Almora">Almora</option>
                                    <option value="Bageshwar">Bageshwar</option>
                                    <option value="Chamoli">Chamoli</option>
                                    <option value="Champawat">Champawat</option>
                                    <option value="Dehradun">Dehradun</option>
                                    <option value="Haridwar">Haridwar</option>
                                    <option value="Nainital">Nainital</option>
                                    <option value="Pauri Garhwal">Pauri Garhwal</option>
                                    <option value="Pithoragarh">Pithoragarh</option>
                                    <option value="Rudraprayag">Rudraprayag</option>
                                    <option value="Tehri Garhwal">Tehri Garhwal</option>
                                    <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                    <option value="Uttarkashi">Uttarkashi</option>
                                            <option value="other">Other (Please specify)</option>
                                </select>
                                <input type="text" id="apiOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="apiState">State*</label>
                            <select id="apiState" name="state" required>
                                <option value="">Select State</option>
                                <option value="Andhra Pradesh">Andhra Pradesh</option>
                                <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                <option value="Assam">Assam</option>
                                <option value="Bihar">Bihar</option>
                                <option value="Chhattisgarh">Chhattisgarh</option>
                                <option value="Goa">Goa</option>
                                <option value="Gujarat">Gujarat</option>
                                <option value="Haryana">Haryana</option>
                                <option value="Himachal Pradesh">Himachal Pradesh</option>
                                <option value="Jharkhand">Jharkhand</option>
                                <option value="Karnataka">Karnataka</option>
                                <option value="Kerala">Kerala</option>
                                <option value="Madhya Pradesh">Madhya Pradesh</option>
                                <option value="Maharashtra">Maharashtra</option>
                                <option value="Manipur">Manipur</option>
                                <option value="Meghalaya">Meghalaya</option>
                                <option value="Mizoram">Mizoram</option>
                                <option value="Nagaland">Nagaland</option>
                                <option value="Odisha">Odisha</option>
                                <option value="Punjab">Punjab</option>
                                <option value="Rajasthan">Rajasthan</option>
                                <option value="Sikkim">Sikkim</option>
                                <option value="Tamil Nadu">Tamil Nadu</option>
                                <option value="Telangana">Telangana</option>
                                <option value="Tripura">Tripura</option>
                                <option value="Uttar Pradesh">Uttar Pradesh</option>
                                <option value="Uttarakhand">Uttarakhand</option>
                                <option value="West Bengal">West Bengal</option>
                                <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                <option value="Chandigarh">Chandigarh</option>
                                <option value="Dadra and Nagar Haveli and Daman and Diu">Dadra and Nagar Haveli and Daman and Diu</option>
                                <option value="Delhi">Delhi</option>
                                <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                                <option value="Ladakh">Ladakh</option>
                                <option value="Lakshadweep">Lakshadweep</option>
                                <option value="Puducherry">Puducherry</option>
                                
                            </select>
                        </div>
                    </div>

                    <!-- Audit Dates -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="apiStartDate">Start Audit Date*</label>
                            <input type="date" id="apiStartDate" name="startDate" required>
                        </div>
                        <div class="form-group">
                            <label for="apiEndDate">Finish Audit Date*</label>
                            <input type="date" id="apiEndDate" name="endDate" required>
                        </div>
                    </div>

                    <!-- Report Prepared By -->
                    <div class="form-group">
                        <label>Report Prepared By*</label>
                        <div class="name-input">
                            <select class="title-select" name="preparedByTitle" required>
                                <option value="Mr.">Mr.</option>
                                <option value="Ms.">Ms.</option>
                                <option value="Mrs.">Mrs.</option>
                                <option value="Dr.">Dr.</option>
                            </select>
                            <input type="text" placeholder="Full Name" name="preparedByName" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Application Type*</label>
                        <div class="radio-group">
                            <label><input type="radio" name="applicationType" value="Internal" checked> Internal</label>
                            <label><input type="radio" name="applicationType" value="External"> External</label>
                        </div>
                    </div>
                    <!-- Asset Details -->
                    <div class="form-group">
                        <label>Asset Details* (At least 1 required, max 8)</label>
                        <div id="apiAssetContainer">
                            <div class="asset-entry api-asset-entry" data-asset-index="0">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="apiAssetDescription_0">Asset Description*</label>
                                        <input type="text" id="apiAssetDescription_0" name="assetDescription[]" placeholder="Enter asset description" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="apiAssetCriticality_0">Criticality of Asset*</label>
                                        <input type="text" id="apiAssetCriticality_0" name="assetCriticality[]" placeholder="Enter criticality" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="apiAssetUrl_0">URL*</label>
                                        <input type="text" id="apiAssetUrl_0" name="assetUrl[]" placeholder="Enter URL" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="apiAssetHash_0">Hash Value*</label>
                                        <input type="text" id="apiAssetHash_0" name="assetHash[]" placeholder="Enter hash value" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="apiAssetVersion_0">Version*</label>
                                        <input type="text" id="apiAssetVersion_0" name="assetVersion[]" placeholder="Enter version" required>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="add-member-btn" id="apiAddAssetBtn">+ Add Asset</button>
                    </div>
                    <!-- Auditee Details -->
                    <div class="form-group">
                        <label>Name of Auditee Organization Person*</label>
                        <div class="name-input">
                            <select class="title-select" name="auditeeTitle" required>
                                <option value="Mr.">Mr.</option>
                                <option value="Ms.">Ms.</option>
                                <option value="Mrs.">Mrs.</option>
                                <option value="Dr.">Dr.</option>
                            </select>
                            <input type="text" placeholder="Full Name" name="auditeeName" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="apiDesignation">Designation of the Person*</label>
                        <input type="text" id="apiDesignation" name="designation" required>
                    </div>

                    <div class="form-group">
                        <label for="apiBankEmail">Email ID of the Organization*</label>
                        <div id="apiEmailContainer">
                            <input type="email" name="bankEmail[]" placeholder="Email Address" required>
                        </div>
                        <button type="button" class="add-member-btn" id="apiAddEmailBtn" style="margin-top: 10px;">+ Add Another Email</button>
                    </div>

                    <!-- Auditing Team -->
                    <div class="form-group">
                        <label>Details of Auditing Team* (At least 1 required, max 8)</label>
                        <div id="apiAuditTeamContainer">
                            <div class="team-member" data-index="0">
                                <div class="form-row">
                                    <div class="form-group">
                                        <input type="text" name="teamName[]" placeholder="Name*" required>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" name="teamQualification[]" placeholder="Qualification/Certification*" required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Certified (Yes/No)*</label>
                                    <div class="radio-group">
                                        <label><input type="radio" name="teamCertified[0]" value="yes" required> Yes</label>
                                        <label><input type="radio" name="teamCertified[0]" value="no"> No</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="add-member-btn" id="apiAddMemberBtn">+ Add Team Member</button>
                    </div>

                    <!-- Vulnerability Status Radio Buttons -->
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid #ddd;">
                    <div class="form-group">
                        <label class="form-label" style="margin-bottom: 10px;">Vulnerability Status*</label>
                        <div style="display: flex; gap: 30px; margin-top: 10px;">
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="radio" name="apiVulnerabilityStatus" value="0" required onchange="toggleApiFirstAuditVulnerabilitySection()" style="width: auto;">
                                <span>0 Vulnerabilities</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="radio" name="apiVulnerabilityStatus" value="has" required onchange="toggleApiFirstAuditVulnerabilitySection()" style="width: auto;">
                                <span>Has Vulnerability</span>
                            </label>
                        </div>
                    </div>

                    <!-- Vulnerability Details Section -->
                    <div id="apiFirstAuditVulnerabilitySection" style="display: none;">
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid #ddd;">
                    <div class="form-group">
                        <h3 style="margin-bottom: 15px;">Vulnerability Details</h3>
                        
                        <div id="apiFirstAuditVulnerabilityContainer">
                            <div class="vulnerability-entry" data-vuln-index="0">
                                <h4 style="color: #2c3e50; margin-bottom: 10px;">Vulnerability 1</h4>
                                
                                <div class="form-group">
                                    <label for="apiVulnVulnerabilities_0">Vulnerabilities*</label>
                                    <textarea id="apiVulnVulnerabilities_0" name="vulnVulnerabilities[]" placeholder="Enter vulnerabilities" rows="3" required></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="apiVulnName_0">Name of Vulnerability*</label>
                                    <input type="text" id="apiVulnName_0" name="vulnName[]" placeholder="Enter vulnerability name" required>
                                </div>

                                <div class="form-group">
                                    <label for="apiVulnRiskFactor_0">Risk Factor*</label>
                                    <select id="apiVulnRiskFactor_0" name="vulnRiskFactor[]" required>
                                        <option value="">Select Risk Factor</option>
                                        <option value="Critical">Critical</option>
                                        <option value="High">High</option>
                                        <option value="Medium">Medium</option>
                                        <option value="Low">Low</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="apiVulnCVE_0">CVE ID</label>
                                    <input type="text" id="apiVulnCVE_0" name="vulnCVE[]" placeholder="Enter CVE ID (optional)">
                                </div>

                                <div class="form-group">
                                    <label for="apiVulnCVSS_0">CVSS</label>
                                    <input type="text" id="apiVulnCVSS_0" name="vulnCVSS[]" placeholder="Enter CVSS score (optional)">
                                </div>

                                <div class="form-group">
                                    <label for="apiVulnObservation_0">Audit Observation*</label>
                                    <textarea id="apiVulnObservation_0" name="vulnObservation[]" rows="3" placeholder="Enter audit observation" required></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="apiVulnImpact_0">Impact*</label>
                                    <textarea id="apiVulnImpact_0" name="vulnImpact[]" rows="3" placeholder="Enter impact description" required></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="apiVulnRecommendation_0">Recommendation / Countermeasure*</label>
                                    <textarea id="apiVulnRecommendation_0" name="vulnRecommendation[]" rows="3" placeholder="Enter recommendation" required></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="apiVulnReference_0">Reference Link</label>
                                    <textarea id="apiVulnReference_0" name="vulnReference[]" placeholder="Enter reference URL (optional)" rows="2"></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="apiVulnAffectedSystem_0">Affected Systems*</label>
                                    <input type="text" id="apiVulnAffectedSystem_0" name="vulnAffectedSystem[]" placeholder="Enter affected systems" required>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="add-member-btn" id="apiAddVulnerabilityBtn" style="margin-top: 15px;">+ Add New Vulnerability</button>
                    </div>

                    <!-- File Upload -->
                    <div class="form-group">
                        <label>File Upload*</label>
                        
                        <div class="file-upload-group">
                            <label for="apiEvidenceFiles">Evidences Zip Files</label>
                            <input type="file" id="apiEvidenceFiles" name="evidenceFiles" accept=".zip" required>
                            <small class="file-help" style="color: brown;">Upload evidence ZIP file containing vulnerability proofs.</small>
                        </div>
                    </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeVaptModal('apiFirstAuditModal')">Cancel</button>
                        <button type="submit" class="submit-btn">Submit Report</button>
                    </div>
                    <br>
                    <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>  
                    </small>
                </form>
            </div>
        </div>
    </div>

    <!-- Web Application VAPT Follow-up Audit Modal -->
    <div id="webAppFollowUpAuditModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Web Application VAPT Follow-up Audit Details</h3>
                <span class="close-modal" onclick="closeVaptModal('webAppFollowUpAuditModal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="webAppFollowUpAuditForm" action="/process_web_app_vapt_follow_up_audit_report" method="POST" enctype="multipart/form-data">
                    <!-- Audit Dates -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="webAppFollowUpStartDate">Start Audit Date*</label>
                            <input type="date" id="webAppFollowUpStartDate" name="startDate" required>
                        </div>
                        <div class="form-group">
                            <label for="webAppFollowUpEndDate">Finish Audit Date*</label>
                            <input type="date" id="webAppFollowUpEndDate" name="endDate" required>
                        </div>
                    </div>

                    <!-- File Uploads -->
                    <div class="form-group">
                        <label>File Uploads</label>
                        
                        <div class="file-upload-group">
                            <label for="webAppFollowUpUserExcelFile">User Excel File (.xlsx)*</label>
                            <input type="file" id="webAppFollowUpUserExcelFile" name="userExcelFile" accept=".xlsx" required>
                            <small class="file-help" style="color: brown;">Upload the Excel file containing vulnerabilities (required).</small>
                        </div>
                        
                        <div class="file-upload-group">
                            <label for="webAppFollowUpNewPOCFile">New POC Zip Files (Optional)</label>
                            <input type="file" id="webAppFollowUpNewPOCFile" name="newPOCFiles" accept=".zip">
                            <small class="file-help" style="color: brown;">Upload new POC evidence ZIP file for follow-up audit (optional).</small>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeVaptModal('webAppFollowUpAuditModal')">Cancel</button>
                        <button type="submit" class="submit-btn">Submit Report</button>
                    </div>
                    <br>
                    <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>  
                    </small>
                </form>
            </div>
        </div>
    </div>

    <!-- Work Plan Submission Modal -->
    <div id="workPlanModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>Submit Today's Work Plan</h3>
                <span class="close-modal" onclick="closeWorkPlanModal()">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="workPlanForm" onsubmit="handleWorkPlanSubmit(event)">
                    <!-- Hidden field for status check -->
                    <input type="hidden" id="workPlanEmployeeNameForCheck" value="{{ user.employee_name if user else '' }}">
                    
                    <!-- Read-only fields -->
                    <div class="form-group">
                        <label for="workPlanDate">Date</label>
                        <input type="date" id="workPlanDate" name="date" readonly style="background-color: #f5f5f5;">
                    </div>

                    <div class="form-group">
                        <label for="workPlanEmployeeName">Employee Name</label>
                        <input type="text" id="workPlanEmployeeName" name="employeeName" readonly style="background-color: #f5f5f5;" value="{{ user.employee_name if user else '' }}">
                    </div>

                    <div class="form-group">
                        <label for="workPlanEmployeeTeam">Employee Team</label>
                        <input type="text" id="workPlanEmployeeTeam" name="employeeTeam" readonly style="background-color: #f5f5f5;" value="{{ user.department if user else '' }}">
                    </div>

                    <!-- Task Section -->
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid #ddd;">
                    <div class="form-group">
                        <h3 style="margin-bottom: 15px;">Task Details</h3>
                        
                        <div id="workPlanTaskContainer">
                            <div class="task-entry" data-task-index="0">
                                <div class="form-group">
                                    <label for="workPlanTask_0">Task*</label>
                                    <input type="text" id="workPlanTask_0" name="task[]" placeholder="Enter task name" required>
                                </div>

                                <div class="form-group">
                                    <label for="workPlanTaskDescription_0">Task Description*</label>
                                    <textarea id="workPlanTaskDescription_0" name="taskDescription[]" rows="2" placeholder="Enter task description" required></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="workPlanClientName_0">Client Name*</label>
                                    <input type="text" id="workPlanClientName_0" name="clientName[]" placeholder="Enter client name" required>
                                </div>

                                <div class="form-group">
                                    <label for="workPlanTime_0">Time Taken (in Hours)*</label>
                                    <input type="number" id="workPlanTime_0" name="time[]" step="0.01" min="0" placeholder="e.g., 1.25, 2.5" required>
                                </div>
                            </div>
                        </div>
                        
                        <button type="button" class="add-member-btn" id="addWorkPlanTaskBtn" style="margin-top: 15px;">+ Add New Task</button>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeWorkPlanModal()">Cancel</button>
                        <button type="submit" class="submit-btn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Update Work Modal -->
    <div id="updateWorkModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>Update Today's Work</h3>
                <span class="close-modal" onclick="closeUpdateWorkModal()">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="updateWorkForm" onsubmit="handleUpdateWorkSubmit(event)">
                    <!-- Hidden field for status check -->
                    <input type="hidden" id="updateWorkEmployeeNameForCheck" value="{{ user.employee_name if user else '' }}">
                    
                    <!-- Read-only fields -->
                    <div class="form-group">
                        <label for="updateWorkDate">Date</label>
                        <input type="date" id="updateWorkDate" name="date" readonly style="background-color: #f5f5f5;">
                    </div>

                    <div class="form-group">
                        <label for="updateWorkEmployeeName">Employee Name</label>
                        <input type="text" id="updateWorkEmployeeName" name="employeeName" readonly style="background-color: #f5f5f5;" value="{{ user.employee_name if user else '' }}">
                    </div>

                    <div class="form-group">
                        <label for="updateWorkEmployeeTeam">Employee Team</label>
                        <input type="text" id="updateWorkEmployeeTeam" name="employeeTeam" readonly style="background-color: #f5f5f5;" value="{{ user.department if user else '' }}">
                    </div>

                    <!-- Task Section -->
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid #ddd;">
                    <div class="form-group">
                        <h3 style="margin-bottom: 15px;">Task Details</h3>
                        
                        <div id="updateWorkTaskContainer">
                            <div class="task-entry" data-task-index="0">
                                <div class="form-group">
                                    <label for="updateWorkTask_0">Task*</label>
                                    <input type="text" id="updateWorkTask_0" name="task[]" placeholder="Enter task name" required>
                                </div>

                                <div class="form-group">
                                    <label for="updateWorkClientName_0">Client Name*</label>
                                    <input type="text" id="updateWorkClientName_0" name="clientName[]" placeholder="Enter client name" required>
                                </div>

                                <div class="form-group">
                                    <label for="updateWorkTime_0">Time Taken (in Hours)*</label>
                                    <input type="number" id="updateWorkTime_0" name="time[]" step="0.01" min="0" placeholder="e.g., 1.25, 2.5" required>
                                </div>

                                <div class="form-group">
                                    <label for="updateWorkStatus_0">Status*</label>
                                    <select id="updateWorkStatus_0" name="status[]" required>
                                        <option value="">Select Status</option>
                                        <option value="Completed">Completed</option>
                                        <option value="Pending">Pending</option>
                                        <option value="In Progress">In Progress</option>
                                        <option value="Remove">Remove</option>
                                        <option value="Take over">Take over</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="updateWorkDescription_0">Description*</label>
                                    <textarea id="updateWorkDescription_0" name="description[]" rows="2" placeholder="Enter description" required></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <button type="button" class="add-member-btn" id="addUpdateWorkTaskBtn" style="margin-top: 15px;">+ Add New Task</button>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeUpdateWorkModal()">Cancel</button>
                        <button type="submit" class="submit-btn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Android Mobile Application VAPT Follow-up Audit Modal -->
    <div id="androidAppFollowUpAuditModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Android Mobile Application VAPT Follow-up Audit Details</h3>
                <span class="close-modal" onclick="closeVaptModal('androidAppFollowUpAuditModal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="androidAppFollowUpAuditForm" action="/process_android_app_vapt_follow_up_audit_report" method="POST" enctype="multipart/form-data">
                    <!-- Audit Dates -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="androidAppFollowUpStartDate">Start Audit Date*</label>
                            <input type="date" id="androidAppFollowUpStartDate" name="startDate" required>
                        </div>
                        <div class="form-group">
                            <label for="androidAppFollowUpEndDate">Finish Audit Date*</label>
                            <input type="date" id="androidAppFollowUpEndDate" name="endDate" required>
                        </div>
                    </div>

                    <!-- Hash Value -->
                    <div class="form-group">
                        <label for="androidAppFollowUpHashValue">Hash Value</label>
                        <input type="text" id="androidAppFollowUpHashValue" name="hashValue" placeholder="Enter hash value">
                        <small class="file-help" style="color: brown;">Enter the hash value for the application (optional).</small>
                    </div>

                    <!-- File Uploads -->
                    <div class="form-group">
                        <label>File Uploads</label>
                        
                        <div class="file-upload-group">
                            <label for="androidAppFollowUpUserExcelFile">User Excel File (.xlsx)*</label>
                            <input type="file" id="androidAppFollowUpUserExcelFile" name="userExcelFile" accept=".xlsx" required>
                            <small class="file-help" style="color: brown;">Upload the Excel file containing vulnerabilities (required).</small>
                        </div>
                        
                        <div class="file-upload-group">
                            <label for="androidAppFollowUpNewPOCFile">New POC Zip Files (Optional)</label>
                            <input type="file" id="androidAppFollowUpNewPOCFile" name="newPOCFiles" accept=".zip">
                            <small class="file-help" style="color: brown;">Upload new POC evidence ZIP file for follow-up audit (optional).</small>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeVaptModal('androidAppFollowUpAuditModal')">Cancel</button>
                        <button type="submit" class="submit-btn">Submit Report</button>
                    </div>
                    <br>
                    <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>  
                    </small>
                </form>
            </div>
        </div>
    </div>

    <!-- Work Plan Submission Modal -->
    <div id="workPlanModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>Submit Today's Work Plan</h3>
                <span class="close-modal" onclick="closeWorkPlanModal()">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="workPlanForm" onsubmit="handleWorkPlanSubmit(event)">
                    <!-- Hidden field for status check -->
                    <input type="hidden" id="workPlanEmployeeNameForCheck" value="{{ user.employee_name if user else '' }}">
                    
                    <!-- Read-only fields -->
                    <div class="form-group">
                        <label for="workPlanDate">Date</label>
                        <input type="date" id="workPlanDate" name="date" readonly style="background-color: #f5f5f5;">
                    </div>

                    <div class="form-group">
                        <label for="workPlanEmployeeName">Employee Name</label>
                        <input type="text" id="workPlanEmployeeName" name="employeeName" readonly style="background-color: #f5f5f5;" value="{{ user.employee_name if user else '' }}">
                    </div>

                    <div class="form-group">
                        <label for="workPlanEmployeeTeam">Employee Team</label>
                        <input type="text" id="workPlanEmployeeTeam" name="employeeTeam" readonly style="background-color: #f5f5f5;" value="{{ user.department if user else '' }}">
                    </div>

                    <!-- Task Section -->
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid #ddd;">
                    <div class="form-group">
                        <h3 style="margin-bottom: 15px;">Task Details</h3>
                        
                        <div id="workPlanTaskContainer">
                            <div class="task-entry" data-task-index="0">
                                <div class="form-group">
                                    <label for="workPlanTask_0">Task*</label>
                                    <input type="text" id="workPlanTask_0" name="task[]" placeholder="Enter task name" required>
                                </div>

                                <div class="form-group">
                                    <label for="workPlanTaskDescription_0">Task Description*</label>
                                    <textarea id="workPlanTaskDescription_0" name="taskDescription[]" rows="2" placeholder="Enter task description" required></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="workPlanClientName_0">Client Name*</label>
                                    <input type="text" id="workPlanClientName_0" name="clientName[]" placeholder="Enter client name" required>
                                </div>

                                <div class="form-group">
                                    <label for="workPlanTime_0">Time Taken (in Hours)*</label>
                                    <input type="number" id="workPlanTime_0" name="time[]" step="0.01" min="0" placeholder="e.g., 1.25, 2.5" required>
                                </div>
                            </div>
                        </div>
                        
                        <button type="button" class="add-member-btn" id="addWorkPlanTaskBtn" style="margin-top: 15px;">+ Add New Task</button>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeWorkPlanModal()">Cancel</button>
                        <button type="submit" class="submit-btn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Update Work Modal -->
    <div id="updateWorkModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>Update Today's Work</h3>
                <span class="close-modal" onclick="closeUpdateWorkModal()">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="updateWorkForm" onsubmit="handleUpdateWorkSubmit(event)">
                    <!-- Hidden field for status check -->
                    <input type="hidden" id="updateWorkEmployeeNameForCheck" value="{{ user.employee_name if user else '' }}">
                    
                    <!-- Read-only fields -->
                    <div class="form-group">
                        <label for="updateWorkDate">Date</label>
                        <input type="date" id="updateWorkDate" name="date" readonly style="background-color: #f5f5f5;">
                    </div>

                    <div class="form-group">
                        <label for="updateWorkEmployeeName">Employee Name</label>
                        <input type="text" id="updateWorkEmployeeName" name="employeeName" readonly style="background-color: #f5f5f5;" value="{{ user.employee_name if user else '' }}">
                    </div>

                    <div class="form-group">
                        <label for="updateWorkEmployeeTeam">Employee Team</label>
                        <input type="text" id="updateWorkEmployeeTeam" name="employeeTeam" readonly style="background-color: #f5f5f5;" value="{{ user.department if user else '' }}">
                    </div>

                    <!-- Task Section -->
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid #ddd;">
                    <div class="form-group">
                        <h3 style="margin-bottom: 15px;">Task Details</h3>
                        
                        <div id="updateWorkTaskContainer">
                            <div class="task-entry" data-task-index="0">
                                <div class="form-group">
                                    <label for="updateWorkTask_0">Task*</label>
                                    <input type="text" id="updateWorkTask_0" name="task[]" placeholder="Enter task name" required>
                                </div>

                                <div class="form-group">
                                    <label for="updateWorkClientName_0">Client Name*</label>
                                    <input type="text" id="updateWorkClientName_0" name="clientName[]" placeholder="Enter client name" required>
                                </div>

                                <div class="form-group">
                                    <label for="updateWorkTime_0">Time Taken (in Hours)*</label>
                                    <input type="number" id="updateWorkTime_0" name="time[]" step="0.01" min="0" placeholder="e.g., 1.25, 2.5" required>
                                </div>

                                <div class="form-group">
                                    <label for="updateWorkStatus_0">Status*</label>
                                    <select id="updateWorkStatus_0" name="status[]" required>
                                        <option value="">Select Status</option>
                                        <option value="Completed">Completed</option>
                                        <option value="Pending">Pending</option>
                                        <option value="In Progress">In Progress</option>
                                        <option value="Remove">Remove</option>
                                        <option value="Take over">Take over</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="updateWorkDescription_0">Description*</label>
                                    <textarea id="updateWorkDescription_0" name="description[]" rows="2" placeholder="Enter description" required></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <button type="button" class="add-member-btn" id="addUpdateWorkTaskBtn" style="margin-top: 15px;">+ Add New Task</button>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeUpdateWorkModal()">Cancel</button>
                        <button type="submit" class="submit-btn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- IOS Mobile Application VAPT Follow-up Audit Modal -->
    <div id="iosAppFollowUpAuditModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>IOS Mobile Application VAPT Follow-up Audit Details</h3>
                <span class="close-modal" onclick="closeVaptModal('iosAppFollowUpAuditModal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="iosAppFollowUpAuditForm" action="/process_ios_app_vapt_follow_up_audit_report" method="POST" enctype="multipart/form-data">
                    <!-- Audit Dates -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="iosAppFollowUpStartDate">Start Audit Date*</label>
                            <input type="date" id="iosAppFollowUpStartDate" name="startDate" required>
                        </div>
                        <div class="form-group">
                            <label for="iosAppFollowUpEndDate">Finish Audit Date*</label>
                            <input type="date" id="iosAppFollowUpEndDate" name="endDate" required>
                        </div>
                    </div>

                    <!-- Hash Value -->
                    <div class="form-group">
                        <label for="iosAppFollowUpHashValue">Hash Value</label>
                        <input type="text" id="iosAppFollowUpHashValue" name="hashValue" placeholder="Enter hash value">
                        <small class="file-help" style="color: brown;">Enter the hash value for the application (optional).</small>
                    </div>

                    <!-- File Uploads -->
                    <div class="form-group">
                        <label>File Uploads</label>
                        
                        <div class="file-upload-group">
                            <label for="iosAppFollowUpUserExcelFile">User Excel File (.xlsx)*</label>
                            <input type="file" id="iosAppFollowUpUserExcelFile" name="userExcelFile" accept=".xlsx" required>
                            <small class="file-help" style="color: brown;">Upload the Excel file containing vulnerabilities (required).</small>
                        </div>
                        
                        <div class="file-upload-group">
                            <label for="iosAppFollowUpNewPOCFile">New POC Zip Files (Optional)</label>
                            <input type="file" id="iosAppFollowUpNewPOCFile" name="newPOCFiles" accept=".zip">
                            <small class="file-help" style="color: brown;">Upload new POC evidence ZIP file for follow-up audit (optional).</small>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeVaptModal('iosAppFollowUpAuditModal')">Cancel</button>
                        <button type="submit" class="submit-btn">Submit Report</button>
                    </div>
                    <br>
                    <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>  
                    </small>
                </form>
            </div>
        </div>
    </div>

    <!-- Work Plan Submission Modal -->
    <div id="workPlanModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>Submit Today's Work Plan</h3>
                <span class="close-modal" onclick="closeWorkPlanModal()">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="workPlanForm" onsubmit="handleWorkPlanSubmit(event)">
                    <!-- Hidden field for status check -->
                    <input type="hidden" id="workPlanEmployeeNameForCheck" value="{{ user.employee_name if user else '' }}">
                    
                    <!-- Read-only fields -->
                    <div class="form-group">
                        <label for="workPlanDate">Date</label>
                        <input type="date" id="workPlanDate" name="date" readonly style="background-color: #f5f5f5;">
                    </div>

                    <div class="form-group">
                        <label for="workPlanEmployeeName">Employee Name</label>
                        <input type="text" id="workPlanEmployeeName" name="employeeName" readonly style="background-color: #f5f5f5;" value="{{ user.employee_name if user else '' }}">
                    </div>

                    <div class="form-group">
                        <label for="workPlanEmployeeTeam">Employee Team</label>
                        <input type="text" id="workPlanEmployeeTeam" name="employeeTeam" readonly style="background-color: #f5f5f5;" value="{{ user.department if user else '' }}">
                    </div>

                    <!-- Task Section -->
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid #ddd;">
                    <div class="form-group">
                        <h3 style="margin-bottom: 15px;">Task Details</h3>
                        
                        <div id="workPlanTaskContainer">
                            <div class="task-entry" data-task-index="0">
                                <div class="form-group">
                                    <label for="workPlanTask_0">Task*</label>
                                    <input type="text" id="workPlanTask_0" name="task[]" placeholder="Enter task name" required>
                                </div>

                                <div class="form-group">
                                    <label for="workPlanTaskDescription_0">Task Description*</label>
                                    <textarea id="workPlanTaskDescription_0" name="taskDescription[]" rows="2" placeholder="Enter task description" required></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="workPlanClientName_0">Client Name*</label>
                                    <input type="text" id="workPlanClientName_0" name="clientName[]" placeholder="Enter client name" required>
                                </div>

                                <div class="form-group">
                                    <label for="workPlanTime_0">Time Taken (in Hours)*</label>
                                    <input type="number" id="workPlanTime_0" name="time[]" step="0.01" min="0" placeholder="e.g., 1.25, 2.5" required>
                                </div>
                            </div>
                        </div>
                        
                        <button type="button" class="add-member-btn" id="addWorkPlanTaskBtn" style="margin-top: 15px;">+ Add New Task</button>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeWorkPlanModal()">Cancel</button>
                        <button type="submit" class="submit-btn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Update Work Modal -->
    <div id="updateWorkModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>Update Today's Work</h3>
                <span class="close-modal" onclick="closeUpdateWorkModal()">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="updateWorkForm" onsubmit="handleUpdateWorkSubmit(event)">
                    <!-- Hidden field for status check -->
                    <input type="hidden" id="updateWorkEmployeeNameForCheck" value="{{ user.employee_name if user else '' }}">
                    
                    <!-- Read-only fields -->
                    <div class="form-group">
                        <label for="updateWorkDate">Date</label>
                        <input type="date" id="updateWorkDate" name="date" readonly style="background-color: #f5f5f5;">
                    </div>

                    <div class="form-group">
                        <label for="updateWorkEmployeeName">Employee Name</label>
                        <input type="text" id="updateWorkEmployeeName" name="employeeName" readonly style="background-color: #f5f5f5;" value="{{ user.employee_name if user else '' }}">
                    </div>

                    <div class="form-group">
                        <label for="updateWorkEmployeeTeam">Employee Team</label>
                        <input type="text" id="updateWorkEmployeeTeam" name="employeeTeam" readonly style="background-color: #f5f5f5;" value="{{ user.department if user else '' }}">
                    </div>

                    <!-- Task Section -->
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid #ddd;">
                    <div class="form-group">
                        <h3 style="margin-bottom: 15px;">Task Details</h3>
                        
                        <div id="updateWorkTaskContainer">
                            <div class="task-entry" data-task-index="0">
                                <div class="form-group">
                                    <label for="updateWorkTask_0">Task*</label>
                                    <input type="text" id="updateWorkTask_0" name="task[]" placeholder="Enter task name" required>
                                </div>

                                <div class="form-group">
                                    <label for="updateWorkClientName_0">Client Name*</label>
                                    <input type="text" id="updateWorkClientName_0" name="clientName[]" placeholder="Enter client name" required>
                                </div>

                                <div class="form-group">
                                    <label for="updateWorkTime_0">Time Taken (in Hours)*</label>
                                    <input type="number" id="updateWorkTime_0" name="time[]" step="0.01" min="0" placeholder="e.g., 1.25, 2.5" required>
                                </div>

                                <div class="form-group">
                                    <label for="updateWorkStatus_0">Status*</label>
                                    <select id="updateWorkStatus_0" name="status[]" required>
                                        <option value="">Select Status</option>
                                        <option value="Completed">Completed</option>
                                        <option value="Pending">Pending</option>
                                        <option value="In Progress">In Progress</option>
                                        <option value="Remove">Remove</option>
                                        <option value="Take over">Take over</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="updateWorkDescription_0">Description*</label>
                                    <textarea id="updateWorkDescription_0" name="description[]" rows="2" placeholder="Enter description" required></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <button type="button" class="add-member-btn" id="addUpdateWorkTaskBtn" style="margin-top: 15px;">+ Add New Task</button>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeUpdateWorkModal()">Cancel</button>
                        <button type="submit" class="submit-btn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- API VAPT Follow-up Audit Modal -->
    <div id="apiFollowUpAuditModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>API VAPT Follow-up Audit Details</h3>
                <span class="close-modal" onclick="closeVaptModal('apiFollowUpAuditModal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="apiFollowUpAuditForm" action="/process_api_vapt_follow_up_audit_report" method="POST" enctype="multipart/form-data">
                    <!-- Audit Dates -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="apiFollowUpStartDate">Start Audit Date*</label>
                            <input type="date" id="apiFollowUpStartDate" name="startDate" required>
                        </div>
                        <div class="form-group">
                            <label for="apiFollowUpEndDate">Finish Audit Date*</label>
                            <input type="date" id="apiFollowUpEndDate" name="endDate" required>
                        </div>
                    </div>

                    <!-- File Uploads -->
                    <div class="form-group">
                        <label>File Uploads</label>
                        
                        <div class="file-upload-group">
                            <label for="apiFollowUpUserExcelFile">User Excel File (.xlsx)*</label>
                            <input type="file" id="apiFollowUpUserExcelFile" name="userExcelFile" accept=".xlsx" required>
                            <small class="file-help" style="color: brown;">Upload the Excel file containing vulnerabilities (required).</small>
                        </div>
                        
                        <div class="file-upload-group">
                            <label for="apiFollowUpNewPOCFile">New POC Zip Files (Optional)</label>
                            <input type="file" id="apiFollowUpNewPOCFile" name="newPOCFiles" accept=".zip">
                            <small class="file-help" style="color: brown;">Upload new POC evidence ZIP file for follow-up audit (optional).</small>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeVaptModal('apiFollowUpAuditModal')">Cancel</button>
                        <button type="submit" class="submit-btn">Submit Report</button>
                    </div>
                    <br>
                    <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>  
                    </small>
                </form>
            </div>
        </div>
    </div>

    <!-- Work Plan Submission Modal -->
    <div id="workPlanModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>Submit Today's Work Plan</h3>
                <span class="close-modal" onclick="closeWorkPlanModal()">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="workPlanForm" onsubmit="handleWorkPlanSubmit(event)">
                    <!-- Hidden field for status check -->
                    <input type="hidden" id="workPlanEmployeeNameForCheck" value="{{ user.employee_name if user else '' }}">
                    
                    <!-- Read-only fields -->
                    <div class="form-group">
                        <label for="workPlanDate">Date</label>
                        <input type="date" id="workPlanDate" name="date" readonly style="background-color: #f5f5f5;">
                    </div>

                    <div class="form-group">
                        <label for="workPlanEmployeeName">Employee Name</label>
                        <input type="text" id="workPlanEmployeeName" name="employeeName" readonly style="background-color: #f5f5f5;" value="{{ user.employee_name if user else '' }}">
                    </div>

                    <div class="form-group">
                        <label for="workPlanEmployeeTeam">Employee Team</label>
                        <input type="text" id="workPlanEmployeeTeam" name="employeeTeam" readonly style="background-color: #f5f5f5;" value="{{ user.department if user else '' }}">
                    </div>

                    <!-- Task Section -->
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid #ddd;">
                    <div class="form-group">
                        <h3 style="margin-bottom: 15px;">Task Details</h3>
                        
                        <div id="workPlanTaskContainer">
                            <div class="task-entry" data-task-index="0">
                                <div class="form-group">
                                    <label for="workPlanTask_0">Task*</label>
                                    <input type="text" id="workPlanTask_0" name="task[]" placeholder="Enter task name" required>
                                </div>

                                <div class="form-group">
                                    <label for="workPlanTaskDescription_0">Task Description*</label>
                                    <textarea id="workPlanTaskDescription_0" name="taskDescription[]" rows="2" placeholder="Enter task description" required></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="workPlanClientName_0">Client Name*</label>
                                    <input type="text" id="workPlanClientName_0" name="clientName[]" placeholder="Enter client name" required>
                                </div>

                                <div class="form-group">
                                    <label for="workPlanTime_0">Time Taken (in Hours)*</label>
                                    <input type="number" id="workPlanTime_0" name="time[]" step="0.01" min="0" placeholder="e.g., 1.25, 2.5" required>
                                </div>
                            </div>
                        </div>
                        
                        <button type="button" class="add-member-btn" id="addWorkPlanTaskBtn" style="margin-top: 15px;">+ Add New Task</button>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeWorkPlanModal()">Cancel</button>
                        <button type="submit" class="submit-btn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Update Work Modal -->
    <div id="updateWorkModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>Update Today's Work</h3>
                <span class="close-modal" onclick="closeUpdateWorkModal()">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="updateWorkForm" onsubmit="handleUpdateWorkSubmit(event)">
                    <!-- Hidden field for status check -->
                    <input type="hidden" id="updateWorkEmployeeNameForCheck" value="{{ user.employee_name if user else '' }}">
                    
                    <!-- Read-only fields -->
                    <div class="form-group">
                        <label for="updateWorkDate">Date</label>
                        <input type="date" id="updateWorkDate" name="date" readonly style="background-color: #f5f5f5;">
                    </div>

                    <div class="form-group">
                        <label for="updateWorkEmployeeName">Employee Name</label>
                        <input type="text" id="updateWorkEmployeeName" name="employeeName" readonly style="background-color: #f5f5f5;" value="{{ user.employee_name if user else '' }}">
                    </div>

                    <div class="form-group">
                        <label for="updateWorkEmployeeTeam">Employee Team</label>
                        <input type="text" id="updateWorkEmployeeTeam" name="employeeTeam" readonly style="background-color: #f5f5f5;" value="{{ user.department if user else '' }}">
                    </div>

                    <!-- Task Section -->
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid #ddd;">
                    <div class="form-group">
                        <h3 style="margin-bottom: 15px;">Task Details</h3>
                        
                        <div id="updateWorkTaskContainer">
                            <div class="task-entry" data-task-index="0">
                                <div class="form-group">
                                    <label for="updateWorkTask_0">Task*</label>
                                    <input type="text" id="updateWorkTask_0" name="task[]" placeholder="Enter task name" required>
                                </div>

                                <div class="form-group">
                                    <label for="updateWorkClientName_0">Client Name*</label>
                                    <input type="text" id="updateWorkClientName_0" name="clientName[]" placeholder="Enter client name" required>
                                </div>

                                <div class="form-group">
                                    <label for="updateWorkTime_0">Time Taken (in Hours)*</label>
                                    <input type="number" id="updateWorkTime_0" name="time[]" step="0.01" min="0" placeholder="e.g., 1.25, 2.5" required>
                                </div>

                                <div class="form-group">
                                    <label for="updateWorkStatus_0">Status*</label>
                                    <select id="updateWorkStatus_0" name="status[]" required>
                                        <option value="">Select Status</option>
                                        <option value="Completed">Completed</option>
                                        <option value="Pending">Pending</option>
                                        <option value="In Progress">In Progress</option>
                                        <option value="Remove">Remove</option>
                                        <option value="Take over">Take over</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="updateWorkDescription_0">Description*</label>
                                    <textarea id="updateWorkDescription_0" name="description[]" rows="2" placeholder="Enter description" required></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <button type="button" class="add-member-btn" id="addUpdateWorkTaskBtn" style="margin-top: 15px;">+ Add New Task</button>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeUpdateWorkModal()">Cancel</button>
                        <button type="submit" class="submit-btn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Sprint Plan Modal -->
    <div id="sprintPlanModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h3>Submit Sprint Plan</h3>
                <span class="close-modal" onclick="closeSprintPlanModal()">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="sprintPlanForm" onsubmit="handleSprintPlanSubmit(event)">
                    <!-- Hidden field for status check -->
                    <input type="hidden" id="sprintPlanEmployeeNameForCheck" value="{{ user.employee_name if user else '' }}">
                    
                    <!-- Read-only fields -->
                    <div class="form-group">
                        <label for="sprintPlanEmployeeName">Employee Name</label>
                        <input type="text" id="sprintPlanEmployeeName" name="employeeName" readonly style="background-color: #f5f5f5;" value="{{ user.employee_name if user else '' }}">
                    </div>

                    <div class="form-group">
                        <label for="sprintPlanEmployeeTeam">Employee Team</label>
                        <input type="text" id="sprintPlanEmployeeTeam" name="employeeTeam" readonly style="background-color: #f5f5f5;" value="{{ user.department if user else '' }}">
                    </div>

                    <!-- Day Section -->
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid #ddd;">
                    <div class="form-group">
                        <h3 style="margin-bottom: 15px;">Sprint Plan for Next 6 Days</h3>
                        
                        <div id="sprintPlanDayContainer">
                            <div class="day-entry" data-day-index="0">
                                <div class="form-group">
                                    <label>Date*</label>
                                    <input type="date" class="sprint-date-input" name="dates[]" required>
                                </div>
                                
                                <div class="form-group">
                                    <h4 style="margin-bottom: 10px;">Tasks</h4>
                                    <div id="sprintDay0TaskContainer" class="task-container">
                                        <div class="task-entry" data-task-index="0">
                                            <div class="form-group">
                                                <label>Task*</label>
                                                <input type="text" name="tasks[0][]" placeholder="Enter task" required>
                                            </div>
                                            <div class="form-group">
                                                <label>Client Name*</label>
                                                <input type="text" name="clientNames[0][]" placeholder="Enter client name" required>
                                            </div>
                                            <div class="form-group">
                                                <label>Time (Hours)*</label>
                                                <input type="number" name="times[0][]" step="0.01" min="0" placeholder="e.g., 1.25" required>
                                            </div>
                                            <button type="button" onclick="removeSprintTask(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 5px 10px; cursor: pointer;">Remove</button>
                                        </div>
                                    </div>
                                    <button type="button" class="add-member-btn add-sprint-task-btn" data-day="0" style="margin-top: 10px;">+ Add New Task</button>
                                </div>
                                
                                <button type="button" onclick="removeSprintDay(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; margin-top: 15px; cursor: pointer; width: 100%;">Remove This Day</button>
                            </div>
                        </div>
                        
                        <button type="button" class="add-member-btn" id="addSprintDayBtn" style="margin-top: 15px;">+ Add New Day</button>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeSprintPlanModal()">Cancel</button>
                        <button type="submit" class="submit-btn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Last Week Sprint Modal -->
    <div id="lastWeekSprintModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h3>Submit Last Week Sprint</h3>
                <span class="close-modal" onclick="closeLastWeekSprintModal()">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="lastWeekSprintForm" onsubmit="handleLastWeekSprintSubmit(event)">
                    <!-- Hidden field for status check -->
                    <input type="hidden" id="lastWeekSprintEmployeeNameForCheck" value="{{ user.employee_name if user else '' }}">
                    
                    <!-- Read-only fields -->
                    <div class="form-group">
                        <label for="lastWeekSprintEmployeeName">Employee Name</label>
                        <input type="text" id="lastWeekSprintEmployeeName" name="employeeName" readonly style="background-color: #f5f5f5;" value="{{ user.employee_name if user else '' }}">
                    </div>

                    <div class="form-group">
                        <label for="lastWeekSprintEmployeeTeam">Employee Team</label>
                        <input type="text" id="lastWeekSprintEmployeeTeam" name="employeeTeam" readonly style="background-color: #f5f5f5;" value="{{ user.department if user else '' }}">
                    </div>

                    <!-- Special Comment Field -->
                    <div class="form-group">
                        <label for="lastWeekSprintSpecialComment">Special Comment or Extra Comment</label>
                        <textarea id="lastWeekSprintSpecialComment" name="specialComment" rows="3" placeholder="Enter any specific comment or extra information"></textarea>
                    </div>

                    <!-- Day Section -->
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid #ddd;">
                    <div class="form-group">
                        <h3 style="margin-bottom: 15px;">Last Week Sprint Work</h3>
                        
                        <div id="lastWeekSprintDayContainer">
                            <div class="day-entry" data-day-index="0">
                                <div class="form-group">
                                    <label>Date*</label>
                                    <input type="date" class="sprint-date-input" name="dates[]" required>
                                </div>
                                
                                <div class="form-group">
                                    <h4 style="margin-bottom: 10px;">Tasks</h4>
                                    <div id="lastWeekSprintDay0TaskContainer" class="task-container">
                                        <div class="task-entry" data-task-index="0">
                                            <div class="form-group">
                                                <label>Task*</label>
                                                <input type="text" name="tasks[0][]" placeholder="Enter task" required>
                                            </div>
                                            <div class="form-group">
                                                <label>Client Name*</label>
                                                <input type="text" name="clientNames[0][]" placeholder="Enter client name" required>
                                            </div>
                                            <div class="form-group">
                                                <label>Time (Hours)*</label>
                                                <input type="number" name="times[0][]" step="0.01" min="0" placeholder="e.g., 1.25" required>
                                            </div>
                                            <div class="form-group">
                                                <label>Status*</label>
                                                <select name="statuses[0][]" required>
                                                    <option value="">Select Status</option>
                                                    <option value="Completed">Completed</option>
                                                    <option value="Pending">Pending</option>
                                                    <option value="In Progress">In Progress</option>
                                                    <option value="Remove">Remove</option>
                                                    <option value="Take over">Take over</option>
                                                </select>
                                            </div>
                                            <button type="button" onclick="removeLastWeekSprintTask(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 5px 10px; cursor: pointer;">Remove</button>
                                        </div>
                                    </div>
                                    <button type="button" class="add-member-btn add-lastweek-task-btn" data-day="0" style="margin-top: 10px;">+ Add New Task</button>
                                </div>
                                
                                <button type="button" onclick="removeLastWeekSprintDay(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; margin-top: 15px; cursor: pointer; width: 100%;">Remove This Day</button>
                            </div>
                        </div>
                        
                        <button type="button" class="add-member-btn" id="addLastWeekSprintDayBtn" style="margin-top: 15px;">+ Add New Day</button>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeLastWeekSprintModal()">Cancel</button>
                        <button type="submit" class="submit-btn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Extra Work Modal -->
    <div id="extraWorkModal" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h3>Submit Extra Work</h3>
                <span class="close-modal" onclick="closeExtraWorkModal()">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="extraWorkForm" onsubmit="handleExtraWorkSubmit(event)">
                    <!-- Read-only fields -->
                    <div class="form-group">
                        <label for="extraWorkEmployeeName">Employee Name</label>
                        <input type="text" id="extraWorkEmployeeName" name="employeeName" readonly style="background-color: #f5f5f5;" value="{{ user.employee_name if user else '' }}">
                    </div>

                    <div class="form-group">
                        <label for="extraWorkEmployeeTeam">Employee Team</label>
                        <input type="text" id="extraWorkEmployeeTeam" name="employeeTeam" readonly style="background-color: #f5f5f5;" value="{{ user.department if user else '' }}">
                    </div>

                    <div class="form-group">
                        <label for="extraWorkDate">Date</label>
                        <input type="date" id="extraWorkDate" name="date" readonly style="background-color: #f5f5f5;">
                    </div>

                    <div class="form-group">
                        <label for="extraWorkTime">Time (Hours)*</label>
                        <input type="number" id="extraWorkTime" name="time" step="0.01" min="0" placeholder="e.g., 1.25, 2.5" required>
                    </div>

                    <div class="form-group">
                        <label for="extraWorkTask">Task*</label>
                        <input type="text" id="extraWorkTask" name="task" placeholder="Enter task" required>
                    </div>

                    <div class="form-group">
                        <label for="extraWorkTaskDescription">Task Description*</label>
                        <textarea id="extraWorkTaskDescription" name="taskDescription" rows="3" placeholder="Enter task description" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="extraWorkClient">Client Name*</label>
                        <input type="text" id="extraWorkClient" name="clientName" placeholder="Enter client name" required>
                    </div>

                    <div class="form-group">
                        <label for="extraWorkConcernedPerson">Concerned Person*</label>
                        <input type="text" id="extraWorkConcernedPerson" name="concernedPerson" placeholder="Enter concerned person name" required>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeExtraWorkModal()">Cancel</button>
                        <button type="submit" class="submit-btn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Leave Approval Request Modal -->
    <div id="leaveApprovalModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>Leave Approval Request</h3>
                <span class="close-modal" onclick="closeLeaveApprovalModal()">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="leaveApprovalForm">
                    <!-- Employee Name (Default) -->
                    <div class="form-group">
                        <label for="leaveEmployeeName">Employee Name</label>
                        <input type="text" id="leaveEmployeeName" name="employeeName" readonly style="background-color: #f5f5f5;" value="{{ user.employee_name if user else '' }}">
                    </div>

                    <!-- Date (Today's Date by Default) -->
                    <div class="form-group">
                        <label for="leaveRequestDate">Date</label>
                        <input type="date" id="leaveRequestDate" name="requestDate" readonly style="background-color: #f5f5f5;">
                    </div>

                    <!-- Leave Type Radio Buttons -->
                    <div class="form-group">
                        <label>Leave Type*</label>
                        <div class="radio-group">
                            <label><input type="radio" name="leaveType" value="Preplan Leave" checked onchange="toggleCurrentTaskField()"> Preplan Leave</label>
                            <label><input type="radio" name="leaveType" value="Emergency Leave" onchange="toggleCurrentTaskField()"> Emergency Leave</label>
                        </div>
                    </div>

                    <!-- Leave From -->
                    <div class="form-group">
                        <label for="leaveFrom">Leave From*</label>
                        <input type="date" id="leaveFrom" name="leaveFrom" required>
                    </div>

                    <!-- Leave To -->
                    <div class="form-group">
                        <label for="leaveTo">Leave To*</label>
                        <input type="date" id="leaveTo" name="leaveTo" required>
                    </div>

                    <!-- Reason -->
                    <div class="form-group">
                        <label for="leaveReason">Reason*</label>
                        <input type="text" id="leaveReason" name="reason" placeholder="Enter reason for leave" required>
                    </div>

                    <!-- Your current task (Only shown if Emergency Leave is selected) -->
                    <div class="form-group" id="currentTaskField" style="display: none;">
                        <label for="leaveCurrentTask">Your Current Task*</label>
                        <textarea id="leaveCurrentTask" name="currentTask" rows="3" placeholder="Enter your current task details"></textarea>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeLeaveApprovalModal()">Cancel</button>
                        <button type="button" class="submit-btn" onclick="handleLeaveApprovalSubmit()">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Complaint About Team Modal -->
    <div id="complaintModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>Complaint About Team</h3>
                <span class="close-modal" onclick="closeComplaintModal()">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="complaintForm">
                    <!-- Employee Name (Default) -->
                    <div class="form-group">
                        <label for="complaintEmployeeName">Employee Name</label>
                        <input type="text" id="complaintEmployeeName" name="employeeName" readonly style="background-color: #f5f5f5;" value="{{ user.employee_name if user else '' }}">
                    </div>

                    <!-- Employee Team (Default) -->
                    <div class="form-group">
                        <label for="complaintEmployeeTeam">Employee Team</label>
                        <input type="text" id="complaintEmployeeTeam" name="employeeTeam" readonly style="background-color: #f5f5f5;" value="{{ user.department if user else '' }}">
                    </div>

                    <!-- Date (Current date by default) -->
                    <div class="form-group">
                        <label for="complaintDate">Date</label>
                        <input type="date" id="complaintDate" name="date" readonly style="background-color: #f5f5f5;">
                    </div>

                    <!-- Person Name -->
                    <div class="form-group">
                        <label for="complaintPersonName">Person Name*</label>
                        <input type="text" id="complaintPersonName" name="personName" placeholder="Enter person name" required>
                    </div>

                    <!-- Complain Description -->
                    <div class="form-group">
                        <label for="complaintDescription">Complain Description*</label>
                        <textarea id="complaintDescription" name="complainDescription" rows="4" placeholder="Enter complaint details" required></textarea>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeComplaintModal()">Cancel</button>
                        <button type="button" class="submit-btn" onclick="handleComplaintSubmit()">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
    window.performanceData = {
        punctuality: {% if performance_data %}{{ performance_data.punctuality|default(0) }}{% else %}0{% endif %},
        clientSatisfaction: {% if performance_data %}{{ performance_data.client_satisfaction|default(0) }}{% else %}0{% endif %},
        behaviour: {% if performance_data %}{{ performance_data.behaviour|default(0) }}{% else %}0{% endif %},
        communicationSkills: {% if performance_data %}{{ performance_data.communication_skills|default(0) }}{% else %}0{% endif %},
        technicalSkills: {% if performance_data %}{{ performance_data.technical_skills|default(0) }}{% else %}0{% endif %},
        teamCoordination: {% if performance_data %}{{ performance_data.team_coordination|default(0) }}{% else %}0{% endif %}
    };
    </script>
    <script>
    window.performanceHistory = {% if performance_history %}{{ performance_history | tojson }}{% else %}[]{% endif %};
    
    // Debug logging for chart data
    console.log('VAPT Chart Data Setup:');
    console.log('- Performance Data:', window.performanceData);
    console.log('- Performance History:', window.performanceHistory);
    console.log('- Chart.js available:', typeof Chart !== 'undefined');
    </script>
    
    <script>
    // Chart initialization fallback - ensures charts render even if external JS fails
    (function() {
        let fallbackRetries = 0;
        const MAX_FALLBACK_RETRIES = 50; // Maximum 10 seconds (50 * 200ms)
        
        function initChartsFallback() {
            // Check if charts already initialized
            const progressCtx = document.getElementById('progressChart');
            const lastYearCtx = document.getElementById('lastYearChart');
            
            if (!progressCtx || !lastYearCtx) {
                fallbackRetries++;
                if (fallbackRetries >= MAX_FALLBACK_RETRIES) {
                    console.error('VAPT: Chart canvas elements not found after maximum retries.');
                    return;
                }
                console.warn('VAPT: Chart canvas elements not found yet, retrying... (' + fallbackRetries + '/' + MAX_FALLBACK_RETRIES + ')');
                setTimeout(initChartsFallback, 200);
                return;
            }
            
            // Wait for Chart.js
            if (typeof Chart === 'undefined') {
                fallbackRetries++;
                if (fallbackRetries >= MAX_FALLBACK_RETRIES) {
                    console.error('VAPT: Chart.js failed to load after maximum retries. Please check your internet connection or CDN availability.');
                    return;
                }
                console.warn('VAPT: Chart.js not loaded yet, retrying... (' + fallbackRetries + '/' + MAX_FALLBACK_RETRIES + ')');
                setTimeout(initChartsFallback, 200);
                return;
            }
            
            // Reset retry counter on success
            fallbackRetries = 0;
            
            // Wait a bit more to let external JS initialize first, but not too long
            setTimeout(function() {
                // Force re-check canvas visibility
                if (progressCtx && !progressCtx.chartInstance) {
                    console.log('VAPT Fallback: Initializing progress chart...');
                    try {
                        const perfData = window.performanceData || {};
                        const perfScores = [
                            perfData.punctuality || 0,
                            perfData.clientSatisfaction || 0,
                            perfData.behaviour || 0,
                            perfData.communicationSkills || 0,
                            perfData.technicalSkills || 0,
                            perfData.teamCoordination || 0
                        ];
                        
                        function getBarColor(score) {
                            if (score <= 6) return 'rgba(255, 99, 132, 0.8)';
                            if (score <= 8) return 'rgba(255, 206, 86, 0.8)';
                            return 'rgba(75, 192, 192, 0.8)';
                        }
                        
                        const container = progressCtx.parentElement;
                        if (container) {
                            container.style.display = 'block';
                            container.style.width = '100%';
                            container.style.height = '260px';
                        }
                        progressCtx.style.display = 'block';
                        
                        progressCtx.chartInstance = new Chart(progressCtx.getContext('2d'), {
                            type: 'bar',
                            data: {
                                labels: ['Punctuality', 'Client\nSatisfaction', 'Behaviour', 'Communication\nSkills', 'Technical\nSkills', 'Team\nCoordination'],
                                datasets: [{
                                    label: 'Performance Metrics',
                                    data: perfScores,
                                    backgroundColor: perfScores.map(getBarColor),
                                    borderColor: perfScores.map(s => getBarColor(s).replace('0.8', '1')),
                                    borderWidth: 2
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: { legend: { display: false } },
                                scales: {
                                    x: { ticks: { font: { size: 12 } } },
                                    y: { beginAtZero: true, max: 10, ticks: { stepSize: 1 } }
                                }
                            }
                        });
                        console.log('VAPT Fallback: Progress chart initialized');
                    } catch (e) {
                        console.error('VAPT Fallback: Error initializing progress chart:', e);
                    }
                }
                
                // Initialize last year chart if needed
                if (lastYearCtx && !lastYearCtx.chartInstance) {
                    console.log('VAPT Fallback: Initializing last year chart...');
                    try {
                        const historyData = window.performanceHistory && Array.isArray(window.performanceHistory) 
                            ? window.performanceHistory 
                            : [];
                        
                        if (historyData.length > 0) {
                            const labels = [];
                            const data = [];
                            for (let i = 0; i < historyData.length; i++) {
                                const item = historyData[i];
                                if (item && item.month_name && item.year_short) {
                                    labels.push(`${item.month_name}\n'${item.year_short}`);
                                    data.push(item.average !== undefined ? item.average : 0);
                                }
                            }
                            
                            if (labels.length > 0) {
                                const container = lastYearCtx.parentElement;
                                if (container) {
                                    container.style.display = 'block';
                                    container.style.width = '100%';
                                    container.style.height = '260px';
                                }
                                lastYearCtx.style.display = 'block';
                                
                                lastYearCtx.chartInstance = new Chart(lastYearCtx.getContext('2d'), {
                                    type: 'line',
                                    data: {
                                        labels: labels,
                                        datasets: [{
                                            label: 'Performance Trend',
                                            data: data,
                                            borderColor: 'rgba(52, 152, 219, 1)',
                                            backgroundColor: 'rgba(52, 152, 219, 0.1)',
                                            tension: 0.4,
                                            fill: true,
                                            pointRadius: 5
                                        }]
                                    },
                                    options: {
                                        responsive: true,
                                        maintainAspectRatio: false,
                                        plugins: { legend: { display: false } },
                                        scales: {
                                            y: { 
                                                beginAtZero: true,
                                                max: 10, 
                                                ticks: { stepSize: 1 } 
                                            }
                                        }
                                    }
                                });
                                console.log('VAPT Fallback: Last year chart initialized');
                            }
                        }
                    } catch (e) {
                        console.error('VAPT Fallback: Error initializing last year chart:', e);
                    }
                }
            }, 200);
        }
        
        // Start fallback initialization after a short delay
        setTimeout(initChartsFallback, 300);
    })();
    </script>
    
    <script>
    // VAPT Modal Functions
    function openVaptModal(modalId) {
        document.getElementById(modalId).style.display = 'block';
        
        // Handle default values for VAPT First Audit MetaData modal
        if (modalId === 'vaptFirstAuditMetaDataModal') {
            // Ensure default selected values are properly set and sub-sector is populated
            setTimeout(() => {
                const sectorSelect = document.getElementById('vaptMetaSectorOrg');
                if (sectorSelect) {
                    // The selected attribute ensures the value is set, but we verify it
                    const selectedOption = sectorSelect.options[sectorSelect.selectedIndex];
                    if (selectedOption && selectedOption.value === 'Finance') {
                        // Trigger sub-sector update to populate Finance sub-sectors
                        if (typeof updateVaptSubSectorOptions === 'function') {
                            updateVaptSubSectorOptions();
                        }
                    }
                }
                
                // Initialize date last audit field - ensure NA is selected and date input is hidden
                const dateLastAuditType = document.getElementById('vaptMetaDateLastAuditType');
                if (dateLastAuditType && typeof toggleVaptLastAuditDateInput === 'function') {
                    toggleVaptLastAuditDateInput('vaptMetaDateLastAuditType', 'vaptMetaDateLastAudit');
                }
            }, 50);
        }
        
        // Handle default values for Public IP First Audit MetaData modal
        if (modalId === 'publicIpFirstAuditMetaDataModal') {
            setTimeout(() => {
                const sectorSelect = document.getElementById('publicIpMetaSectorOrg');
                if (sectorSelect) {
                    const selectedOption = sectorSelect.options[sectorSelect.selectedIndex];
                    if (selectedOption && selectedOption.value === 'Finance') {
                        if (typeof updatePublicIpVaptSubSectorOptions === 'function') {
                            updatePublicIpVaptSubSectorOptions();
                        }
                    }
                }

                const dateLastAuditType = document.getElementById('publicIpMetaDateLastAuditType');
                if (dateLastAuditType && typeof togglePublicIpVaptLastAuditDateInput === 'function') {
                    togglePublicIpVaptLastAuditDateInput('publicIpMetaDateLastAuditType', 'publicIpMetaDateLastAudit');
                }
            }, 50);
        }

        // Handle default values for Website VAPT First Audit MetaData modal
        if (modalId === 'websiteVaptFirstAuditMetaDataModal') {
            // Ensure default selected values are properly set and sub-sector is populated
            setTimeout(() => {
                const sectorSelect = document.getElementById('websiteVaptMetaSectorOrg');
                if (sectorSelect) {
                    // The selected attribute ensures the value is set, but we verify it
                    const selectedOption = sectorSelect.options[sectorSelect.selectedIndex];
                    if (selectedOption && selectedOption.value === 'Finance') {
                        // Trigger sub-sector update to populate Finance sub-sectors
                        if (typeof updateWebsiteVaptSubSectorOptions === 'function') {
                            updateWebsiteVaptSubSectorOptions();
                        }
                    }
                }
                
                // Initialize date last audit field - ensure NA is selected and date input is hidden
                const dateLastAuditType = document.getElementById('websiteVaptMetaDateLastAuditType');
                if (dateLastAuditType && typeof toggleWebsiteVaptLastAuditDateInput === 'function') {
                    toggleWebsiteVaptLastAuditDateInput('websiteVaptMetaDateLastAuditType', 'websiteVaptMetaDateLastAudit');
                }
                
                // Set default audit type
                const auditTypeSelect = document.getElementById('websiteVaptMetaTypeOfAudit');
                if (auditTypeSelect) {
                    auditTypeSelect.value = 'Website /Web Application Audit';
                }
            }, 50);
        }
        
        // Handle default values for Web Application VAPT First Audit MetaData modal
        if (modalId === 'webAppVaptFirstAuditMetaDataModal') {
            setTimeout(() => {
                const sectorSelect = document.getElementById('webAppVaptMetaSectorOrg');
                if (sectorSelect) {
                    const selectedOption = sectorSelect.options[sectorSelect.selectedIndex];
                    if (selectedOption && selectedOption.value === 'Finance') {
                        if (typeof updateWebAppVaptSubSectorOptions === 'function') {
                            updateWebAppVaptSubSectorOptions();
                        }
                    }
                }
                
                const dateLastAuditType = document.getElementById('webAppVaptMetaDateLastAuditType');
                if (dateLastAuditType && typeof toggleWebAppVaptLastAuditDateInput === 'function') {
                    toggleWebAppVaptLastAuditDateInput('webAppVaptMetaDateLastAuditType', 'webAppVaptMetaDateLastAudit');
                }
                
                const auditTypeSelect = document.getElementById('webAppVaptMetaTypeAudit');
                if (auditTypeSelect) {
                    auditTypeSelect.value = 'Website /Web Application Audit';
                }
            }, 50);
        }
        
        // Handle default values for Android Mobile Application VAPT First Audit MetaData modal
        if (modalId === 'androidVaptFirstAuditMetaDataModal') {
            setTimeout(() => {
                const sectorSelect = document.getElementById('androidVaptMetaSectorOrg');
                if (sectorSelect) {
                    const selectedOption = sectorSelect.options[sectorSelect.selectedIndex];
                    if (selectedOption && selectedOption.value === 'Finance') {
                        if (typeof updateAndroidVaptSubSectorOptions === 'function') {
                            updateAndroidVaptSubSectorOptions();
                        }
                    }
                }
                
                const dateLastAuditType = document.getElementById('androidVaptMetaDateLastAuditType');
                if (dateLastAuditType && typeof toggleAndroidVaptLastAuditDateInput === 'function') {
                    toggleAndroidVaptLastAuditDateInput('androidVaptMetaDateLastAuditType', 'androidVaptMetaDateLastAudit');
                }
                
                const auditTypeSelect = document.getElementById('androidVaptMetaTypeAudit');
                if (auditTypeSelect) {
                    auditTypeSelect.value = 'Website /Android Mobile Application Audit';
                }
            }, 50);
        }
        
        // Handle default values for IOS Mobile Application VAPT First Audit MetaData modal
        if (modalId === 'iosVaptFirstAuditMetaDataModal') {
            setTimeout(() => {
                const sectorSelect = document.getElementById('iosVaptMetaSectorOrg');
                if (sectorSelect) {
                    const selectedOption = sectorSelect.options[sectorSelect.selectedIndex];
                    if (selectedOption && selectedOption.value === 'Finance') {
                        if (typeof updateIosVaptSubSectorOptions === 'function') {
                            updateIosVaptSubSectorOptions();
                        }
                    }
                }
                
                const dateLastAuditType = document.getElementById('iosVaptMetaDateLastAuditType');
                if (dateLastAuditType && typeof toggleIosVaptLastAuditDateInput === 'function') {
                    toggleIosVaptLastAuditDateInput('iosVaptMetaDateLastAuditType', 'iosVaptMetaDateLastAudit');
                }
                
                const auditTypeSelect = document.getElementById('iosVaptMetaTypeAudit');
                if (auditTypeSelect) {
                    auditTypeSelect.value = 'Website /IOS Mobile Application Audit';
                }
            }, 50);
        }

        // Handle default values for API VAPT First Audit MetaData modal
        if (modalId === 'apiFirstAuditMetaDataModal') {
            setTimeout(() => {
                const sectorSelect = document.getElementById('apiMetaSectorOrg');
                if (sectorSelect) {
                    const selectedOption = sectorSelect.options[sectorSelect.selectedIndex];
                    if (selectedOption && selectedOption.value === 'Finance') {
                        if (typeof updateApiSubSectorOptions === 'function') {
                            updateApiSubSectorOptions();
                        }
                    }
                }
                
                const dateLastAuditType = document.getElementById('apiMetaDateLastAuditType');
                if (dateLastAuditType && typeof toggleApiLastAuditDateInput === 'function') {
                    toggleApiLastAuditDateInput('apiMetaDateLastAuditType', 'apiMetaDateLastAudit');
                }
            }, 50);
        }
        
        // Handle default values for Website VAPT Follow Up Audit MetaData modal
        if (modalId === 'websiteVaptFollowUpAuditMetaDataModal') {
            // Ensure default selected values are properly set and sub-sector is populated
            setTimeout(() => {
                const sectorSelect = document.getElementById('websiteVaptFollowUpMetaSectorOrg');
                if (sectorSelect) {
                    // The selected attribute ensures the value is set, but we verify it
                    const selectedOption = sectorSelect.options[sectorSelect.selectedIndex];
                    if (selectedOption && selectedOption.value === 'Finance') {
                        // Trigger sub-sector update to populate Finance sub-sectors
                        if (typeof updateWebsiteVaptFollowUpSubSectorOptions === 'function') {
                            updateWebsiteVaptFollowUpSubSectorOptions();
                        }
                    }
                }
                
                // Set default audit type
                const auditTypeSelect = document.getElementById('websiteVaptFollowUpMetaTypeAudit');
                if (auditTypeSelect) {
                    auditTypeSelect.value = 'Website /Web Application Audit';
                }
            }, 50);
        }

        // Handle default values for Android Mobile Application VAPT Follow Up Audit MetaData modal
        if (modalId === 'webAppVaptFollowUpAuditMetaDataModal') {
            setTimeout(() => {
                const sectorSelect = document.getElementById('webAppVaptFollowUpMetaSectorOrg');
                if (sectorSelect) {
                    const selectedOption = sectorSelect.options[sectorSelect.selectedIndex];
                    if (selectedOption && selectedOption.value === 'Finance') {
                        if (typeof updateWebAppVaptFollowUpSubSectorOptions === 'function') {
                            updateWebAppVaptFollowUpSubSectorOptions();
                        }
                    }
                }

                const auditeeSelect = document.getElementById('webAppVaptFollowUpMetaAuditeeOrg');
                if (auditeeSelect && typeof toggleWebAppVaptFollowUpOtherField === 'function') {
                    toggleWebAppVaptFollowUpOtherField('webAppVaptFollowUpMetaAuditeeOrg', 'webAppVaptFollowUpMetaAuditeeOrgOther');
                }

                const auditTypeSelect = document.getElementById('webAppVaptFollowUpMetaTypeAudit');
                if (auditTypeSelect) {
                    auditTypeSelect.value = 'VAPT-Application';
                    if (typeof toggleWebAppVaptFollowUpOtherField === 'function') {
                        toggleWebAppVaptFollowUpOtherField('webAppVaptFollowUpMetaTypeAudit', 'webAppVaptFollowUpMetaTypeAuditOther');
                    }
                }
            }, 50);
        }

        // Handle default values for IOS Mobile Application VAPT Follow Up Audit MetaData modal
        if (modalId === 'iosVaptFollowUpAuditMetaDataModal') {
            setTimeout(() => {
                const sectorSelect = document.getElementById('iosVaptFollowUpMetaSectorOrg');
                if (sectorSelect) {
                    const selectedOption = sectorSelect.options[sectorSelect.selectedIndex];
                    if (selectedOption && selectedOption.value === 'Finance') {
                        if (typeof updateIosVaptFollowUpSubSectorOptions === 'function') {
                            updateIosVaptFollowUpSubSectorOptions();
                        }
                    }
                }

                const auditeeSelect = document.getElementById('iosVaptFollowUpMetaAuditeeOrg');
                if (auditeeSelect && typeof toggleIosVaptFollowUpOtherField === 'function') {
                    toggleIosVaptFollowUpOtherField('iosVaptFollowUpMetaAuditeeOrg', 'iosVaptFollowUpMetaAuditeeOrgOther');
                }

                const auditTypeSelect = document.getElementById('iosVaptFollowUpMetaTypeAudit');
                if (auditTypeSelect) {
                    auditTypeSelect.value = 'VAPT-Infrastructure';
                    if (typeof toggleIosVaptFollowUpOtherField === 'function') {
                        toggleIosVaptFollowUpOtherField('iosVaptFollowUpMetaTypeAudit', 'iosVaptFollowUpMetaTypeAuditOther');
                    }
                }
            }, 50);
        }

        // Handle default values for Infrastructure VAPT Follow Up Audit MetaData modal
        if (modalId === 'vaptFollowUpAuditMetaDataModal') {
            setTimeout(() => {
                const sectorSelect = document.getElementById('vaptFollowUpMetaSectorOrg');
                if (sectorSelect) {
                    const selectedOption = sectorSelect.options[sectorSelect.selectedIndex];
                    if (selectedOption && selectedOption.value === 'Finance') {
                        if (typeof updateVaptFollowUpSubSectorOptions === 'function') {
                            updateVaptFollowUpSubSectorOptions();
                        }
                    }
                }
            }, 50);
        }

        // Handle default values for Public IP VAPT Follow Up Audit MetaData modal
        if (modalId === 'publicIpFollowUpAuditMetaDataModal') {
            setTimeout(() => {
                const sectorSelect = document.getElementById('publicIpFollowUpMetaSectorOrg');
                if (sectorSelect) {
                    const selectedOption = sectorSelect.options[sectorSelect.selectedIndex];
                    if (selectedOption && selectedOption.value === 'Finance') {
                        if (typeof updatePublicIpFollowUpSubSectorOptions === 'function') {
                            updatePublicIpFollowUpSubSectorOptions();
                        }
                    }
                }
            }, 50);
        }

        // Handle default values for Android Mobile Application VAPT Follow Up Audit MetaData modal
        if (modalId === 'androidVaptFollowUpAuditMetaDataModal') {
            setTimeout(() => {
                const sectorSelect = document.getElementById('androidVaptFollowUpMetaSectorOrg');
                if (sectorSelect) {
                    const selectedOption = sectorSelect.options[sectorSelect.selectedIndex];
                    if (selectedOption && selectedOption.value === 'Finance') {
                        if (typeof updateAndroidVaptFollowUpSubSectorOptions === 'function') {
                            updateAndroidVaptFollowUpSubSectorOptions();
                        }
                    }
                }
            }, 50);
        }

        // Handle default values for API VAPT Follow Up Audit MetaData modal
        if (modalId === 'apiFollowUpAuditMetaDataModal') {
            setTimeout(() => {
                const sectorSelect = document.getElementById('apiFollowUpMetaSectorOrg');
                if (sectorSelect) {
                    const selectedOption = sectorSelect.options[sectorSelect.selectedIndex];
                    if (selectedOption && selectedOption.value === 'Finance') {
                        if (typeof updateApiFollowUpSubSectorOptions === 'function') {
                            updateApiFollowUpSubSectorOptions();
                        }
                    }
                }
            }, 50);
        }
    }
    
    function closeVaptModal(modalId) {
        const modal = document.getElementById(modalId);
        if (modal) {
            modal.style.display = 'none';
            // Reset form if exists
            const form = modal.querySelector('form');
            if (form) {
                form.reset();
                
                // Determine which container IDs to use based on modal ID
                let emailContainerId, teamContainerId;
                if (modalId === 'publicIpFirstAuditModal') {
                    emailContainerId = 'publicIpEmailContainer';
                    teamContainerId = 'publicIpAuditTeamContainer';
                } else if (modalId === 'publicIpFollowUpAuditModal') {
                    emailContainerId = 'publicIpFollowUpEmailContainer';
                    teamContainerId = 'publicIpFollowUpAuditTeamContainer';
                } else if (modalId === 'androidAppFirstAuditModal') {
                    emailContainerId = 'androidAppEmailContainer';
                    teamContainerId = 'androidAppAuditTeamContainer';
                } else if (modalId === 'androidAppFollowUpAuditModal') {
                    emailContainerId = null;
                    teamContainerId = null;
                } else if (modalId === 'iosAppFirstAuditModal') {
                    emailContainerId = 'iosAppEmailContainer';
                    teamContainerId = 'iosAppAuditTeamContainer';
                } else if (modalId === 'iosAppFollowUpAuditModal') {
                    emailContainerId = null;
                    teamContainerId = null;
                } else if (modalId === 'apiFirstAuditModal') {
                    emailContainerId = 'apiEmailContainer';
                    teamContainerId = 'apiAuditTeamContainer';
                } else if (modalId === 'webAppFirstAuditModal') {
                    emailContainerId = 'webAppEmailContainer';
                    teamContainerId = 'webAppAuditTeamContainer';
                } else if (modalId === 'webAppFollowUpAuditModal') {
                    emailContainerId = null;
                    teamContainerId = null;
                } else if (modalId === 'webAppVaptFollowUpAuditMetaDataModal') {
                    emailContainerId = null;
                    teamContainerId = null;
                } else if (modalId === 'iosVaptFollowUpAuditMetaDataModal') {
                    emailContainerId = null;
                    teamContainerId = null;
                } else {
                    emailContainerId = 'vaptEmailContainer';
                    teamContainerId = 'vaptAuditTeamContainer';
                }
                
                // Reset dynamic fields
                const emailContainer = document.getElementById(emailContainerId);
                if (emailContainerId && emailContainer) {
                    emailContainer.innerHTML = '<input type="email" name="bankEmail[]" placeholder="Email Address" required>';
                }
                const teamContainer = teamContainerId ? document.getElementById(teamContainerId) : null;
                if (teamContainerId && teamContainer) {
                    const firstMember = teamContainer.querySelector('.team-member');
                    teamContainer.innerHTML = '';
                    if (firstMember) {
                        teamContainer.appendChild(firstMember.cloneNode(true));
                    }
                }
                
                // Reset vulnerability container for web app modal
                if (modalId === 'androidAppFirstAuditModal') {
                    const androidAssetContainer = document.getElementById('androidAppAssetContainer');
                    if (androidAssetContainer) {
                        const firstAsset = androidAssetContainer.querySelector('.android-asset-entry');
                        androidAssetContainer.innerHTML = '';
                        if (firstAsset) {
                            androidAssetContainer.appendChild(firstAsset.cloneNode(true));
                        }
                    }
                    const androidVulnContainer = document.getElementById('androidAppVulnerabilityContainer');
                    if (androidVulnContainer) {
                        const firstVuln = androidVulnContainer.querySelector('.vulnerability-entry');
                        androidVulnContainer.innerHTML = '';
                        if (firstVuln) {
                            androidVulnContainer.appendChild(firstVuln.cloneNode(true));
                        }
                    }
                } else if (modalId === 'apiFollowUpAuditModal') {
                    // Reset form - no special handling needed for simplified form
                } else if (modalId === 'iosAppFirstAuditModal') {
                    const iosAssetContainer = document.getElementById('iosAppAssetContainer');
                    if (iosAssetContainer) {
                        const firstAsset = iosAssetContainer.querySelector('.ios-asset-entry');
                        iosAssetContainer.innerHTML = '';
                        if (firstAsset) {
                            iosAssetContainer.appendChild(firstAsset.cloneNode(true));
                        }
                    }
                    const iosVulnContainer = document.getElementById('iosAppVulnerabilityContainer');
                    if (iosVulnContainer) {
                        const firstVuln = iosVulnContainer.querySelector('.vulnerability-entry');
                        iosVulnContainer.innerHTML = '';
                        if (firstVuln) {
                            iosVulnContainer.appendChild(firstVuln.cloneNode(true));
                        }
                    }
                } else if (modalId === 'apiFirstAuditModal') {
                    const apiAssetContainer = document.getElementById('apiAssetContainer');
                    if (apiAssetContainer) {
                        const firstAsset = apiAssetContainer.querySelector('.api-asset-entry');
                        apiAssetContainer.innerHTML = '';
                        if (firstAsset) {
                            apiAssetContainer.appendChild(firstAsset.cloneNode(true));
                        }
                    }
                    const apiVulnContainer = document.getElementById('apiFirstAuditVulnerabilityContainer');
                    if (apiVulnContainer) {
                        const firstVuln = apiVulnContainer.querySelector('.vulnerability-entry');
                        apiVulnContainer.innerHTML = '';
                        if (firstVuln) {
                            apiVulnContainer.appendChild(firstVuln.cloneNode(true));
                        }
                    }
                } else if (modalId === 'webAppFirstAuditModal') {
                    const vulnContainer = document.getElementById('webAppVulnerabilityContainer');
                    if (vulnContainer) {
                        const firstVuln = vulnContainer.querySelector('.vulnerability-entry');
                        vulnContainer.innerHTML = '';
                        if (firstVuln) {
                            vulnContainer.appendChild(firstVuln.cloneNode(true));
                        }
                    }
                    const assetContainer = document.getElementById('webAppAssetContainer');
                    if (assetContainer) {
                        const firstAsset = assetContainer.querySelector('.asset-entry');
                        assetContainer.innerHTML = '';
                        if (firstAsset) {
                            assetContainer.appendChild(firstAsset.cloneNode(true));
                        }
                    }
                    const internalRadio = document.getElementById('webAppApplicationTypeInternal');
                    const externalRadio = document.getElementById('webAppApplicationTypeExternal');
                    if (internalRadio) {
                        internalRadio.checked = true;
                    }
                    if (externalRadio) {
                        externalRadio.checked = false;
                    }
                    if (typeof updateWebAppAssetIpLabels === 'function') {
                        updateWebAppAssetIpLabels();
                    }
                }
                
                // Reset containers for Web Application VAPT First Audit MetaData modal
                if (modalId === 'webAppVaptFirstAuditMetaDataModal') {
                    const webAppMetaVulnContainer = document.getElementById('webAppVaptVulnerabilityContainer');
                    if (webAppMetaVulnContainer) {
                        const firstVuln = webAppMetaVulnContainer.querySelector('.vulnerability-entry');
                        webAppMetaVulnContainer.innerHTML = '';
                        if (firstVuln) {
                            webAppMetaVulnContainer.appendChild(firstVuln.cloneNode(true));
                        }
                    }
                    
                    const webAppMetaEmpContainer = document.getElementById('webAppVaptEmployeeContainer');
                    if (webAppMetaEmpContainer) {
                        const firstEmp = webAppMetaEmpContainer.querySelector('.employee-entry');
                        webAppMetaEmpContainer.innerHTML = '';
                        if (firstEmp) {
                            webAppMetaEmpContainer.appendChild(firstEmp.cloneNode(true));
                        }
                    }
                    if (typeof webAppVaptVulnEntryCount !== 'undefined') {
                        webAppVaptVulnEntryCount = 1;
                    }
                    if (typeof webAppVaptEmpEntryCount !== 'undefined') {
                        webAppVaptEmpEntryCount = 1;
                    }
                }
                
                if (modalId === 'androidVaptFirstAuditMetaDataModal') {
                    const androidMetaVulnContainer = document.getElementById('androidVaptVulnerabilityContainer');
                    if (androidMetaVulnContainer) {
                        const firstVuln = androidMetaVulnContainer.querySelector('.vulnerability-entry');
                        androidMetaVulnContainer.innerHTML = '';
                        if (firstVuln) {
                            androidMetaVulnContainer.appendChild(firstVuln.cloneNode(true));
                        }
                    }
                    
                    const androidMetaEmpContainer = document.getElementById('androidVaptEmployeeContainer');
                    if (androidMetaEmpContainer) {
                        const firstEmp = androidMetaEmpContainer.querySelector('.employee-entry');
                        androidMetaEmpContainer.innerHTML = '';
                        if (firstEmp) {
                            androidMetaEmpContainer.appendChild(firstEmp.cloneNode(true));
                        }
                    }
                    if (typeof androidVaptVulnEntryCount !== 'undefined') {
                        androidVaptVulnEntryCount = 1;
                    }
                    if (typeof androidVaptEmpEntryCount !== 'undefined') {
                        androidVaptEmpEntryCount = 1;
                    }
                }
                
                if (modalId === 'iosVaptFirstAuditMetaDataModal') {
                    const iosMetaVulnContainer = document.getElementById('iosVaptVulnerabilityContainer');
                    if (iosMetaVulnContainer) {
                        const firstVuln = iosMetaVulnContainer.querySelector('.vulnerability-entry');
                        iosMetaVulnContainer.innerHTML = '';
                        if (firstVuln) {
                            iosMetaVulnContainer.appendChild(firstVuln.cloneNode(true));
                        }
                    }
                    
                    const iosMetaEmpContainer = document.getElementById('iosVaptEmployeeContainer');
                    if (iosMetaEmpContainer) {
                        const firstEmp = iosMetaEmpContainer.querySelector('.employee-entry');
                        iosMetaEmpContainer.innerHTML = '';
                        if (firstEmp) {
                            iosMetaEmpContainer.appendChild(firstEmp.cloneNode(true));
                        }
                    }
                    if (typeof iosVaptVulnEntryCount !== 'undefined') {
                        iosVaptVulnEntryCount = 1;
                    }
                    if (typeof iosVaptEmpEntryCount !== 'undefined') {
                        iosVaptEmpEntryCount = 1;
                    }
                }
                
                if (modalId === 'webAppVaptFollowUpAuditMetaDataModal') {
                    const webAppFollowUpVulnContainer = document.getElementById('webAppVaptFollowUpVulnerabilityContainer');
                    if (webAppFollowUpVulnContainer) {
                        const firstVuln = webAppFollowUpVulnContainer.querySelector('.vulnerability-entry');
                        webAppFollowUpVulnContainer.innerHTML = '';
                        if (firstVuln) {
                            webAppFollowUpVulnContainer.appendChild(firstVuln.cloneNode(true));
                        }
                    }

                    const webAppFollowUpEmpContainer = document.getElementById('webAppVaptFollowUpEmployeeContainer');
                    if (webAppFollowUpEmpContainer) {
                        const firstEmp = webAppFollowUpEmpContainer.querySelector('.employee-entry');
                        webAppFollowUpEmpContainer.innerHTML = '';
                        if (firstEmp) {
                            webAppFollowUpEmpContainer.appendChild(firstEmp.cloneNode(true));
                        }
                    }

                    if (typeof webAppVaptFollowUpVulnEntryCount !== 'undefined') {
                        webAppVaptFollowUpVulnEntryCount = 1;
                    }
                    if (typeof webAppVaptFollowUpEmpEntryCount !== 'undefined') {
                        webAppVaptFollowUpEmpEntryCount = 1;
                    }

                    const webAppFollowUpOtherFields = [
                        'webAppVaptFollowUpMetaAuditeeOrgOther',
                        'webAppVaptFollowUpMetaTypeAuditOther'
                    ];
                    webAppFollowUpOtherFields.forEach(fieldId => {
                        const field = document.getElementById(fieldId);
                        if (field) {
                            field.style.display = 'none';
                            field.required = false;
                            field.value = '';
                        }
                    });
                }
                
                if (modalId === 'iosVaptFollowUpAuditMetaDataModal') {
                    const iosFollowUpVulnContainer = document.getElementById('iosVaptFollowUpVulnerabilityContainer');
                    if (iosFollowUpVulnContainer) {
                        const firstVuln = iosFollowUpVulnContainer.querySelector('.vulnerability-entry');
                        iosFollowUpVulnContainer.innerHTML = '';
                        if (firstVuln) {
                            iosFollowUpVulnContainer.appendChild(firstVuln.cloneNode(true));
                        }
                    }

                    const iosFollowUpEmpContainer = document.getElementById('iosVaptFollowUpEmployeeContainer');
                    if (iosFollowUpEmpContainer) {
                        const firstEmp = iosFollowUpEmpContainer.querySelector('.employee-entry');
                        iosFollowUpEmpContainer.innerHTML = '';
                        if (firstEmp) {
                            iosFollowUpEmpContainer.appendChild(firstEmp.cloneNode(true));
                        }
                    }

                    if (typeof iosVaptFollowUpVulnEntryCount !== 'undefined') {
                        iosVaptFollowUpVulnEntryCount = 1;
                    }
                    if (typeof iosVaptFollowUpEmpEntryCount !== 'undefined') {
                        iosVaptFollowUpEmpEntryCount = 1;
                    }

                    const iosFollowUpOtherFields = [
                        'iosVaptFollowUpMetaAuditeeOrgOther',
                        'iosVaptFollowUpMetaTypeAuditOther'
                    ];
                    iosFollowUpOtherFields.forEach(fieldId => {
                        const field = document.getElementById(fieldId);
                        if (field) {
                            field.style.display = 'none';
                            field.required = false;
                            field.value = '';
                        }
                    });
                }
                
                // Reset containers for Website VAPT First Audit MetaData modal
                if (modalId === 'websiteVaptFirstAuditMetaDataModal') {
                    const websiteMetaVulnContainer = document.getElementById('websiteVaptVulnerabilityContainer');
                    if (websiteMetaVulnContainer) {
                        const firstVuln = websiteMetaVulnContainer.querySelector('.vulnerability-entry');
                        websiteMetaVulnContainer.innerHTML = '';
                        if (firstVuln) {
                            websiteMetaVulnContainer.appendChild(firstVuln.cloneNode(true));
                        }
                    }
                    
                    const websiteMetaEmpContainer = document.getElementById('websiteVaptEmployeeContainer');
                    if (websiteMetaEmpContainer) {
                        const firstEmp = websiteMetaEmpContainer.querySelector('.employee-entry');
                        websiteMetaEmpContainer.innerHTML = '';
                        if (firstEmp) {
                            websiteMetaEmpContainer.appendChild(firstEmp.cloneNode(true));
                        }
                    }
                    if (typeof websiteVaptVulnEntryCount !== 'undefined') {
                        websiteVaptVulnEntryCount = 1;
                    }
                    if (typeof websiteVaptEmpEntryCount !== 'undefined') {
                        websiteVaptEmpEntryCount = 1;
                    }
                }
                
                // Reset submit button
                const submitBtn = form.querySelector('button[type="submit"]');
                if (submitBtn) {
                    submitBtn.disabled = false;
                    submitBtn.style.opacity = '1';
                    submitBtn.style.cursor = 'pointer';
                    
                    if (modalId === 'webAppVaptFirstAuditMetaDataModal' || modalId === 'websiteVaptFirstAuditMetaDataModal' || modalId === 'androidVaptFirstAuditMetaDataModal' || modalId === 'iosVaptFirstAuditMetaDataModal' || modalId === 'webAppVaptFollowUpAuditMetaDataModal' || modalId === 'iosVaptFollowUpAuditMetaDataModal') {
                        submitBtn.innerHTML = '<i class="fas fa-check"></i> Submit';
                    } else {
                        submitBtn.textContent = 'Submit Report';
                    }
                }
            }
        }
    }
    
    function getWebAppApplicationType() {
        const form = document.getElementById('webAppFirstAuditForm');
        if (!form) {
            return 'Internal';
        }
        const selected = form.querySelector('input[name="applicationType"]:checked');
        return selected ? selected.value : 'Internal';
    }

    function updateWebAppAssetIpLabels() {
        const assetContainer = document.getElementById('webAppAssetContainer');
        if (!assetContainer) {
            return;
        }
        const isExternal = getWebAppApplicationType() === 'External';
        const labelText = isExternal ? 'External IP Address*' : 'Internal IP Addresses*';
        const placeholderText = isExternal ? 'Enter external IP address(es)' : 'Enter internal IP addresses';
        assetContainer.querySelectorAll('.asset-entry').forEach(entry => {
            const labelSpan = entry.querySelector('.webAppAssetIpLabel');
            if (labelSpan) {
                labelSpan.textContent = labelText;
            }
            const ipInput = entry.querySelector('.webAppAssetIpInput');
            if (ipInput) {
                ipInput.placeholder = placeholderText;
            }
        });
    }
    
    // Toggle other input fields
    function toggleVaptOtherInput(selectId, inputId) {
        const selectElement = document.getElementById(selectId);
        const inputElement = document.getElementById(inputId);
        
        if (!selectElement || !inputElement) {
            console.error('toggleVaptOtherInput: Element not found', { selectId, inputId });
            return;
        }
        
        if (selectElement.value === 'other') {
            inputElement.classList.remove('hidden');
            inputElement.style.display = 'block';
            inputElement.required = true;
        } else {
            inputElement.classList.add('hidden');
            inputElement.style.display = 'none';
            inputElement.required = false;
            inputElement.value = '';
        }
    }
    
    // Add email functionality
    document.addEventListener('DOMContentLoaded', function() {
        // First Audit - Add Email
        const addEmailBtn = document.getElementById('vaptAddEmailBtn');
        if (addEmailBtn) {
            addEmailBtn.addEventListener('click', function() {
                const emailContainer = document.getElementById('vaptEmailContainer');
                const newEmailField = document.createElement('div');
                newEmailField.style.display = 'flex';
                newEmailField.style.gap = '10px';
                newEmailField.style.marginTop = '10px';
                newEmailField.innerHTML = `
                    <input type="email" name="bankEmail[]" placeholder="Email Address" required style="flex: 1;">
                    <button type="button" onclick="removeVaptEmailField(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; cursor: pointer;">Remove</button>
                `;
                emailContainer.appendChild(newEmailField);
            });
        }
        
        // First Audit - Add Team Member
        const addMemberBtn = document.getElementById('vaptAddMemberBtn');
        if (addMemberBtn) {
            addMemberBtn.addEventListener('click', function() {
                const teamContainer = document.getElementById('vaptAuditTeamContainer');
                const teamMembers = teamContainer.querySelectorAll('.team-member');
                
                if (teamMembers.length >= 8) {
                    alert('Maximum 8 team members allowed');
                    return;
                }
                
                const newIndex = teamMembers.length;
                const newMember = document.createElement('div');
                newMember.className = 'team-member';
                newMember.setAttribute('data-index', newIndex);
                newMember.innerHTML = `
                    <div class="form-row">
                        <div class="form-group">
                            <input type="text" name="teamName[]" placeholder="Name*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamQualification[]" placeholder="Qualification/Certification*" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Certified (Yes/No)*</label>
                        <div class="radio-group">
                            <label><input type="radio" name="teamCertified[${newIndex}]" value="yes" required> Yes</label>
                            <label><input type="radio" name="teamCertified[${newIndex}]" value="no"> No</label>
                        </div>
                    </div>
                    <button type="button" onclick="removeVaptTeamMember(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; margin-top: 10px; cursor: pointer;">Remove Member</button>
                `;
                teamContainer.appendChild(newMember);
            });
        }
        
        // Follow-up Audit - Add Email
        const addFollowUpEmailBtn = document.getElementById('vaptAddFollowUpEmailBtn');
        if (addFollowUpEmailBtn) {
            addFollowUpEmailBtn.addEventListener('click', function() {
                const emailContainer = document.getElementById('vaptFollowUpEmailContainer');
                const newEmailField = document.createElement('div');
                newEmailField.style.display = 'flex';
                newEmailField.style.gap = '10px';
                newEmailField.style.marginTop = '10px';
                newEmailField.innerHTML = `
                    <input type="email" name="bankEmail[]" placeholder="Email Address" required style="flex: 1;">
                    <button type="button" onclick="removeVaptEmailField(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; cursor: pointer;">Remove</button>
                `;
                emailContainer.appendChild(newEmailField);
            });
        }
        
        // Follow-up Audit - Add Team Member
        const addFollowUpMemberBtn = document.getElementById('vaptAddFollowUpMemberBtn');
        if (addFollowUpMemberBtn) {
            addFollowUpMemberBtn.addEventListener('click', function() {
                const teamContainer = document.getElementById('vaptFollowUpAuditTeamContainer');
                const teamMembers = teamContainer.querySelectorAll('.team-member');
                
                if (teamMembers.length >= 8) {
                    alert('Maximum 8 team members allowed');
                    return;
                }
                
                const newIndex = teamMembers.length;
                const newMember = document.createElement('div');
                newMember.className = 'team-member';
                newMember.setAttribute('data-index', newIndex);
                newMember.innerHTML = `
                    <div class="form-row">
                        <div class="form-group">
                            <input type="text" name="teamName[]" placeholder="Name*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamQualification[]" placeholder="Qualification/Certification*" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Certified (Yes/No)*</label>
                        <div class="radio-group">
                            <label><input type="radio" name="teamCertified[${newIndex}]" value="yes" required> Yes</label>
                            <label><input type="radio" name="teamCertified[${newIndex}]" value="no"> No</label>
                        </div>
                    </div>
                    <button type="button" onclick="removeVaptTeamMember(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; margin-top: 10px; cursor: pointer;">Remove Member</button>
                `;
                teamContainer.appendChild(newMember);
            });
        }
        
        // Website VAPT Follow-up Add Email functionality
        const websiteVaptAddFollowUpEmailBtn = document.getElementById('websiteVaptAddFollowUpEmailBtn');
        if (websiteVaptAddFollowUpEmailBtn) {
            websiteVaptAddFollowUpEmailBtn.addEventListener('click', function() {
                const container = document.getElementById('websiteVaptFollowUpEmailContainer');
                const emailDiv = document.createElement('div');
                emailDiv.style.display = 'flex';
                emailDiv.style.gap = '10px';
                emailDiv.style.marginTop = '10px';
                emailDiv.innerHTML = `
                    <input type="email" name="bankEmail[]" placeholder="Email Address" required style="flex: 1;">
                    <button type="button" onclick="removeVaptEmailField(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; cursor: pointer;">Remove</button>
                `;
                container.appendChild(emailDiv);
            });
        }

        // Website VAPT Follow-up Add Team Member functionality
        const websiteVaptAddFollowUpMemberBtn = document.getElementById('websiteVaptAddFollowUpMemberBtn');
        if (websiteVaptAddFollowUpMemberBtn) {
            websiteVaptAddFollowUpMemberBtn.addEventListener('click', function() {
                const container = document.getElementById('websiteVaptFollowUpAuditTeamContainer');
                const teamMembers = container.querySelectorAll('.team-member');
                
                if (teamMembers.length >= 8) {
                    alert('Maximum 8 team members allowed');
                    return;
                }
                
                const newIndex = teamMembers.length;
                const memberDiv = document.createElement('div');
                memberDiv.className = 'team-member';
                memberDiv.setAttribute('data-index', newIndex);
                
                memberDiv.innerHTML = `
                    <div class="form-row">
                        <div class="form-group">
                            <input type="text" name="teamName[]" placeholder="Name*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamQualification[]" placeholder="Qualification/Certification*" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Certified (Yes/No)*</label>
                        <div class="radio-group">
                            <label><input type="radio" name="teamCertified[${newIndex}]" value="yes" required> Yes</label>
                            <label><input type="radio" name="teamCertified[${newIndex}]" value="no"> No</label>
                        </div>
                    </div>
                    <button type="button" onclick="removeWebsiteVaptFollowUpTeamMember(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; margin-top: 10px; cursor: pointer;">Remove Member</button>
                `;
                
                container.appendChild(memberDiv);
            });
        }
    });
    
    // Website VAPT Follow Up Audit Certificate Form Handler
    document.addEventListener('DOMContentLoaded', function() {
        const websiteVaptFollowUpAuditCertificateForm = document.getElementById('websiteVaptFollowUpAuditCertificateForm');
        if (websiteVaptFollowUpAuditCertificateForm) {
            websiteVaptFollowUpAuditCertificateForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                
                // Handle organization name (combo-input logic)
                let organization_name = formData.get('organizationName');
                if (organization_name === 'other') {
                    organization_name = formData.get('otherOrganizationName');
                    if (!organization_name || organization_name.trim() === '') {
                        alert('Please enter the organization name');
                        return;
                    }
                }
                
                // Handle city (combo-input logic)
                let city = formData.get('city');
                if (city === 'other') {
                    city = formData.get('otherCity');
                    if (!city || city.trim() === '') {
                        alert('Please enter the city name');
                        return;
                    }
                }
                
                // Handle state (combo-input logic)
                let state = formData.get('state');
                if (state === 'other') {
                    state = formData.get('otherState');
                    if (!state || state.trim() === '') {
                        alert('Please enter the state name');
                        return;
                    }
                }
                
                // Validate required fields
                const requiredFields = ['auditeeDesignation', 'scope', 'startAuditDate', 'endAuditDate', 'firstReportId', 'reportId'];
                for (const field of requiredFields) {
                    if (!formData.get(field) || formData.get(field).trim() === '') {
                        alert(`Please fill in the ${field.replace(/([A-Z])/g, ' $1').toLowerCase()}`);
                        return;
                    }
                }
                
                // Validate combo-input fields
                if (!organization_name || organization_name.trim() === '') {
                    alert('Please select or enter an organization name');
                    return;
                }
                
                if (!city || city.trim() === '') {
                    alert('Please select or enter a city');
                    return;
                }
                
                if (!state || state.trim() === '') {
                    alert('Please select or enter a state');
                    return;
                }
                
                // Validate date range
                const startDate = new Date(formData.get('startAuditDate'));
                const endDate = new Date(formData.get('endAuditDate'));
                if (startDate >= endDate) {
                    alert('End Audit Date must be after Start Audit Date');
                    return;
                }
                
                // Disable submit button to prevent multiple submissions
                const submitBtn = this.querySelector('button[type="submit"]');
                const originalText = submitBtn ? submitBtn.textContent : 'Generate Certificate';
                if (submitBtn) {
                    submitBtn.disabled = true;
                    submitBtn.textContent = 'Processing...';
                    submitBtn.style.opacity = '0.6';
                    submitBtn.style.cursor = 'not-allowed';
                }
                
                // Prepare form data with correct combo-input values
                const submitFormData = new FormData();
                submitFormData.append('organizationName', organization_name);
                submitFormData.append('city', city);
                submitFormData.append('state', state);
                submitFormData.append('auditeeDesignation', formData.get('auditeeDesignation'));
                submitFormData.append('scope', formData.get('scope'));
                submitFormData.append('startAuditDate', formData.get('startAuditDate'));
                submitFormData.append('endAuditDate', formData.get('endAuditDate'));
                submitFormData.append('firstReportId', formData.get('firstReportId'));
                submitFormData.append('reportId', formData.get('reportId'));
                
                fetch('/process_website_vapt_follow_up_audit_certificate', {
                    method: 'POST',
                    body: submitFormData
                })
                .then(response => {
                    if (response.ok) {
                        return response.blob().then(blob => {
                            // Download the certificate file
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.href = url;
                            a.download = 'Website_VAPT_Follow_Up_Certificate.docx';
                            document.body.appendChild(a);
                            a.click();
                            window.URL.revokeObjectURL(url);
                            document.body.removeChild(a);
                            
                            // Close modal
                            closeVaptModal('websiteVaptFollowUpAuditCertificateModal');
                            
                            // Reset form
                            this.reset();
                            
                            // Refresh the page after a short delay to ensure download completes
                            setTimeout(() => {
                                window.location.reload();
                            }, 1000);
                        });
                    } else {
                        return response.json().then(data => {
                            throw new Error(data.error || 'Network response was not ok');
                        });
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Error: ' + error.message);
                    if (submitBtn) {
                        submitBtn.disabled = false;
                        submitBtn.textContent = originalText;
                        submitBtn.style.opacity = '1';
                        submitBtn.style.cursor = 'pointer';
                    }
                });
            });
        }
    });
    
    // API VAPT Follow Up Audit Certificate Form Handler
    document.addEventListener('DOMContentLoaded', function() {
        const apiVaptFollowUpAuditCertificateForm = document.getElementById('apiVaptFollowUpAuditCertificateForm');
        if (apiVaptFollowUpAuditCertificateForm) {
            apiVaptFollowUpAuditCertificateForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                
                // Handle organization name (combo-input logic)
                let organization_name = formData.get('organizationName');
                if (organization_name === 'other') {
                    organization_name = formData.get('otherOrganizationName');
                    if (!organization_name || organization_name.trim() === '') {
                        alert('Please enter the organization name');
                        return;
                    }
                }
                
                // Handle city (combo-input logic)
                let city = formData.get('city');
                if (city === 'other') {
                    city = formData.get('otherCity');
                    if (!city || city.trim() === '') {
                        alert('Please enter the city name');
                        return;
                    }
                }
                
                // Handle state (combo-input logic)
                let state = formData.get('state');
                if (state === 'other') {
                    state = formData.get('otherState');
                    if (!state || state.trim() === '') {
                        alert('Please enter the state name');
                        return;
                    }
                }
                
                // Validate required fields
                const requiredFields = ['auditeeDesignation', 'scope', 'startAuditDate', 'endAuditDate', 'firstReportId', 'reportId'];
                for (const field of requiredFields) {
                    if (!formData.get(field) || formData.get(field).trim() === '') {
                        alert(`Please fill out the ${field} field`);
                        return;
                    }
                }
                
                // Validate date logic
                const startDate = new Date(formData.get('startAuditDate'));
                const endDate = new Date(formData.get('endAuditDate'));
                if (startDate >= endDate) {
                    alert('End Audit Date must be after Start Audit Date');
                    return;
                }
                
                // Disable submit button to prevent multiple submissions
                const submitBtn = this.querySelector('button[type="submit"]');
                const originalText = submitBtn ? submitBtn.textContent : 'Generate Certificate';
                if (submitBtn) {
                    submitBtn.disabled = true;
                    submitBtn.textContent = 'Processing...';
                    submitBtn.style.opacity = '0.6';
                    submitBtn.style.cursor = 'not-allowed';
                }
                
                // Prepare form data with correct combo-input values
                const submitFormData = new FormData();
                submitFormData.append('organizationName', organization_name);
                submitFormData.append('city', city);
                submitFormData.append('state', state);
                submitFormData.append('auditeeDesignation', formData.get('auditeeDesignation'));
                submitFormData.append('scope', formData.get('scope'));
                submitFormData.append('startAuditDate', formData.get('startAuditDate'));
                submitFormData.append('endAuditDate', formData.get('endAuditDate'));
                submitFormData.append('firstReportId', formData.get('firstReportId'));
                submitFormData.append('reportId', formData.get('reportId'));
                
                fetch('/process_api_vapt_follow_up_audit_certificate', {
                    method: 'POST',
                    body: submitFormData
                })
                .then(response => {
                    if (response.ok) {
                        return response.blob().then(blob => {
                            // Download the certificate file
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.href = url;
                            a.download = 'API_VAPT_Follow_Up_Certificate.docx';
                            document.body.appendChild(a);
                            a.click();
                            window.URL.revokeObjectURL(url);
                            document.body.removeChild(a);
                            
                            // Close modal
                            closeVaptModal('apiVaptFollowUpAuditCertificateModal');
                            
                            // Reset form
                            this.reset();
                            
                            // Refresh the page after a short delay to ensure download completes
                            setTimeout(() => {
                                window.location.reload();
                            }, 1000);
                        });
                    } else {
                        return response.json().then(data => {
                            throw new Error(data.error || 'Network response was not ok');
                        });
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Error: ' + error.message);
                    if (submitBtn) {
                        submitBtn.disabled = false;
                        submitBtn.textContent = originalText;
                        submitBtn.style.opacity = '1';
                        submitBtn.style.cursor = 'pointer';
                    }
                });
            });
        }
    });
    
    // Public IP VAPT Follow Up Audit Certificate Form Handler
    document.addEventListener('DOMContentLoaded', function() {
        const publicIpVaptFollowUpAuditCertificateForm = document.getElementById('publicIpVaptFollowUpAuditCertificateForm');
        if (publicIpVaptFollowUpAuditCertificateForm) {
            publicIpVaptFollowUpAuditCertificateForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                
                // Handle organization name (combo-input logic)
                let organization_name = formData.get('organizationName');
                if (organization_name === 'other') {
                    organization_name = formData.get('otherOrganizationName');
                    if (!organization_name || organization_name.trim() === '') {
                        alert('Please enter the organization name');
                        return;
                    }
                }
                
                // Handle city (combo-input logic)
                let city = formData.get('city');
                if (city === 'other') {
                    city = formData.get('otherCity');
                    if (!city || city.trim() === '') {
                        alert('Please enter the city name');
                        return;
                    }
                }
                
                // Handle state (combo-input logic)
                let state = formData.get('state');
                if (state === 'other') {
                    state = formData.get('otherState');
                    if (!state || state.trim() === '') {
                        alert('Please enter the state name');
                        return;
                    }
                }
                
                // Validate required fields
                const requiredFields = ['auditeeDesignation', 'scope', 'startAuditDate', 'endAuditDate', 'firstReportId', 'reportId'];
                for (const field of requiredFields) {
                    if (!formData.get(field) || formData.get(field).trim() === '') {
                        alert(`Please fill in the ${field.replace(/([A-Z])/g, ' $1').toLowerCase()}`);
                        return;
                    }
                }
                
                // Validate combo-input fields
                if (!organization_name || organization_name.trim() === '') {
                    alert('Please select or enter an organization name');
                    return;
                }
                
                if (!city || city.trim() === '') {
                    alert('Please select or enter a city');
                    return;
                }
                
                if (!state || state.trim() === '') {
                    alert('Please select or enter a state');
                    return;
                }
                
                // Validate date range
                const startDate = new Date(formData.get('startAuditDate'));
                const endDate = new Date(formData.get('endAuditDate'));
                if (startDate >= endDate) {
                    alert('End Audit Date must be after Start Audit Date');
                    return;
                }
                
                // Disable submit button to prevent multiple submissions
                const submitBtn = this.querySelector('button[type="submit"]');
                const originalText = submitBtn ? submitBtn.textContent : 'Generate Certificate';
                if (submitBtn) {
                    submitBtn.disabled = true;
                    submitBtn.textContent = 'Processing...';
                    submitBtn.style.opacity = '0.6';
                    submitBtn.style.cursor = 'not-allowed';
                }
                
                // Prepare form data with correct combo-input values
                const submitFormData = new FormData();
                submitFormData.append('organizationName', organization_name);
                submitFormData.append('city', city);
                submitFormData.append('state', state);
                submitFormData.append('auditeeDesignation', formData.get('auditeeDesignation'));
                submitFormData.append('scope', formData.get('scope'));
                submitFormData.append('startAuditDate', formData.get('startAuditDate'));
                submitFormData.append('endAuditDate', formData.get('endAuditDate'));
                submitFormData.append('firstReportId', formData.get('firstReportId'));
                submitFormData.append('reportId', formData.get('reportId'));
                
                fetch('/process_public_ip_vapt_follow_up_audit_certificate', {
                    method: 'POST',
                    body: submitFormData
                })
                .then(response => {
                    if (response.ok) {
                        return response.blob().then(blob => {
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.href = url;
                            a.download = 'Public_IP_VAPT_Follow_Up_Certificate.docx';
                            document.body.appendChild(a);
                            a.click();
                            window.URL.revokeObjectURL(url);
                            document.body.removeChild(a);
                            
                            closeVaptModal('publicIpVaptFollowUpAuditCertificateModal');
                            this.reset();
                            
                            setTimeout(() => {
                                window.location.reload();
                            }, 1000);
                        });
                    } else {
                        return response.json().then(data => {
                            throw new Error(data.error || 'Network response was not ok');
                        });
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Error: ' + error.message);
                    if (submitBtn) {
                        submitBtn.disabled = false;
                        submitBtn.textContent = originalText;
                        submitBtn.style.opacity = '1';
                        submitBtn.style.cursor = 'pointer';
                    }
                });
            });
        }
    });
    
    // Web Application VAPT Follow Up Audit Certificate Form Handler
    document.addEventListener('DOMContentLoaded', function() {
        const webAppVaptFollowUpAuditCertificateForm = document.getElementById('webAppVaptFollowUpAuditCertificateForm');
        if (webAppVaptFollowUpAuditCertificateForm) {
            webAppVaptFollowUpAuditCertificateForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                
                let organization_name = formData.get('organizationName');
                if (organization_name === 'other') {
                    organization_name = formData.get('otherOrganizationName');
                    if (!organization_name || organization_name.trim() === '') {
                        alert('Please enter the organization name');
                        return;
                    }
                }
                
                let city = formData.get('city');
                if (city === 'other') {
                    city = formData.get('otherCity');
                    if (!city || city.trim() === '') {
                        alert('Please enter the city name');
                        return;
                    }
                }
                
                let state = formData.get('state');
                if (state === 'other') {
                    state = formData.get('otherState');
                    if (!state || state.trim() === '') {
                        alert('Please enter the state name');
                        return;
                    }
                }
                
                const requiredFields = ['auditeeDesignation', 'scope', 'startAuditDate', 'endAuditDate', 'firstReportId', 'reportId'];
                for (const field of requiredFields) {
                    if (!formData.get(field) || formData.get(field).trim() === '') {
                        alert(`Please fill in the ${field.replace(/([A-Z])/g, ' $1').toLowerCase()}`);
                        return;
                    }
                }
                
                if (!organization_name || organization_name.trim() === '') {
                    alert('Please select or enter an organization name');
                    return;
                }
                
                if (!city || city.trim() === '') {
                    alert('Please select or enter a city');
                    return;
                }
                
                if (!state || state.trim() === '') {
                    alert('Please select or enter a state');
                    return;
                }
                
                const startDate = new Date(formData.get('startAuditDate'));
                const endDate = new Date(formData.get('endAuditDate'));
                if (startDate >= endDate) {
                    alert('End Audit Date must be after Start Audit Date');
                    return;
                }
                
                const submitBtn = this.querySelector('button[type="submit"]');
                const originalText = submitBtn ? submitBtn.textContent : 'Generate Certificate';
                if (submitBtn) {
                    submitBtn.disabled = true;
                    submitBtn.textContent = 'Processing...';
                    submitBtn.style.opacity = '0.6';
                    submitBtn.style.cursor = 'not-allowed';
                }
                
                const submitFormData = new FormData();
                submitFormData.append('organizationName', organization_name);
                submitFormData.append('city', city);
                submitFormData.append('state', state);
                submitFormData.append('auditeeDesignation', formData.get('auditeeDesignation'));
                submitFormData.append('scope', formData.get('scope'));
                submitFormData.append('startAuditDate', formData.get('startAuditDate'));
                submitFormData.append('endAuditDate', formData.get('endAuditDate'));
                submitFormData.append('firstReportId', formData.get('firstReportId'));
                submitFormData.append('reportId', formData.get('reportId'));
                
                fetch('/process_web_app_vapt_follow_up_audit_certificate', {
                    method: 'POST',
                    body: submitFormData
                })
                .then(response => {
                    if (response.ok) {
                        return response.blob().then(blob => {
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.href = url;
                            a.download = 'Web_Application_VAPT_Follow_Up_Certificate.docx';
                            document.body.appendChild(a);
                            a.click();
                            window.URL.revokeObjectURL(url);
                            document.body.removeChild(a);
                            
                            closeVaptModal('webAppVaptFollowUpAuditCertificateModal');
                            this.reset();
                            
                            setTimeout(() => {
                                window.location.reload();
                            }, 1000);
                        });
                    } else {
                        return response.json().then(data => {
                            throw new Error(data.error || 'Network response was not ok');
                        });
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Error: ' + error.message);
                    if (submitBtn) {
                        submitBtn.disabled = false;
                        submitBtn.textContent = originalText;
                        submitBtn.style.opacity = '1';
                        submitBtn.style.cursor = 'pointer';
                    }
                });
            });
        }
    });
    
    // Android Application VAPT Follow Up Audit Certificate Form Handler
    document.addEventListener('DOMContentLoaded', function() {
        const androidAppVaptFollowUpAuditCertificateForm = document.getElementById('androidAppVaptFollowUpAuditCertificateForm');
        if (androidAppVaptFollowUpAuditCertificateForm) {
            androidAppVaptFollowUpAuditCertificateForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                
                let organization_name = formData.get('organizationName');
                if (organization_name === 'other') {
                    organization_name = formData.get('otherOrganizationName');
                    if (!organization_name || organization_name.trim() === '') {
                        alert('Please enter the organization name');
                        return;
                    }
                }
                
                let city = formData.get('city');
                if (city === 'other') {
                    city = formData.get('otherCity');
                    if (!city || city.trim() === '') {
                        alert('Please enter the city name');
                        return;
                    }
                }
                
                let state = formData.get('state');
                if (state === 'other') {
                    state = formData.get('otherState');
                    if (!state || state.trim() === '') {
                        alert('Please enter the state name');
                        return;
                    }
                }
                
                const requiredFields = ['auditeeDesignation', 'scope', 'startAuditDate', 'endAuditDate', 'firstReportId', 'reportId'];
                for (const field of requiredFields) {
                    if (!formData.get(field) || formData.get(field).trim() === '') {
                        alert(`Please fill in the ${field.replace(/([A-Z])/g, ' $1').toLowerCase()}`);
                        return;
                    }
                }
                
                if (!organization_name || organization_name.trim() === '') {
                    alert('Please select or enter an organization name');
                    return;
                }
                
                if (!city || city.trim() === '') {
                    alert('Please select or enter a city');
                    return;
                }
                
                if (!state || state.trim() === '') {
                    alert('Please select or enter a state');
                    return;
                }
                
                const startDate = new Date(formData.get('startAuditDate'));
                const endDate = new Date(formData.get('endAuditDate'));
                if (startDate >= endDate) {
                    alert('End Audit Date must be after Start Audit Date');
                    return;
                }
                
                const submitBtn = this.querySelector('button[type="submit"]');
                const originalText = submitBtn ? submitBtn.textContent : 'Generate Certificate';
                if (submitBtn) {
                    submitBtn.disabled = true;
                    submitBtn.textContent = 'Processing...';
                    submitBtn.style.opacity = '0.6';
                    submitBtn.style.cursor = 'not-allowed';
                }
                
                const submitFormData = new FormData();
                submitFormData.append('organizationName', organization_name);
                submitFormData.append('city', city);
                submitFormData.append('state', state);
                submitFormData.append('auditeeDesignation', formData.get('auditeeDesignation'));
                submitFormData.append('scope', formData.get('scope'));
                submitFormData.append('startAuditDate', formData.get('startAuditDate'));
                submitFormData.append('endAuditDate', formData.get('endAuditDate'));
                submitFormData.append('firstReportId', formData.get('firstReportId'));
                submitFormData.append('reportId', formData.get('reportId'));
                
                fetch('/process_android_app_vapt_follow_up_audit_certificate', {
                    method: 'POST',
                    body: submitFormData
                })
                .then(response => {
                    if (response.ok) {
                        return response.blob().then(blob => {
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.href = url;
                            a.download = 'Android_Application_VAPT_Follow_Up_Certificate.docx';
                            document.body.appendChild(a);
                            a.click();
                            window.URL.revokeObjectURL(url);
                            document.body.removeChild(a);
                            
                            closeVaptModal('androidAppVaptFollowUpAuditCertificateModal');
                            this.reset();
                            
                            setTimeout(() => {
                                window.location.reload();
                            }, 1000);
                        });
                    } else {
                        return response.json().then(data => {
                            throw new Error(data.error || 'Network response was not ok');
                        });
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Error: ' + error.message);
                    if (submitBtn) {
                        submitBtn.disabled = false;
                        submitBtn.textContent = originalText;
                        submitBtn.style.opacity = '1';
                        submitBtn.style.cursor = 'pointer';
                    }
                });
            });
        }
    });
    
    // IOS Application VAPT Follow Up Audit Certificate Form Handler
    document.addEventListener('DOMContentLoaded', function() {
        const iosAppVaptFollowUpAuditCertificateForm = document.getElementById('iosAppVaptFollowUpAuditCertificateForm');
        if (iosAppVaptFollowUpAuditCertificateForm) {
            iosAppVaptFollowUpAuditCertificateForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                
                let organization_name = formData.get('organizationName');
                if (organization_name === 'other') {
                    organization_name = formData.get('otherOrganizationName');
                    if (!organization_name || organization_name.trim() === '') {
                        alert('Please enter the organization name');
                        return;
                    }
                }
                
                let city = formData.get('city');
                if (city === 'other') {
                    city = formData.get('otherCity');
                    if (!city || city.trim() === '') {
                        alert('Please enter the city name');
                        return;
                    }
                }
                
                let state = formData.get('state');
                if (state === 'other') {
                    state = formData.get('otherState');
                    if (!state || state.trim() === '') {
                        alert('Please enter the state name');
                        return;
                    }
                }
                
                const requiredFields = ['auditeeDesignation', 'scope', 'startAuditDate', 'endAuditDate', 'firstReportId', 'reportId'];
                for (const field of requiredFields) {
                    if (!formData.get(field) || formData.get(field).trim() === '') {
                        alert(`Please fill in the ${field.replace(/([A-Z])/g, ' $1').toLowerCase()}`);
                        return;
                    }
                }
                
                if (!organization_name || organization_name.trim() === '') {
                    alert('Please select or enter an organization name');
                    return;
                }
                
                if (!city || city.trim() === '') {
                    alert('Please select or enter a city');
                    return;
                }
                
                if (!state || state.trim() === '') {
                    alert('Please select or enter a state');
                    return;
                }
                
                const startDate = new Date(formData.get('startAuditDate'));
                const endDate = new Date(formData.get('endAuditDate'));
                if (startDate >= endDate) {
                    alert('End Audit Date must be after Start Audit Date');
                    return;
                }
                
                const submitBtn = this.querySelector('button[type="submit"]');
                const originalText = submitBtn ? submitBtn.textContent : 'Generate Certificate';
                if (submitBtn) {
                    submitBtn.disabled = true;
                    submitBtn.textContent = 'Processing...';
                    submitBtn.style.opacity = '0.6';
                    submitBtn.style.cursor = 'not-allowed';
                }
                
                const submitFormData = new FormData();
                submitFormData.append('organizationName', organization_name);
                submitFormData.append('city', city);
                submitFormData.append('state', state);
                submitFormData.append('auditeeDesignation', formData.get('auditeeDesignation'));
                submitFormData.append('scope', formData.get('scope'));
                submitFormData.append('startAuditDate', formData.get('startAuditDate'));
                submitFormData.append('endAuditDate', formData.get('endAuditDate'));
                submitFormData.append('firstReportId', formData.get('firstReportId'));
                submitFormData.append('reportId', formData.get('reportId'));
                
                fetch('/process_ios_app_vapt_follow_up_audit_certificate', {
                    method: 'POST',
                    body: submitFormData
                })
                .then(response => {
                    if (response.ok) {
                        return response.blob().then(blob => {
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.href = url;
                            a.download = 'IOS_Application_VAPT_Follow_Up_Certificate.docx';
                            document.body.appendChild(a);
                            a.click();
                            window.URL.revokeObjectURL(url);
                            document.body.removeChild(a);
                            
                            closeVaptModal('iosAppVaptFollowUpAuditCertificateModal');
                            this.reset();
                            
                            setTimeout(() => {
                                window.location.reload();
                            }, 1000);
                        });
                    } else {
                        return response.json().then(data => {
                            throw new Error(data.error || 'Network response was not ok');
                        });
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Error: ' + error.message);
                    if (submitBtn) {
                        submitBtn.disabled = false;
                        submitBtn.textContent = originalText;
                        submitBtn.style.opacity = '1';
                        submitBtn.style.cursor = 'pointer';
                    }
                });
            });
        }
    });
    
    function removeVaptEmailField(button) {
        button.parentElement.remove();
    }
    
    function removeVaptTeamMember(button) {
        button.parentElement.remove();
    }
    
    
    // Date validation for Infrastructure VAPT First Audit Details
    // Disable finish date before start date (including start date)
    function setupVaptDateValidation() {
        const vaptStartDateInput = document.getElementById('vaptStartDate');
        const vaptEndDateInput = document.getElementById('vaptEndDate');
        
        if (vaptStartDateInput && vaptEndDateInput) {
            // Function to update finish date min value based on start date
            function updateFinishDateMin() {
                const startDate = vaptStartDateInput.value;
                if (startDate) {
                    // Calculate the day after start date
                    const startDateObj = new Date(startDate);
                    startDateObj.setDate(startDateObj.getDate() + 1);
                    
                    // Format as YYYY-MM-DD for the min attribute
                    const minDate = startDateObj.toISOString().split('T')[0];
                    
                    // Set the minimum date for finish date (day after start date)
                    vaptEndDateInput.setAttribute('min', minDate);
                    
                    // If finish date is already selected and is before or equal to start date, clear it
                    if (vaptEndDateInput.value && vaptEndDateInput.value <= startDate) {
                        vaptEndDateInput.value = '';
                    }
                } else {
                    // If start date is cleared, remove the min restriction
                    vaptEndDateInput.removeAttribute('min');
                }
            }
            
            // Set up change event listener
            vaptStartDateInput.addEventListener('change', updateFinishDateMin);
            
            // Also check if start date is already set when modal opens
            if (vaptStartDateInput.value) {
                updateFinishDateMin();
            }
        }
    }
    
    // Run setup when DOM is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', setupVaptDateValidation);
    } else {
        // DOM is already loaded
        setupVaptDateValidation();
    }
    
    document.addEventListener('DOMContentLoaded', function() {
        const startAuditInput = document.getElementById('vaptFirstAuditCertificateStartAuditDate');
        const endAuditInput = document.getElementById('vaptFirstAuditCertificateEndAuditDate');
        const releaseDateInput = document.getElementById('vaptFirstAuditCertificateReleaseDate');

        if (!startAuditInput || !endAuditInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        const applyEndConstraints = () => {
            if (startAuditInput.value) {
                endAuditInput.min = startAuditInput.value;
                if (endAuditInput.value && endAuditInput.value < startAuditInput.value) {
                    endAuditInput.value = startAuditInput.value;
                }
            } else {
                endAuditInput.removeAttribute('min');
            }
        };

        const applyStartConstraints = () => {
            if (endAuditInput.value) {
                startAuditInput.max = endAuditInput.value;
                if (startAuditInput.value && startAuditInput.value > endAuditInput.value) {
                    startAuditInput.value = endAuditInput.value;
                }
            } else {
                startAuditInput.removeAttribute('max');
            }
        };

        const applyReleaseMinConstraint = () => {
            if (!releaseDateInput) return;

            if (endAuditInput.value) {
                const minDate = new Date(endAuditInput.value);
                minDate.setDate(minDate.getDate() + 1);
                const minDateStr = formatDate(minDate);
                releaseDateInput.min = minDateStr;

                if (releaseDateInput.value && releaseDateInput.value < minDateStr) {
                    releaseDateInput.value = minDateStr;
                }
            } else {
                releaseDateInput.removeAttribute('min');
            }
        };

        const applyStartEndMaxConstraintsFromRelease = () => {
            if (!releaseDateInput || !releaseDateInput.value) {
                startAuditInput.removeAttribute('max');
                endAuditInput.removeAttribute('max');
                applyStartConstraints();
                applyEndConstraints();
                return;
            }

            const releaseDate = new Date(releaseDateInput.value);
            const maxDate = new Date(releaseDate);
            maxDate.setDate(maxDate.getDate() - 1);
            const maxDateStr = formatDate(maxDate);

            if (maxDateStr >= startAuditInput.min || !startAuditInput.min) {
                startAuditInput.max = maxDateStr;
                if (startAuditInput.value && startAuditInput.value > maxDateStr) {
                    startAuditInput.value = maxDateStr;
                }
            }

            if (maxDateStr >= (endAuditInput.min || '')) {
                endAuditInput.max = maxDateStr;
                if (endAuditInput.value && endAuditInput.value > maxDateStr) {
                    endAuditInput.value = maxDateStr;
                }
            }

            applyEndConstraints();
            applyStartConstraints();
        };

        const handleStartChange = () => {
            applyEndConstraints();
            applyReleaseMinConstraint();
            applyStartEndMaxConstraintsFromRelease();
        };

        const handleEndChange = () => {
            applyStartConstraints();
            applyEndConstraints();
            applyReleaseMinConstraint();
            applyStartEndMaxConstraintsFromRelease();
        };

        startAuditInput.addEventListener('change', handleStartChange);
        endAuditInput.addEventListener('change', handleEndChange);

        if (releaseDateInput) {
            releaseDateInput.addEventListener('change', () => {
                applyStartEndMaxConstraintsFromRelease();
                applyReleaseMinConstraint();
            });
        }

        applyStartConstraints();
        applyEndConstraints();
        applyReleaseMinConstraint();
        applyStartEndMaxConstraintsFromRelease();
    });
    
    // Date validation for Infrastructure VAPT Follow Up Audit Details
    // Disable finish date before start date (including start date)
    function setupVaptFollowUpDateValidation() {
        const vaptFollowUpStartDateInput = document.getElementById('vaptFollowUpStartDate');
        const vaptFollowUpEndDateInput = document.getElementById('vaptFollowUpEndDate');
        
        if (vaptFollowUpStartDateInput && vaptFollowUpEndDateInput) {
            // Function to update finish date min value based on start date
            function updateFollowUpFinishDateMin() {
                const startDate = vaptFollowUpStartDateInput.value;
                if (startDate) {
                    // Calculate the day after start date
                    const startDateObj = new Date(startDate);
                    startDateObj.setDate(startDateObj.getDate() + 1);
                    
                    // Format as YYYY-MM-DD for the min attribute
                    const minDate = startDateObj.toISOString().split('T')[0];
                    
                    // Set the minimum date for finish date (day after start date)
                    vaptFollowUpEndDateInput.setAttribute('min', minDate);
                    
                    // If finish date is already selected and is before or equal to start date, clear it
                    if (vaptFollowUpEndDateInput.value && vaptFollowUpEndDateInput.value <= startDate) {
                        vaptFollowUpEndDateInput.value = '';
                    }
                } else {
                    // If start date is cleared, remove the min restriction
                    vaptFollowUpEndDateInput.removeAttribute('min');
                }
            }
            
            // Set up change event listener
            vaptFollowUpStartDateInput.addEventListener('change', updateFollowUpFinishDateMin);
            
            // Also check if start date is already set when modal opens
            if (vaptFollowUpStartDateInput.value) {
                updateFollowUpFinishDateMin();
            }
        }
    }
    
    // Run setup when DOM is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', setupVaptFollowUpDateValidation);
    } else {
        // DOM is already loaded
        setupVaptFollowUpDateValidation();
    }
    
    document.addEventListener('DOMContentLoaded', function () {
        const releaseDateInput = document.getElementById('vaptFollowUpFirstAuditReportDate');
        const startDateInput = document.getElementById('vaptFollowUpStartDate');
        const endDateInput = document.getElementById('vaptFollowUpEndDate');

        if (!releaseDateInput || !startDateInput || !endDateInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        const enforceStartConstraints = () => {
            if (releaseDateInput.value) {
                startDateInput.min = releaseDateInput.value;
                if (startDateInput.value && startDateInput.value < releaseDateInput.value) {
                    startDateInput.value = releaseDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('min');
            }
        };

        const enforceReleaseConstraints = () => {
            if (startDateInput.value) {
                releaseDateInput.max = startDateInput.value;
                if (releaseDateInput.value && releaseDateInput.value > startDateInput.value) {
                    releaseDateInput.value = startDateInput.value;
                }
            } else {
                releaseDateInput.removeAttribute('max');
            }
        };

        const enforceEndConstraints = () => {
            const candidateMins = [];

            if (releaseDateInput.value) {
                candidateMins.push(releaseDateInput.value);
            }

            if (startDateInput.value) {
                const minFromStart = new Date(startDateInput.value);
                minFromStart.setDate(minFromStart.getDate() + 1);
                candidateMins.push(formatDate(minFromStart));
            }

            if (candidateMins.length) {
                const minValue = candidateMins.reduce((max, current) => current > max ? current : max, candidateMins[0]);
                endDateInput.min = minValue;
                if (endDateInput.value && endDateInput.value < minValue) {
                    endDateInput.value = minValue;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const ensureEndNotBeforeRelease = () => {
            if (releaseDateInput.value && endDateInput.value && endDateInput.value < releaseDateInput.value) {
                endDateInput.value = releaseDateInput.value;
            }
        };

        const syncConstraints = () => {
            enforceStartConstraints();
            enforceReleaseConstraints();
            enforceEndConstraints();
            ensureEndNotBeforeRelease();
        };

        releaseDateInput.addEventListener('change', syncConstraints);
        startDateInput.addEventListener('change', syncConstraints);
        endDateInput.addEventListener('change', () => {
            enforceReleaseConstraints();
            enforceEndConstraints();
            ensureEndNotBeforeRelease();
        });

        syncConstraints();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const startDateInput = document.getElementById('vaptMetaStartDate');
        const endDateInput = document.getElementById('vaptMetaEndDate');

        if (!startDateInput || !endDateInput) {
            return;
        }

        const applyEndConstraints = () => {
            if (startDateInput.value) {
                endDateInput.min = startDateInput.value;
                if (endDateInput.value && endDateInput.value < startDateInput.value) {
                    endDateInput.value = startDateInput.value;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const applyStartConstraints = () => {
            if (endDateInput.value) {
                startDateInput.max = endDateInput.value;
                if (startDateInput.value && startDateInput.value > endDateInput.value) {
                    startDateInput.value = endDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('max');
            }
        };

        const syncConstraints = () => {
            applyEndConstraints();
            applyStartConstraints();
        };

        startDateInput.addEventListener('change', syncConstraints);
        endDateInput.addEventListener('change', syncConstraints);

        syncConstraints();
    });

    // Date constraints for VAPT First Audit Meta Data form
    // Constraint between Start Audit Date and Date of Audit Completion
    document.addEventListener('DOMContentLoaded', function() {
        const startAuditInput = document.getElementById('vaptMetaStartDate');
        const dateCompletionInput = document.getElementById('vaptMetaDateCompletion');

        if (!startAuditInput || !dateCompletionInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        // When start audit date changes, set minimum date for date of completion (start date + 1 day)
        const applyCompletionDateMinConstraint = () => {
            if (startAuditInput.value) {
                const startDate = new Date(startAuditInput.value);
                // Set minimum to start date + 1 day (so completion date must be after start date)
                const minDate = new Date(startDate);
                minDate.setDate(minDate.getDate() + 1);
                const minDateStr = formatDate(minDate);
                dateCompletionInput.setAttribute('min', minDateStr);
                // If completion date is before or equal to start date, clear it
                if (dateCompletionInput.value && dateCompletionInput.value <= startAuditInput.value) {
                    dateCompletionInput.value = '';
                }
            } else {
                dateCompletionInput.removeAttribute('min');
            }
        };

        // When date of completion changes, set maximum date for start audit date (completion date - 1 day)
        const applyStartDateMaxConstraint = () => {
            if (dateCompletionInput.value) {
                const completionDate = new Date(dateCompletionInput.value);
                // Set maximum to completion date - 1 day (so start date must be before completion date)
                const maxDate = new Date(completionDate);
                maxDate.setDate(maxDate.getDate() - 1);
                const maxDateStr = formatDate(maxDate);
                startAuditInput.setAttribute('max', maxDateStr);
                // If start date is after or equal to completion date, clear it
                if (startAuditInput.value && startAuditInput.value >= dateCompletionInput.value) {
                    startAuditInput.value = '';
                }
            } else {
                startAuditInput.removeAttribute('max');
            }
        };

        // Add event listeners
        startAuditInput.addEventListener('change', () => {
            applyCompletionDateMinConstraint();
        });

        dateCompletionInput.addEventListener('change', () => {
            applyStartDateMaxConstraint();
        });

        // Apply constraints on page load if values are already set
        applyCompletionDateMinConstraint();
        applyStartDateMaxConstraint();
    });

    // Date constraints for API First Audit Meta Data form
    // Constraint between Start Audit Date and Date of Audit Completion
    document.addEventListener('DOMContentLoaded', function() {
        const startAuditInput = document.getElementById('apiMetaStartDate');
        const dateCompletionInput = document.getElementById('apiMetaDateCompletion');

        if (!startAuditInput || !dateCompletionInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        // When start audit date changes, set minimum date for date of completion (start date + 1 day)
        const applyCompletionDateMinConstraint = () => {
            if (startAuditInput.value) {
                const startDate = new Date(startAuditInput.value);
                // Set minimum to start date + 1 day (so completion date must be after start date)
                const minDate = new Date(startDate);
                minDate.setDate(minDate.getDate() + 1);
                const minDateStr = formatDate(minDate);
                dateCompletionInput.setAttribute('min', minDateStr);
                // If completion date is before or equal to start date, clear it
                if (dateCompletionInput.value && dateCompletionInput.value <= startAuditInput.value) {
                    dateCompletionInput.value = '';
                }
            } else {
                dateCompletionInput.removeAttribute('min');
            }
        };

        // When date of completion changes, set maximum date for start audit date (completion date - 1 day)
        const applyStartDateMaxConstraint = () => {
            if (dateCompletionInput.value) {
                const completionDate = new Date(dateCompletionInput.value);
                // Set maximum to completion date - 1 day (so start date must be before completion date)
                const maxDate = new Date(completionDate);
                maxDate.setDate(maxDate.getDate() - 1);
                const maxDateStr = formatDate(maxDate);
                startAuditInput.setAttribute('max', maxDateStr);
                // If start date is after or equal to completion date, clear it
                if (startAuditInput.value && startAuditInput.value >= dateCompletionInput.value) {
                    startAuditInput.value = '';
                }
            } else {
                startAuditInput.removeAttribute('max');
            }
        };

        // Add event listeners
        startAuditInput.addEventListener('change', () => {
            applyCompletionDateMinConstraint();
        });

        dateCompletionInput.addEventListener('change', () => {
            applyStartDateMaxConstraint();
        });

        // Apply constraints on page load if values are already set
        applyCompletionDateMinConstraint();
        applyStartDateMaxConstraint();
    });

    // Date constraints for Public IP First Audit Meta Data form
    // Constraint between Start Audit Date and Date of Audit Completion
    document.addEventListener('DOMContentLoaded', function() {
        const startAuditInput = document.getElementById('publicIpMetaStartDate');
        const dateCompletionInput = document.getElementById('publicIpMetaDateCompletion');

        if (!startAuditInput || !dateCompletionInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        // When start audit date changes, set minimum date for date of completion (start date + 1 day)
        const applyCompletionDateMinConstraint = () => {
            if (startAuditInput.value) {
                const startDate = new Date(startAuditInput.value);
                // Set minimum to start date + 1 day (so completion date must be after start date)
                const minDate = new Date(startDate);
                minDate.setDate(minDate.getDate() + 1);
                const minDateStr = formatDate(minDate);
                dateCompletionInput.setAttribute('min', minDateStr);
                // If completion date is before or equal to start date, clear it
                if (dateCompletionInput.value && dateCompletionInput.value <= startAuditInput.value) {
                    dateCompletionInput.value = '';
                }
            } else {
                dateCompletionInput.removeAttribute('min');
            }
        };

        // When date of completion changes, set maximum date for start audit date (completion date - 1 day)
        const applyStartDateMaxConstraint = () => {
            if (dateCompletionInput.value) {
                const completionDate = new Date(dateCompletionInput.value);
                // Set maximum to completion date - 1 day (so start date must be before completion date)
                const maxDate = new Date(completionDate);
                maxDate.setDate(maxDate.getDate() - 1);
                const maxDateStr = formatDate(maxDate);
                startAuditInput.setAttribute('max', maxDateStr);
                // If start date is after or equal to completion date, clear it
                if (startAuditInput.value && startAuditInput.value >= dateCompletionInput.value) {
                    startAuditInput.value = '';
                }
            } else {
                startAuditInput.removeAttribute('max');
            }
        };

        // Add event listeners
        startAuditInput.addEventListener('change', () => {
            applyCompletionDateMinConstraint();
        });

        dateCompletionInput.addEventListener('change', () => {
            applyStartDateMaxConstraint();
        });

        // Apply constraints on page load if values are already set
        applyCompletionDateMinConstraint();
        applyStartDateMaxConstraint();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const startDateInput = document.getElementById('vaptFollowUpMetaStartDate');
        const endDateInput = document.getElementById('vaptFollowUpMetaEndDate');

        if (!startDateInput || !endDateInput) {
            return;
        }

        const applyEndConstraints = () => {
            if (startDateInput.value) {
                endDateInput.min = startDateInput.value;
                if (endDateInput.value && endDateInput.value < startDateInput.value) {
                    endDateInput.value = startDateInput.value;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const applyStartConstraints = () => {
            if (endDateInput.value) {
                startDateInput.max = endDateInput.value;
                if (startDateInput.value && startDateInput.value > endDateInput.value) {
                    startDateInput.value = endDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('max');
            }
        };

        const syncConstraints = () => {
            applyEndConstraints();
            applyStartConstraints();
        };

        startDateInput.addEventListener('change', syncConstraints);
        endDateInput.addEventListener('change', syncConstraints);

        syncConstraints();
    });

    // Date constraints for VAPT Follow-Up Audit Meta Data form
    // Constraint between Start Audit Date and Date of Audit Completion
    document.addEventListener('DOMContentLoaded', function() {
        const startAuditInput = document.getElementById('vaptFollowUpMetaStartDate');
        const dateCompletionInput = document.getElementById('vaptFollowUpMetaDateCompletion');

        if (!startAuditInput || !dateCompletionInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        // When start audit date changes, set minimum date for date of completion (start date + 1 day)
        const applyCompletionDateMinConstraint = () => {
            if (startAuditInput.value) {
                const startDate = new Date(startAuditInput.value);
                // Set minimum to start date + 1 day (so completion date must be after start date)
                const minDate = new Date(startDate);
                minDate.setDate(minDate.getDate() + 1);
                const minDateStr = formatDate(minDate);
                dateCompletionInput.setAttribute('min', minDateStr);
                // If completion date is before or equal to start date, clear it
                if (dateCompletionInput.value && dateCompletionInput.value <= startAuditInput.value) {
                    dateCompletionInput.value = '';
                }
            } else {
                dateCompletionInput.removeAttribute('min');
            }
        };

        // When date of completion changes, set maximum date for start audit date (completion date - 1 day)
        const applyStartDateMaxConstraint = () => {
            if (dateCompletionInput.value) {
                const completionDate = new Date(dateCompletionInput.value);
                // Set maximum to completion date - 1 day (so start date must be before completion date)
                const maxDate = new Date(completionDate);
                maxDate.setDate(maxDate.getDate() - 1);
                const maxDateStr = formatDate(maxDate);
                startAuditInput.setAttribute('max', maxDateStr);
                // If start date is after or equal to completion date, clear it
                if (startAuditInput.value && startAuditInput.value >= dateCompletionInput.value) {
                    startAuditInput.value = '';
                }
            } else {
                startAuditInput.removeAttribute('max');
            }
        };

        // Add event listeners
        startAuditInput.addEventListener('change', () => {
            applyCompletionDateMinConstraint();
        });

        dateCompletionInput.addEventListener('change', () => {
            applyStartDateMaxConstraint();
        });

        // Apply constraints on page load if values are already set
        applyCompletionDateMinConstraint();
        applyStartDateMaxConstraint();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const startAuditInput = document.getElementById('vaptFirstAuditCertificateStartAuditDate');
        const endAuditInput = document.getElementById('vaptFirstAuditCertificateEndAuditDate');
        const releaseDateInput = document.getElementById('vaptFirstAuditCertificateReleaseDate');

        if (!startAuditInput || !endAuditInput || !releaseDateInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        const setReleaseMinFromEnd = () => {
            if (endAuditInput.value) {
                releaseDateInput.min = endAuditInput.value;
                if (releaseDateInput.value && releaseDateInput.value < endAuditInput.value) {
                    releaseDateInput.value = endAuditInput.value;
                }
            } else {
                releaseDateInput.removeAttribute('min');
            }
        };

        const setStartEndMaxFromRelease = () => {
            if (releaseDateInput.value) {
                const maxDate = new Date(releaseDateInput.value);
                startAuditInput.max = releaseDateInput.value;
                const maxEndDate = formatDate(maxDate);
                endAuditInput.max = maxEndDate;

                if (startAuditInput.value && startAuditInput.value > releaseDateInput.value) {
                    startAuditInput.value = releaseDateInput.value;
                }
                if (endAuditInput.value && endAuditInput.value > maxEndDate) {
                    endAuditInput.value = maxEndDate;
                }
            } else {
                startAuditInput.removeAttribute('max');
                endAuditInput.removeAttribute('max');
            }
        };

        const setEndMinFromStart = () => {
            if (startAuditInput.value) {
                endAuditInput.min = startAuditInput.value;
                if (endAuditInput.value && endAuditInput.value < startAuditInput.value) {
                    endAuditInput.value = startAuditInput.value;
                }
            } else {
                endAuditInput.removeAttribute('min');
            }
        };

        startAuditInput.addEventListener('change', () => {
            setEndMinFromStart();
            setReleaseMinFromEnd();
            setStartEndMaxFromRelease();
        });

        endAuditInput.addEventListener('change', () => {
            setReleaseMinFromEnd();
            setEndMinFromStart();
            setStartEndMaxFromRelease();
        });

        releaseDateInput.addEventListener('change', () => {
            setStartEndMaxFromRelease();
            setEndMinFromStart();
            setReleaseMinFromEnd();
        });

        setEndMinFromStart();
        setReleaseMinFromEnd();
        setStartEndMaxFromRelease();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const startAuditInput = document.getElementById('vaptFollowUpAuditCertificateStartAuditDate');
        const endAuditInput = document.getElementById('vaptFollowUpAuditCertificateEndAuditDate');
        const releaseDateInput = document.getElementById('vaptFollowUpAuditCertificateReleaseDate');

        if (!startAuditInput || !endAuditInput || !releaseDateInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        const setReleaseMinFromEnd = () => {
            if (endAuditInput.value) {
                releaseDateInput.min = endAuditInput.value;
                if (releaseDateInput.value && releaseDateInput.value < endAuditInput.value) {
                    releaseDateInput.value = endAuditInput.value;
                }
            } else {
                releaseDateInput.removeAttribute('min');
            }
        };

        const setStartEndMaxFromRelease = () => {
            if (releaseDateInput.value) {
                const maxDate = new Date(releaseDateInput.value);
                startAuditInput.max = releaseDateInput.value;
                const maxEndDate = formatDate(maxDate);
                endAuditInput.max = maxEndDate;

                if (startAuditInput.value && startAuditInput.value > releaseDateInput.value) {
                    startAuditInput.value = releaseDateInput.value;
                }
                if (endAuditInput.value && endAuditInput.value > maxEndDate) {
                    endAuditInput.value = maxEndDate;
                }
            } else {
                startAuditInput.removeAttribute('max');
                endAuditInput.removeAttribute('max');
            }
        };

        const setEndMinFromStart = () => {
            if (startAuditInput.value) {
                endAuditInput.min = startAuditInput.value;
                if (endAuditInput.value && endAuditInput.value < startAuditInput.value) {
                    endAuditInput.value = startAuditInput.value;
                }
            } else {
                endAuditInput.removeAttribute('min');
            }
        };

        startAuditInput.addEventListener('change', () => {
            setEndMinFromStart();
            setReleaseMinFromEnd();
            setStartEndMaxFromRelease();
        });

        endAuditInput.addEventListener('change', () => {
            setReleaseMinFromEnd();
            setEndMinFromStart();
            setStartEndMaxFromRelease();
        });

        releaseDateInput.addEventListener('change', () => {
            setStartEndMaxFromRelease();
            setEndMinFromStart();
            setReleaseMinFromEnd();
        });

        setEndMinFromStart();
        setReleaseMinFromEnd();
        setStartEndMaxFromRelease();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const startDateInput = document.getElementById('websiteVaptStartDate');
        const endDateInput = document.getElementById('websiteVaptEndDate');

        if (!startDateInput || !endDateInput) {
            return;
        }

        const applyEndConstraints = () => {
            if (startDateInput.value) {
                endDateInput.min = startDateInput.value;
                if (endDateInput.value && endDateInput.value < startDateInput.value) {
                    endDateInput.value = startDateInput.value;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const applyStartConstraints = () => {
            if (endDateInput.value) {
                startDateInput.max = endDateInput.value;
                if (startDateInput.value && startDateInput.value > endDateInput.value) {
                    startDateInput.value = endDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('max');
            }
        };

        const syncConstraints = () => {
            applyEndConstraints();
                applyStartConstraints();
        };

        startDateInput.addEventListener('change', syncConstraints);
        endDateInput.addEventListener('change', syncConstraints);

        syncConstraints();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const releaseDateInput = document.getElementById('websiteVaptFollowUpFirstAuditReportDate');
        const startDateInput = document.getElementById('websiteVaptFollowUpStartDate');
        const endDateInput = document.getElementById('websiteVaptFollowUpEndDate');

        if (!releaseDateInput || !startDateInput || !endDateInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        const enforceStartConstraints = () => {
            if (releaseDateInput.value) {
                startDateInput.min = releaseDateInput.value;
                if (startDateInput.value && startDateInput.value < releaseDateInput.value) {
                    startDateInput.value = releaseDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('min');
            }
        };

        const enforceReleaseConstraints = () => {
            if (startDateInput.value) {
                releaseDateInput.max = startDateInput.value;
                if (releaseDateInput.value && releaseDateInput.value > startDateInput.value) {
                    releaseDateInput.value = startDateInput.value;
                }
            } else {
                releaseDateInput.removeAttribute('max');
            }
        };

        const enforceEndConstraints = () => {
            const candidates = [];

            if (releaseDateInput.value) {
                candidates.push(releaseDateInput.value);
            }

            if (startDateInput.value) {
                const minFromStart = new Date(startDateInput.value);
                minFromStart.setDate(minFromStart.getDate() + 1);
                candidates.push(formatDate(minFromStart));
            }

            if (candidates.length) {
                const minValue = candidates.reduce((max, current) => current > max ? current : max, candidates[0]);
                endDateInput.min = minValue;
                if (endDateInput.value && endDateInput.value < minValue) {
                    endDateInput.value = minValue;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const ensureEndNotBeforeRelease = () => {
            if (releaseDateInput.value && endDateInput.value && endDateInput.value < releaseDateInput.value) {
                endDateInput.value = releaseDateInput.value;
            }
        };

        const syncConstraints = () => {
            enforceStartConstraints();
            enforceReleaseConstraints();
            enforceEndConstraints();
            ensureEndNotBeforeRelease();
        };

        releaseDateInput.addEventListener('change', syncConstraints);
        startDateInput.addEventListener('change', syncConstraints);
        endDateInput.addEventListener('change', () => {
            enforceReleaseConstraints();
            enforceEndConstraints();
            ensureEndNotBeforeRelease();
        });

        syncConstraints();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const startDateInput = document.getElementById('websiteVaptMetaStartDate');
        const endDateInput = document.getElementById('websiteVaptMetaEndDate');

        if (!startDateInput || !endDateInput) {
            return;
        }

        const applyEndConstraints = () => {
            if (startDateInput.value) {
                endDateInput.min = startDateInput.value;
                if (endDateInput.value && endDateInput.value < startDateInput.value) {
                    endDateInput.value = startDateInput.value;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const applyStartConstraints = () => {
            if (endDateInput.value) {
                startDateInput.max = endDateInput.value;
                if (startDateInput.value && startDateInput.value > endDateInput.value) {
                    startDateInput.value = endDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('max');
            }
        };

        const syncConstraints = () => {
            applyEndConstraints();
            applyStartConstraints();
        };

        startDateInput.addEventListener('change', syncConstraints);
        endDateInput.addEventListener('change', syncConstraints);

        syncConstraints();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const startDateInput = document.getElementById('websiteVaptFollowUpMetaStartDate');
        const endDateInput = document.getElementById('websiteVaptFollowUpMetaEndDate');

        if (!startDateInput || !endDateInput) {
            return;
        }

        const applyEndConstraints = () => {
            if (startDateInput.value) {
                endDateInput.min = startDateInput.value;
                if (endDateInput.value && endDateInput.value < startDateInput.value) {
                    endDateInput.value = startDateInput.value;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const applyStartConstraints = () => {
            if (endDateInput.value) {
                startDateInput.max = endDateInput.value;
                if (startDateInput.value && startDateInput.value > endDateInput.value) {
                    startDateInput.value = endDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('max');
            }
        };

        const syncConstraints = () => {
            applyEndConstraints();
            applyStartConstraints();
        };

        startDateInput.addEventListener('change', syncConstraints);
        endDateInput.addEventListener('change', syncConstraints);

        syncConstraints();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const startAuditInput = document.getElementById('websiteVaptFirstAuditCertificateStartAuditDate');
        const endAuditInput = document.getElementById('websiteVaptFirstAuditCertificateEndAuditDate');
        const releaseDateInput = document.getElementById('websiteVaptFirstAuditCertificateReleaseDate');

        if (!startAuditInput || !endAuditInput || !releaseDateInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        const setReleaseMinFromEnd = () => {
            if (endAuditInput.value) {
                releaseDateInput.min = endAuditInput.value;
                if (releaseDateInput.value && releaseDateInput.value < endAuditInput.value) {
                    releaseDateInput.value = endAuditInput.value;
                }
            } else {
                releaseDateInput.removeAttribute('min');
            }
        };

        const setStartEndMaxFromRelease = () => {
            if (releaseDateInput.value) {
                const maxDate = new Date(releaseDateInput.value);
                startAuditInput.max = releaseDateInput.value;
                const maxEndDate = formatDate(maxDate);
                endAuditInput.max = maxEndDate;

                if (startAuditInput.value && startAuditInput.value > releaseDateInput.value) {
                    startAuditInput.value = releaseDateInput.value;
                }
                if (endAuditInput.value && endAuditInput.value > maxEndDate) {
                    endAuditInput.value = maxEndDate;
                }
            } else {
                startAuditInput.removeAttribute('max');
                endAuditInput.removeAttribute('max');
            }
        };

        const setEndMinFromStart = () => {
            if (startAuditInput.value) {
                endAuditInput.min = startAuditInput.value;
                if (endAuditInput.value && endAuditInput.value < startAuditInput.value) {
                    endAuditInput.value = startAuditInput.value;
                }
            } else {
                endAuditInput.removeAttribute('min');
            }
        };

        startAuditInput.addEventListener('change', () => {
            setEndMinFromStart();
            setReleaseMinFromEnd();
            setStartEndMaxFromRelease();
        });

        endAuditInput.addEventListener('change', () => {
            setReleaseMinFromEnd();
            setEndMinFromStart();
            setStartEndMaxFromRelease();
        });

        releaseDateInput.addEventListener('change', () => {
            setStartEndMaxFromRelease();
            setEndMinFromStart();
            setReleaseMinFromEnd();
        });

        setEndMinFromStart();
        setReleaseMinFromEnd();
        setStartEndMaxFromRelease();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const startAuditInput = document.getElementById('websiteVaptFollowUpAuditCertificateStartAuditDate');
        const endAuditInput = document.getElementById('websiteVaptFollowUpAuditCertificateEndAuditDate');
        const releaseDateInput = document.getElementById('websiteVaptFollowUpAuditCertificateReleaseDate');

        if (!startAuditInput || !endAuditInput || !releaseDateInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        const setReleaseMinFromEnd = () => {
            if (endAuditInput.value) {
                releaseDateInput.min = endAuditInput.value;
                if (releaseDateInput.value && releaseDateInput.value < endAuditInput.value) {
                    releaseDateInput.value = endAuditInput.value;
                }
            } else {
                releaseDateInput.removeAttribute('min');
            }
        };

        const setStartEndMaxFromRelease = () => {
            if (releaseDateInput.value) {
                const maxDate = new Date(releaseDateInput.value);
                startAuditInput.max = releaseDateInput.value;
                const maxEndDate = formatDate(maxDate);
                endAuditInput.max = maxEndDate;

                if (startAuditInput.value && startAuditInput.value > releaseDateInput.value) {
                    startAuditInput.value = releaseDateInput.value;
                }
                if (endAuditInput.value && endAuditInput.value > maxEndDate) {
                    endAuditInput.value = maxEndDate;
                }
            } else {
                startAuditInput.removeAttribute('max');
                endAuditInput.removeAttribute('max');
            }
        };

        const setEndMinFromStart = () => {
            if (startAuditInput.value) {
                endAuditInput.min = startAuditInput.value;
                if (endAuditInput.value && endAuditInput.value < startAuditInput.value) {
                    endAuditInput.value = startAuditInput.value;
                }
            } else {
                endAuditInput.removeAttribute('min');
            }
        };

        startAuditInput.addEventListener('change', () => {
            setEndMinFromStart();
            setReleaseMinFromEnd();
            setStartEndMaxFromRelease();
        });

        endAuditInput.addEventListener('change', () => {
            setReleaseMinFromEnd();
            setEndMinFromStart();
            setStartEndMaxFromRelease();
        });

        releaseDateInput.addEventListener('change', () => {
            setStartEndMaxFromRelease();
            setEndMinFromStart();
            setReleaseMinFromEnd();
        });

        setEndMinFromStart();
        setReleaseMinFromEnd();
        setStartEndMaxFromRelease();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const startDateInput = document.getElementById('publicIpStartDate');
        const endDateInput = document.getElementById('publicIpEndDate');

        if (!startDateInput || !endDateInput) {
            return;
        }

        const applyEndConstraints = () => {
            if (startDateInput.value) {
                endDateInput.min = startDateInput.value;
                if (endDateInput.value && endDateInput.value < startDateInput.value) {
                    endDateInput.value = startDateInput.value;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const applyStartConstraints = () => {
            if (endDateInput.value) {
                startDateInput.max = endDateInput.value;
                if (startDateInput.value && startDateInput.value > endDateInput.value) {
                    startDateInput.value = endDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('max');
            }
        };

        const syncConstraints = () => {
            applyEndConstraints();
            applyStartConstraints();
        };

        startDateInput.addEventListener('change', syncConstraints);
        endDateInput.addEventListener('change', syncConstraints);

        syncConstraints();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const releaseDateInput = document.getElementById('publicIpFollowUpFirstAuditReportDate');
        const startDateInput = document.getElementById('publicIpFollowUpStartDate');
        const endDateInput = document.getElementById('publicIpFollowUpEndDate');

        if (!releaseDateInput || !startDateInput || !endDateInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        const enforceStartConstraints = () => {
            if (releaseDateInput.value) {
                startDateInput.min = releaseDateInput.value;
                if (startDateInput.value && startDateInput.value < releaseDateInput.value) {
                    startDateInput.value = releaseDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('min');
            }
        };

        const enforceReleaseConstraints = () => {
            if (startDateInput.value) {
                releaseDateInput.max = startDateInput.value;
                if (releaseDateInput.value && releaseDateInput.value > startDateInput.value) {
                    releaseDateInput.value = startDateInput.value;
                }
            } else {
                releaseDateInput.removeAttribute('max');
            }
        };

        const enforceEndConstraints = () => {
            const candidates = [];

            if (releaseDateInput.value) {
                candidates.push(releaseDateInput.value);
            }

            if (startDateInput.value) {
                const minFromStart = new Date(startDateInput.value);
                minFromStart.setDate(minFromStart.getDate() + 1);
                candidates.push(formatDate(minFromStart));
            }

            if (candidates.length) {
                const minValue = candidates.reduce((max, current) => current > max ? current : max, candidates[0]);
                endDateInput.min = minValue;
                if (endDateInput.value && endDateInput.value < minValue) {
                    endDateInput.value = minValue;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const ensureEndNotBeforeRelease = () => {
            if (releaseDateInput.value && endDateInput.value && endDateInput.value < releaseDateInput.value) {
                endDateInput.value = releaseDateInput.value;
            }
        };

        const syncConstraints = () => {
            enforceStartConstraints();
            enforceReleaseConstraints();
            enforceEndConstraints();
            ensureEndNotBeforeRelease();
        };

        releaseDateInput.addEventListener('change', syncConstraints);
        startDateInput.addEventListener('change', syncConstraints);
        endDateInput.addEventListener('change', () => {
            enforceReleaseConstraints();
            enforceEndConstraints();
            ensureEndNotBeforeRelease();
        });

        syncConstraints();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const startDateInput = document.getElementById('publicIpMetaStartDate');
        const endDateInput = document.getElementById('publicIpMetaEndDate');

        if (!startDateInput || !endDateInput) {
            return;
        }

        const applyEndConstraints = () => {
            if (startDateInput.value) {
                endDateInput.min = startDateInput.value;
                if (endDateInput.value && endDateInput.value < startDateInput.value) {
                    endDateInput.value = startDateInput.value;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const applyStartConstraints = () => {
            if (endDateInput.value) {
                startDateInput.max = endDateInput.value;
                if (startDateInput.value && startDateInput.value > endDateInput.value) {
                    startDateInput.value = endDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('max');
            }
        };

        const syncConstraints = () => {
            applyEndConstraints();
            applyStartConstraints();
        };

        startDateInput.addEventListener('change', syncConstraints);
        endDateInput.addEventListener('change', syncConstraints);

        syncConstraints();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const startDateInput = document.getElementById('publicIpFollowUpMetaStartDate');
        const endDateInput = document.getElementById('publicIpFollowUpMetaEndDate');

        if (!startDateInput || !endDateInput) {
            return;
        }

        const applyEndConstraints = () => {
            if (startDateInput.value) {
                endDateInput.min = startDateInput.value;
                if (endDateInput.value && endDateInput.value < startDateInput.value) {
                    endDateInput.value = startDateInput.value;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const applyStartConstraints = () => {
            if (endDateInput.value) {
                startDateInput.max = endDateInput.value;
                if (startDateInput.value && startDateInput.value > endDateInput.value) {
                    startDateInput.value = endDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('max');
            }
        };

        const syncConstraints = () => {
            applyEndConstraints();
            applyStartConstraints();
        };

        startDateInput.addEventListener('change', syncConstraints);
        endDateInput.addEventListener('change', syncConstraints);

        syncConstraints();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const startDateInput = document.getElementById('webAppStartDate');
        const endDateInput = document.getElementById('webAppEndDate');

        if (!startDateInput || !endDateInput) {
            return;
        }

        const applyEndConstraints = () => {
            if (startDateInput.value) {
                endDateInput.min = startDateInput.value;
                if (endDateInput.value && endDateInput.value < startDateInput.value) {
                    endDateInput.value = startDateInput.value;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const applyStartConstraints = () => {
            if (endDateInput.value) {
                startDateInput.max = endDateInput.value;
                if (startDateInput.value && startDateInput.value > endDateInput.value) {
                    startDateInput.value = endDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('max');
            }
        };

        const syncConstraints = () => {
            applyEndConstraints();
            applyStartConstraints();
        };

        startDateInput.addEventListener('change', syncConstraints);
        endDateInput.addEventListener('change', syncConstraints);

        syncConstraints();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const releaseDateInput = document.getElementById('webAppFollowUpFirstAuditReportDate');
        const startDateInput = document.getElementById('webAppFollowUpStartDate');
        const endDateInput = document.getElementById('webAppFollowUpEndDate');

        if (!releaseDateInput || !startDateInput || !endDateInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        const enforceStartConstraints = () => {
            if (releaseDateInput.value) {
                startDateInput.min = releaseDateInput.value;
                if (startDateInput.value && startDateInput.value < releaseDateInput.value) {
                    startDateInput.value = releaseDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('min');
            }
        };

        const enforceReleaseConstraints = () => {
            if (startDateInput.value) {
                releaseDateInput.max = startDateInput.value;
                if (releaseDateInput.value && releaseDateInput.value > startDateInput.value) {
                    releaseDateInput.value = startDateInput.value;
                }
            } else {
                releaseDateInput.removeAttribute('max');
            }
        };

        const enforceEndConstraints = () => {
            const candidates = [];

            if (releaseDateInput.value) {
                candidates.push(releaseDateInput.value);
            }

            if (startDateInput.value) {
                const minFromStart = new Date(startDateInput.value);
                minFromStart.setDate(minFromStart.getDate() + 1);
                candidates.push(formatDate(minFromStart));
            }

            if (candidates.length) {
                const minValue = candidates.reduce((max, current) => current > max ? current : max, candidates[0]);
                endDateInput.min = minValue;
                if (endDateInput.value && endDateInput.value < minValue) {
                    endDateInput.value = minValue;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const ensureEndNotBeforeRelease = () => {
            if (releaseDateInput.value && endDateInput.value && endDateInput.value < releaseDateInput.value) {
                endDateInput.value = releaseDateInput.value;
            }
        };

        const syncConstraints = () => {
            enforceStartConstraints();
            enforceReleaseConstraints();
            enforceEndConstraints();
            ensureEndNotBeforeRelease();
        };

        releaseDateInput.addEventListener('change', syncConstraints);
        startDateInput.addEventListener('change', syncConstraints);
        endDateInput.addEventListener('change', () => {
            enforceReleaseConstraints();
            enforceEndConstraints();
            ensureEndNotBeforeRelease();
        });

        syncConstraints();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const startDateInput = document.getElementById('webAppVaptMetaStartDate');
        const endDateInput = document.getElementById('webAppVaptMetaEndDate');

        if (!startDateInput || !endDateInput) {
            return;
        }

        const applyEndConstraints = () => {
            if (startDateInput.value) {
                endDateInput.min = startDateInput.value;
                if (endDateInput.value && endDateInput.value < startDateInput.value) {
                    endDateInput.value = startDateInput.value;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const applyStartConstraints = () => {
            if (endDateInput.value) {
                startDateInput.max = endDateInput.value;
                if (startDateInput.value && startDateInput.value > endDateInput.value) {
                    startDateInput.value = endDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('max');
            }
        };

        const syncConstraints = () => {
            applyEndConstraints();
            applyStartConstraints();
        };

        startDateInput.addEventListener('change', syncConstraints);
        endDateInput.addEventListener('change', syncConstraints);

        syncConstraints();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const startDateInput = document.getElementById('webAppVaptFollowUpMetaStartDate');
        const endDateInput = document.getElementById('webAppVaptFollowUpMetaEndDate');

        if (!startDateInput || !endDateInput) {
            return;
        }

        const applyEndConstraints = () => {
            if (startDateInput.value) {
                endDateInput.min = startDateInput.value;
                if (endDateInput.value && endDateInput.value < startDateInput.value) {
                    endDateInput.value = startDateInput.value;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const applyStartConstraints = () => {
            if (endDateInput.value) {
                startDateInput.max = endDateInput.value;
                if (startDateInput.value && startDateInput.value > endDateInput.value) {
                    startDateInput.value = endDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('max');
            }
        };

        const syncConstraints = () => {
            applyEndConstraints();
            applyStartConstraints();
        };

        startDateInput.addEventListener('change', syncConstraints);
        endDateInput.addEventListener('change', syncConstraints);

        syncConstraints();
    });

    // Date constraints for Web Application VAPT Follow-Up Audit Meta Data form
    // Constraint between Start Audit Date and Date of Audit Completion
    document.addEventListener('DOMContentLoaded', function() {
        const startAuditInput = document.getElementById('webAppVaptFollowUpMetaStartDate');
        const dateCompletionInput = document.getElementById('webAppVaptFollowUpMetaDateCompletion');

        if (!startAuditInput || !dateCompletionInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        // When start audit date changes, set minimum date for date of completion (start date + 1 day)
        const applyCompletionDateMinConstraint = () => {
            if (startAuditInput.value) {
                const startDate = new Date(startAuditInput.value);
                // Set minimum to start date + 1 day (so completion date must be after start date)
                const minDate = new Date(startDate);
                minDate.setDate(minDate.getDate() + 1);
                const minDateStr = formatDate(minDate);
                dateCompletionInput.setAttribute('min', minDateStr);
                // If completion date is before or equal to start date, clear it
                if (dateCompletionInput.value && dateCompletionInput.value <= startAuditInput.value) {
                    dateCompletionInput.value = '';
                }
            } else {
                dateCompletionInput.removeAttribute('min');
            }
        };

        // When date of completion changes, set maximum date for start audit date (completion date - 1 day)
        const applyStartDateMaxConstraint = () => {
            if (dateCompletionInput.value) {
                const completionDate = new Date(dateCompletionInput.value);
                // Set maximum to completion date - 1 day (so start date must be before completion date)
                const maxDate = new Date(completionDate);
                maxDate.setDate(maxDate.getDate() - 1);
                const maxDateStr = formatDate(maxDate);
                startAuditInput.setAttribute('max', maxDateStr);
                // If start date is after or equal to completion date, clear it
                if (startAuditInput.value && startAuditInput.value >= dateCompletionInput.value) {
                    startAuditInput.value = '';
                }
            } else {
                startAuditInput.removeAttribute('max');
            }
        };

        // Add event listeners
        startAuditInput.addEventListener('change', () => {
            applyCompletionDateMinConstraint();
        });

        dateCompletionInput.addEventListener('change', () => {
            applyStartDateMaxConstraint();
        });

        // Apply constraints on page load if values are already set
        applyCompletionDateMinConstraint();
        applyStartDateMaxConstraint();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const startDateInput = document.getElementById('androidAppStartDate');
        const endDateInput = document.getElementById('androidAppEndDate');

        if (!startDateInput || !endDateInput) {
            return;
        }

        const applyEndConstraints = () => {
            if (startDateInput.value) {
                endDateInput.min = startDateInput.value;
                if (endDateInput.value && endDateInput.value < startDateInput.value) {
                    endDateInput.value = startDateInput.value;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const applyStartConstraints = () => {
            if (endDateInput.value) {
                startDateInput.max = endDateInput.value;
                if (startDateInput.value && startDateInput.value > endDateInput.value) {
                    startDateInput.value = endDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('max');
            }
        };

        const syncConstraints = () => {
            applyEndConstraints();
            applyStartConstraints();
        };

        startDateInput.addEventListener('change', syncConstraints);
        endDateInput.addEventListener('change', syncConstraints);

        syncConstraints();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const releaseDateInput = document.getElementById('androidAppFollowUpFirstAuditReportDate');
        const startDateInput = document.getElementById('androidAppFollowUpStartDate');
        const endDateInput = document.getElementById('androidAppFollowUpEndDate');

        if (!releaseDateInput || !startDateInput || !endDateInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        const enforceStartConstraints = () => {
            if (releaseDateInput.value) {
                startDateInput.min = releaseDateInput.value;
                if (startDateInput.value && startDateInput.value < releaseDateInput.value) {
                    startDateInput.value = releaseDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('min');
            }
        };

        const enforceReleaseConstraints = () => {
            if (startDateInput.value) {
                releaseDateInput.max = startDateInput.value;
                if (releaseDateInput.value && releaseDateInput.value > startDateInput.value) {
                    releaseDateInput.value = startDateInput.value;
                }
            } else {
                releaseDateInput.removeAttribute('max');
            }
        };

        const enforceEndConstraints = () => {
            const candidates = [];

            if (releaseDateInput.value) {
                candidates.push(releaseDateInput.value);
            }

            if (startDateInput.value) {
                const minFromStart = new Date(startDateInput.value);
                minFromStart.setDate(minFromStart.getDate() + 1);
                candidates.push(formatDate(minFromStart));
            }

            if (candidates.length) {
                const minValue = candidates.reduce((max, current) => current > max ? current : max, candidates[0]);
                endDateInput.min = minValue;
                if (endDateInput.value && endDateInput.value < minValue) {
                    endDateInput.value = minValue;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const ensureEndNotBeforeRelease = () => {
            if (releaseDateInput.value && endDateInput.value && endDateInput.value < releaseDateInput.value) {
                endDateInput.value = releaseDateInput.value;
            }
        };

        const syncConstraints = () => {
            enforceStartConstraints();
            enforceReleaseConstraints();
            enforceEndConstraints();
            ensureEndNotBeforeRelease();
        };

        releaseDateInput.addEventListener('change', syncConstraints);
        startDateInput.addEventListener('change', syncConstraints);
        endDateInput.addEventListener('change', () => {
            enforceReleaseConstraints();
            enforceEndConstraints();
            ensureEndNotBeforeRelease();
        });

        syncConstraints();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const startDateInput = document.getElementById('androidVaptMetaStartDate');
        const endDateInput = document.getElementById('androidVaptMetaEndDate');

        if (!startDateInput || !endDateInput) {
            return;
        }

        const applyEndConstraints = () => {
            if (startDateInput.value) {
                endDateInput.min = startDateInput.value;
                if (endDateInput.value && endDateInput.value < startDateInput.value) {
                    endDateInput.value = startDateInput.value;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const applyStartConstraints = () => {
            if (endDateInput.value) {
                startDateInput.max = endDateInput.value;
                if (startDateInput.value && startDateInput.value > endDateInput.value) {
                    startDateInput.value = endDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('max');
            }
        };

        const syncConstraints = () => {
            applyEndConstraints();
            applyStartConstraints();
        };

        startDateInput.addEventListener('change', syncConstraints);
        endDateInput.addEventListener('change', syncConstraints);

        syncConstraints();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const startDateInput = document.getElementById('androidVaptFollowUpMetaStartDate');
        const endDateInput = document.getElementById('androidVaptFollowUpMetaEndDate');

        if (!startDateInput || !endDateInput) {
            return;
        }

        const applyEndConstraints = () => {
            if (startDateInput.value) {
                endDateInput.min = startDateInput.value;
                if (endDateInput.value && endDateInput.value < startDateInput.value) {
                    endDateInput.value = startDateInput.value;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const applyStartConstraints = () => {
            if (endDateInput.value) {
                startDateInput.max = endDateInput.value;
                if (startDateInput.value && startDateInput.value > endDateInput.value) {
                    startDateInput.value = endDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('max');
            }
        };

        const syncConstraints = () => {
            applyEndConstraints();
            applyStartConstraints();
        };

        startDateInput.addEventListener('change', syncConstraints);
        endDateInput.addEventListener('change', syncConstraints);

        syncConstraints();
    });

    // Date constraints for Android VAPT Follow-Up Audit Meta Data form
    // Constraint between Start Audit Date and Date of Audit Completion
    document.addEventListener('DOMContentLoaded', function() {
        const startAuditInput = document.getElementById('androidVaptFollowUpMetaStartDate');
        const dateCompletionInput = document.getElementById('androidVaptFollowUpMetaDateCompletion');

        if (!startAuditInput || !dateCompletionInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        // When start audit date changes, set minimum date for date of completion (start date + 1 day)
        const applyCompletionDateMinConstraint = () => {
            if (startAuditInput.value) {
                const startDate = new Date(startAuditInput.value);
                // Set minimum to start date + 1 day (so completion date must be after start date)
                const minDate = new Date(startDate);
                minDate.setDate(minDate.getDate() + 1);
                const minDateStr = formatDate(minDate);
                dateCompletionInput.setAttribute('min', minDateStr);
                // If completion date is before or equal to start date, clear it
                if (dateCompletionInput.value && dateCompletionInput.value <= startAuditInput.value) {
                    dateCompletionInput.value = '';
                }
            } else {
                dateCompletionInput.removeAttribute('min');
            }
        };

        // When date of completion changes, set maximum date for start audit date (completion date - 1 day)
        const applyStartDateMaxConstraint = () => {
            if (dateCompletionInput.value) {
                const completionDate = new Date(dateCompletionInput.value);
                // Set maximum to completion date - 1 day (so start date must be before completion date)
                const maxDate = new Date(completionDate);
                maxDate.setDate(maxDate.getDate() - 1);
                const maxDateStr = formatDate(maxDate);
                startAuditInput.setAttribute('max', maxDateStr);
                // If start date is after or equal to completion date, clear it
                if (startAuditInput.value && startAuditInput.value >= dateCompletionInput.value) {
                    startAuditInput.value = '';
                }
            } else {
                startAuditInput.removeAttribute('max');
            }
        };

        // Add event listeners
        startAuditInput.addEventListener('change', () => {
            applyCompletionDateMinConstraint();
        });

        dateCompletionInput.addEventListener('change', () => {
            applyStartDateMaxConstraint();
        });

        // Apply constraints on page load if values are already set
        applyCompletionDateMinConstraint();
        applyStartDateMaxConstraint();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const startDateInput = document.getElementById('iosAppStartDate');
        const endDateInput = document.getElementById('iosAppEndDate');

        if (!startDateInput || !endDateInput) {
            return;
        }

        const applyEndConstraints = () => {
            if (startDateInput.value) {
                endDateInput.min = startDateInput.value;
                if (endDateInput.value && endDateInput.value < startDateInput.value) {
                    endDateInput.value = startDateInput.value;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const applyStartConstraints = () => {
            if (endDateInput.value) {
                startDateInput.max = endDateInput.value;
                if (startDateInput.value && startDateInput.value > endDateInput.value) {
                    startDateInput.value = endDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('max');
            }
        };

        const syncConstraints = () => {
            applyEndConstraints();
            applyStartConstraints();
        };

        startDateInput.addEventListener('change', syncConstraints);
        endDateInput.addEventListener('change', syncConstraints);

        syncConstraints();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const releaseDateInput = document.getElementById('iosAppFollowUpFirstAuditReportDate');
        const startDateInput = document.getElementById('iosAppFollowUpStartDate');
        const endDateInput = document.getElementById('iosAppFollowUpEndDate');

        if (!releaseDateInput || !startDateInput || !endDateInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        const enforceStartConstraints = () => {
            if (releaseDateInput.value) {
                startDateInput.min = releaseDateInput.value;
                if (startDateInput.value && startDateInput.value < releaseDateInput.value) {
                    startDateInput.value = releaseDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('min');
            }
        };

        const enforceReleaseConstraints = () => {
            if (startDateInput.value) {
                releaseDateInput.max = startDateInput.value;
                if (releaseDateInput.value && releaseDateInput.value > startDateInput.value) {
                    releaseDateInput.value = startDateInput.value;
                }
            } else {
                releaseDateInput.removeAttribute('max');
            }
        };

        const enforceEndConstraints = () => {
            const candidates = [];

            if (releaseDateInput.value) {
                candidates.push(releaseDateInput.value);
            }

            if (startDateInput.value) {
                const minFromStart = new Date(startDateInput.value);
                minFromStart.setDate(minFromStart.getDate() + 1);
                candidates.push(formatDate(minFromStart));
            }

            if (candidates.length) {
                const minValue = candidates.reduce((max, current) => current > max ? current : max, candidates[0]);
                endDateInput.min = minValue;
                if (endDateInput.value && endDateInput.value < minValue) {
                    endDateInput.value = minValue;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const ensureEndNotBeforeRelease = () => {
            if (releaseDateInput.value && endDateInput.value && endDateInput.value < releaseDateInput.value) {
                endDateInput.value = releaseDateInput.value;
            }
        };

        const syncConstraints = () => {
            enforceStartConstraints();
            enforceReleaseConstraints();
            enforceEndConstraints();
            ensureEndNotBeforeRelease();
        };

        releaseDateInput.addEventListener('change', syncConstraints);
        startDateInput.addEventListener('change', syncConstraints);
        endDateInput.addEventListener('change', () => {
            enforceReleaseConstraints();
            enforceEndConstraints();
            ensureEndNotBeforeRelease();
        });

        syncConstraints();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const startDateInput = document.getElementById('iosVaptMetaStartDate');
        const endDateInput = document.getElementById('iosVaptMetaEndDate');

        if (!startDateInput || !endDateInput) {
            return;
        }

        const applyEndConstraints = () => {
            if (startDateInput.value) {
                endDateInput.min = startDateInput.value;
                if (endDateInput.value && endDateInput.value < startDateInput.value) {
                    endDateInput.value = startDateInput.value;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const applyStartConstraints = () => {
            if (endDateInput.value) {
                startDateInput.max = endDateInput.value;
                if (startDateInput.value && startDateInput.value > endDateInput.value) {
                    startDateInput.value = endDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('max');
            }
        };

        const syncConstraints = () => {
            applyEndConstraints();
            applyStartConstraints();
        };

        startDateInput.addEventListener('change', syncConstraints);
        endDateInput.addEventListener('change', syncConstraints);

        syncConstraints();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const startDateInput = document.getElementById('iosVaptFollowUpMetaStartDate');
        const endDateInput = document.getElementById('iosVaptFollowUpMetaEndDate');

        if (!startDateInput || !endDateInput) {
            return;
        }

        const applyEndConstraints = () => {
            if (startDateInput.value) {
                endDateInput.min = startDateInput.value;
                if (endDateInput.value && endDateInput.value < startDateInput.value) {
                    endDateInput.value = startDateInput.value;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const applyStartConstraints = () => {
            if (endDateInput.value) {
                startDateInput.max = endDateInput.value;
                if (startDateInput.value && startDateInput.value > endDateInput.value) {
                    startDateInput.value = endDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('max');
            }
        };

        const syncConstraints = () => {
            applyEndConstraints();
            applyStartConstraints();
        };

        startDateInput.addEventListener('change', syncConstraints);
        endDateInput.addEventListener('change', syncConstraints);

        syncConstraints();
    });

    // Date constraints for iOS VAPT Follow-Up Audit Meta Data form
    // Constraint between Start Audit Date and Date of Audit Completion
    document.addEventListener('DOMContentLoaded', function() {
        const startAuditInput = document.getElementById('iosVaptFollowUpMetaStartDate');
        const dateCompletionInput = document.getElementById('iosVaptFollowUpMetaDateCompletion');

        if (!startAuditInput || !dateCompletionInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        // When start audit date changes, set minimum date for date of completion (start date + 1 day)
        const applyCompletionDateMinConstraint = () => {
            if (startAuditInput.value) {
                const startDate = new Date(startAuditInput.value);
                // Set minimum to start date + 1 day (so completion date must be after start date)
                const minDate = new Date(startDate);
                minDate.setDate(minDate.getDate() + 1);
                const minDateStr = formatDate(minDate);
                dateCompletionInput.setAttribute('min', minDateStr);
                // If completion date is before or equal to start date, clear it
                if (dateCompletionInput.value && dateCompletionInput.value <= startAuditInput.value) {
                    dateCompletionInput.value = '';
                }
            } else {
                dateCompletionInput.removeAttribute('min');
            }
        };

        // When date of completion changes, set maximum date for start audit date (completion date - 1 day)
        const applyStartDateMaxConstraint = () => {
            if (dateCompletionInput.value) {
                const completionDate = new Date(dateCompletionInput.value);
                // Set maximum to completion date - 1 day (so start date must be before completion date)
                const maxDate = new Date(completionDate);
                maxDate.setDate(maxDate.getDate() - 1);
                const maxDateStr = formatDate(maxDate);
                startAuditInput.setAttribute('max', maxDateStr);
                // If start date is after or equal to completion date, clear it
                if (startAuditInput.value && startAuditInput.value >= dateCompletionInput.value) {
                    startAuditInput.value = '';
                }
            } else {
                startAuditInput.removeAttribute('max');
            }
        };

        // Add event listeners
        startAuditInput.addEventListener('change', () => {
            applyCompletionDateMinConstraint();
        });

        dateCompletionInput.addEventListener('change', () => {
            applyStartDateMaxConstraint();
        });

        // Apply constraints on page load if values are already set
        applyCompletionDateMinConstraint();
        applyStartDateMaxConstraint();
    });

    // Date constraints for Public IP VAPT Follow-Up Audit Meta Data form
    // Constraint between Start Audit Date and Date of Audit Completion
    document.addEventListener('DOMContentLoaded', function() {
        const startAuditInput = document.getElementById('publicIpFollowUpMetaStartDate');
        const dateCompletionInput = document.getElementById('publicIpFollowUpMetaDateCompletion');

        if (!startAuditInput || !dateCompletionInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        // When start audit date changes, set minimum date for date of completion (start date + 1 day)
        const applyCompletionDateMinConstraint = () => {
            if (startAuditInput.value) {
                const startDate = new Date(startAuditInput.value);
                // Set minimum to start date + 1 day (so completion date must be after start date)
                const minDate = new Date(startDate);
                minDate.setDate(minDate.getDate() + 1);
                const minDateStr = formatDate(minDate);
                dateCompletionInput.setAttribute('min', minDateStr);
                // If completion date is before or equal to start date, clear it
                if (dateCompletionInput.value && dateCompletionInput.value <= startAuditInput.value) {
                    dateCompletionInput.value = '';
                }
            } else {
                dateCompletionInput.removeAttribute('min');
            }
        };

        // When date of completion changes, set maximum date for start audit date (completion date - 1 day)
        const applyStartDateMaxConstraint = () => {
            if (dateCompletionInput.value) {
                const completionDate = new Date(dateCompletionInput.value);
                // Set maximum to completion date - 1 day (so start date must be before completion date)
                const maxDate = new Date(completionDate);
                maxDate.setDate(maxDate.getDate() - 1);
                const maxDateStr = formatDate(maxDate);
                startAuditInput.setAttribute('max', maxDateStr);
                // If start date is after or equal to completion date, clear it
                if (startAuditInput.value && startAuditInput.value >= dateCompletionInput.value) {
                    startAuditInput.value = '';
                }
            } else {
                startAuditInput.removeAttribute('max');
            }
        };

        // Add event listeners
        startAuditInput.addEventListener('change', () => {
            applyCompletionDateMinConstraint();
        });

        dateCompletionInput.addEventListener('change', () => {
            applyStartDateMaxConstraint();
        });

        // Apply constraints on page load if values are already set
        applyCompletionDateMinConstraint();
        applyStartDateMaxConstraint();
    });

    // Date constraints for API VAPT Follow-Up Audit Meta Data form
    // Constraint between Start Audit Date and Date of Audit Completion
    document.addEventListener('DOMContentLoaded', function() {
        const startAuditInput = document.getElementById('apiFollowUpMetaStartDate');
        const dateCompletionInput = document.getElementById('apiFollowUpMetaDateCompletion');

        if (!startAuditInput || !dateCompletionInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        // When start audit date changes, set minimum date for date of completion (start date + 1 day)
        const applyCompletionDateMinConstraint = () => {
            if (startAuditInput.value) {
                const startDate = new Date(startAuditInput.value);
                // Set minimum to start date + 1 day (so completion date must be after start date)
                const minDate = new Date(startDate);
                minDate.setDate(minDate.getDate() + 1);
                const minDateStr = formatDate(minDate);
                dateCompletionInput.setAttribute('min', minDateStr);
                // If completion date is before or equal to start date, clear it
                if (dateCompletionInput.value && dateCompletionInput.value <= startAuditInput.value) {
                    dateCompletionInput.value = '';
                }
            } else {
                dateCompletionInput.removeAttribute('min');
            }
        };

        // When date of completion changes, set maximum date for start audit date (completion date - 1 day)
        const applyStartDateMaxConstraint = () => {
            if (dateCompletionInput.value) {
                const completionDate = new Date(dateCompletionInput.value);
                // Set maximum to completion date - 1 day (so start date must be before completion date)
                const maxDate = new Date(completionDate);
                maxDate.setDate(maxDate.getDate() - 1);
                const maxDateStr = formatDate(maxDate);
                startAuditInput.setAttribute('max', maxDateStr);
                // If start date is after or equal to completion date, clear it
                if (startAuditInput.value && startAuditInput.value >= dateCompletionInput.value) {
                    startAuditInput.value = '';
                }
            } else {
                startAuditInput.removeAttribute('max');
            }
        };

        // Add event listeners
        startAuditInput.addEventListener('change', () => {
            applyCompletionDateMinConstraint();
        });

        dateCompletionInput.addEventListener('change', () => {
            applyStartDateMaxConstraint();
        });

        // Apply constraints on page load if values are already set
        applyCompletionDateMinConstraint();
        applyStartDateMaxConstraint();
    });

    // Date constraints for Website VAPT Follow-Up Audit Meta Data form
    // Constraint between Start Audit Date and Date of Audit Completion
    document.addEventListener('DOMContentLoaded', function() {
        const startAuditInput = document.getElementById('websiteVaptFollowUpMetaStartDate');
        const dateCompletionInput = document.getElementById('websiteVaptFollowUpMetaDateCompletion');

        if (!startAuditInput || !dateCompletionInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        // When start audit date changes, set minimum date for date of completion (start date + 1 day)
        const applyCompletionDateMinConstraint = () => {
            if (startAuditInput.value) {
                const startDate = new Date(startAuditInput.value);
                // Set minimum to start date + 1 day (so completion date must be after start date)
                const minDate = new Date(startDate);
                minDate.setDate(minDate.getDate() + 1);
                const minDateStr = formatDate(minDate);
                dateCompletionInput.setAttribute('min', minDateStr);
                // If completion date is before or equal to start date, clear it
                if (dateCompletionInput.value && dateCompletionInput.value <= startAuditInput.value) {
                    dateCompletionInput.value = '';
                }
            } else {
                dateCompletionInput.removeAttribute('min');
            }
        };

        // When date of completion changes, set maximum date for start audit date (completion date - 1 day)
        const applyStartDateMaxConstraint = () => {
            if (dateCompletionInput.value) {
                const completionDate = new Date(dateCompletionInput.value);
                // Set maximum to completion date - 1 day (so start date must be before completion date)
                const maxDate = new Date(completionDate);
                maxDate.setDate(maxDate.getDate() - 1);
                const maxDateStr = formatDate(maxDate);
                startAuditInput.setAttribute('max', maxDateStr);
                // If start date is after or equal to completion date, clear it
                if (startAuditInput.value && startAuditInput.value >= dateCompletionInput.value) {
                    startAuditInput.value = '';
                }
            } else {
                startAuditInput.removeAttribute('max');
            }
        };

        // Add event listeners
        startAuditInput.addEventListener('change', () => {
            applyCompletionDateMinConstraint();
        });

        dateCompletionInput.addEventListener('change', () => {
            applyStartDateMaxConstraint();
        });

        // Apply constraints on page load if values are already set
        applyCompletionDateMinConstraint();
        applyStartDateMaxConstraint();
    });

    // Date constraints for Website VAPT First Audit Meta Data form
    // Constraint between Start Audit Date and Date of Audit Completion
    document.addEventListener('DOMContentLoaded', function() {
        const startAuditInput = document.getElementById('websiteVaptMetaStartDate');
        const dateCompletionInput = document.getElementById('websiteVaptMetaDateCompletion');

        if (!startAuditInput || !dateCompletionInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        // When start audit date changes, set minimum date for date of completion (start date + 1 day)
        const applyCompletionDateMinConstraint = () => {
            if (startAuditInput.value) {
                const startDate = new Date(startAuditInput.value);
                // Set minimum to start date + 1 day (so completion date must be after start date)
                const minDate = new Date(startDate);
                minDate.setDate(minDate.getDate() + 1);
                const minDateStr = formatDate(minDate);
                dateCompletionInput.setAttribute('min', minDateStr);
                // If completion date is before or equal to start date, clear it
                if (dateCompletionInput.value && dateCompletionInput.value <= startAuditInput.value) {
                    dateCompletionInput.value = '';
                }
            } else {
                dateCompletionInput.removeAttribute('min');
            }
        };

        // When date of completion changes, set maximum date for start audit date (completion date - 1 day)
        const applyStartDateMaxConstraint = () => {
            if (dateCompletionInput.value) {
                const completionDate = new Date(dateCompletionInput.value);
                // Set maximum to completion date - 1 day (so start date must be before completion date)
                const maxDate = new Date(completionDate);
                maxDate.setDate(maxDate.getDate() - 1);
                const maxDateStr = formatDate(maxDate);
                startAuditInput.setAttribute('max', maxDateStr);
                // If start date is after or equal to completion date, clear it
                if (startAuditInput.value && startAuditInput.value >= dateCompletionInput.value) {
                    startAuditInput.value = '';
                }
            } else {
                startAuditInput.removeAttribute('max');
            }
        };

        // Add event listeners
        startAuditInput.addEventListener('change', () => {
            applyCompletionDateMinConstraint();
        });

        dateCompletionInput.addEventListener('change', () => {
            applyStartDateMaxConstraint();
        });

        // Apply constraints on page load if values are already set
        applyCompletionDateMinConstraint();
        applyStartDateMaxConstraint();
    });

    // Date constraints for Web Application VAPT First Audit Meta Data form
    // Constraint between Start Audit Date and Date of Audit Completion
    document.addEventListener('DOMContentLoaded', function() {
        const startAuditInput = document.getElementById('webAppVaptMetaStartDate');
        const dateCompletionInput = document.getElementById('webAppVaptMetaDateCompletion');

        if (!startAuditInput || !dateCompletionInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        // When start audit date changes, set minimum date for date of completion (start date + 1 day)
        const applyCompletionDateMinConstraint = () => {
            if (startAuditInput.value) {
                const startDate = new Date(startAuditInput.value);
                // Set minimum to start date + 1 day (so completion date must be after start date)
                const minDate = new Date(startDate);
                minDate.setDate(minDate.getDate() + 1);
                const minDateStr = formatDate(minDate);
                dateCompletionInput.setAttribute('min', minDateStr);
                // If completion date is before or equal to start date, clear it
                if (dateCompletionInput.value && dateCompletionInput.value <= startAuditInput.value) {
                    dateCompletionInput.value = '';
                }
            } else {
                dateCompletionInput.removeAttribute('min');
            }
        };

        // When date of completion changes, set maximum date for start audit date (completion date - 1 day)
        const applyStartDateMaxConstraint = () => {
            if (dateCompletionInput.value) {
                const completionDate = new Date(dateCompletionInput.value);
                // Set maximum to completion date - 1 day (so start date must be before completion date)
                const maxDate = new Date(completionDate);
                maxDate.setDate(maxDate.getDate() - 1);
                const maxDateStr = formatDate(maxDate);
                startAuditInput.setAttribute('max', maxDateStr);
                // If start date is after or equal to completion date, clear it
                if (startAuditInput.value && startAuditInput.value >= dateCompletionInput.value) {
                    startAuditInput.value = '';
                }
            } else {
                startAuditInput.removeAttribute('max');
            }
        };

        // Add event listeners
        startAuditInput.addEventListener('change', () => {
            applyCompletionDateMinConstraint();
        });

        dateCompletionInput.addEventListener('change', () => {
            applyStartDateMaxConstraint();
        });

        // Apply constraints on page load if values are already set
        applyCompletionDateMinConstraint();
        applyStartDateMaxConstraint();
    });

    // Date constraints for Android VAPT First Audit Meta Data form
    // Constraint between Start Audit Date and Date of Audit Completion
    document.addEventListener('DOMContentLoaded', function() {
        const startAuditInput = document.getElementById('androidVaptMetaStartDate');
        const dateCompletionInput = document.getElementById('androidVaptMetaDateCompletion');

        if (!startAuditInput || !dateCompletionInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        // When start audit date changes, set minimum date for date of completion (start date + 1 day)
        const applyCompletionDateMinConstraint = () => {
            if (startAuditInput.value) {
                const startDate = new Date(startAuditInput.value);
                // Set minimum to start date + 1 day (so completion date must be after start date)
                const minDate = new Date(startDate);
                minDate.setDate(minDate.getDate() + 1);
                const minDateStr = formatDate(minDate);
                dateCompletionInput.setAttribute('min', minDateStr);
                // If completion date is before or equal to start date, clear it
                if (dateCompletionInput.value && dateCompletionInput.value <= startAuditInput.value) {
                    dateCompletionInput.value = '';
                }
            } else {
                dateCompletionInput.removeAttribute('min');
            }
        };

        // When date of completion changes, set maximum date for start audit date (completion date - 1 day)
        const applyStartDateMaxConstraint = () => {
            if (dateCompletionInput.value) {
                const completionDate = new Date(dateCompletionInput.value);
                // Set maximum to completion date - 1 day (so start date must be before completion date)
                const maxDate = new Date(completionDate);
                maxDate.setDate(maxDate.getDate() - 1);
                const maxDateStr = formatDate(maxDate);
                startAuditInput.setAttribute('max', maxDateStr);
                // If start date is after or equal to completion date, clear it
                if (startAuditInput.value && startAuditInput.value >= dateCompletionInput.value) {
                    startAuditInput.value = '';
                }
            } else {
                startAuditInput.removeAttribute('max');
            }
        };

        // Add event listeners
        startAuditInput.addEventListener('change', () => {
            applyCompletionDateMinConstraint();
        });

        dateCompletionInput.addEventListener('change', () => {
            applyStartDateMaxConstraint();
        });

        // Apply constraints on page load if values are already set
        applyCompletionDateMinConstraint();
        applyStartDateMaxConstraint();
    });

    // Date constraints for iOS VAPT First Audit Meta Data form
    // Constraint between Start Audit Date and Date of Audit Completion
    document.addEventListener('DOMContentLoaded', function() {
        const startAuditInput = document.getElementById('iosVaptMetaStartDate');
        const dateCompletionInput = document.getElementById('iosVaptMetaDateCompletion');

        if (!startAuditInput || !dateCompletionInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        // When start audit date changes, set minimum date for date of completion (start date + 1 day)
        const applyCompletionDateMinConstraint = () => {
            if (startAuditInput.value) {
                const startDate = new Date(startAuditInput.value);
                // Set minimum to start date + 1 day (so completion date must be after start date)
                const minDate = new Date(startDate);
                minDate.setDate(minDate.getDate() + 1);
                const minDateStr = formatDate(minDate);
                dateCompletionInput.setAttribute('min', minDateStr);
                // If completion date is before or equal to start date, clear it
                if (dateCompletionInput.value && dateCompletionInput.value <= startAuditInput.value) {
                    dateCompletionInput.value = '';
                }
            } else {
                dateCompletionInput.removeAttribute('min');
            }
        };

        // When date of completion changes, set maximum date for start audit date (completion date - 1 day)
        const applyStartDateMaxConstraint = () => {
            if (dateCompletionInput.value) {
                const completionDate = new Date(dateCompletionInput.value);
                // Set maximum to completion date - 1 day (so start date must be before completion date)
                const maxDate = new Date(completionDate);
                maxDate.setDate(maxDate.getDate() - 1);
                const maxDateStr = formatDate(maxDate);
                startAuditInput.setAttribute('max', maxDateStr);
                // If start date is after or equal to completion date, clear it
                if (startAuditInput.value && startAuditInput.value >= dateCompletionInput.value) {
                    startAuditInput.value = '';
                }
            } else {
                startAuditInput.removeAttribute('max');
            }
        };

        // Add event listeners
        startAuditInput.addEventListener('change', () => {
            applyCompletionDateMinConstraint();
        });

        dateCompletionInput.addEventListener('change', () => {
            applyStartDateMaxConstraint();
        });

        // Apply constraints on page load if values are already set
        applyCompletionDateMinConstraint();
        applyStartDateMaxConstraint();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const startDateInput = document.getElementById('apiStartDate');
        const endDateInput = document.getElementById('apiEndDate');

        if (!startDateInput || !endDateInput) {
            return;
        }

        const applyEndConstraints = () => {
            if (startDateInput.value) {
                endDateInput.min = startDateInput.value;
                if (endDateInput.value && endDateInput.value < startDateInput.value) {
                    endDateInput.value = startDateInput.value;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const applyStartConstraints = () => {
            if (endDateInput.value) {
                startDateInput.max = endDateInput.value;
                if (startDateInput.value && startDateInput.value > endDateInput.value) {
                    startDateInput.value = endDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('max');
            }
        };

        const syncConstraints = () => {
            applyEndConstraints();
            applyStartConstraints();
        };

        startDateInput.addEventListener('change', syncConstraints);
        endDateInput.addEventListener('change', syncConstraints);

        syncConstraints();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const releaseDateInput = document.getElementById('apiFollowUpFirstAuditReportDate');
        const startDateInput = document.getElementById('apiFollowUpStartDate');
        const endDateInput = document.getElementById('apiFollowUpEndDate');

        if (!releaseDateInput || !startDateInput || !endDateInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        const enforceStartConstraints = () => {
            if (releaseDateInput.value) {
                startDateInput.min = releaseDateInput.value;
                if (startDateInput.value && startDateInput.value < releaseDateInput.value) {
                    startDateInput.value = releaseDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('min');
            }
        };

        const enforceReleaseConstraints = () => {
            if (startDateInput.value) {
                releaseDateInput.max = startDateInput.value;
                if (releaseDateInput.value && releaseDateInput.value > startDateInput.value) {
                    releaseDateInput.value = startDateInput.value;
                }
            } else {
                releaseDateInput.removeAttribute('max');
            }
        };

        const enforceEndConstraints = () => {
            const candidates = [];

            if (releaseDateInput.value) {
                candidates.push(releaseDateInput.value);
            }

            if (startDateInput.value) {
                const minFromStart = new Date(startDateInput.value);
                minFromStart.setDate(minFromStart.getDate() + 1);
                candidates.push(formatDate(minFromStart));
            }

            if (candidates.length) {
                const minValue = candidates.reduce((max, current) => current > max ? current : max, candidates[0]);
                endDateInput.min = minValue;
                if (endDateInput.value && endDateInput.value < minValue) {
                    endDateInput.value = minValue;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const ensureEndNotBeforeRelease = () => {
            if (releaseDateInput.value && endDateInput.value && endDateInput.value < releaseDateInput.value) {
                endDateInput.value = releaseDateInput.value;
            }
        };

        const syncConstraints = () => {
            enforceStartConstraints();
            enforceReleaseConstraints();
            enforceEndConstraints();
            ensureEndNotBeforeRelease();
        };

        releaseDateInput.addEventListener('change', syncConstraints);
        startDateInput.addEventListener('change', syncConstraints);
        endDateInput.addEventListener('change', () => {
            enforceReleaseConstraints();
            enforceEndConstraints();
            ensureEndNotBeforeRelease();
        });

        syncConstraints();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const startDateInput = document.getElementById('apiMetaStartDate');
        const endDateInput = document.getElementById('apiMetaEndDate');

        if (!startDateInput || !endDateInput) {
            return;
        }

        const applyEndConstraints = () => {
            if (startDateInput.value) {
                endDateInput.min = startDateInput.value;
                if (endDateInput.value && endDateInput.value < startDateInput.value) {
                    endDateInput.value = startDateInput.value;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const applyStartConstraints = () => {
            if (endDateInput.value) {
                startDateInput.max = endDateInput.value;
                if (startDateInput.value && startDateInput.value > endDateInput.value) {
                    startDateInput.value = endDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('max');
            }
        };

        const syncConstraints = () => {
            applyEndConstraints();
            applyStartConstraints();
        };

        startDateInput.addEventListener('change', syncConstraints);
        endDateInput.addEventListener('change', syncConstraints);

        syncConstraints();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const startDateInput = document.getElementById('apiFollowUpMetaStartDate');
        const endDateInput = document.getElementById('apiFollowUpMetaEndDate');

        if (!startDateInput || !endDateInput) {
            return;
        }

        const applyEndConstraints = () => {
            if (startDateInput.value) {
                endDateInput.min = startDateInput.value;
                if (endDateInput.value && endDateInput.value < startDateInput.value) {
                    endDateInput.value = startDateInput.value;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const applyStartConstraints = () => {
            if (endDateInput.value) {
                startDateInput.max = endDateInput.value;
                if (startDateInput.value && startDateInput.value > endDateInput.value) {
                    startDateInput.value = endDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('max');
            }
        };

        const syncConstraints = () => {
            applyEndConstraints();
            applyStartConstraints();
        };

        startDateInput.addEventListener('change', syncConstraints);
        endDateInput.addEventListener('change', syncConstraints);

        syncConstraints();
    });

    // Form validation and submission
    if (document.getElementById('vaptFirstAuditForm')) {
        document.getElementById('vaptFirstAuditForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Validate dates
            const startDateInput = document.getElementById('vaptStartDate');
            const endDateInput = document.getElementById('vaptEndDate');
            
            if (!startDateInput.value || !endDateInput.value) {
                alert('Please select both start and end dates');
                return false;
            }
            
            const startDate = new Date(startDateInput.value);
            const endDate = new Date(endDateInput.value);
            
            if (startDate >= endDate) {
                alert('Finish date must be after start date');
                return false;
            }
            
            // Handle organization name
            const organizationSelect = document.getElementById('vaptOrganization');
            const otherOrganizationInput = document.getElementById('vaptOtherOrganization');
            if (organizationSelect.value === 'other') {
                if (!otherOrganizationInput.value || otherOrganizationInput.value.trim() === '') {
                    alert('Please enter the organization name');
                    return false;
                }
            }
            
            // Handle city
            const citySelect = document.getElementById('vaptCity');
            const otherCityInput = document.getElementById('vaptOtherCity');
            if (citySelect.value === 'other') {
                if (!otherCityInput.value || otherCityInput.value.trim() === '') {
                    alert('Please enter the city name');
                    return false;
                }
            }
            
            // Validate at least one team member
            const teamMembers = document.querySelectorAll('#vaptAuditTeamContainer .team-member');
            if (teamMembers.length === 0) {
                alert('Please add at least one team member');
                return false;
            }
            
            // Disable submit button
            const submitBtn = this.querySelector('button[type="submit"]');
            if (submitBtn) {
                submitBtn.disabled = true;
                submitBtn.textContent = 'Processing...';
                submitBtn.style.opacity = '0.6';
                submitBtn.style.cursor = 'not-allowed';
                
                const spinner = document.createElement('span');
                spinner.innerHTML = ' <span style="display: inline-block; width: 16px; height: 16px; border: 2px solid #ffffff; border-radius: 50%; border-top-color: transparent; animation: spin 1s linear infinite;"></span>';
                submitBtn.appendChild(spinner);
            }
            
            // Check vulnerabilities before generating report
            checkVaptVulnerabilitiesBeforeReport(this);
            
            return false;
        });
    }
    
    // Follow-up Audit Form validation and submission
    if (document.getElementById('vaptFollowUpAuditForm')) {
        document.getElementById('vaptFollowUpAuditForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Validate dates
            const startDateInput = document.getElementById('vaptFollowUpStartDate');
            const endDateInput = document.getElementById('vaptFollowUpEndDate');
            const firstAuditDateInput = document.getElementById('vaptFollowUpFirstAuditReportDate');
            
            if (!startDateInput.value || !endDateInput.value || !firstAuditDateInput.value) {
                alert('Please select all required dates');
                return false;
            }
            
            const startDate = new Date(startDateInput.value);
            const endDate = new Date(endDateInput.value);
            const firstAuditDate = new Date(firstAuditDateInput.value);
            
            if (startDate >= endDate) {
                alert('Finish date must be after start date');
                return false;
            }
            
            if (startDate <= firstAuditDate) {
                alert('Follow-up audit start date must be after first audit report date');
                return false;
            }
            
            // Handle organization name
            const organizationSelect = document.getElementById('vaptFollowUpOrganization');
            const otherOrganizationInput = document.getElementById('vaptFollowUpOtherOrganization');
            if (organizationSelect.value === 'other') {
                if (!otherOrganizationInput.value || otherOrganizationInput.value.trim() === '') {
                    alert('Please enter the organization name');
                    return false;
                }
            }
            
            // Handle city
            const citySelect = document.getElementById('vaptFollowUpCity');
            const otherCityInput = document.getElementById('vaptFollowUpOtherCity');
            if (citySelect.value === 'other') {
                if (!otherCityInput.value || otherCityInput.value.trim() === '') {
                    alert('Please enter the city name');
                    return false;
                }
            }
            
            // Validate at least one team member
            const teamMembers = document.querySelectorAll('#vaptFollowUpAuditTeamContainer .team-member');
            if (teamMembers.length === 0) {
                alert('Please add at least one team member');
                return false;
            }
            
            
            // Disable submit button
            const submitBtn = this.querySelector('button[type="submit"]');
            if (submitBtn) {
                submitBtn.disabled = true;
                submitBtn.textContent = 'Processing...';
                submitBtn.style.opacity = '0.6';
                submitBtn.style.cursor = 'not-allowed';
                
                const spinner = document.createElement('span');
                spinner.innerHTML = ' <span style="display: inline-block; width: 16px; height: 16px; border: 2px solid #ffffff; border-radius: 50%; border-top-color: transparent; animation: spin 1s linear infinite;"></span>';
                submitBtn.appendChild(spinner);
            }
            
            // Check vulnerabilities before generating report
            checkVaptFollowUpVulnerabilitiesBeforeReport(this);
            
            return false;
        });
    }
    
    // Function to check vulnerabilities
    function checkVaptVulnerabilitiesBeforeReport(form) {
        const formData = new FormData(form);
        
        // Handle organization name
        const organizationSelect = document.getElementById('vaptOrganization');
        if (organizationSelect.value === 'other') {
            const otherOrganizationInput = document.getElementById('vaptOtherOrganization');
            if (otherOrganizationInput.value && otherOrganizationInput.value.trim() !== '') {
                formData.set('organization', otherOrganizationInput.value);
            }
        }
        
        // Handle city
        const citySelect = document.getElementById('vaptCity');
        if (citySelect.value === 'other') {
            const otherCityInput = document.getElementById('vaptOtherCity');
            if (otherCityInput.value && otherCityInput.value.trim() !== '') {
                formData.set('city', otherCityInput.value);
            }
        }
        
        // Show loading indicator
        showVaptLoadingIndicator();
        
        fetch('/check_vapt_vulnerabilities', {
            method: 'POST',
            body: formData
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            hideVaptLoadingIndicator();
            
            if (data.error) {
                alert('Error: ' + data.error);
                resetVaptSubmitButtonState();
                return;
            }
            
            // Show vulnerability confirmation dialog
            showVaptVulnerabilityConfirmationDialog(data, form);
        })
        .catch(error => {
            hideVaptLoadingIndicator();
            console.error('Error:', error);
            alert('Error checking vulnerabilities. Please try again.');
            resetVaptSubmitButtonState();
        });
    }
    
    // Reset submit button state
    function resetVaptSubmitButtonState() {
        const submitBtn = document.querySelector('#vaptFirstAuditForm button[type="submit"]');
        if (submitBtn) {
            submitBtn.disabled = false;
            submitBtn.textContent = 'Submit Report';
            submitBtn.style.opacity = '1';
            submitBtn.style.cursor = 'pointer';
            const spinner = submitBtn.querySelector('span');
            if (spinner) spinner.remove();
        }
    }
    
    // Reset Follow-up submit button state
    function resetVaptFollowUpSubmitButtonState() {
        const submitBtn = document.querySelector('#vaptFollowUpAuditForm button[type="submit"]');
        if (submitBtn) {
            submitBtn.disabled = false;
            submitBtn.textContent = 'Submit Report';
            submitBtn.style.opacity = '1';
            submitBtn.style.cursor = 'pointer';
            const spinner = submitBtn.querySelector('span');
            if (spinner) spinner.remove();
        }
    }
    
    // Function to check Follow-up vulnerabilities
    function checkVaptFollowUpVulnerabilitiesBeforeReport(form) {
        const formData = new FormData(form);
        
        // Handle organization name
        const organizationSelect = document.getElementById('vaptFollowUpOrganization');
        if (organizationSelect.value === 'other') {
            const otherOrganizationInput = document.getElementById('vaptFollowUpOtherOrganization');
            if (otherOrganizationInput.value && otherOrganizationInput.value.trim() !== '') {
                formData.set('organization', otherOrganizationInput.value);
            }
        }
        
        // Handle city
        const citySelect = document.getElementById('vaptFollowUpCity');
        if (citySelect.value === 'other') {
            const otherCityInput = document.getElementById('vaptFollowUpOtherCity');
            if (otherCityInput.value && otherCityInput.value.trim() !== '') {
                formData.set('city', otherCityInput.value);
            }
        }
        
        // Show loading indicator
        showVaptLoadingIndicator();
        
        fetch('/vapt_followup_check_vulnerabilities', {
            method: 'POST',
            body: formData
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            hideVaptLoadingIndicator();
            
            if (data.error) {
                alert('Error: ' + data.error);
                resetVaptFollowUpSubmitButtonState();
                return;
            }
            
            // Show vulnerability confirmation dialog
            showVaptFollowUpVulnerabilityConfirmationDialog(data, form);
        })
        .catch(error => {
            hideVaptLoadingIndicator();
            console.error('Error:', error);
            alert('Error checking vulnerabilities. Please try again.');
            resetVaptFollowUpSubmitButtonState();
        });
    }
    
    // Loading indicator functions
    function showVaptLoadingIndicator() {
        const overlay = document.createElement('div');
        overlay.className = 'loading-overlay';
        overlay.id = 'vaptLoadingOverlay';
        overlay.innerHTML = `
            <div class="loading-content">
                <div class="loading-spinner"></div>
                <h3>Processing...</h3>
                <p>Please wait while we check vulnerabilities</p>
            </div>
        `;
        document.body.appendChild(overlay);
    }
    
    function hideVaptLoadingIndicator() {
        const overlay = document.getElementById('vaptLoadingOverlay');
        if (overlay) {
            overlay.remove();
        }
    }
    
    // Global state for VAPT vulnerability merge management
    let vaptVulnerabilityMergeState = {
        matchedGroups: [],
        unmatchedVulnerabilities: [],
        currentForm: null,
        isFollowUp: false  // Track if this is follow-up audit
    };
    
    // Show vulnerability confirmation dialog with full management UI
    function showVaptVulnerabilityConfirmationDialog(vulnData, form) {
        vaptVulnerabilityMergeState.currentForm = form;
        vaptVulnerabilityMergeState.isFollowUp = false;  // First audit
        vaptVulnerabilityMergeState.matchedGroups = vulnData.matched_groups || [];
        vaptVulnerabilityMergeState.unmatchedVulnerabilities = vulnData.unmatched_vulnerabilities || [];
        
        const dialog = document.createElement('div');
        dialog.className = 'vuln-confirmation-dialog';
        dialog.id = 'vaptMainVulnDialog';
        
        const dialogContent = document.createElement('div');
        dialogContent.className = 'dialog-content';
        dialogContent.style.maxWidth = '1400px';
        dialogContent.style.maxHeight = '90vh';
        dialogContent.style.overflow = 'auto';
        
        const title = document.createElement('h2');
        title.textContent = 'Vulnerability Management - Match & Merge';
        title.style.marginBottom = '20px';
        
        dialogContent.appendChild(title);
        
        // Add undo button at the top
        const headerActions = document.createElement('div');
        headerActions.style.marginBottom = '20px';
        headerActions.style.display = 'flex';
        headerActions.style.justifyContent = 'space-between';
        headerActions.style.alignItems = 'center';
        
        const undoButton = document.createElement('button');
        undoButton.textContent = ' Undo Last Operation';
        undoButton.className = 'undo-btn';
        undoButton.style.padding = '8px 16px';
        undoButton.style.backgroundColor = '#f39c12';
        undoButton.style.color = 'white';
        undoButton.style.border = 'none';
        undoButton.style.borderRadius = '4px';
        undoButton.style.cursor = 'pointer';
        undoButton.onclick = undoVaptLastMergeOperation;
        headerActions.appendChild(undoButton);
        
        const refreshInfo = document.createElement('span');
        refreshInfo.textContent = `Matched: ${vaptVulnerabilityMergeState.matchedGroups.length} | Unmatched: ${vaptVulnerabilityMergeState.unmatchedVulnerabilities.length}`;
        refreshInfo.style.fontSize = '14px';
        refreshInfo.style.color = '#666';
        refreshInfo.id = 'vaptVulnCountInfo';
        headerActions.appendChild(refreshInfo);
        
        dialogContent.appendChild(headerActions);
        
        // Check if all vulnerabilities are matched
        if (vaptVulnerabilityMergeState.unmatchedVulnerabilities.length === 0 && vaptVulnerabilityMergeState.matchedGroups.length > 0) {
            const noVulnMsg = document.createElement('div');
            noVulnMsg.textContent = ' All vulnerabilities have been matched with the catalog!';
            noVulnMsg.className = 'no-vulnerabilities';
            noVulnMsg.style.color = '#27ae60';
            noVulnMsg.style.padding = '20px';
            noVulnMsg.style.backgroundColor = '#d5f4e6';
            noVulnMsg.style.borderRadius = '8px';
            noVulnMsg.style.marginBottom = '20px';
            dialogContent.appendChild(noVulnMsg);
            
            renderVaptMatchedVulnerabilitiesSection(dialogContent);
            
            const buttonContainer = document.createElement('div');
            buttonContainer.className = 'button-container';
            buttonContainer.style.marginTop = '20px';
            
            const proceedButton = document.createElement('button');
            proceedButton.textContent = 'Generate Report';
            proceedButton.className = 'proceed-btn';
            proceedButton.onclick = function() {
                proceedButton.disabled = true;
                proceedButton.textContent = 'Processing...';
                dialog.remove();
                generateVaptReport(form);
            };
            
            const cancelButton = document.createElement('button');
            cancelButton.textContent = 'Cancel';
            cancelButton.className = 'cancel-btn';
            cancelButton.onclick = function() {
                dialog.remove();
                resetVaptSubmitButtonState();
            };
            
            buttonContainer.appendChild(proceedButton);
            buttonContainer.appendChild(cancelButton);
            dialogContent.appendChild(buttonContainer);
        } else if (vaptVulnerabilityMergeState.unmatchedVulnerabilities.length === 0 && vaptVulnerabilityMergeState.matchedGroups.length === 0) {
            const noVulnMsg = document.createElement('div');
            noVulnMsg.textContent = 'No vulnerabilities found.';
            noVulnMsg.className = 'no-vulnerabilities';
            dialogContent.appendChild(noVulnMsg);
            
            const buttonContainer = document.createElement('div');
            buttonContainer.className = 'button-container';
            
            const proceedButton = document.createElement('button');
            proceedButton.textContent = 'Generate Report';
            proceedButton.className = 'proceed-btn';
            proceedButton.onclick = function() {
                proceedButton.disabled = true;
                proceedButton.textContent = 'Processing...';
                dialog.remove();
                generateVaptReport(form);
            };
            
            const cancelButton = document.createElement('button');
            cancelButton.textContent = 'Cancel';
            cancelButton.className = 'cancel-btn';
            cancelButton.onclick = function() {
                dialog.remove();
                resetVaptSubmitButtonState();
            };
            
            buttonContainer.appendChild(proceedButton);
            buttonContainer.appendChild(cancelButton);
            dialogContent.appendChild(buttonContainer);
        } else {
            // Create main container with matched and unmatched sections
            const mainContainer = document.createElement('div');
            mainContainer.className = 'vulnerability-management-container';
            mainContainer.id = 'vaptVulnManagementContainer';
            
            // Section 1: Matched Vulnerabilities
            if (vaptVulnerabilityMergeState.matchedGroups.length > 0) {
                renderVaptMatchedVulnerabilitiesSection(mainContainer);
            }
            
            // Section 2: Unmatched Vulnerabilities
            if (vaptVulnerabilityMergeState.unmatchedVulnerabilities.length > 0) {
                renderVaptUnmatchedVulnerabilitiesSection(mainContainer);
            }
            
            dialogContent.appendChild(mainContainer);
            
            // Add action buttons at bottom
            const buttonContainer = document.createElement('div');
            buttonContainer.className = 'button-container';
            buttonContainer.style.marginTop = '30px';
            buttonContainer.style.padding = '20px';
            buttonContainer.style.borderTop = '2px solid #e0e0e0';
            
            const proceedButton = document.createElement('button');
            proceedButton.textContent = 'Generate Report';
            proceedButton.className = 'proceed-btn';
            // Disable button until all vulnerabilities are matched
            const allMatched = vaptVulnerabilityMergeState.unmatchedVulnerabilities.length === 0 && vaptVulnerabilityMergeState.matchedGroups.length > 0;
            proceedButton.disabled = !allMatched;
            proceedButton.id = 'vaptGenerateReportBtn';
            if (!allMatched) {
                proceedButton.style.opacity = '0.6';
                proceedButton.style.cursor = 'not-allowed';
                proceedButton.title = 'Please match all vulnerabilities before generating report';
            }
            proceedButton.onclick = function() {
                if (proceedButton.disabled) return;
                proceedButton.disabled = true;
                proceedButton.textContent = 'Processing...';
                dialog.remove();
                generateVaptReport(form);
            };
            
            const cancelButton = document.createElement('button');
            cancelButton.textContent = 'Cancel';
            cancelButton.className = 'cancel-btn';
            cancelButton.onclick = function() {
                dialog.remove();
                resetVaptSubmitButtonState();
            };
            
            buttonContainer.appendChild(proceedButton);
            buttonContainer.appendChild(cancelButton);
            dialogContent.appendChild(buttonContainer);
        }
        
        dialog.appendChild(dialogContent);
        document.body.appendChild(dialog);
        
        dialog.addEventListener('click', function(e) {
            if (e.target === dialog) {
                // Don't close on backdrop click
            }
        });
    }
    
    // Function to render matched vulnerabilities section
    function renderVaptMatchedVulnerabilitiesSection(container) {
        const matchedSection = document.createElement('div');
        matchedSection.className = 'matched-vulnerabilities-section';
        matchedSection.style.marginBottom = '30px';
        matchedSection.id = 'vaptMatchedVulnSection';
        
        const matchedTitle = document.createElement('h3');
        matchedTitle.textContent = ' Matched Vulnerabilities';
        matchedTitle.style.color = '#27ae60';
        matchedTitle.style.borderBottom = '2px solid #27ae60';
        matchedTitle.style.paddingBottom = '10px';
        matchedTitle.style.marginBottom = '15px';
        matchedSection.appendChild(matchedTitle);
        
        const matchedList = document.createElement('div');
        matchedList.className = 'matched-list';
        matchedList.id = 'vaptMatchedVulnList';
        
        vaptVulnerabilityMergeState.matchedGroups.forEach((group, groupIndex) => {
            const groupDiv = document.createElement('div');
            groupDiv.className = 'matched-group';
            groupDiv.style.marginBottom = '15px';
            groupDiv.style.padding = '15px';
            groupDiv.style.backgroundColor = '#f8f9fa';
            groupDiv.style.borderRadius = '8px';
            groupDiv.style.border = '1px solid #dee2e6';
            
            const groupHeader = document.createElement('div');
            groupHeader.style.display = 'flex';
            groupHeader.style.justifyContent = 'space-between';
            groupHeader.style.alignItems = 'center';
            groupHeader.style.marginBottom = '10px';
            
            const groupInfo = document.createElement('div');
            groupInfo.style.flex = '1';
            
            const groupName = document.createElement('strong');
            groupName.textContent = group.group_name;
            groupName.style.fontSize = '16px';
            groupName.style.color = '#2c3e50';
            groupInfo.appendChild(groupName);
            
            const riskBadge = document.createElement('span');
            riskBadge.textContent = group.risk_factor;
            riskBadge.style.marginLeft = '10px';
            riskBadge.style.padding = '4px 8px';
            riskBadge.style.borderRadius = '4px';
            riskBadge.style.fontSize = '12px';
            riskBadge.style.fontWeight = 'bold';
            
            const riskLower = (group.risk_factor || '').toLowerCase();
            if (riskLower === 'critical') {
                riskBadge.style.backgroundColor = '#8b0000';
                riskBadge.style.color = 'white';
            } else if (riskLower === 'high') {
                riskBadge.style.backgroundColor = '#dc3545';
                riskBadge.style.color = 'white';
            } else if (riskLower === 'medium') {
                riskBadge.style.backgroundColor = '#ffc107';
                riskBadge.style.color = 'black';
            } else if (riskLower === 'low') {
                riskBadge.style.backgroundColor = '#28a745';
                riskBadge.style.color = 'white';
            }
            groupInfo.appendChild(riskBadge);
            
            const mergeButton = document.createElement('button');
            mergeButton.textContent = ' Merge';
            mergeButton.style.padding = '6px 12px';
            mergeButton.style.backgroundColor = '#3498db';
            mergeButton.style.color = 'white';
            mergeButton.style.border = 'none';
            mergeButton.style.borderRadius = '4px';
            mergeButton.style.cursor = 'pointer';
            mergeButton.style.fontSize = '13px';
            mergeButton.onclick = function() {
                showVaptMergeMatchedGroupsDialog(group.catalog_id);
            };
            
            groupHeader.appendChild(groupInfo);
            groupHeader.appendChild(mergeButton);
            groupDiv.appendChild(groupHeader);
            
            const vulnList = document.createElement('ul');
            vulnList.style.marginTop = '10px';
            vulnList.style.marginLeft = '20px';
            vulnList.style.fontSize = '14px';
            vulnList.style.color = '#555';
            
            group.matched_vulnerabilities.forEach(vuln => {
                const vulnItem = document.createElement('li');
                vulnItem.textContent = vuln;
                vulnItem.style.marginBottom = '5px';
                vulnList.appendChild(vulnItem);
            });
            
            groupDiv.appendChild(vulnList);
            matchedList.appendChild(groupDiv);
        });
        
        matchedSection.appendChild(matchedList);
        container.appendChild(matchedSection);
    }
    
    // Function to render unmatched vulnerabilities section
    function renderVaptUnmatchedVulnerabilitiesSection(container) {
        console.log('renderVaptUnmatchedVulnerabilitiesSection called');
        console.log('Unmatched vulnerabilities to render:', vaptVulnerabilityMergeState.unmatchedVulnerabilities);
        console.log('Count:', vaptVulnerabilityMergeState.unmatchedVulnerabilities.length);
        
        const unmatchedSection = document.createElement('div');
        unmatchedSection.className = 'unmatched-vulnerabilities-section';
        unmatchedSection.id = 'vaptUnmatchedVulnSection';
        
        const unmatchedTitle = document.createElement('h3');
        unmatchedTitle.textContent = ' Unmatched Vulnerabilities';
        unmatchedTitle.style.color = '#e74c3c';
        unmatchedTitle.style.borderBottom = '2px solid #e74c3c';
        unmatchedTitle.style.paddingBottom = '10px';
        unmatchedTitle.style.marginBottom = '15px';
        unmatchedSection.appendChild(unmatchedTitle);
        
        const unmatchedList = document.createElement('div');
        unmatchedList.className = 'unmatched-list';
        unmatchedList.id = 'vaptUnmatchedVulnList';
        
        console.log('Starting to iterate through vulnerabilities...');
        vaptVulnerabilityMergeState.unmatchedVulnerabilities.forEach((vuln, vulnIndex) => {
            console.log(`Rendering vulnerability ${vulnIndex}: ${vuln}`);
            const vulnDiv = document.createElement('div');
            vulnDiv.className = 'unmatched-vuln-item';
            vulnDiv.style.marginBottom = '15px';
            vulnDiv.style.padding = '15px';
            vulnDiv.style.backgroundColor = '#fff3cd';
            vulnDiv.style.borderRadius = '8px';
            vulnDiv.style.border = '1px solid #ffc107';
            vulnDiv.style.display = 'flex';
            vulnDiv.style.justifyContent = 'space-between';
            vulnDiv.style.alignItems = 'center';
            
            const vulnName = document.createElement('span');
            vulnName.textContent = vuln;
            vulnName.style.flex = '1';
            vulnName.style.fontSize = '14px';
            vulnName.style.fontWeight = '500';
            
            const actionsDiv = document.createElement('div');
            actionsDiv.style.display = 'flex';
            actionsDiv.style.gap = '8px';
            
            // Button 1: Merge with Matched
            const mergeMatchedBtn = document.createElement('button');
            mergeMatchedBtn.textContent = 'Merge with Matched';
            mergeMatchedBtn.style.padding = '6px 12px';
            mergeMatchedBtn.style.backgroundColor = '#3498db';
            mergeMatchedBtn.style.color = 'white';
            mergeMatchedBtn.style.border = 'none';
            mergeMatchedBtn.style.borderRadius = '4px';
            mergeMatchedBtn.style.cursor = 'pointer';
            mergeMatchedBtn.style.fontSize = '12px';
            mergeMatchedBtn.onclick = function() {
                showVaptMergeWithMatchedDialog(vuln);
            };
            
            // Button 2: Merge with Unmatched
            const mergeUnmatchedBtn = document.createElement('button');
            mergeUnmatchedBtn.textContent = 'Merge with Unmatched';
            mergeUnmatchedBtn.style.padding = '6px 12px';
            mergeUnmatchedBtn.style.backgroundColor = '#9b59b6';
            mergeUnmatchedBtn.style.color = 'white';
            mergeUnmatchedBtn.style.border = 'none';
            mergeUnmatchedBtn.style.borderRadius = '4px';
            mergeUnmatchedBtn.style.cursor = 'pointer';
            mergeUnmatchedBtn.style.fontSize = '12px';
            mergeUnmatchedBtn.onclick = function() {
                showVaptMergeWithUnmatchedDialog(vuln);
            };
            
            // Button 3: Add Details
            const addDetailsBtn = document.createElement('button');
            addDetailsBtn.textContent = 'Add Details';
            addDetailsBtn.style.padding = '6px 12px';
            addDetailsBtn.style.backgroundColor = '#27ae60';
            addDetailsBtn.style.color = 'white';
            addDetailsBtn.style.border = 'none';
            addDetailsBtn.style.borderRadius = '4px';
            addDetailsBtn.style.cursor = 'pointer';
            addDetailsBtn.style.fontSize = '12px';
            addDetailsBtn.onclick = function() {
                showVaptAddDetailsDialog(vuln);
            };
            
            actionsDiv.appendChild(mergeMatchedBtn);
            actionsDiv.appendChild(mergeUnmatchedBtn);
            actionsDiv.appendChild(addDetailsBtn);
            
            vulnDiv.appendChild(vulnName);
            vulnDiv.appendChild(actionsDiv);
            unmatchedList.appendChild(vulnDiv);
        });
        
        console.log('Finished iterating. Total items added to unmatchedList:', unmatchedList.children.length);
        
        unmatchedSection.appendChild(unmatchedList);
        container.appendChild(unmatchedSection);
        
        console.log('Unmatched section appended to container');
    }
    
    // Helper function to refresh the vulnerability management UI
    function refreshVaptVulnerabilityUI() {
        const container = document.getElementById('vaptVulnManagementContainer');
        if (!container) {
            console.warn('VAPT Vulnerability container not found, skipping refresh');
            console.log('Looking for container ID: vaptVulnManagementContainer');
            console.log('Available containers:', document.querySelectorAll('[id*="Vuln"]'));
            return;
        }
        
        console.log('=== REFRESH VAPT UI START ===');
        console.log('State - Matched Groups:', vaptVulnerabilityMergeState.matchedGroups.length);
        console.log('State - Unmatched Vulnerabilities:', vaptVulnerabilityMergeState.unmatchedVulnerabilities.length);
        console.log('Unmatched list:', vaptVulnerabilityMergeState.unmatchedVulnerabilities);
        console.log('Container element:', container);
        console.log('Container parent:', container.parentElement);
        console.log('Container is in DOM:', document.contains(container));
        
        // Clear and rebuild
        container.innerHTML = '';
        console.log('Container cleared, innerHTML:', container.innerHTML.length, 'chars');
        
        // Always render both sections to ensure proper display
        if (vaptVulnerabilityMergeState.matchedGroups.length > 0) {
            console.log('Rendering matched section...');
            renderVaptMatchedVulnerabilitiesSection(container);
        }
        
        if (vaptVulnerabilityMergeState.unmatchedVulnerabilities.length > 0) {
            console.log('Rendering unmatched section with', vaptVulnerabilityMergeState.unmatchedVulnerabilities.length, 'vulnerabilities');
            renderVaptUnmatchedVulnerabilitiesSection(container);
        } else {
            console.log('No unmatched vulnerabilities to render');
        }
        
        // If no unmatched vulnerabilities left, show success message
        if (vaptVulnerabilityMergeState.unmatchedVulnerabilities.length === 0 && vaptVulnerabilityMergeState.matchedGroups.length > 0) {
            console.log('All matched! Showing success message');
            const successMsg = document.createElement('div');
            successMsg.textContent = ' All vulnerabilities matched! Ready to generate report.';
            successMsg.style.color = '#27ae60';
            successMsg.style.padding = '15px';
            successMsg.style.backgroundColor = '#d5f4e6';
            successMsg.style.borderRadius = '8px';
            successMsg.style.marginTop = '20px';
            successMsg.style.textAlign = 'center';
            successMsg.style.fontWeight = 'bold';
            container.appendChild(successMsg);
            
            // Enable the Generate Report button
            const generateReportBtn = document.getElementById('vaptGenerateReportBtn');
            if (generateReportBtn) {
                generateReportBtn.disabled = false;
                generateReportBtn.style.opacity = '1';
                generateReportBtn.style.cursor = 'pointer';
                generateReportBtn.title = '';
            }
        } else {
            // Disable the Generate Report button if not all matched
            const generateReportBtn = document.getElementById('vaptGenerateReportBtn');
            if (generateReportBtn) {
                generateReportBtn.disabled = true;
                generateReportBtn.style.opacity = '0.6';
                generateReportBtn.style.cursor = 'not-allowed';
                generateReportBtn.title = 'Please match all vulnerabilities before generating report';
            }
        }
        
        // Update counter in header
        const countInfo = document.getElementById('vaptVulnCountInfo');
        if (countInfo) {
            countInfo.textContent = `Matched: ${vaptVulnerabilityMergeState.matchedGroups.length} | Unmatched: ${vaptVulnerabilityMergeState.unmatchedVulnerabilities.length}`;
            console.log('Counter updated');
        }
        
        console.log('=== REFRESH VAPT UI END ===');
    }
    
    // Show Follow-up vulnerability confirmation dialog
    function showVaptFollowUpVulnerabilityConfirmationDialog(vulnData, form) {
        vaptVulnerabilityMergeState.currentForm = form;
        vaptVulnerabilityMergeState.isFollowUp = true;  // Follow-up audit
        vaptVulnerabilityMergeState.matchedGroups = vulnData.matched_groups || [];
        vaptVulnerabilityMergeState.unmatchedVulnerabilities = vulnData.unmatched_vulnerabilities || [];
        
        // Use the same dialog function as First Audit - it will handle both
        const dialog = document.createElement('div');
        dialog.className = 'vuln-confirmation-dialog';
        dialog.id = 'vaptFollowUpVulnDialog';
        
        const dialogContent = document.createElement('div');
        dialogContent.className = 'dialog-content';
        dialogContent.style.maxWidth = '1400px';
        dialogContent.style.maxHeight = '90vh';
        dialogContent.style.overflow = 'auto';
        
        const title = document.createElement('h2');
        title.textContent = 'Follow-up Vulnerability Management - Match & Merge';
        title.style.marginBottom = '20px';
        
        dialogContent.appendChild(title);
        
        // Add undo button at the top
        const headerActions = document.createElement('div');
        headerActions.style.marginBottom = '20px';
        headerActions.style.display = 'flex';
        headerActions.style.justifyContent = 'space-between';
        headerActions.style.alignItems = 'center';
        
        const undoButton = document.createElement('button');
        undoButton.textContent = ' Undo Last Operation';
        undoButton.className = 'undo-btn';
        undoButton.style.padding = '8px 16px';
        undoButton.style.backgroundColor = '#f39c12';
        undoButton.style.color = 'white';
        undoButton.style.border = 'none';
        undoButton.style.borderRadius = '4px';
        undoButton.style.cursor = 'pointer';
        undoButton.onclick = undoVaptFollowUpLastMergeOperation;
        headerActions.appendChild(undoButton);
        
        const refreshInfo = document.createElement('span');
        refreshInfo.textContent = `Matched: ${vaptVulnerabilityMergeState.matchedGroups.length} | Unmatched: ${vaptVulnerabilityMergeState.unmatchedVulnerabilities.length}`;
        refreshInfo.style.fontSize = '14px';
        refreshInfo.style.color = '#666';
        refreshInfo.id = 'vaptVulnCountInfo';
        headerActions.appendChild(refreshInfo);
        
        dialogContent.appendChild(headerActions);
        
        const items = vaptVulnerabilityMergeState.unmatchedVulnerabilities;
        
        // Handle different scenarios
        if (items.length === 0 && vaptVulnerabilityMergeState.matchedGroups.length > 0) {
            const noVulnMsg = document.createElement('div');
            noVulnMsg.textContent = ' All vulnerabilities have been matched with the catalog!';
            noVulnMsg.className = 'no-vulnerabilities';
            noVulnMsg.style.color = '#27ae60';
            noVulnMsg.style.padding = '20px';
            noVulnMsg.style.backgroundColor = '#d5f4e6';
            noVulnMsg.style.borderRadius = '8px';
            noVulnMsg.style.marginBottom = '20px';
            dialogContent.appendChild(noVulnMsg);
            
            renderVaptMatchedVulnerabilitiesSection(dialogContent);
            
            const buttonContainer = document.createElement('div');
            buttonContainer.className = 'button-container';
            buttonContainer.style.marginTop = '20px';
            
            const proceedButton = document.createElement('button');
            proceedButton.textContent = 'Generate Report';
            proceedButton.className = 'proceed-btn';
            proceedButton.onclick = function() {
                proceedButton.disabled = true;
                proceedButton.textContent = 'Processing...';
                dialog.remove();
                generateVaptFollowUpReport(form);
            };
            
            const cancelButton = document.createElement('button');
            cancelButton.textContent = 'Cancel';
            cancelButton.className = 'cancel-btn';
            cancelButton.onclick = function() {
                dialog.remove();
                resetVaptFollowUpSubmitButtonState();
            };
            
            buttonContainer.appendChild(proceedButton);
            buttonContainer.appendChild(cancelButton);
            dialogContent.appendChild(buttonContainer);
        } else if (items.length === 0 && vaptVulnerabilityMergeState.matchedGroups.length === 0) {
            // No vulnerabilities at all
            const noVulnMsg = document.createElement('div');
            noVulnMsg.textContent = 'No vulnerabilities found.';
            noVulnMsg.className = 'no-vulnerabilities';
            dialogContent.appendChild(noVulnMsg);
            
            const buttonContainer = document.createElement('div');
            buttonContainer.className = 'button-container';
            
            const proceedButton = document.createElement('button');
            proceedButton.textContent = 'Generate Report';
            proceedButton.className = 'proceed-btn';
            proceedButton.onclick = function() {
                proceedButton.disabled = true;
                proceedButton.textContent = 'Processing...';
                dialog.remove();
                generateVaptFollowUpReport(form);
            };
            
            const cancelButton = document.createElement('button');
            cancelButton.textContent = 'Cancel';
            cancelButton.className = 'cancel-btn';
            cancelButton.onclick = function() {
                dialog.remove();
                resetVaptFollowUpSubmitButtonState();
            };
            
            buttonContainer.appendChild(proceedButton);
            buttonContainer.appendChild(cancelButton);
            dialogContent.appendChild(buttonContainer);
        } else {
            // Create main container with matched and unmatched sections
            const mainContainer = document.createElement('div');
            mainContainer.className = 'vulnerability-management-container';
            mainContainer.id = 'vaptVulnManagementContainer';
            
            if (vaptVulnerabilityMergeState.matchedGroups.length > 0) {
                renderVaptMatchedVulnerabilitiesSection(mainContainer);
            }
            
            if (vaptVulnerabilityMergeState.unmatchedVulnerabilities.length > 0) {
                renderVaptUnmatchedVulnerabilitiesSection(mainContainer);
            }
            
            dialogContent.appendChild(mainContainer);
            
            const buttonContainer = document.createElement('div');
            buttonContainer.className = 'button-container';
            buttonContainer.style.marginTop = '30px';
            buttonContainer.style.padding = '20px';
            buttonContainer.style.borderTop = '2px solid #e0e0e0';
            
            const proceedButton = document.createElement('button');
            proceedButton.textContent = 'Generate Report';
            proceedButton.className = 'proceed-btn';
            // Disable button until all vulnerabilities are matched
            const allMatched = vaptVulnerabilityMergeState.unmatchedVulnerabilities.length === 0 && vaptVulnerabilityMergeState.matchedGroups.length > 0;
            proceedButton.disabled = !allMatched;
            proceedButton.id = 'vaptGenerateReportBtn';
            if (!allMatched) {
                proceedButton.style.opacity = '0.6';
                proceedButton.style.cursor = 'not-allowed';
                proceedButton.title = 'Please match all vulnerabilities before generating report';
            }
            proceedButton.onclick = function() {
                if (proceedButton.disabled) return;
                proceedButton.disabled = true;
                proceedButton.textContent = 'Processing...';
                dialog.remove();
                generateVaptFollowUpReport(form);
            };
            
            const cancelButton = document.createElement('button');
            cancelButton.textContent = 'Cancel';
            cancelButton.className = 'cancel-btn';
            cancelButton.onclick = function() {
                dialog.remove();
                resetVaptFollowUpSubmitButtonState();
            };
            
            buttonContainer.appendChild(proceedButton);
            buttonContainer.appendChild(cancelButton);
            dialogContent.appendChild(buttonContainer);
        }
        
        dialog.appendChild(dialogContent);
        document.body.appendChild(dialog);
        
        dialog.addEventListener('click', function(e) {
            if (e.target === dialog) {
                // Don't close on backdrop click
            }
        });
    }
    
    // Generate VAPT report
    function generateVaptReport(form) {
        const formData = new FormData(form);
        
        // Handle organization name
        const organizationSelect = document.getElementById('vaptOrganization');
        if (organizationSelect.value === 'other') {
            const otherOrganizationInput = document.getElementById('vaptOtherOrganization');
            if (otherOrganizationInput.value && otherOrganizationInput.value.trim() !== '') {
                formData.set('organization', otherOrganizationInput.value);
            }
        }
        
        // Handle city
        const citySelect = document.getElementById('vaptCity');
        if (citySelect.value === 'other') {
            const otherCityInput = document.getElementById('vaptOtherCity');
            if (otherCityInput.value && otherCityInput.value.trim() !== '') {
                formData.set('city', otherCityInput.value);
            }
        }
        
        showVaptLoadingIndicator();
        
        fetch('/process_vapt_first_audit_report', {
            method: 'POST',
            body: formData
        })
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }
            return response.blob();
        })
        .then(blob => {
            hideVaptLoadingIndicator();
            
            // Download the file
            const url = window.URL.createObjectURL(blob);
            const link = document.createElement('a');   
            link.href = url;
            link.download = 'Infrastructure_VAPT_First_Audit_Report.xlsx';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            window.URL.revokeObjectURL(url);
            
            // Close modal and reset
            closeVaptModal('vaptFirstAuditModal');
            
            // Reload page immediately
            location.reload();
        })
        .catch(error => {
            hideVaptLoadingIndicator();
            console.error('Error:', error);
            alert('Error generating report: ' + error.message);
            resetVaptSubmitButtonState();
        });
    }
    
    // Generate VAPT Follow-up Report
    function generateVaptFollowUpReport(form) {
        const formData = new FormData(form);
        
        // Handle organization name
        const organizationSelect = document.getElementById('vaptFollowUpOrganization');
        if (organizationSelect.value === 'other') {
            const otherOrganizationInput = document.getElementById('vaptFollowUpOtherOrganization');
            if (otherOrganizationInput.value && otherOrganizationInput.value.trim() !== '') {
                formData.set('organization', otherOrganizationInput.value);
            }
        }
        
        // Handle city
        const citySelect = document.getElementById('vaptFollowUpCity');
        if (citySelect.value === 'other') {
            const otherCityInput = document.getElementById('vaptFollowUpOtherCity');
            if (otherCityInput.value && otherCityInput.value.trim() !== '') {
                formData.set('city', otherCityInput.value);
            }
        }
        
        showVaptLoadingIndicator();
        
        fetch('/process_vapt_follow_up_audit_report', {
            method: 'POST',
            body: formData
        })
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }
            return response.blob();
        })
        .then(blob => {
            hideVaptLoadingIndicator();
            
            // Download the file
            const url = window.URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'Infrastructure_VAPT_Follow_Up_Audit_Report.xlsx';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            window.URL.revokeObjectURL(url);
            
            // Close modal and reset
            closeVaptModal('vaptFollowUpAuditModal');
            
            // Reload page immediately
            location.reload();
        })
        .catch(error => {
            hideVaptLoadingIndicator();
            console.error('Error:', error);
            alert('Error generating follow-up report: ' + error.message);
            resetVaptFollowUpSubmitButtonState();
        });
    }
    
    // Helper function to get correct endpoint based on audit type
    function getVaptEndpoint(baseName) {
        let endpoint;
        if (vaptVulnerabilityMergeState.isFollowUp) {
            // For follow-up, replace 'merge_vapt_' with 'vapt_followup_merge_'
            // and 'add_vapt_' with 'vapt_followup_add_'
            // and 'undo_vapt_' with 'vapt_followup_undo_'
            if (baseName.startsWith('merge_vapt_')) {
                endpoint = '/vapt_followup_merge_' + baseName.substring(11); // Remove 'merge_vapt_'
            } else if (baseName.startsWith('add_vapt_')) {
                endpoint = '/vapt_followup_add_' + baseName.substring(9); // Remove 'add_vapt_'
            } else if (baseName.startsWith('undo_vapt_')) {
                endpoint = '/vapt_followup_undo_' + baseName.substring(10); // Remove 'undo_vapt_'
            } else {
                endpoint = '/vapt_followup_' + baseName;
            }
        } else {
            endpoint = '/' + baseName;
        }
        console.log(`getVaptEndpoint('${baseName}') -> '${endpoint}' (isFollowUp: ${vaptVulnerabilityMergeState.isFollowUp})`);
        return endpoint;
    }
    
    // Dialog 1: Merge with Matched - Select target matched group
    function showVaptMergeWithMatchedDialog(unmatchedVuln) {
        const dialog = document.createElement('div');
        dialog.className = 'vuln-confirmation-dialog';
        dialog.style.zIndex = '10001';
        
        const dialogContent = document.createElement('div');
        dialogContent.className = 'dialog-content';
        dialogContent.style.maxWidth = '600px';
        
        const title = document.createElement('h3');
        title.textContent = 'Merge with Matched Group';
        title.style.marginBottom = '15px';
        dialogContent.appendChild(title);
        
        const instruction = document.createElement('p');
        instruction.textContent = `Select a matched group to merge "${unmatchedVuln}" into:`;
        instruction.style.marginBottom = '20px';
        instruction.style.fontSize = '14px';
        dialogContent.appendChild(instruction);
        
        const form = document.createElement('div');
        
        vaptVulnerabilityMergeState.matchedGroups.forEach((group, idx) => {
            const radioDiv = document.createElement('div');
            radioDiv.style.marginBottom = '12px';
            radioDiv.style.padding = '10px';
            radioDiv.style.backgroundColor = '#f8f9fa';
            radioDiv.style.borderRadius = '4px';
            
            const radio = document.createElement('input');
            radio.type = 'radio';
            radio.name = 'vapt_target_matched_group';
            radio.value = group.catalog_id;
            radio.id = `vapt_matched_group_${idx}`;
            
            const label = document.createElement('label');
            label.setAttribute('for', `vapt_matched_group_${idx}`);
            label.style.marginLeft = '8px';
            label.style.cursor = 'pointer';
            label.textContent = group.group_name;
            
            radioDiv.appendChild(radio);
            radioDiv.appendChild(label);
            form.appendChild(radioDiv);
        });
        
        dialogContent.appendChild(form);
        
        const buttonContainer = document.createElement('div');
        buttonContainer.className = 'button-container';
        buttonContainer.style.marginTop = '20px';
        
        const confirmBtn = document.createElement('button');
        confirmBtn.textContent = 'Confirm Merge';
        confirmBtn.className = 'proceed-btn';
        confirmBtn.onclick = function() {
            const selectedRadio = document.querySelector('input[name="vapt_target_matched_group"]:checked');
            if (!selectedRadio) {
                alert('Please select a group to merge with');
                return;
            }
            
            confirmBtn.disabled = true;
            confirmBtn.textContent = 'Merging...';
            
            const endpoint = getVaptEndpoint('merge_vapt_with_matched');
            const payload = {
                unmatched_vulnerability: unmatchedVuln,
                target_group_id: parseInt(selectedRadio.value)
            };
            
            console.log('Calling endpoint:', endpoint);
            console.log('Payload:', payload);
            
            fetch(endpoint, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(payload)
            })
            .then(response => {
                console.log('Response status:', response.status);
                console.log('Response OK:', response.ok);
                if (!response.ok) {
                    return response.text().then(text => {
                        console.error('Error response body:', text);
                        throw new Error(`HTTP ${response.status}: ${text}`);
                    });
                }
                return response.json();
            })
            .then(data => {
                console.log('Merge with matched response:', data);
                if (data.success && data.updated_state) {
                    console.log('Before update - Matched:', vaptVulnerabilityMergeState.matchedGroups.length, 'Unmatched:', vaptVulnerabilityMergeState.unmatchedVulnerabilities.length);
                    console.log('From server - Matched:', data.updated_state.matched_groups.length, 'Unmatched:', data.updated_state.unmatched_vulnerabilities.length);
                    
                    // Update the global state with the response
                    vaptVulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups || [];
                    vaptVulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities || [];
                    
                    console.log('After update - Matched:', vaptVulnerabilityMergeState.matchedGroups.length, 'Unmatched:', vaptVulnerabilityMergeState.unmatchedVulnerabilities.length);
                    console.log('Unmatched list:', vaptVulnerabilityMergeState.unmatchedVulnerabilities);
                    
                    // Verify main dialog exists before removing sub-dialog
                    const mainDialog = document.getElementById('vaptMainVulnDialog') || document.getElementById('vaptFollowUpVulnDialog');
                    console.log('Main dialog exists:', !!mainDialog);
                    
                    const containerBeforeRemove = document.getElementById('vaptVulnManagementContainer');
                    console.log('Container exists before sub-dialog remove:', !!containerBeforeRemove);
                    
                    // Remove the sub-dialog first
                    dialog.remove();
                    console.log('Sub-dialog removed');
                    
                    const containerAfterRemove = document.getElementById('vaptVulnManagementContainer');
                    console.log('Container exists after sub-dialog remove:', !!containerAfterRemove);
                    
                    // Then refresh the main UI
                    refreshVaptVulnerabilityUI();
                    
                    alert('Vulnerability merged successfully!');
                } else {
                    alert('Error: ' + (data.error || 'Unknown error occurred'));
                    confirmBtn.disabled = false;
                    confirmBtn.textContent = 'Confirm Merge';
                }
            })
            .catch(error => {
                console.error('Error merging with matched:', error);
                alert('Error merging vulnerability: ' + error.message);
                confirmBtn.disabled = false;
                confirmBtn.textContent = 'Confirm Merge';
            });
        };
        
        const cancelBtn = document.createElement('button');
        cancelBtn.textContent = 'Cancel';
        cancelBtn.className = 'cancel-btn';
        cancelBtn.onclick = function() {
            dialog.remove();
        };
        
        buttonContainer.appendChild(confirmBtn);
        buttonContainer.appendChild(cancelBtn);
        dialogContent.appendChild(buttonContainer);
        
        dialog.appendChild(dialogContent);
        document.body.appendChild(dialog);
    }
    
    // Dialog 2: Merge with Unmatched - Select other unmatched + provide details
    function showVaptMergeWithUnmatchedDialog(primaryVuln) {
        const dialog = document.createElement('div');
        dialog.className = 'vuln-confirmation-dialog';
        dialog.style.zIndex = '10001';
        
        const dialogContent = document.createElement('div');
        dialogContent.className = 'dialog-content';
        dialogContent.style.maxWidth = '800px';
        dialogContent.style.maxHeight = '80vh';
        dialogContent.style.overflow = 'auto';
        
        const title = document.createElement('h3');
        title.textContent = 'Merge with Other Unmatched Vulnerabilities';
        title.style.marginBottom = '15px';
        dialogContent.appendChild(title);
        
        const instruction = document.createElement('p');
        instruction.innerHTML = `<strong>Primary:</strong> ${primaryVuln}<br><br>Select other unmatched vulnerabilities to merge with:`;
        instruction.style.marginBottom = '20px';
        instruction.style.fontSize = '14px';
        dialogContent.appendChild(instruction);
        
        const checkboxContainer = document.createElement('div');
        checkboxContainer.style.marginBottom = '20px';
        checkboxContainer.style.maxHeight = '200px';
        checkboxContainer.style.overflow = 'auto';
        checkboxContainer.style.border = '1px solid #ddd';
        checkboxContainer.style.padding = '10px';
        checkboxContainer.style.borderRadius = '4px';
        
        vaptVulnerabilityMergeState.unmatchedVulnerabilities.forEach((vuln, idx) => {
            if (vuln === primaryVuln) return;
            
            const checkDiv = document.createElement('div');
            checkDiv.style.marginBottom = '8px';
            
            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkbox.value = vuln;
            checkbox.id = `vapt_unmatched_vuln_${idx}`;
            checkbox.className = 'vapt-merge-unmatched-checkbox';
            
            const label = document.createElement('label');
            label.setAttribute('for', `vapt_unmatched_vuln_${idx}`);
            label.style.marginLeft = '8px';
            label.style.cursor = 'pointer';
            label.textContent = vuln;
            
            checkDiv.appendChild(checkbox);
            checkDiv.appendChild(label);
            checkboxContainer.appendChild(checkDiv);
        });
        
        dialogContent.appendChild(checkboxContainer);
        
        const nextBtn = document.createElement('button');
        nextBtn.textContent = 'Next: Provide Group Details';
        nextBtn.className = 'proceed-btn';
        nextBtn.style.width = '100%';
        nextBtn.style.marginBottom = '10px';
        nextBtn.onclick = function() {
            const checkboxes = document.querySelectorAll('.vapt-merge-unmatched-checkbox:checked');
            const selectedVulns = [primaryVuln, ...Array.from(checkboxes).map(cb => cb.value)];
            
            if (selectedVulns.length < 1) {
                alert('No vulnerabilities selected');
                return;
            }
            
            dialog.remove();
            showVaptVulnerabilityDetailsForm(selectedVulns, 'merge_with_unmatched');
        };
        
        const cancelBtn = document.createElement('button');
        cancelBtn.textContent = 'Cancel';
        cancelBtn.className = 'cancel-btn';
        cancelBtn.style.width = '100%';
        cancelBtn.onclick = function() {
            dialog.remove();
        };
        
        dialogContent.appendChild(nextBtn);
        dialogContent.appendChild(cancelBtn);
        
        dialog.appendChild(dialogContent);
        document.body.appendChild(dialog);
    }
    
    // Dialog 3: Add Details - Form for single vulnerability
    function showVaptAddDetailsDialog(vuln) {
        showVaptVulnerabilityDetailsForm([vuln], 'add_details');
    }
    
    // Dialog 4: Merge Matched Groups - Select target for merging
    function showVaptMergeMatchedGroupsDialog(sourceGroupId) {
        const dialog = document.createElement('div');
        dialog.className = 'vuln-confirmation-dialog';
        dialog.style.zIndex = '10001';
        
        const dialogContent = document.createElement('div');
        dialogContent.className = 'dialog-content';
        dialogContent.style.maxWidth = '600px';
        
        const sourceGroup = vaptVulnerabilityMergeState.matchedGroups.find(g => g.catalog_id === sourceGroupId);
        if (!sourceGroup) {
            alert('Source group not found');
            return;
        }
        
        const title = document.createElement('h3');
        title.textContent = 'Merge Matched Groups';
        title.style.marginBottom = '15px';
        dialogContent.appendChild(title);
        
        const instruction = document.createElement('p');
        instruction.innerHTML = `<strong>Merge FROM:</strong> ${sourceGroup.group_name}<br><br>Select target group to merge INTO:`;
        instruction.style.marginBottom = '20px';
        instruction.style.fontSize = '14px';
        dialogContent.appendChild(instruction);
        
        const form = document.createElement('div');
        
        vaptVulnerabilityMergeState.matchedGroups.forEach((group, idx) => {
            if (group.catalog_id === sourceGroupId) return;
            
            const radioDiv = document.createElement('div');
            radioDiv.style.marginBottom = '12px';
            radioDiv.style.padding = '10px';
            radioDiv.style.backgroundColor = '#f8f9fa';
            radioDiv.style.borderRadius = '4px';
            
            const radio = document.createElement('input');
            radio.type = 'radio';
            radio.name = 'vapt_target_group';
            radio.value = group.catalog_id;
            radio.id = `vapt_target_group_${idx}`;
            
            const label = document.createElement('label');
            label.setAttribute('for', `vapt_target_group_${idx}`);
            label.style.marginLeft = '8px';
            label.style.cursor = 'pointer';
            label.textContent = group.group_name;
            
            radioDiv.appendChild(radio);
            radioDiv.appendChild(label);
            form.appendChild(radioDiv);
        });
        
        dialogContent.appendChild(form);
        
        const buttonContainer = document.createElement('div');
        buttonContainer.className = 'button-container';
        buttonContainer.style.marginTop = '20px';
        
        const confirmBtn = document.createElement('button');
        confirmBtn.textContent = 'Confirm Merge';
        confirmBtn.className = 'proceed-btn';
        confirmBtn.onclick = function() {
            const selectedRadio = document.querySelector('input[name="vapt_target_group"]:checked');
            if (!selectedRadio) {
                alert('Please select a target group');
                return;
            }
            
            confirmBtn.disabled = true;
            confirmBtn.textContent = 'Merging...';
            
            const endpoint = getVaptEndpoint('merge_vapt_matched_groups');
            const payload = {
                source_group_id: sourceGroupId,
                target_group_id: parseInt(selectedRadio.value)
            };
            
            console.log('Calling endpoint:', endpoint);
            console.log('Payload:', payload);
            
            fetch(endpoint, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(payload)
            })
            .then(response => {
                console.log('Response status:', response.status);
                console.log('Response OK:', response.ok);
                if (!response.ok) {
                    return response.text().then(text => {
                        console.error('Error response body:', text);
                        throw new Error(`HTTP ${response.status}: ${text}`);
                    });
                }
                return response.json();
            })
            .then(data => {
                console.log('Merge matched groups response:', data);
                if (data.success && data.updated_state) {
                    // Update the global state with the response
                    vaptVulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups || [];
                    vaptVulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities || [];
                    
                    console.log('Updated state - Matched:', vaptVulnerabilityMergeState.matchedGroups.length, 'Unmatched:', vaptVulnerabilityMergeState.unmatchedVulnerabilities.length);
                    
                    // Remove the sub-dialog first
                    dialog.remove();
                    
                    // Then refresh the main UI
                    refreshVaptVulnerabilityUI();
                    
                    alert('Groups merged successfully!');
                } else {
                    alert('Error: ' + (data.error || 'Unknown error occurred'));
                    confirmBtn.disabled = false;
                    confirmBtn.textContent = 'Confirm Merge';
                }
            })
            .catch(error => {
                console.error('Error merging matched groups:', error);
                alert('Error merging groups: ' + error.message);
                confirmBtn.disabled = false;
                confirmBtn.textContent = 'Confirm Merge';
            });
        };
        
        const cancelBtn = document.createElement('button');
        cancelBtn.textContent = 'Cancel';
        cancelBtn.className = 'cancel-btn';
        cancelBtn.onclick = function() {
            dialog.remove();
        };
        
        buttonContainer.appendChild(confirmBtn);
        buttonContainer.appendChild(cancelBtn);
        dialogContent.appendChild(buttonContainer);
        
        dialog.appendChild(dialogContent);
        document.body.appendChild(dialog);
    }
    
    // Comprehensive vulnerability details form
    function showVaptVulnerabilityDetailsForm(vulnerabilities, actionType) {
        const dialog = document.createElement('div');
        dialog.className = 'vuln-confirmation-dialog';
        dialog.style.zIndex = '10002';
        
        const dialogContent = document.createElement('div');
        dialogContent.className = 'dialog-content';
        dialogContent.style.maxWidth = '900px';
        dialogContent.style.maxHeight = '85vh';
        dialogContent.style.overflow = 'auto';
        
        const title = document.createElement('h3');
        title.textContent = actionType === 'add_details' ? 'Add Vulnerability Details' : 'Provide Group Details for Merged Vulnerabilities';
        title.style.marginBottom = '15px';
        dialogContent.appendChild(title);
        
        if (vulnerabilities.length > 1) {
            const vulnList = document.createElement('div');
            vulnList.style.marginBottom = '20px';
            vulnList.style.padding = '10px';
            vulnList.style.backgroundColor = '#f8f9fa';
            vulnList.style.borderRadius = '4px';
            
            const listTitle = document.createElement('strong');
            listTitle.textContent = 'Vulnerabilities in this group:';
            listTitle.style.display = 'block';
            listTitle.style.marginBottom = '8px';
            vulnList.appendChild(listTitle);
            
            const ul = document.createElement('ul');
            ul.style.marginLeft = '20px';
            vulnerabilities.forEach(v => {
                const li = document.createElement('li');
                li.textContent = v;
                li.style.marginBottom = '4px';
                ul.appendChild(li);
            });
            vulnList.appendChild(ul);
            dialogContent.appendChild(vulnList);
        }
        
        const formContainer = document.createElement('div');
        formContainer.style.marginBottom = '20px';
        
        const fields = [
            { name: 'vulnerabilityName', label: 'Vulnerability Group Name', type: 'text', placeholder: 'e.g., Apache Multiple Vulnerabilities', required: true },
            { name: 'riskFactor', label: 'Risk Factor', type: 'select', options: ['', 'LOW', 'MEDIUM', 'HIGH', 'CRITICAL'], required: true },
            { name: 'cveId', label: 'CVE ID', type: 'text', placeholder: 'e.g., CVE-2023-1234 or Multiple', required: false },
            { name: 'cvssScore', label: 'CVSS Score', type: 'text', placeholder: 'e.g., 7.5', required: false },
            { name: 'auditObservation', label: 'Audit Observation', type: 'textarea', required: true },
            { name: 'impact', label: 'Impact', type: 'textarea', required: true },
            { name: 'recommendation', label: 'Recommendation', type: 'textarea', required: true },
            { name: 'referenceLink', label: 'Reference Link', type: 'textarea', placeholder: 'Enter reference links (one per line)', required: false }
        ];
        
        fields.forEach(field => {
            const fieldDiv = document.createElement('div');
            fieldDiv.style.marginBottom = '15px';
            
            const label = document.createElement('label');
            label.textContent = field.label + (field.required ? ' *' : '');
            label.style.display = 'block';
            label.style.marginBottom = '5px';
            label.style.fontWeight = '500';
            label.style.fontSize = '14px';
            fieldDiv.appendChild(label);
            
            let input;
            if (field.type === 'select') {
                input = document.createElement('select');
                input.id = `vapt_${field.name}`;
                input.name = field.name;
                input.style.width = '100%';
                input.style.padding = '8px';
                input.style.borderRadius = '4px';
                input.style.border = '1px solid #ced4da';
                if (field.required) input.required = true;
                
                field.options.forEach(option => {
                    const optionElement = document.createElement('option');
                    optionElement.value = option;
                    optionElement.textContent = option || 'Select Risk Factor';
                    input.appendChild(optionElement);
                });
            } else if (field.type === 'textarea') {
                input = document.createElement('textarea');
                input.id = `vapt_${field.name}`;
                input.name = field.name;
                input.rows = 4;
                input.style.width = '100%';
                input.style.padding = '8px';
                input.style.borderRadius = '4px';
                input.style.border = '1px solid #ced4da';
                input.style.resize = 'vertical';
                if (field.placeholder) input.placeholder = field.placeholder;
                if (field.required) input.required = true;
            } else {
                input = document.createElement('input');
                input.type = field.type;
                input.id = `vapt_${field.name}`;
                input.name = field.name;
                input.style.width = '100%';
                input.style.padding = '8px';
                input.style.borderRadius = '4px';
                input.style.border = '1px solid #ced4da';
                if (field.placeholder) input.placeholder = field.placeholder;
                if (field.required) input.required = true;
            }
            
            fieldDiv.appendChild(input);
            formContainer.appendChild(fieldDiv);
        });
        
        dialogContent.appendChild(formContainer);
        
        const buttonContainer = document.createElement('div');
        buttonContainer.className = 'button-container';
        buttonContainer.style.marginTop = '20px';
        
        const submitBtn = document.createElement('button');
        submitBtn.textContent = 'Submit & Update Catalog';
        submitBtn.className = 'proceed-btn';
        submitBtn.onclick = function() {
            const vulnName = document.getElementById('vapt_vulnerabilityName').value.trim();
            const riskFactor = document.getElementById('vapt_riskFactor').value;
            const observation = document.getElementById('vapt_auditObservation').value.trim();
            const impact = document.getElementById('vapt_impact').value.trim();
            const recommendation = document.getElementById('vapt_recommendation').value.trim();
            
            if (!vulnName || !riskFactor || !observation || !impact || !recommendation) {
                alert('Please fill in all required fields (marked with *)');
                return;
            }
            
            submitBtn.disabled = true;
            submitBtn.textContent = 'Submitting...';
            
            const details = {
                vulnerabilityName: vulnName,
                riskFactor: riskFactor,
                cveId: document.getElementById('vapt_cveId').value.trim(),
                cvssScore: document.getElementById('vapt_cvssScore').value.trim(),
                auditObservation: observation,
                impact: impact,
                recommendation: recommendation,
                referenceLink: document.getElementById('vapt_referenceLink').value.trim()
            };
            
            const endpointBase = actionType === 'add_details' ? 'add_vapt_vulnerability_details' : 'merge_vapt_with_unmatched';
            const endpoint = getVaptEndpoint(endpointBase);
            const payload = actionType === 'add_details' 
                ? { vulnerability_name: vulnerabilities[0], vulnerability_details: details }
                : { vulnerabilities: vulnerabilities, vulnerability_details: details };
            
            console.log('Calling endpoint:', endpoint);
            console.log('Action type:', actionType);
            console.log('Payload:', payload);
            
            fetch(endpoint, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(payload)
            })
            .then(response => {
                console.log('Response status:', response.status);
                console.log('Response OK:', response.ok);
                if (!response.ok) {
                    return response.text().then(text => {
                        console.error('Error response body:', text);
                        throw new Error(`HTTP ${response.status}: ${text}`);
                    });
                }
                return response.json();
            })
            .then(data => {
                console.log('Add/merge unmatched response:', data);
                if (data.success && data.updated_state) {
                    // Update the global state with the response
                    vaptVulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups || [];
                    vaptVulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities || [];
                    
                    console.log('Updated state - Matched:', vaptVulnerabilityMergeState.matchedGroups.length, 'Unmatched:', vaptVulnerabilityMergeState.unmatchedVulnerabilities.length);
                    
                    // Remove the sub-dialog first
                    dialog.remove();
                    
                    // Then refresh the main UI
                    refreshVaptVulnerabilityUI();
                    
                    alert(actionType === 'add_details' ? 'Details added successfully!' : 'Vulnerabilities merged successfully!');
                } else {
                    alert('Error: ' + (data.error || 'Unknown error'));
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'Submit & Update Catalog';
                }
            })
            .catch(error => {
                console.error('Error submitting details:', error);
                alert('Error submitting details: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = 'Submit & Update Catalog';
            });
        };
        
        const cancelBtn = document.createElement('button');
        cancelBtn.textContent = 'Cancel';
        cancelBtn.className = 'cancel-btn';
        cancelBtn.onclick = function() {
            dialog.remove();
        };
        
        buttonContainer.appendChild(submitBtn);
        buttonContainer.appendChild(cancelBtn);
        dialogContent.appendChild(buttonContainer);
        
        dialog.appendChild(dialogContent);
        document.body.appendChild(dialog);
    }
    
    // Undo last merge operation
    function undoVaptLastMergeOperation() {
        if (!confirm('Are you sure you want to undo the last operation?')) {
            return;
        }
        
        fetch(getVaptEndpoint('undo_vapt_last_merge'), {
            method: 'POST',
            headers: {'Content-Type': 'application/json'}
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            console.log('Undo response:', data);
            if (data.success && data.updated_state) {
                // Update the global state with the response
                vaptVulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups || [];
                vaptVulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities || [];
                
                console.log('Updated state - Matched:', vaptVulnerabilityMergeState.matchedGroups.length, 'Unmatched:', vaptVulnerabilityMergeState.unmatchedVulnerabilities.length);
                
                // Refresh the main UI
                refreshVaptVulnerabilityUI();
                
                alert('Operation undone successfully!');
            } else {
                alert('Error: ' + (data.error || 'No operations to undo'));
            }
        })
        .catch(error => {
            console.error('Error undoing operation:', error);
            alert('Error undoing operation: ' + error.message);
        });
    }
    
    // Word Report Form Submission
    if (document.getElementById('vaptFirstAuditWordForm')) {
        document.getElementById('vaptFirstAuditWordForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const fileInput = document.getElementById('vaptWordExcelFile');
            
            // Validate file selection
            if (!fileInput.files[0]) {
                alert('Please select an Excel file (.xlsx)');
                return;
            }
            
            // Validate file extension
            const fileName = fileInput.files[0].name;
            if (!fileName.toLowerCase().endsWith('.xlsx')) {
                alert('Please select a valid Excel file (.xlsx)');
                return;
            }
            
            // Disable submit button
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = 'Processing...';
            submitBtn.style.opacity = '0.6';
            
            showVaptLoadingIndicator();
            
            fetch('/process_vapt_first_audit_word_report', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                return response.blob();
            })
            .then(blob => {
                hideVaptLoadingIndicator();
                
                // Download the file
                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'Infrastructure_VAPT_First_Audit_Report.docx';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);
                
                // Close modal
                closeVaptModal('vaptFirstAuditWordModal');
                
                // Reload page immediately
                location.reload();
            })
            .catch(error => {
                hideVaptLoadingIndicator();
                console.error('Error:', error);
                alert('Error generating Word report: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
                submitBtn.style.opacity = '1';
            });
        });
    }

    if (document.getElementById('webAppFirstAuditWordForm')) {
        document.getElementById('webAppFirstAuditWordForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const formData = new FormData(this);
            const fileInput = document.getElementById('webAppWordExcelFile');

            if (!fileInput.files[0]) {
                alert('Please select an Excel file (.xlsx)');
                return;
            }

            const fileName = fileInput.files[0].name;
            if (!fileName.toLowerCase().endsWith('.xlsx')) {
                alert('Please select a valid Excel file (.xlsx)');
                return;
            }

            const submitBtn = this.querySelector('button[type=\"submit\"]');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = 'Processing...';
            submitBtn.style.opacity = '0.6';

            showVaptLoadingIndicator();

            fetch('/process_web_app_vapt_first_audit_word_report', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                return response.blob();
            })
            .then(blob => {
                hideVaptLoadingIndicator();

                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'Web_Application_VAPT_First_Audit_Report.docx';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);

                closeVaptModal('webAppFirstAuditWordModal');
                location.reload();
            })
            .catch(error => {
                hideVaptLoadingIndicator();
                console.error('Error:', error);
                alert('Error generating Word report: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
                submitBtn.style.opacity = '1';
            });
        });
    }

    if (document.getElementById('androidAppFirstAuditWordForm')) {
        document.getElementById('androidAppFirstAuditWordForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const formData = new FormData(this);
            const fileInput = document.getElementById('androidAppWordExcelFile');

            if (!fileInput.files[0]) {
                alert('Please select an Excel file (.xlsx)');
                return;
            }

            const fileName = fileInput.files[0].name;
            if (!fileName.toLowerCase().endsWith('.xlsx')) {
                alert('Please select a valid Excel file (.xlsx)');
                return;
            }

            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = 'Processing...';
            submitBtn.style.opacity = '0.6';

            showVaptLoadingIndicator();

            fetch('/process_android_app_vapt_first_audit_word_report', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                return response.blob();
            })
            .then(blob => {
                hideVaptLoadingIndicator();

                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'Android_Mobile_Application_VAPT_First_Audit_Report.docx';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);

                closeVaptModal('androidAppFirstAuditWordModal');
                location.reload();
            })
            .catch(error => {
                hideVaptLoadingIndicator();
                console.error('Error:', error);
                alert('Error generating Word report: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
                submitBtn.style.opacity = '1';
            });
        });
    }

    if (document.getElementById('iosAppFirstAuditWordForm')) {
        document.getElementById('iosAppFirstAuditWordForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const formData = new FormData(this);
            const fileInput = document.getElementById('iosAppWordExcelFile');

            if (!fileInput.files[0]) {
                alert('Please select an Excel file (.xlsx)');
                return;
            }

            const fileName = fileInput.files[0].name;
            if (!fileName.toLowerCase().endsWith('.xlsx')) {
                alert('Please select a valid Excel file (.xlsx)');
                return;
            }

            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = 'Processing...';
            submitBtn.style.opacity = '0.6';

            showVaptLoadingIndicator();

            fetch('/process_ios_app_vapt_first_audit_word_report', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                return response.blob();
            })
            .then(blob => {
                hideVaptLoadingIndicator();

                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'IOS_Mobile_Application_VAPT_First_Audit_Report.docx';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);

                closeVaptModal('iosAppFirstAuditWordModal');
                location.reload();
            })
            .catch(error => {
                hideVaptLoadingIndicator();
                console.error('Error:', error);
                alert('Error generating Word report: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
                submitBtn.style.opacity = '1';
            });
        });
    }

    if (document.getElementById('apiAppFirstAuditWordForm')) {
        document.getElementById('apiAppFirstAuditWordForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const formData = new FormData(this);
            const fileInput = document.getElementById('apiAppWordExcelFile');

            if (!fileInput.files[0]) {
                alert('Please select an Excel file (.xlsx)');
                return;
            }

            const fileName = fileInput.files[0].name;
            if (!fileName.toLowerCase().endsWith('.xlsx')) {
                alert('Please select a valid Excel file (.xlsx)');
                return;
            }

            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = 'Processing...';
            submitBtn.style.opacity = '0.6';

            showVaptLoadingIndicator();

            fetch('/process_api_vapt_first_audit_word_report', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                return response.blob();
            })
            .then(blob => {
                hideVaptLoadingIndicator();

                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'API_VAPT_First_Audit_Report.docx';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);

                closeVaptModal('apiAppFirstAuditWordModal');
                location.reload();
            })
            .catch(error => {
                hideVaptLoadingIndicator();
                console.error('Error:', error);
                alert('Error generating Word report: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
                submitBtn.style.opacity = '1';
            });
        });
    }

    if (document.getElementById('androidAppFollowUpAuditWordForm')) {
        document.getElementById('androidAppFollowUpAuditWordForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const formData = new FormData(this);
            const fileInput = document.getElementById('androidAppFollowUpWordExcelFile');

            if (!fileInput.files[0]) {
                alert('Please select an Excel file (.xlsx)');
                return;
            }

            const fileName = fileInput.files[0].name;
            if (!fileName.toLowerCase().endsWith('.xlsx')) {
                alert('Please select a valid Excel file (.xlsx)');
                return;
            }

            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = 'Processing...';
            submitBtn.style.opacity = '0.6';

            showVaptLoadingIndicator();

            fetch('/process_android_app_vapt_follow_up_audit_word_report', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                return response.blob();
            })
            .then(blob => {
                hideVaptLoadingIndicator();

                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'Android_Mobile_Application_VAPT_Follow_Up_Audit_Report.docx';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);

                closeVaptModal('androidAppFollowUpAuditWordModal');
                location.reload();
            })
            .catch(error => {
                hideVaptLoadingIndicator();
                console.error('Error:', error);
                alert('Error generating Word report: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
                submitBtn.style.opacity = '1';
            });
        });
    }

    if (document.getElementById('iosAppFollowUpAuditWordForm')) {
        document.getElementById('iosAppFollowUpAuditWordForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const formData = new FormData(this);
            const fileInput = document.getElementById('iosAppFollowUpWordExcelFile');

            if (!fileInput.files[0]) {
                alert('Please select an Excel file (.xlsx)');
                return;
            }

            const fileName = fileInput.files[0].name;
            if (!fileName.toLowerCase().endsWith('.xlsx')) {
                alert('Please select a valid Excel file (.xlsx)');
                return;
            }

            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = 'Processing...';
            submitBtn.style.opacity = '0.6';

            showVaptLoadingIndicator();

            fetch('/process_ios_app_vapt_follow_up_audit_word_report', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                return response.blob();
            })
            .then(blob => {
                hideVaptLoadingIndicator();

                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'IOS_Mobile_Application_VAPT_Follow_Up_Audit_Report.docx';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);

                closeVaptModal('iosAppFollowUpAuditWordModal');
                location.reload();
            })
            .catch(error => {
                hideVaptLoadingIndicator();
                console.error('Error:', error);
                alert('Error generating Word report: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
                submitBtn.style.opacity = '1';
            });
        });
    }

    if (document.getElementById('apiFollowUpAuditWordForm')) {
        document.getElementById('apiFollowUpAuditWordForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const formData = new FormData(this);
            const fileInput = document.getElementById('apiFollowUpWordExcelFile');

            if (!fileInput.files[0]) {
                alert('Please select an Excel file (.xlsx)');
                return;
            }

            const fileName = fileInput.files[0].name;
            if (!fileName.toLowerCase().endsWith('.xlsx')) {
                alert('Please select a valid Excel file (.xlsx)');
                return;
            }

            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = 'Processing...';
            submitBtn.style.opacity = '0.6';

            showVaptLoadingIndicator();

            fetch('/process_api_vapt_follow_up_audit_word_report', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                return response.blob();
            })
            .then(blob => {
                hideVaptLoadingIndicator();

                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'API_VAPT_Follow_Up_Audit_Report.docx';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);

                closeVaptModal('apiFollowUpAuditWordModal');
                location.reload();
            })
            .catch(error => {
                hideVaptLoadingIndicator();
                console.error('Error:', error);
                alert('Error generating Word report: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
                submitBtn.style.opacity = '1';
            });
        });
    }
    
    // Website VAPT Word Report Form Submission
    if (document.getElementById('websiteVaptFirstAuditWordForm')) {
        document.getElementById('websiteVaptFirstAuditWordForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const fileInput = document.getElementById('websiteVaptWordExcelFile');
            
            // Validate file selection
            if (!fileInput.files[0]) {
                alert('Please select an Excel file (.xlsx)');
                return;
            }
            
            // Validate file extension
            const fileName = fileInput.files[0].name;
            if (!fileName.toLowerCase().endsWith('.xlsx')) {
                alert('Please select a valid Excel file (.xlsx)');
                return;
            }
            
            // Disable submit button
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = 'Processing...';
            submitBtn.style.opacity = '0.6';
            
            showVaptLoadingIndicator();
            
            fetch('/process_website_vapt_first_audit_word_report', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                return response.blob();
            })
            .then(blob => {
                hideVaptLoadingIndicator();
                
                // Download the file
                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'Website_VAPT_First_Audit_Report.docx';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);
                
                // Close modal
                closeVaptModal('websiteVaptFirstAuditWordModal');
                
                // Reload page immediately
                location.reload();
            })
            .catch(error => {
                hideVaptLoadingIndicator();
                console.error('Error:', error);
                alert('Error generating Word report: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
                submitBtn.style.opacity = '1';
            });
        });
    }
    
    // Public IP First Audit Word Report Form Submission
    if (document.getElementById('publicIpFirstAuditWordForm')) {
        document.getElementById('publicIpFirstAuditWordForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const fileInput = document.getElementById('publicIpWordExcelFile');
            
            // Validate file selection
            if (!fileInput.files[0]) {
                alert('Please select an Excel file (.xlsx)');
                return;
            }
            
            // Validate file extension
            const fileName = fileInput.files[0].name;
            if (!fileName.toLowerCase().endsWith('.xlsx')) {
                alert('Please select a valid Excel file (.xlsx)');
                return;
            }
            
            // Disable submit button
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = 'Processing...';
            submitBtn.style.opacity = '0.6';
            
            showVaptLoadingIndicator();
            
            fetch('/process_public_ip_vapt_first_audit_word_report', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                return response.blob();
            })
            .then(blob => {
                hideVaptLoadingIndicator();
                
                // Download the file
                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'Public_IP_VAPT_First_Audit_Report.docx';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);
                
                // Close modal
                closeVaptModal('publicIpFirstAuditWordModal');
                
                // Reload page immediately
                location.reload();
            })
            .catch(error => {
                hideVaptLoadingIndicator();
                console.error('Error:', error);
                alert('Error generating Word report: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
                submitBtn.style.opacity = '1';
            });
        });
    }
    
    // Follow-up Word Report Form Submission
    if (document.getElementById('vaptFollowUpAuditWordForm')) {
        document.getElementById('vaptFollowUpAuditWordForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const fileInput = document.getElementById('vaptFollowUpWordExcelFile');
            
            // Validate file selection
            if (!fileInput.files[0]) {
                alert('Please select an Excel file (.xlsx)');
                return;
            }
            
            // Validate file extension
            const fileName = fileInput.files[0].name;
            if (!fileName.toLowerCase().endsWith('.xlsx')) {
                alert('Please select a valid Excel file (.xlsx)');
                return;
            }
            
            // Disable submit button
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = 'Processing...';
            submitBtn.style.opacity = '0.6';
            
            showVaptLoadingIndicator();
            
            fetch('/process_vapt_follow_up_audit_word_report', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                return response.blob();
            })
            .then(blob => {
                hideVaptLoadingIndicator();
                
                // Download the file
                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'Infrastructure_VAPT_Follow_Up_Audit_Report.docx';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);
                
                // Close modal
                closeVaptModal('vaptFollowUpAuditWordModal');
                
                // Reload page immediately
                location.reload();
            })
            .catch(error => {
                hideVaptLoadingIndicator();
                console.error('Error:', error);
                alert('Error generating Follow-up Word report: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
                submitBtn.style.opacity = '1';
            });
        });
    }
    
    // Web Application Follow-Up Word Report Form Submission
    if (document.getElementById('webAppFollowUpAuditWordForm')) {
        document.getElementById('webAppFollowUpAuditWordForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const formData = new FormData(this);
            const fileInput = document.getElementById('webAppFollowUpWordExcelFile');

            if (!fileInput.files[0]) {
                alert('Please select an Excel file (.xlsx)');
                return;
            }

            const fileName = fileInput.files[0].name;
            if (!fileName.toLowerCase().endsWith('.xlsx')) {
                alert('Please select a valid Excel file (.xlsx)');
                return;
            }

            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = 'Processing...';
            submitBtn.style.opacity = '0.6';

            showVaptLoadingIndicator();

            fetch('/process_web_app_follow_up_audit_word_report', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                return response.blob();
            })
            .then(blob => {
                hideVaptLoadingIndicator();

                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'Web_Application_VAPT_Follow_Up_Audit_Report.docx';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);

                closeVaptModal('webAppFollowUpAuditWordModal');
                location.reload();
            })
            .catch(error => {
                hideVaptLoadingIndicator();
                console.error('Error:', error);
                alert('Error generating Web Application Follow-up Word report: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
                submitBtn.style.opacity = '1';
            });
        });
    }

    
    // Website VAPT Follow-Up Word Report Form Submission
    if (document.getElementById('websiteVaptFollowUpAuditWordForm')) {
        document.getElementById('websiteVaptFollowUpAuditWordForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const fileInput = document.getElementById('websiteVaptFollowUpWordExcelFile');
            
            // Validate file selection
            if (!fileInput.files[0]) {
                alert('Please select an Excel file (.xlsx)');
                return;
            }
            
            // Validate file extension
            const fileName = fileInput.files[0].name;
            if (!fileName.toLowerCase().endsWith('.xlsx')) {
                alert('Please select a valid Excel file (.xlsx)');
                return;
            }
            
            // Disable submit button
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = 'Processing...';
            submitBtn.style.opacity = '0.6';
            
            showVaptLoadingIndicator();
            
            fetch('/process_website_vapt_follow_up_audit_word_report', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                return response.blob();
            })
            .then(blob => {
                hideVaptLoadingIndicator();
                
                // Download the file
                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'Website_VAPT_Follow_Up_Audit_Report.docx';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);
                
                // Close modal
                closeVaptModal('websiteVaptFollowUpAuditWordModal');
                
                // Reload page immediately
                location.reload();
            })
            .catch(error => {
                hideVaptLoadingIndicator();
                console.error('Error:', error);
                alert('Error generating Word report: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
                submitBtn.style.opacity = '1';
            });
        });
    }

    // Public IP Follow-Up Audit Word Report Form Handler
    if (document.getElementById('publicIpFollowUpAuditWordForm')) {
        document.getElementById('publicIpFollowUpAuditWordForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const fileInput = document.getElementById('publicIpFollowUpWordExcelFile');
            
            // Validate file selection
            if (!fileInput.files[0]) {
                alert('Please select an Excel file (.xlsx)');
                return;
            }
            
            // Validate file extension
            const fileName = fileInput.files[0].name;
            if (!fileName.toLowerCase().endsWith('.xlsx')) {
                alert('Please select a valid Excel file (.xlsx)');
                return;
            }
            
            // Disable submit button
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = 'Processing...';
            submitBtn.style.opacity = '0.6';
            
            showVaptLoadingIndicator();
            
            fetch('/process_public_ip_vapt_follow_up_audit_word_report', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                return response.blob();
            })
            .then(blob => {
                hideVaptLoadingIndicator();
                
                // Create download link
                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'Public_IP_VAPT_Follow_Up_Audit_Report.docx';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);
                
                // Close modal
                closeVaptModal('publicIpFollowUpAuditWordModal');
                
                // Reload page immediately
                location.reload();
            })
            .catch(error => {
                hideVaptLoadingIndicator();
                console.error('Error:', error);
                alert('Error generating Word report: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
                submitBtn.style.opacity = '1';
            });
        });
    }
    
    // Undo Follow-up last merge operation (separate function for clarity)
    function undoVaptFollowUpLastMergeOperation() {
        if (!confirm('Are you sure you want to undo the last operation?')) {
            return;
        }
        
        fetch('/vapt_followup_undo_last_merge', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'}
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            console.log('Undo Follow-up response:', data);
            if (data.success && data.updated_state) {
                vaptVulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups || [];
                vaptVulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities || [];
                
                console.log('Updated state - Matched:', vaptVulnerabilityMergeState.matchedGroups.length, 'Unmatched:', vaptVulnerabilityMergeState.unmatchedVulnerabilities.length);
                
                refreshVaptVulnerabilityUI();
                
                alert('Operation undone successfully!');
            } else {
                alert('Error: ' + (data.error || 'No operations to undo'));
            }
        })
        .catch(error => {
            console.error('Error undoing operation:', error);
            alert('Error undoing operation: ' + error.message);
        });
    }

    // ==============================================================================
    // VAPT MetaData Functions
    // ==============================================================================

    // Sub-sector mappings for VAPT MetaData
    const vaptSubSectorMappings = {"Agriculture": ["Agriculture"], "Defence": ["Defence"], "Education": ["Education"], "Energy": ["Nuclear Energy", "Oil and Gas", "Power", "Renewable Energy"], "Finance": ["Banking", "Financial Services and Tax", "Insurance", "Market Infrastructure Institutions", "PFRDA", "NHB"], "Healthcare": ["Healthcare services", "Medical devices", "Pharmaceuticals"], "Information_and_Broadcasting": ["Information_and_Broadcasting"], "Information_and_Communication_Technology": ["Information_and_Communication_Technology"], "Law_Enforcement_and_Security": ["Law_Enforcement_and_Security"], "Public_Essential_Services_and_Utilities": ["Building and Construction", "Emergency Services", "Food", "Textiles and Consumer Goods", "Heavy industries", "Postal Services", "Public administration", "Retail services", "Sports, cultural activities, Trade Fairs and Entertainment", "Tourism & Hospitality", "Water and Sewage Utilities"], "Space": ["Space"], "Transportation": ["Air Transportation", "Land Transportation", "Water Transportation"]};

    // Toggle Other field for VAPT MetaData
    function toggleVaptOtherField(selectId, otherId) {
        const selectElement = document.getElementById(selectId);
        const otherInput = document.getElementById(otherId);
        
        if (selectElement && otherInput) {
            if (selectElement.value === 'Other') {
                otherInput.style.display = 'block';
                otherInput.required = true;
            } else {
                otherInput.style.display = 'none';
                otherInput.required = false;
                otherInput.value = '';
            }
        }
    }

    // Update Sub-Sector options for VAPT MetaData
    function updateVaptSubSectorOptions() {
        const sectorSelect = document.getElementById('vaptMetaSectorOrg');
        const subSectorSelect = document.getElementById('vaptMetaSubSector');
        const selectedSector = sectorSelect.value;

        // Clear existing options
        subSectorSelect.innerHTML = '<option value="">Select Sub Sector</option>';

        if (selectedSector && vaptSubSectorMappings[selectedSector]) {
            const subSectors = vaptSubSectorMappings[selectedSector];
            subSectors.forEach(subSector => {
                const option = document.createElement('option');
                option.value = subSector;
                option.textContent = subSector;
                subSectorSelect.appendChild(option);
            });
        }
    }

    function updateApiSubSectorOptions() {
        const sectorSelect = document.getElementById('apiMetaSectorOrg');
        const subSectorSelect = document.getElementById('apiMetaSubSector');

        if (!sectorSelect || !subSectorSelect) {
            return;
        }

        const selectedSector = sectorSelect.value;

        subSectorSelect.innerHTML = '<option value="">Select Sub Sector</option>';

        if (selectedSector && vaptSubSectorMappings[selectedSector]) {
            const subSectors = vaptSubSectorMappings[selectedSector];
            subSectors.forEach(subSector => {
                const option = document.createElement('option');
                option.value = subSector;
                option.textContent = subSector;
                subSectorSelect.appendChild(option);
            });
        }
    }

    // Toggle Last Audit Date Input for VAPT MetaData
    function toggleVaptLastAuditDateInput(selectId, dateInputId) {
        const select = document.getElementById(selectId);
        const dateInput = document.getElementById(dateInputId);
        const hiddenInput = document.getElementById(dateInputId + 'Value');
        
        if (select.value === 'NA') {
            // Hide date input and set hidden value to NA
            dateInput.style.display = 'none';
            dateInput.required = false;
            dateInput.value = '';
            if (hiddenInput) {
                hiddenInput.value = 'NA';
            }
        } else if (select.value === 'EnterDate') {
            // Show date input and make it required
            dateInput.style.display = 'block';
            dateInput.required = true;
            if (hiddenInput) {
                // Clear hidden input, will be set from date input on form submit
                hiddenInput.value = '';
            }
        } else {
            // Default: hide and clear
            dateInput.style.display = 'none';
            dateInput.required = false;
            dateInput.value = '';
            if (hiddenInput) {
                hiddenInput.value = '';
            }
        }
    }

    // Toggle Vulnerability Section for VAPT MetaData
    function toggleVaptVulnerabilitySection() {
        const vulnerabilitySection = document.getElementById('vaptVulnerabilitySection');
        const vulnerabilityStatus = document.querySelector('input[name="vulnerabilityStatus"]:checked');
        
        if (vulnerabilityStatus && vulnerabilityStatus.value === 'has') {
            // Show the vulnerability section
            vulnerabilitySection.style.display = 'block';
            
            // Make all vulnerability fields required
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = true;
            });
        } else {
            // Hide the vulnerability section
            vulnerabilitySection.style.display = 'none';
            
            // Remove required attribute from all vulnerability fields
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = false;
                // Clear the values
                if (input.type === 'text' || input.type === 'number' || input.type === 'email') {
                    input.value = '';
                } else if (input.tagName === 'SELECT') {
                    input.selectedIndex = 0;
                }
            });
        }
    }

    // Toggle functions for First Audit pop-ups
    function toggleWebAppFirstAuditVulnerabilitySection() {
        const vulnerabilitySection = document.getElementById('webAppFirstAuditVulnerabilitySection');
        const vulnerabilityStatus = document.querySelector('input[name="webAppVulnerabilityStatus"]:checked');
        
        if (vulnerabilityStatus && vulnerabilityStatus.value === 'has') {
            // Show the vulnerability section
            vulnerabilitySection.style.display = 'block';
            
            // Make all vulnerability fields and file upload required
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required], textarea[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = true;
            });
            const fileInput = document.getElementById('webAppEvidenceFiles');
            if (fileInput) fileInput.required = true;
        } else {
            // Hide the vulnerability section
            vulnerabilitySection.style.display = 'none';
            
            // Remove required attribute from all vulnerability fields
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required], textarea[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = false;
                // Clear the values
                if (input.type === 'text' || input.type === 'number' || input.type === 'email' || input.tagName === 'TEXTAREA') {
                    input.value = '';
                } else if (input.tagName === 'SELECT') {
                    input.selectedIndex = 0;
                }
            });
            const fileInput = document.getElementById('webAppEvidenceFiles');
            if (fileInput) {
                fileInput.required = false;
                fileInput.value = '';
            }
        }
    }

    function toggleAndroidAppFirstAuditVulnerabilitySection() {
        const vulnerabilitySection = document.getElementById('androidAppFirstAuditVulnerabilitySection');
        const vulnerabilityStatus = document.querySelector('input[name="androidAppVulnerabilityStatus"]:checked');
        
        if (vulnerabilityStatus && vulnerabilityStatus.value === 'has') {
            // Show the vulnerability section
            vulnerabilitySection.style.display = 'block';
            
            // Make all vulnerability fields and file upload required
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required], textarea[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = true;
            });
            const fileInput = document.getElementById('androidAppEvidenceFiles');
            if (fileInput) fileInput.required = true;
        } else {
            // Hide the vulnerability section
            vulnerabilitySection.style.display = 'none';
            
            // Remove required attribute from all vulnerability fields
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required], textarea[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = false;
                // Clear the values
                if (input.type === 'text' || input.type === 'number' || input.type === 'email' || input.tagName === 'TEXTAREA') {
                    input.value = '';
                } else if (input.tagName === 'SELECT') {
                    input.selectedIndex = 0;
                }
            });
            const fileInput = document.getElementById('androidAppEvidenceFiles');
            if (fileInput) {
                fileInput.required = false;
                fileInput.value = '';
            }
        }
    }

    function toggleIosAppFirstAuditVulnerabilitySection() {
        const vulnerabilitySection = document.getElementById('iosAppFirstAuditVulnerabilitySection');
        const vulnerabilityStatus = document.querySelector('input[name="iosAppVulnerabilityStatus"]:checked');
        
        if (vulnerabilityStatus && vulnerabilityStatus.value === 'has') {
            // Show the vulnerability section
            vulnerabilitySection.style.display = 'block';
            
            // Make all vulnerability fields and file upload required
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required], textarea[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = true;
            });
            const fileInput = document.getElementById('iosAppEvidenceFiles');
            if (fileInput) fileInput.required = true;
        } else {
            // Hide the vulnerability section
            vulnerabilitySection.style.display = 'none';
            
            // Remove required attribute from all vulnerability fields
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required], textarea[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = false;
                // Clear the values
                if (input.type === 'text' || input.type === 'number' || input.type === 'email' || input.tagName === 'TEXTAREA') {
                    input.value = '';
                } else if (input.tagName === 'SELECT') {
                    input.selectedIndex = 0;
                }
            });
            const fileInput = document.getElementById('iosAppEvidenceFiles');
            if (fileInput) {
                fileInput.required = false;
                fileInput.value = '';
            }
        }
    }

    function toggleApiFirstAuditVulnerabilitySection() {
        const vulnerabilitySection = document.getElementById('apiFirstAuditVulnerabilitySection');
        const vulnerabilityStatus = document.querySelector('input[name="apiVulnerabilityStatus"]:checked');
        
        if (vulnerabilityStatus && vulnerabilityStatus.value === 'has') {
            // Show the vulnerability section
            vulnerabilitySection.style.display = 'block';
            
            // Make all vulnerability fields and file upload required
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required], textarea[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = true;
            });
            const fileInput = document.getElementById('apiEvidenceFiles');
            if (fileInput) fileInput.required = true;
        } else {
            // Hide the vulnerability section
            vulnerabilitySection.style.display = 'none';
            
            // Remove required attribute from all vulnerability fields
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required], textarea[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = false;
                // Clear the values
                if (input.type === 'text' || input.type === 'number' || input.type === 'email' || input.tagName === 'TEXTAREA') {
                    input.value = '';
                } else if (input.tagName === 'SELECT') {
                    input.selectedIndex = 0;
                }
            });
            const fileInput = document.getElementById('apiEvidenceFiles');
            if (fileInput) {
                fileInput.required = false;
                fileInput.value = '';
            }
        }
    }

    // Add Vulnerability Entry for VAPT MetaData
    let vaptVulnEntryCount = 1;
    function addVaptVulnerabilityEntry() {
        const container = document.getElementById('vaptVulnerabilityContainer');
        const entryDiv = document.createElement('div');
        entryDiv.className = 'vulnerability-entry';
        entryDiv.style.border = '1px solid #ddd';
        entryDiv.style.padding = '15px';
        entryDiv.style.marginBottom = '15px';
        entryDiv.style.borderRadius = '5px';
        entryDiv.style.position = 'relative';

        entryDiv.innerHTML = `
            <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
            <div class="form-group">
                <label class="form-label">Audited infrastructure details*</label>
                <input type="text" name="vuln_${vaptVulnEntryCount}_infrastructure" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                <input type="text" name="vuln_${vaptVulnEntryCount}_name" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">CVE/CWE Reference Number*</label>
                <input type="text" name="vuln_${vaptVulnEntryCount}_cve" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Severity of Issue*</label>
                <select name="vuln_${vaptVulnEntryCount}_severity" class="form-input" required>
                    <option value="">Select Severity</option>
                    <option value="Critical">Critical</option>
                    <option value="High">High</option>
                    <option value="Medium">Medium</option>
                    <option value="Low">Low</option>
                    <option value="Informational">Informational</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                <input type="number" name="vuln_${vaptVulnEntryCount}_count" class="form-input" min="0" required>
            </div>
            <div class="form-group">
                <label class="form-label">Attributing Factor*</label>
                <select name="vuln_${vaptVulnEntryCount}_factor" class="form-input" required>
                    <option value="">Select Factor</option>
                    <option value="Coding Error">Coding Error</option>
                    <option value="Configuration Error">Configuration Error</option>
                    <option value="Deployment Error">Deployment Error</option>
                    <option value="Design Error">Design Error</option>
                    <option value="Operation Error">Operation Error</option>
                    <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                </select>
            </div>
        `;

        container.appendChild(entryDiv);
        vaptVulnEntryCount++;
    }

    // Add Employee Entry for VAPT MetaData
    let vaptEmpEntryCount = 1;
    function addVaptEmployeeEntry() {
        const container = document.getElementById('vaptEmployeeContainer');
        const entryDiv = document.createElement('div');
        entryDiv.className = 'employee-entry';
        entryDiv.style.border = '1px solid #ddd';
        entryDiv.style.padding = '15px';
        entryDiv.style.marginBottom = '15px';
        entryDiv.style.borderRadius = '5px';
        entryDiv.style.position = 'relative';

        entryDiv.innerHTML = `
            <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
            <div class="form-group">
                <label class="form-label">Name of employee*</label>
                <input type="text" name="emp_${vaptEmpEntryCount}_name" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">E-mail ID*</label>
                <input type="email" name="emp_${vaptEmpEntryCount}_email" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">CISSP*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${vaptEmpEntryCount}_cissp" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${vaptEmpEntryCount}_cissp" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CISA*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${vaptEmpEntryCount}_cisa" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${vaptEmpEntryCount}_cisa" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CISM*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${vaptEmpEntryCount}_cism" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${vaptEmpEntryCount}_cism" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">ISO*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${vaptEmpEntryCount}_iso" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${vaptEmpEntryCount}_iso" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">DISA*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${vaptEmpEntryCount}_disa" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${vaptEmpEntryCount}_disa" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">OSCP*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${vaptEmpEntryCount}_oscp" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${vaptEmpEntryCount}_oscp" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CEH*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${vaptEmpEntryCount}_ceh" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${vaptEmpEntryCount}_ceh" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">Others</label>
                <input type="text" name="emp_${vaptEmpEntryCount}_others" class="form-input" placeholder="Specify other certifications">
            </div>
            <div class="form-group">
                <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                <input type="number" name="emp_${vaptEmpEntryCount}_experience" class="form-input" min="0" step="0.5" required>
            </div>
        `;

        container.appendChild(entryDiv);
        vaptEmpEntryCount++;
    }

    // Toggle Vulnerability Section for API First Audit MetaData
    function toggleApiVulnerabilitySection() {
        const vulnerabilitySection = document.getElementById('apiVulnerabilitySection');
        const form = document.getElementById('apiFirstAuditMetaDataForm');
        const vulnerabilityStatus = form ? form.querySelector('input[name="vulnerabilityStatus"]:checked') : null;
        
        if (vulnerabilityStatus && vulnerabilityStatus.value === 'has') {
            // Show the vulnerability section
            vulnerabilitySection.style.display = 'block';
            
            // Make all vulnerability fields required
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = true;
            });
        } else {
            // Hide the vulnerability section
            vulnerabilitySection.style.display = 'none';
            
            // Remove required attribute from all vulnerability fields
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = false;
                // Clear the values
                if (input.type === 'text' || input.type === 'number' || input.type === 'email') {
                    input.value = '';
                } else if (input.tagName === 'SELECT') {
                    input.selectedIndex = 0;
                }
            });
        }
    }

    // Add Vulnerability Entry for API First Audit MetaData
    let apiVulnEntryCount = 1;
    function addApiVulnerabilityEntry() {
        const container = document.getElementById('apiVulnerabilityContainer');
        if (!container) {
            return;
        }

        const entryDiv = document.createElement('div');
        entryDiv.className = 'vulnerability-entry';
        entryDiv.style.border = '1px solid #ddd';
        entryDiv.style.padding = '15px';
        entryDiv.style.marginBottom = '15px';
        entryDiv.style.borderRadius = '5px';
        entryDiv.style.position = 'relative';

        entryDiv.innerHTML = `
            <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
            <div class="form-group">
                <label class="form-label">Audited infrastructure details*</label>
                <input type="text" name="vuln_${apiVulnEntryCount}_infrastructure" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                <input type="text" name="vuln_${apiVulnEntryCount}_name" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">CVE/CWE Reference Number*</label>
                <input type="text" name="vuln_${apiVulnEntryCount}_cve" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Severity of Issue*</label>
                <select name="vuln_${apiVulnEntryCount}_severity" class="form-input" required>
                    <option value="">Select Severity</option>
                    <option value="Critical">Critical</option>
                    <option value="High">High</option>
                    <option value="Medium">Medium</option>
                    <option value="Low">Low</option>
                    <option value="Informational">Informational</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                <input type="number" name="vuln_${apiVulnEntryCount}_count" class="form-input" min="0" required>
            </div>
            <div class="form-group">
                <label class="form-label">Attributing Factor*</label>
                <select name="vuln_${apiVulnEntryCount}_factor" class="form-input" required>
                    <option value="">Select Factor</option>
                    <option value="Coding Error">Coding Error</option>
                    <option value="Configuration Error">Configuration Error</option>
                    <option value="Deployment Error">Deployment Error</option>
                    <option value="Design Error">Design Error</option>
                    <option value="Operation Error">Operation Error</option>
                    <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                </select>
            </div>
        `;

        container.appendChild(entryDiv);
        apiVulnEntryCount++;
    }

    // Add Employee Entry for API First Audit MetaData
    let apiEmpEntryCount = 1;
    function addApiEmployeeEntry() {
        const container = document.getElementById('apiEmployeeContainer');
        if (!container) {
            return;
        }

        const entryDiv = document.createElement('div');
        entryDiv.className = 'employee-entry';
        entryDiv.style.border = '1px solid #ddd';
        entryDiv.style.padding = '15px';
        entryDiv.style.marginBottom = '15px';
        entryDiv.style.borderRadius = '5px';
        entryDiv.style.position = 'relative';

        entryDiv.innerHTML = `
            <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
            <div class="form-group">
                <label class="form-label">Name of employee*</label>
                <input type="text" name="emp_${apiEmpEntryCount}_name" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">E-mail ID*</label>
                <input type="email" name="emp_${apiEmpEntryCount}_email" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">CISSP*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${apiEmpEntryCount}_cissp" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${apiEmpEntryCount}_cissp" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CISA*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${apiEmpEntryCount}_cisa" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${apiEmpEntryCount}_cisa" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CISM*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${apiEmpEntryCount}_cism" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${apiEmpEntryCount}_cism" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">ISO*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${apiEmpEntryCount}_iso" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${apiEmpEntryCount}_iso" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">DISA*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${apiEmpEntryCount}_disa" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${apiEmpEntryCount}_disa" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">OSCP*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${apiEmpEntryCount}_oscp" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${apiEmpEntryCount}_oscp" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CEH*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${apiEmpEntryCount}_ceh" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${apiEmpEntryCount}_ceh" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">Others</label>
                <input type="text" name="emp_${apiEmpEntryCount}_others" class="form-input" placeholder="Specify other certifications">
            </div>
            <div class="form-group">
                <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                <input type="number" name="emp_${apiEmpEntryCount}_experience" class="form-input" min="0" step="0.5" required>
            </div>
        `;

        container.appendChild(entryDiv);
        apiEmpEntryCount++;
    }

    // Handle VAPT First Audit MetaData form submission
    function handleVaptFirstAuditMetaDataSubmit(event) {
        event.preventDefault();
        
        const submitBtn = document.getElementById('vaptFirstAuditMetaDataSubmitBtn');
        const originalText = submitBtn.innerHTML;
        
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
        submitBtn.disabled = true;
        
        const formData = new FormData(document.getElementById('vaptFirstAuditMetaDataForm'));
        
        // Handle dateLastAudit value: if date input is visible and has value, use it; otherwise use "NA"
        const dateLastAuditType = document.getElementById('vaptMetaDateLastAuditType');
        const dateLastAuditInput = document.getElementById('vaptMetaDateLastAudit');
        const dateLastAuditHidden = document.getElementById('vaptMetaDateLastAuditValue');
        
        if (dateLastAuditType && dateLastAuditInput && dateLastAuditHidden) {
            if (dateLastAuditType.value === 'EnterDate' && dateLastAuditInput.value) {
                // Use the date value from the date input
                formData.set('dateLastAudit', dateLastAuditInput.value);
            } else {
                // Use "NA" from hidden input
                formData.set('dateLastAudit', dateLastAuditHidden.value || 'NA');
            }
        }
        
        fetch('/process_vapt_first_audit_metadata', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // Download the file
                const link = document.createElement('a');
                link.href = data.download_url;
                link.download = data.filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Close modal
                closeVaptModal('vaptFirstAuditMetaDataModal');
                
                // Cleanup and reload after 2 seconds
                setTimeout(() => {
                    fetch('/cleanup_vapt_first_audit_metadata', {
                        method: 'POST'
                    }).then(() => {
                        location.reload();
                    });
                }, 2000);
            } else {
                alert('Error: ' + (data.error || 'Unknown error'));
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        })
        .catch(error => {
            console.error('VAPT First Audit MetaData Error:', error);
            alert('An error occurred: ' + error.message);
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
        });
    }

    // Handle API First Audit MetaData form submission
    function handleApiFirstAuditMetaDataSubmit(event) {
        event.preventDefault();

        const submitBtn = document.getElementById('apiFirstAuditMetaDataSubmitBtn');
        if (!submitBtn) {
            return;
        }


        const originalText = submitBtn.innerHTML;

        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
        submitBtn.disabled = true;

        const formElement = document.getElementById('apiFirstAuditMetaDataForm');
        if (!formElement) {
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            return;
        }

        const formData = new FormData(formElement);

        const dateLastAuditType = document.getElementById('apiMetaDateLastAuditType');
        const dateLastAuditInput = document.getElementById('apiMetaDateLastAudit');
        const dateLastAuditHidden = document.getElementById('apiMetaDateLastAuditValue');

        if (dateLastAuditType && dateLastAuditInput && dateLastAuditHidden) {
            if (dateLastAuditType.value === 'EnterDate' && dateLastAuditInput.value) {
                formData.set('dateLastAudit', dateLastAuditInput.value);
            } else {
                formData.set('dateLastAudit', dateLastAuditHidden.value || 'NA');
            }
        }

        fetch('/process_api_first_audit_metadata', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const link = document.createElement('a');
                link.href = data.download_url;
                link.download = data.filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                closeVaptModal('apiFirstAuditMetaDataModal');

                setTimeout(() => {
                    fetch('/cleanup_api_first_audit_metadata', {
                        method: 'POST'
                    }).then(() => {
                        location.reload();
                    });
                }, 2000);
            } else {
                alert('Error: ' + (data.error || 'Unknown error'));
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        })
        .catch(error => {
            console.error('API First Audit MetaData Error:', error);
            alert('An error occurred: ' + error.message);
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
        });
    }

    // ==============================================================================
    // Public IP VAPT MetaData Functions
    // ==============================================================================

    // Toggle Other field for Public IP VAPT MetaData (re-use VAPT handler)
    function togglePublicIpVaptOtherField(selectId, otherId) {
        if (typeof toggleVaptOtherField === 'function') {
            toggleVaptOtherField(selectId, otherId);
        }
    }

    // Update Sub-Sector options for Public IP VAPT MetaData
    function updatePublicIpVaptSubSectorOptions() {
        const sectorSelect = document.getElementById('publicIpMetaSectorOrg');
        const subSectorSelect = document.getElementById('publicIpMetaSubSector');

        if (!sectorSelect || !subSectorSelect) {
            return;
        }

        const selectedSector = sectorSelect.value;

        // Clear existing options
        subSectorSelect.innerHTML = '<option value="">Select Sub Sector</option>';

        if (selectedSector && vaptSubSectorMappings[selectedSector]) {
            const subSectors = vaptSubSectorMappings[selectedSector];
            subSectors.forEach(subSector => {
                const option = document.createElement('option');
                option.value = subSector;
                option.textContent = subSector;
                subSectorSelect.appendChild(option);
            });
        }
    }

    // Toggle Last Audit Date Input for Public IP VAPT MetaData (re-use VAPT handler)
    function togglePublicIpVaptLastAuditDateInput(selectId, dateInputId) {
        if (typeof toggleVaptLastAuditDateInput === 'function') {
            toggleVaptLastAuditDateInput(selectId, dateInputId);
        }
    }

    // Toggle Vulnerability Section for Public IP VAPT MetaData
    function togglePublicIpVulnerabilitySection() {
        const vulnerabilitySection = document.getElementById('publicIpVulnerabilitySection');
        const form = document.getElementById('publicIpFirstAuditMetaDataForm');
        const vulnerabilityStatus = form ? form.querySelector('input[name="vulnerabilityStatus"]:checked') : null;
        
        if (vulnerabilityStatus && vulnerabilityStatus.value === 'has') {
            // Show the vulnerability section
            vulnerabilitySection.style.display = 'block';
            
            // Make all vulnerability fields required
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = true;
            });
        } else {
            // Hide the vulnerability section
            vulnerabilitySection.style.display = 'none';
            
            // Remove required attribute from all vulnerability fields
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = false;
                // Clear the values
                if (input.type === 'text' || input.type === 'number' || input.type === 'email') {
                    input.value = '';
                } else if (input.tagName === 'SELECT') {
                    input.selectedIndex = 0;
                }
            });
        }
    }

    // Add Vulnerability Entry for Public IP VAPT MetaData
    let publicIpVulnEntryCount = 1;
    function addPublicIpVulnerabilityEntry() {
        const container = document.getElementById('publicIpVulnerabilityContainer');
        if (!container) {
            return;
        }

        const entryDiv = document.createElement('div');
        entryDiv.className = 'vulnerability-entry';
        entryDiv.style.border = '1px solid #ddd';
        entryDiv.style.padding = '15px';
        entryDiv.style.marginBottom = '15px';
        entryDiv.style.borderRadius = '5px';
        entryDiv.style.position = 'relative';

        entryDiv.innerHTML = `
            <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
            <div class="form-group">
                <label class="form-label">Audited infrastructure details*</label>
                <input type="text" name="vuln_${publicIpVulnEntryCount}_infrastructure" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                <input type="text" name="vuln_${publicIpVulnEntryCount}_name" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">CVE/CWE Reference Number*</label>
                <input type="text" name="vuln_${publicIpVulnEntryCount}_cve" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Severity of Issue*</label>
                <select name="vuln_${publicIpVulnEntryCount}_severity" class="form-input" required>
                    <option value="">Select Severity</option>
                    <option value="Critical">Critical</option>
                    <option value="High">High</option>
                    <option value="Medium">Medium</option>
                    <option value="Low">Low</option>
                    <option value="Informational">Informational</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                <input type="number" name="vuln_${publicIpVulnEntryCount}_count" class="form-input" min="0" required>
            </div>
            <div class="form-group">
                <label class="form-label">Attributing Factor*</label>
                <select name="vuln_${publicIpVulnEntryCount}_factor" class="form-input" required>
                    <option value="">Select Factor</option>
                    <option value="Coding Error">Coding Error</option>
                    <option value="Configuration Error">Configuration Error</option>
                    <option value="Deployment Error">Deployment Error</option>
                    <option value="Design Error">Design Error</option>
                    <option value="Operation Error">Operation Error</option>
                    <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                </select>
            </div>
        `;

        container.appendChild(entryDiv);
        publicIpVulnEntryCount++;
    }

    // Add Employee Entry for Public IP VAPT MetaData
    let publicIpEmpEntryCount = 1;
    function addPublicIpEmployeeEntry() {
        const container = document.getElementById('publicIpEmployeeContainer');
        if (!container) {
            return;
        }

        const entryDiv = document.createElement('div');
        entryDiv.className = 'employee-entry';
        entryDiv.style.border = '1px solid #ddd';
        entryDiv.style.padding = '15px';
        entryDiv.style.marginBottom = '15px';
        entryDiv.style.borderRadius = '5px';
        entryDiv.style.position = 'relative';

        entryDiv.innerHTML = `
            <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
            <div class="form-group">
                <label class="form-label">Name of employee*</label>
                <input type="text" name="emp_${publicIpEmpEntryCount}_name" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">E-mail ID*</label>
                <input type="email" name="emp_${publicIpEmpEntryCount}_email" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">CISSP*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${publicIpEmpEntryCount}_cissp" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${publicIpEmpEntryCount}_cissp" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CISA*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${publicIpEmpEntryCount}_cisa" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${publicIpEmpEntryCount}_cisa" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CISM*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${publicIpEmpEntryCount}_cism" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${publicIpEmpEntryCount}_cism" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">ISO*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${publicIpEmpEntryCount}_iso" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${publicIpEmpEntryCount}_iso" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">DISA*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${publicIpEmpEntryCount}_disa" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${publicIpEmpEntryCount}_disa" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">OSCP*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${publicIpEmpEntryCount}_oscp" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${publicIpEmpEntryCount}_oscp" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CEH*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${publicIpEmpEntryCount}_ceh" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${publicIpEmpEntryCount}_ceh" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">Others</label>
                <input type="text" name="emp_${publicIpEmpEntryCount}_others" class="form-input" placeholder="Specify other certifications">
            </div>
            <div class="form-group">
                <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                <input type="number" name="emp_${publicIpEmpEntryCount}_experience" class="form-input" min="0" step="0.5" required>
            </div>
        `;

        container.appendChild(entryDiv);
        publicIpEmpEntryCount++;
    }

    // Handle Public IP VAPT First Audit MetaData form submission
    function handlePublicIpFirstAuditMetaDataSubmit(event) {
        event.preventDefault();

        const submitBtn = document.getElementById('publicIpFirstAuditMetaDataSubmitBtn');
        if (!submitBtn) {
            return;
        }

        const originalText = submitBtn.innerHTML;

        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
        submitBtn.disabled = true;

        const formElement = document.getElementById('publicIpFirstAuditMetaDataForm');
        if (!formElement) {
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            return;
        }

        const formData = new FormData(formElement);

        const dateLastAuditType = document.getElementById('publicIpMetaDateLastAuditType');
        const dateLastAuditInput = document.getElementById('publicIpMetaDateLastAudit');
        const dateLastAuditHidden = document.getElementById('publicIpMetaDateLastAuditValue');

        if (dateLastAuditType && dateLastAuditInput && dateLastAuditHidden) {
            if (dateLastAuditType.value === 'EnterDate' && dateLastAuditInput.value) {
                formData.set('dateLastAudit', dateLastAuditInput.value);
            } else {
                formData.set('dateLastAudit', dateLastAuditHidden.value || 'NA');
            }
        }

        fetch('/process_public_ip_first_audit_metadata', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const link = document.createElement('a');
                link.href = data.download_url;
                link.download = data.filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                closeVaptModal('publicIpFirstAuditMetaDataModal');

                setTimeout(() => {
                    fetch('/cleanup_public_ip_first_audit_metadata', {
                        method: 'POST'
                    }).then(() => {
                        location.reload();
                    });
                }, 2000);
            } else {
                alert('Error: ' + (data.error || 'Unknown error'));
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        })
        .catch(error => {
            console.error('Public IP First Audit MetaData Error:', error);
            alert('An error occurred: ' + error.message);
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
        });
    }

    // ==============================================================================
    // Website VAPT MetaData Functions
    // ==============================================================================

    // Toggle Other field for Website VAPT MetaData
    function toggleWebsiteVaptOtherField(selectId, otherId) {
        const selectElement = document.getElementById(selectId);
        const otherInput = document.getElementById(otherId);
        
        if (selectElement && otherInput) {
            if (selectElement.value === 'Other') {
                otherInput.style.display = 'block';
                otherInput.required = true;
            } else {
                otherInput.style.display = 'none';
                otherInput.required = false;
                otherInput.value = '';
            }
        }
    }

    // Update Sub-Sector options for Website VAPT MetaData
    function updateWebsiteVaptSubSectorOptions() {
        const sectorSelect = document.getElementById('websiteVaptMetaSectorOrg');
        const subSectorSelect = document.getElementById('websiteVaptMetaSubSector');
        const selectedSector = sectorSelect.value;

        // Clear existing options
        subSectorSelect.innerHTML = '<option value="">Select Sub Sector</option>';

        if (selectedSector && vaptSubSectorMappings[selectedSector]) {
            const subSectors = vaptSubSectorMappings[selectedSector];
            subSectors.forEach(subSector => {
                const option = document.createElement('option');
                option.value = subSector;
                option.textContent = subSector;
                subSectorSelect.appendChild(option);
            });
        }
    }

    // Toggle Last Audit Date Input for Website VAPT MetaData
    function toggleWebsiteVaptLastAuditDateInput(selectId, dateInputId) {
        const select = document.getElementById(selectId);
        const dateInput = document.getElementById(dateInputId);
        const hiddenInput = document.getElementById(dateInputId + 'Value');
        
        if (select.value === 'NA') {
            // Hide date input and set hidden value to NA
            dateInput.style.display = 'none';
            dateInput.required = false;
            dateInput.value = '';
            if (hiddenInput) {
                hiddenInput.value = 'NA';
            }
        } else if (select.value === 'EnterDate') {
            // Show date input and make it required
            dateInput.style.display = 'block';
            dateInput.required = true;
            if (hiddenInput) {
                // Clear hidden input, will be set from date input on form submit
                hiddenInput.value = '';
            }
        } else {
            // Default: hide and clear
            dateInput.style.display = 'none';
            dateInput.required = false;
            dateInput.value = '';
            if (hiddenInput) {
                hiddenInput.value = '';
            }
        }
    }

    // Toggle Vulnerability Section for Website VAPT MetaData
    function toggleWebsiteVaptVulnerabilitySection() {
        const vulnerabilitySection = document.getElementById('websiteVaptVulnerabilitySection');
        const vulnerabilityStatus = document.querySelector('input[name="vulnerabilityStatus"]:checked');
        
        if (vulnerabilityStatus && vulnerabilityStatus.value === 'has') {
            // Show the vulnerability section
            vulnerabilitySection.style.display = 'block';
            
            // Make all vulnerability fields required
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = true;
            });
        } else {
            // Hide the vulnerability section
            vulnerabilitySection.style.display = 'none';
            
            // Remove required attribute from all vulnerability fields
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = false;
                // Clear the values
                if (input.type === 'text' || input.type === 'number' || input.type === 'email') {
                    input.value = '';
                } else if (input.tagName === 'SELECT') {
                    input.selectedIndex = 0;
                }
            });
        }
    }

    // Add Vulnerability Entry for Website VAPT MetaData
    let websiteVaptVulnEntryCount = 1;
    function addWebsiteVaptVulnerabilityEntry() {
        const container = document.getElementById('websiteVaptVulnerabilityContainer');
        const entryDiv = document.createElement('div');
        entryDiv.className = 'vulnerability-entry';
        entryDiv.style.border = '1px solid #ddd';
        entryDiv.style.padding = '15px';
        entryDiv.style.marginBottom = '15px';
        entryDiv.style.borderRadius = '5px';
        entryDiv.style.position = 'relative';

        entryDiv.innerHTML = `
            <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
            <div class="form-group">
                <label class="form-label">Audited infrastructure details*</label>
                <input type="text" name="vuln_${websiteVaptVulnEntryCount}_infrastructure" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                <input type="text" name="vuln_${websiteVaptVulnEntryCount}_name" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">CVE/CWE Reference Number*</label>
                <input type="text" name="vuln_${websiteVaptVulnEntryCount}_cve" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Severity of Issue*</label>
                <select name="vuln_${websiteVaptVulnEntryCount}_severity" class="form-input" required>
                    <option value="">Select Severity</option>
                    <option value="Critical">Critical</option>
                    <option value="High">High</option>
                    <option value="Medium">Medium</option>
                    <option value="Low">Low</option>
                    <option value="Informational">Informational</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                <input type="number" name="vuln_${websiteVaptVulnEntryCount}_count" class="form-input" min="0" required>
            </div>
            <div class="form-group">
                <label class="form-label">Attributing Factor*</label>
                <select name="vuln_${websiteVaptVulnEntryCount}_factor" class="form-input" required>
                    <option value="">Select Factor</option>
                    <option value="Coding Error">Coding Error</option>
                    <option value="Configuration Error">Configuration Error</option>
                    <option value="Deployment Error">Deployment Error</option>
                    <option value="Design Error">Design Error</option>
                    <option value="Operation Error">Operation Error</option>
                    <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                </select>
            </div>
        `;

        container.appendChild(entryDiv);
        websiteVaptVulnEntryCount++;
    }

    // Add Employee Entry for Website VAPT MetaData
    let websiteVaptEmpEntryCount = 1;
    function addWebsiteVaptEmployeeEntry() {
        const container = document.getElementById('websiteVaptEmployeeContainer');
        const entryDiv = document.createElement('div');
        entryDiv.className = 'employee-entry';
        entryDiv.style.border = '1px solid #ddd';
        entryDiv.style.padding = '15px';
        entryDiv.style.marginBottom = '15px';
        entryDiv.style.borderRadius = '5px';
        entryDiv.style.position = 'relative';

        entryDiv.innerHTML = `
            <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
            <div class="form-group">
                <label class="form-label">Name of employee*</label>
                <input type="text" name="emp_${websiteVaptEmpEntryCount}_name" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">E-mail ID*</label>
                <input type="email" name="emp_${websiteVaptEmpEntryCount}_email" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">CISSP*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${websiteVaptEmpEntryCount}_cissp" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${websiteVaptEmpEntryCount}_cissp" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CISA*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${websiteVaptEmpEntryCount}_cisa" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${websiteVaptEmpEntryCount}_cisa" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CISM*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${websiteVaptEmpEntryCount}_cism" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${websiteVaptEmpEntryCount}_cism" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">ISO*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${websiteVaptEmpEntryCount}_iso" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${websiteVaptEmpEntryCount}_iso" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">DISA*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${websiteVaptEmpEntryCount}_disa" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${websiteVaptEmpEntryCount}_disa" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">OSCP*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${websiteVaptEmpEntryCount}_oscp" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${websiteVaptEmpEntryCount}_oscp" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CEH*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${websiteVaptEmpEntryCount}_ceh" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${websiteVaptEmpEntryCount}_ceh" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">Others</label>
                <input type="text" name="emp_${websiteVaptEmpEntryCount}_others" class="form-input" placeholder="Specify other certifications">
            </div>
            <div class="form-group">
                <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                <input type="number" name="emp_${websiteVaptEmpEntryCount}_experience" class="form-input" min="0" step="0.5" required>
            </div>
        `;

        container.appendChild(entryDiv);
        websiteVaptEmpEntryCount++;
    }

    // Handle Website VAPT First Audit MetaData form submission
    function handleWebsiteVaptFirstAuditMetaDataSubmit(event) {
        event.preventDefault();
        
        const submitBtn = document.getElementById('websiteVaptFirstAuditMetaDataSubmitBtn');
        const originalText = submitBtn.innerHTML;
        
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
        submitBtn.disabled = true;
        
        const formData = new FormData(document.getElementById('websiteVaptFirstAuditMetaDataForm'));
        
        // Handle dateLastAudit value: if date input is visible and has value, use it; otherwise use "NA"
        const dateLastAuditType = document.getElementById('websiteVaptMetaDateLastAuditType');
        const dateLastAuditInput = document.getElementById('websiteVaptMetaDateLastAudit');
        const dateLastAuditHidden = document.getElementById('websiteVaptMetaDateLastAuditValue');
        
        if (dateLastAuditType && dateLastAuditInput && dateLastAuditHidden) {
            if (dateLastAuditType.value === 'EnterDate' && dateLastAuditInput.value) {
                // Use the date value from the date input
                formData.set('dateLastAudit', dateLastAuditInput.value);
            } else {
                // Use "NA" from hidden input
                formData.set('dateLastAudit', dateLastAuditHidden.value || 'NA');
            }
        }
        
        fetch('/process_web_application_vapt_first_audit_metadata', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // Download the file
                const link = document.createElement('a');
                link.href = data.download_url;
                link.download = data.filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Close modal
                closeVaptModal('websiteVaptFirstAuditMetaDataModal');
                
                // Cleanup and reload after 2 seconds
                setTimeout(() => {
                    fetch('/cleanup_web_application_vapt_first_audit_metadata', {
                        method: 'POST'
                    }).then(() => {
                        location.reload();
                    });
                }, 2000);
            } else {
                alert('Error: ' + (data.error || 'Unknown error'));
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        })
        .catch(error => {
            console.error('Website VAPT First Audit MetaData Error:', error);
            alert('An error occurred: ' + error.message);
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
        });
    }

    // Web Application VAPT MetaData Functions
    // ==============================================================================

    // Toggle Other field for Web Application VAPT MetaData
    function toggleWebAppVaptOtherField(selectId, otherId) {
        const selectElement = document.getElementById(selectId);
        const otherInput = document.getElementById(otherId);
        
        if (selectElement && otherInput) {
            if (selectElement.value === 'Other') {
                otherInput.style.display = 'block';
                otherInput.required = true;
            } else {
                otherInput.style.display = 'none';
                otherInput.required = false;
                otherInput.value = '';
            }
        }
    }

    // Update Sub-Sector options for Web Application VAPT MetaData
    function updateWebAppVaptSubSectorOptions() {
        const sectorSelect = document.getElementById('webAppVaptMetaSectorOrg');
        const subSectorSelect = document.getElementById('webAppVaptMetaSubSector');
        const selectedSector = sectorSelect.value;

        // Clear existing options
        subSectorSelect.innerHTML = '<option value="">Select Sub Sector</option>';

        if (selectedSector && vaptSubSectorMappings[selectedSector]) {
            const subSectors = vaptSubSectorMappings[selectedSector];
            subSectors.forEach(subSector => {
                const option = document.createElement('option');
                option.value = subSector;
                option.textContent = subSector;
                subSectorSelect.appendChild(option);
            });
        }
    }

    // Toggle Last Audit Date Input for Web Application VAPT MetaData
    function toggleWebAppVaptLastAuditDateInput(selectId, dateInputId) {
        const select = document.getElementById(selectId);
        const dateInput = document.getElementById(dateInputId);
        const hiddenInput = document.getElementById(dateInputId + 'Value');
        
        if (select.value === 'NA') {
            // Hide date input and set hidden value to NA
            dateInput.style.display = 'none';
            dateInput.required = false;
            dateInput.value = '';
            if (hiddenInput) {
                hiddenInput.value = 'NA';
            }
        } else if (select.value === 'EnterDate') {
            // Show date input and make it required
            dateInput.style.display = 'block';
            dateInput.required = true;
            if (hiddenInput) {
                // Clear hidden input, will be set from date input on form submit
                hiddenInput.value = '';
            }
        } else {
            // Default: hide and clear
            dateInput.style.display = 'none';
            dateInput.required = false;
            dateInput.value = '';
            if (hiddenInput) {
                hiddenInput.value = '';
            }
        }
    }

    // Toggle Vulnerability Section for Web Application VAPT MetaData
    function toggleWebAppVaptVulnerabilitySection() {
        const vulnerabilitySection = document.getElementById('webAppVaptVulnerabilitySection');
        const form = document.getElementById('webAppVaptFirstAuditMetaDataForm');
        const vulnerabilityStatus = form ? form.querySelector('input[name="vulnerabilityStatus"]:checked') : null;
        
        if (vulnerabilityStatus && vulnerabilityStatus.value === 'has') {
            // Show the vulnerability section
            vulnerabilitySection.style.display = 'block';
            
            // Make all vulnerability fields required
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = true;
            });
        } else {
            // Hide the vulnerability section
            vulnerabilitySection.style.display = 'none';
            
            // Remove required attribute from all vulnerability fields
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = false;
                // Clear the values
                if (input.type === 'text' || input.type === 'number' || input.type === 'email') {
                    input.value = '';
                } else if (input.tagName === 'SELECT') {
                    input.selectedIndex = 0;
                }
            });
        }
    }

    // Add Vulnerability Entry for Web Application VAPT MetaData
    let webAppVaptVulnEntryCount = 1;
    function addWebAppVaptVulnerabilityEntry() {
        const container = document.getElementById('webAppVaptVulnerabilityContainer');
        const entryDiv = document.createElement('div');
        entryDiv.className = 'vulnerability-entry';
        entryDiv.style.border = '1px solid #ddd';
        entryDiv.style.padding = '15px';
        entryDiv.style.marginBottom = '15px';
        entryDiv.style.borderRadius = '5px';
        entryDiv.style.position = 'relative';

        entryDiv.innerHTML = `
            <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
            <div class="form-group">
                <label class="form-label">Audited infrastructure details*</label>
                <input type="text" name="vuln_${webAppVaptVulnEntryCount}_infrastructure" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                <input type="text" name="vuln_${webAppVaptVulnEntryCount}_name" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">CVE/CWE Reference Number*</label>
                <input type="text" name="vuln_${webAppVaptVulnEntryCount}_cve" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Severity of Issue*</label>
                <select name="vuln_${webAppVaptVulnEntryCount}_severity" class="form-input" required>
                    <option value="">Select Severity</option>
                    <option value="Critical">Critical</option>
                    <option value="High">High</option>
                    <option value="Medium">Medium</option>
                    <option value="Low">Low</option>
                    <option value="Informational">Informational</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                <input type="number" name="vuln_${webAppVaptVulnEntryCount}_count" class="form-input" min="0" required>
            </div>
            <div class="form-group">
                <label class="form-label">Attributing Factor*</label>
                <select name="vuln_${webAppVaptVulnEntryCount}_factor" class="form-input" required>
                    <option value="">Select Factor</option>
                    <option value="Coding Error">Coding Error</option>
                    <option value="Configuration Error">Configuration Error</option>
                    <option value="Deployment Error">Deployment Error</option>
                    <option value="Design Error">Design Error</option>
                    <option value="Operation Error">Operation Error</option>
                    <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                </select>
            </div>
        `;

        container.appendChild(entryDiv);
        webAppVaptVulnEntryCount++;
    }

    // Add Employee Entry for Web Application VAPT MetaData
    let webAppVaptEmpEntryCount = 1;
    function addWebAppVaptEmployeeEntry() {
        const container = document.getElementById('webAppVaptEmployeeContainer');
        const entryDiv = document.createElement('div');
        entryDiv.className = 'employee-entry';
        entryDiv.style.border = '1px solid #ddd';
        entryDiv.style.padding = '15px';
        entryDiv.style.marginBottom = '15px';
        entryDiv.style.borderRadius = '5px';
        entryDiv.style.position = 'relative';

        entryDiv.innerHTML = `
            <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
            <div class="form-group">
                <label class="form-label">Name of employee*</label>
                <input type="text" name="emp_${webAppVaptEmpEntryCount}_name" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">E-mail ID*</label>
                <input type="email" name="emp_${webAppVaptEmpEntryCount}_email" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">CISSP*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${webAppVaptEmpEntryCount}_cissp" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${webAppVaptEmpEntryCount}_cissp" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CISA*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${webAppVaptEmpEntryCount}_cisa" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${webAppVaptEmpEntryCount}_cisa" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CISM*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${webAppVaptEmpEntryCount}_cism" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${webAppVaptEmpEntryCount}_cism" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">ISO*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${webAppVaptEmpEntryCount}_iso" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${webAppVaptEmpEntryCount}_iso" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">DISA*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${webAppVaptEmpEntryCount}_disa" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${webAppVaptEmpEntryCount}_disa" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">OSCP*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${webAppVaptEmpEntryCount}_oscp" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${webAppVaptEmpEntryCount}_oscp" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CEH*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${webAppVaptEmpEntryCount}_ceh" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${webAppVaptEmpEntryCount}_ceh" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">Others</label>
                <input type="text" name="emp_${webAppVaptEmpEntryCount}_others" class="form-input" placeholder="Specify other certifications">
            </div>
            <div class="form-group">
                <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                <input type="number" name="emp_${webAppVaptEmpEntryCount}_experience" class="form-input" min="0" step="0.5" required>
            </div>
        `;

        container.appendChild(entryDiv);
        webAppVaptEmpEntryCount++;
    }

    // Handle Web Application VAPT First Audit MetaData form submission
    function handleWebAppVaptFirstAuditMetaDataSubmit(event) {
        event.preventDefault();
        
        const submitBtn = document.getElementById('webAppVaptFirstAuditMetaDataSubmitBtn');
        const originalText = submitBtn.innerHTML;
        
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
        submitBtn.disabled = true;
        
        const formData = new FormData(document.getElementById('webAppVaptFirstAuditMetaDataForm'));
        
        // Handle dateLastAudit value: if date input is visible and has value, use it; otherwise use "NA"
        const dateLastAuditType = document.getElementById('webAppVaptMetaDateLastAuditType');
        const dateLastAuditInput = document.getElementById('webAppVaptMetaDateLastAudit');
        const dateLastAuditHidden = document.getElementById('webAppVaptMetaDateLastAuditValue');
        
        if (dateLastAuditType && dateLastAuditInput && dateLastAuditHidden) {
            if (dateLastAuditType.value === 'EnterDate' && dateLastAuditInput.value) {
                // Use the date value from the date input
                formData.set('dateLastAudit', dateLastAuditInput.value);
            } else {
                // Use "NA" from hidden input
                formData.set('dateLastAudit', dateLastAuditHidden.value || 'NA');
            }
        }
        
        fetch('/process_website_vapt_first_audit_metadata', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // Download the file
                const link = document.createElement('a');
                link.href = data.download_url;
                link.download = data.filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Close modal
                closeVaptModal('webAppVaptFirstAuditMetaDataModal');
                
                // Cleanup and reload after 2 seconds
                setTimeout(() => {
                    fetch('/cleanup_website_vapt_first_audit_metadata', {
                        method: 'POST'
                    }).then(() => {
                        location.reload();
                    });
                }, 2000);
            } else {
                alert('Error: ' + (data.error || 'Unknown error'));
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        })
        .catch(error => {
            console.error('Web Application VAPT First Audit MetaData Error:', error);
            alert('An error occurred: ' + error.message);
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
        });
    }

    // ==============================================================================
    // Android Mobile Application VAPT MetaData Functions
    // ==============================================================================

    // Toggle Other field for Android Mobile Application VAPT MetaData
    function toggleAndroidVaptOtherField(selectId, otherId) {
        const selectElement = document.getElementById(selectId);
        const otherInput = document.getElementById(otherId);
        
        if (selectElement && otherInput) {
            if (selectElement.value === 'Other') {
                otherInput.style.display = 'block';
                otherInput.required = true;
            } else {
                otherInput.style.display = 'none';
                otherInput.required = false;
                otherInput.value = '';
            }
        }
    }

    // Update Sub-Sector options for Android Mobile Application VAPT MetaData
    function updateAndroidVaptSubSectorOptions() {
        const sectorSelect = document.getElementById('androidVaptMetaSectorOrg');
        const subSectorSelect = document.getElementById('androidVaptMetaSubSector');
        const selectedSector = sectorSelect.value;

        // Clear existing options
        subSectorSelect.innerHTML = '<option value="">Select Sub Sector</option>';

        if (selectedSector && vaptSubSectorMappings[selectedSector]) {
            const subSectors = vaptSubSectorMappings[selectedSector];
            subSectors.forEach(subSector => {
                const option = document.createElement('option');
                option.value = subSector;
                option.textContent = subSector;
                subSectorSelect.appendChild(option);
            });
        }
    }

    // Toggle Last Audit Date Input for Android Mobile Application VAPT MetaData
    function toggleAndroidVaptLastAuditDateInput(selectId, dateInputId) {
        const select = document.getElementById(selectId);
        const dateInput = document.getElementById(dateInputId);
        const hiddenInput = document.getElementById(dateInputId + 'Value');
        
        if (select.value === 'NA') {
            dateInput.style.display = 'none';
            dateInput.required = false;
            dateInput.value = '';
            if (hiddenInput) {
                hiddenInput.value = 'NA';
            }
        } else if (select.value === 'EnterDate') {
            dateInput.style.display = 'block';
            dateInput.required = true;
            if (hiddenInput) {
                hiddenInput.value = '';
            }
        } else {
            dateInput.style.display = 'none';
            dateInput.required = false;
            dateInput.value = '';
            if (hiddenInput) {
                hiddenInput.value = '';
            }
        }
    }

    // Toggle Vulnerability Section for Android Mobile Application VAPT MetaData
    function toggleAndroidVaptVulnerabilitySection() {
        const vulnerabilitySection = document.getElementById('androidVaptVulnerabilitySection');
        const form = document.getElementById('androidVaptFirstAuditMetaDataForm');
        const vulnerabilityStatus = form ? form.querySelector('input[name="vulnerabilityStatus"]:checked') : null;
        
        if (vulnerabilityStatus && vulnerabilityStatus.value === 'has') {
            // Show the vulnerability section
            vulnerabilitySection.style.display = 'block';
            
            // Make all vulnerability fields required
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = true;
            });
        } else {
            // Hide the vulnerability section
            vulnerabilitySection.style.display = 'none';
            
            // Remove required attribute from all vulnerability fields
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = false;
                // Clear the values
                if (input.type === 'text' || input.type === 'number' || input.type === 'email') {
                    input.value = '';
                } else if (input.tagName === 'SELECT') {
                    input.selectedIndex = 0;
                }
            });
        }
    }

    // Add Vulnerability Entry for Android Mobile Application VAPT MetaData
    let androidVaptVulnEntryCount = 1;
    function addAndroidVaptVulnerabilityEntry() {
        const container = document.getElementById('androidVaptVulnerabilityContainer');
        const entryDiv = document.createElement('div');
        entryDiv.className = 'vulnerability-entry';
        entryDiv.style.border = '1px solid #ddd';
        entryDiv.style.padding = '15px';
        entryDiv.style.marginBottom = '15px';
        entryDiv.style.borderRadius = '5px';
        entryDiv.style.position = 'relative';

        entryDiv.innerHTML = `
            <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
            <div class="form-group">
                <label class="form-label">Audited infrastructure details*</label>
                <input type="text" name="vuln_${androidVaptVulnEntryCount}_infrastructure" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                <input type="text" name="vuln_${androidVaptVulnEntryCount}_name" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">CVE/CWE Reference Number*</label>
                <input type="text" name="vuln_${androidVaptVulnEntryCount}_cve" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Severity of Issue*</label>
                <select name="vuln_${androidVaptVulnEntryCount}_severity" class="form-input" required>
                    <option value="">Select Severity</option>
                    <option value="Critical">Critical</option>
                    <option value="High">High</option>
                    <option value="Medium">Medium</option>
                    <option value="Low">Low</option>
                    <option value="Informational">Informational</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                <input type="number" name="vuln_${androidVaptVulnEntryCount}_count" class="form-input" min="0" required>
            </div>
            <div class="form-group">
                <label class="form-label">Attributing Factor*</label>
                <select name="vuln_${androidVaptVulnEntryCount}_factor" class="form-input" required>
                    <option value="">Select Factor</option>
                    <option value="Coding Error">Coding Error</option>
                    <option value="Configuration Error">Configuration Error</option>
                    <option value="Deployment Error">Deployment Error</option>
                    <option value="Design Error">Design Error</option>
                    <option value="Operation Error">Operation Error</option>
                    <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                </select>
            </div>
        `;

        container.appendChild(entryDiv);
        androidVaptVulnEntryCount++;
    }

    // Add Employee Entry for Android Mobile Application VAPT MetaData
    let androidVaptEmpEntryCount = 1;
    function addAndroidVaptEmployeeEntry() {
        const container = document.getElementById('androidVaptEmployeeContainer');
        const entryDiv = document.createElement('div');
        entryDiv.className = 'employee-entry';
        entryDiv.style.border = '1px solid #ddd';
        entryDiv.style.padding = '15px';
        entryDiv.style.marginBottom = '15px';
        entryDiv.style.borderRadius = '5px';
        entryDiv.style.position = 'relative';

        entryDiv.innerHTML = `
            <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
            <div class="form-group">
                <label class="form-label">Name of employee*</label>
                <input type="text" name="emp_${androidVaptEmpEntryCount}_name" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">E-mail ID*</label>
                <input type="email" name="emp_${androidVaptEmpEntryCount}_email" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">CISSP*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${androidVaptEmpEntryCount}_cissp" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${androidVaptEmpEntryCount}_cissp" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CISA*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${androidVaptEmpEntryCount}_cisa" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${androidVaptEmpEntryCount}_cisa" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CISM*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${androidVaptEmpEntryCount}_cism" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${androidVaptEmpEntryCount}_cism" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">ISO*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${androidVaptEmpEntryCount}_iso" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${androidVaptEmpEntryCount}_iso" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">DISA*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${androidVaptEmpEntryCount}_disa" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${androidVaptEmpEntryCount}_disa" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">OSCP*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${androidVaptEmpEntryCount}_oscp" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${androidVaptEmpEntryCount}_oscp" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CEH*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${androidVaptEmpEntryCount}_ceh" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${androidVaptEmpEntryCount}_ceh" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">Others</label>
                <input type="text" name="emp_${androidVaptEmpEntryCount}_others" class="form-input" placeholder="Specify other certifications">
            </div>
            <div class="form-group">
                <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                <input type="number" name="emp_${androidVaptEmpEntryCount}_experience" class="form-input" min="0" step="0.5" required>
            </div>
        `;

        container.appendChild(entryDiv);
        androidVaptEmpEntryCount++;
    }

    // Handle Android Mobile Application VAPT First Audit MetaData form submission
    function handleAndroidVaptFirstAuditMetaDataSubmit(event) {
        event.preventDefault();
        
        const submitBtn = document.getElementById('androidVaptFirstAuditMetaDataSubmitBtn');
        const originalText = submitBtn.innerHTML;
        
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
        submitBtn.disabled = true;
        
        const formData = new FormData(document.getElementById('androidVaptFirstAuditMetaDataForm'));
        
        const dateLastAuditType = document.getElementById('androidVaptMetaDateLastAuditType');
        const dateLastAuditInput = document.getElementById('androidVaptMetaDateLastAudit');
        const dateLastAuditHidden = document.getElementById('androidVaptMetaDateLastAuditValue');
        
        if (dateLastAuditType && dateLastAuditInput && dateLastAuditHidden) {
            if (dateLastAuditType.value === 'EnterDate' && dateLastAuditInput.value) {
                formData.set('dateLastAudit', dateLastAuditInput.value);
            } else {
                formData.set('dateLastAudit', dateLastAuditHidden.value || 'NA');
            }
        }
        
        fetch('/process_android_application_vapt_first_audit_metadata', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const link = document.createElement('a');
                link.href = data.download_url;
                link.download = data.filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                closeVaptModal('androidVaptFirstAuditMetaDataModal');
                
                setTimeout(() => {
                    fetch('/cleanup_android_application_vapt_first_audit_metadata', {
                        method: 'POST'
                    }).then(() => {
                        location.reload();
                    });
                }, 2000);
            } else {
                alert('Error: ' + (data.error || 'Unknown error'));
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        })
        .catch(error => {
            console.error('Android Mobile Application VAPT First Audit MetaData Error:', error);
            alert('An error occurred: ' + error.message);
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
        });
    }

    // ==============================================================================
    // IOS Mobile Application VAPT MetaData Functions
    // ==============================================================================

    // Toggle Other field for IOS Mobile Application VAPT MetaData
    function toggleIosVaptOtherField(selectId, otherId) {
        const selectElement = document.getElementById(selectId);
        const otherInput = document.getElementById(otherId);
        
        if (selectElement && otherInput) {
            if (selectElement.value === 'Other') {
                otherInput.style.display = 'block';
                otherInput.required = true;
            } else {
                otherInput.style.display = 'none';
                otherInput.required = false;
                otherInput.value = '';
            }
        }
    }

    // Update Sub-Sector options for IOS Mobile Application VAPT MetaData
    function updateIosVaptSubSectorOptions() {
        const sectorSelect = document.getElementById('iosVaptMetaSectorOrg');
        const subSectorSelect = document.getElementById('iosVaptMetaSubSector');
        const selectedSector = sectorSelect.value;

        subSectorSelect.innerHTML = '<option value="">Select Sub Sector</option>';

        if (selectedSector && vaptSubSectorMappings[selectedSector]) {
            const subSectors = vaptSubSectorMappings[selectedSector];
            subSectors.forEach(subSector => {
                const option = document.createElement('option');
                option.value = subSector;
                option.textContent = subSector;
                subSectorSelect.appendChild(option);
            });
        }
    }

    // Toggle Last Audit Date Input for IOS Mobile Application VAPT MetaData
    function toggleIosVaptLastAuditDateInput(selectId, dateInputId) {
        const select = document.getElementById(selectId);
        const dateInput = document.getElementById(dateInputId);
        const hiddenInput = document.getElementById(dateInputId + 'Value');
        
        if (select.value === 'NA') {
            dateInput.style.display = 'none';
            dateInput.required = false;
            dateInput.value = '';
            if (hiddenInput) {
                hiddenInput.value = 'NA';
            }
        } else if (select.value === 'EnterDate') {
            dateInput.style.display = 'block';
            dateInput.required = true;
            if (hiddenInput) {
                hiddenInput.value = '';
            }
        } else {
            dateInput.style.display = 'none';
            dateInput.required = false;
            dateInput.value = '';
            if (hiddenInput) {
                hiddenInput.value = '';
            }
        }
    }

    // Toggle Vulnerability Section for IOS Mobile Application VAPT MetaData
    function toggleIosVaptVulnerabilitySection() {
        const vulnerabilitySection = document.getElementById('iosVaptVulnerabilitySection');
        const form = document.getElementById('iosVaptFirstAuditMetaDataForm');
        const vulnerabilityStatus = form ? form.querySelector('input[name="vulnerabilityStatus"]:checked') : null;
        
        if (vulnerabilityStatus && vulnerabilityStatus.value === 'has') {
            // Show the vulnerability section
            vulnerabilitySection.style.display = 'block';
            
            // Make all vulnerability fields required
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = true;
            });
        } else {
            // Hide the vulnerability section
            vulnerabilitySection.style.display = 'none';
            
            // Remove required attribute from all vulnerability fields
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = false;
                // Clear the values
                if (input.type === 'text' || input.type === 'number' || input.type === 'email') {
                    input.value = '';
                } else if (input.tagName === 'SELECT') {
                    input.selectedIndex = 0;
                }
            });
        }
    }

    // Add Vulnerability Entry for IOS Mobile Application VAPT MetaData
    let iosVaptVulnEntryCount = 1;
    function addIosVaptVulnerabilityEntry() {
        const container = document.getElementById('iosVaptVulnerabilityContainer');
        const entryDiv = document.createElement('div');
        entryDiv.className = 'vulnerability-entry';
        entryDiv.style.border = '1px solid #ddd';
        entryDiv.style.padding = '15px';
        entryDiv.style.marginBottom = '15px';
        entryDiv.style.borderRadius = '5px';
        entryDiv.style.position = 'relative';

        entryDiv.innerHTML = `
            <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
            <div class="form-group">
                <label class="form-label">Audited infrastructure details*</label>
                <input type="text" name="vuln_${iosVaptVulnEntryCount}_infrastructure" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                <input type="text" name="vuln_${iosVaptVulnEntryCount}_name" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">CVE/CWE Reference Number*</label>
                <input type="text" name="vuln_${iosVaptVulnEntryCount}_cve" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Severity of Issue*</label>
                <select name="vuln_${iosVaptVulnEntryCount}_severity" class="form-input" required>
                    <option value="">Select Severity</option>
                    <option value="Critical">Critical</option>
                    <option value="High">High</option>
                    <option value="Medium">Medium</option>
                    <option value="Low">Low</option>
                    <option value="Informational">Informational</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                <input type="number" name="vuln_${iosVaptVulnEntryCount}_count" class="form-input" min="0" required>
            </div>
            <div class="form-group">
                <label class="form-label">Attributing Factor*</label>
                <select name="vuln_${iosVaptVulnEntryCount}_factor" class="form-input" required>
                    <option value="">Select Factor</option>
                    <option value="Coding Error">Coding Error</option>
                    <option value="Configuration Error">Configuration Error</option>
                    <option value="Deployment Error">Deployment Error</option>
                    <option value="Design Error">Design Error</option>
                    <option value="Operation Error">Operation Error</option>
                    <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                </select>
            </div>
        `;

        container.appendChild(entryDiv);
        iosVaptVulnEntryCount++;
    }

    // Add Employee Entry for IOS Mobile Application VAPT MetaData
    let iosVaptEmpEntryCount = 1;
    function addIosVaptEmployeeEntry() {
        const container = document.getElementById('iosVaptEmployeeContainer');
        const entryDiv = document.createElement('div');
        entryDiv.className = 'employee-entry';
        entryDiv.style.border = '1px solid #ddd';
        entryDiv.style.padding = '15px';
        entryDiv.style.marginBottom = '15px';
        entryDiv.style.borderRadius = '5px';
        entryDiv.style.position = 'relative';

        entryDiv.innerHTML = `
            <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
            <div class="form-group">
                <label class="form-label">Name of employee*</label>
                <input type="text" name="emp_${iosVaptEmpEntryCount}_name" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">E-mail ID*</label>
                <input type="email" name="emp_${iosVaptEmpEntryCount}_email" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">CISSP*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${iosVaptEmpEntryCount}_cissp" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${iosVaptEmpEntryCount}_cissp" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CISA*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${iosVaptEmpEntryCount}_cisa" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${iosVaptEmpEntryCount}_cisa" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CISM*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${iosVaptEmpEntryCount}_cism" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${iosVaptEmpEntryCount}_cism" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">ISO*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${iosVaptEmpEntryCount}_iso" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${iosVaptEmpEntryCount}_iso" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">DISA*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${iosVaptEmpEntryCount}_disa" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${iosVaptEmpEntryCount}_disa" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">OSCP*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${iosVaptEmpEntryCount}_oscp" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${iosVaptEmpEntryCount}_oscp" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CEH*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${iosVaptEmpEntryCount}_ceh" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${iosVaptEmpEntryCount}_ceh" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">Others</label>
                <input type="text" name="emp_${iosVaptEmpEntryCount}_others" class="form-input" placeholder="Specify other certifications">
            </div>
            <div class="form-group">
                <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                <input type="number" name="emp_${iosVaptEmpEntryCount}_experience" class="form-input" min="0" step="0.5" required>
            </div>
        `;

        container.appendChild(entryDiv);
        iosVaptEmpEntryCount++;
    }

    // Handle IOS Mobile Application VAPT First Audit MetaData form submission
    function handleIosVaptFirstAuditMetaDataSubmit(event) {
        event.preventDefault();
        
        const submitBtn = document.getElementById('iosVaptFirstAuditMetaDataSubmitBtn');
        const originalText = submitBtn.innerHTML;
        
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
        submitBtn.disabled = true;
        
        const formData = new FormData(document.getElementById('iosVaptFirstAuditMetaDataForm'));
        
        const dateLastAuditType = document.getElementById('iosVaptMetaDateLastAuditType');
        const dateLastAuditInput = document.getElementById('iosVaptMetaDateLastAudit');
        const dateLastAuditHidden = document.getElementById('iosVaptMetaDateLastAuditValue');
        
        if (dateLastAuditType && dateLastAuditInput && dateLastAuditHidden) {
            if (dateLastAuditType.value === 'EnterDate' && dateLastAuditInput.value) {
                formData.set('dateLastAudit', dateLastAuditInput.value);
            } else {
                formData.set('dateLastAudit', dateLastAuditHidden.value || 'NA');
            }
        }
        
        fetch('/process_ios_application_vapt_first_audit_metadata', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const link = document.createElement('a');
                link.href = data.download_url;
                link.download = data.filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                closeVaptModal('iosVaptFirstAuditMetaDataModal');
                
                setTimeout(() => {
                    fetch('/cleanup_ios_application_vapt_first_audit_metadata', {
                        method: 'POST'
                    }).then(() => {
                        location.reload();
                    });
                }, 2000);
            } else {
                alert('Error: ' + (data.error || 'Unknown error'));
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        })
        .catch(error => {
            console.error('IOS Mobile Application VAPT First Audit MetaData Error:', error);
            alert('An error occurred: ' + error.message);
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
        });
    }

    // ==============================================================================
    // Website VAPT Follow Up MetaData Functions
    // ==============================================================================

    // Sub-sector mappings for Website VAPT Follow Up MetaData
    const websiteVaptFollowUpSubSectorMappings = {"Agriculture": ["Agriculture"], "Defence": ["Defence"], "Education": ["Education"], "Energy": ["Nuclear Energy", "Oil and Gas", "Power", "Renewable Energy"], "Finance": ["Banking", "Financial Services and Tax", "Insurance", "Market Infrastructure Institutions", "PFRDA", "NHB"], "Healthcare": ["Healthcare services", "Medical devices", "Pharmaceuticals"], "Information_and_Broadcasting": ["Information_and_Broadcasting"], "Information_and_Communication_Technology": ["Information_and_Communication_Technology"], "Law_Enforcement_and_Security": ["Law_Enforcement_and_Security"], "Public_Essential_Services_and_Utilities": ["Building and Construction", "Emergency Services", "Food", "Textiles and Consumer Goods", "Heavy industries", "Postal Services", "Public administration", "Retail services", "Sports, cultural activities, Trade Fairs and Entertainment", "Tourism & Hospitality", "Water and Sewage Utilities"], "Space": ["Space"], "Transportation": ["Air Transportation", "Land Transportation", "Water Transportation"]};

    // Update Follow Up Sub-Sector options for Website VAPT MetaData
    function updateWebsiteVaptFollowUpSubSectorOptions() {
        const sectorSelect = document.getElementById('websiteVaptFollowUpMetaSectorOrg');
        const subSectorSelect = document.getElementById('websiteVaptFollowUpMetaSubSector');
        const selectedSector = sectorSelect.value;

        // Clear existing options
        subSectorSelect.innerHTML = '<option value="">Select Sub Sector</option>';

        if (selectedSector && websiteVaptFollowUpSubSectorMappings[selectedSector]) {
            const subSectors = websiteVaptFollowUpSubSectorMappings[selectedSector];
            subSectors.forEach(subSector => {
                const option = document.createElement('option');
                option.value = subSector;
                option.textContent = subSector;
                subSectorSelect.appendChild(option);
            });
        }
    }

    // Add Vulnerability Entry for Website VAPT Follow Up MetaData
    let websiteVaptFollowUpVulnEntryCount = 1;
    // Toggle Vulnerability Section for Website VAPT Follow Up Audit MetaData
    function toggleWebsiteVaptFollowUpVulnerabilitySection() {
        const vulnerabilitySection = document.getElementById('websiteVaptFollowUpVulnerabilitySection');
        const form = document.getElementById('websiteVaptFollowUpAuditMetaDataForm');
        const vulnerabilityStatus = form ? form.querySelector('input[name="vulnerabilityStatus"]:checked') : null;
        
        if (vulnerabilityStatus && vulnerabilityStatus.value === 'has') {
            // Show the vulnerability section
            vulnerabilitySection.style.display = 'block';
            
            // Make all vulnerability fields required
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = true;
            });
        } else {
            // Hide the vulnerability section
            vulnerabilitySection.style.display = 'none';
            
            // Remove required attribute from all vulnerability fields
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = false;
                // Clear the values
                if (input.type === 'text' || input.type === 'number' || input.type === 'email') {
                    input.value = '';
                } else if (input.tagName === 'SELECT') {
                    input.selectedIndex = 0;
                }
            });
        }
    }

    function addWebsiteVaptFollowUpVulnerabilityEntry() {
        const container = document.getElementById('websiteVaptFollowUpVulnerabilityContainer');
        const entryDiv = document.createElement('div');
        entryDiv.className = 'vulnerability-entry';
        entryDiv.style.border = '1px solid #ddd';
        entryDiv.style.padding = '15px';
        entryDiv.style.marginBottom = '15px';
        entryDiv.style.borderRadius = '5px';
        entryDiv.style.position = 'relative';

        entryDiv.innerHTML = `
            <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
            <div class="form-group">
                <label class="form-label">Audited infrastructure details*</label>
                <input type="text" name="vuln_${websiteVaptFollowUpVulnEntryCount}_infrastructure" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                <input type="text" name="vuln_${websiteVaptFollowUpVulnEntryCount}_name" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">CVE/CWE Reference Number*</label>
                <input type="text" name="vuln_${websiteVaptFollowUpVulnEntryCount}_cve" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Severity of Issue*</label>
                <select name="vuln_${websiteVaptFollowUpVulnEntryCount}_severity" class="form-input" required>
                    <option value="">Select Severity</option>
                    <option value="Critical">Critical</option>
                    <option value="High">High</option>
                    <option value="Medium">Medium</option>
                    <option value="Low">Low</option>
                    <option value="Informational">Informational</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                <input type="number" name="vuln_${websiteVaptFollowUpVulnEntryCount}_count" class="form-input" min="0" required>
            </div>
            <div class="form-group">
                <label class="form-label">Attributing Factor*</label>
                <select name="vuln_${websiteVaptFollowUpVulnEntryCount}_factor" class="form-input" required>
                    <option value="">Select Factor</option>
                    <option value="Coding Error">Coding Error</option>
                    <option value="Configuration Error">Configuration Error</option>
                    <option value="Deployment Error">Deployment Error</option>
                    <option value="Design Error">Design Error</option>
                    <option value="Operation Error">Operation Error</option>
                    <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                </select>
            </div>
        `;

        container.appendChild(entryDiv);
        websiteVaptFollowUpVulnEntryCount++;
    }

    // Add Employee Entry for Website VAPT Follow Up MetaData
    let websiteVaptFollowUpEmpEntryCount = 1;
    function addWebsiteVaptFollowUpEmployeeEntry() {
        const container = document.getElementById('websiteVaptFollowUpEmployeeContainer');
        const entryDiv = document.createElement('div');
        entryDiv.className = 'employee-entry';
        entryDiv.style.border = '1px solid #ddd';
        entryDiv.style.padding = '15px';
        entryDiv.style.marginBottom = '15px';
        entryDiv.style.borderRadius = '5px';
        entryDiv.style.position = 'relative';

        entryDiv.innerHTML = `
            <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
            <div class="form-group">
                <label class="form-label">Name of employee*</label>
                <input type="text" name="emp_${websiteVaptFollowUpEmpEntryCount}_name" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">E-mail ID*</label>
                <input type="email" name="emp_${websiteVaptFollowUpEmpEntryCount}_email" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">CISSP*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${websiteVaptFollowUpEmpEntryCount}_cissp" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${websiteVaptFollowUpEmpEntryCount}_cissp" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CISA*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${websiteVaptFollowUpEmpEntryCount}_cisa" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${websiteVaptFollowUpEmpEntryCount}_cisa" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CISM*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${websiteVaptFollowUpEmpEntryCount}_cism" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${websiteVaptFollowUpEmpEntryCount}_cism" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">ISO*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${websiteVaptFollowUpEmpEntryCount}_iso" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${websiteVaptFollowUpEmpEntryCount}_iso" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">DISA*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${websiteVaptFollowUpEmpEntryCount}_disa" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${websiteVaptFollowUpEmpEntryCount}_disa" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">OSCP*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${websiteVaptFollowUpEmpEntryCount}_oscp" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${websiteVaptFollowUpEmpEntryCount}_oscp" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CEH*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${websiteVaptFollowUpEmpEntryCount}_ceh" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${websiteVaptFollowUpEmpEntryCount}_ceh" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">Others</label>
                <input type="text" name="emp_${websiteVaptFollowUpEmpEntryCount}_others" class="form-input" placeholder="Specify other certifications">
            </div>
            <div class="form-group">
                <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                <input type="number" name="emp_${websiteVaptFollowUpEmpEntryCount}_experience" class="form-input" min="0" step="0.5" required>
            </div>
        `;

        container.appendChild(entryDiv);
        websiteVaptFollowUpEmpEntryCount++;
    }

    // Handle Infrastructure VAPT Follow Up Audit MetaData form submission
    function handleVaptFollowUpAuditMetaDataSubmit(event) {
        event.preventDefault();
        
        const submitBtn = document.getElementById('vaptFollowUpAuditMetaDataSubmitBtn');
        const originalText = submitBtn ? submitBtn.innerHTML : '';
        
        if (submitBtn) {
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
        }
        
        const form = document.getElementById('vaptFollowUpAuditMetaDataForm');
        const formData = new FormData(form);
        
        fetch('/process_vapt_follow_up_audit_metadata', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // Download the file
                const link = document.createElement('a');
                link.href = data.download_url;
                link.download = data.filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Close modal
                closeVaptModal('vaptFollowUpAuditMetaDataModal');
                
                // Cleanup and reload after 2 seconds
                setTimeout(() => {
                    fetch('/cleanup_vapt_follow_up_audit_metadata', {
                        method: 'POST'
                    }).then(() => {
                        location.reload();
                    });
                }, 2000);
            } else {
                alert('Error: ' + (data.error || 'Unknown error'));
                if (submitBtn) {
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                }
            }
        })
        .catch(error => {
            console.error('Infrastructure VAPT Follow Up Audit MetaData Error:', error);
            alert('An error occurred: ' + error.message);
            if (submitBtn) {
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        });
    }

    // Handle Website VAPT Follow Up Audit MetaData form submission
    function handleWebsiteVaptFollowUpAuditMetaDataSubmit(event) {
        event.preventDefault();
        
        const submitBtn = document.getElementById('websiteVaptFollowUpAuditMetaDataSubmitBtn');
        const originalText = submitBtn.innerHTML;
        
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
        submitBtn.disabled = true;
        
        const formData = new FormData(document.getElementById('websiteVaptFollowUpAuditMetaDataForm'));
        
        fetch('/process_website_vapt_follow_up_audit_metadata', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // Download the file
                const link = document.createElement('a');
                link.href = data.download_url;
                link.download = data.filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Close modal
                closeVaptModal('websiteVaptFollowUpAuditMetaDataModal');
                
                // Cleanup and reload after 2 seconds
                setTimeout(() => {
                    fetch('/cleanup_website_vapt_follow_up_audit_metadata', {
                        method: 'POST'
                    }).then(() => {
                        location.reload();
                    });
                }, 2000);
            } else {
                alert('Error: ' + (data.error || 'Unknown error'));
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        })
        .catch(error => {
            console.error('Website VAPT Follow Up Audit MetaData Error:', error);
            alert('An error occurred: ' + error.message);
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
        });
    }

    // ==============================================================================
    // Website VAPT Functions
    // ==============================================================================

    // Website VAPT Add Email functionality
    const websiteVaptAddEmailBtn = document.getElementById('websiteVaptAddEmailBtn');
    if (websiteVaptAddEmailBtn) {
        websiteVaptAddEmailBtn.addEventListener('click', function() {
            const container = document.getElementById('websiteVaptEmailContainer');
            const emailDiv = document.createElement('div');
            emailDiv.style.display = 'flex';
            emailDiv.style.gap = '10px';
            emailDiv.style.marginTop = '10px';
            emailDiv.innerHTML = `
                <input type="email" name="bankEmail[]" placeholder="Email Address" required style="flex: 1;">
                <button type="button" onclick="removeVaptEmailField(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; cursor: pointer;">Remove</button>
            `;
            container.appendChild(emailDiv);
        });
    }

    // Website VAPT Add Team Member functionality
    const websiteVaptAddMemberBtn = document.getElementById('websiteVaptAddMemberBtn');
    if (websiteVaptAddMemberBtn) {
        let websiteVaptTeamMemberCount = 1;
        
        websiteVaptAddMemberBtn.addEventListener('click', function() {
            const container = document.getElementById('websiteVaptAuditTeamContainer');
            const teamMembers = container.querySelectorAll('.team-member');
            
            if (teamMembers.length >= 8) {
                alert('Maximum 8 team members allowed');
                return;
            }
            
            const index = websiteVaptTeamMemberCount;
            const memberDiv = document.createElement('div');
            memberDiv.className = 'team-member';
            memberDiv.setAttribute('data-index', index);
            
            memberDiv.innerHTML = `
                <div class="form-row">
                    <div class="form-group">
                        <input type="text" name="teamName[]" placeholder="Name*" required>
                    </div>
                    <div class="form-group">
                        <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                    </div>
                    <div class="form-group">
                        <input type="text" name="teamQualification[]" placeholder="Qualification/Certification*" required>
                    </div>
                </div>
                <div class="form-group">
                    <label>Certified (Yes/No)*</label>
                    <div class="radio-group">
                        <label><input type="radio" name="teamCertified[${index}]" value="yes" required> Yes</label>
                        <label><input type="radio" name="teamCertified[${index}]" value="no"> No</label>
                    </div>
                </div>
                <button type="button" onclick="removeWebsiteVaptTeamMember(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; margin-top: 10px; cursor: pointer;">Remove Member</button>
            `;
            
            container.appendChild(memberDiv);
            websiteVaptTeamMemberCount++;
        });
    }

    function removeWebsiteVaptTeamMember(button) {
        const container = document.getElementById('websiteVaptAuditTeamContainer');
        const teamMembers = container.querySelectorAll('.team-member');
        
        if (teamMembers.length <= 1) {
            alert('At least one team member is required');
            return;
        }
        
        button.closest('.team-member').remove();
    }

    // Website VAPT Global state for vulnerability merging
    let websiteVaptVulnerabilityMergeState = {
        matchedGroups: [],
        unmatchedVulnerabilities: [],
        isWebsite: true  // Flag to differentiate from Infrastructure
    };

    // Website VAPT Form Submission Handler
    document.getElementById('websiteVaptFirstAuditForm').addEventListener('submit', function(e) {
        e.preventDefault();
        
        // Validate team members
        const teamMembers = document.getElementById('websiteVaptAuditTeamContainer').querySelectorAll('.team-member');
        if (teamMembers.length < 1) {
            alert('At least one team member is required');
            return;
        }
        
        // Validate dates
        const startDate = new Date(document.getElementById('websiteVaptStartDate').value);
        const endDate = new Date(document.getElementById('websiteVaptEndDate').value);
        
        if (endDate < startDate) {
            alert('End date must be after start date');
            return;
        }
        
        // Check vulnerabilities first
        checkWebsiteVaptVulnerabilitiesBeforeReport(this);
    });

    function checkWebsiteVaptVulnerabilitiesBeforeReport(form) {
        const formData = new FormData(form);
        const submitBtn = form.querySelector('.submit-btn');
        const originalText = submitBtn.textContent;
        
        submitBtn.disabled = true;
        submitBtn.textContent = 'Checking Vulnerabilities...';
        
        fetch('/check_website_vapt_vulnerabilities', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.error) {
                alert('Error: ' + data.error);
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
                return;
            }
            
            // Show vulnerability confirmation dialog
            showWebsiteVaptVulnerabilityConfirmationDialog(data, form);
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Error checking vulnerabilities: ' + error.message);
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
        });
    }

    function resetWebsiteVaptSubmitButtonState() {
        const submitBtn = document.querySelector('#websiteVaptFirstAuditForm .submit-btn');
        if (submitBtn) {
            submitBtn.disabled = false;
            submitBtn.textContent = 'Submit Report';
        }
    }

    function showWebsiteVaptVulnerabilityConfirmationDialog(vulnData, form) {
        // Update global state
        websiteVaptVulnerabilityMergeState.matchedGroups = vulnData.matched_groups || [];
        websiteVaptVulnerabilityMergeState.unmatchedVulnerabilities = vulnData.unmatched_vulnerabilities || [];
        
        // Create dialog overlay
        const dialogOverlay = document.createElement('div');
        dialogOverlay.id = 'websiteVaptVulnerabilityDialog';
        dialogOverlay.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        `;
        
        const dialogContent = document.createElement('div');
        dialogContent.className = 'dialog-content';
        dialogContent.style.cssText = `
            background: white;
            padding: 30px;
            border-radius: 8px;
            max-width: 1400px;
            max-height: 90vh;
            overflow: auto;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        `;
        
        // Header with title, undo button, count info, and Add Vulnerability Manual button
        const headerSection = document.createElement('div');
        headerSection.style.cssText = 'display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid #2c3e50;';
        
        const headerLeft = document.createElement('div');
        headerLeft.style.cssText = 'display: flex; align-items: center; gap: 15px;';
        
        const headerTitle = document.createElement('h2');
        headerTitle.textContent = 'Website VAPT - Vulnerability Management';
        headerTitle.style.cssText = 'margin: 0; color: #2c3e50;';
        
        const undoButton = document.createElement('button');
        undoButton.textContent = ' Undo Last Operation';
        undoButton.className = 'undo-btn';
        undoButton.style.cssText = 'padding: 8px 16px; background-color: #f39c12; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 13px;';
        undoButton.onclick = undoWebsiteVaptLastMergeOperation;
        
        const refreshInfo = document.createElement('span');
        refreshInfo.textContent = `Matched: ${websiteVaptVulnerabilityMergeState.matchedGroups.length} | Unmatched: ${websiteVaptVulnerabilityMergeState.unmatchedVulnerabilities.length}`;
        refreshInfo.style.cssText = 'font-size: 14px; color: #666;';
        refreshInfo.id = 'websiteVaptVulnCountInfo';
        
        headerLeft.appendChild(headerTitle);
        headerLeft.appendChild(undoButton);
        headerLeft.appendChild(refreshInfo);
        
        const addManualVulnBtn = document.createElement('button');
        addManualVulnBtn.type = 'button';
        addManualVulnBtn.className = 'submit-btn';
        addManualVulnBtn.style.cssText = 'background-color: #27ae60; padding: 10px 20px; font-size: 14px;';
        addManualVulnBtn.innerHTML = '<i class="fas fa-plus-circle"></i> Add Vulnerability Manual';
        addManualVulnBtn.onclick = () => showWebsiteAddManualVulnerabilityDialog();
        
        headerSection.appendChild(headerLeft);
        headerSection.appendChild(addManualVulnBtn);
        dialogContent.appendChild(headerSection);
        
        // Vulnerability management container
        const vulnContainer = document.createElement('div');
        vulnContainer.id = 'websiteVaptVulnManagementContainer';
        vulnContainer.className = 'vulnerability-management-container';
        dialogContent.appendChild(vulnContainer);
        
        // Render initial UI
        renderWebsiteVaptVulnerabilityUI(vulnContainer);
        
        // Proceed and Cancel buttons
        const buttonContainer = document.createElement('div');
        buttonContainer.style.cssText = 'margin-top: 20px; display: flex; gap: 15px; justify-content: flex-end; padding-top: 20px; border-top: 2px solid #eee;';
        
        const cancelBtn = document.createElement('button');
        cancelBtn.type = 'button';
        cancelBtn.className = 'cancel-btn';
        cancelBtn.textContent = 'Cancel';
        cancelBtn.onclick = () => {
            document.body.removeChild(dialogOverlay);
            resetWebsiteVaptSubmitButtonState();
        };
        
        const proceedBtn = document.createElement('button');
        proceedBtn.type = 'button';
        proceedBtn.className = 'proceed-btn submit-btn';
        proceedBtn.textContent = 'Proceed to Generate Report';
        proceedBtn.style.cssText = 'background-color: #2c3e50; min-width: 200px;';
        proceedBtn.onclick = () => {
            if (websiteVaptVulnerabilityMergeState.unmatchedVulnerabilities.length > 0) {
                alert('Please handle all unmatched vulnerabilities before proceeding');
                return;
            }
            
            document.body.removeChild(dialogOverlay);
            generateWebsiteVaptReport(form);
        };
        
        // Disable proceed button if there are unmatched vulnerabilities
        if (websiteVaptVulnerabilityMergeState.unmatchedVulnerabilities.length > 0) {
            proceedBtn.disabled = true;
            proceedBtn.style.opacity = '0.5';
            proceedBtn.style.cursor = 'not-allowed';
        }
        
        buttonContainer.appendChild(cancelBtn);
        buttonContainer.appendChild(proceedBtn);
        dialogContent.appendChild(buttonContainer);
        
        dialogOverlay.appendChild(dialogContent);
        document.body.appendChild(dialogOverlay);
    }

    function renderWebsiteVaptVulnerabilityUI(container) {
        container.innerHTML = '';
        
        // Matched Groups Section
        const matchedSection = document.createElement('div');
        matchedSection.style.cssText = 'margin-bottom: 30px;';
        matchedSection.id = 'websiteVaptMatchedVulnSection';
        
        const matchedTitle = document.createElement('h3');
        matchedTitle.textContent = ' Matched Vulnerabilities';
        matchedTitle.style.cssText = 'color: #27ae60; border-bottom: 2px solid #27ae60; padding-bottom: 10px; margin-bottom: 15px;';
        matchedSection.appendChild(matchedTitle);
        
        const matchedList = document.createElement('div');
        matchedList.className = 'matched-list';
        matchedList.id = 'websiteVaptMatchedVulnList';
        matchedList.style.cssText = 'margin-bottom: 30px;';
        
        websiteVaptVulnerabilityMergeState.matchedGroups.forEach((group, groupIndex) => {
            const groupDiv = document.createElement('div');
            groupDiv.className = 'matched-group';
            groupDiv.style.cssText = 'margin-bottom: 15px; padding: 15px; background-color: #f8f9fa; border-radius: 8px; border: 1px solid #dee2e6;';
            
            const groupHeader = document.createElement('div');
            groupHeader.style.cssText = 'display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;';
            
            const groupInfo = document.createElement('div');
            groupInfo.style.flex = '1';
            
            const groupName = document.createElement('strong');
            groupName.textContent = group.group_name;
            groupName.style.cssText = 'font-size: 16px; color: #2c3e50;';
            groupInfo.appendChild(groupName);
            
            const riskBadge = document.createElement('span');
            riskBadge.textContent = group.risk_factor || '';
            riskBadge.style.cssText = 'margin-left: 10px; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold;';
            
            const riskLower = (group.risk_factor || '').toLowerCase();
            if (riskLower === 'critical') {
                riskBadge.style.cssText += 'background-color: #8b0000; color: white;';
            } else if (riskLower === 'high') {
                riskBadge.style.cssText += 'background-color: #dc3545; color: white;';
            } else if (riskLower === 'medium') {
                riskBadge.style.cssText += 'background-color: #ffc107; color: black;';
            } else if (riskLower === 'low') {
                riskBadge.style.cssText += 'background-color: #28a745; color: white;';
            }
            groupInfo.appendChild(riskBadge);
            
            if (group.is_manual) {
                const manualBadge = document.createElement('span');
                manualBadge.textContent = 'Manual';
                manualBadge.style.cssText = 'margin-left: 10px; padding: 4px 8px; background: #3498db; color: white; border-radius: 4px; font-size: 12px;';
                groupInfo.appendChild(manualBadge);
            }
            
            const mergeButton = document.createElement('button');
            mergeButton.textContent = ' Merge';
            mergeButton.style.cssText = 'padding: 6px 12px; background-color: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 13px;';
            mergeButton.onclick = function() {
                showWebsiteMergeMatchedGroupsDialog(group.catalog_id);
            };
            
            groupHeader.appendChild(groupInfo);
            groupHeader.appendChild(mergeButton);
            groupDiv.appendChild(groupHeader);
            
            const vulnList = document.createElement('ul');
            vulnList.style.cssText = 'margin-top: 10px; margin-left: 20px; font-size: 14px; color: #555;';
            
            group.matched_vulnerabilities.forEach(vuln => {
                const vulnItem = document.createElement('li');
                vulnItem.textContent = vuln;
                vulnItem.style.marginBottom = '5px';
                vulnList.appendChild(vulnItem);
            });
            
            groupDiv.appendChild(vulnList);
            matchedList.appendChild(groupDiv);
        });
        
        matchedSection.appendChild(matchedList);
        container.appendChild(matchedSection);
        
        // Unmatched Vulnerabilities Section
        if (websiteVaptVulnerabilityMergeState.unmatchedVulnerabilities.length > 0) {
            const unmatchedSection = document.createElement('div');
            unmatchedSection.innerHTML = `<h3 style="color: #e74c3c; margin-bottom: 15px;"><i class="fas fa-exclamation-triangle"></i> Unmatched Vulnerabilities (${websiteVaptVulnerabilityMergeState.unmatchedVulnerabilities.length})</h3>`;
            
            const unmatchedList = document.createElement('div');
            
            websiteVaptVulnerabilityMergeState.unmatchedVulnerabilities.forEach(vuln => {
                const vulnDiv = document.createElement('div');
                vulnDiv.style.cssText = 'background: #ffebee; padding: 15px; margin-bottom: 10px; border-radius: 5px; border-left: 4px solid #e74c3c; display: flex; justify-content: space-between; align-items: center;';
                
                const vulnName = document.createElement('span');
                vulnName.textContent = vuln;
                vulnName.style.cssText = 'color: #2c3e50; flex: 1;';
                
                const actionsDiv = document.createElement('div');
                actionsDiv.style.cssText = 'display: flex; gap: 10px;';
                
                // Merge with Matched button
                const mergeMatchedBtn = document.createElement('button');
                mergeMatchedBtn.type = 'button';
                mergeMatchedBtn.className = 'submit-btn';
                mergeMatchedBtn.textContent = 'Merge with Matched';
                mergeMatchedBtn.style.cssText = 'background-color: #3498db; padding: 5px 10px; font-size: 0.85em;';
                mergeMatchedBtn.onclick = () => showWebsiteMergeWithMatchedDialog(vuln);
                
                // Merge with Unmatched button
                const mergeUnmatchedBtn = document.createElement('button');
                mergeUnmatchedBtn.type = 'button';
                mergeUnmatchedBtn.className = 'submit-btn';
                mergeUnmatchedBtn.textContent = 'Merge with Unmatched';
                mergeUnmatchedBtn.style.cssText = 'background-color: #9b59b6; padding: 5px 10px; font-size: 0.85em;';
                mergeUnmatchedBtn.onclick = () => showWebsiteMergeWithUnmatchedDialog(vuln);
                
                // Add Details button
                const addDetailsBtn = document.createElement('button');
                addDetailsBtn.type = 'button';
                addDetailsBtn.className = 'submit-btn';
                addDetailsBtn.textContent = 'Add Details';
                addDetailsBtn.style.cssText = 'background-color: #e67e22; padding: 5px 10px; font-size: 0.85em;';
                addDetailsBtn.onclick = () => showWebsiteAddDetailsDialog(vuln);
                
                actionsDiv.appendChild(mergeMatchedBtn);
                actionsDiv.appendChild(mergeUnmatchedBtn);
                actionsDiv.appendChild(addDetailsBtn);
                
                vulnDiv.appendChild(vulnName);
                vulnDiv.appendChild(actionsDiv);
                unmatchedList.appendChild(vulnDiv);
            });
            
            unmatchedSection.appendChild(unmatchedList);
            container.appendChild(unmatchedSection);
        } else {
            const allMatchedMsg = document.createElement('div');
            allMatchedMsg.style.cssText = 'background: #d4edda; color: #155724; padding: 20px; border-radius: 5px; text-align: center; font-size: 1.1em;';
            allMatchedMsg.innerHTML = '<i class="fas fa-check-circle"></i> All vulnerabilities are matched! You can proceed to generate the report.';
            container.appendChild(allMatchedMsg);
            
            // Enable proceed button
            const proceedBtn = document.querySelector('.proceed-btn');
            if (proceedBtn) {
                proceedBtn.disabled = false;
                proceedBtn.style.opacity = '1';
                proceedBtn.style.cursor = 'pointer';
            }
        }
    }

    // Show "Add Vulnerability Manual" Dialog - NEW FEATURE
    function showWebsiteAddManualVulnerabilityDialog() {
        const dialogOverlay = document.createElement('div');
        dialogOverlay.className = 'sub-dialog-overlay';
        dialogOverlay.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: flex; justify-content: center; align-items: center; z-index: 10001;';
        
        const dialogBox = document.createElement('div');
        dialogBox.style.cssText = 'background: white; padding: 30px; border-radius: 8px; max-width: 800px; width: 90%; max-height: 90vh; overflow-y: auto;';
        
        dialogBox.innerHTML = `
            <h3 style="margin-top: 0; color: #27ae60;"><i class="fas fa-plus-circle"></i> Add Vulnerability Manually</h3>
            <p style="color: #666; margin-bottom: 20px;">Enter complete details for the new vulnerability. This will be added to the catalog and appear in the matched vulnerabilities list.</p>
            <form id="websiteManualVulnForm">
                <div class="form-group">
                    <label>Vulnerability Name*</label>
                    <input type="text" id="websiteManualVulnName" class="form-input" required>
                </div>
                <div class="form-group">
                    <label>Risk Factor*</label>
                    <select id="websiteManualRiskFactor" class="form-input" required>
                        <option value="">Select Risk</option>
                        <option value="Critical">Critical</option>
                        <option value="High">High</option>
                        <option value="Medium">Medium</option>
                        <option value="Low">Low</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>CVE/CWE ID*</label>
                    <input type="text" id="websiteManualCveId" class="form-input" required>
                </div>
                <div class="form-group">
                    <label>CVSS Score*</label>
                    <input type="text" id="websiteManualCvssScore" class="form-input" required>
                </div>
                <div class="form-group">
                    <label>Audit Observation*</label>
                    <textarea id="websiteManualObservation" class="form-input" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label>Impact*</label>
                    <textarea id="websiteManualImpact" class="form-input" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label>Recommendation*</label>
                    <textarea id="websiteManualRecommendation" class="form-input" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label>Reference Link*</label>
                    <textarea id="websiteManualReferenceLink" class="form-input" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label>Affected URL</label>
                    <textarea id="websiteManualAffectedSystems" class="form-input" rows="2" placeholder="Enter affected systems (one per line or comma-separated)" required></textarea>
                    <small style="color: #666;">This will be added to the Infra_VAPT worksheet only, not to the catalog.</small>
                </div>
                <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                    <button type="button" class="cancel-btn" onclick="this.closest('.sub-dialog-overlay').remove()">Cancel</button>
                    <button type="submit" class="submit-btn" style="background-color: #27ae60;">Add Vulnerability</button>
                </div>
            </form>
        `;
        
        // Handle form submission
        dialogBox.querySelector('#websiteManualVulnForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const vulnerabilityDetails = {
                vulnerabilityName: document.getElementById('websiteManualVulnName').value,
                riskFactor: document.getElementById('websiteManualRiskFactor').value,
                cveId: document.getElementById('websiteManualCveId').value,
                cvssScore: document.getElementById('websiteManualCvssScore').value,
                auditObservation: document.getElementById('websiteManualObservation').value,
                impact: document.getElementById('websiteManualImpact').value,
                recommendation: document.getElementById('websiteManualRecommendation').value,
                referenceLink: document.getElementById('websiteManualReferenceLink').value,
                affectedSystems: document.getElementById('websiteManualAffectedSystems').value
            };
            
            // Submit to backend
            fetch('/add_website_manual_vulnerability', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({vulnerability_details: vulnerabilityDetails})
            })
            .then(response => response.json())
            .then(data => {
                if (data.success && (data.updated_state || data.new_vulnerability)) {
                    // Prefer non-destructive merge to avoid dropping earlier items
                    const current = websiteVaptVulnerabilityMergeState.matchedGroups || [];
                    const updated = (data.updated_state && data.updated_state.matched_groups) || [];

                    if (updated.length >= current.length) {
                        // Server returned a full state that is not smaller  accept it
                        websiteVaptVulnerabilityMergeState.matchedGroups = updated;
                    } else if (data.new_vulnerability) {
                        // Construct a minimal group from the new_vulnerability payload and append
                        const nv = data.new_vulnerability;
                        const newGroup = {
                            catalog_id: nv.group_id,
                            group_name: nv.group_name,
                            risk_factor: nv.risk_factor,
                            matched_vulnerabilities: [nv.group_name],
                            is_new_group: true,
                            is_manual: true
                        };
                        // Avoid duplicates by catalog_id
                        const exists = current.some(g => g.catalog_id === newGroup.catalog_id);
                        if (!exists) current.push(newGroup);
                        websiteVaptVulnerabilityMergeState.matchedGroups = current;
                    }

                    // Always update unmatched list when provided
                    if (data.updated_state && Array.isArray(data.updated_state.unmatched_vulnerabilities)) {
                    websiteVaptVulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities;
                    }
                    
                    // Refresh UI
                    const container = document.getElementById('websiteVaptVulnManagementContainer');
                    renderWebsiteVaptVulnerabilityUI(container);
                    
                    // Close dialog
                    document.body.removeChild(dialogOverlay);
                    
                    alert('Vulnerability added successfully!');
                } else {
                    alert('Error: ' + (data.error || 'Unknown error'));
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error adding vulnerability: ' + error.message);
            });
        });
        
        dialogOverlay.appendChild(dialogBox);
        document.body.appendChild(dialogOverlay);
    }

    // Refresh Website VAPT UI after merge operations
    function refreshWebsiteVaptVulnerabilityUI() {
        const container = document.getElementById('websiteVaptVulnManagementContainer');
        if (!container) {
            console.error('Container not found for refresh');
            return;
        }
        renderWebsiteVaptVulnerabilityUI(container);
        
        // Update count info in header
        const countInfo = document.getElementById('websiteVaptVulnCountInfo');
        if (countInfo) {
            countInfo.textContent = `Matched: ${websiteVaptVulnerabilityMergeState.matchedGroups.length} | Unmatched: ${websiteVaptVulnerabilityMergeState.unmatchedVulnerabilities.length}`;
        }
        
        // Update proceed button state
        const proceedBtn = document.querySelector('.proceed-btn');
        if (proceedBtn) {
            if (websiteVaptVulnerabilityMergeState.unmatchedVulnerabilities.length > 0) {
                proceedBtn.disabled = true;
                proceedBtn.style.opacity = '0.5';
                proceedBtn.style.cursor = 'not-allowed';
            } else {
                proceedBtn.disabled = false;
                proceedBtn.style.opacity = '1';
                proceedBtn.style.cursor = 'pointer';
            }
        }
    }
    
    // Function to show merge matched groups dialog
    function showWebsiteMergeMatchedGroupsDialog(sourceGroupId) {
        const dialog = document.createElement('div');
        dialog.className = 'vuln-confirmation-dialog';
        dialog.style.zIndex = '10001';
        
        const dialogContent = document.createElement('div');
        dialogContent.className = 'dialog-content';
        dialogContent.style.maxWidth = '600px';
        
        const sourceGroup = websiteVaptVulnerabilityMergeState.matchedGroups.find(g => g.catalog_id === sourceGroupId);
        if (!sourceGroup) {
            alert('Source group not found');
            return;
        }
        
        const title = document.createElement('h3');
        title.textContent = 'Merge Matched Groups';
        title.style.marginBottom = '15px';
        dialogContent.appendChild(title);
        
        const instruction = document.createElement('p');
        instruction.innerHTML = `<strong>Merge FROM:</strong> ${sourceGroup.group_name}<br><br>Select target group to merge INTO:`;
        instruction.style.marginBottom = '20px';
        instruction.style.fontSize = '14px';
        dialogContent.appendChild(instruction);
        
        const form = document.createElement('div');
        
        websiteVaptVulnerabilityMergeState.matchedGroups.forEach((group, idx) => {
            if (group.catalog_id === sourceGroupId) return;
            
            const radioDiv = document.createElement('div');
            radioDiv.style.marginBottom = '12px';
            radioDiv.style.padding = '10px';
            radioDiv.style.backgroundColor = '#f8f9fa';
            radioDiv.style.borderRadius = '4px';
            
            const radio = document.createElement('input');
            radio.type = 'radio';
            radio.name = 'website_target_group';
            radio.value = group.catalog_id;
            radio.id = `website_target_group_${idx}`;
            
            const label = document.createElement('label');
            label.setAttribute('for', `website_target_group_${idx}`);
            label.style.marginLeft = '8px';
            label.style.cursor = 'pointer';
            label.textContent = group.group_name;
            
            radioDiv.appendChild(radio);
            radioDiv.appendChild(label);
            form.appendChild(radioDiv);
        });
        
        if (form.children.length === 0) {
            const noGroupsMsg = document.createElement('p');
            noGroupsMsg.textContent = 'No other matched groups available to merge with.';
            noGroupsMsg.style.color = '#666';
            dialogContent.appendChild(noGroupsMsg);
        } else {
            dialogContent.appendChild(form);
        }
        
        const buttonContainer = document.createElement('div');
        buttonContainer.style.marginTop = '20px';
        buttonContainer.style.display = 'flex';
        buttonContainer.style.gap = '10px';
        
        const mergeBtn = document.createElement('button');
        mergeBtn.textContent = 'Merge';
        mergeBtn.className = 'proceed-btn';
        mergeBtn.onclick = function() {
            const selectedRadio = document.querySelector('input[name="website_target_group"]:checked');
            if (!selectedRadio) {
                alert('Please select a target group');
                return;
            }
            
            const targetGroupId = parseInt(selectedRadio.value);
            
            fetch('/merge_website_vapt_matched_groups', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    source_group_id: sourceGroupId,
                    target_group_id: targetGroupId
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    websiteVaptVulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups || [];
                    websiteVaptVulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities || [];
                    dialog.remove();
                    refreshWebsiteVaptVulnerabilityUI();
                    alert('Groups merged successfully!');
                } else {
                    alert('Error: ' + (data.error || 'Failed to merge groups'));
                }
            })
            .catch(error => {
                console.error('Error merging groups:', error);
                alert('Error merging groups: ' + error.message);
            });
        };
        
        const cancelBtn = document.createElement('button');
        cancelBtn.textContent = 'Cancel';
        cancelBtn.className = 'cancel-btn';
        cancelBtn.onclick = () => dialog.remove();
        
        buttonContainer.appendChild(mergeBtn);
        buttonContainer.appendChild(cancelBtn);
        dialogContent.appendChild(buttonContainer);
        
        dialog.appendChild(dialogContent);
        document.body.appendChild(dialog);
    }
    
    // Function to undo last merge operation
    function undoWebsiteVaptLastMergeOperation() {
        if (!confirm('Are you sure you want to undo the last operation?')) {
            return;
        }
        
        fetch('/website_vapt_undo_last_merge', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'}
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            console.log('Undo response:', data);
            if (data.success && data.updated_state) {
                // Update the global state with the response
                websiteVaptVulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups || [];
                websiteVaptVulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities || [];
                
                console.log('Updated state - Matched:', websiteVaptVulnerabilityMergeState.matchedGroups.length, 'Unmatched:', websiteVaptVulnerabilityMergeState.unmatchedVulnerabilities.length);
                
                // Refresh the main UI
                refreshWebsiteVaptVulnerabilityUI();
                
                alert('Operation undone successfully!');
            } else {
                alert('Error: ' + (data.error || 'No operations to undo'));
            }
        })
        .catch(error => {
            console.error('Error undoing operation:', error);
            alert('Error undoing operation: ' + error.message);
        });
    }

    // Dialog 1: Merge with Matched - Select matched group
    function showWebsiteMergeWithMatchedDialog(unmatchedVuln) {
        const dialog = document.createElement('div');
        dialog.className = 'vuln-confirmation-dialog';
        dialog.style.zIndex = '10001';
        
        const dialogContent = document.createElement('div');
        dialogContent.className = 'dialog-content';
        dialogContent.style.maxWidth = '600px';
        
        const title = document.createElement('h3');
        title.textContent = 'Merge with Matched Group';
        title.style.marginBottom = '15px';
        dialogContent.appendChild(title);
        
        const instruction = document.createElement('p');
        instruction.textContent = `Select a matched group to merge "${unmatchedVuln}" into:`;
        instruction.style.marginBottom = '20px';
        instruction.style.fontSize = '14px';
        dialogContent.appendChild(instruction);
        
        const form = document.createElement('div');
        
        websiteVaptVulnerabilityMergeState.matchedGroups.forEach((group, idx) => {
            const radioDiv = document.createElement('div');
            radioDiv.style.marginBottom = '12px';
            radioDiv.style.padding = '10px';
            radioDiv.style.backgroundColor = '#f8f9fa';
            radioDiv.style.borderRadius = '4px';
            
            const radio = document.createElement('input');
            radio.type = 'radio';
            radio.name = 'website_target_matched_group';
            radio.value = group.catalog_id;
            radio.id = `website_matched_group_${idx}`;
            
            const label = document.createElement('label');
            label.setAttribute('for', `website_matched_group_${idx}`);
            label.style.marginLeft = '8px';
            label.style.cursor = 'pointer';
            label.textContent = group.group_name;
            
            radioDiv.appendChild(radio);
            radioDiv.appendChild(label);
            form.appendChild(radioDiv);
        });
        
        dialogContent.appendChild(form);
        
        const buttonContainer = document.createElement('div');
        buttonContainer.className = 'button-container';
        buttonContainer.style.marginTop = '20px';
        
        const confirmBtn = document.createElement('button');
        confirmBtn.textContent = 'Confirm Merge';
        confirmBtn.className = 'proceed-btn';
        confirmBtn.onclick = function() {
            const selectedRadio = document.querySelector('input[name="website_target_matched_group"]:checked');
            if (!selectedRadio) {
                alert('Please select a group to merge with');
                return;
            }
            
            confirmBtn.disabled = true;
            confirmBtn.textContent = 'Merging...';
            
            fetch('/merge_website_vapt_with_matched', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    unmatched_vulnerability: unmatchedVuln,
                    target_group_id: parseInt(selectedRadio.value)
                })
            })
            .then(response => {
                if (!response.ok) {
                    return response.text().then(text => {
                        throw new Error(`HTTP ${response.status}: ${text}`);
                    });
                }
                return response.json();
            })
            .then(data => {
                if (data.success && data.updated_state) {
                    websiteVaptVulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups || [];
                    websiteVaptVulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities || [];
                    
                    dialog.remove();
                    refreshWebsiteVaptVulnerabilityUI();
                    
                    alert('Vulnerability merged successfully!');
                } else {
                    alert('Error: ' + (data.error || 'Unknown error'));
                    confirmBtn.disabled = false;
                    confirmBtn.textContent = 'Confirm Merge';
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error merging: ' + error.message);
                confirmBtn.disabled = false;
                confirmBtn.textContent = 'Confirm Merge';
            });
        };
        
        const cancelBtn = document.createElement('button');
        cancelBtn.textContent = 'Cancel';
        cancelBtn.className = 'cancel-btn';
        cancelBtn.onclick = () => dialog.remove();
        
        buttonContainer.appendChild(confirmBtn);
        buttonContainer.appendChild(cancelBtn);
        dialogContent.appendChild(buttonContainer);
        
        dialog.appendChild(dialogContent);
        document.body.appendChild(dialog);
    }

    // Dialog 2: Merge with Unmatched - Select other unmatched + provide details
    function showWebsiteMergeWithUnmatchedDialog(primaryVuln) {
        const dialog = document.createElement('div');
        dialog.className = 'vuln-confirmation-dialog';
        dialog.style.zIndex = '10001';
        
        const dialogContent = document.createElement('div');
        dialogContent.className = 'dialog-content';
        dialogContent.style.maxWidth = '800px';
        dialogContent.style.maxHeight = '80vh';
        dialogContent.style.overflow = 'auto';
        
        const title = document.createElement('h3');
        title.textContent = 'Merge with Other Unmatched Vulnerabilities';
        title.style.marginBottom = '15px';
        dialogContent.appendChild(title);
        
        const instruction = document.createElement('p');
        instruction.innerHTML = `<strong>Primary:</strong> ${primaryVuln}<br><br>Select other unmatched vulnerabilities to merge with:`;
        instruction.style.marginBottom = '20px';
        instruction.style.fontSize = '14px';
        dialogContent.appendChild(instruction);
        
        const checkboxContainer = document.createElement('div');
        checkboxContainer.style.marginBottom = '20px';
        checkboxContainer.style.maxHeight = '200px';
        checkboxContainer.style.overflow = 'auto';
        checkboxContainer.style.border = '1px solid #ddd';
        checkboxContainer.style.padding = '10px';
        checkboxContainer.style.borderRadius = '4px';
        
        websiteVaptVulnerabilityMergeState.unmatchedVulnerabilities.forEach((vuln, idx) => {
            if (vuln === primaryVuln) return;
            
            const checkDiv = document.createElement('div');
            checkDiv.style.marginBottom = '8px';
            
            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkbox.value = vuln;
            checkbox.id = `website_unmatched_vuln_${idx}`;
            checkbox.className = 'website-merge-unmatched-checkbox';
            
            const label = document.createElement('label');
            label.setAttribute('for', `website_unmatched_vuln_${idx}`);
            label.style.marginLeft = '8px';
            label.style.cursor = 'pointer';
            label.textContent = vuln;
            
            checkDiv.appendChild(checkbox);
            checkDiv.appendChild(label);
            checkboxContainer.appendChild(checkDiv);
        });
        
        dialogContent.appendChild(checkboxContainer);
        
        const nextBtn = document.createElement('button');
        nextBtn.textContent = 'Next: Provide Group Details';
        nextBtn.className = 'proceed-btn';
        nextBtn.style.width = '100%';
        nextBtn.style.marginBottom = '10px';
        nextBtn.onclick = function() {
            const checkboxes = document.querySelectorAll('.website-merge-unmatched-checkbox:checked');
            const selectedVulns = [primaryVuln, ...Array.from(checkboxes).map(cb => cb.value)];
            
            if (selectedVulns.length < 1) {
                alert('No vulnerabilities selected');
                return;
            }
            
            dialog.remove();
            showWebsiteVulnerabilityDetailsForm(selectedVulns, 'merge_with_unmatched');
        };
        
        const cancelBtn = document.createElement('button');
        cancelBtn.textContent = 'Cancel';
        cancelBtn.className = 'cancel-btn';
        cancelBtn.style.width = '100%';
        cancelBtn.onclick = () => dialog.remove();
        
        dialogContent.appendChild(nextBtn);
        dialogContent.appendChild(cancelBtn);
        
        dialog.appendChild(dialogContent);
        document.body.appendChild(dialog);
    }

    // Dialog 3: Add Details - Form for single vulnerability
    function showWebsiteAddDetailsDialog(vuln) {
        showWebsiteVulnerabilityDetailsForm([vuln], 'add_details');
    }

    // Comprehensive vulnerability details form for Website VAPT
    function showWebsiteVulnerabilityDetailsForm(vulnerabilities, actionType) {
        const dialog = document.createElement('div');
        dialog.className = 'vuln-confirmation-dialog';
        dialog.style.zIndex = '10002';
        
        const dialogContent = document.createElement('div');
        dialogContent.className = 'dialog-content';
        dialogContent.style.maxWidth = '900px';
        dialogContent.style.maxHeight = '85vh';
        dialogContent.style.overflow = 'auto';
        
        const title = document.createElement('h3');
        title.textContent = actionType === 'add_details' ? 'Add Vulnerability Details' : 'Provide Group Details for Merged Vulnerabilities';
        title.style.marginBottom = '15px';
        dialogContent.appendChild(title);
        
        if (vulnerabilities.length > 1) {
            const vulnList = document.createElement('div');
            vulnList.style.marginBottom = '20px';
            vulnList.style.padding = '10px';
            vulnList.style.backgroundColor = '#f8f9fa';
            vulnList.style.borderRadius = '4px';
            
            const listTitle = document.createElement('strong');
            listTitle.textContent = 'Vulnerabilities in this group:';
            listTitle.style.display = 'block';
            listTitle.style.marginBottom = '8px';
            vulnList.appendChild(listTitle);
            
            const ul = document.createElement('ul');
            ul.style.marginLeft = '20px';
            vulnerabilities.forEach(v => {
                const li = document.createElement('li');
                li.textContent = v;
                li.style.marginBottom = '4px';
                ul.appendChild(li);
            });
            vulnList.appendChild(ul);
            dialogContent.appendChild(vulnList);
        }
        
        const formContainer = document.createElement('div');
        formContainer.style.marginBottom = '20px';
        
        const fields = [
            { name: 'vulnerabilityName', label: 'Vulnerability Group Name', type: 'text', placeholder: 'e.g., SQL Injection Vulnerabilities', required: true },
            { name: 'riskFactor', label: 'Risk Factor', type: 'select', options: ['', 'Low', 'Medium', 'High', 'Critical'], required: true },
            { name: 'cveId', label: 'CVE ID', type: 'text', placeholder: 'e.g., CVE-2023-1234 or Multiple', required: false },
            { name: 'cvssScore', label: 'CVSS Score', type: 'text', placeholder: 'e.g., 7.5', required: false },
            { name: 'auditObservation', label: 'Audit Observation', type: 'textarea', required: true },
            { name: 'impact', label: 'Impact', type: 'textarea', required: true },
            { name: 'recommendation', label: 'Recommendation', type: 'textarea', required: true },
            { name: 'referenceLink', label: 'Reference Link', type: 'textarea', placeholder: 'Enter reference links (one per line)', required: false }
        ];
        
        fields.forEach(field => {
            const fieldDiv = document.createElement('div');
            fieldDiv.style.marginBottom = '15px';
            
            const label = document.createElement('label');
            label.textContent = field.label + (field.required ? ' *' : '');
            label.style.display = 'block';
            label.style.marginBottom = '5px';
            label.style.fontWeight = '500';
            label.style.fontSize = '14px';
            fieldDiv.appendChild(label);
            
            let input;
            if (field.type === 'select') {
                input = document.createElement('select');
                input.id = `website_${field.name}`;
                input.name = field.name;
                input.style.width = '100%';
                input.style.padding = '8px';
                input.style.borderRadius = '4px';
                input.style.border = '1px solid #ced4da';
                if (field.required) input.required = true;
                
                field.options.forEach(option => {
                    const optionElement = document.createElement('option');
                    optionElement.value = option;
                    optionElement.textContent = option || 'Select Risk Factor';
                    input.appendChild(optionElement);
                });
            } else if (field.type === 'textarea') {
                input = document.createElement('textarea');
                input.id = `website_${field.name}`;
                input.name = field.name;
                input.rows = 4;
                input.style.width = '100%';
                input.style.padding = '8px';
                input.style.borderRadius = '4px';
                input.style.border = '1px solid #ced4da';
                input.style.resize = 'vertical';
                if (field.placeholder) input.placeholder = field.placeholder;
                if (field.required) input.required = true;
            } else {
                input = document.createElement('input');
                input.type = field.type;
                input.id = `website_${field.name}`;
                input.name = field.name;
                input.style.width = '100%';
                input.style.padding = '8px';
                input.style.borderRadius = '4px';
                input.style.border = '1px solid #ced4da';
                if (field.placeholder) input.placeholder = field.placeholder;
                if (field.required) input.required = true;
            }
            
            fieldDiv.appendChild(input);
            formContainer.appendChild(fieldDiv);
        });
        
        dialogContent.appendChild(formContainer);
        
        const buttonContainer = document.createElement('div');
        buttonContainer.className = 'button-container';
        buttonContainer.style.marginTop = '20px';
        
        const submitBtn = document.createElement('button');
        submitBtn.textContent = 'Submit & Update Catalog';
        submitBtn.className = 'proceed-btn';
        submitBtn.onclick = function() {
            const vulnName = document.getElementById('website_vulnerabilityName').value.trim();
            const riskFactor = document.getElementById('website_riskFactor').value;
            const observation = document.getElementById('website_auditObservation').value.trim();
            const impact = document.getElementById('website_impact').value.trim();
            const recommendation = document.getElementById('website_recommendation').value.trim();
            
            if (!vulnName || !riskFactor || !observation || !impact || !recommendation) {
                alert('Please fill in all required fields (marked with *)');
                return;
            }
            
            submitBtn.disabled = true;
            submitBtn.textContent = 'Submitting...';
            
            const details = {
                vulnerabilityName: vulnName,
                riskFactor: riskFactor,
                cveId: document.getElementById('website_cveId').value.trim(),
                cvssScore: document.getElementById('website_cvssScore').value.trim(),
                auditObservation: observation,
                impact: impact,
                recommendation: recommendation,
                referenceLink: document.getElementById('website_referenceLink').value.trim()
            };
            
            const endpoint = actionType === 'add_details' ? '/add_website_vapt_vulnerability_details' : '/merge_website_vapt_with_unmatched';
            const payload = actionType === 'add_details' 
                ? { vulnerability_name: vulnerabilities[0], vulnerability_details: details }
                : { vulnerabilities: vulnerabilities, vulnerability_details: details };
            
            fetch(endpoint, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(payload)
            })
            .then(response => {
                if (!response.ok) {
                    return response.text().then(text => {
                        throw new Error(`HTTP ${response.status}: ${text}`);
                    });
                }
                return response.json();
            })
            .then(data => {
                if (data.success && data.updated_state) {
                    websiteVaptVulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups || [];
                    websiteVaptVulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities || [];
                    
                    dialog.remove();
                    refreshWebsiteVaptVulnerabilityUI();
                    
                    alert(actionType === 'add_details' ? 'Details added successfully!' : 'Vulnerabilities merged successfully!');
                } else {
                    alert('Error: ' + (data.error || 'Unknown error'));
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'Submit & Update Catalog';
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error submitting: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = 'Submit & Update Catalog';
            });
        };
        
        const cancelBtn = document.createElement('button');
        cancelBtn.textContent = 'Cancel';
        cancelBtn.className = 'cancel-btn';
        cancelBtn.onclick = () => dialog.remove();
        
        buttonContainer.appendChild(submitBtn);
        buttonContainer.appendChild(cancelBtn);
        dialogContent.appendChild(buttonContainer);
        
        dialog.appendChild(dialogContent);
        document.body.appendChild(dialog);
    }

    // Generate Website VAPT Report
    function generateWebsiteVaptReport(form) { 
        showVaptLoadingIndicator();
        
        const formData = new FormData(form);
        
        fetch('/process_website_vapt_first_audit_report', {
            method: 'POST',
            body: formData
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Report generation failed');
            }
            return response.blob();
        })
        .then(blob => {
            hideVaptLoadingIndicator();
            
            const url = window.URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'Website_VAPT_First_Audit_Report.xlsx';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            window.URL.revokeObjectURL(url);
            
            closeVaptModal('websiteVaptFirstAuditModal');
            location.reload();
        })
        .catch(error => {
            hideVaptLoadingIndicator();
            console.error('Error:', error);
            alert('Error generating report: ' + error.message);
        });
    }

    // ==============================================================================
    // Public IP VAPT First Audit Functions
    // ==============================================================================

    // Public IP VAPT Global state for vulnerability merging
    let publicIpVaptVulnerabilityMergeState = {
        matchedGroups: [],
        unmatchedVulnerabilities: [],
        isPublicIp: true  // Flag to differentiate
    };

    // Public IP VAPT Form Submission Handler
    document.getElementById('publicIpFirstAuditForm').addEventListener('submit', function(e) {
        e.preventDefault();
        
        // Validate team members
        const teamMembers = document.getElementById('publicIpAuditTeamContainer').querySelectorAll('.team-member');
        if (teamMembers.length < 1) {
            alert('At least one team member is required');
            return;
        }
        
        // Validate dates
        const startDate = new Date(document.getElementById('publicIpStartDate').value);
        const endDate = new Date(document.getElementById('publicIpEndDate').value);
        
        if (endDate < startDate) {
            alert('End date must be after start date');
            return;
        }
        
        // Check vulnerabilities first
        checkPublicIpVaptVulnerabilitiesBeforeReport(this);
    });

    function checkPublicIpVaptVulnerabilitiesBeforeReport(form) {
        const formData = new FormData(form);
        const submitBtn = form.querySelector('.submit-btn');
        const originalText = submitBtn.textContent;
        
        submitBtn.disabled = true;
        submitBtn.textContent = 'Checking Vulnerabilities...';
        
        fetch('/check_public_ip_vapt_vulnerabilities', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.error) {
                alert('Error: ' + data.error);
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
                return;
            }
            
            // Show vulnerability confirmation dialog
            showPublicIpVaptVulnerabilityConfirmationDialog(data, form);
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Error checking vulnerabilities: ' + error.message);
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
        });
    }

    function resetPublicIpVaptSubmitButtonState() {
        const submitBtn = document.querySelector('#publicIpFirstAuditForm .submit-btn');
        if (submitBtn) {
            submitBtn.disabled = false;
            submitBtn.textContent = 'Submit Report';
        }
    }

    function showPublicIpVaptVulnerabilityConfirmationDialog(vulnData, form) {
        // Update global state
        publicIpVaptVulnerabilityMergeState.matchedGroups = vulnData.matched_groups || [];
        publicIpVaptVulnerabilityMergeState.unmatchedVulnerabilities = vulnData.unmatched_vulnerabilities || [];
        
        // Create dialog overlay
        const dialogOverlay = document.createElement('div');
        dialogOverlay.id = 'publicIpVaptVulnerabilityDialog';
        dialogOverlay.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        `;
        
        const dialogContent = document.createElement('div');
        dialogContent.className = 'dialog-content';
        dialogContent.style.cssText = `
            background: white;
            padding: 30px;
            border-radius: 8px;
            max-width: 1400px;
            max-height: 90vh;
            overflow: auto;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        `;
        
        // Header with title and Add Vulnerability Manual button
        const headerSection = document.createElement('div');
        headerSection.style.cssText = 'display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid #2c3e50;';
        
        const headerTitle = document.createElement('h2');
        headerTitle.textContent = 'Public IP VAPT - Vulnerability Management';
        headerTitle.style.cssText = 'margin: 0; color: #2c3e50;';
        
        const headerLeft = document.createElement('div');
        headerLeft.style.cssText = 'display: flex; align-items: center; gap: 15px; flex: 1;';
        
        const undoButton = document.createElement('button');
        undoButton.textContent = ' Undo Last Operation';
        undoButton.className = 'undo-btn';
        undoButton.style.cssText = 'padding: 8px 16px; background-color: #f39c12; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 13px;';
        undoButton.onclick = undoPublicIpVaptLastMergeOperation;
        
        const refreshInfo = document.createElement('span');
        refreshInfo.textContent = `Matched: ${publicIpVaptVulnerabilityMergeState.matchedGroups.length} | Unmatched: ${publicIpVaptVulnerabilityMergeState.unmatchedVulnerabilities.length}`;
        refreshInfo.style.cssText = 'font-size: 14px; color: #666;';
        refreshInfo.id = 'publicIpVaptVulnCountInfo';
        
        headerLeft.appendChild(headerTitle);
        headerLeft.appendChild(undoButton);
        headerLeft.appendChild(refreshInfo);
        
        const addManualVulnBtn = document.createElement('button');
        addManualVulnBtn.type = 'button';
        addManualVulnBtn.className = 'submit-btn';
        addManualVulnBtn.style.cssText = 'background-color: #27ae60; padding: 10px 20px; font-size: 14px;';
        addManualVulnBtn.innerHTML = '<i class="fas fa-plus-circle"></i> Add Vulnerability Manual';
        addManualVulnBtn.onclick = () => showPublicIpAddManualVulnerabilityDialog();
        
        headerSection.appendChild(headerLeft);
        headerSection.appendChild(addManualVulnBtn);
        dialogContent.appendChild(headerSection);
        
        
        // Vulnerability management container
        const vulnContainer = document.createElement('div');
        vulnContainer.id = 'publicIpVaptVulnManagementContainer';
        vulnContainer.className = 'vulnerability-management-container';
        dialogContent.appendChild(vulnContainer);
        
        // Render initial UI
        renderPublicIpVaptVulnerabilityUI(vulnContainer);
        
        // Proceed and Cancel buttons
        const buttonContainer = document.createElement('div');
        buttonContainer.style.cssText = 'margin-top: 20px; display: flex; gap: 15px; justify-content: flex-end; padding-top: 20px; border-top: 2px solid #eee;';
        
        const cancelBtn = document.createElement('button');
        cancelBtn.type = 'button';
        cancelBtn.className = 'cancel-btn';
        cancelBtn.textContent = 'Cancel';
        cancelBtn.onclick = () => {
            document.body.removeChild(dialogOverlay);
            resetPublicIpVaptSubmitButtonState();
        };
        
        const proceedBtn = document.createElement('button');
        proceedBtn.type = 'button';
        proceedBtn.className = 'proceed-btn submit-btn';
        proceedBtn.textContent = 'Proceed to Generate Report';
        proceedBtn.style.cssText = 'background-color: #2c3e50; min-width: 200px;';
        proceedBtn.onclick = () => {
            if (publicIpVaptVulnerabilityMergeState.unmatchedVulnerabilities.length > 0) {
                alert('Please handle all unmatched vulnerabilities before proceeding');
                return;
            }
            
            document.body.removeChild(dialogOverlay);
            generatePublicIpVaptReport(form);
        };
        
        // Disable proceed button if there are unmatched vulnerabilities
        if (publicIpVaptVulnerabilityMergeState.unmatchedVulnerabilities.length > 0) {
            proceedBtn.disabled = true;
            proceedBtn.style.opacity = '0.5';
            proceedBtn.style.cursor = 'not-allowed';
        }
        
        buttonContainer.appendChild(cancelBtn);
        buttonContainer.appendChild(proceedBtn);
        dialogContent.appendChild(buttonContainer);
        
        dialogOverlay.appendChild(dialogContent);
        document.body.appendChild(dialogOverlay);
    }

    function renderPublicIpVaptVulnerabilityUI(container) {
        container.innerHTML = '';
        
        // Matched Groups Section
        const matchedSection = document.createElement('div');
        matchedSection.style.cssText = 'margin-bottom: 30px;';
        matchedSection.id = 'publicIpMatchedVulnSection';
        
        const matchedTitle = document.createElement('h3');
        matchedTitle.textContent = ' Matched Vulnerabilities';
        matchedTitle.style.cssText = 'color: #27ae60; border-bottom: 2px solid #27ae60; padding-bottom: 10px; margin-bottom: 15px;';
        matchedSection.appendChild(matchedTitle);
        
        const matchedList = document.createElement('div');
        matchedList.className = 'matched-list';
        matchedList.id = 'publicIpMatchedVulnList';
        matchedList.style.cssText = 'margin-bottom: 30px;';
        
        publicIpVaptVulnerabilityMergeState.matchedGroups.forEach((group, groupIndex) => {
            const groupDiv = document.createElement('div');
            groupDiv.className = 'matched-group';
            groupDiv.style.cssText = 'margin-bottom: 15px; padding: 15px; background-color: #f8f9fa; border-radius: 8px; border: 1px solid #dee2e6;';
            
            const groupHeader = document.createElement('div');
            groupHeader.style.cssText = 'display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;';
            
            const groupInfo = document.createElement('div');
            groupInfo.style.flex = '1';
            
            const groupName = document.createElement('strong');
            groupName.textContent = group.group_name;
            groupName.style.cssText = 'font-size: 16px; color: #2c3e50;';
            groupInfo.appendChild(groupName);
            
            const riskBadge = document.createElement('span');
            riskBadge.textContent = group.risk_factor || '';
            riskBadge.style.cssText = 'margin-left: 10px; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold;';
            
            const riskLower = (group.risk_factor || '').toLowerCase();
            if (riskLower === 'critical') {
                riskBadge.style.cssText += 'background-color: #8b0000; color: white;';
            } else if (riskLower === 'high') {
                riskBadge.style.cssText += 'background-color: #dc3545; color: white;';
            } else if (riskLower === 'medium') {
                riskBadge.style.cssText += 'background-color: #ffc107; color: black;';
            } else if (riskLower === 'low') {
                riskBadge.style.cssText += 'background-color: #28a745; color: white;';
            }
            groupInfo.appendChild(riskBadge);
            
            if (group.is_manual) {
                const manualBadge = document.createElement('span');
                manualBadge.textContent = 'Manual';
                manualBadge.style.cssText = 'margin-left: 10px; padding: 4px 8px; background: #3498db; color: white; border-radius: 4px; font-size: 12px;';
                groupInfo.appendChild(manualBadge);
            }
            
            const mergeButton = document.createElement('button');
            mergeButton.textContent = ' Merge';
            mergeButton.style.cssText = 'padding: 6px 12px; background-color: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 13px;';
            mergeButton.onclick = function() {
                showPublicIpMergeMatchedGroupsDialog(group.catalog_id);
            };
            
            groupHeader.appendChild(groupInfo);
            groupHeader.appendChild(mergeButton);
            groupDiv.appendChild(groupHeader);
            
            const vulnList = document.createElement('ul');
            vulnList.style.cssText = 'margin-top: 10px; margin-left: 20px; font-size: 14px; color: #555;';
            
            group.matched_vulnerabilities.forEach(vuln => {
                const vulnItem = document.createElement('li');
                vulnItem.textContent = vuln;
                vulnItem.style.marginBottom = '5px';
                vulnList.appendChild(vulnItem);
            });
            
            groupDiv.appendChild(vulnList);
            matchedList.appendChild(groupDiv);
        });
        
        matchedSection.appendChild(matchedList);
        container.appendChild(matchedSection);
        
        // Unmatched Vulnerabilities Section
        if (publicIpVaptVulnerabilityMergeState.unmatchedVulnerabilities.length > 0) {
            const unmatchedSection = document.createElement('div');
            unmatchedSection.innerHTML = `<h3 style="color: #e74c3c; margin-bottom: 15px;"><i class="fas fa-exclamation-triangle"></i> Unmatched Vulnerabilities (${publicIpVaptVulnerabilityMergeState.unmatchedVulnerabilities.length})</h3>`;
            
            const unmatchedList = document.createElement('div');
            unmatchedList.style.cssText = 'margin-bottom: 30px;';
            
            publicIpVaptVulnerabilityMergeState.unmatchedVulnerabilities.forEach(vuln => {
                const vulnDiv = document.createElement('div');
                vulnDiv.style.cssText = 'background: #ffebee; padding: 15px; margin-bottom: 10px; border-radius: 5px; border-left: 4px solid #e74c3c; display: flex; justify-content: space-between; align-items: center;';
                
                const vulnName = document.createElement('span');
                vulnName.textContent = vuln;
                vulnName.style.cssText = 'color: #2c3e50; flex: 1;';
                
                const actionsDiv = document.createElement('div');
                actionsDiv.style.cssText = 'display: flex; gap: 10px;';
                
                // Merge with Matched button
                const mergeMatchedBtn = document.createElement('button');
                mergeMatchedBtn.type = 'button';
                mergeMatchedBtn.className = 'submit-btn';
                mergeMatchedBtn.textContent = 'Merge with Matched';
                mergeMatchedBtn.style.cssText = 'background-color: #3498db; padding: 5px 10px; font-size: 0.85em;';
                mergeMatchedBtn.onclick = () => showPublicIpMergeWithMatchedDialog(vuln);
                
                // Merge with Unmatched button
                const mergeUnmatchedBtn = document.createElement('button');
                mergeUnmatchedBtn.type = 'button';
                mergeUnmatchedBtn.className = 'submit-btn';
                mergeUnmatchedBtn.textContent = 'Merge with Unmatched';
                mergeUnmatchedBtn.style.cssText = 'background-color: #9b59b6; padding: 5px 10px; font-size: 0.85em;';
                mergeUnmatchedBtn.onclick = () => showPublicIpMergeWithUnmatchedDialog(vuln);
                
                // Add Details button
                const addDetailsBtn = document.createElement('button');
                addDetailsBtn.type = 'button';
                addDetailsBtn.className = 'submit-btn';
                addDetailsBtn.textContent = 'Add Details';
                addDetailsBtn.style.cssText = 'background-color: #e67e22; padding: 5px 10px; font-size: 0.85em;';
                addDetailsBtn.onclick = () => showPublicIpAddDetailsDialog(vuln);
                
                actionsDiv.appendChild(mergeMatchedBtn);
                actionsDiv.appendChild(mergeUnmatchedBtn);
                actionsDiv.appendChild(addDetailsBtn);
                
                vulnDiv.appendChild(vulnName);
                vulnDiv.appendChild(actionsDiv);
                unmatchedList.appendChild(vulnDiv);
            });
            
            unmatchedSection.appendChild(unmatchedList);
            container.appendChild(unmatchedSection);
        } else {
            const allMatchedMsg = document.createElement('div');
            allMatchedMsg.style.cssText = 'background: #d4edda; color: #155724; padding: 20px; border-radius: 5px; text-align: center; font-size: 1.1em;';
            allMatchedMsg.innerHTML = '<i class="fas fa-check-circle"></i> All vulnerabilities are matched! You can proceed to generate the report.';
            container.appendChild(allMatchedMsg);
            
            // Enable proceed button
            const proceedBtn = document.querySelector('.proceed-btn');
            if (proceedBtn) {
                proceedBtn.disabled = false;
                proceedBtn.style.opacity = '1';
                proceedBtn.style.cursor = 'pointer';
            }
        }
    }

    // Dialog 1: Merge with Matched - Select matched group
    function showPublicIpMergeWithMatchedDialog(unmatchedVuln) {
        const dialog = document.createElement('div');
        dialog.className = 'vuln-confirmation-dialog';
        dialog.style.zIndex = '10001';
        
        const dialogContent = document.createElement('div');
        dialogContent.className = 'dialog-content';
        dialogContent.style.maxWidth = '600px';
        
        const title = document.createElement('h3');
        title.textContent = 'Merge with Matched Group';
        title.style.marginBottom = '15px';
        dialogContent.appendChild(title);
        
        const instruction = document.createElement('p');
        instruction.textContent = `Select a matched group to merge "${unmatchedVuln}" into:`;
        instruction.style.marginBottom = '20px';
        instruction.style.fontSize = '14px';
        dialogContent.appendChild(instruction);
        
        const form = document.createElement('div');
        
        publicIpVaptVulnerabilityMergeState.matchedGroups.forEach((group, idx) => {
            const radioDiv = document.createElement('div');
            radioDiv.style.marginBottom = '12px';
            radioDiv.style.padding = '10px';
            radioDiv.style.backgroundColor = '#f8f9fa';
            radioDiv.style.borderRadius = '4px';
            
            const radio = document.createElement('input');
            radio.type = 'radio';
            radio.name = 'publicIp_target_matched_group';
            radio.value = group.catalog_id;
            radio.id = `publicIp_matched_group_${idx}`;
            
            const label = document.createElement('label');
            label.setAttribute('for', `publicIp_matched_group_${idx}`);
            label.style.marginLeft = '8px';
            label.style.cursor = 'pointer';
            label.textContent = group.group_name;
            
            radioDiv.appendChild(radio);
            radioDiv.appendChild(label);
            form.appendChild(radioDiv);
        });
        
        dialogContent.appendChild(form);
        
        const buttonContainer = document.createElement('div');
        buttonContainer.className = 'button-container';
        buttonContainer.style.marginTop = '20px';
        
        const confirmBtn = document.createElement('button');
        confirmBtn.textContent = 'Confirm Merge';
        confirmBtn.className = 'proceed-btn';
        confirmBtn.onclick = function() {
            const selectedRadio = document.querySelector('input[name="publicIp_target_matched_group"]:checked');
            if (!selectedRadio) {
                alert('Please select a group to merge with');
                return;
            }
            
            confirmBtn.disabled = true;
            confirmBtn.textContent = 'Merging...';
            
            fetch('/merge_public_ip_vapt_with_matched', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    unmatched_vulnerability: unmatchedVuln,
                    target_group_id: parseInt(selectedRadio.value)
                })
            })
            .then(response => {
                if (!response.ok) {
                    return response.text().then(text => {
                        throw new Error(`HTTP ${response.status}: ${text}`);
                    });
                }
                return response.json();
            })
            .then(data => {
                if (data.success && data.updated_state) {
                    // Update global state with backend response
                    publicIpVaptVulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups || [];
                    publicIpVaptVulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities || [];
                    
                    dialog.remove();
                    refreshPublicIpVaptVulnerabilityUI();
                    
                    alert('Vulnerability merged successfully!');
                } else {
                    alert('Error: ' + (data.error || 'Unknown error'));
                    confirmBtn.disabled = false;
                    confirmBtn.textContent = 'Confirm Merge';
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error merging: ' + error.message);
                confirmBtn.disabled = false;
                confirmBtn.textContent = 'Confirm Merge';
            });
        };
        
        const cancelBtn = document.createElement('button');
        cancelBtn.textContent = 'Cancel';
        cancelBtn.className = 'cancel-btn';
        cancelBtn.onclick = () => dialog.remove();
        
        buttonContainer.appendChild(confirmBtn);
        buttonContainer.appendChild(cancelBtn);
        dialogContent.appendChild(buttonContainer);
        
        dialog.appendChild(dialogContent);
        document.body.appendChild(dialog);
    }

    // Dialog 2: Merge with Unmatched
    function showPublicIpMergeWithUnmatchedDialog(primaryVuln) {
        const dialog = document.createElement('div');
        dialog.className = 'vuln-confirmation-dialog';
        dialog.style.zIndex = '10001';
        
        const dialogContent = document.createElement('div');
        dialogContent.className = 'dialog-content';
        dialogContent.style.maxWidth = '800px';
        dialogContent.style.maxHeight = '80vh';
        dialogContent.style.overflow = 'auto';
        
        const title = document.createElement('h3');
        title.textContent = 'Merge with Other Unmatched Vulnerabilities';
        title.style.marginBottom = '15px';
        dialogContent.appendChild(title);
        
        const instruction = document.createElement('p');
        instruction.innerHTML = `<strong>Primary:</strong> ${primaryVuln}<br><br>Select other unmatched vulnerabilities to merge with:`;
        instruction.style.marginBottom = '20px';
        instruction.style.fontSize = '14px';
        dialogContent.appendChild(instruction);
        
        const checkboxContainer = document.createElement('div');
        checkboxContainer.style.marginBottom = '20px';
        checkboxContainer.style.maxHeight = '200px';
        checkboxContainer.style.overflow = 'auto';
        checkboxContainer.style.border = '1px solid #ddd';
        checkboxContainer.style.padding = '10px';
        checkboxContainer.style.borderRadius = '4px';
        
        publicIpVaptVulnerabilityMergeState.unmatchedVulnerabilities.forEach((vuln, idx) => {
            if (vuln === primaryVuln) return;
            
            const checkDiv = document.createElement('div');
            checkDiv.style.marginBottom = '8px';
            
            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkbox.value = vuln;
            checkbox.id = `publicIp_unmatched_vuln_${idx}`;
            checkbox.className = 'publicIp-merge-unmatched-checkbox';
            
            const label = document.createElement('label');
            label.setAttribute('for', `publicIp_unmatched_vuln_${idx}`);
            label.style.marginLeft = '8px';
            label.style.cursor = 'pointer';
            label.textContent = vuln;
            
            checkDiv.appendChild(checkbox);
            checkDiv.appendChild(label);
            checkboxContainer.appendChild(checkDiv);
        });
        
        dialogContent.appendChild(checkboxContainer);
        
        const nextBtn = document.createElement('button');
        nextBtn.textContent = 'Next: Provide Group Details';
        nextBtn.className = 'proceed-btn';
        nextBtn.style.width = '100%';
        nextBtn.style.marginBottom = '10px';
        nextBtn.onclick = function() {
            const checkboxes = document.querySelectorAll('.publicIp-merge-unmatched-checkbox:checked');
            const selectedVulns = [primaryVuln, ...Array.from(checkboxes).map(cb => cb.value)];
            
            if (selectedVulns.length < 1) {
                alert('No vulnerabilities selected');
                return;
            }
            
            dialog.remove();
            showPublicIpVulnerabilityDetailsForm(selectedVulns, 'merge_with_unmatched');
        };
        
        const cancelBtn = document.createElement('button');
        cancelBtn.textContent = 'Cancel';
        cancelBtn.className = 'cancel-btn';
        cancelBtn.style.width = '100%';
        cancelBtn.onclick = () => dialog.remove();
        
        dialogContent.appendChild(nextBtn);
        dialogContent.appendChild(cancelBtn);
        dialog.appendChild(dialogContent);
        document.body.appendChild(dialog);
    }

    // Dialog 3: Add Details for single vulnerability
    function showPublicIpAddDetailsDialog(unmatchedVuln) {
        const selectedVulns = [unmatchedVuln];
        showPublicIpVulnerabilityDetailsForm(selectedVulns, 'add_details');
    }

    function showPublicIpVulnerabilityDetailsForm(vulnerabilities, action) {
        const dialog = document.createElement('div');
        dialog.className = 'vuln-confirmation-dialog';
        dialog.style.zIndex = '10001';
        
        const dialogContent = document.createElement('div');
        dialogContent.className = 'dialog-content';
        dialogContent.style.maxWidth = '800px';
        dialogContent.style.maxHeight = '90vh';
        dialogContent.style.overflow = 'auto';
        
        const title = document.createElement('h3');
        title.textContent = 'Provide Vulnerability Details';
        title.style.marginBottom = '15px';
        dialogContent.appendChild(title);
        
        const instruction = document.createElement('p');
        instruction.innerHTML = `<strong>Vulnerabilities:</strong> ${vulnerabilities.join(', ')}`;
        instruction.style.marginBottom = '20px';
        instruction.style.fontSize = '14px';
        dialogContent.appendChild(instruction);
        
        const form = document.createElement('form');
        form.id = 'publicIpVulnDetailsForm';
        
        const vulnNameDiv = document.createElement('div');
        vulnNameDiv.className = 'form-group';
        // Pre-fill with first vulnerability name or provide placeholder
        const defaultName = vulnerabilities && vulnerabilities.length > 0 ? vulnerabilities[0] : '';
        vulnNameDiv.innerHTML = `
            <label>Vulnerability Name*</label>
            <input type="text" id="publicIpVulnName" class="form-input" placeholder="Enter vulnerability name" value="${defaultName}" required>
        `;
        form.appendChild(vulnNameDiv);
        
        const riskFactorDiv = document.createElement('div');
        riskFactorDiv.className = 'form-group';
        riskFactorDiv.innerHTML = `
            <label>Risk Factor*</label>
            <select id="publicIpVulnRiskFactor" class="form-input" required>
                <option value="">Select Risk</option>
                <option value="Critical">Critical</option>
                <option value="High">High</option>
                <option value="Medium">Medium</option>
                <option value="Low">Low</option>
            </select>
        `;
        form.appendChild(riskFactorDiv);
        
        const cveDiv = document.createElement('div');
        cveDiv.className = 'form-group';
        cveDiv.innerHTML = `
            <label>CVE/CWE ID*</label>
            <input type="text" id="publicIpVulnCveId" class="form-input" required>
        `;
        form.appendChild(cveDiv);
        
        const cvssDiv = document.createElement('div');
        cvssDiv.className = 'form-group';
        cvssDiv.innerHTML = `
            <label>CVSS Score*</label>
            <input type="text" id="publicIpVulnCvssScore" class="form-input" required>
        `;
        form.appendChild(cvssDiv);
        
        const observationDiv = document.createElement('div');
        observationDiv.className = 'form-group';
        observationDiv.innerHTML = `
            <label>Audit Observation*</label>
            <textarea id="publicIpVulnObservation" class="form-input" rows="3" required></textarea>
        `;
        form.appendChild(observationDiv);
        
        const impactDiv = document.createElement('div');
        impactDiv.className = 'form-group';
        impactDiv.innerHTML = `
            <label>Impact*</label>
            <textarea id="publicIpVulnImpact" class="form-input" rows="3" required></textarea>
        `;
        form.appendChild(impactDiv);
        
        const recommendationDiv = document.createElement('div');
        recommendationDiv.className = 'form-group';
        recommendationDiv.innerHTML = `
            <label>Recommendation*</label>
            <textarea id="publicIpVulnRecommendation" class="form-input" rows="3" required></textarea>
        `;
        form.appendChild(recommendationDiv);
        
        const referenceDiv = document.createElement('div');
        referenceDiv.className = 'form-group';
        referenceDiv.innerHTML = `
            <label>Reference Link*</label>
            <textarea id="publicIpVulnReferenceLink" class="form-input" rows="3" placeholder="Enter reference links (one per line)" required></textarea>
        `;
        form.appendChild(referenceDiv);
        
        const buttonContainer = document.createElement('div');
        buttonContainer.className = 'button-container';
        buttonContainer.style.marginTop = '20px';
        buttonContainer.style.display = 'flex';
        buttonContainer.style.gap = '10px';
        
        const submitBtn = document.createElement('button');
        submitBtn.type = 'submit';
        submitBtn.textContent = 'Submit';
        submitBtn.className = 'proceed-btn';
        submitBtn.style.flex = '1';
        
        const cancelBtn = document.createElement('button');
        cancelBtn.type = 'button';
        cancelBtn.textContent = 'Cancel';
        cancelBtn.className = 'cancel-btn';
        cancelBtn.style.flex = '1';
        cancelBtn.onclick = () => dialog.remove();
        
        buttonContainer.appendChild(submitBtn);
        buttonContainer.appendChild(cancelBtn);
        form.appendChild(buttonContainer);
        
        form.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const details = {
                vulnerabilityName: document.getElementById('publicIpVulnName').value,
                riskFactor: document.getElementById('publicIpVulnRiskFactor').value,
                cveId: document.getElementById('publicIpVulnCveId').value,
                cvssScore: document.getElementById('publicIpVulnCvssScore').value,
                auditObservation: document.getElementById('publicIpVulnObservation').value,
                impact: document.getElementById('publicIpVulnImpact').value,
                recommendation: document.getElementById('publicIpVulnRecommendation').value,
                referenceLink: document.getElementById('publicIpVulnReferenceLink').value
            };
            
            let endpoint = '';
            let requestBody = {};
            
            if (action === 'merge_with_unmatched') {
                endpoint = '/merge_public_ip_vapt_with_unmatched';
                requestBody = {
                    vulnerabilities: vulnerabilities,
                    vulnerability_details: details
                };
            } else if (action === 'add_details') {
                endpoint = '/add_public_ip_vapt_vulnerability_details';
                requestBody = {
                    vulnerability_name: vulnerabilities[0],
                    vulnerability_details: details
                };
            }
            
            submitBtn.disabled = true;
            submitBtn.textContent = 'Submitting...';
            
            fetch(endpoint, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(requestBody)
            })
            .then(response => response.json())
            .then(data => {
                if (data.success && data.updated_state) {
                    // Update global state with backend response
                    publicIpVaptVulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups || [];
                    publicIpVaptVulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities || [];
                    
                    dialog.remove();
                    refreshPublicIpVaptVulnerabilityUI();
                    
                    alert('Vulnerability details added successfully!');
                } else {
                    alert('Error: ' + (data.error || 'Unknown error'));
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'Submit';
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = 'Submit';
            });
        });
        
        dialogContent.appendChild(form);
        dialog.appendChild(dialogContent);
        document.body.appendChild(dialog);
    }

    function refreshPublicIpVaptVulnerabilityUI() {
        const container = document.getElementById('publicIpVaptVulnManagementContainer');
        if (!container) {
            console.error('Container not found for refresh');
            return;
        }
        renderPublicIpVaptVulnerabilityUI(container);
        
        // Update count info in header
        const countInfo = document.getElementById('publicIpVaptVulnCountInfo');
        if (countInfo) {
            countInfo.textContent = `Matched: ${publicIpVaptVulnerabilityMergeState.matchedGroups.length} | Unmatched: ${publicIpVaptVulnerabilityMergeState.unmatchedVulnerabilities.length}`;
        }
        
        // Update proceed button state
        const proceedBtn = document.querySelector('.proceed-btn');
        if (proceedBtn) {
            if (publicIpVaptVulnerabilityMergeState.unmatchedVulnerabilities.length > 0) {
                proceedBtn.disabled = true;
                proceedBtn.style.opacity = '0.5';
                proceedBtn.style.cursor = 'not-allowed';
            } else {
                proceedBtn.disabled = false;
                proceedBtn.style.opacity = '1';
                proceedBtn.style.cursor = 'pointer';
            }
        }
    }
    
    // Function to show add manual vulnerability dialog
    function showPublicIpAddManualVulnerabilityDialog() {
        const dialogOverlay = document.createElement('div');
        dialogOverlay.className = 'sub-dialog-overlay';
        dialogOverlay.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: flex; justify-content: center; align-items: center; z-index: 10001;';
        
        const dialogBox = document.createElement('div');
        dialogBox.style.cssText = 'background: white; padding: 30px; border-radius: 8px; max-width: 800px; width: 90%; max-height: 90vh; overflow-y: auto;';
        
        dialogBox.innerHTML = `
            <h3 style="margin-top: 0; color: #27ae60;"><i class="fas fa-plus-circle"></i> Add Vulnerability Manually</h3>
            <p style="color: #666; margin-bottom: 20px;">Enter complete details for the new vulnerability. This will be added to the catalog and appear in the matched vulnerabilities list.</p>
            <form id="publicIpManualVulnForm">
                <div class="form-group">
                    <label>Vulnerability Name*</label>
                    <input type="text" id="publicIpManualVulnName" class="form-input" required>
                </div>
                <div class="form-group">
                    <label>Risk Factor*</label>
                    <select id="publicIpManualRiskFactor" class="form-input" required>
                        <option value="">Select Risk</option>
                        <option value="Critical">Critical</option>
                        <option value="High">High</option>
                        <option value="Medium">Medium</option>
                        <option value="Low">Low</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>CVE/CWE ID*</label>
                    <input type="text" id="publicIpManualCveId" class="form-input" required>
                </div>
                <div class="form-group">
                    <label>CVSS Score*</label>
                    <input type="text" id="publicIpManualCvssScore" class="form-input" required>
                </div>
                <div class="form-group">
                    <label>Audit Observation*</label>
                    <textarea id="publicIpManualObservation" class="form-input" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label>Impact*</label>
                    <textarea id="publicIpManualImpact" class="form-input" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label>Recommendation*</label>
                    <textarea id="publicIpManualRecommendation" class="form-input" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label>Reference Link*</label>
                    <textarea id="publicIpManualReferenceLink" class="form-input" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label>Affected IP</label>
                    <textarea id="publicIpManualAffectedSystems" class="form-input" rows="2" placeholder="Enter affected IP addresses (one per line or comma-separated)" required></textarea>
                    <small style="color: #666;">This will be added to the Public_IP_VAPT worksheet only, not to the catalog.</small>
                </div>
                <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                    <button type="button" class="cancel-btn" onclick="this.closest('.sub-dialog-overlay').remove()">Cancel</button>
                    <button type="submit" class="submit-btn" style="background-color: #27ae60;">Add Vulnerability</button>
                </div>
            </form>
        `;
        
        // Handle form submission
        dialogBox.querySelector('#publicIpManualVulnForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const vulnerabilityDetails = {
                vulnerabilityName: document.getElementById('publicIpManualVulnName').value,
                riskFactor: document.getElementById('publicIpManualRiskFactor').value,
                cveId: document.getElementById('publicIpManualCveId').value,
                cvssScore: document.getElementById('publicIpManualCvssScore').value,
                auditObservation: document.getElementById('publicIpManualObservation').value,
                impact: document.getElementById('publicIpManualImpact').value,
                recommendation: document.getElementById('publicIpManualRecommendation').value,
                referenceLink: document.getElementById('publicIpManualReferenceLink').value,
                affectedSystems: document.getElementById('publicIpManualAffectedSystems').value
            };
            
            // Submit to backend
            fetch('/add_public_ip_manual_vulnerability', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({vulnerability_details: vulnerabilityDetails})
            })
            .then(response => response.json())
            .then(data => {
                if (data.success && (data.updated_state || data.new_vulnerability)) {
                    // Prefer non-destructive merge to avoid dropping earlier items
                    const current = publicIpVaptVulnerabilityMergeState.matchedGroups || [];
                    const updated = (data.updated_state && data.updated_state.matched_groups) || [];

                    if (updated.length >= current.length) {
                        // Server returned a full state that is not smaller  accept it
                        publicIpVaptVulnerabilityMergeState.matchedGroups = updated;
                    } else if (data.new_vulnerability) {
                        // Construct a minimal group from the new_vulnerability payload and append
                        const nv = data.new_vulnerability;
                        const newGroup = {
                            catalog_id: nv.group_id,
                            group_name: nv.group_name,
                            risk_factor: nv.risk_factor,
                            matched_vulnerabilities: [nv.group_name],
                            is_new_group: true,
                            is_manual: true
                        };
                        // Avoid duplicates by catalog_id
                        const exists = current.some(g => g.catalog_id === newGroup.catalog_id);
                        if (!exists) current.push(newGroup);
                        publicIpVaptVulnerabilityMergeState.matchedGroups = current;
                    }

                    // Always update unmatched list when provided
                    if (data.updated_state && Array.isArray(data.updated_state.unmatched_vulnerabilities)) {
                        publicIpVaptVulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities;
                    }
                    
                    // Refresh UI
                    const container = document.getElementById('publicIpVaptVulnManagementContainer');
                    renderPublicIpVaptVulnerabilityUI(container);
                    
                    // Close dialog
                    document.body.removeChild(dialogOverlay);
                    
                    alert('Vulnerability added successfully!');
                } else {
                    alert('Error: ' + (data.error || 'Unknown error'));
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error adding vulnerability: ' + error.message);
            });
        });
        
        dialogOverlay.appendChild(dialogBox);
        document.body.appendChild(dialogOverlay);
    }
    
    // Function to show merge matched groups dialog
    function showPublicIpMergeMatchedGroupsDialog(sourceGroupId) {
        const dialog = document.createElement('div');
        dialog.className = 'vuln-confirmation-dialog';
        dialog.style.zIndex = '10001';
        
        const dialogContent = document.createElement('div');
        dialogContent.className = 'dialog-content';
        dialogContent.style.maxWidth = '600px';
        
        const sourceGroup = publicIpVaptVulnerabilityMergeState.matchedGroups.find(g => g.catalog_id === sourceGroupId);
        if (!sourceGroup) {
            alert('Source group not found');
            return;
        }
        
        const title = document.createElement('h3');
        title.textContent = 'Merge Matched Groups';
        title.style.marginBottom = '15px';
        dialogContent.appendChild(title);
        
        const instruction = document.createElement('p');
        instruction.innerHTML = `<strong>Merge FROM:</strong> ${sourceGroup.group_name}<br><br>Select target group to merge INTO:`;
        instruction.style.marginBottom = '20px';
        instruction.style.fontSize = '14px';
        dialogContent.appendChild(instruction);
        
        const form = document.createElement('div');
        
        publicIpVaptVulnerabilityMergeState.matchedGroups.forEach((group, idx) => {
            if (group.catalog_id === sourceGroupId) return;
            
            const radioDiv = document.createElement('div');
            radioDiv.style.marginBottom = '12px';
            radioDiv.style.padding = '10px';
            radioDiv.style.backgroundColor = '#f8f9fa';
            radioDiv.style.borderRadius = '4px';
            
            const radio = document.createElement('input');
            radio.type = 'radio';
            radio.name = 'publicIp_target_group';
            radio.value = group.catalog_id;
            radio.id = `publicIp_target_group_${idx}`;
            
            const label = document.createElement('label');
            label.setAttribute('for', `publicIp_target_group_${idx}`);
            label.style.marginLeft = '8px';
            label.style.cursor = 'pointer';
            label.textContent = group.group_name;
            
            radioDiv.appendChild(radio);
            radioDiv.appendChild(label);
            form.appendChild(radioDiv);
        });
        
        if (form.children.length === 0) {
            const noGroupsMsg = document.createElement('p');
            noGroupsMsg.textContent = 'No other matched groups available to merge with.';
            noGroupsMsg.style.color = '#666';
            dialogContent.appendChild(noGroupsMsg);
        } else {
            dialogContent.appendChild(form);
        }
        
        const buttonContainer = document.createElement('div');
        buttonContainer.style.marginTop = '20px';
        buttonContainer.style.display = 'flex';
        buttonContainer.style.gap = '10px';
        
        const mergeBtn = document.createElement('button');
        mergeBtn.textContent = 'Merge';
        mergeBtn.className = 'proceed-btn';
        mergeBtn.onclick = function() {
            const selectedRadio = document.querySelector('input[name="publicIp_target_group"]:checked');
            if (!selectedRadio) {
                alert('Please select a target group');
                return;
            }
            
            const targetGroupId = parseInt(selectedRadio.value);
            
            fetch('/merge_public_ip_vapt_matched_groups', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    source_group_id: sourceGroupId,
                    target_group_id: targetGroupId
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    publicIpVaptVulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups || [];
                    publicIpVaptVulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities || [];
                    dialog.remove();
                    refreshPublicIpVaptVulnerabilityUI();
                    alert('Groups merged successfully!');
                } else {
                    alert('Error: ' + (data.error || 'Failed to merge groups'));
                }
            })
            .catch(error => {
                console.error('Error merging groups:', error);
                alert('Error merging groups: ' + error.message);
            });
        };
        
        const cancelBtn = document.createElement('button');
        cancelBtn.textContent = 'Cancel';
        cancelBtn.className = 'cancel-btn';
        cancelBtn.onclick = () => dialog.remove();
        
        buttonContainer.appendChild(mergeBtn);
        buttonContainer.appendChild(cancelBtn);
        dialogContent.appendChild(buttonContainer);
        
        dialog.appendChild(dialogContent);
        document.body.appendChild(dialog);
    }
    
    // Function to undo last merge operation
    function undoPublicIpVaptLastMergeOperation() {
        if (!confirm('Are you sure you want to undo the last operation?')) {
            return;
        }
        
        fetch('/public_ip_vapt_undo_last_merge', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'}
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            console.log('Undo response:', data);
            if (data.success && data.updated_state) {
                // Update the global state with the response
                publicIpVaptVulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups || [];
                publicIpVaptVulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities || [];
                
                console.log('Updated state - Matched:', publicIpVaptVulnerabilityMergeState.matchedGroups.length, 'Unmatched:', publicIpVaptVulnerabilityMergeState.unmatchedVulnerabilities.length);
                
                // Refresh the main UI
                refreshPublicIpVaptVulnerabilityUI();
                
                alert('Operation undone successfully!');
            } else {
                alert('Error: ' + (data.error || 'No operations to undo'));
            }
        })
        .catch(error => {
            console.error('Error undoing operation:', error);
            alert('Error undoing operation: ' + error.message);
        });
    }

    function generatePublicIpVaptReport(form) {
        showVaptLoadingIndicator();
        
        const formData = new FormData(form);
        
        fetch('/process_public_ip_vapt_first_audit_report', {
            method: 'POST',
            body: formData
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Report generation failed');
            }
            return response.blob();
        })
        .then(blob => {
            hideVaptLoadingIndicator();
            
            const url = window.URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'Public_IP_VAPT_First_Audit_Report.xlsx';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            window.URL.revokeObjectURL(url);
            
            closeVaptModal('publicIpFirstAuditModal');
            location.reload();
        })
        .catch(error => {
            hideVaptLoadingIndicator();
            console.error('Error:', error);
            alert('Error generating report: ' + error.message);
        });
    }

    // Add Email and Team Member handlers for Public IP
    document.addEventListener('DOMContentLoaded', function() {
        // Public IP - Add Email
        const publicIpAddEmailBtn = document.getElementById('publicIpAddEmailBtn');
        if (publicIpAddEmailBtn) {
            publicIpAddEmailBtn.addEventListener('click', function() {
                const emailContainer = document.getElementById('publicIpEmailContainer');
                const newEmailField = document.createElement('div');
                newEmailField.style.display = 'flex';
                newEmailField.style.gap = '10px';
                newEmailField.style.marginTop = '10px';
                newEmailField.innerHTML = `
                    <input type="email" name="bankEmail[]" placeholder="Email Address" required style="flex: 1;">
                    <button type="button" onclick="removeVaptEmailField(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; cursor: pointer;">Remove</button>
                `;
                emailContainer.appendChild(newEmailField);
            });
        }
        
        // Public IP - Add Team Member
        const publicIpAddMemberBtn = document.getElementById('publicIpAddMemberBtn');
        if (publicIpAddMemberBtn) {
            publicIpAddMemberBtn.addEventListener('click', function() {
                const teamContainer = document.getElementById('publicIpAuditTeamContainer');
                const teamMembers = teamContainer.querySelectorAll('.team-member');
                
                if (teamMembers.length >= 8) {
                    alert('Maximum 8 team members allowed');
                    return;
                }
                
                const newIndex = teamMembers.length;
                const newMember = document.createElement('div');
                newMember.className = 'team-member';
                newMember.setAttribute('data-index', newIndex);
                newMember.innerHTML = `
                    <div class="form-row">
                        <div class="form-group">
                            <input type="text" name="teamName[]" placeholder="Name*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamQualification[]" placeholder="Qualification/Certification*" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Certified (Yes/No)*</label>
                        <div class="radio-group">
                            <label><input type="radio" name="teamCertified[${newIndex}]" value="yes" required> Yes</label>
                            <label><input type="radio" name="teamCertified[${newIndex}]" value="no"> No</label>
                        </div>
                    </div>
                    <button type="button" onclick="removeVaptTeamMember(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; margin-top: 10px; cursor: pointer;">Remove Member</button>
                `;
                teamContainer.appendChild(newMember);
            });
        }

        // Public IP Follow-up - Add Email
        const publicIpAddFollowUpEmailBtn = document.getElementById('publicIpAddFollowUpEmailBtn');
        if (publicIpAddFollowUpEmailBtn) {
            publicIpAddFollowUpEmailBtn.addEventListener('click', function() {
                const emailContainer = document.getElementById('publicIpFollowUpEmailContainer');
                const newEmailField = document.createElement('div');
                newEmailField.style.display = 'flex';
                newEmailField.style.gap = '10px';
                newEmailField.style.marginTop = '10px';
                newEmailField.innerHTML = `
                    <input type="email" name="bankEmail[]" placeholder="Email Address" required style="flex: 1;">
                    <button type="button" onclick="removeVaptEmailField(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; cursor: pointer;">Remove</button>
                `;
                emailContainer.appendChild(newEmailField);
            });
        }

        // Public IP Follow-up - Add Team Member
        const publicIpAddFollowUpMemberBtn = document.getElementById('publicIpAddFollowUpMemberBtn');
        if (publicIpAddFollowUpMemberBtn) {
            publicIpAddFollowUpMemberBtn.addEventListener('click', function() {
                const teamContainer = document.getElementById('publicIpFollowUpAuditTeamContainer');
                const teamMembers = teamContainer.querySelectorAll('.team-member');
                
                if (teamMembers.length >= 8) {
                    alert('Maximum 8 team members allowed');
                    return;
                }
                
                const newIndex = teamMembers.length;
                const newMember = document.createElement('div');
                newMember.className = 'team-member';
                newMember.setAttribute('data-index', newIndex);
                newMember.innerHTML = `
                    <div class="form-row">
                        <div class="form-group">
                            <input type="text" name="teamName[]" placeholder="Name*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamQualification[]" placeholder="Qualification/Certification*" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Certified (Yes/No)*</label>
                        <div class="radio-group">
                            <label><input type="radio" name="teamCertified[${newIndex}]" value="yes" required> Yes</label>
                            <label><input type="radio" name="teamCertified[${newIndex}]" value="no"> No</label>
                        </div>
                    </div>
                    <button type="button" onclick="removeVaptTeamMember(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; margin-top: 10px; cursor: pointer;">Remove Member</button>
                `;
                teamContainer.appendChild(newMember);
            });
        }

        // Web Application - Add Email
        const webAppAddEmailBtn = document.getElementById('webAppAddEmailBtn');
        if (webAppAddEmailBtn) {
            webAppAddEmailBtn.addEventListener('click', function() {
                const emailContainer = document.getElementById('webAppEmailContainer');
                const newEmailField = document.createElement('div');
                newEmailField.style.display = 'flex';
                newEmailField.style.gap = '10px';
                newEmailField.style.marginTop = '10px';
                newEmailField.innerHTML = `
                    <input type="email" name="bankEmail[]" placeholder="Email Address" required style="flex: 1;">
                    <button type="button" onclick="removeVaptEmailField(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; cursor: pointer;">Remove</button>
                `;
                emailContainer.appendChild(newEmailField);
            });
        }

        // Web Application - Add Team Member
        const webAppAddMemberBtn = document.getElementById('webAppAddMemberBtn');
        if (webAppAddMemberBtn) {
            webAppAddMemberBtn.addEventListener('click', function() {
                const teamContainer = document.getElementById('webAppAuditTeamContainer');
                const teamMembers = teamContainer.querySelectorAll('.team-member');
                
                if (teamMembers.length >= 8) {
                    alert('Maximum 8 team members allowed');
                    return;
                }
                
                const newIndex = teamMembers.length;
                const newMember = document.createElement('div');
                newMember.className = 'team-member';
                newMember.setAttribute('data-index', newIndex);
                newMember.innerHTML = `
                    <div class="form-row">
                        <div class="form-group">
                            <input type="text" name="teamName[]" placeholder="Name*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamQualification[]" placeholder="Qualification/Certification*" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Certified (Yes/No)*</label>
                        <div class="radio-group">
                            <label><input type="radio" name="teamCertified[${newIndex}]" value="yes" required> Yes</label>
                            <label><input type="radio" name="teamCertified[${newIndex}]" value="no"> No</label>
                        </div>
                    </div>
                `;
                teamContainer.appendChild(newMember);
            });
        }

        // Web Application - Add Asset
        const webAppApplicationTypeRadios = document.querySelectorAll('#webAppFirstAuditForm input[name="applicationType"]');
        if (webAppApplicationTypeRadios.length) {
            webAppApplicationTypeRadios.forEach(radio => {
                radio.addEventListener('change', updateWebAppAssetIpLabels);
            });
        }
        updateWebAppAssetIpLabels();

        const webAppAddAssetBtn = document.getElementById('webAppAddAssetBtn');
        if (webAppAddAssetBtn) {
            webAppAddAssetBtn.addEventListener('click', function() {
                const assetContainer = document.getElementById('webAppAssetContainer');
                const assetEntries = assetContainer.querySelectorAll('.asset-entry');

                if (assetEntries.length >= 8) {
                    alert('Maximum 8 assets allowed');
                    return;
                }

                const newIndex = assetEntries.length;
                const isExternal = getWebAppApplicationType() === 'External';
                const ipLabelText = isExternal ? 'External IP Address*' : 'Internal IP Addresses*';
                const ipPlaceholder = isExternal ? 'Enter external IP address(es)' : 'Enter internal IP addresses';

                const newAsset = document.createElement('div');
                newAsset.className = 'asset-entry';
                newAsset.setAttribute('data-asset-index', newIndex);
                newAsset.innerHTML = `
                    <hr style="margin: 20px 0; border: none; border-top: 1px solid #ddd;">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="webAppAssetDescription_${newIndex}">Asset Description*</label>
                            <input type="text" id="webAppAssetDescription_${newIndex}" name="assetDescription[]" placeholder="Enter asset description" required>
                        </div>
                        <div class="form-group">
                            <label for="webAppAssetCriticality_${newIndex}">Criticality of Asset*</label>
                            <input type="text" id="webAppAssetCriticality_${newIndex}" name="assetCriticality[]" placeholder="Enter criticality" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="webAppAssetIp_${newIndex}"><span class="webAppAssetIpLabel">${ipLabelText}</span></label>
                            <input type="text" id="webAppAssetIp_${newIndex}" name="assetInternalIp[]" class="webAppAssetIpInput" placeholder="${ipPlaceholder}" required>
                        </div>
                        <div class="form-group">
                            <label for="webAppAssetUrl_${newIndex}">URL*</label>
                            <input type="text" id="webAppAssetUrl_${newIndex}" name="assetUrl[]" placeholder="Enter URL" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="webAppAssetVersion_${newIndex}">Version*</label>
                        <input type="text" id="webAppAssetVersion_${newIndex}" name="assetVersion[]" placeholder="Enter version" required>
                    </div>
                `;
                assetContainer.appendChild(newAsset);
                updateWebAppAssetIpLabels();
            });
        }

        // Web Application Follow-Up Word - Add Asset
        const webAppFollowUpWordAddAssetBtn = document.getElementById('webAppFollowUpWordAddAssetBtn');
        if (webAppFollowUpWordAddAssetBtn) {
            webAppFollowUpWordAddAssetBtn.addEventListener('click', function() {
                const assetContainer = document.getElementById('webAppFollowUpWordAssetContainer');
                const assetEntries = assetContainer.querySelectorAll('.asset-entry');

                if (assetEntries.length >= 8) {
                    alert('Maximum 8 assets allowed');
                    return;
                }

                const newIndex = assetEntries.length;
                const isExternal = document.querySelector('#webAppFollowUpAuditWordForm input[name="applicationType"]:checked')?.value === 'External';
                const ipLabelText = isExternal ? 'External IP Address*' : 'Internal IP Addresses*';
                const ipPlaceholder = isExternal ? 'Enter external IP address(es)' : 'Enter internal IP addresses';

                const newAsset = document.createElement('div');
                newAsset.className = 'asset-entry';
                newAsset.setAttribute('data-asset-index', newIndex);
                newAsset.innerHTML = `
                    <hr style="margin: 20px 0; border: none; border-top: 1px solid #ddd;">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="webAppFollowUpWordAssetDescription_${newIndex}">Asset Description*</label>
                            <input type="text" id="webAppFollowUpWordAssetDescription_${newIndex}" name="assetDescription[]" placeholder="Enter asset description" required>
                        </div>
                        <div class="form-group">
                            <label for="webAppFollowUpWordAssetCriticality_${newIndex}">Criticality of Asset*</label>
                            <input type="text" id="webAppFollowUpWordAssetCriticality_${newIndex}" name="assetCriticality[]" placeholder="Enter criticality" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="webAppFollowUpWordAssetIp_${newIndex}"><span class="webAppFollowUpWordAssetIpLabel">${ipLabelText}</span></label>
                            <input type="text" id="webAppFollowUpWordAssetIp_${newIndex}" name="assetInternalIp[]" class="webAppFollowUpWordAssetIpInput" placeholder="${ipPlaceholder}" required>
                        </div>
                        <div class="form-group">
                            <label for="webAppFollowUpWordAssetUrl_${newIndex}">URL*</label>
                            <input type="text" id="webAppFollowUpWordAssetUrl_${newIndex}" name="assetUrl[]" placeholder="Enter URL" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="webAppFollowUpWordAssetVersion_${newIndex}">Version*</label>
                        <input type="text" id="webAppFollowUpWordAssetVersion_${newIndex}" name="assetVersion[]" placeholder="Enter version" required>
                    </div>
                `;
                assetContainer.appendChild(newAsset);
            });
        }

        // Update IP label based on application type for Follow-Up Word modal
        const webAppFollowUpWordApplicationTypeRadios = document.querySelectorAll('#webAppFollowUpAuditWordForm input[name="applicationType"]');
        if (webAppFollowUpWordApplicationTypeRadios.length) {
            webAppFollowUpWordApplicationTypeRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    const isExternal = this.value === 'External';
                    const ipLabels = document.querySelectorAll('#webAppFollowUpWordAssetContainer .webAppFollowUpWordAssetIpLabel');
                    const ipInputs = document.querySelectorAll('#webAppFollowUpWordAssetContainer .webAppFollowUpWordAssetIpInput');
                    
                    ipLabels.forEach(label => {
                        label.textContent = isExternal ? 'External IP Address*' : 'Internal IP Addresses*';
                    });
                    
                    ipInputs.forEach(input => {
                        input.placeholder = isExternal ? 'Enter external IP address(es)' : 'Enter internal IP addresses';
                    });
                });
            });
        }

        // Web Application Follow-Up Word - Add Email
        const webAppFollowUpWordAddEmailBtn = document.getElementById('webAppFollowUpWordAddEmailBtn');
        if (webAppFollowUpWordAddEmailBtn) {
            webAppFollowUpWordAddEmailBtn.addEventListener('click', function() {
                const emailContainer = document.getElementById('webAppFollowUpWordEmailContainer');
                const newEmailField = document.createElement('div');
                newEmailField.style.display = 'flex';
                newEmailField.style.gap = '10px';
                newEmailField.style.marginTop = '10px';
                newEmailField.innerHTML = `
                    <input type="email" name="bankEmail[]" placeholder="Email Address" required style="flex: 1;">
                    <button type="button" onclick="removeVaptEmailField(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; cursor: pointer;">Remove</button>
                `;
                emailContainer.appendChild(newEmailField);
            });
        }

        // Web Application Follow-Up Word - Add Team Member
        const webAppFollowUpWordAddMemberBtn = document.getElementById('webAppFollowUpWordAddMemberBtn');
        if (webAppFollowUpWordAddMemberBtn) {
            webAppFollowUpWordAddMemberBtn.addEventListener('click', function() {
                const teamContainer = document.getElementById('webAppFollowUpWordAuditTeamContainer');
                const teamMembers = teamContainer.querySelectorAll('.team-member');
                
                if (teamMembers.length >= 8) {
                    alert('Maximum 8 team members allowed');
                    return;
                }
                
                const newIndex = teamMembers.length;
                const newMember = document.createElement('div');
                newMember.className = 'team-member';
                newMember.setAttribute('data-index', newIndex);
                newMember.innerHTML = `
                    <hr style="margin: 20px 0; border: none; border-top: 1px solid #ddd;">
                    <div class="form-row">
                        <div class="form-group">
                            <input type="text" name="teamName[]" placeholder="Name*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamQualification[]" placeholder="Qualification*" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Certified (Yes/No)*</label>
                        <div class="radio-group">
                            <label><input type="radio" name="teamCertified[${newIndex}]" value="yes" required> Yes</label>
                            <label><input type="radio" name="teamCertified[${newIndex}]" value="no"> No</label>
                        </div>
                    </div>
                `;
                teamContainer.appendChild(newMember);
            });
        }

        // API Follow-Up Word - Add Asset
        const apiFollowUpWordAddAssetBtn = document.getElementById('apiFollowUpWordAddAssetBtn');
        if (apiFollowUpWordAddAssetBtn) {
            apiFollowUpWordAddAssetBtn.addEventListener('click', function() {
                const assetContainer = document.getElementById('apiFollowUpWordAssetContainer');
                const assetEntries = assetContainer.querySelectorAll('.asset-entry');

                if (assetEntries.length >= 8) {
                    alert('Maximum 8 assets allowed');
                    return;
                }

                const newIndex = assetEntries.length;

                const newAsset = document.createElement('div');
                newAsset.className = 'asset-entry';
                newAsset.setAttribute('data-asset-index', newIndex);
                newAsset.innerHTML = `
                    <hr style="margin: 20px 0; border: none; border-top: 1px solid #ddd;">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="apiFollowUpWordAssetDescription_${newIndex}">Asset Description*</label>
                            <input type="text" id="apiFollowUpWordAssetDescription_${newIndex}" name="assetDescription[]" placeholder="Enter asset description" required>
                        </div>
                        <div class="form-group">
                            <label for="apiFollowUpWordAssetCriticality_${newIndex}">Criticality of Asset*</label>
                            <input type="text" id="apiFollowUpWordAssetCriticality_${newIndex}" name="assetCriticality[]" placeholder="Enter criticality" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="apiFollowUpWordAssetUrl_${newIndex}">URL*</label>
                            <input type="text" id="apiFollowUpWordAssetUrl_${newIndex}" name="assetUrl[]" placeholder="Enter URL" required>
                        </div>
                        <div class="form-group">
                            <label for="apiFollowUpWordAssetHash_${newIndex}">Hash Value*</label>
                            <input type="text" id="apiFollowUpWordAssetHash_${newIndex}" name="assetHash[]" placeholder="Enter hash value" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="apiFollowUpWordAssetVersion_${newIndex}">Version*</label>
                        <input type="text" id="apiFollowUpWordAssetVersion_${newIndex}" name="assetVersion[]" placeholder="Enter version" required>
                    </div>
                `;
                assetContainer.appendChild(newAsset);
            });
        }

        // API Follow-Up Word - Add Email
        const apiFollowUpWordAddEmailBtn = document.getElementById('apiFollowUpWordAddEmailBtn');
        if (apiFollowUpWordAddEmailBtn) {
            apiFollowUpWordAddEmailBtn.addEventListener('click', function() {
                const emailContainer = document.getElementById('apiFollowUpWordEmailContainer');
                const newEmailField = document.createElement('div');
                newEmailField.style.display = 'flex';
                newEmailField.style.gap = '10px';
                newEmailField.style.marginTop = '10px';
                newEmailField.innerHTML = `
                    <input type="email" name="bankEmail[]" placeholder="Email Address" required style="flex: 1;">
                    <button type="button" onclick="removeVaptEmailField(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; cursor: pointer;">Remove</button>
                `;
                emailContainer.appendChild(newEmailField);
            });
        }

        // API Follow-Up Word - Add Team Member
        const apiFollowUpWordAddMemberBtn = document.getElementById('apiFollowUpWordAddMemberBtn');
        if (apiFollowUpWordAddMemberBtn) {
            apiFollowUpWordAddMemberBtn.addEventListener('click', function() {
                const teamContainer = document.getElementById('apiFollowUpWordAuditTeamContainer');
                const teamMembers = teamContainer.querySelectorAll('.team-member');
                
                if (teamMembers.length >= 8) {
                    alert('Maximum 8 team members allowed');
                    return;
                }
                
                const newIndex = teamMembers.length;
                const newMember = document.createElement('div');
                newMember.className = 'team-member';
                newMember.setAttribute('data-index', newIndex);
                newMember.innerHTML = `
                    <hr style="margin: 20px 0; border: none; border-top: 1px solid #ddd;">
                    <div class="form-row">
                        <div class="form-group">
                            <input type="text" name="teamName[]" placeholder="Name*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamQualification[]" placeholder="Qualification*" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Certified (Yes/No)*</label>
                        <div class="radio-group">
                            <label><input type="radio" name="teamCertified[${newIndex}]" value="yes" required> Yes</label>
                            <label><input type="radio" name="teamCertified[${newIndex}]" value="no"> No</label>
                        </div>
                    </div>
                `;
                teamContainer.appendChild(newMember);
            });
        }

        // Android Application Follow-Up Word - Add Asset
        const androidAppFollowUpWordAddAssetBtn = document.getElementById('androidAppFollowUpWordAddAssetBtn');
        if (androidAppFollowUpWordAddAssetBtn) {
            androidAppFollowUpWordAddAssetBtn.addEventListener('click', function() {
                const assetContainer = document.getElementById('androidAppFollowUpWordAssetContainer');
                const assetEntries = assetContainer.querySelectorAll('.asset-entry');

                if (assetEntries.length >= 8) {
                    alert('Maximum 8 assets allowed');
                    return;
                }

                const newIndex = assetEntries.length;

                const newAsset = document.createElement('div');
                newAsset.className = 'asset-entry';
                newAsset.setAttribute('data-asset-index', newIndex);
                newAsset.innerHTML = `
                    <hr style="margin: 20px 0; border: none; border-top: 1px solid #ddd;">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="androidAppFollowUpWordAssetDescription_${newIndex}">Asset Description*</label>
                            <input type="text" id="androidAppFollowUpWordAssetDescription_${newIndex}" name="assetDescription[]" placeholder="Enter asset description" required>
                        </div>
                        <div class="form-group">
                            <label for="androidAppFollowUpWordAssetCriticality_${newIndex}">Criticality of Asset*</label>
                            <input type="text" id="androidAppFollowUpWordAssetCriticality_${newIndex}" name="assetCriticality[]" placeholder="Enter criticality" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="androidAppFollowUpWordAssetHash_${newIndex}">Hash Value*</label>
                            <input type="text" id="androidAppFollowUpWordAssetHash_${newIndex}" name="assetHash[]" placeholder="Enter hash value" required>
                        </div>
                        <div class="form-group">
                            <label for="androidAppFollowUpWordAssetVersion_${newIndex}">Version*</label>
                            <input type="text" id="androidAppFollowUpWordAssetVersion_${newIndex}" name="assetVersion[]" placeholder="Enter version" required>
                        </div>
                    </div>
                `;
                assetContainer.appendChild(newAsset);
            });
        }

        // Android Application Follow-Up Word - Add Email
        const androidAppFollowUpWordAddEmailBtn = document.getElementById('androidAppFollowUpWordAddEmailBtn');
        if (androidAppFollowUpWordAddEmailBtn) {
            androidAppFollowUpWordAddEmailBtn.addEventListener('click', function() {
                const emailContainer = document.getElementById('androidAppFollowUpWordEmailContainer');
                const newEmailField = document.createElement('div');
                newEmailField.style.display = 'flex';
                newEmailField.style.gap = '10px';
                newEmailField.style.marginTop = '10px';
                newEmailField.innerHTML = `
                    <input type="email" name="bankEmail[]" placeholder="Email Address" required style="flex: 1;">
                    <button type="button" onclick="removeVaptEmailField(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; cursor: pointer;">Remove</button>
                `;
                emailContainer.appendChild(newEmailField);
            });
        }

        // Android Application Follow-Up Word - Add Team Member
        const androidAppFollowUpWordAddMemberBtn = document.getElementById('androidAppFollowUpWordAddMemberBtn');
        if (androidAppFollowUpWordAddMemberBtn) {
            androidAppFollowUpWordAddMemberBtn.addEventListener('click', function() {
                const teamContainer = document.getElementById('androidAppFollowUpWordAuditTeamContainer');
                const teamMembers = teamContainer.querySelectorAll('.team-member');
                
                if (teamMembers.length >= 8) {
                    alert('Maximum 8 team members allowed');
                    return;
                }
                
                const newIndex = teamMembers.length;
                const newMember = document.createElement('div');
                newMember.className = 'team-member';
                newMember.setAttribute('data-index', newIndex);
                newMember.innerHTML = `
                    <hr style="margin: 20px 0; border: none; border-top: 1px solid #ddd;">
                    <div class="form-row">
                        <div class="form-group">
                            <input type="text" name="teamName[]" placeholder="Name*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamQualification[]" placeholder="Qualification*" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Certified (Yes/No)*</label>
                        <div class="radio-group">
                            <label><input type="radio" name="teamCertified[${newIndex}]" value="yes" required> Yes</label>
                            <label><input type="radio" name="teamCertified[${newIndex}]" value="no"> No</label>
                        </div>
                    </div>
                `;
                teamContainer.appendChild(newMember);
            });
        }

        // IOS Application Follow-Up Word - Add Asset
        const iosAppFollowUpWordAddAssetBtn = document.getElementById('iosAppFollowUpWordAddAssetBtn');
        if (iosAppFollowUpWordAddAssetBtn) {
            iosAppFollowUpWordAddAssetBtn.addEventListener('click', function() {
                const assetContainer = document.getElementById('iosAppFollowUpWordAssetContainer');
                const assetEntries = assetContainer.querySelectorAll('.asset-entry');

                if (assetEntries.length >= 8) {
                    alert('Maximum 8 assets allowed');
                    return;
                }

                const newIndex = assetEntries.length;

                const newAsset = document.createElement('div');
                newAsset.className = 'asset-entry';
                newAsset.setAttribute('data-asset-index', newIndex);
                newAsset.innerHTML = `
                    <hr style="margin: 20px 0; border: none; border-top: 1px solid #ddd;">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="iosAppFollowUpWordAssetDescription_${newIndex}">Asset Description*</label>
                            <input type="text" id="iosAppFollowUpWordAssetDescription_${newIndex}" name="assetDescription[]" placeholder="Enter asset description" required>
                        </div>
                        <div class="form-group">
                            <label for="iosAppFollowUpWordAssetCriticality_${newIndex}">Criticality of Asset*</label>
                            <input type="text" id="iosAppFollowUpWordAssetCriticality_${newIndex}" name="assetCriticality[]" placeholder="Enter criticality" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="iosAppFollowUpWordAssetHash_${newIndex}">Hash Value*</label>
                            <input type="text" id="iosAppFollowUpWordAssetHash_${newIndex}" name="assetHash[]" placeholder="Enter hash value" required>
                        </div>
                        <div class="form-group">
                            <label for="iosAppFollowUpWordAssetVersion_${newIndex}">Version*</label>
                            <input type="text" id="iosAppFollowUpWordAssetVersion_${newIndex}" name="assetVersion[]" placeholder="Enter version" required>
                        </div>
                    </div>
                `;
                assetContainer.appendChild(newAsset);
            });
        }

        // IOS Application Follow-Up Word - Add Email
        const iosAppFollowUpWordAddEmailBtn = document.getElementById('iosAppFollowUpWordAddEmailBtn');
        if (iosAppFollowUpWordAddEmailBtn) {
            iosAppFollowUpWordAddEmailBtn.addEventListener('click', function() {
                const emailContainer = document.getElementById('iosAppFollowUpWordEmailContainer');
                const newEmailField = document.createElement('div');
                newEmailField.style.display = 'flex';
                newEmailField.style.gap = '10px';
                newEmailField.style.marginTop = '10px';
                newEmailField.innerHTML = `
                    <input type="email" name="bankEmail[]" placeholder="Email Address" required style="flex: 1;">
                    <button type="button" onclick="removeVaptEmailField(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; cursor: pointer;">Remove</button>
                `;
                emailContainer.appendChild(newEmailField);
            });
        }

        // IOS Application Follow-Up Word - Add Team Member
        const iosAppFollowUpWordAddMemberBtn = document.getElementById('iosAppFollowUpWordAddMemberBtn');
        if (iosAppFollowUpWordAddMemberBtn) {
            iosAppFollowUpWordAddMemberBtn.addEventListener('click', function() {
                const teamContainer = document.getElementById('iosAppFollowUpWordAuditTeamContainer');
                const teamMembers = teamContainer.querySelectorAll('.team-member');
                
                if (teamMembers.length >= 8) {
                    alert('Maximum 8 team members allowed');
                    return;
                }
                
                const newIndex = teamMembers.length;
                const newMember = document.createElement('div');
                newMember.className = 'team-member';
                newMember.setAttribute('data-index', newIndex);
                newMember.innerHTML = `
                    <hr style="margin: 20px 0; border: none; border-top: 1px solid #ddd;">
                    <div class="form-row">
                        <div class="form-group">
                            <input type="text" name="teamName[]" placeholder="Name*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamQualification[]" placeholder="Qualification*" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Certified (Yes/No)*</label>
                        <div class="radio-group">
                            <label><input type="radio" name="teamCertified[${newIndex}]" value="yes" required> Yes</label>
                            <label><input type="radio" name="teamCertified[${newIndex}]" value="no"> No</label>
                        </div>
                    </div>
                `;
                teamContainer.appendChild(newMember);
            });
        }

        // Web Application - Add New Vulnerability
        const webAppAddVulnerabilityBtn = document.getElementById('webAppAddVulnerabilityBtn');
        if (webAppAddVulnerabilityBtn) {
            webAppAddVulnerabilityBtn.addEventListener('click', function() {
                const vulnContainer = document.getElementById('webAppVulnerabilityContainer');
                const vulnEntries = vulnContainer.querySelectorAll('.vulnerability-entry');
                const newIndex = vulnEntries.length;
                
                const newVulnEntry = document.createElement('div');
                newVulnEntry.className = 'vulnerability-entry';
                newVulnEntry.setAttribute('data-vuln-index', newIndex);
                newVulnEntry.innerHTML = `
                    <hr style="margin: 20px 0; border: none; border-top: 1px solid #ddd;">
                    <h4 style="color: #2c3e50; margin-bottom: 10px;">Vulnerability ${newIndex + 1}</h4>
                    
                    <div class="form-group">
                        <label for="webAppVulnVulnerabilities_${newIndex}">Vulnerabilities*</label>
                        <textarea id="webAppVulnVulnerabilities_${newIndex}" name="vulnVulnerabilities[]" placeholder="Enter vulnerabilities" rows="3" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="webAppVulnName_${newIndex}">Name of Vulnerability*</label>
                        <input type="text" id="webAppVulnName_${newIndex}" name="vulnName[]" placeholder="Enter vulnerability name" required>
                    </div>

                    <div class="form-group">
                        <label for="webAppVulnRiskFactor_${newIndex}">Risk Factor*</label>
                        <select id="webAppVulnRiskFactor_${newIndex}" name="vulnRiskFactor[]" required>
                            <option value="">Select Risk Factor</option>
                            <option value="Critical">Critical</option>
                            <option value="High">High</option>
                            <option value="Medium">Medium</option>
                            <option value="Low">Low</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="webAppVulnCVE_${newIndex}">CVE ID</label>
                        <input type="text" id="webAppVulnCVE_${newIndex}" name="vulnCVE[]" placeholder="Enter CVE ID (optional)">
                    </div>

                    <div class="form-group">
                        <label for="webAppVulnCVSS_${newIndex}">CVSS</label>
                        <input type="text" id="webAppVulnCVSS_${newIndex}" name="vulnCVSS[]" placeholder="Enter CVSS score (optional)">
                    </div>

                    <div class="form-group">
                        <label for="webAppVulnObservation_${newIndex}">Audit Observation*</label>
                        <textarea id="webAppVulnObservation_${newIndex}" name="vulnObservation[]" rows="3" placeholder="Enter audit observation" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="webAppVulnImpact_${newIndex}">Impact*</label>
                        <textarea id="webAppVulnImpact_${newIndex}" name="vulnImpact[]" rows="3" placeholder="Enter impact description" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="webAppVulnRecommendation_${newIndex}">Recommendation / Countermeasure*</label>
                        <textarea id="webAppVulnRecommendation_${newIndex}" name="vulnRecommendation[]" rows="3" placeholder="Enter recommendation" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="webAppVulnReference_${newIndex}">Reference Link</label>
                        <textarea id="webAppVulnReference_${newIndex}" name="vulnReference[]" placeholder="Enter reference URL (optional)" rows="2"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="webAppVulnAffectedSystem_${newIndex}">Affected Systems*</label>
                        <input type="text" id="webAppVulnAffectedSystem_${newIndex}" name="vulnAffectedSystem[]" placeholder="Enter affected systems" required>
                    </div>
                `;
                vulnContainer.appendChild(newVulnEntry);
            });
        }

        // Android Mobile Application - Add Email
        const androidAppAddEmailBtn = document.getElementById('androidAppAddEmailBtn');
        if (androidAppAddEmailBtn) {
            androidAppAddEmailBtn.addEventListener('click', function() {
                const emailContainer = document.getElementById('androidAppEmailContainer');
                const newEmailField = document.createElement('div');
                newEmailField.style.display = 'flex';
                newEmailField.style.gap = '10px';
                newEmailField.style.marginTop = '10px';
                newEmailField.innerHTML = `
                    <input type=\"email\" name=\"bankEmail[]\" placeholder=\"Email Address\" required style=\"flex: 1;\">
                    <button type=\"button\" onclick=\"removeVaptEmailField(this)\" style=\"background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; cursor: pointer;\">Remove</button>
                `;
                emailContainer.appendChild(newEmailField);
            });
        }

        // Android Mobile Application - Add Team Member
        const androidAppAddMemberBtn = document.getElementById('androidAppAddMemberBtn');
        if (androidAppAddMemberBtn) {
            androidAppAddMemberBtn.addEventListener('click', function() {
                const teamContainer = document.getElementById('androidAppAuditTeamContainer');
                const teamMembers = teamContainer.querySelectorAll('.team-member');

                if (teamMembers.length >= 8) {
                    alert('Maximum 8 team members allowed');
                    return;
                }

                const newIndex = teamMembers.length;
                const newMember = document.createElement('div');
                newMember.className = 'team-member';
                newMember.setAttribute('data-index', newIndex);
                newMember.innerHTML = `
                    <div class=\"form-row\">
                        <div class=\"form-group\">
                            <input type=\"text\" name=\"teamName[]\" placeholder=\"Name*\" required>
                        </div>
                        <div class=\"form-group\">
                            <input type=\"text\" name=\"teamDesignation[]\" placeholder=\"Designation*\" required>
                        </div>
                    </div>
                    <div class=\"form-row\">
                        <div class=\"form-group\">
                            <input type=\"email\" name=\"teamEmail[]\" placeholder=\"Email Address*\" required>
                        </div>
                        <div class=\"form-group\">
                            <input type=\"text\" name=\"teamQualification[]\" placeholder=\"Qualification/Certification*\" required>
                        </div>
                    </div>
                    <div class=\"form-group\">
                        <label>Certified (Yes/No)*</label>
                        <div class=\"radio-group\">
                            <label><input type=\"radio\" name=\"teamCertified[${newIndex}]\" value=\"yes\" required> Yes</label>
                            <label><input type=\"radio\" name=\"teamCertified[${newIndex}]\" value=\"no\"> No</label>
                        </div>
                    </div>
                `;
                teamContainer.appendChild(newMember);
            });
        }

        // Android Mobile Application - Add Asset
        const androidAppAddAssetBtn = document.getElementById('androidAppAddAssetBtn');
        if (androidAppAddAssetBtn) {
            androidAppAddAssetBtn.addEventListener('click', function() {
                const assetContainer = document.getElementById('androidAppAssetContainer');
                const assetEntries = assetContainer.querySelectorAll('.android-asset-entry');

                if (assetEntries.length >= 8) {
                    alert('Maximum 8 assets allowed');
                    return;
                }

                const newIndex = assetEntries.length;
                const newAsset = document.createElement('div');
                newAsset.className = 'asset-entry android-asset-entry';
                newAsset.setAttribute('data-asset-index', newIndex);
                newAsset.innerHTML = `
                    <hr style="margin: 20px 0; border: none; border-top: 1px solid #ddd;">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="androidAppAssetDescription_${newIndex}">Asset Description*</label>
                            <input type="text" id="androidAppAssetDescription_${newIndex}" name="assetDescription[]" placeholder="Enter asset description" required>
                        </div>
                        <div class="form-group">
                            <label for="androidAppAssetCriticality_${newIndex}">Criticality of Asset*</label>
                            <input type="text" id="androidAppAssetCriticality_${newIndex}" name="assetCriticality[]" placeholder="Enter criticality" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="androidAppAssetHash_${newIndex}">Hash Value*</label>
                            <input type="text" id="androidAppAssetHash_${newIndex}" name="assetHash[]" placeholder="Enter hash value" required>
                        </div>
                        <div class="form-group">
                            <label for="androidAppAssetVersion_${newIndex}">Version*</label>
                            <input type="text" id="androidAppAssetVersion_${newIndex}" name="assetVersion[]" placeholder="Enter version" required>
                        </div>
                    </div>
                `;
                assetContainer.appendChild(newAsset);
            });
        }

        // IOS Mobile Application - Add Asset
        const iosAppAddAssetBtn = document.getElementById('iosAppAddAssetBtn');
        if (iosAppAddAssetBtn) {
            iosAppAddAssetBtn.addEventListener('click', function() {
                const assetContainer = document.getElementById('iosAppAssetContainer');
                const assetEntries = assetContainer.querySelectorAll('.ios-asset-entry');

                if (assetEntries.length >= 8) {
                    alert('Maximum 8 assets allowed');
                    return;
                }

                const newIndex = assetEntries.length;
                const newAsset = document.createElement('div');
                newAsset.className = 'asset-entry ios-asset-entry';
                newAsset.setAttribute('data-asset-index', newIndex);
                newAsset.innerHTML = `
                    <hr style="margin: 20px 0; border: none; border-top: 1px solid #ddd;">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="iosAppAssetDescription_${newIndex}">Asset Description*</label>
                            <input type="text" id="iosAppAssetDescription_${newIndex}" name="assetDescription[]" placeholder="Enter asset description" required>
                        </div>
                        <div class="form-group">
                            <label for="iosAppAssetCriticality_${newIndex}">Criticality of Asset*</label>
                            <input type="text" id="iosAppAssetCriticality_${newIndex}" name="assetCriticality[]" placeholder="Enter criticality" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="iosAppAssetHash_${newIndex}">Hash Value*</label>
                            <input type="text" id="iosAppAssetHash_${newIndex}" name="assetHash[]" placeholder="Enter hash value" required>
                        </div>
                        <div class="form-group">
                            <label for="iosAppAssetVersion_${newIndex}">Version*</label>
                            <input type="text" id="iosAppAssetVersion_${newIndex}" name="assetVersion[]" placeholder="Enter version" required>
                        </div>
                    </div>
                `;
                assetContainer.appendChild(newAsset);
            });
        }

        // API Application - Add Asset
        const apiAddAssetBtn = document.getElementById('apiAddAssetBtn');
        if (apiAddAssetBtn) {
            apiAddAssetBtn.addEventListener('click', function() {
                const assetContainer = document.getElementById('apiAssetContainer');
                const assetEntries = assetContainer.querySelectorAll('.api-asset-entry');

                if (assetEntries.length >= 8) {
                    alert('Maximum 8 assets allowed');
                    return;
                }

                const newIndex = assetEntries.length;
                const newAsset = document.createElement('div');
                newAsset.className = 'asset-entry api-asset-entry';
                newAsset.setAttribute('data-asset-index', newIndex);
                newAsset.innerHTML = `
                    <hr style="margin: 20px 0; border: none; border-top: 1px solid #ddd;">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="apiAssetDescription_${newIndex}">Asset Description*</label>
                            <input type="text" id="apiAssetDescription_${newIndex}" name="assetDescription[]" placeholder="Enter asset description" required>
                        </div>
                        <div class="form-group">
                            <label for="apiAssetCriticality_${newIndex}">Criticality of Asset*</label>
                            <input type="text" id="apiAssetCriticality_${newIndex}" name="assetCriticality[]" placeholder="Enter criticality" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="apiAssetUrl_${newIndex}">URL*</label>
                            <input type="text" id="apiAssetUrl_${newIndex}" name="assetUrl[]" placeholder="Enter URL" required>
                        </div>
                        <div class="form-group">
                            <label for="apiAssetHash_${newIndex}">Hash Value*</label>
                            <input type="text" id="apiAssetHash_${newIndex}" name="assetHash[]" placeholder="Enter hash value" required>
                        </div>
                        <div class="form-group">
                            <label for="apiAssetVersion_${newIndex}">Version*</label>
                            <input type="text" id="apiAssetVersion_${newIndex}" name="assetVersion[]" placeholder="Enter version" required>
                        </div>
                    </div>
                `;
                assetContainer.appendChild(newAsset);
            });
        }

        // API Follow-Up - Add Asset

        // Android Mobile Application Follow-Up - Add Asset
        const androidAppFollowUpAddAssetBtn = document.getElementById('androidAppFollowUpAddAssetBtn');
        if (androidAppFollowUpAddAssetBtn) {
            androidAppFollowUpAddAssetBtn.addEventListener('click', function() {
                const assetContainer = document.getElementById('androidAppFollowUpAssetContainer');
                const assetEntries = assetContainer.querySelectorAll('.android-followup-asset-entry');

                if (assetEntries.length >= 8) {
                    alert('Maximum 8 assets allowed');
                    return;
                }

                const newIndex = assetEntries.length;
                const newAsset = document.createElement('div');
                newAsset.className = 'asset-entry android-followup-asset-entry';
                newAsset.setAttribute('data-asset-index', newIndex);
                newAsset.innerHTML = `
                    <hr style="margin: 20px 0; border: none; border-top: 1px solid #ddd;">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="androidAppFollowUpAssetDescription_${newIndex}">Asset Description*</label>
                            <input type="text" id="androidAppFollowUpAssetDescription_${newIndex}" name="assetDescription[]" placeholder="Enter asset description" required>
                        </div>
                        <div class="form-group">
                            <label for="androidAppFollowUpAssetCriticality_${newIndex}">Criticality of Asset*</label>
                            <input type="text" id="androidAppFollowUpAssetCriticality_${newIndex}" name="assetCriticality[]" placeholder="Enter criticality" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="androidAppFollowUpAssetHash_${newIndex}">Hash Value*</label>
                            <input type="text" id="androidAppFollowUpAssetHash_${newIndex}" name="assetHash[]" placeholder="Enter hash value" required>
                        </div>
                        <div class="form-group">
                            <label for="androidAppFollowUpAssetVersion_${newIndex}">Version*</label>
                            <input type="text" id="androidAppFollowUpAssetVersion_${newIndex}" name="assetVersion[]" placeholder="Enter version" required>
                        </div>
                    </div>
                `;
                assetContainer.appendChild(newAsset);
            });
        }

        // IOS Mobile Application Follow-Up - Add Asset

        // Android Mobile Application - Add New Vulnerability
        const androidAppAddVulnerabilityBtn = document.getElementById('androidAppAddVulnerabilityBtn');
        if (androidAppAddVulnerabilityBtn) {
            androidAppAddVulnerabilityBtn.addEventListener('click', function() {
                const vulnContainer = document.getElementById('androidAppVulnerabilityContainer');
                const vulnEntries = vulnContainer.querySelectorAll('.vulnerability-entry');
                const newIndex = vulnEntries.length;

                const newVulnEntry = document.createElement('div');
                newVulnEntry.className = 'vulnerability-entry';
                newVulnEntry.setAttribute('data-vuln-index', newIndex);
                newVulnEntry.innerHTML = `
                    <hr style=\"margin: 20px 0; border: none; border-top: 1px solid #ddd;\">
                    <h4 style=\"color: #2c3e50; margin-bottom: 10px;\">Vulnerability ${newIndex + 1}</h4>

                    <div class=\"form-group\">
                        <label for=\"androidAppVulnVulnerabilities_${newIndex}\">Vulnerabilities*</label>
                        <textarea id=\"androidAppVulnVulnerabilities_${newIndex}\" name=\"vulnVulnerabilities[]\" placeholder=\"Enter vulnerabilities\" rows=\"3\" required></textarea>
                    </div>

                    <div class=\"form-group\">
                        <label for=\"androidAppVulnName_${newIndex}\">Name of Vulnerability*</label>
                        <input type=\"text\" id=\"androidAppVulnName_${newIndex}\" name=\"vulnName[]\" placeholder=\"Enter vulnerability name\" required>
                    </div>

                    <div class=\"form-group\">
                        <label for=\"androidAppVulnRiskFactor_${newIndex}\">Risk Factor*</label>
                        <select id=\"androidAppVulnRiskFactor_${newIndex}\" name=\"vulnRiskFactor[]\" required>
                            <option value=\"\">Select Risk Factor</option>
                            <option value=\"Critical\">Critical</option>
                            <option value=\"High\">High</option>
                            <option value=\"Medium\">Medium</option>
                            <option value=\"Low\">Low</option>
                        </select>
                    </div>

                    <div class=\"form-group\">
                        <label for=\"androidAppVulnCVE_${newIndex}\">CVE ID</label>
                        <input type=\"text\" id=\"androidAppVulnCVE_${newIndex}\" name=\"vulnCVE[]\" placeholder=\"Enter CVE ID (optional)\">
                    </div>

                    <div class=\"form-group\">
                        <label for=\"androidAppVulnCVSS_${newIndex}\">CVSS</label>
                        <input type=\"text\" id=\"androidAppVulnCVSS_${newIndex}\" name=\"vulnCVSS[]\" placeholder=\"Enter CVSS score (optional)\">
                    </div>

                    <div class=\"form-group\">
                        <label for=\"androidAppVulnObservation_${newIndex}\">Audit Observation*</label>
                        <textarea id=\"androidAppVulnObservation_${newIndex}\" name=\"vulnObservation[]\" rows=\"3\" placeholder=\"Enter audit observation\" required></textarea>
                    </div>

                    <div class=\"form-group\">
                        <label for=\"androidAppVulnImpact_${newIndex}\">Impact*</label>
                        <textarea id=\"androidAppVulnImpact_${newIndex}\" name=\"vulnImpact[]\" rows=\"3\" placeholder=\"Enter impact description\" required></textarea>
                    </div>

                    <div class=\"form-group\">
                        <label for=\"androidAppVulnRecommendation_${newIndex}\">Recommendation / Countermeasure*</label>
                        <textarea id=\"androidAppVulnRecommendation_${newIndex}\" name=\"vulnRecommendation[]\" rows=\"3\" placeholder=\"Enter recommendation\" required></textarea>
                    </div>

                    <div class=\"form-group\">
                        <label for=\"androidAppVulnReference_${newIndex}\">Reference Link</label>
                        <textarea id=\"androidAppVulnReference_${newIndex}\" name=\"vulnReference[]\" placeholder=\"Enter reference URL (optional)\" rows=\"2\"></textarea>
                    </div>

                    <div class=\"form-group\">
                        <label for=\"androidAppVulnAffectedSystem_${newIndex}\">Affected Systems*</label>
                        <input type=\"text\" id=\"androidAppVulnAffectedSystem_${newIndex}\" name=\"vulnAffectedSystem[]\" placeholder=\"Enter affected systems\" required>
                    </div>
                `;
                vulnContainer.appendChild(newVulnEntry);
            });
        }

        // IOS Mobile Application - Add Email
        const iosAppAddEmailBtn = document.getElementById('iosAppAddEmailBtn');
        if (iosAppAddEmailBtn) {
            iosAppAddEmailBtn.addEventListener('click', function() {
                const emailContainer = document.getElementById('iosAppEmailContainer');
                const newEmailField = document.createElement('div');
                newEmailField.style.display = 'flex';
                newEmailField.style.gap = '10px';
                newEmailField.style.marginTop = '10px';
                newEmailField.innerHTML = `
                    <input type="email" name="bankEmail[]" placeholder="Email Address" required style="flex: 1;">
                    <button type="button" onclick="removeVaptEmailField(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; cursor: pointer;">Remove</button>
                `;
                emailContainer.appendChild(newEmailField);
            });
        }

        // IOS Mobile Application - Add Team Member
        const iosAppAddMemberBtn = document.getElementById('iosAppAddMemberBtn');
        if (iosAppAddMemberBtn) {
            iosAppAddMemberBtn.addEventListener('click', function() {
                const teamContainer = document.getElementById('iosAppAuditTeamContainer');
                const teamMembers = teamContainer.querySelectorAll('.team-member');

                if (teamMembers.length >= 8) {
                    alert('Maximum 8 team members allowed');
                    return;
                }

                const newIndex = teamMembers.length;
                const newMember = document.createElement('div');
                newMember.className = 'team-member';
                newMember.setAttribute('data-index', newIndex);
                newMember.innerHTML = `
                    <div class="form-row">
                        <div class="form-group">
                            <input type="text" name="teamName[]" placeholder="Name*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamQualification[]" placeholder="Qualification/Certification*" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Certified (Yes/No)*</label>
                        <div class="radio-group">
                            <label><input type="radio" name="teamCertified[${newIndex}]" value="yes" required> Yes</label>
                            <label><input type="radio" name="teamCertified[${newIndex}]" value="no"> No</label>
                        </div>
                    </div>
                `;
                teamContainer.appendChild(newMember);
            });
        }

        // IOS Mobile Application - Add New Vulnerability
        const iosAppAddVulnerabilityBtn = document.getElementById('iosAppAddVulnerabilityBtn');
        if (iosAppAddVulnerabilityBtn) {
            iosAppAddVulnerabilityBtn.addEventListener('click', function() {
                const vulnContainer = document.getElementById('iosAppVulnerabilityContainer');
                const vulnEntries = vulnContainer.querySelectorAll('.vulnerability-entry');
                const newIndex = vulnEntries.length;

                const newVulnEntry = document.createElement('div');
                newVulnEntry.className = 'vulnerability-entry';
                newVulnEntry.setAttribute('data-vuln-index', newIndex);
                newVulnEntry.innerHTML = `
                    <hr style="margin: 20px 0; border: none; border-top: 1px solid #ddd;">
                    <h4 style="color: #2c3e50; margin-bottom: 10px;">Vulnerability ${newIndex + 1}</h4>

                    <div class="form-group">
                        <label for="iosAppVulnVulnerabilities_${newIndex}">Vulnerabilities*</label>
                        <textarea id="iosAppVulnVulnerabilities_${newIndex}" name="vulnVulnerabilities[]" placeholder="Enter vulnerabilities" rows="3" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="iosAppVulnName_${newIndex}">Name of Vulnerability*</label>
                        <input type="text" id="iosAppVulnName_${newIndex}" name="vulnName[]" placeholder="Enter vulnerability name" required>
                    </div>

                    <div class="form-group">
                        <label for="iosAppVulnRiskFactor_${newIndex}">Risk Factor*</label>
                        <select id="iosAppVulnRiskFactor_${newIndex}" name="vulnRiskFactor[]" required>
                            <option value="">Select Risk Factor</option>
                            <option value="Critical">Critical</option>
                            <option value="High">High</option>
                            <option value="Medium">Medium</option>
                            <option value="Low">Low</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="iosAppVulnCVE_${newIndex}">CVE ID</label>
                        <input type="text" id="iosAppVulnCVE_${newIndex}" name="vulnCVE[]" placeholder="Enter CVE ID (optional)">
                    </div>

                    <div class="form-group">
                        <label for="iosAppVulnCVSS_${newIndex}">CVSS</label>
                        <input type="text" id="iosAppVulnCVSS_${newIndex}" name="vulnCVSS[]" placeholder="Enter CVSS score (optional)">
                    </div>

                    <div class="form-group">
                        <label for="iosAppVulnObservation_${newIndex}">Audit Observation*</label>
                        <textarea id="iosAppVulnObservation_${newIndex}" name="vulnObservation[]" rows="3" placeholder="Enter audit observation" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="iosAppVulnImpact_${newIndex}">Impact*</label>
                        <textarea id="iosAppVulnImpact_${newIndex}" name="vulnImpact[]" rows="3" placeholder="Enter impact description" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="iosAppVulnRecommendation_${newIndex}">Recommendation / Countermeasure*</label>
                        <textarea id="iosAppVulnRecommendation_${newIndex}" name="vulnRecommendation[]" rows="3" placeholder="Enter recommendation" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="iosAppVulnReference_${newIndex}">Reference Link</label>
                        <textarea id="iosAppVulnReference_${newIndex}" name="vulnReference[]" placeholder="Enter reference URL (optional)" rows="2"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="iosAppVulnAffectedSystem_${newIndex}">Affected Systems*</label>
                        <input type="text" id="iosAppVulnAffectedSystem_${newIndex}" name="vulnAffectedSystem[]" placeholder="Enter affected systems" required>
                    </div>
                `;
                vulnContainer.appendChild(newVulnEntry);
            });
        }

        // API - Add Email
        const apiAddEmailBtn = document.getElementById('apiAddEmailBtn');
        if (apiAddEmailBtn) {
            apiAddEmailBtn.addEventListener('click', function() {
                const emailContainer = document.getElementById('apiEmailContainer');
                const newEmailField = document.createElement('div');
                newEmailField.style.display = 'flex';
                newEmailField.style.gap = '10px';
                newEmailField.style.marginTop = '10px';
                newEmailField.innerHTML = `
                    <input type="email" name="bankEmail[]" placeholder="Email Address" required style="flex: 1;">
                    <button type="button" onclick="removeVaptEmailField(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; cursor: pointer;">Remove</button>
                `;
                emailContainer.appendChild(newEmailField);
            });
        }

        // API - Add Team Member
        const apiAddMemberBtn = document.getElementById('apiAddMemberBtn');
        if (apiAddMemberBtn) {
            apiAddMemberBtn.addEventListener('click', function() {
                const teamContainer = document.getElementById('apiAuditTeamContainer');
                const teamMembers = teamContainer.querySelectorAll('.team-member');

                if (teamMembers.length >= 8) {
                    alert('Maximum 8 team members allowed');
                    return;
                }

                const newIndex = teamMembers.length;
                const newMember = document.createElement('div');
                newMember.className = 'team-member';
                newMember.setAttribute('data-index', newIndex);
                newMember.innerHTML = `
                    <div class="form-row">
                        <div class="form-group">
                            <input type="text" name="teamName[]" placeholder="Name*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamQualification[]" placeholder="Qualification/Certification*" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Certified (Yes/No)*</label>
                        <div class="radio-group">
                            <label><input type="radio" name="teamCertified[${newIndex}]" value="yes" required> Yes</label>
                            <label><input type="radio" name="teamCertified[${newIndex}]" value="no"> No</label>
                        </div>
                    </div>
                `;
                teamContainer.appendChild(newMember);
            });
        }

        // API - Add New Vulnerability
        const apiAddVulnerabilityBtn = document.getElementById('apiAddVulnerabilityBtn');
        if (apiAddVulnerabilityBtn) {
            apiAddVulnerabilityBtn.addEventListener('click', function() {
                const vulnContainer = document.getElementById('apiFirstAuditVulnerabilityContainer');
                if (!vulnContainer) {
                    return;
                }

                const existingEntries = vulnContainer.querySelectorAll('.vulnerability-entry');
                if (!existingEntries.length) {
                    return;
                }

                const maxVulnEntries = 20;
                if (existingEntries.length >= maxVulnEntries) {
                    alert(`Maximum ${maxVulnEntries} vulnerabilities allowed`);
                    return;
                }

                const templateEntry = existingEntries[0];
                const newIndex = existingEntries.length;
                const clonedEntry = templateEntry.cloneNode(true);

                clonedEntry.setAttribute('data-vuln-index', newIndex);

                // Remove any existing separators to avoid duplication
                clonedEntry.querySelectorAll('hr').forEach(hr => hr.remove());
                const divider = document.createElement('hr');
                divider.style.margin = '20px 0';
                divider.style.border = 'none';
                divider.style.borderTop = '1px solid #ddd';
                clonedEntry.insertBefore(divider, clonedEntry.firstChild);

                let header = clonedEntry.querySelector('h4');
                if (!header) {
                    header = document.createElement('h4');
                    header.style.color = '#2c3e50';
                    header.style.marginBottom = '10px';
                    clonedEntry.insertBefore(header, divider.nextSibling);
                }
                header.textContent = `Vulnerability ${newIndex + 1}`;

                const fields = clonedEntry.querySelectorAll('input, textarea, select');
                fields.forEach(field => {
                    if (field instanceof HTMLInputElement) {
                        if (field.type === 'radio' || field.type === 'checkbox') {
                            field.checked = false;
                        } else {
                            field.value = '';
                        }
                    } else if (field instanceof HTMLTextAreaElement) {
                        field.value = '';
                    } else if (field instanceof HTMLSelectElement) {
                        field.selectedIndex = 0;
                    }

                    if (field.id && field.id.includes('_')) {
                        const idBase = field.id.replace(/_\d+$/, '');
                        field.id = `${idBase}_${newIndex}`;
                    }
                });

                const labels = clonedEntry.querySelectorAll('label[for]');
                labels.forEach(label => {
                    if (label.htmlFor && label.htmlFor.includes('_')) {
                        const forBase = label.htmlFor.replace(/_\d+$/, '');
                        label.htmlFor = `${forBase}_${newIndex}`;
                    }
                });

                vulnContainer.appendChild(clonedEntry);
            });
        }

        // Public IP Follow-up Audit Form Submission Handler
        document.getElementById('publicIpFollowUpAuditForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Validate team members
            const teamMembers = document.getElementById('publicIpFollowUpAuditTeamContainer').querySelectorAll('.team-member');
            if (teamMembers.length < 1) {
                alert('At least one team member is required');
                return;
            }
            
            // Validate dates
            const startDate = new Date(document.getElementById('publicIpFollowUpStartDate').value);
            const endDate = new Date(document.getElementById('publicIpFollowUpEndDate').value);
            
            if (endDate < startDate) {
                alert('End date must be after start date');
                return;
            }
            
            // Show loading indicator
            showVaptLoadingIndicator();
            const submitBtn = this.querySelector('.submit-btn');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = 'Checking...';
            
            const formData = new FormData(this);
            
            // Handle organization name
            const organizationSelect = document.getElementById('publicIpFollowUpOrganization');
            if (organizationSelect && organizationSelect.value === 'other') {
                const otherOrganizationInput = document.getElementById('publicIpFollowUpOtherOrganization');
                if (otherOrganizationInput && otherOrganizationInput.value && otherOrganizationInput.value.trim() !== '') {
                    formData.set('organization', otherOrganizationInput.value);
                }
            }
            
            // Handle city
            const citySelect = document.getElementById('publicIpFollowUpCity');
            if (citySelect && citySelect.value === 'other') {
                const otherCityInput = document.getElementById('publicIpFollowUpOtherCity');
                if (otherCityInput && otherCityInput.value && otherCityInput.value.trim() !== '') {
                    formData.set('city', otherCityInput.value);
                }
            }
            
            // First check vulnerabilities
            fetch('/public_ip_vapt_followup_check_vulnerabilities', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    alert('Error: ' + data.error);
                    submitBtn.disabled = false;
                    submitBtn.textContent = originalText;
                    hideVaptLoadingIndicator();
                    return;
                }
                
                // Hide loading indicator before showing dialog
                hideVaptLoadingIndicator();
                
                // Show vulnerability confirmation dialog
                showPublicIpFollowUpVulnerabilityConfirmationDialog(data, this);
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error checking vulnerabilities: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
                hideVaptLoadingIndicator();
            });
        });
    });

    // ==============================================================================
    // Public IP Follow-up Vulnerability Management
    // ==============================================================================
    
    // Public IP Follow-up vulnerability management state
    let publicIpFollowUpVulnerabilityMergeState = {
        matchedGroups: [],
        unmatchedVulnerabilities: []
    };

    function showPublicIpFollowUpVulnerabilityConfirmationDialog(vulnData, form) {
        publicIpFollowUpVulnerabilityMergeState.matchedGroups = vulnData.matched_groups || [];
        publicIpFollowUpVulnerabilityMergeState.unmatchedVulnerabilities = vulnData.unmatched_vulnerabilities || [];
        
        const dialogOverlay = document.createElement('div');
        dialogOverlay.id = 'publicIpFollowUpVulnerabilityDialog';
        dialogOverlay.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        `;
        
        const dialogContent = document.createElement('div');
        dialogContent.className = 'dialog-content';
        dialogContent.style.cssText = `
            background: white;
            padding: 30px;
            border-radius: 8px;
            max-width: 1400px;
            max-height: 90vh;
            overflow: auto;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        `;
        
        // Header with title, undo button, count info, and Add Vulnerability Manual button
        const headerSection = document.createElement('div');
        headerSection.style.cssText = 'display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid #2c3e50;';
        
        const headerLeft = document.createElement('div');
        headerLeft.style.cssText = 'display: flex; align-items: center; gap: 15px;';
        
        const headerTitle = document.createElement('h2');
        headerTitle.textContent = 'Public IP VAPT Follow-Up - Vulnerability Management';
        headerTitle.style.cssText = 'margin: 0; color: #2c3e50;';
        
        const undoButton = document.createElement('button');
        undoButton.textContent = ' Undo Last Operation';
        undoButton.className = 'undo-btn';
        undoButton.style.cssText = 'padding: 8px 16px; background-color: #f39c12; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 13px;';
        undoButton.onclick = undoPublicIpFollowUpLastMergeOperation;
        
        const refreshInfo = document.createElement('span');
        refreshInfo.textContent = `Matched: ${publicIpFollowUpVulnerabilityMergeState.matchedGroups.length} | Unmatched: ${publicIpFollowUpVulnerabilityMergeState.unmatchedVulnerabilities.length}`;
        refreshInfo.style.cssText = 'padding: 6px 12px; background-color: #ecf0f1; border-radius: 4px; font-size: 13px; color: #2c3e50;';
        refreshInfo.id = 'publicIpFollowUpVulnCountInfo';
        
        headerLeft.appendChild(headerTitle);
        headerLeft.appendChild(undoButton);
        headerLeft.appendChild(refreshInfo);
        
        const addManualVulnBtn = document.createElement('button');
        addManualVulnBtn.type = 'button';
        addManualVulnBtn.className = 'submit-btn';
        addManualVulnBtn.innerHTML = '<i class="fas fa-plus-circle"></i> Add Vulnerability Manual';
        addManualVulnBtn.style.cssText = 'background-color: #27ae60; padding: 8px 16px; font-size: 13px;';
        addManualVulnBtn.onclick = () => showPublicIpFollowUpAddManualVulnerabilityDialog();
        
        headerSection.appendChild(headerLeft);
        headerSection.appendChild(addManualVulnBtn);
        dialogContent.appendChild(headerSection);
        
        const vulnContainer = document.createElement('div');
        vulnContainer.id = 'publicIpFollowUpVulnManagementContainer';
        vulnContainer.className = 'vulnerability-management-container';
        dialogContent.appendChild(vulnContainer);
        
        renderPublicIpFollowUpVulnerabilityUI(vulnContainer);
        
        const buttonContainer = document.createElement('div');
        buttonContainer.style.cssText = 'margin-top: 20px; display: flex; gap: 15px; justify-content: flex-end; padding-top: 20px; border-top: 2px solid #eee;';
        
        const cancelBtn = document.createElement('button');
        cancelBtn.type = 'button';
        cancelBtn.className = 'cancel-btn';
        cancelBtn.textContent = 'Cancel';
        cancelBtn.onclick = () => {
            document.body.removeChild(dialogOverlay);
            const submitBtn = form.querySelector('.submit-btn');
            if (submitBtn) {
                submitBtn.disabled = false;
                submitBtn.textContent = 'Submit Report';
            }
        };
        
        const proceedBtn = document.createElement('button');
        proceedBtn.type = 'button';
        proceedBtn.className = 'proceed-btn submit-btn';
        proceedBtn.textContent = 'Proceed to Generate Report';
        proceedBtn.style.cssText = 'background-color: #2c3e50; min-width: 200px;';
        proceedBtn.onclick = () => {
            if (publicIpFollowUpVulnerabilityMergeState.unmatchedVulnerabilities.length > 0) {
                alert('Please handle all unmatched vulnerabilities before proceeding');
                return;
            }
            
            document.body.removeChild(dialogOverlay);
            generatePublicIpFollowUpVaptReport(form);
        };
        
        if (publicIpFollowUpVulnerabilityMergeState.unmatchedVulnerabilities.length > 0) {
            proceedBtn.disabled = true;
            proceedBtn.style.opacity = '0.5';
            proceedBtn.style.cursor = 'not-allowed';
        }
        
        buttonContainer.appendChild(cancelBtn);
        buttonContainer.appendChild(proceedBtn);
        dialogContent.appendChild(buttonContainer);
        
        dialogOverlay.appendChild(dialogContent);
        document.body.appendChild(dialogOverlay);
    }
    
    function renderPublicIpFollowUpVulnerabilityUI(container) {
        container.innerHTML = '';
        
        // Matched Groups Section
        const matchedSection = document.createElement('div');
        matchedSection.innerHTML = `<h3 style="color: #27ae60; margin-bottom: 15px;"><i class="fas fa-check-circle"></i> Matched Vulnerabilities (${publicIpFollowUpVulnerabilityMergeState.matchedGroups.length})</h3>`;
        
        const matchedList = document.createElement('div');
        matchedList.style.cssText = 'margin-bottom: 30px;';
        
        publicIpFollowUpVulnerabilityMergeState.matchedGroups.forEach((group, groupIndex) => {
            const groupDiv = document.createElement('div');
            groupDiv.className = 'matched-group';
            groupDiv.style.cssText = 'margin-bottom: 15px; padding: 15px; background-color: #f8f9fa; border-radius: 8px; border: 1px solid #dee2e6;';
            
            const groupHeader = document.createElement('div');
            groupHeader.style.cssText = 'display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;';
            
            const groupInfo = document.createElement('div');
            groupInfo.style.flex = '1';
            
            const groupName = document.createElement('strong');
            groupName.textContent = group.group_name;
            groupName.style.cssText = 'font-size: 16px; color: #2c3e50;';
            groupInfo.appendChild(groupName);
            
            const riskBadge = document.createElement('span');
            riskBadge.textContent = group.risk_factor || '';
            riskBadge.style.cssText = 'margin-left: 10px; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold;';
            
            const riskLower = (group.risk_factor || '').toLowerCase();
            if (riskLower === 'critical') {
                riskBadge.style.cssText += 'background-color: #8b0000; color: white;';
            } else if (riskLower === 'high') {
                riskBadge.style.cssText += 'background-color: #dc3545; color: white;';
            } else if (riskLower === 'medium') {
                riskBadge.style.cssText += 'background-color: #ffc107; color: black;';
            } else if (riskLower === 'low') {
                riskBadge.style.cssText += 'background-color: #28a745; color: white;';
            }
            groupInfo.appendChild(riskBadge);
            
            if (group.is_manual) {
                const manualBadge = document.createElement('span');
                manualBadge.textContent = 'Manual';
                manualBadge.style.cssText = 'margin-left: 10px; padding: 4px 8px; background: #3498db; color: white; border-radius: 4px; font-size: 12px;';
                groupInfo.appendChild(manualBadge);
            }
            
            const mergeButton = document.createElement('button');
            mergeButton.textContent = ' Merge';
            mergeButton.style.cssText = 'padding: 6px 12px; background-color: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 13px;';
            mergeButton.onclick = function() {
                showPublicIpFollowUpMergeMatchedGroupsDialog(group.catalog_id);
            };
            
            groupHeader.appendChild(groupInfo);
            groupHeader.appendChild(mergeButton);
            groupDiv.appendChild(groupHeader);
            
            const vulnList = document.createElement('ul');
            vulnList.style.cssText = 'margin-top: 10px; margin-left: 20px; font-size: 14px; color: #555;';
            
            group.matched_vulnerabilities.forEach(vuln => {
                const vulnItem = document.createElement('li');
                vulnItem.textContent = vuln;
                vulnItem.style.marginBottom = '5px';
                vulnList.appendChild(vulnItem);
            });
            
            groupDiv.appendChild(vulnList);
            matchedList.appendChild(groupDiv);
        });
        
        matchedSection.appendChild(matchedList);
        container.appendChild(matchedSection);
        
        if (publicIpFollowUpVulnerabilityMergeState.unmatchedVulnerabilities.length > 0) {
            const unmatchedSection = document.createElement('div');
            unmatchedSection.innerHTML = `<h3 style="color: #e74c3c; margin-bottom: 15px;"><i class="fas fa-exclamation-triangle"></i> Unmatched Vulnerabilities (${publicIpFollowUpVulnerabilityMergeState.unmatchedVulnerabilities.length})</h3>`;
            
            const unmatchedList = document.createElement('div');
            
            publicIpFollowUpVulnerabilityMergeState.unmatchedVulnerabilities.forEach(vuln => {
                const vulnDiv = document.createElement('div');
                vulnDiv.style.cssText = 'background: #ffebee; padding: 15px; margin-bottom: 10px; border-radius: 5px; border-left: 4px solid #e74c3c; display: flex; justify-content: space-between; align-items: center;';
                
                const vulnName = document.createElement('span');
                vulnName.textContent = vuln;
                vulnName.style.cssText = 'color: #2c3e50; flex: 1;';
                
                const actionsDiv = document.createElement('div');
                actionsDiv.style.cssText = 'display: flex; gap: 10px;';
                
                const mergeMatchedBtn = document.createElement('button');
                mergeMatchedBtn.type = 'button';
                mergeMatchedBtn.className = 'submit-btn';
                mergeMatchedBtn.textContent = 'Merge with Matched';
                mergeMatchedBtn.style.cssText = 'background-color: #3498db; padding: 5px 10px; font-size: 0.85em;';
                mergeMatchedBtn.onclick = () => showPublicIpFollowUpMergeWithMatchedDialog(vuln);
                
                const mergeUnmatchedBtn = document.createElement('button');
                mergeUnmatchedBtn.type = 'button';
                mergeUnmatchedBtn.className = 'submit-btn';
                mergeUnmatchedBtn.textContent = 'Merge with Unmatched';
                mergeUnmatchedBtn.style.cssText = 'background-color: #9b59b6; padding: 5px 10px; font-size: 0.85em;';
                mergeUnmatchedBtn.onclick = () => showPublicIpFollowUpMergeWithUnmatchedDialog(vuln);
                
                const addDetailsBtn = document.createElement('button');
                addDetailsBtn.type = 'button';
                addDetailsBtn.className = 'submit-btn';
                addDetailsBtn.textContent = 'Add Details';
                addDetailsBtn.style.cssText = 'background-color: #e67e22; padding: 5px 10px; font-size: 0.85em;';
                addDetailsBtn.onclick = () => showPublicIpFollowUpAddDetailsDialog(vuln);
                
                actionsDiv.appendChild(mergeMatchedBtn);
                actionsDiv.appendChild(mergeUnmatchedBtn);
                actionsDiv.appendChild(addDetailsBtn);
                
                vulnDiv.appendChild(vulnName);
                vulnDiv.appendChild(actionsDiv);
                unmatchedList.appendChild(vulnDiv);
            });
            
            unmatchedSection.appendChild(unmatchedList);
            container.appendChild(unmatchedSection);
        } else {
            const allMatchedMsg = document.createElement('div');
            allMatchedMsg.style.cssText = 'background: #d4edda; color: #155724; padding: 20px; border-radius: 5px; text-align: center; font-size: 1.1em;';
            allMatchedMsg.innerHTML = '<i class="fas fa-check-circle"></i> All vulnerabilities are matched! You can proceed to generate the report.';
            container.appendChild(allMatchedMsg);
            
            const proceedBtn = document.querySelector('.proceed-btn');
            if (proceedBtn) {
                proceedBtn.disabled = false;
                proceedBtn.style.opacity = '1';
                proceedBtn.style.cursor = 'pointer';
            }
        }
    }
    
    function showPublicIpFollowUpMergeWithMatchedDialog(unmatchedVuln) {
        // This will open a dialog to select which matched group to merge with
        // For now, implement similar to Website VAPT Follow-up logic
        if (publicIpFollowUpVulnerabilityMergeState.matchedGroups.length === 0) {
            alert('No matched groups available to merge with');
            return;
        }
        
        const dialog = document.createElement('div');
        dialog.className = 'vuln-confirmation-dialog';
        dialog.style.zIndex = '10001';
        dialog.style.position = 'fixed';
        dialog.style.top = '0';
        dialog.style.left = '0';
        dialog.style.width = '100%';
        dialog.style.height = '100%';
        dialog.style.backgroundColor = 'rgba(0,0,0,0.7)';
        dialog.style.display = 'flex';
        dialog.style.justifyContent = 'center';
        dialog.style.alignItems = 'center';
        
        const dialogContent = document.createElement('div');
        dialogContent.style.cssText = 'background: white; padding: 30px; border-radius: 8px; max-width: 600px; width: 90%;';
        
        dialogContent.innerHTML = `
            <h3 style="margin-bottom: 20px;">Merge "${unmatchedVuln}" with Matched Group</h3>
            <p style="margin-bottom: 20px;">Select a matched group to merge this vulnerability with:</p>
            <div id="matchedGroupsList" style="margin-bottom: 20px; max-height: 300px; overflow-y: auto;"></div>
            <div style="display: flex; gap: 10px; justify-content: flex-end;">
                <button type="button" class="cancel-btn" onclick="this.closest('.vuln-confirmation-dialog').remove()">Cancel</button>
            </div>
        `;
        
        const matchedGroupsList = dialogContent.querySelector('#matchedGroupsList');
        publicIpFollowUpVulnerabilityMergeState.matchedGroups.forEach(group => {
            const groupItem = document.createElement('div');
            groupItem.style.cssText = 'padding: 10px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 5px; cursor: pointer;';
            groupItem.style.transition = 'background-color 0.3s';
            groupItem.innerHTML = `
                <strong>${group.group_name}</strong>
                <p style="margin: 5px 0; font-size: 0.9em; color: #666;">${group.matched_vulnerabilities.length} vulnerability(ies)</p>
            `;
            
            groupItem.onclick = () => {
                const payload = {
                    unmatched_vulnerability: unmatchedVuln,
                    target_group_id: group.catalog_id
                };
                
                fetch('/public_ip_vapt_followup_merge_with_matched', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                })
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        alert('Error: ' + data.error);
                    } else {
                        // Update state
                        publicIpFollowUpVulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups || [];
                        publicIpFollowUpVulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities || [];
                        
                        // Refresh UI
                        const container = document.getElementById('publicIpFollowUpVulnManagementContainer');
                        if (container) {
                            renderPublicIpFollowUpVulnerabilityUI(container);
                        }
                        
                        dialog.remove();
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Error merging vulnerability: ' + error.message);
                });
            };
            
            groupItem.onmouseover = () => groupItem.style.backgroundColor = '#f0f0f0';
            groupItem.onmouseout = () => groupItem.style.backgroundColor = '';
            
            matchedGroupsList.appendChild(groupItem);
        });
        
        dialog.appendChild(dialogContent);
        document.body.appendChild(dialog);
    }
    
    function showPublicIpFollowUpMergeWithUnmatchedDialog(unmatchedVuln) {
        // Create dialog to select multiple unmatched vulnerabilities to merge with this one
        const dialog = document.createElement('div');
        dialog.className = 'vuln-confirmation-dialog';
        dialog.style.zIndex = '10001';
        dialog.style.position = 'fixed';
        dialog.style.top = '0';
        dialog.style.left = '0';
        dialog.style.width = '100%';
        dialog.style.height = '100%';
        dialog.style.backgroundColor = 'rgba(0,0,0,0.7)';
        dialog.style.display = 'flex';
        dialog.style.justifyContent = 'center';
        dialog.style.alignItems = 'center';
        
        const dialogContent = document.createElement('div');
        dialogContent.style.cssText = 'background: white; padding: 30px; border-radius: 8px; max-width: 600px; width: 90%;';
        
        dialogContent.innerHTML = `
            <h3 style="margin-bottom: 20px;">Create New Group with "${unmatchedVuln}"</h3>
            <p style="margin-bottom: 20px;">Select other unmatched vulnerabilities to merge with this one:</p>
            <div id="unmatchedVulnsList" style="margin-bottom: 20px; max-height: 300px; overflow-y: auto;"></div>
            <div style="display: flex; gap: 10px; justify-content: flex-end;">
                <button type="button" class="cancel-btn" onclick="this.closest('.vuln-confirmation-dialog').remove()">Cancel</button>
                <button type="button" class="submit-btn" id="confirmMergeUnmatchedBtn">Create Group</button>
            </div>
        `;
        
        const unmatchedVulnsList = dialogContent.querySelector('#unmatchedVulnsList');
        const selectedVulns = new Set([unmatchedVuln]);
        
        let otherVulnsCount = 0;
        publicIpFollowUpVulnerabilityMergeState.unmatchedVulnerabilities.forEach(vuln => {
            if (vuln === unmatchedVuln) return;
            otherVulnsCount++;
            
            const vulnItem = document.createElement('div');
            vulnItem.style.cssText = 'padding: 10px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 5px; cursor: pointer; display: flex; align-items: center;';
            vulnItem.style.transition = 'background-color 0.3s';
            
            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkbox.value = vuln;
            checkbox.style.marginRight = '10px';
            
            const label = document.createElement('label');
            label.textContent = vuln;
            label.style.cursor = 'pointer';
            label.style.flex = '1';
            
            vulnItem.appendChild(checkbox);
            vulnItem.appendChild(label);
            
            checkbox.onchange = (e) => {
                if (e.target.checked) {
                    selectedVulns.add(vuln);
                    vulnItem.style.backgroundColor = '#e8f5e9';
                } else {
                    selectedVulns.delete(vuln);
                    vulnItem.style.backgroundColor = '';
                }
            };
            
            // Make clicking the whole item toggle the checkbox
            vulnItem.onclick = (e) => {
                if (e.target !== checkbox && e.target !== label) {
                    checkbox.click();
                }
            };
            
            unmatchedVulnsList.appendChild(vulnItem);
        });
        
        // If no other vulnerabilities to merge with, show message and allow creating a single-vuln group
        const confirmBtn = dialogContent.querySelector('#confirmMergeUnmatchedBtn');
        
        if (otherVulnsCount === 0) {
            const infoMsg = document.createElement('p');
            infoMsg.style.cssText = 'padding: 15px; background: #e3f2fd; border-radius: 5px; margin-bottom: 15px; color: #1565c0;';
            infoMsg.innerHTML = '<i class="fas fa-info-circle"></i> No other unmatched vulnerabilities to merge with. You can create a group with just this vulnerability.';
            unmatchedVulnsList.parentNode.insertBefore(infoMsg, unmatchedVulnsList);
            
            unmatchedVulnsList.innerHTML = '<p style="padding: 15px; text-align: center; color: #666;">No other unmatched vulnerabilities available.</p>';
            
            // Update button text to be more appropriate
            confirmBtn.textContent = 'Create Group with This Vulnerability';
        }
        confirmBtn.onclick = () => {
            // Allow creating a group if there are no other vulnerabilities OR if at least one other is selected
            if (otherVulnsCount > 0 && selectedVulns.size === 1) {
                alert('Please select at least one more vulnerability to create a group');
                return;
            }
            
            dialog.remove();
            showPublicIpFollowUpVulnerabilityDetailsForm(Array.from(selectedVulns), 'merge_with_unmatched');
        };
        
        dialog.appendChild(dialogContent);
        document.body.appendChild(dialog);
    }
    
    function showPublicIpFollowUpVulnerabilityDetailsForm(vulnerabilities, actionType) {
        const dialog = document.createElement('div');
        dialog.className = 'vuln-confirmation-dialog';
        dialog.style.zIndex = '10002';
        dialog.style.position = 'fixed';
        dialog.style.top = '0';
        dialog.style.left = '0';
        dialog.style.width = '100%';
        dialog.style.height = '100%';
        dialog.style.backgroundColor = 'rgba(0,0,0,0.7)';
        dialog.style.display = 'flex';
        dialog.style.justifyContent = 'center';
        dialog.style.alignItems = 'center';
        
        const dialogContent = document.createElement('div');
        dialogContent.style.cssText = 'background: white; padding: 30px; border-radius: 8px; max-width: 700px; width: 90%; max-height: 90vh; overflow-y: auto;';
        
        const vulnerabilitiesList = vulnerabilities.map(v => `<li>${v}</li>`).join('');
        
        dialogContent.innerHTML = `
            <h3 style="margin-bottom: 20px;">Add Details for New Vulnerability Group</h3>
            <p style="margin-bottom: 15px;"><strong>Selected Vulnerabilities:</strong></p>
            <ul style="margin-bottom: 20px; padding-left: 20px; max-height: 100px; overflow-y: auto;">${vulnerabilitiesList}</ul>
            
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Vulnerability Name*</label>
                <input type="text" id="detailsVulnNameInput" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
            </div>
            
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Risk Factor*</label>
                <select id="detailsRiskFactorInput" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                    <option value="">Select Risk Factor</option>
                    <option value="Critical">Critical</option>
                    <option value="High">High</option>
                    <option value="Medium">Medium</option>
                    <option value="Low">Low</option>
                </select>
            </div>
            
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px; font-weight: bold;">CVE ID</label>
                <input type="text" id="detailsCveIdInput" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
            </div>
            
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px; font-weight: bold;">CVSS Score*</label>
                <input type="text" id="detailsCvssInput" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
            </div>
            
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Audit Observation*</label>
                <textarea id="detailsAuditObservationInput" required rows="4" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;"></textarea>
            </div>
            
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Impact*</label>
                <textarea id="detailsImpactInput" required rows="4" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;"></textarea>
            </div>
            
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Recommendation/Countermeasure*</label>
                <textarea id="detailsRecommendationInput" required rows="4" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;"></textarea>
            </div>
            
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Reference Link</label>
                <textarea id="detailsReferenceLinkInput" rows="3" placeholder="Enter reference links (one per line)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; resize: vertical;"></textarea>
            </div>
            
            <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                <button type="button" class="cancel-btn" onclick="this.closest('.vuln-confirmation-dialog').remove()">Cancel</button>
                <button type="button" class="submit-btn" id="confirmDetailsBtn">Create Group</button>
            </div>
        `;
        
        dialog.appendChild(dialogContent);
        document.body.appendChild(dialog);
        
        const confirmDetailsBtn = dialog.querySelector('#confirmDetailsBtn');
        confirmDetailsBtn.onclick = () => {
            const vulnName = document.getElementById('detailsVulnNameInput').value;
            const riskFactor = document.getElementById('detailsRiskFactorInput').value;
            const cveId = document.getElementById('detailsCveIdInput').value;
            const cvss = document.getElementById('detailsCvssInput').value;
            const auditObservation = document.getElementById('detailsAuditObservationInput').value;
            const impact = document.getElementById('detailsImpactInput').value;
            const recommendation = document.getElementById('detailsRecommendationInput').value;
            const referenceLink = document.getElementById('detailsReferenceLinkInput').value;
            
            if (!vulnName || !riskFactor || !cvss || !auditObservation || !impact || !recommendation) {
                alert('Please fill all required fields');
                return;
            }
            
            const payload = {
                vulnerabilities: vulnerabilities,
                vulnerability_details: {
                    vulnerabilityName: vulnName,
                    riskFactor: riskFactor,
                    cveId: cveId || '',
                    cvssScore: cvss,
                    auditObservation: auditObservation,
                    impact: impact,
                    recommendation: recommendation,
                    referenceLink: referenceLink || ''
                }
            };
            
            fetch('/public_ip_vapt_followup_merge_with_unmatched', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(payload)
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    alert('Error: ' + data.error);
                } else {
                    // Update state
                    publicIpFollowUpVulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups || [];
                    publicIpFollowUpVulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities || [];
                    
                    // Refresh UI
                    const container = document.getElementById('publicIpFollowUpVulnManagementContainer');
                    if (container) {
                        renderPublicIpFollowUpVulnerabilityUI(container);
                    }
                    
                    dialog.remove();
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error creating group: ' + error.message);
            });
        };
    }
    
    function showPublicIpFollowUpAddDetailsDialog(unmatchedVuln) {
        const dialog = document.createElement('div');
        dialog.className = 'vuln-confirmation-dialog';
        dialog.style.zIndex = '10001';
        dialog.style.position = 'fixed';
        dialog.style.top = '0';
        dialog.style.left = '0';
        dialog.style.width = '100%';
        dialog.style.height = '100%';
        dialog.style.backgroundColor = 'rgba(0,0,0,0.7)';
        dialog.style.display = 'flex';
        dialog.style.justifyContent = 'center';
        dialog.style.alignItems = 'center';
        
        const dialogContent = document.createElement('div');
        dialogContent.style.cssText = 'background: white; padding: 30px; border-radius: 8px; max-width: 700px; width: 90%; max-height: 90vh; overflow-y: auto;';
        
        dialogContent.innerHTML = `
            <h3 style="margin-bottom: 20px;">Add Details for "${unmatchedVuln}"</h3>
            <p style="margin-bottom: 20px;">Please provide detailed information for this vulnerability:</p>
            
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Vulnerability Name*</label>
                <input type="text" id="vulnNameInput" value="${unmatchedVuln}" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
            </div>
            
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Risk Factor*</label>
                <select id="riskFactorInput" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                    <option value="">Select Risk Factor</option>
                    <option value="Critical">Critical</option>
                    <option value="High">High</option>
                    <option value="Medium">Medium</option>
                    <option value="Low">Low</option>
                </select>
            </div>
            
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px; font-weight: bold;">CVE ID</label>
                <input type="text" id="cveIdInput" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
            </div>
            
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px; font-weight: bold;">CVSS</label>
                <input type="text" id="cvssInput" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
            </div>
            
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Audit Observation*</label>
                <textarea id="auditObservationInput" required rows="4" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;"></textarea>
            </div>
            
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Impact*</label>
                <textarea id="impactInput" required rows="4" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;"></textarea>
            </div>
            
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Recommendation/Countermeasure*</label>
                <textarea id="recommendationInput" required rows="4" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;"></textarea>
            </div>
            
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Reference Link</label>
                <textarea id="referenceLinkInput" rows="3" placeholder="Enter reference links (one per line)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; resize: vertical;"></textarea>
            </div>
            
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Affected Systems*</label>
                <input type="text" id="affectedSystemsInput" required placeholder="e.g., Host/IP addresses" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
            </div>
            
            <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                <button type="button" class="cancel-btn" onclick="this.closest('.vuln-confirmation-dialog').remove()">Cancel</button>
                <button type="button" class="submit-btn" id="confirmAddDetailsBtn">Add Details</button>
            </div>
        `;
        
        const confirmBtn = dialogContent.querySelector('#confirmAddDetailsBtn');
        confirmBtn.onclick = () => {
            const vulnName = document.getElementById('vulnNameInput').value;
            const riskFactor = document.getElementById('riskFactorInput').value;
            const cveId = document.getElementById('cveIdInput').value;
            const cvss = document.getElementById('cvssInput').value;
            const auditObservation = document.getElementById('auditObservationInput').value;
            const impact = document.getElementById('impactInput').value;
            const recommendation = document.getElementById('recommendationInput').value;
            const referenceLink = document.getElementById('referenceLinkInput').value;
            const affectedSystems = document.getElementById('affectedSystemsInput').value;
            
            if (!vulnName || !riskFactor || !auditObservation || !impact || !recommendation || !affectedSystems) {
                alert('Please fill all required fields');
                return;
            }
            
            const payload = {
                vulnerability_name: unmatchedVuln,
                vulnerability_details: {
                    vulnerabilityName: vulnName,
                    riskFactor: riskFactor,
                    cveId: cveId || '',
                    cvssScore: cvss || '',
                    auditObservation: auditObservation,
                    impact: impact,
                    recommendation: recommendation,
                    referenceLink: referenceLink || '',
                    affectedSystems: affectedSystems
                }
            };
            
            fetch('/public_ip_vapt_followup_add_vulnerability_details', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(payload)
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    alert('Error: ' + data.error);
                } else {
                    // Update state
                    publicIpFollowUpVulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups || [];
                    publicIpFollowUpVulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities || [];
                    
                    // Refresh UI
                    const container = document.getElementById('publicIpFollowUpVulnManagementContainer');
                    if (container) {
                        renderPublicIpFollowUpVulnerabilityUI(container);
                    }
                    
                    dialog.remove();
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error adding vulnerability details: ' + error.message);
            });
        };
        
        dialog.appendChild(dialogContent);
        document.body.appendChild(dialog);
    }
    
    function refreshPublicIpFollowUpVulnerabilityUI() {
        const container = document.getElementById('publicIpFollowUpVulnManagementContainer');
        if (!container) {
            console.error('Container not found for refresh');
            return;
        }
        renderPublicIpFollowUpVulnerabilityUI(container);
        
        // Update count info
        const countInfo = document.getElementById('publicIpFollowUpVulnCountInfo');
        if (countInfo) {
            countInfo.textContent = `Matched: ${publicIpFollowUpVulnerabilityMergeState.matchedGroups.length} | Unmatched: ${publicIpFollowUpVulnerabilityMergeState.unmatchedVulnerabilities.length}`;
        }
        
        // Update proceed button state
        const proceedBtn = document.querySelector('.proceed-btn');
        if (proceedBtn) {
            if (publicIpFollowUpVulnerabilityMergeState.unmatchedVulnerabilities.length > 0) {
                proceedBtn.disabled = true;
                proceedBtn.style.opacity = '0.5';
                proceedBtn.style.cursor = 'not-allowed';
            } else {
                proceedBtn.disabled = false;
                proceedBtn.style.opacity = '1';
                proceedBtn.style.cursor = 'pointer';
            }
        }
    }
    
    function undoPublicIpFollowUpLastMergeOperation() {
        if (!confirm('Are you sure you want to undo the last operation?')) {
            return;
        }
        
        fetch('/public_ip_vapt_followup_undo_last_merge', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'}
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            console.log('Undo response:', data);
            if (data.success && data.updated_state) {
                publicIpFollowUpVulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups || [];
                publicIpFollowUpVulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities || [];
                
                console.log('Updated state - Matched:', publicIpFollowUpVulnerabilityMergeState.matchedGroups.length, 'Unmatched:', publicIpFollowUpVulnerabilityMergeState.unmatchedVulnerabilities.length);
                
                // Refresh the main UI
                refreshPublicIpFollowUpVulnerabilityUI();
                
                alert('Operation undone successfully!');
            } else {
                alert('Error: ' + (data.error || 'No operations to undo'));
            }
        })
        .catch(error => {
            console.error('Error undoing operation:', error);
            alert('Error undoing operation: ' + error.message);
        });
    }
    
    function showPublicIpFollowUpMergeMatchedGroupsDialog(sourceGroupId) {
        const dialog = document.createElement('div');
        dialog.className = 'vuln-confirmation-dialog';
        dialog.style.zIndex = '10001';
        
        const dialogContent = document.createElement('div');
        dialogContent.className = 'dialog-content';
        dialogContent.style.maxWidth = '600px';
        
        const sourceGroup = publicIpFollowUpVulnerabilityMergeState.matchedGroups.find(g => g.catalog_id === sourceGroupId);
        if (!sourceGroup) {
            alert('Source group not found');
            return;
        }
        
        const title = document.createElement('h3');
        title.textContent = 'Merge Matched Groups';
        title.style.marginBottom = '15px';
        dialogContent.appendChild(title);
        
        const instruction = document.createElement('p');
        instruction.innerHTML = `<strong>Merge FROM:</strong> ${sourceGroup.group_name}<br><br>Select target group to merge INTO:`;
        instruction.style.marginBottom = '15px';
        dialogContent.appendChild(instruction);
        
        const select = document.createElement('select');
        select.style.cssText = 'width: 100%; padding: 8px; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 4px;';
        
        const defaultOption = document.createElement('option');
        defaultOption.value = '';
        defaultOption.textContent = '-- Select Target Group --';
        select.appendChild(defaultOption);
        
        publicIpFollowUpVulnerabilityMergeState.matchedGroups.forEach(group => {
            if (group.catalog_id !== sourceGroupId) {
                const option = document.createElement('option');
                option.value = group.catalog_id;
                option.textContent = `${group.group_name} (${group.matched_vulnerabilities.length} vulnerabilities)`;
                select.appendChild(option);
            }
        });
        
        dialogContent.appendChild(select);
        
        const buttonContainer = document.createElement('div');
        buttonContainer.style.cssText = 'display: flex; gap: 10px; justify-content: flex-end;';
        
        const confirmBtn = document.createElement('button');
        confirmBtn.textContent = 'Merge';
        confirmBtn.className = 'submit-btn';
        confirmBtn.onclick = () => {
            const targetGroupId = parseInt(select.value);
            if (!targetGroupId) {
                alert('Please select a target group');
                return;
            }
            
            fetch('/public_ip_vapt_followup_merge_matched_groups', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    source_group_id: sourceGroupId,
                    target_group_id: targetGroupId
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success && data.updated_state) {
                    publicIpFollowUpVulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups || [];
                    publicIpFollowUpVulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities || [];
                    
                    dialog.remove();
                    refreshPublicIpFollowUpVulnerabilityUI();
                    
                    alert('Groups merged successfully!');
                } else {
                    alert('Error: ' + (data.error || 'Unknown error'));
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error merging groups: ' + error.message);
            });
        };
        
        const cancelBtn = document.createElement('button');
        cancelBtn.textContent = 'Cancel';
        cancelBtn.className = 'cancel-btn';
        cancelBtn.onclick = () => dialog.remove();
        
        buttonContainer.appendChild(confirmBtn);
        buttonContainer.appendChild(cancelBtn);
        dialogContent.appendChild(buttonContainer);
        
        dialog.appendChild(dialogContent);
        document.body.appendChild(dialog);
    }
    
    function showPublicIpFollowUpAddManualVulnerabilityDialog() {
        const dialogOverlay = document.createElement('div');
        dialogOverlay.className = 'sub-dialog-overlay';
        dialogOverlay.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: flex; justify-content: center; align-items: center; z-index: 10001;';
        
        const dialogBox = document.createElement('div');
        dialogBox.style.cssText = 'background: white; padding: 30px; border-radius: 8px; max-width: 800px; width: 90%; max-height: 90vh; overflow-y: auto;';
        
        dialogBox.innerHTML = `
            <h3 style="margin-top: 0; color: #27ae60;"><i class="fas fa-plus-circle"></i> Add Vulnerability Manually</h3>
            <p style="color: #666; margin-bottom: 20px;">Enter complete details for the new vulnerability. This will be added to the catalog and appear in the matched vulnerabilities list.</p>
            <form id="publicIpFollowUpManualVulnForm">
                <div class="form-group">
                    <label>Vulnerability Name*</label>
                    <input type="text" id="publicIpFollowUpManualVulnName" class="form-input" required>
                </div>
                <div class="form-group">
                    <label>Risk Factor*</label>
                    <select id="publicIpFollowUpManualRiskFactor" class="form-input" required>
                        <option value="">Select Risk</option>
                        <option value="Critical">Critical</option>
                        <option value="High">High</option>
                        <option value="Medium">Medium</option>
                        <option value="Low">Low</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>CVE/CWE ID*</label>
                    <input type="text" id="publicIpFollowUpManualCveId" class="form-input" required>
                </div>
                <div class="form-group">
                    <label>CVSS Score*</label>
                    <input type="text" id="publicIpFollowUpManualCvssScore" class="form-input" required>
                </div>
                <div class="form-group">
                    <label>Audit Observation*</label>
                    <textarea id="publicIpFollowUpManualObservation" class="form-input" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label>Impact*</label>
                    <textarea id="publicIpFollowUpManualImpact" class="form-input" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label>Recommendation*</label>
                    <textarea id="publicIpFollowUpManualRecommendation" class="form-input" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label>Reference Link*</label>
                    <input type="text" id="publicIpFollowUpManualReferenceLink" class="form-input" required>
                </div>
                <div class="form-group">
                    <label>Affected Systems (Optional - for display in report)</label>
                    <textarea id="publicIpFollowUpManualAffectedSystems" class="form-input" rows="2" placeholder="Enter affected systems (one per line or comma-separated)"></textarea>
                    <small style="color: #666;">This will be added to the Public_IP_VAPT worksheet only, not to the catalog.</small>
                </div>
                <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                    <button type="button" class="cancel-btn" onclick="this.closest('.sub-dialog-overlay').remove()">Cancel</button>
                    <button type="submit" class="submit-btn" style="background-color: #27ae60;">Add Vulnerability</button>
                </div>
            </form>
        `;
        
        // Handle form submission
        dialogBox.querySelector('#publicIpFollowUpManualVulnForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const vulnerabilityDetails = {
                vulnerabilityName: document.getElementById('publicIpFollowUpManualVulnName').value,
                riskFactor: document.getElementById('publicIpFollowUpManualRiskFactor').value,
                cveId: document.getElementById('publicIpFollowUpManualCveId').value,
                cvssScore: document.getElementById('publicIpFollowUpManualCvssScore').value,
                auditObservation: document.getElementById('publicIpFollowUpManualObservation').value,
                impact: document.getElementById('publicIpFollowUpManualImpact').value,
                recommendation: document.getElementById('publicIpFollowUpManualRecommendation').value,
                referenceLink: document.getElementById('publicIpFollowUpManualReferenceLink').value,
                affectedSystems: document.getElementById('publicIpFollowUpManualAffectedSystems').value
            };
            
            // Submit to backend
            fetch('/public_ip_vapt_followup_add_manual_vulnerability', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({vulnerability_details: vulnerabilityDetails})
            })
            .then(response => response.json())
            .then(data => {
                if (data.success && data.updated_state) {
                    // Update global state
                    publicIpFollowUpVulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups;
                    publicIpFollowUpVulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities;
                    
                    // Refresh UI
                    const container = document.getElementById('publicIpFollowUpVulnManagementContainer');
                    renderPublicIpFollowUpVulnerabilityUI(container);
                    
                    // Update count info
                    const countInfo = document.getElementById('publicIpFollowUpVulnCountInfo');
                    if (countInfo) {
                        countInfo.textContent = `Matched: ${publicIpFollowUpVulnerabilityMergeState.matchedGroups.length} | Unmatched: ${publicIpFollowUpVulnerabilityMergeState.unmatchedVulnerabilities.length}`;
                    }
                    
                    // Close dialog
                    document.body.removeChild(dialogOverlay);
                    
                    alert('Vulnerability added successfully!');
                } else {
                    alert('Error: ' + (data.error || 'Unknown error'));
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error adding vulnerability: ' + error.message);
            });
        });
        
        dialogOverlay.appendChild(dialogBox);
        document.body.appendChild(dialogOverlay);
    }
    
    function generatePublicIpFollowUpVaptReport(form) {
        const formData = new FormData(form);
        
        // Handle organization name
        const organizationSelect = document.getElementById('publicIpFollowUpOrganization');
        if (organizationSelect && organizationSelect.value === 'other') {
            const otherOrganizationInput = document.getElementById('publicIpFollowUpOtherOrganization');
            if (otherOrganizationInput && otherOrganizationInput.value && otherOrganizationInput.value.trim() !== '') {
                formData.set('organization', otherOrganizationInput.value);
            }
        }
        
        // Handle city
        const citySelect = document.getElementById('publicIpFollowUpCity');
        if (citySelect && citySelect.value === 'other') {
            const otherCityInput = document.getElementById('publicIpFollowUpOtherCity');
            if (otherCityInput && otherCityInput.value && otherCityInput.value.trim() !== '') {
                formData.set('city', otherCityInput.value);
            }
        }
        
        showVaptLoadingIndicator();
        const submitBtn = form.querySelector('.submit-btn');
        const originalText = submitBtn.textContent;
        submitBtn.disabled = true;
        submitBtn.textContent = 'Generating Report...';
        
        fetch('/process_public_ip_vapt_follow_up_audit_report', {
            method: 'POST',
            body: formData
        })
        .then(response => response.blob())
        .then(blob => {
            const url = window.URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'Public_IP_VAPT_Follow_Up_Audit_Report.xlsx';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            window.URL.revokeObjectURL(url);
            
            hideVaptLoadingIndicator();
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
            
            closeVaptModal('publicIpFollowUpAuditModal');
            location.reload();
        })
        .catch(error => {
            hideVaptLoadingIndicator();
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
            alert('Error generating report: ' + error.message);
        });
    }

    // ==============================================================================
    // VAPT Follow Up MetaData Functions
    // ==============================================================================

    // Sub-sector mappings for VAPT Follow Up MetaData
    const vaptFollowUpSubSectorMappings = {"Agriculture": ["Agriculture"], "Defence": ["Defence"], "Education": ["Education"], "Energy": ["Nuclear Energy", "Oil and Gas", "Power", "Renewable Energy"], "Finance": ["Banking", "Financial Services and Tax", "Insurance", "Market Infrastructure Institutions", "PFRDA", "NHB"], "Healthcare": ["Healthcare services", "Medical devices", "Pharmaceuticals"], "Information_and_Broadcasting": ["Information_and_Broadcasting"], "Information_and_Communication_Technology": ["Information_and_Communication_Technology"], "Law_Enforcement_and_Security": ["Law_Enforcement_and_Security"], "Public_Essential_Services_and_Utilities": ["Building and Construction", "Emergency Services", "Food", "Textiles and Consumer Goods", "Heavy industries", "Postal Services", "Public administration", "Retail services", "Sports, cultural activities, Trade Fairs and Entertainment", "Tourism & Hospitality", "Water and Sewage Utilities"], "Space": ["Space"], "Transportation": ["Air Transportation", "Land Transportation", "Water Transportation"]};

    // Update Follow Up Sub-Sector options for VAPT MetaData
    function updateVaptFollowUpSubSectorOptions() {
        const sectorSelect = document.getElementById('vaptFollowUpMetaSectorOrg');
        const subSectorSelect = document.getElementById('vaptFollowUpMetaSubSector');
        const selectedSector = sectorSelect.value;

        // Clear existing options
        subSectorSelect.innerHTML = '<option value="">Select Sub Sector</option>';

        if (selectedSector && vaptFollowUpSubSectorMappings[selectedSector]) {
            const subSectors = vaptFollowUpSubSectorMappings[selectedSector];
            subSectors.forEach(subSector => {
                const option = document.createElement('option');
                option.value = subSector;
                option.textContent = subSector;
                subSectorSelect.appendChild(option);
            });
        }
    }

    // Update Follow Up Sub-Sector options for Android Mobile Application VAPT MetaData
    function updateAndroidVaptFollowUpSubSectorOptions() {
        const sectorSelect = document.getElementById('androidVaptFollowUpMetaSectorOrg');
        const subSectorSelect = document.getElementById('androidVaptFollowUpMetaSubSector');
        
        if (!sectorSelect || !subSectorSelect) {
            return;
        }

        const selectedSector = sectorSelect.value;

        // Clear existing options
        subSectorSelect.innerHTML = '<option value="">Select Sub Sector</option>';

        if (selectedSector && vaptFollowUpSubSectorMappings[selectedSector]) {
            const subSectors = vaptFollowUpSubSectorMappings[selectedSector];
            subSectors.forEach(subSector => {
                const option = document.createElement('option');
                option.value = subSector;
                option.textContent = subSector;
                subSectorSelect.appendChild(option);
            });
        }
    }

    // Add Vulnerability Entry for VAPT Follow Up MetaData
    let vaptFollowUpVulnEntryCount = 1;
    // Toggle Vulnerability Section for VAPT Follow Up Audit MetaData
    function toggleVaptFollowUpVulnerabilitySection() {
        const vulnerabilitySection = document.getElementById('vaptFollowUpVulnerabilitySection');
        const form = document.getElementById('vaptFollowUpAuditMetaDataForm');
        const vulnerabilityStatus = form ? form.querySelector('input[name="vulnerabilityStatus"]:checked') : null;
        
        if (vulnerabilityStatus && vulnerabilityStatus.value === 'has') {
            // Show the vulnerability section
            vulnerabilitySection.style.display = 'block';
            
            // Make all vulnerability fields required
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = true;
            });
        } else {
            // Hide the vulnerability section
            vulnerabilitySection.style.display = 'none';
            
            // Remove required attribute from all vulnerability fields
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = false;
                // Clear the values
                if (input.type === 'text' || input.type === 'number' || input.type === 'email') {
                    input.value = '';
                } else if (input.tagName === 'SELECT') {
                    input.selectedIndex = 0;
                }
            });
        }
    }

    function addVaptFollowUpVulnerabilityEntry() {
        const container = document.getElementById('vaptFollowUpVulnerabilityContainer');
        const entryDiv = document.createElement('div');
        entryDiv.className = 'vulnerability-entry';
        entryDiv.style.border = '1px solid #ddd';
        entryDiv.style.padding = '15px';
        entryDiv.style.marginBottom = '15px';
        entryDiv.style.borderRadius = '5px';
        entryDiv.style.position = 'relative';

        entryDiv.innerHTML = `
            <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
            <div class="form-group">
                <label class="form-label">Audited infrastructure details*</label>
                <input type="text" name="vuln_${vaptFollowUpVulnEntryCount}_infrastructure" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                <input type="text" name="vuln_${vaptFollowUpVulnEntryCount}_name" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">CVE/CWE Reference Number*</label>
                <input type="text" name="vuln_${vaptFollowUpVulnEntryCount}_cve" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Severity of Issue*</label>
                <select name="vuln_${vaptFollowUpVulnEntryCount}_severity" class="form-input" required>
                    <option value="">Select Severity</option>
                    <option value="Critical">Critical</option>
                    <option value="High">High</option>
                    <option value="Medium">Medium</option>
                    <option value="Low">Low</option>
                    <option value="Informational">Informational</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                <input type="number" name="vuln_${vaptFollowUpVulnEntryCount}_count" class="form-input" min="0" required>
            </div>
            <div class="form-group">
                <label class="form-label">Attributing Factor*</label>
                <select name="vuln_${vaptFollowUpVulnEntryCount}_factor" class="form-input" required>
                    <option value="">Select Factor</option>
                    <option value="Coding Error">Coding Error</option>
                    <option value="Configuration Error">Configuration Error</option>
                    <option value="Deployment Error">Deployment Error</option>
                    <option value="Design Error">Design Error</option>
                    <option value="Operation Error">Operation Error</option>
                    <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                </select>
            </div>
        `;

        container.appendChild(entryDiv);
        vaptFollowUpVulnEntryCount++;
    }

    // Add Employee Entry for VAPT Follow Up MetaData
    let vaptFollowUpEmpEntryCount = 1;
    function addVaptFollowUpEmployeeEntry() {
        const container = document.getElementById('vaptFollowUpEmployeeContainer');
        const entryDiv = document.createElement('div');
        entryDiv.className = 'employee-entry';
        entryDiv.style.border = '1px solid #ddd';
        entryDiv.style.padding = '15px';
        entryDiv.style.marginBottom = '15px';
        entryDiv.style.borderRadius = '5px';
        entryDiv.style.position = 'relative';

        entryDiv.innerHTML = `
            <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
            <div class="form-group">
                <label class="form-label">Name of employee*</label>
                <input type="text" name="emp_${vaptFollowUpEmpEntryCount}_name" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">E-mail ID*</label>
                <input type="email" name="emp_${vaptFollowUpEmpEntryCount}_email" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">CISSP*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${vaptFollowUpEmpEntryCount}_cissp" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${vaptFollowUpEmpEntryCount}_cissp" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CISA*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${vaptFollowUpEmpEntryCount}_cisa" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${vaptFollowUpEmpEntryCount}_cisa" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CISM*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${vaptFollowUpEmpEntryCount}_cism" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${vaptFollowUpEmpEntryCount}_cism" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">ISO*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${vaptFollowUpEmpEntryCount}_iso" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${vaptFollowUpEmpEntryCount}_iso" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">DISA*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${vaptFollowUpEmpEntryCount}_disa" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${vaptFollowUpEmpEntryCount}_disa" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">OSCP*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${vaptFollowUpEmpEntryCount}_oscp" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${vaptFollowUpEmpEntryCount}_oscp" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CEH*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${vaptFollowUpEmpEntryCount}_ceh" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${vaptFollowUpEmpEntryCount}_ceh" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">Others</label>
                <input type="text" name="emp_${vaptFollowUpEmpEntryCount}_others" class="form-input" placeholder="Specify other certifications">
            </div>
            <div class="form-group">
                <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                <input type="number" name="emp_${vaptFollowUpEmpEntryCount}_experience" class="form-input" min="0" step="0.5" required>
            </div>
        `;

        container.appendChild(entryDiv);
        vaptFollowUpEmpEntryCount++;
    }

    // Web Application Follow Up Audit MetaData Functions
    // ==============================================================================

    function toggleWebAppVaptFollowUpOtherField(selectId, otherInputId) {
        const selectElement = document.getElementById(selectId);
        const otherInput = document.getElementById(otherInputId);

        if (!selectElement || !otherInput) {
            return;
        }

        if (selectElement.value === 'Other') {
            otherInput.style.display = 'block';
            otherInput.required = true;
        } else {
            otherInput.style.display = 'none';
            otherInput.required = false;
            otherInput.value = '';
        }
    }

    function updateWebAppVaptFollowUpSubSectorOptions() {
        const sectorSelect = document.getElementById('webAppVaptFollowUpMetaSectorOrg');
        const subSectorSelect = document.getElementById('webAppVaptFollowUpMetaSubSector');

        if (!sectorSelect || !subSectorSelect) {
            return;
        }

        const selectedSector = sectorSelect.value;
        subSectorSelect.innerHTML = '<option value="">Select Sub Sector</option>';

        if (selectedSector && vaptFollowUpSubSectorMappings[selectedSector]) {
            const subSectors = vaptFollowUpSubSectorMappings[selectedSector];
            subSectors.forEach(subSector => {
                const option = document.createElement('option');
                option.value = subSector;
                option.textContent = subSector;
                subSectorSelect.appendChild(option);
            });
        }
    }

    let webAppVaptFollowUpVulnEntryCount = 1;
    // Toggle Vulnerability Section for Web Application Follow Up Audit MetaData
    function toggleWebAppVaptFollowUpVulnerabilitySection() {
        const vulnerabilitySection = document.getElementById('webAppVaptFollowUpVulnerabilitySection');
        const form = document.getElementById('webAppVaptFollowUpAuditMetaDataForm');
        const vulnerabilityStatus = form ? form.querySelector('input[name="vulnerabilityStatus"]:checked') : null;
        
        if (vulnerabilityStatus && vulnerabilityStatus.value === 'has') {
            // Show the vulnerability section
            vulnerabilitySection.style.display = 'block';
            
            // Make all vulnerability fields required
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = true;
            });
        } else {
            // Hide the vulnerability section
            vulnerabilitySection.style.display = 'none';
            
            // Remove required attribute from all vulnerability fields
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = false;
                // Clear the values
                if (input.type === 'text' || input.type === 'number' || input.type === 'email') {
                    input.value = '';
                } else if (input.tagName === 'SELECT') {
                    input.selectedIndex = 0;
                }
            });
        }
    }

    // Toggle Vulnerability Section for Android Follow Up Audit MetaData
    function toggleAndroidVaptFollowUpVulnerabilitySection() {
        const vulnerabilitySection = document.getElementById('androidVaptFollowUpVulnerabilitySection');
        const form = document.getElementById('androidVaptFollowUpAuditMetaDataForm');
        const vulnerabilityStatus = form ? form.querySelector('input[name="vulnerabilityStatus"]:checked') : null;
        
        if (vulnerabilityStatus && vulnerabilityStatus.value === 'has') {
            // Show the vulnerability section
            vulnerabilitySection.style.display = 'block';
            
            // Make all vulnerability fields required
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = true;
            });
        } else {
            // Hide the vulnerability section
            vulnerabilitySection.style.display = 'none';
            
            // Remove required attribute from all vulnerability fields
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = false;
                // Clear the values
                if (input.type === 'text' || input.type === 'number' || input.type === 'email') {
                    input.value = '';
                } else if (input.tagName === 'SELECT') {
                    input.selectedIndex = 0;
                }
            });
        }
    }

    function addWebAppVaptFollowUpVulnerabilityEntry() {
        const container = document.getElementById('webAppVaptFollowUpVulnerabilityContainer');
        if (!container) {
            return;
        }

        const entryDiv = document.createElement('div');
        entryDiv.className = 'vulnerability-entry';
        entryDiv.style.border = '1px solid #ddd';
        entryDiv.style.padding = '15px';
        entryDiv.style.marginBottom = '15px';
        entryDiv.style.borderRadius = '5px';
        entryDiv.style.position = 'relative';

        entryDiv.innerHTML = `
            <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
            <div class="form-group">
                <label class="form-label">Audited infrastructure details*</label>
                <input type="text" name="vuln_${webAppVaptFollowUpVulnEntryCount}_infrastructure" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                <input type="text" name="vuln_${webAppVaptFollowUpVulnEntryCount}_name" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">CVE/CWE Reference Number*</label>
                <input type="text" name="vuln_${webAppVaptFollowUpVulnEntryCount}_cve" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Severity of Issue*</label>
                <select name="vuln_${webAppVaptFollowUpVulnEntryCount}_severity" class="form-input" required>
                    <option value="">Select Severity</option>
                    <option value="Critical">Critical</option>
                    <option value="High">High</option>
                    <option value="Medium">Medium</option>
                    <option value="Low">Low</option>
                    <option value="Informational">Informational</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                <input type="number" name="vuln_${webAppVaptFollowUpVulnEntryCount}_count" class="form-input" min="0" required>
            </div>
            <div class="form-group">
                <label class="form-label">Attributing Factor*</label>
                <select name="vuln_${webAppVaptFollowUpVulnEntryCount}_factor" class="form-input" required>
                    <option value="">Select Factor</option>
                    <option value="Coding Error">Coding Error</option>
                    <option value="Configuration Error">Configuration Error</option>
                    <option value="Deployment Error">Deployment Error</option>
                    <option value="Design Error">Design Error</option>
                    <option value="Operation Error">Operation Error</option>
                    <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                </select>
            </div>
        `;

        container.appendChild(entryDiv);
        webAppVaptFollowUpVulnEntryCount++;
    }

    let webAppVaptFollowUpEmpEntryCount = 1;
    function addWebAppVaptFollowUpEmployeeEntry() {
        const container = document.getElementById('webAppVaptFollowUpEmployeeContainer');
        if (!container) {
            return;
        }

        const entryDiv = document.createElement('div');
        entryDiv.className = 'employee-entry';
        entryDiv.style.border = '1px solid #ddd';
        entryDiv.style.padding = '15px';
        entryDiv.style.marginBottom = '15px';
        entryDiv.style.borderRadius = '5px';
        entryDiv.style.position = 'relative';

        entryDiv.innerHTML = `
            <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
            <div class="form-group">
                <label class="form-label">Name of employee*</label>
                <input type="text" name="emp_${webAppVaptFollowUpEmpEntryCount}_name" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">E-mail ID*</label>
                <input type="email" name="emp_${webAppVaptFollowUpEmpEntryCount}_email" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">CISSP*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${webAppVaptFollowUpEmpEntryCount}_cissp" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${webAppVaptFollowUpEmpEntryCount}_cissp" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CISA*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${webAppVaptFollowUpEmpEntryCount}_cisa" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${webAppVaptFollowUpEmpEntryCount}_cisa" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CISM*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${webAppVaptFollowUpEmpEntryCount}_cism" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${webAppVaptFollowUpEmpEntryCount}_cism" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">ISO*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${webAppVaptFollowUpEmpEntryCount}_iso" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${webAppVaptFollowUpEmpEntryCount}_iso" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">DISA*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${webAppVaptFollowUpEmpEntryCount}_disa" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${webAppVaptFollowUpEmpEntryCount}_disa" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">OSCP*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${webAppVaptFollowUpEmpEntryCount}_oscp" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${webAppVaptFollowUpEmpEntryCount}_oscp" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CEH*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${webAppVaptFollowUpEmpEntryCount}_ceh" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${webAppVaptFollowUpEmpEntryCount}_ceh" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">Others</label>
                <input type="text" name="emp_${webAppVaptFollowUpEmpEntryCount}_others" class="form-input" placeholder="Specify other certifications">
            </div>
            <div class="form-group">
                <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                <input type="number" name="emp_${webAppVaptFollowUpEmpEntryCount}_experience" class="form-input" min="0" step="0.5" required>
            </div>
        `;

        container.appendChild(entryDiv);
        webAppVaptFollowUpEmpEntryCount++;
    }

    function handleWebAppVaptFollowUpAuditMetaDataSubmit(event) {
        event.preventDefault();

        const submitBtn = document.getElementById('webAppVaptFollowUpAuditMetaDataSubmitBtn');
        const originalText = submitBtn ? submitBtn.innerHTML : '';

        if (submitBtn) {
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
        }

        const form = document.getElementById('webAppVaptFollowUpAuditMetaDataForm');
        const formData = new FormData(form);

        fetch('/process_web_application_follow_up_audit_metadata', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const link = document.createElement('a');
                link.href = data.download_url;
                link.download = data.filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                closeVaptModal('webAppVaptFollowUpAuditMetaDataModal');

                setTimeout(() => {
                    fetch('/cleanup_web_application_follow_up_audit_metadata', {
                        method: 'POST'
                    }).then(() => {
                        location.reload();
                    });
                }, 2000);
            } else {
                alert('Error: ' + (data.error || 'Unknown error'));
                if (submitBtn) {
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                }
            }
        })
        .catch(error => {
            console.error('Web Application Follow Up Audit MetaData Error:', error);
            alert('An error occurred: ' + error.message);
            if (submitBtn) {
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        });
    }

    // IOS Mobile Application Follow Up Audit MetaData Functions
    // ==============================================================================

    function toggleIosVaptFollowUpOtherField(selectId, otherInputId) {
        const selectElement = document.getElementById(selectId);
        const otherInput = document.getElementById(otherInputId);

        if (!selectElement || !otherInput) {
            return;
        }

        if (selectElement.value === 'Other') {
            otherInput.style.display = 'block';
            otherInput.required = true;
        } else {
            otherInput.style.display = 'none';
            otherInput.required = false;
            otherInput.value = '';
        }
    }

    function updateIosVaptFollowUpSubSectorOptions() {
        const sectorSelect = document.getElementById('iosVaptFollowUpMetaSectorOrg');
        const subSectorSelect = document.getElementById('iosVaptFollowUpMetaSubSector');

        if (!sectorSelect || !subSectorSelect) {
            return;
        }

        const selectedSector = sectorSelect.value;
        subSectorSelect.innerHTML = '<option value="">Select Sub Sector</option>';

        if (selectedSector && vaptFollowUpSubSectorMappings[selectedSector]) {
            const subSectors = vaptFollowUpSubSectorMappings[selectedSector];
            subSectors.forEach(subSector => {
                const option = document.createElement('option');
                option.value = subSector;
                option.textContent = subSector;
                subSectorSelect.appendChild(option);
            });
        }
    }

    let iosVaptFollowUpVulnEntryCount = 1;
    // Toggle Vulnerability Section for iOS Follow Up Audit MetaData
    function toggleIosVaptFollowUpVulnerabilitySection() {
        const vulnerabilitySection = document.getElementById('iosVaptFollowUpVulnerabilitySection');
        const form = document.getElementById('iosVaptFollowUpAuditMetaDataForm');
        const vulnerabilityStatus = form ? form.querySelector('input[name="vulnerabilityStatus"]:checked') : null;
        
        if (vulnerabilityStatus && vulnerabilityStatus.value === 'has') {
            // Show the vulnerability section
            vulnerabilitySection.style.display = 'block';
            
            // Make all vulnerability fields required
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = true;
            });
        } else {
            // Hide the vulnerability section
            vulnerabilitySection.style.display = 'none';
            
            // Remove required attribute from all vulnerability fields
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = false;
                // Clear the values
                if (input.type === 'text' || input.type === 'number' || input.type === 'email') {
                    input.value = '';
                } else if (input.tagName === 'SELECT') {
                    input.selectedIndex = 0;
                }
            });
        }
    }

    function addIosVaptFollowUpVulnerabilityEntry() {
        const container = document.getElementById('iosVaptFollowUpVulnerabilityContainer');
        if (!container) {
            return;
        }

        const entryDiv = document.createElement('div');
        entryDiv.className = 'vulnerability-entry';
        entryDiv.style.border = '1px solid #ddd';
        entryDiv.style.padding = '15px';
        entryDiv.style.marginBottom = '15px';
        entryDiv.style.borderRadius = '5px';
        entryDiv.style.position = 'relative';

        entryDiv.innerHTML = `
            <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
            <div class="form-group">
                <label class="form-label">Audited infrastructure details*</label>
                <input type="text" name="vuln_${iosVaptFollowUpVulnEntryCount}_infrastructure" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                <input type="text" name="vuln_${iosVaptFollowUpVulnEntryCount}_name" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">CVE/CWE Reference Number*</label>
                <input type="text" name="vuln_${iosVaptFollowUpVulnEntryCount}_cve" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Severity of Issue*</label>
                <select name="vuln_${iosVaptFollowUpVulnEntryCount}_severity" class="form-input" required>
                    <option value="">Select Severity</option>
                    <option value="Critical">Critical</option>
                    <option value="High">High</option>
                    <option value="Medium">Medium</option>
                    <option value="Low">Low</option>
                    <option value="Informational">Informational</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                <input type="number" name="vuln_${iosVaptFollowUpVulnEntryCount}_count" class="form-input" min="0" required>
            </div>
            <div class="form-group">
                <label class="form-label">Attributing Factor*</label>
                <select name="vuln_${iosVaptFollowUpVulnEntryCount}_factor" class="form-input" required>
                    <option value="">Select Factor</option>
                    <option value="Coding Error">Coding Error</option>
                    <option value="Configuration Error">Configuration Error</option>
                    <option value="Deployment Error">Deployment Error</option>
                    <option value="Design Error">Design Error</option>
                    <option value="Operation Error">Operation Error</option>
                    <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                </select>
            </div>
        `;

        container.appendChild(entryDiv);
        iosVaptFollowUpVulnEntryCount++;
    }

    let iosVaptFollowUpEmpEntryCount = 1;
    function addIosVaptFollowUpEmployeeEntry() {
        const container = document.getElementById('iosVaptFollowUpEmployeeContainer');
        if (!container) {
            return;
        }

        const entryDiv = document.createElement('div');
        entryDiv.className = 'employee-entry';
        entryDiv.style.border = '1px solid #ddd';
        entryDiv.style.padding = '15px';
        entryDiv.style.marginBottom = '15px';
        entryDiv.style.borderRadius = '5px';
        entryDiv.style.position = 'relative';

        entryDiv.innerHTML = `
            <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
            <div class="form-group">
                <label class="form-label">Name of employee*</label>
                <input type="text" name="emp_${iosVaptFollowUpEmpEntryCount}_name" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">E-mail ID*</label>
                <input type="email" name="emp_${iosVaptFollowUpEmpEntryCount}_email" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">CISSP*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${iosVaptFollowUpEmpEntryCount}_cissp" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${iosVaptFollowUpEmpEntryCount}_cissp" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CISA*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${iosVaptFollowUpEmpEntryCount}_cisa" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${iosVaptFollowUpEmpEntryCount}_cisa" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CISM*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${iosVaptFollowUpEmpEntryCount}_cism" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${iosVaptFollowUpEmpEntryCount}_cism" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">ISO*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${iosVaptFollowUpEmpEntryCount}_iso" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${iosVaptFollowUpEmpEntryCount}_iso" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">DISA*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${iosVaptFollowUpEmpEntryCount}_disa" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${iosVaptFollowUpEmpEntryCount}_disa" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">OSCP*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${iosVaptFollowUpEmpEntryCount}_oscp" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${iosVaptFollowUpEmpEntryCount}_oscp" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CEH*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${iosVaptFollowUpEmpEntryCount}_ceh" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${iosVaptFollowUpEmpEntryCount}_ceh" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">Others</label>
                <input type="text" name="emp_${iosVaptFollowUpEmpEntryCount}_others" class="form-input" placeholder="Specify other certifications">
            </div>
            <div class="form-group">
                <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                <input type="number" name="emp_${iosVaptFollowUpEmpEntryCount}_experience" class="form-input" min="0" step="0.5" required>
            </div>
        `;

        container.appendChild(entryDiv);
        iosVaptFollowUpEmpEntryCount++;
    }

    function handleIosVaptFollowUpAuditMetaDataSubmit(event) {
        event.preventDefault();

        const submitBtn = document.getElementById('iosVaptFollowUpAuditMetaDataSubmitBtn');
        const originalText = submitBtn ? submitBtn.innerHTML : '';

        if (submitBtn) {
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
        }

        const form = document.getElementById('iosVaptFollowUpAuditMetaDataForm');
        const formData = new FormData(form);

        fetch('/process_ios_application_follow_up_audit_metadata', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const link = document.createElement('a');
                link.href = data.download_url;
                link.download = data.filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                closeVaptModal('iosVaptFollowUpAuditMetaDataModal');

                setTimeout(() => {
                    fetch('/cleanup_ios_application_follow_up_audit_metadata', {
                        method: 'POST'
                    }).then(() => {
                        location.reload();
                    });
                }, 2000);
            } else {
                alert('Error: ' + (data.error || 'Unknown error'));
                if (submitBtn) {
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                }
            }
        })
        .catch(error => {
            console.error('IOS Mobile Application Follow Up Audit MetaData Error:', error);
            alert('An error occurred: ' + error.message);
            if (submitBtn) {
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        });
    }


    function updateApiFollowUpSubSectorOptions() {
        const sectorSelect = document.getElementById('apiFollowUpMetaSectorOrg');
        const subSectorSelect = document.getElementById('apiFollowUpMetaSubSector');

        if (!sectorSelect || !subSectorSelect) {
            return;
        }

        const selectedSector = sectorSelect.value;

        subSectorSelect.innerHTML = '<option value="">Select Sub Sector</option>';

        if (selectedSector && vaptFollowUpSubSectorMappings[selectedSector]) {
            const subSectors = vaptFollowUpSubSectorMappings[selectedSector];
            subSectors.forEach(subSector => {
                const option = document.createElement('option');
                option.value = subSector;
                option.textContent = subSector;
                subSectorSelect.appendChild(option);
            });
        }
    }

    // Toggle Vulnerability Section for API Follow Up Audit MetaData
    function toggleApiFollowUpVulnerabilitySection() {
        const vulnerabilitySection = document.getElementById('apiFollowUpVulnerabilitySection');
        const form = document.getElementById('apiFollowUpAuditMetaDataForm');
        const vulnerabilityStatus = form ? form.querySelector('input[name="vulnerabilityStatus"]:checked') : null;
        
        if (vulnerabilityStatus && vulnerabilityStatus.value === 'has') {
            // Show the vulnerability section
            vulnerabilitySection.style.display = 'block';
            
            // Make all vulnerability fields required
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = true;
            });
        } else {
            // Hide the vulnerability section
            vulnerabilitySection.style.display = 'none';
            
            // Remove required attribute from all vulnerability fields
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = false;
                // Clear the values
                if (input.type === 'text' || input.type === 'number' || input.type === 'email') {
                    input.value = '';
                } else if (input.tagName === 'SELECT') {
                    input.selectedIndex = 0;
                }
            });
        }
    }

    let apiFollowUpVulnEntryCount = 1;
    function addApiFollowUpVulnerabilityEntry() {
        const container = document.getElementById('apiFollowUpVulnerabilityContainer');
        if (!container) {
            return;
        }

        const entryDiv = document.createElement('div');
        entryDiv.className = 'vulnerability-entry';
        entryDiv.style.border = '1px solid #ddd';
        entryDiv.style.padding = '15px';
        entryDiv.style.marginBottom = '15px';
        entryDiv.style.borderRadius = '5px';
        entryDiv.style.position = 'relative';

        entryDiv.innerHTML = `
            <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
            <div class="form-group">
                <label class="form-label">Audited infrastructure details*</label>
                <input type="text" name="vuln_${apiFollowUpVulnEntryCount}_infrastructure" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                <input type="text" name="vuln_${apiFollowUpVulnEntryCount}_name" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">CVE/CWE Reference Number*</label>
                <input type="text" name="vuln_${apiFollowUpVulnEntryCount}_cve" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Severity of Issue*</label>
                <select name="vuln_${apiFollowUpVulnEntryCount}_severity" class="form-input" required>
                    <option value="">Select Severity</option>
                    <option value="Critical">Critical</option>
                    <option value="High">High</option>
                    <option value="Medium">Medium</option>
                    <option value="Low">Low</option>
                    <option value="Informational">Informational</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                <input type="number" name="vuln_${apiFollowUpVulnEntryCount}_count" class="form-input" min="0" required>
            </div>
            <div class="form-group">
                <label class="form-label">Attributing Factor*</label>
                <select name="vuln_${apiFollowUpVulnEntryCount}_factor" class="form-input" required>
                    <option value="">Select Factor</option>
                    <option value="Coding Error">Coding Error</option>
                    <option value="Configuration Error">Configuration Error</option>
                    <option value="Deployment Error">Deployment Error</option>
                    <option value="Design Error">Design Error</option>
                    <option value="Operation Error">Operation Error</option>
                    <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                </select>
            </div>
        `;

        container.appendChild(entryDiv);
        apiFollowUpVulnEntryCount++;
    }

    let apiFollowUpEmpEntryCount = 1;
    function addApiFollowUpEmployeeEntry() {
        const container = document.getElementById('apiFollowUpEmployeeContainer');
        if (!container) {
            return;
        }

        const entryDiv = document.createElement('div');
        entryDiv.className = 'employee-entry';
        entryDiv.style.border = '1px solid #ddd';
        entryDiv.style.padding = '15px';
        entryDiv.style.marginBottom = '15px';
        entryDiv.style.borderRadius = '5px';
        entryDiv.style.position = 'relative';

        entryDiv.innerHTML = `
            <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
            <div class="form-group">
                <label class="form-label">Name of employee*</label>
                <input type="text" name="emp_${apiFollowUpEmpEntryCount}_name" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">E-mail ID*</label>
                <input type="email" name="emp_${apiFollowUpEmpEntryCount}_email" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">CISSP*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${apiFollowUpEmpEntryCount}_cissp" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${apiFollowUpEmpEntryCount}_cissp" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CISA*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${apiFollowUpEmpEntryCount}_cisa" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${apiFollowUpEmpEntryCount}_cisa" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CISM*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${apiFollowUpEmpEntryCount}_cism" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${apiFollowUpEmpEntryCount}_cism" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">ISO*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${apiFollowUpEmpEntryCount}_iso" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${apiFollowUpEmpEntryCount}_iso" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">DISA*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${apiFollowUpEmpEntryCount}_disa" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${apiFollowUpEmpEntryCount}_disa" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">OSCP*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${apiFollowUpEmpEntryCount}_oscp" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${apiFollowUpEmpEntryCount}_oscp" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CEH*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${apiFollowUpEmpEntryCount}_ceh" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${apiFollowUpEmpEntryCount}_ceh" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">Others</label>
                <input type="text" name="emp_${apiFollowUpEmpEntryCount}_others" class="form-input" placeholder="Specify other certifications">
            </div>
            <div class="form-group">
                <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                <input type="number" name="emp_${apiFollowUpEmpEntryCount}_experience" class="form-input" min="0" step="0.5" required>
            </div>
        `;

        container.appendChild(entryDiv);
        apiFollowUpEmpEntryCount++;
    }


    function handleApiFollowUpAuditMetaDataSubmit(event) {
        event.preventDefault();

        const submitBtn = document.getElementById('apiFollowUpAuditMetaDataSubmitBtn');
        if (!submitBtn) {
            return;
        }

        const originalText = submitBtn.innerHTML;

        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
        submitBtn.disabled = true;

        const formElement = document.getElementById('apiFollowUpAuditMetaDataForm');
        if (!formElement) {
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            return;
        }

        const formData = new FormData(formElement);

        fetch('/process_api_follow_up_audit_metadata', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const link = document.createElement('a');
                link.href = data.download_url;
                link.download = data.filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                closeVaptModal('apiFollowUpAuditMetaDataModal');

                setTimeout(() => {
                    fetch('/cleanup_api_follow_up_audit_metadata', {
                        method: 'POST'
                    }).then(() => {
                        location.reload();
                    });
                }, 2000);
            } else {
                alert('Error: ' + (data.error || 'Unknown error'));
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        })
        .catch(error => {
            console.error('API Follow Up Audit MetaData Error:', error);
            alert('An error occurred: ' + error.message);
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
        });
    }

    function updatePublicIpFollowUpSubSectorOptions() {
        const sectorSelect = document.getElementById('publicIpFollowUpMetaSectorOrg');
        const subSectorSelect = document.getElementById('publicIpFollowUpMetaSubSector');

        if (!sectorSelect || !subSectorSelect) {
            return;
        }

        const selectedSector = sectorSelect.value;

        subSectorSelect.innerHTML = '<option value="">Select Sub Sector</option>';

        if (selectedSector && vaptFollowUpSubSectorMappings[selectedSector]) {
            const subSectors = vaptFollowUpSubSectorMappings[selectedSector];
            subSectors.forEach(subSector => {
                const option = document.createElement('option');
                option.value = subSector;
                option.textContent = subSector;
                subSectorSelect.appendChild(option);
            });
        }
    }

    let publicIpFollowUpVulnEntryCount = 1;
    // Toggle Vulnerability Section for Public IP Follow Up Audit MetaData
    function togglePublicIpFollowUpVulnerabilitySection() {
        const vulnerabilitySection = document.getElementById('publicIpFollowUpVulnerabilitySection');
        const form = document.getElementById('publicIpFollowUpAuditMetaDataForm');
        const vulnerabilityStatus = form ? form.querySelector('input[name="vulnerabilityStatus"]:checked') : null;
        
        if (vulnerabilityStatus && vulnerabilityStatus.value === 'has') {
            // Show the vulnerability section
            vulnerabilitySection.style.display = 'block';
            
            // Make all vulnerability fields required
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = true;
            });
        } else {
            // Hide the vulnerability section
            vulnerabilitySection.style.display = 'none';
            
            // Remove required attribute from all vulnerability fields
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            vulnerabilityInputs.forEach(input => {
                input.required = false;
                // Clear the values
                if (input.type === 'text' || input.type === 'number' || input.type === 'email') {
                    input.value = '';
                } else if (input.tagName === 'SELECT') {
                    input.selectedIndex = 0;
                }
            });
        }
    }

    function addPublicIpFollowUpVulnerabilityEntry() {
        const container = document.getElementById('publicIpFollowUpVulnerabilityContainer');
        if (!container) {
            return;
        }

        const entryDiv = document.createElement('div');
        entryDiv.className = 'vulnerability-entry';
        entryDiv.style.border = '1px solid #ddd';
        entryDiv.style.padding = '15px';
        entryDiv.style.marginBottom = '15px';
        entryDiv.style.borderRadius = '5px';
        entryDiv.style.position = 'relative';

        entryDiv.innerHTML = `
            <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
            <div class="form-group">
                <label class="form-label">Audited infrastructure details*</label>
                <input type="text" name="vuln_${publicIpFollowUpVulnEntryCount}_infrastructure" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                <input type="text" name="vuln_${publicIpFollowUpVulnEntryCount}_name" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">CVE/CWE Reference Number*</label>
                <input type="text" name="vuln_${publicIpFollowUpVulnEntryCount}_cve" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Severity of Issue*</label>
                <select name="vuln_${publicIpFollowUpVulnEntryCount}_severity" class="form-input" required>
                    <option value="">Select Severity</option>
                    <option value="Critical">Critical</option>
                    <option value="High">High</option>
                    <option value="Medium">Medium</option>
                    <option value="Low">Low</option>
                    <option value="Informational">Informational</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                <input type="number" name="vuln_${publicIpFollowUpVulnEntryCount}_count" class="form-input" min="0" required>
            </div>
            <div class="form-group">
                <label class="form-label">Attributing Factor*</label>
                <select name="vuln_${publicIpFollowUpVulnEntryCount}_factor" class="form-input" required>
                    <option value="">Select Factor</option>
                    <option value="Coding Error">Coding Error</option>
                    <option value="Configuration Error">Configuration Error</option>
                    <option value="Deployment Error">Deployment Error</option>
                    <option value="Design Error">Design Error</option>
                    <option value="Operation Error">Operation Error</option>
                    <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                </select>
            </div>
        `;

        container.appendChild(entryDiv);
        publicIpFollowUpVulnEntryCount++;
    }

    let publicIpFollowUpEmpEntryCount = 1;
    function addPublicIpFollowUpEmployeeEntry() {
        const container = document.getElementById('publicIpFollowUpEmployeeContainer');
        if (!container) {
            return;
        }

        const entryDiv = document.createElement('div');
        entryDiv.className = 'employee-entry';
        entryDiv.style.border = '1px solid #ddd';
        entryDiv.style.padding = '15px';
        entryDiv.style.marginBottom = '15px';
        entryDiv.style.borderRadius = '5px';
        entryDiv.style.position = 'relative';

        entryDiv.innerHTML = `
            <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
            <div class="form-group">
                <label class="form-label">Name of employee*</label>
                <input type="text" name="emp_${publicIpFollowUpEmpEntryCount}_name" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">E-mail ID*</label>
                <input type="email" name="emp_${publicIpFollowUpEmpEntryCount}_email" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">CISSP*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${publicIpFollowUpEmpEntryCount}_cissp" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${publicIpFollowUpEmpEntryCount}_cissp" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CISA*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${publicIpFollowUpEmpEntryCount}_cisa" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${publicIpFollowUpEmpEntryCount}_cisa" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CISM*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${publicIpFollowUpEmpEntryCount}_cism" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${publicIpFollowUpEmpEntryCount}_cism" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">ISO*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${publicIpFollowUpEmpEntryCount}_iso" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${publicIpFollowUpEmpEntryCount}_iso" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">DISA*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${publicIpFollowUpEmpEntryCount}_disa" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${publicIpFollowUpEmpEntryCount}_disa" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">OSCP*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${publicIpFollowUpEmpEntryCount}_oscp" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${publicIpFollowUpEmpEntryCount}_oscp" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">CEH*</label>
                <div style="display: flex; gap: 20px;">
                    <label><input type="radio" name="emp_${publicIpFollowUpEmpEntryCount}_ceh" value="Yes" required> Yes</label>
                    <label><input type="radio" name="emp_${publicIpFollowUpEmpEntryCount}_ceh" value="No" required> No</label>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">Others</label>
                <input type="text" name="emp_${publicIpFollowUpEmpEntryCount}_others" class="form-input" placeholder="Specify other certifications">
            </div>
            <div class="form-group">
                <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                <input type="number" name="emp_${publicIpFollowUpEmpEntryCount}_experience" class="form-input" min="0" step="0.5" required>
            </div>
        `;

        container.appendChild(entryDiv);
        publicIpFollowUpEmpEntryCount++;
    }

    function handlePublicIpFollowUpAuditMetaDataSubmit(event) {
        event.preventDefault();

        const submitBtn = document.getElementById('publicIpFollowUpAuditMetaDataSubmitBtn');
        if (!submitBtn) {
            return;
        }

        const originalText = submitBtn.innerHTML;

        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
        submitBtn.disabled = true;

        const formElement = document.getElementById('publicIpFollowUpAuditMetaDataForm');
        if (!formElement) {
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            return;
        }

        const formData = new FormData(formElement);

        fetch('/process_public_ip_follow_up_audit_metadata', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const link = document.createElement('a');
                link.href = data.download_url;
                link.download = data.filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                closeVaptModal('publicIpFollowUpAuditMetaDataModal');

                setTimeout(() => {
                    fetch('/cleanup_public_ip_follow_up_audit_metadata', {
                        method: 'POST'
                    }).then(() => {
                        location.reload();
                    });
                }, 2000);
            } else {
                alert('Error: ' + (data.error || 'Unknown error'));
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        })
        .catch(error => {
            console.error('Public IP Follow Up Audit MetaData Error:', error);
            alert('An error occurred: ' + error.message);
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
        });
    }

    // Handle VAPT Follow Up Audit MetaData form submission

    // ==============================================================================
    // Website VAPT Follow-up Audit Functions
    // ==============================================================================

    function removeWebsiteVaptFollowUpTeamMember(button) {
        const container = document.getElementById('websiteVaptFollowUpAuditTeamContainer');
        const teamMembers = container.querySelectorAll('.team-member');
        
        if (teamMembers.length <= 1) {
            alert('At least one team member is required');
            return;
        }
        
        button.closest('.team-member').remove();
    }

    // Website VAPT Follow-up Form Submission Handler
    if (document.getElementById('websiteVaptFollowUpAuditForm')) {
        document.getElementById('websiteVaptFollowUpAuditForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Validate team members
                const teamMembers = document.getElementById('websiteVaptFollowUpAuditTeamContainer').querySelectorAll('.team-member');
                if (teamMembers.length < 1) {
                    alert('At least one team member is required');
                    return;
                }
                
                // Validate dates
                const startDate = new Date(document.getElementById('websiteVaptFollowUpStartDate').value);
                const endDate = new Date(document.getElementById('websiteVaptFollowUpEndDate').value);
                const firstAuditDate = new Date(document.getElementById('websiteVaptFollowUpFirstAuditReportDate').value);
                
                if (endDate < startDate) {
                    alert('End date must be after start date');
                    return;
                }
                
                // Show loading indicator
                showVaptLoadingIndicator();
                
                const submitBtn = this.querySelector('.submit-btn');
                const originalText = submitBtn.textContent;
                submitBtn.disabled = true;
                submitBtn.textContent = 'Checking...';
                
                const formData = new FormData(this);
                
                // Handle organization name
                const organizationSelect = document.getElementById('websiteVaptFollowUpOrganization');
                if (organizationSelect && organizationSelect.value === 'other') {
                    const otherOrganizationInput = document.getElementById('websiteVaptFollowUpOtherOrganization');
                    if (otherOrganizationInput && otherOrganizationInput.value && otherOrganizationInput.value.trim() !== '') {
                        formData.set('organization', otherOrganizationInput.value);
                    }
                }
                
                // Handle city
                const citySelect = document.getElementById('websiteVaptFollowUpCity');
                if (citySelect && citySelect.value === 'other') {
                    const otherCityInput = document.getElementById('websiteVaptFollowUpOtherCity');
                    if (otherCityInput && otherCityInput.value && otherCityInput.value.trim() !== '') {
                        formData.set('city', otherCityInput.value);
                    }
                }
                
                // First check vulnerabilities
                fetch('/website_vapt_followup_check_vulnerabilities', {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        alert('Error: ' + data.error);
                        submitBtn.disabled = false;
                        submitBtn.textContent = originalText;
                        hideVaptLoadingIndicator();
                        return;
                    }
                    
                    // Hide loading indicator before showing dialog
                    hideVaptLoadingIndicator();
                    
                    // Show vulnerability confirmation dialog
                    showWebsiteVaptFollowUpVulnerabilityConfirmationDialog(data, this);
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Error checking vulnerabilities: ' + error.message);
                    submitBtn.disabled = false;
                    submitBtn.textContent = originalText;
                    hideVaptLoadingIndicator();
                });
        });
    }

    // Website VAPT Follow-Up vulnerability management state
    let websiteVaptFollowUpVulnerabilityMergeState = {
        matchedGroups: [],
        unmatchedVulnerabilities: [],
        mergeOperations: [],
        newGroupDetails: {},
        manuallyAddedVulnerabilities: []
    };

    // Website VAPT Follow-Up vulnerability management functions
    function showWebsiteVaptFollowUpVulnerabilityConfirmationDialog(vulnData, form) {
        websiteVaptFollowUpVulnerabilityMergeState.matchedGroups = vulnData.matched_groups || [];
        websiteVaptFollowUpVulnerabilityMergeState.unmatchedVulnerabilities = vulnData.unmatched_vulnerabilities || [];
        
        const dialogOverlay = document.createElement('div');
        dialogOverlay.id = 'websiteVaptFollowUpVulnerabilityDialog';
        dialogOverlay.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        `;
        
        const dialogContent = document.createElement('div');
        dialogContent.className = 'dialog-content';
        dialogContent.style.cssText = `
            background: white;
            padding: 30px;
            border-radius: 8px;
            max-width: 1400px;
            max-height: 90vh;
            overflow: auto;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        `;
        
        // Header with title, undo button, count info, and Add Vulnerability Manual button
        const headerSection = document.createElement('div');
        headerSection.style.cssText = 'display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid #2c3e50;';
        
        const headerLeft = document.createElement('div');
        headerLeft.style.cssText = 'display: flex; align-items: center; gap: 15px;';
        
        const headerTitle = document.createElement('h2');
        headerTitle.textContent = 'Website VAPT Follow-Up - Vulnerability Management';
        headerTitle.style.cssText = 'margin: 0; color: #2c3e50;';
        
        const undoButton = document.createElement('button');
        undoButton.textContent = ' Undo Last Operation';
        undoButton.className = 'undo-btn';
        undoButton.style.cssText = 'padding: 8px 16px; background-color: #f39c12; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 13px;';
        undoButton.onclick = undoWebsiteVaptFollowUpLastMergeOperation;
        
        const refreshInfo = document.createElement('span');
        refreshInfo.textContent = `Matched: ${websiteVaptFollowUpVulnerabilityMergeState.matchedGroups.length} | Unmatched: ${websiteVaptFollowUpVulnerabilityMergeState.unmatchedVulnerabilities.length}`;
        refreshInfo.style.cssText = 'font-size: 14px; color: #666;';
        refreshInfo.id = 'websiteVaptFollowUpVulnCountInfo';
        
        headerLeft.appendChild(headerTitle);
        headerLeft.appendChild(undoButton);
        headerLeft.appendChild(refreshInfo);
        
        const addManualVulnBtn = document.createElement('button');
        addManualVulnBtn.type = 'button';
        addManualVulnBtn.className = 'submit-btn';
        addManualVulnBtn.style.cssText = 'background-color: #27ae60; padding: 10px 20px; font-size: 14px;';
        addManualVulnBtn.innerHTML = '<i class="fas fa-plus-circle"></i> Add Vulnerability Manual';
        addManualVulnBtn.onclick = () => showWebsiteFollowUpAddManualVulnerabilityDialog();
        
        headerSection.appendChild(headerLeft);
        headerSection.appendChild(addManualVulnBtn);
        dialogContent.appendChild(headerSection);
        
        const vulnContainer = document.createElement('div');
        vulnContainer.id = 'websiteVaptFollowUpVulnManagementContainer';
        vulnContainer.className = 'vulnerability-management-container';
        dialogContent.appendChild(vulnContainer);
        
        renderWebsiteVaptFollowUpVulnerabilityUI(vulnContainer);
        
        const buttonContainer = document.createElement('div');
        buttonContainer.style.cssText = 'margin-top: 20px; display: flex; gap: 15px; justify-content: flex-end; padding-top: 20px; border-top: 2px solid #eee;';
        
        const cancelBtn = document.createElement('button');
        cancelBtn.type = 'button';
        cancelBtn.className = 'cancel-btn';
        cancelBtn.textContent = 'Cancel';
        cancelBtn.onclick = () => {
            document.body.removeChild(dialogOverlay);
            resetWebsiteVaptFollowUpSubmitButtonState();
        };
        
        const proceedBtn = document.createElement('button');
        proceedBtn.type = 'button';
        proceedBtn.className = 'proceed-btn submit-btn';
        proceedBtn.textContent = 'Proceed to Generate Report';
        proceedBtn.style.cssText = 'background-color: #2c3e50; min-width: 200px;';
        proceedBtn.onclick = () => {
            if (websiteVaptFollowUpVulnerabilityMergeState.unmatchedVulnerabilities.length > 0) {
                alert('Please handle all unmatched vulnerabilities before proceeding');
                return;
            }
            
            document.body.removeChild(dialogOverlay);
            generateWebsiteVaptFollowUpReport(form);
        };
        
        if (websiteVaptFollowUpVulnerabilityMergeState.unmatchedVulnerabilities.length > 0) {
            proceedBtn.disabled = true;
            proceedBtn.style.opacity = '0.5';
            proceedBtn.style.cursor = 'not-allowed';
        }
        
        buttonContainer.appendChild(cancelBtn);
        buttonContainer.appendChild(proceedBtn);
        dialogContent.appendChild(buttonContainer);
        
        dialogOverlay.appendChild(dialogContent);
        document.body.appendChild(dialogOverlay);
    }

    function renderWebsiteVaptFollowUpVulnerabilityUI(container) {
        container.innerHTML = '';
        
        // Matched Groups Section
        const matchedSection = document.createElement('div');
        matchedSection.innerHTML = `<h3 style="color: #27ae60; margin-bottom: 15px;"><i class="fas fa-check-circle"></i> Matched Vulnerabilities (${websiteVaptFollowUpVulnerabilityMergeState.matchedGroups.length})</h3>`;
        
        const matchedList = document.createElement('div');
        matchedList.style.cssText = 'margin-bottom: 30px;';
        
        websiteVaptFollowUpVulnerabilityMergeState.matchedGroups.forEach((group, groupIndex) => {
            const groupDiv = document.createElement('div');
            groupDiv.className = 'matched-group';
            groupDiv.style.cssText = 'margin-bottom: 15px; padding: 15px; background-color: #f8f9fa; border-radius: 8px; border: 1px solid #dee2e6;';
            
            const groupHeader = document.createElement('div');
            groupHeader.style.cssText = 'display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;';
            
            const groupInfo = document.createElement('div');
            groupInfo.style.flex = '1';
            
            const groupName = document.createElement('strong');
            groupName.textContent = group.group_name;
            groupName.style.cssText = 'font-size: 16px; color: #2c3e50;';
            groupInfo.appendChild(groupName);
            
            const riskBadge = document.createElement('span');
            riskBadge.textContent = group.risk_factor || '';
            riskBadge.style.cssText = 'margin-left: 10px; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold;';
            
            const riskLower = (group.risk_factor || '').toLowerCase();
            if (riskLower === 'critical') {
                riskBadge.style.cssText += 'background-color: #8b0000; color: white;';
            } else if (riskLower === 'high') {
                riskBadge.style.cssText += 'background-color: #dc3545; color: white;';
            } else if (riskLower === 'medium') {
                riskBadge.style.cssText += 'background-color: #ffc107; color: black;';
            } else if (riskLower === 'low') {
                riskBadge.style.cssText += 'background-color: #28a745; color: white;';
            }
            groupInfo.appendChild(riskBadge);
            
            if (group.is_manual) {
                const manualBadge = document.createElement('span');
                manualBadge.textContent = 'Manual';
                manualBadge.style.cssText = 'margin-left: 10px; padding: 4px 8px; background: #3498db; color: white; border-radius: 4px; font-size: 12px;';
                groupInfo.appendChild(manualBadge);
            }
            
            const mergeButton = document.createElement('button');
            mergeButton.textContent = ' Merge';
            mergeButton.style.cssText = 'padding: 6px 12px; background-color: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 13px;';
            mergeButton.onclick = function() {
                showWebsiteFollowUpMergeMatchedGroupsDialog(group.catalog_id);
            };
            
            groupHeader.appendChild(groupInfo);
            groupHeader.appendChild(mergeButton);
            groupDiv.appendChild(groupHeader);
            
            const vulnList = document.createElement('ul');
            vulnList.style.cssText = 'margin-top: 10px; margin-left: 20px; font-size: 14px; color: #555;';
            
            group.matched_vulnerabilities.forEach(vuln => {
                const vulnItem = document.createElement('li');
                vulnItem.textContent = vuln;
                vulnItem.style.marginBottom = '5px';
                vulnList.appendChild(vulnItem);
            });
            
            groupDiv.appendChild(vulnList);
            matchedList.appendChild(groupDiv);
        });
        
        matchedSection.appendChild(matchedList);
        container.appendChild(matchedSection);
        
        // Unmatched Vulnerabilities Section
        if (websiteVaptFollowUpVulnerabilityMergeState.unmatchedVulnerabilities.length > 0) {
            const unmatchedSection = document.createElement('div');
            unmatchedSection.innerHTML = `<h3 style="color: #e74c3c; margin-bottom: 15px;"><i class="fas fa-exclamation-triangle"></i> Unmatched Vulnerabilities (${websiteVaptFollowUpVulnerabilityMergeState.unmatchedVulnerabilities.length})</h3>`;
            
            const unmatchedList = document.createElement('div');
            
            websiteVaptFollowUpVulnerabilityMergeState.unmatchedVulnerabilities.forEach(vuln => {
                const vulnDiv = document.createElement('div');
                vulnDiv.style.cssText = 'background: #ffebee; padding: 15px; margin-bottom: 10px; border-radius: 5px; border-left: 4px solid #e74c3c; display: flex; justify-content: space-between; align-items: center;';
                
                const vulnName = document.createElement('span');
                vulnName.textContent = vuln;
                vulnName.style.cssText = 'color: #2c3e50; flex: 1;';
                
                const actionsDiv = document.createElement('div');
                actionsDiv.style.cssText = 'display: flex; gap: 10px;';
                
                // Merge with Matched button
                const mergeMatchedBtn = document.createElement('button');
                mergeMatchedBtn.type = 'button';
                mergeMatchedBtn.className = 'submit-btn';
                mergeMatchedBtn.textContent = 'Merge with Matched';
                mergeMatchedBtn.style.cssText = 'background-color: #3498db; padding: 5px 10px; font-size: 0.85em;';
                mergeMatchedBtn.onclick = () => showWebsiteFollowUpMergeWithMatchedDialog(vuln);
                
                // Merge with Unmatched button
                const mergeUnmatchedBtn = document.createElement('button');
                mergeUnmatchedBtn.type = 'button';
                mergeUnmatchedBtn.className = 'submit-btn';
                mergeUnmatchedBtn.textContent = 'Merge with Unmatched';
                mergeUnmatchedBtn.style.cssText = 'background-color: #9b59b6; padding: 5px 10px; font-size: 0.85em;';
                mergeUnmatchedBtn.onclick = () => showWebsiteFollowUpMergeWithUnmatchedDialog(vuln);
                
                // Add Details button
                const addDetailsBtn = document.createElement('button');
                addDetailsBtn.type = 'button';
                addDetailsBtn.className = 'submit-btn';
                addDetailsBtn.textContent = 'Add Details';
                addDetailsBtn.style.cssText = 'background-color: #e67e22; padding: 5px 10px; font-size: 0.85em;';
                addDetailsBtn.onclick = () => showWebsiteFollowUpAddDetailsDialog(vuln);
                
                actionsDiv.appendChild(mergeMatchedBtn);
                actionsDiv.appendChild(mergeUnmatchedBtn);
                actionsDiv.appendChild(addDetailsBtn);
                
                vulnDiv.appendChild(vulnName);
                vulnDiv.appendChild(actionsDiv);
                unmatchedList.appendChild(vulnDiv);
            });
            
            unmatchedSection.appendChild(unmatchedList);
            container.appendChild(unmatchedSection);
        } else {
            const allMatchedMsg = document.createElement('div');
            allMatchedMsg.style.cssText = 'background: #d4edda; color: #155724; padding: 20px; border-radius: 5px; text-align: center; font-size: 1.1em;';
            allMatchedMsg.innerHTML = '<i class="fas fa-check-circle"></i> All vulnerabilities are matched! You can proceed to generate the report.';
            container.appendChild(allMatchedMsg);
            
            // Enable proceed button
            const proceedBtn = document.querySelector('.proceed-btn');
            if (proceedBtn) {
                proceedBtn.disabled = false;
                proceedBtn.style.opacity = '1';
                proceedBtn.style.cursor = 'pointer';
            }
        }
    }
    
    function showWebsiteFollowUpMergeWithMatchedDialog(unmatchedVuln) {
        const totalVulns = websiteVaptFollowUpVulnerabilityMergeState.matchedGroups.length + 
                           websiteVaptFollowUpVulnerabilityMergeState.unmatchedVulnerabilities.length;
        
        const matchedCount = websiteVaptFollowUpVulnerabilityMergeState.matchedGroups.length;
        const unmatchedCount = websiteVaptFollowUpVulnerabilityMergeState.unmatchedVulnerabilities.length;
        
        container.innerHTML = `
            <div style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 5px;">
                <p><strong>Total Vulnerabilities:</strong> ${totalVulns} | 
                   <strong>Matched:</strong> ${matchedCount} | 
                   <strong>Unmatched:</strong> ${unmatchedCount}</p>
            </div>
            
            <div class="vulnerability-sections">
                ${unmatchedCount > 0 ? `
                <div class="vulnerability-section unmatched">
                    <h3>Unmatched Vulnerabilities (${unmatchedCount})</h3>
                    ${websiteVaptFollowUpVulnerabilityMergeState.unmatchedVulnerabilities.map((vuln, idx) => `
                        <div class="vulnerability-item" data-vuln="${vuln}" style="display: flex; justify-content: space-between; align-items: center; padding: 10px; margin: 5px 0; background: #fff; border: 1px solid #ddd; border-radius: 5px;">
                            <span style="flex: 1; margin-right: 10px;">${vuln}</span>
                            <button onclick="showWebsiteVaptFollowUpVulnOptions('${vuln}')" class="report-option" style="background: #2c3e50; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer;">
                                <i class="fas fa-cog"></i> Actions
                            </button>
                        </div>
                    `).join('')}
                </div>
                ` : '<div style="text-align: center; padding: 20px; color: #27ae60;"><strong>All vulnerabilities matched! </strong></div>'}
                
                <div class="vulnerability-section matched">
                    <h3>Matched Vulnerabilities (${matchedCount})</h3>
                    ${websiteVaptFollowUpVulnerabilityMergeState.matchedGroups.map((group, idx) => `
                        <div class="vulnerability-group" style="padding: 10px; margin: 5px 0; background: #e8f5e9; border: 1px solid #4caf50; border-radius: 5px;">
                            <div class="group-header" style="font-weight: bold; margin-bottom: 5px;">
                                <strong>${group.group_name}</strong> - Risk: ${group.risk_factor} - CVSS: ${group.cvss_score}
                            </div>
                            <div class="group-vulnerabilities">
                                ${group.matched_vulnerabilities.map(v => `<span class="vuln-tag" style="display: inline-block; padding: 2px 8px; margin: 2px; background: #c8e6c9; border-radius: 3px; font-size: 12px;">${v}</span>`).join('')}
                            </div>
                        </div>
                    `).join('')}
                </div>
            </div>
        `;
    }

    function showWebsiteFollowUpMergeWithMatchedDialog(unmatchedVuln) {
        const dialog = document.createElement('div');
        dialog.className = 'vuln-confirmation-dialog';
        dialog.style.zIndex = '10001';
        
        const dialogContent = document.createElement('div');
        dialogContent.className = 'dialog-content';
        dialogContent.style.maxWidth = '600px';
        
        const title = document.createElement('h3');
        title.textContent = 'Merge with Matched Group';
        title.style.marginBottom = '15px';
        dialogContent.appendChild(title);
        
        const instruction = document.createElement('p');
        instruction.textContent = `Select a matched group to merge "${unmatchedVuln}" into:`;
        instruction.style.marginBottom = '20px';
        instruction.style.fontSize = '14px';
        dialogContent.appendChild(instruction);
        
        const form = document.createElement('div');
        
        websiteVaptFollowUpVulnerabilityMergeState.matchedGroups.forEach((group, idx) => {
            const radioDiv = document.createElement('div');
            radioDiv.style.marginBottom = '12px';
            radioDiv.style.padding = '10px';
            radioDiv.style.backgroundColor = '#f8f9fa';
            radioDiv.style.borderRadius = '4px';
            
            const radio = document.createElement('input');
            radio.type = 'radio';
            radio.name = 'website_followup_target_matched_group';
            radio.value = group.catalog_id;
            radio.id = `website_followup_matched_group_${idx}`;
            
            const label = document.createElement('label');
            label.setAttribute('for', `website_followup_matched_group_${idx}`);
            label.style.marginLeft = '8px';
            label.style.cursor = 'pointer';
            label.textContent = group.group_name;
            
            radioDiv.appendChild(radio);
            radioDiv.appendChild(label);
            form.appendChild(radioDiv);
        });
        
        dialogContent.appendChild(form);
        
        const buttonContainer = document.createElement('div');
        buttonContainer.className = 'button-container';
        buttonContainer.style.marginTop = '20px';
        
        const confirmBtn = document.createElement('button');
        confirmBtn.textContent = 'Confirm Merge';
        confirmBtn.className = 'proceed-btn';
        confirmBtn.onclick = function() {
            const selectedRadio = document.querySelector('input[name="website_followup_target_matched_group"]:checked');
            if (!selectedRadio) {
                alert('Please select a group to merge with');
                return;
            }
            
            confirmBtn.disabled = true;
            confirmBtn.textContent = 'Merging...';
            
            fetch('/website_vapt_followup_merge_with_matched', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    unmatched_vulnerability: unmatchedVuln,
                    target_group_id: parseInt(selectedRadio.value)
                })
            })
            .then(response => {
                if (!response.ok) {
                    return response.text().then(text => {
                        throw new Error(`HTTP ${response.status}: ${text}`);
                    });
                }
                return response.json();
            })
            .then(data => {
                if (data.success && data.updated_state) {
                    websiteVaptFollowUpVulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups || [];
                    websiteVaptFollowUpVulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities || [];
                    
                    dialog.remove();
                    refreshWebsiteVaptFollowUpVulnerabilityUI();
                    
                    alert('Vulnerability merged successfully!');
                } else {
                    alert('Error: ' + (data.error || 'Unknown error'));
                    confirmBtn.disabled = false;
                    confirmBtn.textContent = 'Confirm Merge';
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error merging: ' + error.message);
                confirmBtn.disabled = false;
                confirmBtn.textContent = 'Confirm Merge';
            });
        };
        
        const cancelBtn = document.createElement('button');
        cancelBtn.textContent = 'Cancel';
        cancelBtn.className = 'cancel-btn';
        cancelBtn.onclick = () => dialog.remove();
        
        buttonContainer.appendChild(confirmBtn);
        buttonContainer.appendChild(cancelBtn);
        dialogContent.appendChild(buttonContainer);
        
        dialog.appendChild(dialogContent);
        document.body.appendChild(dialog);
    }

    function refreshWebsiteVaptFollowUpVulnerabilityUI() {
        const container = document.getElementById('websiteVaptFollowUpVulnManagementContainer');
        if (!container) {
            console.error('Container not found for refresh');
            return;
        }
        renderWebsiteVaptFollowUpVulnerabilityUI(container);
        
        // Update count info
        const countInfo = document.getElementById('websiteVaptFollowUpVulnCountInfo');
        if (countInfo) {
            countInfo.textContent = `Matched: ${websiteVaptFollowUpVulnerabilityMergeState.matchedGroups.length} | Unmatched: ${websiteVaptFollowUpVulnerabilityMergeState.unmatchedVulnerabilities.length}`;
        }
        
        // Update proceed button state
        const proceedBtn = document.querySelector('.proceed-btn');
        if (proceedBtn) {
            if (websiteVaptFollowUpVulnerabilityMergeState.unmatchedVulnerabilities.length > 0) {
                proceedBtn.disabled = true;
                proceedBtn.style.opacity = '0.5';
                proceedBtn.style.cursor = 'not-allowed';
            } else {
                proceedBtn.disabled = false;
                proceedBtn.style.opacity = '1';
                proceedBtn.style.cursor = 'pointer';
            }
        }
    }
    
    // Function to undo last merge operation for Follow-Up
    function undoWebsiteVaptFollowUpLastMergeOperation() {
        if (!confirm('Are you sure you want to undo the last operation?')) {
            return;
        }
        
        fetch('/website_vapt_followup_undo_last_merge', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'}
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            console.log('Undo response:', data);
            if (data.success && data.updated_state) {
                websiteVaptFollowUpVulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups || [];
                websiteVaptFollowUpVulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities || [];
                
                console.log('Updated state - Matched:', websiteVaptFollowUpVulnerabilityMergeState.matchedGroups.length, 'Unmatched:', websiteVaptFollowUpVulnerabilityMergeState.unmatchedVulnerabilities.length);
                
                // Refresh the main UI
                refreshWebsiteVaptFollowUpVulnerabilityUI();
                
                alert('Operation undone successfully!');
            } else {
                alert('Error: ' + (data.error || 'No operations to undo'));
            }
        })
        .catch(error => {
            console.error('Error undoing operation:', error);
            alert('Error undoing operation: ' + error.message);
        });
    }
    
    // Function to show merge matched groups dialog for Follow-Up
    function showWebsiteFollowUpMergeMatchedGroupsDialog(sourceGroupId) {
        const dialog = document.createElement('div');
        dialog.className = 'vuln-confirmation-dialog';
        dialog.style.zIndex = '10001';
        
        const dialogContent = document.createElement('div');
        dialogContent.className = 'dialog-content';
        dialogContent.style.maxWidth = '600px';
        
        const sourceGroup = websiteVaptFollowUpVulnerabilityMergeState.matchedGroups.find(g => g.catalog_id === sourceGroupId);
        if (!sourceGroup) {
            alert('Source group not found');
            return;
        }
        
        const title = document.createElement('h3');
        title.textContent = 'Merge Matched Groups';
        title.style.marginBottom = '15px';
        dialogContent.appendChild(title);
        
        const instruction = document.createElement('p');
        instruction.innerHTML = `<strong>Merge FROM:</strong> ${sourceGroup.group_name}<br><br>Select target group to merge INTO:`;
        instruction.style.marginBottom = '20px';
        instruction.style.fontSize = '14px';
        dialogContent.appendChild(instruction);
        
        const form = document.createElement('div');
        
        websiteVaptFollowUpVulnerabilityMergeState.matchedGroups.forEach((group, idx) => {
            if (group.catalog_id === sourceGroupId) return;
            
            const radioDiv = document.createElement('div');
            radioDiv.style.marginBottom = '12px';
            radioDiv.style.padding = '10px';
            radioDiv.style.backgroundColor = '#f8f9fa';
            radioDiv.style.borderRadius = '4px';
            
            const radio = document.createElement('input');
            radio.type = 'radio';
            radio.name = 'website_followup_target_group';
            radio.value = group.catalog_id;
            radio.id = `website_followup_target_group_${idx}`;
            
            const label = document.createElement('label');
            label.setAttribute('for', `website_followup_target_group_${idx}`);
            label.style.marginLeft = '8px';
            label.style.cursor = 'pointer';
            label.textContent = group.group_name;
            
            radioDiv.appendChild(radio);
            radioDiv.appendChild(label);
            form.appendChild(radioDiv);
        });
        
        if (form.children.length === 0) {
            const noGroupsMsg = document.createElement('p');
            noGroupsMsg.textContent = 'No other matched groups available to merge with.';
            noGroupsMsg.style.color = '#666';
            dialogContent.appendChild(noGroupsMsg);
        } else {
            dialogContent.appendChild(form);
        }
        
        const buttonContainer = document.createElement('div');
        buttonContainer.style.marginTop = '20px';
        buttonContainer.style.display = 'flex';
        buttonContainer.style.gap = '10px';
        
        const mergeBtn = document.createElement('button');
        mergeBtn.textContent = 'Merge';
        mergeBtn.className = 'proceed-btn';
        mergeBtn.onclick = function() {
            const selectedRadio = document.querySelector('input[name="website_followup_target_group"]:checked');
            if (!selectedRadio) {
                alert('Please select a target group');
                return;
            }
            
            const targetGroupId = parseInt(selectedRadio.value);
            
            fetch('/website_vapt_followup_merge_matched_groups', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    source_group_id: sourceGroupId,
                    target_group_id: targetGroupId
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    websiteVaptFollowUpVulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups || [];
                    websiteVaptFollowUpVulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities || [];
                    dialog.remove();
                    refreshWebsiteVaptFollowUpVulnerabilityUI();
                    alert('Groups merged successfully!');
                } else {
                    alert('Error: ' + (data.error || 'Failed to merge groups'));
                }
            })
            .catch(error => {
                console.error('Error merging groups:', error);
                alert('Error merging groups: ' + error.message);
            });
        };
        
        const cancelBtn = document.createElement('button');
        cancelBtn.textContent = 'Cancel';
        cancelBtn.className = 'cancel-btn';
        cancelBtn.onclick = () => dialog.remove();
        
        buttonContainer.appendChild(mergeBtn);
        buttonContainer.appendChild(cancelBtn);
        dialogContent.appendChild(buttonContainer);
        
        dialog.appendChild(dialogContent);
        document.body.appendChild(dialog);
    }

    function showWebsiteFollowUpMergeWithUnmatchedDialog(primaryVuln) {
        const dialog = document.createElement('div');
        dialog.className = 'vuln-confirmation-dialog';
        dialog.style.zIndex = '10001';
        
        const dialogContent = document.createElement('div');
        dialogContent.className = 'dialog-content';
        dialogContent.style.maxWidth = '800px';
        dialogContent.style.maxHeight = '80vh';
        dialogContent.style.overflow = 'auto';
        
        const title = document.createElement('h3');
        title.textContent = 'Merge with Other Unmatched Vulnerabilities';
        title.style.marginBottom = '15px';
        dialogContent.appendChild(title);
        
        const instruction = document.createElement('p');
        instruction.innerHTML = `<strong>Primary:</strong> ${primaryVuln}<br><br>Select other unmatched vulnerabilities to merge with:`;
        instruction.style.marginBottom = '20px';
        instruction.style.fontSize = '14px';
        dialogContent.appendChild(instruction);
        
        const checkboxContainer = document.createElement('div');
        checkboxContainer.style.marginBottom = '20px';
        checkboxContainer.style.maxHeight = '200px';
        checkboxContainer.style.overflow = 'auto';
        checkboxContainer.style.border = '1px solid #ddd';
        checkboxContainer.style.padding = '10px';
        checkboxContainer.style.borderRadius = '4px';
        
        websiteVaptFollowUpVulnerabilityMergeState.unmatchedVulnerabilities.forEach((vuln, idx) => {
            if (vuln === primaryVuln) return;
            
            const checkDiv = document.createElement('div');
            checkDiv.style.marginBottom = '8px';
            
            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkbox.value = vuln;
            checkbox.id = `website_followup_unmatched_vuln_${idx}`;
            checkbox.className = 'website-followup-merge-unmatched-checkbox';
            
            const label = document.createElement('label');
            label.setAttribute('for', `website_followup_unmatched_vuln_${idx}`);
            label.style.marginLeft = '8px';
            label.style.cursor = 'pointer';
            label.textContent = vuln;
            
            checkDiv.appendChild(checkbox);
            checkDiv.appendChild(label);
            checkboxContainer.appendChild(checkDiv);
        });
        
        dialogContent.appendChild(checkboxContainer);
        
        const nextBtn = document.createElement('button');
        nextBtn.textContent = 'Next: Provide Group Details';
        nextBtn.className = 'proceed-btn';
        nextBtn.style.width = '100%';
        nextBtn.style.marginBottom = '10px';
        nextBtn.onclick = function() {
            const checkboxes = document.querySelectorAll('.website-followup-merge-unmatched-checkbox:checked');
            const selectedVulns = [primaryVuln, ...Array.from(checkboxes).map(cb => cb.value)];
            
            if (selectedVulns.length < 1) {
                alert('No vulnerabilities selected');
                return;
            }
            
            dialog.remove();
            showWebsiteFollowUpVulnerabilityDetailsForm(selectedVulns, 'merge_with_unmatched');
        };
        
        const cancelBtn = document.createElement('button');
        cancelBtn.textContent = 'Cancel';
        cancelBtn.className = 'cancel-btn';
        cancelBtn.style.width = '100%';
        cancelBtn.onclick = () => dialog.remove();
        
        dialogContent.appendChild(nextBtn);
        dialogContent.appendChild(cancelBtn);
        
        dialog.appendChild(dialogContent);
        document.body.appendChild(dialog);
    }

    function showWebsiteFollowUpAddDetailsDialog(vuln) {
        showWebsiteFollowUpVulnerabilityDetailsForm([vuln], 'add_details');
    }

    function showWebsiteFollowUpVulnerabilityDetailsForm(vulnerabilities, actionType) {
        const dialog = document.createElement('div');
        dialog.className = 'vuln-confirmation-dialog';
        dialog.style.zIndex = '10002';
        
        const dialogContent = document.createElement('div');
        dialogContent.className = 'dialog-content';
        dialogContent.style.maxWidth = '900px';
        dialogContent.style.maxHeight = '85vh';
        dialogContent.style.overflow = 'auto';
        
        const title = document.createElement('h3');
        title.textContent = actionType === 'add_details' ? 'Add Vulnerability Details' : 'Provide Group Details for Merged Vulnerabilities';
        title.style.marginBottom = '15px';
        dialogContent.appendChild(title);
        
        if (vulnerabilities.length > 1) {
            const vulnList = document.createElement('div');
            vulnList.style.marginBottom = '20px';
            vulnList.style.padding = '10px';
            vulnList.style.backgroundColor = '#f8f9fa';
            vulnList.style.borderRadius = '4px';
            
            const listTitle = document.createElement('strong');
            listTitle.textContent = 'Vulnerabilities in this group:';
            listTitle.style.display = 'block';
            listTitle.style.marginBottom = '8px';
            vulnList.appendChild(listTitle);
            
            const ul = document.createElement('ul');
            ul.style.marginLeft = '20px';
            vulnerabilities.forEach(v => {
                const li = document.createElement('li');
                li.textContent = v;
                li.style.marginBottom = '4px';
                ul.appendChild(li);
            });
            vulnList.appendChild(ul);
            dialogContent.appendChild(vulnList);
        }
        
        const formContainer = document.createElement('div');
        formContainer.style.marginBottom = '20px';
        
        const fields = [
            { name: 'vulnerabilityName', label: 'Vulnerability Group Name', type: 'text', placeholder: 'e.g., SQL Injection Vulnerabilities', required: true },
            { name: 'riskFactor', label: 'Risk Factor', type: 'select', options: ['', 'Low', 'Medium', 'High', 'Critical'], required: true },
            { name: 'cveId', label: 'CVE ID', type: 'text', placeholder: 'e.g., CVE-2023-1234 or Multiple', required: false },
            { name: 'cvssScore', label: 'CVSS Score', type: 'text', placeholder: 'e.g., 7.5', required: false },
            { name: 'auditObservation', label: 'Audit Observation', type: 'textarea', required: true },
            { name: 'impact', label: 'Impact', type: 'textarea', required: true },
            { name: 'recommendation', label: 'Recommendation', type: 'textarea', required: true },
            { name: 'referenceLink', label: 'Reference Link', type: 'textarea', placeholder: 'Enter reference links (one per line)', required: false }
        ];
        
        fields.forEach(field => {
            const fieldDiv = document.createElement('div');
            fieldDiv.style.marginBottom = '15px';
            
            const label = document.createElement('label');
            label.textContent = field.label + (field.required ? ' *' : '');
            label.style.display = 'block';
            label.style.marginBottom = '5px';
            label.style.fontWeight = '500';
            label.style.fontSize = '14px';
            fieldDiv.appendChild(label);
            
            let input;
            if (field.type === 'select') {
                input = document.createElement('select');
                input.id = `website_followup_${field.name}`;
                input.name = field.name;
                input.style.width = '100%';
                input.style.padding = '8px';
                input.style.borderRadius = '4px';
                input.style.border = '1px solid #ced4da';
                if (field.required) input.required = true;
                
                field.options.forEach(option => {
                    const optionElement = document.createElement('option');
                    optionElement.value = option;
                    optionElement.textContent = option || 'Select Risk Factor';
                    input.appendChild(optionElement);
                });
            } else if (field.type === 'textarea') {
                input = document.createElement('textarea');
                input.id = `website_followup_${field.name}`;
                input.name = field.name;
                input.rows = 4;
                input.style.width = '100%';
                input.style.padding = '8px';
                input.style.borderRadius = '4px';
                input.style.border = '1px solid #ced4da';
                input.style.resize = 'vertical';
                if (field.placeholder) input.placeholder = field.placeholder;
                if (field.required) input.required = true;
            } else {
                input = document.createElement('input');
                input.type = field.type;
                input.id = `website_followup_${field.name}`;
                input.name = field.name;
                input.style.width = '100%';
                input.style.padding = '8px';
                input.style.borderRadius = '4px';
                input.style.border = '1px solid #ced4da';
                if (field.placeholder) input.placeholder = field.placeholder;
                if (field.required) input.required = true;
            }
            
            fieldDiv.appendChild(input);
            formContainer.appendChild(fieldDiv);
        });
        
        dialogContent.appendChild(formContainer);
        
        const buttonContainer = document.createElement('div');
        buttonContainer.className = 'button-container';
        buttonContainer.style.marginTop = '20px';
        
        const submitBtn = document.createElement('button');
        submitBtn.textContent = 'Submit & Update Catalog';
        submitBtn.className = 'proceed-btn';
        submitBtn.onclick = function() {
            const vulnName = document.getElementById('website_followup_vulnerabilityName').value.trim();
            const riskFactor = document.getElementById('website_followup_riskFactor').value;
            const observation = document.getElementById('website_followup_auditObservation').value.trim();
            const impact = document.getElementById('website_followup_impact').value.trim();
            const recommendation = document.getElementById('website_followup_recommendation').value.trim();
            
            if (!vulnName || !riskFactor || !observation || !impact || !recommendation) {
                alert('Please fill in all required fields (marked with *)');
                return;
            }
            
            submitBtn.disabled = true;
            submitBtn.textContent = 'Submitting...';
            
            const details = {
                vulnerabilityName: vulnName,
                riskFactor: riskFactor,
                cveId: document.getElementById('website_followup_cveId').value.trim(),
                cvssScore: document.getElementById('website_followup_cvssScore').value.trim(),
                auditObservation: observation,
                impact: impact,
                recommendation: recommendation,
                referenceLink: document.getElementById('website_followup_referenceLink').value.trim()
            };
            
            const endpoint = actionType === 'add_details' ? '/website_vapt_followup_add_vulnerability_details' : '/website_vapt_followup_merge_with_unmatched';
            const payload = actionType === 'add_details' 
                ? { vulnerability_name: vulnerabilities[0], vulnerability_details: details }
                : { vulnerabilities: vulnerabilities, vulnerability_details: details };
            
            fetch(endpoint, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(payload)
            })
            .then(response => {
                if (!response.ok) {
                    return response.text().then(text => {
                        throw new Error(`HTTP ${response.status}: ${text}`);
                    });
                }
                return response.json();
            })
            .then(data => {
                if (data.success && data.updated_state) {
                    websiteVaptFollowUpVulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups || [];
                    websiteVaptFollowUpVulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities || [];
                    
                    dialog.remove();
                    refreshWebsiteVaptFollowUpVulnerabilityUI();
                    
                    alert(actionType === 'add_details' ? 'Details added successfully!' : 'Vulnerabilities merged successfully!');
                } else {
                    alert('Error: ' + (data.error || 'Unknown error'));
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'Submit & Update Catalog';
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error submitting: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = 'Submit & Update Catalog';
            });
        };
        
        const cancelBtn = document.createElement('button');
        cancelBtn.textContent = 'Cancel';
        cancelBtn.className = 'cancel-btn';
        cancelBtn.onclick = () => dialog.remove();
        
        buttonContainer.appendChild(submitBtn);
        buttonContainer.appendChild(cancelBtn);
        dialogContent.appendChild(buttonContainer);
        
        dialog.appendChild(dialogContent);
        document.body.appendChild(dialog);
    }

    function showWebsiteFollowUpAddManualVulnerabilityDialog() {
        const dialogOverlay = document.createElement('div');
        dialogOverlay.className = 'sub-dialog-overlay';
        dialogOverlay.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: flex; justify-content: center; align-items: center; z-index: 10001;';
        
        const dialogBox = document.createElement('div');
        dialogBox.style.cssText = 'background: white; padding: 30px; border-radius: 8px; max-width: 800px; width: 90%; max-height: 90vh; overflow-y: auto;';
        
        dialogBox.innerHTML = `
            <h3 style="margin-top: 0; color: #27ae60;"><i class="fas fa-plus-circle"></i> Add Vulnerability Manually</h3>
            <p style="color: #666; margin-bottom: 20px;">Enter complete details for the new vulnerability. This will be added to the catalog and appear in the matched vulnerabilities list.</p>
            <form id="websiteFollowUpManualVulnForm">
                <div class="form-group">
                    <label>Vulnerability Name*</label>
                    <input type="text" id="websiteFollowUpManualVulnName" class="form-input" required>
                </div>
                <div class="form-group">
                    <label>Risk Factor*</label>
                    <select id="websiteFollowUpManualRiskFactor" class="form-input" required>
                        <option value="">Select Risk</option>
                        <option value="Critical">Critical</option>
                        <option value="High">High</option>
                        <option value="Medium">Medium</option>
                        <option value="Low">Low</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>CVE/CWE ID*</label>
                    <input type="text" id="websiteFollowUpManualCveId" class="form-input" required>
                </div>
                <div class="form-group">
                    <label>CVSS Score*</label>
                    <input type="text" id="websiteFollowUpManualCvssScore" class="form-input" required>
                </div>
                <div class="form-group">
                    <label>Audit Observation*</label>
                    <textarea id="websiteFollowUpManualObservation" class="form-input" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label>Impact*</label>
                    <textarea id="websiteFollowUpManualImpact" class="form-input" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label>Recommendation*</label>
                    <textarea id="websiteFollowUpManualRecommendation" class="form-input" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label>Reference Link*</label>
                    <input type="text" id="websiteFollowUpManualReferenceLink" class="form-input" required>
                </div>
                <div class="form-group">
                    <label>Affected Systems (Optional - for display in report)</label>
                    <textarea id="websiteFollowUpManualAffectedSystems" class="form-input" rows="2" placeholder="Enter affected systems (one per line or comma-separated)"></textarea>
                    <small style="color: #666;">This will be added to the Website_VAPT worksheet only, not to the catalog.</small>
                </div>
                <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                    <button type="button" class="cancel-btn" onclick="this.closest('.sub-dialog-overlay').remove()">Cancel</button>
                    <button type="submit" class="submit-btn" style="background-color: #27ae60;">Add Vulnerability</button>
                </div>
            </form>
        `;
        
        // Handle form submission
        dialogBox.querySelector('#websiteFollowUpManualVulnForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const vulnerabilityDetails = {
                vulnerabilityName: document.getElementById('websiteFollowUpManualVulnName').value,
                riskFactor: document.getElementById('websiteFollowUpManualRiskFactor').value,
                cveId: document.getElementById('websiteFollowUpManualCveId').value,
                cvssScore: document.getElementById('websiteFollowUpManualCvssScore').value,
                auditObservation: document.getElementById('websiteFollowUpManualObservation').value,
                impact: document.getElementById('websiteFollowUpManualImpact').value,
                recommendation: document.getElementById('websiteFollowUpManualRecommendation').value,
                referenceLink: document.getElementById('websiteFollowUpManualReferenceLink').value,
                affectedSystems: document.getElementById('websiteFollowUpManualAffectedSystems').value
            };
            
            // Submit to backend
            fetch('/website_vapt_followup_add_manual_vulnerability', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({vulnerability_details: vulnerabilityDetails})
            })
            .then(response => response.json())
            .then(data => {
                if (data.success && data.updated_state) {
                    // Update global state
                    websiteVaptFollowUpVulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups;
                    websiteVaptFollowUpVulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities;
                    
                    // Refresh UI
                    const container = document.getElementById('websiteVaptFollowUpVulnManagementContainer');
                    renderWebsiteVaptFollowUpVulnerabilityUI(container);
                    
                    // Close dialog
                    document.body.removeChild(dialogOverlay);
                    
                    alert('Vulnerability added successfully!');
                } else {
                    alert('Error: ' + (data.error || 'Unknown error'));
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error adding vulnerability: ' + error.message);
            });
        });
        
        dialogOverlay.appendChild(dialogBox);
        document.body.appendChild(dialogOverlay);
    }

    function generateWebsiteVaptFollowUpReport(form) {
        const submitBtn = form.querySelector('.submit-btn');
        const originalText = submitBtn.textContent;
        
        showVaptLoadingIndicator();
        submitBtn.disabled = true;
        submitBtn.textContent = 'Generating...';
        
        const formData = new FormData(form);
        
        fetch('/process_website_vapt_follow_up_audit_report', {
            method: 'POST',
            body: formData
        })
        .then(response => response.blob())
        .then(blob => {
            hideVaptLoadingIndicator();
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
            
            const url = window.URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'Website_VAPT_Follow_Up_Audit_Report.xlsx';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            window.URL.revokeObjectURL(url);
            
            closeVaptModal('websiteVaptFollowUpAuditModal');
            location.reload();
        })
        .catch(error => {
            hideVaptLoadingIndicator();
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
            alert('Error generating report: ' + error.message);
        });
    }

    function resetWebsiteVaptFollowUpSubmitButtonState() {
        const submitBtn = document.querySelector('#websiteVaptFollowUpAuditForm .submit-btn');
        if (submitBtn) {
            submitBtn.disabled = false;
            submitBtn.textContent = 'Submit Report';
        }
    }

    function openWebsiteVaptFollowUpVulnOptions() {
        // Placeholder
    }

    // Android Mobile Application First Audit Form Submission Handler
    const androidAppFirstAuditForm = document.getElementById('androidAppFirstAuditForm');
    if (androidAppFirstAuditForm) {
        androidAppFirstAuditForm.addEventListener('submit', function(e) {
            e.preventDefault();

            // Validate vulnerabilities
            const vulnCount = document.querySelectorAll('#androidAppVulnerabilityContainer .vulnerability-entry').length;
            if (vulnCount === 0) {
                alert('At least one vulnerability is required');
                return;
            }

            // Show loading indicator
            showVaptLoadingIndicator();
            const submitBtn = this.querySelector('.submit-btn');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = 'Processing...';

            const formData = new FormData(this);

            // Handle "other" selections
            const organizationSelect = document.getElementById('androidAppOrganization');
            if (organizationSelect && organizationSelect.value === 'other') {
                const otherOrganizationInput = document.getElementById('androidAppOtherOrganization');
                if (otherOrganizationInput && otherOrganizationInput.value && otherOrganizationInput.value.trim() !== '') {
                    formData.set('organization', otherOrganizationInput.value);
                }
            }

            const citySelect = document.getElementById('androidAppCity');
            if (citySelect && citySelect.value === 'other') {
                const otherCityInput = document.getElementById('androidAppOtherCity');
                if (otherCityInput && otherCityInput.value && otherCityInput.value.trim() !== '') {
                    formData.set('city', otherCityInput.value);
                }
            }

            // Submit form
            fetch('/process_android_app_vapt_first_audit_report', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    return response.blob();
                } else {
                    return response.json().then(data => {
                        throw new Error(data.error || 'Error submitting form');
                    });
                }
            })
            .then(blob => {
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'Android_Application_VAPT_First_Audit_Report.xlsx';
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);

                hideVaptLoadingIndicator();

                setTimeout(() => {
                    location.reload();
                }, 500);
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
                hideVaptLoadingIndicator();
            });
        });
    }

    // IOS Mobile Application First Audit Form Submission Handler
    const iosAppFirstAuditForm = document.getElementById('iosAppFirstAuditForm');
    if (iosAppFirstAuditForm) {
        iosAppFirstAuditForm.addEventListener('submit', function(e) {
            e.preventDefault();

            const vulnCount = document.querySelectorAll('#iosAppVulnerabilityContainer .vulnerability-entry').length;
            if (vulnCount === 0) {
                alert('At least one vulnerability is required');
                return;
            }

            showVaptLoadingIndicator();
            const submitBtn = this.querySelector('.submit-btn');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = 'Processing...';

            const formData = new FormData(this);

            const organizationSelect = document.getElementById('iosAppOrganization');
            if (organizationSelect && organizationSelect.value === 'other') {
                const otherOrganizationInput = document.getElementById('iosAppOtherOrganization');
                if (otherOrganizationInput && otherOrganizationInput.value && otherOrganizationInput.value.trim() !== '') {
                    formData.set('organization', otherOrganizationInput.value);
                }
            }

            const citySelect = document.getElementById('iosAppCity');
            if (citySelect && citySelect.value === 'other') {
                const otherCityInput = document.getElementById('iosAppOtherCity');
                if (otherCityInput && otherCityInput.value && otherCityInput.value.trim() !== '') {
                    formData.set('city', otherCityInput.value);
                }
            }

            fetch('/process_ios_app_vapt_first_audit_report', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    return response.blob();
                } else {
                    return response.json().then(data => {
                        throw new Error(data.error || 'Error submitting form');
                    });
                }
            })
            .then(blob => {
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'IOS_Application_VAPT_First_Audit_Report.xlsx';
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);

                hideVaptLoadingIndicator();

                setTimeout(() => {
                    location.reload();
                }, 500);
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
                hideVaptLoadingIndicator();
            });
        });
    }

    // API First Audit Form Submission Handler
    const apiFirstAuditForm = document.getElementById('apiFirstAuditForm');
    if (apiFirstAuditForm) {
        apiFirstAuditForm.addEventListener('submit', function(e) {
            e.preventDefault();

            const vulnCount = document.querySelectorAll('#apiFirstAuditVulnerabilityContainer .vulnerability-entry').length;
            if (vulnCount === 0) {
                alert('At least one vulnerability is required');
                return;
            }

            showVaptLoadingIndicator();
            const submitBtn = this.querySelector('.submit-btn');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = 'Processing...';

            const formData = new FormData(this);

            const organizationSelect = document.getElementById('apiOrganization');
            if (organizationSelect && organizationSelect.value === 'other') {
                const otherOrganizationInput = document.getElementById('apiOtherOrganization');
                if (otherOrganizationInput && otherOrganizationInput.value && otherOrganizationInput.value.trim() !== '') {
                    formData.set('organization', otherOrganizationInput.value);
                }
            }

            const citySelect = document.getElementById('apiCity');
            if (citySelect && citySelect.value === 'other') {
                const otherCityInput = document.getElementById('apiOtherCity');
                if (otherCityInput && otherCityInput.value && otherCityInput.value.trim() !== '') {
                    formData.set('city', otherCityInput.value);
                }
            }

            fetch('/process_api_vapt_first_audit_report', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    return response.blob();
                } else {
                    return response.json().then(data => {
                        throw new Error(data.error || 'Error submitting form');
                    });
                }
            })
            .then(blob => {
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'API_VAPT_First_Audit_Report.xlsx';
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);

                hideVaptLoadingIndicator();

                setTimeout(() => {
                    location.reload();
                }, 500);
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
                hideVaptLoadingIndicator();
            });
        });
    }

    // Web Application First Audit Form Submission Handler
    const webAppFirstAuditForm = document.getElementById('webAppFirstAuditForm');
    if (webAppFirstAuditForm) {
        webAppFirstAuditForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Validate vulnerabilities
            const vulnCount = document.querySelectorAll('#webAppVulnerabilityContainer .vulnerability-entry').length;
            if (vulnCount === 0) {
                alert('At least one vulnerability is required');
                return;
            }

            // Validate assets
            const assetCount = document.querySelectorAll('#webAppAssetContainer .asset-entry').length;
            if (assetCount === 0) {
                alert('At least one asset is required');
                return;
            }
            
            // Show loading indicator
            showVaptLoadingIndicator();
            const submitBtn = this.querySelector('.submit-btn');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = 'Processing...';
            
            const formData = new FormData(this);
            
            // Handle "other" selections
            const organizationSelect = document.getElementById('webAppOrganization');
            if (organizationSelect && organizationSelect.value === 'other') {
                const otherOrganizationInput = document.getElementById('webAppOtherOrganization');
                if (otherOrganizationInput && otherOrganizationInput.value && otherOrganizationInput.value.trim() !== '') {
                    formData.set('organization', otherOrganizationInput.value);
                }
            }
            
            const citySelect = document.getElementById('webAppCity');
            if (citySelect && citySelect.value === 'other') {
                const otherCityInput = document.getElementById('webAppOtherCity');
                if (otherCityInput && otherCityInput.value && otherCityInput.value.trim() !== '') {
                    formData.set('city', otherCityInput.value);
                }
            }
            
            // Submit form
            fetch('/process_web_app_vapt_first_audit_report', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    // Get the blob
                    return response.blob();
                } else {
                    return response.json().then(data => {
                        throw new Error(data.error || 'Error submitting form');
                    });
                }
            })
            .then(blob => {
                // Create download link
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'Web_Application_VAPT_First_Audit_Report.xlsx';
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                // Hide loading indicator
                hideVaptLoadingIndicator();
                
                // Refresh page after a short delay
                setTimeout(() => {
                    location.reload();
                }, 500);
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
                hideVaptLoadingIndicator();
            });
        });
    }

        // Android Mobile Application Follow-Up - Add Email
        const androidAppFollowUpAddEmailBtn = document.getElementById('androidAppFollowUpAddEmailBtn');
        if (androidAppFollowUpAddEmailBtn) {
            androidAppFollowUpAddEmailBtn.addEventListener('click', function() {
                const emailContainer = document.getElementById('androidAppFollowUpEmailContainer');
                const newEmailField = document.createElement('div');
                newEmailField.style.display = 'flex';
                newEmailField.style.gap = '10px';
                newEmailField.style.marginTop = '10px';
                newEmailField.innerHTML = `
                    <input type="email" name="bankEmail[]" placeholder="Email Address" required style="flex: 1;">
                    <button type="button" onclick="removeVaptEmailField(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; cursor: pointer;">Remove</button>
                `;
                emailContainer.appendChild(newEmailField);
            });
        }

        // Android Mobile Application Follow-Up - Add Team Member
        const androidAppFollowUpAddMemberBtn = document.getElementById('androidAppFollowUpAddMemberBtn');
        if (androidAppFollowUpAddMemberBtn) {
            androidAppFollowUpAddMemberBtn.addEventListener('click', function() {
                const teamContainer = document.getElementById('androidAppFollowUpAuditTeamContainer');
                const teamMembers = teamContainer.querySelectorAll('.team-member');
                
                if (teamMembers.length >= 8) {
                    alert('Maximum 8 team members allowed');
                    return;
                }
                
                const newIndex = teamMembers.length;
                const newMember = document.createElement('div');
                newMember.className = 'team-member';
                newMember.setAttribute('data-index', newIndex);
                newMember.innerHTML = `
                    <div class="form-row">
                        <div class="form-group">
                            <input type="text" name="teamName[]" placeholder="Name*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamQualification[]" placeholder="Qualification/Certification*" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Certified (Yes/No)*</label>
                        <div class="radio-group">
                            <label><input type="radio" name="teamCertified[${newIndex}]" value="yes" required> Yes</label>
                            <label><input type="radio" name="teamCertified[${newIndex}]" value="no"> No</label>
                        </div>
                    </div>
                `;
                teamContainer.appendChild(newMember);
            });
        }

        // Android Mobile Application Follow-Up - Add New Vulnerability
        const androidAppFollowUpAddVulnerabilityBtn = document.getElementById('androidAppFollowUpAddVulnerabilityBtn');
        if (androidAppFollowUpAddVulnerabilityBtn) {
            androidAppFollowUpAddVulnerabilityBtn.addEventListener('click', function() {
                const vulnContainer = document.getElementById('androidAppFollowUpVulnerabilityContainer');
                const vulnEntries = vulnContainer.querySelectorAll('.vulnerability-entry');
                const newIndex = vulnEntries.length;
                
                const newVulnEntry = document.createElement('div');
                newVulnEntry.className = 'vulnerability-entry';
                newVulnEntry.setAttribute('data-vuln-index', newIndex);
                newVulnEntry.innerHTML = `
                    <hr style="margin: 20px 0; border: none; border-top: 1px solid #ddd;">
                    <h4 style="color: #2c3e50; margin-bottom: 10px;">Vulnerability ${newIndex + 1}</h4>
                    
                    <div class="form-group">
                        <label for="androidAppFollowUpVulnVulnerabilities_${newIndex}">Vulnerabilities*</label>
                        <textarea id="androidAppFollowUpVulnVulnerabilities_${newIndex}" name="vulnVulnerabilities[]" placeholder="Enter vulnerabilities" rows="3" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="androidAppFollowUpVulnName_${newIndex}">Name of Vulnerability*</label>
                        <input type="text" id="androidAppFollowUpVulnName_${newIndex}" name="vulnName[]" placeholder="Enter vulnerability name" required>
                    </div>

                    <div class="form-group">
                        <label for="androidAppFollowUpVulnRiskFactor_${newIndex}">Risk Factor*</label>
                        <select id="androidAppFollowUpVulnRiskFactor_${newIndex}" name="vulnRiskFactor[]" required>
                            <option value="">Select Risk Factor</option>
                            <option value="Critical">Critical</option>
                            <option value="High">High</option>
                            <option value="Medium">Medium</option>
                            <option value="Low">Low</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="androidAppFollowUpVulnCVE_${newIndex}">CVE ID</label>
                        <input type="text" id="androidAppFollowUpVulnCVE_${newIndex}" name="vulnCVE[]" placeholder="Enter CVE ID (optional)">
                    </div>

                    <div class="form-group">
                        <label for="androidAppFollowUpVulnCVSS_${newIndex}">CVSS</label>
                        <input type="text" id="androidAppFollowUpVulnCVSS_${newIndex}" name="vulnCVSS[]" placeholder="Enter CVSS score (optional)">
                    </div>

                    <div class="form-group">
                        <label for="androidAppFollowUpVulnObservation_${newIndex}">Audit Observation*</label>
                        <textarea id="androidAppFollowUpVulnObservation_${newIndex}" name="vulnObservation[]" rows="3" placeholder="Enter audit observation" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="androidAppFollowUpVulnImpact_${newIndex}">Impact*</label>
                        <textarea id="androidAppFollowUpVulnImpact_${newIndex}" name="vulnImpact[]" rows="3" placeholder="Enter impact description" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="androidAppFollowUpVulnRecommendation_${newIndex}">Recommendation / Countermeasure*</label>
                        <textarea id="androidAppFollowUpVulnRecommendation_${newIndex}" name="vulnRecommendation[]" rows="3" placeholder="Enter recommendation" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="androidAppFollowUpVulnReference_${newIndex}">Reference Link</label>
                        <textarea id="androidAppFollowUpVulnReference_${newIndex}" name="vulnReference[]" placeholder="Enter reference URL (optional)" rows="2"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="androidAppFollowUpVulnAffectedSystem_${newIndex}">Affected Systems*</label>
                        <input type="text" id="androidAppFollowUpVulnAffectedSystem_${newIndex}" name="vulnAffectedSystem[]" placeholder="Enter affected systems" required>
                    </div>

                    <div class="form-group">
                        <label for="androidAppFollowUpVulnStatus_${newIndex}">Status*</label>
                        <select id="androidAppFollowUpVulnStatus_${newIndex}" name="vulnStatus[]" required>
                            <option value="">Select Status</option>
                            <option value="Open">Open</option>
                            <option value="Closed">Closed</option>
                            <option value="New">New</option>
                            <option value="Closed With Exceptions">Closed With Exceptions</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="androidAppFollowUpVulnRemark_${newIndex}">Remark</label>
                        <textarea id="androidAppFollowUpVulnRemark_${newIndex}" name="vulnRemark[]" rows="2" placeholder="Enter remark (optional)"></textarea>
                    </div>
                `;
                vulnContainer.appendChild(newVulnEntry);
            });
        }

        // Android Mobile Application Follow-Up Audit Form Submission Handler
        const androidAppFollowUpAuditForm = document.getElementById('androidAppFollowUpAuditForm');
        if (androidAppFollowUpAuditForm) {
            androidAppFollowUpAuditForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const userExcelFile = document.getElementById('androidAppFollowUpUserExcelFile').files[0];
            if (!userExcelFile) {
                alert('Please upload the User Excel File (.xlsx)');
                return;
            }
            
            // Read Excel file and extract vulnerabilities
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    // Use SheetJS (xlsx) library to read Excel
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, {type: 'array'});
                    
                    // Find "Android Mobile Application VAPT" worksheet
                    let ws = null;
                    for (let sheetName of workbook.SheetNames) {
                        if (sheetName.includes('Android Mobile Application VAPT')) {
                            ws = workbook.Sheets[sheetName];
                            break;
                        }
                    }
                    
                    if (!ws) {
                        // Try to find first worksheet
                        ws = workbook.Sheets[workbook.SheetNames[0]];
                    }
                    
                    if (!ws) {
                        alert('Could not find worksheet in Excel file');
                        return;
                    }
                    
                    // Convert to JSON to extract data
                    const jsonData = XLSX.utils.sheet_to_json(ws, {header: 1, defval: ''});
                    
                    // Find header row (row with "Name of Vulnerability" or "Vulnerabilities")
                    let headerRowIndex = -1;
                    let nameColIndex = -1;
                    let vulnColIndex = -1;
                    
                    for (let i = 0; i < Math.min(10, jsonData.length); i++) {
                        const row = jsonData[i];
                        for (let j = 0; j < row.length; j++) {
                            const cellValue = String(row[j] || '').toLowerCase();
                            if (cellValue.includes('name of vulnerability') || cellValue.includes('vulnerability name')) {
                                nameColIndex = j;
                            }
                            if (cellValue.includes('vulnerabilities') && !cellValue.includes('name')) {
                                vulnColIndex = j;
                            }
                        }
                        if (nameColIndex >= 0 || vulnColIndex >= 0) {
                            headerRowIndex = i;
                            break;
                        }
                    }
                    
                    if (nameColIndex < 0) {
                        // Try column C (index 2) as default
                        nameColIndex = 2;
                    }
                    if (vulnColIndex < 0) {
                        // Try column B (index 1) as default
                        vulnColIndex = 1;
                    }
                    
                    // Find Status columns in header row
                    const headerRow = jsonData[headerRowIndex >= 0 ? headerRowIndex : 0];
                    const statusColumns = [];
                    
                    for (let j = 0; j < headerRow.length; j++) {
                        const cellValue = String(headerRow[j] || '').trim();
                        if (cellValue.toLowerCase().startsWith('status')) {
                            // Extract date from "Status - DD.MM.YYYY" format
                            const dateMatch = cellValue.match(/(\d{1,2})\.(\d{1,2})\.(\d{4})/);
                            if (dateMatch) {
                                const day = parseInt(dateMatch[1]);
                                const month = parseInt(dateMatch[2]);
                                const year = parseInt(dateMatch[3]);
                                const dateObj = new Date(year, month - 1, day);
                                statusColumns.push({
                                    colIndex: j,
                                    header: cellValue,
                                    date: dateObj,
                                    dateStr: `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`
                                });
                            }
                        }
                    }
                    
                    // Find the latest Status column
                    let latestStatusCol = null;
                    if (statusColumns.length > 0) {
                        statusColumns.sort((a, b) => b.date - a.date); // Sort descending by date
                        latestStatusCol = statusColumns[0];
                        console.log('Found Status columns:', statusColumns.map(s => s.header));
                        console.log('Using latest Status column:', latestStatusCol.header);
                    }
                    
                    // Extract vulnerabilities
                    const vulnerabilities = [];
                    const filteredVulnerabilities = []; // Track filtered out vulnerabilities
                    const startRow = headerRowIndex >= 0 ? headerRowIndex + 1 : 1;
                    
                    for (let i = startRow; i < jsonData.length; i++) {
                        const row = jsonData[i];
                        const name = String(row[nameColIndex] || '').trim();
                        const vuln = String(row[vulnColIndex] || '').trim();
                        
                        if (name || vuln) {
                            // Check status if Status column exists
                            let shouldShow = true;
                            if (latestStatusCol) {
                                const statusValue = String(row[latestStatusCol.colIndex] || '').trim().toUpperCase();
                                if (statusValue === 'NA' || statusValue === 'CLOSED') {
                                    shouldShow = false;
                                    filteredVulnerabilities.push({
                                        name: name || vuln,
                                        description: vuln,
                                        status: statusValue
                                    });
                                }
                            }
                            
                            if (shouldShow) {
                                vulnerabilities.push({
                                    name: name || vuln,
                                    description: vuln
                                });
                            }
                        }
                    }
                    
                    if (vulnerabilities.length === 0 && filteredVulnerabilities.length > 0) {
                        alert('All vulnerabilities are already Closed or NA. No vulnerabilities to process.');
                        return;
                    }
                    
                    if (vulnerabilities.length === 0) {
                        alert('No vulnerabilities found in the Excel file');
                        return;
                    }
                    
                    console.log(`Showing ${vulnerabilities.length} vulnerabilities, filtered out ${filteredVulnerabilities.length} (NA/Closed)`);
                    
                    // Store filtered vulnerabilities info for backend
                    const form = this;
                    form._filteredVulnerabilities = filteredVulnerabilities;
                    form._latestStatusCol = latestStatusCol;
                    
                    // Show vulnerability management popup
                    showAndroidAppFollowUpVulnerabilityPopup(vulnerabilities, this);
                    
                } catch (error) {
                    console.error('Error reading Excel file:', error);
                    alert('Error reading Excel file: ' + error.message);
                }
            };
            
            reader.readAsArrayBuffer(userExcelFile);
        });
    }
    
    // Android Mobile Application Follow-Up Vulnerability Management Popup
    function showAndroidAppFollowUpVulnerabilityPopup(vulnerabilities, form) {
        const dialogOverlay = document.createElement('div');
        dialogOverlay.id = 'androidAppFollowUpVulnDialog';
        dialogOverlay.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 10000;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow-y: auto;
        `;
        
        const dialog = document.createElement('div');
        dialog.style.cssText = `
            background: white;
            border-radius: 8px;
            padding: 30px;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        `;
        
        const title = document.createElement('h2');
        title.textContent = 'Vulnerability Status Management';
        title.style.cssText = 'margin: 0 0 20px 0; color: #2c3e50;';
        dialog.appendChild(title);
        
        const container = document.createElement('div');
        container.id = 'androidAppFollowUpVulnContainer';
        container.style.cssText = 'margin-bottom: 20px;';
        
        vulnerabilities.forEach((vuln, index) => {
            const vulnDiv = document.createElement('div');
            vulnDiv.style.cssText = 'margin-bottom: 20px; padding: 15px; border: 1px solid #ddd; border-radius: 5px;';
            vulnDiv.setAttribute('data-index', index);
            
            const nameLabel = document.createElement('div');
            nameLabel.textContent = vuln.name;
            nameLabel.style.cssText = 'font-weight: bold; margin-bottom: 5px; color: #2c3e50;';
            vulnDiv.appendChild(nameLabel);
            
            const descLabel = document.createElement('div');
            descLabel.textContent = vuln.description;
            descLabel.style.cssText = 'font-size: 12px; color: #999; margin-bottom: 15px; opacity: 0.7;';
            vulnDiv.appendChild(descLabel);
            
            const statusDiv = document.createElement('div');
            statusDiv.style.cssText = 'margin-bottom: 10px;';
            
            const statusLabel = document.createElement('label');
            statusLabel.textContent = 'Status: ';
            statusLabel.style.cssText = 'display: inline-block; width: 80px;';
            statusDiv.appendChild(statusLabel);
            
            const statusSelect = document.createElement('select');
            statusSelect.name = `vuln_${index}_status`;
            statusSelect.id = `vuln_${index}_status`;
            statusSelect.required = true;
            statusSelect.style.cssText = 'padding: 5px; width: 150px; border: 1px solid #ddd; border-radius: 4px;';
            statusSelect.innerHTML = '<option value="">Select Status</option><option value="Open">Open</option><option value="Closed">Closed</option><option value="Closed With Exception">Closed With Exception</option>';
            statusSelect.addEventListener('change', function() {
                checkAllFieldsFilled();
            });
            statusDiv.appendChild(statusSelect);
            
            vulnDiv.appendChild(statusDiv);
            
            const remarkDiv = document.createElement('div');
            const remarkLabel = document.createElement('label');
            remarkLabel.textContent = 'Remark: ';
            remarkLabel.style.cssText = 'display: block; margin-bottom: 5px;';
            remarkDiv.appendChild(remarkLabel);
            
            const remarkTextarea = document.createElement('textarea');
            remarkTextarea.name = `vuln_${index}_remark`;
            remarkTextarea.id = `vuln_${index}_remark`;
            remarkTextarea.required = true;
            remarkTextarea.rows = 3;
            remarkTextarea.style.cssText = 'width: 100%; padding: 5px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box;';
            remarkTextarea.addEventListener('input', function() {
                checkAllFieldsFilled();
            });
            remarkDiv.appendChild(remarkTextarea);
            
            vulnDiv.appendChild(remarkDiv);
            container.appendChild(vulnDiv);
        });
        
        dialog.appendChild(container);
        
        const buttonContainer = document.createElement('div');
        buttonContainer.style.cssText = 'display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;';
        
        const cancelButton = document.createElement('button');
        cancelButton.textContent = 'Cancel';
        cancelButton.className = 'cancel-btn';
        cancelButton.style.cssText = 'padding: 10px 20px; background-color: #e74c3c; color: white; border: none; border-radius: 4px; cursor: pointer;';
        cancelButton.onclick = function() {
            dialogOverlay.remove();
        };
        buttonContainer.appendChild(cancelButton);
        
        const submitButton = document.createElement('button');
        submitButton.textContent = 'Submit';
        submitButton.className = 'submit-btn';
        submitButton.id = 'androidAppFollowUpVulnSubmitBtn';
        submitButton.style.cssText = 'padding: 10px 20px; background-color: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer;';
        submitButton.disabled = true;
        submitButton.onclick = function() {
            submitAndroidVulnerabilityData(vulnerabilities, form, dialogOverlay);
        };
        buttonContainer.appendChild(submitButton);
        
        dialog.appendChild(buttonContainer);
        dialogOverlay.appendChild(dialog);
        document.body.appendChild(dialogOverlay);
        
        function checkAllFieldsFilled() {
            let allFilled = true;
            vulnerabilities.forEach((vuln, index) => {
                const status = document.getElementById(`vuln_${index}_status`).value;
                const remark = document.getElementById(`vuln_${index}_remark`).value.trim();
                if (!status || !remark) {
                    allFilled = false;
                }
            });
            submitButton.disabled = !allFilled;
        }
    }
    
    function submitAndroidVulnerabilityData(vulnerabilities, form, dialogOverlay) {
        console.log('Submitting vulnerability data...');
        
        const vulnerabilityData = [];
        vulnerabilities.forEach((vuln, index) => {
            const status = document.getElementById(`vuln_${index}_status`).value;
            const remark = document.getElementById(`vuln_${index}_remark`).value.trim();
            vulnerabilityData.push({
                name: vuln.name,
                description: vuln.description,
                status: status,
                remark: remark
            });
        });
        
        console.log('Vulnerability data:', vulnerabilityData);
        
        // Close popup first
        dialogOverlay.remove();
        
        // Show loading indicator
        showVaptLoadingIndicator();
        
        // Get the form element directly
        const formElement = document.getElementById('androidAppFollowUpAuditForm');
        if (!formElement) {
            alert('Form not found. Please refresh the page and try again.');
            hideVaptLoadingIndicator();
            return;
        }
        
        // Get the original submit button from the form
        const originalSubmitBtn = formElement.querySelector('.submit-btn');
        const originalText = originalSubmitBtn ? originalSubmitBtn.textContent : 'Submit Report';
        if (originalSubmitBtn) {
            originalSubmitBtn.disabled = true;
            originalSubmitBtn.textContent = 'Processing...';
        }

        // Create FormData and add all form fields
        const formData = new FormData(formElement);
        
        // Add vulnerability data as JSON
        formData.append('vulnerabilityData', JSON.stringify(vulnerabilityData));
        
        // Add filtered vulnerabilities info (for backend to add NA values)
        if (formElement && formElement._filteredVulnerabilities) {
            formData.append('filteredVulnerabilities', JSON.stringify(formElement._filteredVulnerabilities));
        }
        
        // Ensure all file inputs are included
        const userExcelFile = document.getElementById('androidAppFollowUpUserExcelFile');
        if (!userExcelFile || !userExcelFile.files[0]) {
            alert('User Excel file is missing. Please upload the file again.');
            hideVaptLoadingIndicator();
            if (originalSubmitBtn) {
                originalSubmitBtn.disabled = false;
                originalSubmitBtn.textContent = originalText;
            }
            return;
        }
        formData.append('userExcelFile', userExcelFile.files[0]);
        console.log('User Excel file included:', userExcelFile.files[0].name);
        
        const newPOCFile = document.getElementById('androidAppFollowUpNewPOCFile');
        if (newPOCFile && newPOCFile.files[0]) {
            formData.append('newPOCFiles', newPOCFile.files[0]);
            console.log('New POC file included:', newPOCFile.files[0].name);
        }
        
        // Ensure date fields are included
        const startDate = document.getElementById('androidAppFollowUpStartDate');
        if (startDate && startDate.value) {
            formData.append('startDate', startDate.value);
        }
        
        const endDate = document.getElementById('androidAppFollowUpEndDate');
        if (endDate && endDate.value) {
            formData.append('endDate', endDate.value);
        }
        
        console.log('Submitting form data...');
        
        // Submit form
        fetch('/process_android_app_vapt_follow_up_audit_report', {
            method: 'POST',
            body: formData
        })
        .then(response => {
            console.log('Response status:', response.status);
            if (response.ok) {
                return response.blob();
            } else {
                return response.json().then(data => {
                    throw new Error(data.error || 'Error submitting form');
                });
            }
        })
        .then(blob => {
            console.log('File received, size:', blob.size);
            
            // Create download link
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Android_Application_VAPT_Follow_Up_Audit_Report.xlsx';
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
            document.body.removeChild(a);
            
            console.log('File download initiated');
            
            // Hide loading indicator
            hideVaptLoadingIndicator();
            
            // Refresh page
            setTimeout(() => {
                location.reload();
            }, 500);
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Error: ' + error.message);
            if (originalSubmitBtn) {
                originalSubmitBtn.disabled = false;
                originalSubmitBtn.textContent = originalText;
            }
            hideVaptLoadingIndicator();
        });
    }

        // IOS Mobile Application Follow-Up Audit Form Submission Handler
        const iosAppFollowUpAuditForm = document.getElementById('iosAppFollowUpAuditForm');
        if (iosAppFollowUpAuditForm) {
            iosAppFollowUpAuditForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const userExcelFile = document.getElementById('iosAppFollowUpUserExcelFile').files[0];
            if (!userExcelFile) {
                alert('Please upload the User Excel File (.xlsx)');
                return;
            }
            
            // Read Excel file and extract vulnerabilities
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    // Use SheetJS (xlsx) library to read Excel
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, {type: 'array'});
                    
                    // Find "IOS Mobile Application VAPT" worksheet
                    let ws = null;
                    for (let sheetName of workbook.SheetNames) {
                        if (sheetName.includes('IOS Mobile Application VAPT') || sheetName.includes('iOS Mobile Application VAPT')) {
                            ws = workbook.Sheets[sheetName];
                            break;
                        }
                    }
                    
                    if (!ws) {
                        // Try to find first worksheet
                        ws = workbook.Sheets[workbook.SheetNames[0]];
                    }
                    
                    if (!ws) {
                        alert('Could not find worksheet in Excel file');
                        return;
                    }
                    
                    // Convert to JSON to extract data
                    const jsonData = XLSX.utils.sheet_to_json(ws, {header: 1, defval: ''});
                    
                    // Find header row (row with "Name of Vulnerability" or "Vulnerabilities")
                    let headerRowIndex = -1;
                    let nameColIndex = -1;
                    let vulnColIndex = -1;
                    
                    for (let i = 0; i < Math.min(10, jsonData.length); i++) {
                        const row = jsonData[i];
                        for (let j = 0; j < row.length; j++) {
                            const cellValue = String(row[j] || '').toLowerCase();
                            if (cellValue.includes('name of vulnerability') || cellValue.includes('vulnerability name')) {
                                nameColIndex = j;
                            }
                            if (cellValue.includes('vulnerabilities') && !cellValue.includes('name')) {
                                vulnColIndex = j;
                            }
                        }
                        if (nameColIndex >= 0 || vulnColIndex >= 0) {
                            headerRowIndex = i;
                            break;
                        }
                    }
                    
                    if (nameColIndex < 0) {
                        // Try column C (index 2) as default
                        nameColIndex = 2;
                    }
                    if (vulnColIndex < 0) {
                        // Try column B (index 1) as default
                        vulnColIndex = 1;
                    }
                    
                    // Find Status columns in header row
                    const headerRow = jsonData[headerRowIndex >= 0 ? headerRowIndex : 0];
                    const statusColumns = [];
                    
                    for (let j = 0; j < headerRow.length; j++) {
                        const cellValue = String(headerRow[j] || '').trim();
                        if (cellValue.toLowerCase().startsWith('status')) {
                            // Extract date from "Status - DD.MM.YYYY" format
                            const dateMatch = cellValue.match(/(\d{1,2})\.(\d{1,2})\.(\d{4})/);
                            if (dateMatch) {
                                const day = parseInt(dateMatch[1]);
                                const month = parseInt(dateMatch[2]);
                                const year = parseInt(dateMatch[3]);
                                const dateObj = new Date(year, month - 1, day);
                                statusColumns.push({
                                    colIndex: j,
                                    header: cellValue,
                                    date: dateObj,
                                    dateStr: `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`
                                });
                            }
                        }
                    }
                    
                    // Find the latest Status column
                    let latestStatusCol = null;
                    if (statusColumns.length > 0) {
                        statusColumns.sort((a, b) => b.date - a.date); // Sort descending by date
                        latestStatusCol = statusColumns[0];
                        console.log('Found Status columns:', statusColumns.map(s => s.header));
                        console.log('Using latest Status column:', latestStatusCol.header);
                    }
                    
                    // Extract vulnerabilities
                    const vulnerabilities = [];
                    const filteredVulnerabilities = []; // Track filtered out vulnerabilities
                    const startRow = headerRowIndex >= 0 ? headerRowIndex + 1 : 1;
                    
                    for (let i = startRow; i < jsonData.length; i++) {
                        const row = jsonData[i];
                        const name = String(row[nameColIndex] || '').trim();
                        const vuln = String(row[vulnColIndex] || '').trim();
                        
                        if (name || vuln) {
                            // Check status if Status column exists
                            let shouldShow = true;
                            if (latestStatusCol) {
                                const statusValue = String(row[latestStatusCol.colIndex] || '').trim().toUpperCase();
                                if (statusValue === 'NA' || statusValue === 'CLOSED') {
                                    shouldShow = false;
                                    filteredVulnerabilities.push({
                                        name: name || vuln,
                                        description: vuln,
                                        status: statusValue
                                    });
                                }
                            }
                            
                            if (shouldShow) {
                                vulnerabilities.push({
                                    name: name || vuln,
                                    description: vuln
                                });
                            }
                        }
                    }
                    
                    if (vulnerabilities.length === 0 && filteredVulnerabilities.length > 0) {
                        alert('All vulnerabilities are already Closed or NA. No vulnerabilities to process.');
                        return;
                    }
                    
                    if (vulnerabilities.length === 0) {
                        alert('No vulnerabilities found in the Excel file');
                        return;
                    }
                    
                    console.log(`Showing ${vulnerabilities.length} vulnerabilities, filtered out ${filteredVulnerabilities.length} (NA/Closed)`);
                    
                    // Store filtered vulnerabilities info for backend
                    const form = this;
                    form._filteredVulnerabilities = filteredVulnerabilities;
                    form._latestStatusCol = latestStatusCol;
                    
                    // Show vulnerability management popup
                    showIOSAppFollowUpVulnerabilityPopup(vulnerabilities, this);
                    
                } catch (error) {
                    console.error('Error reading Excel file:', error);
                    alert('Error reading Excel file: ' + error.message);
                }
            };
            
            reader.readAsArrayBuffer(userExcelFile);
        });
    }
    
    // IOS Mobile Application Follow-Up Vulnerability Management Popup
    function showIOSAppFollowUpVulnerabilityPopup(vulnerabilities, form) {
        const dialogOverlay = document.createElement('div');
        dialogOverlay.id = 'iosAppFollowUpVulnDialog';
        dialogOverlay.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 10000;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow-y: auto;
        `;
        
        const dialog = document.createElement('div');
        dialog.style.cssText = `
            background: white;
            border-radius: 8px;
            padding: 30px;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        `;
        
        const title = document.createElement('h2');
        title.textContent = 'Vulnerability Status Management';
        title.style.cssText = 'margin: 0 0 20px 0; color: #2c3e50;';
        dialog.appendChild(title);
        
        const container = document.createElement('div');
        container.id = 'iosAppFollowUpVulnContainer';
        container.style.cssText = 'margin-bottom: 20px;';
        
        vulnerabilities.forEach((vuln, index) => {
            const vulnDiv = document.createElement('div');
            vulnDiv.style.cssText = 'margin-bottom: 20px; padding: 15px; border: 1px solid #ddd; border-radius: 5px;';
            vulnDiv.setAttribute('data-index', index);
            
            const nameLabel = document.createElement('div');
            nameLabel.textContent = vuln.name;
            nameLabel.style.cssText = 'font-weight: bold; margin-bottom: 5px; color: #2c3e50;';
            vulnDiv.appendChild(nameLabel);
            
            const descLabel = document.createElement('div');
            descLabel.textContent = vuln.description;
            descLabel.style.cssText = 'font-size: 12px; color: #999; margin-bottom: 15px; opacity: 0.7;';
            vulnDiv.appendChild(descLabel);
            
            const statusDiv = document.createElement('div');
            statusDiv.style.cssText = 'margin-bottom: 10px;';
            
            const statusLabel = document.createElement('label');
            statusLabel.textContent = 'Status: ';
            statusLabel.style.cssText = 'display: inline-block; width: 80px;';
            statusDiv.appendChild(statusLabel);
            
            const statusSelect = document.createElement('select');
            statusSelect.name = `vuln_${index}_status`;
            statusSelect.id = `vuln_${index}_status`;
            statusSelect.required = true;
            statusSelect.style.cssText = 'padding: 5px; width: 150px; border: 1px solid #ddd; border-radius: 4px;';
            statusSelect.innerHTML = '<option value="">Select Status</option><option value="Open">Open</option><option value="Closed">Closed</option><option value="Closed With Exception">Closed With Exception</option>';
            statusSelect.addEventListener('change', function() {
                checkAllFieldsFilled();
            });
            statusDiv.appendChild(statusSelect);
            
            vulnDiv.appendChild(statusDiv);
            
            const remarkDiv = document.createElement('div');
            const remarkLabel = document.createElement('label');
            remarkLabel.textContent = 'Remark: ';
            remarkLabel.style.cssText = 'display: block; margin-bottom: 5px;';
            remarkDiv.appendChild(remarkLabel);
            
            const remarkTextarea = document.createElement('textarea');
            remarkTextarea.name = `vuln_${index}_remark`;
            remarkTextarea.id = `vuln_${index}_remark`;
            remarkTextarea.required = true;
            remarkTextarea.rows = 3;
            remarkTextarea.style.cssText = 'width: 100%; padding: 5px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box;';
            remarkTextarea.addEventListener('input', function() {
                checkAllFieldsFilled();
            });
            remarkDiv.appendChild(remarkTextarea);
            
            vulnDiv.appendChild(remarkDiv);
            container.appendChild(vulnDiv);
        });
        
        dialog.appendChild(container);
        
        const buttonContainer = document.createElement('div');
        buttonContainer.style.cssText = 'display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;';
        
        const cancelButton = document.createElement('button');
        cancelButton.textContent = 'Cancel';
        cancelButton.className = 'cancel-btn';
        cancelButton.style.cssText = 'padding: 10px 20px; background-color: #e74c3c; color: white; border: none; border-radius: 4px; cursor: pointer;';
        cancelButton.onclick = function() {
            dialogOverlay.remove();
        };
        buttonContainer.appendChild(cancelButton);
        
        const submitButton = document.createElement('button');
        submitButton.textContent = 'Submit';
        submitButton.className = 'submit-btn';
        submitButton.id = 'iosAppFollowUpVulnSubmitBtn';
        submitButton.style.cssText = 'padding: 10px 20px; background-color: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer;';
        submitButton.disabled = true;
        submitButton.onclick = function() {
            submitIOSVulnerabilityData(vulnerabilities, form, dialogOverlay);
        };
        buttonContainer.appendChild(submitButton);
        
        dialog.appendChild(buttonContainer);
        dialogOverlay.appendChild(dialog);
        document.body.appendChild(dialogOverlay);
        
        function checkAllFieldsFilled() {
            let allFilled = true;
            vulnerabilities.forEach((vuln, index) => {
                const status = document.getElementById(`vuln_${index}_status`).value;
                const remark = document.getElementById(`vuln_${index}_remark`).value.trim();
                if (!status || !remark) {
                    allFilled = false;
                }
            });
            submitButton.disabled = !allFilled;
        }
    }
    
    function submitIOSVulnerabilityData(vulnerabilities, form, dialogOverlay) {
        console.log('Submitting vulnerability data...');
        
        const vulnerabilityData = [];
        vulnerabilities.forEach((vuln, index) => {
            const status = document.getElementById(`vuln_${index}_status`).value;
            const remark = document.getElementById(`vuln_${index}_remark`).value.trim();
            vulnerabilityData.push({
                name: vuln.name,
                description: vuln.description,
                status: status,
                remark: remark
            });
        });
        
        console.log('Vulnerability data:', vulnerabilityData);
        
        // Close popup first
        dialogOverlay.remove();
        
        // Show loading indicator
        showVaptLoadingIndicator();
        
        // Get the form element directly
        const formElement = document.getElementById('iosAppFollowUpAuditForm');
        if (!formElement) {
            alert('Form not found. Please refresh the page and try again.');
            hideVaptLoadingIndicator();
            return;
        }
        
        // Get the original submit button from the form
        const originalSubmitBtn = formElement.querySelector('.submit-btn');
        const originalText = originalSubmitBtn ? originalSubmitBtn.textContent : 'Submit Report';
        if (originalSubmitBtn) {
            originalSubmitBtn.disabled = true;
            originalSubmitBtn.textContent = 'Processing...';
        }

        // Create FormData and add all form fields
        const formData = new FormData(formElement);
        
        // Add vulnerability data as JSON
        formData.append('vulnerabilityData', JSON.stringify(vulnerabilityData));
        
        // Add filtered vulnerabilities info (for backend to add NA values)
        if (formElement && formElement._filteredVulnerabilities) {
            formData.append('filteredVulnerabilities', JSON.stringify(formElement._filteredVulnerabilities));
        }
        
        // Ensure all file inputs are included
        const userExcelFile = document.getElementById('iosAppFollowUpUserExcelFile');
        if (!userExcelFile || !userExcelFile.files[0]) {
            alert('User Excel file is missing. Please upload the file again.');
            hideVaptLoadingIndicator();
            if (originalSubmitBtn) {
                originalSubmitBtn.disabled = false;
                originalSubmitBtn.textContent = originalText;
            }
            return;
        }
        formData.append('userExcelFile', userExcelFile.files[0]);
        console.log('User Excel file included:', userExcelFile.files[0].name);
        
        const newPOCFile = document.getElementById('iosAppFollowUpNewPOCFile');
        if (newPOCFile && newPOCFile.files[0]) {
            formData.append('newPOCFiles', newPOCFile.files[0]);
            console.log('New POC file included:', newPOCFile.files[0].name);
        }
        
        // Ensure date fields are included
        const startDate = document.getElementById('iosAppFollowUpStartDate');
        if (startDate && startDate.value) {
            formData.append('startDate', startDate.value);
        }
        
        const endDate = document.getElementById('iosAppFollowUpEndDate');
        if (endDate && endDate.value) {
            formData.append('endDate', endDate.value);
        }
        
        console.log('Submitting form data...');
        
        // Submit form
        fetch('/process_ios_app_vapt_follow_up_audit_report', {
            method: 'POST',
            body: formData
        })
        .then(response => {
            console.log('Response status:', response.status);
            if (response.ok) {
                return response.blob();
            } else {
                return response.json().then(data => {
                    throw new Error(data.error || 'Error submitting form');
                });
            }
        })
        .then(blob => {
            console.log('File received, size:', blob.size);
            
            // Create download link
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'IOS_Application_VAPT_Follow_Up_Audit_Report.xlsx';
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
            document.body.removeChild(a);
            
            console.log('File download initiated');
            
            // Hide loading indicator
            hideVaptLoadingIndicator();
            
            // Refresh page
            setTimeout(() => {
                location.reload();
            }, 500);
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Error: ' + error.message);
            if (originalSubmitBtn) {
                originalSubmitBtn.disabled = false;
                originalSubmitBtn.textContent = originalText;
            }
            hideVaptLoadingIndicator();
        });
    }

        // API Follow-Up Audit Form Submission Handler
        const apiFollowUpAuditForm = document.getElementById('apiFollowUpAuditForm');
        if (apiFollowUpAuditForm) {
            apiFollowUpAuditForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const userExcelFile = document.getElementById('apiFollowUpUserExcelFile').files[0];
            if (!userExcelFile) {
                alert('Please upload the User Excel File (.xlsx)');
                return;
            }
            
            // Read Excel file and extract vulnerabilities
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    // Use SheetJS (xlsx) library to read Excel
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, {type: 'array'});
                    
                    // Find "API VAPT" worksheet
                    let ws = null;
                    for (let sheetName of workbook.SheetNames) {
                        if (sheetName.includes('API VAPT') || sheetName.includes('API_VAPT')) {
                            ws = workbook.Sheets[sheetName];
                            break;
                        }
                    }
                    
                    if (!ws) {
                        // Try first worksheet
                        ws = workbook.Sheets[workbook.SheetNames[0]];
                    }
                    
                    if (!ws) {
                        alert('Could not find worksheet in Excel file');
                        return;
                    }
                    
                    // Convert to JSON to extract data
                    const jsonData = XLSX.utils.sheet_to_json(ws, {header: 1, defval: ''});
                    
                    // Find header row (row with "Name of Vulnerability" or "Vulnerabilities")
                    let headerRowIndex = -1;
                    let nameColIndex = -1;
                    let vulnColIndex = -1;
                    
                    for (let i = 0; i < Math.min(10, jsonData.length); i++) {
                        const row = jsonData[i];
                        for (let j = 0; j < row.length; j++) {
                            const cellValue = String(row[j] || '').toLowerCase();
                            if (cellValue.includes('name of vulnerability') || cellValue.includes('vulnerability name')) {
                                nameColIndex = j;
                            }
                            if (cellValue.includes('vulnerabilities') && !cellValue.includes('name')) {
                                vulnColIndex = j;
                            }
                        }
                        if (nameColIndex >= 0 || vulnColIndex >= 0) {
                            headerRowIndex = i;
                            break;
                        }
                    }
                    
                    if (nameColIndex < 0) {
                        // Try column C (index 2) as default
                        nameColIndex = 2;
                    }
                    if (vulnColIndex < 0) {
                        // Try column B (index 1) as default
                        vulnColIndex = 1;
                    }
                    
                    // Find Status columns in header row
                    const headerRow = jsonData[headerRowIndex >= 0 ? headerRowIndex : 0];
                    const statusColumns = [];
                    
                    for (let j = 0; j < headerRow.length; j++) {
                        const cellValue = String(headerRow[j] || '').trim();
                        if (cellValue.toLowerCase().startsWith('status')) {
                            // Extract date from "Status - DD.MM.YYYY" format
                            const dateMatch = cellValue.match(/(\d{1,2})\.(\d{1,2})\.(\d{4})/);
                            if (dateMatch) {
                                const day = parseInt(dateMatch[1]);
                                const month = parseInt(dateMatch[2]);
                                const year = parseInt(dateMatch[3]);
                                const dateObj = new Date(year, month - 1, day);
                                statusColumns.push({
                                    colIndex: j,
                                    header: cellValue,
                                    date: dateObj,
                                    dateStr: `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`
                                });
                            }
                        }
                    }
                    
                    // Find the latest Status column
                    let latestStatusCol = null;
                    if (statusColumns.length > 0) {
                        statusColumns.sort((a, b) => b.date - a.date); // Sort descending by date
                        latestStatusCol = statusColumns[0];
                        console.log('Found Status columns:', statusColumns.map(s => s.header));
                        console.log('Using latest Status column:', latestStatusCol.header);
                    }
                    
                    // Extract vulnerabilities
                    const vulnerabilities = [];
                    const filteredVulnerabilities = []; // Track filtered out vulnerabilities
                    const startRow = headerRowIndex >= 0 ? headerRowIndex + 1 : 1;
                    
                    for (let i = startRow; i < jsonData.length; i++) {
                        const row = jsonData[i];
                        const name = String(row[nameColIndex] || '').trim();
                        const vuln = String(row[vulnColIndex] || '').trim();
                        
                        if (name || vuln) {
                            // Check status if Status column exists
                            let shouldShow = true;
                            if (latestStatusCol) {
                                const statusValue = String(row[latestStatusCol.colIndex] || '').trim().toUpperCase();
                                if (statusValue === 'NA' || statusValue === 'CLOSED') {
                                    shouldShow = false;
                                    filteredVulnerabilities.push({
                                        name: name || vuln,
                                        description: vuln,
                                        status: statusValue
                                    });
                                }
                            }
                            
                            if (shouldShow) {
                                vulnerabilities.push({
                                    name: name || vuln,
                                    description: vuln
                                });
                            }
                        }
                    }
                    
                    if (vulnerabilities.length === 0 && filteredVulnerabilities.length > 0) {
                        alert('All vulnerabilities are already Closed or NA. No vulnerabilities to process.');
                        return;
                    }
                    
                    if (vulnerabilities.length === 0) {
                        alert('No vulnerabilities found in the Excel file');
                        return;
                    }
                    
                    console.log(`Showing ${vulnerabilities.length} vulnerabilities, filtered out ${filteredVulnerabilities.length} (NA/Closed)`);
                    
                    // Store filtered vulnerabilities info for backend
                    const form = this;
                    form._filteredVulnerabilities = filteredVulnerabilities;
                    form._latestStatusCol = latestStatusCol;
                    
                    // Show vulnerability management popup
                    showApiFollowUpVulnerabilityPopup(vulnerabilities, this);
                } catch (error) {
                    console.error('Error reading Excel file:', error);
                    alert('Error reading Excel file: ' + error.message);
                }
            };
            
            reader.readAsArrayBuffer(userExcelFile);
        });
    }

        // Web Application Follow-Up - Add Email

        // Web Application Follow-Up Audit Form Submission Handler
        const webAppFollowUpAuditForm = document.getElementById('webAppFollowUpAuditForm');
        if (webAppFollowUpAuditForm) {
            webAppFollowUpAuditForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const userExcelFile = document.getElementById('webAppFollowUpUserExcelFile').files[0];
            if (!userExcelFile) {
                alert('Please upload the User Excel File (.xlsx)');
                return;
            }
            
            // Read Excel file and extract vulnerabilities
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    // Use SheetJS (xlsx) library to read Excel
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, {type: 'array'});
                    
                    // Find "Web Application VAPT" worksheet
                    let ws = null;
                    for (let sheetName of workbook.SheetNames) {
                        if (sheetName.includes('Web Application VAPT') || sheetName.includes('Website_VAPT')) {
                            ws = workbook.Sheets[sheetName];
                            break;
                        }
                    }
                    
                    if (!ws) {
                        // Try to find first worksheet
                        ws = workbook.Sheets[workbook.SheetNames[0]];
                    }
                    
                    if (!ws) {
                        alert('Could not find worksheet in Excel file');
                        return;
                    }
                    
                    // Convert to JSON to extract data
                    const jsonData = XLSX.utils.sheet_to_json(ws, {header: 1, defval: ''});
                    
                    // Find header row (row with "Name of Vulnerability" or "Vulnerabilities")
                    let headerRowIndex = -1;
                    let nameColIndex = -1;
                    let vulnColIndex = -1;
                    
                    for (let i = 0; i < Math.min(10, jsonData.length); i++) {
                        const row = jsonData[i];
                        for (let j = 0; j < row.length; j++) {
                            const cellValue = String(row[j] || '').toLowerCase();
                            if (cellValue.includes('name of vulnerability') || cellValue.includes('vulnerability name')) {
                                nameColIndex = j;
                            }
                            if (cellValue.includes('vulnerabilities') && !cellValue.includes('name')) {
                                vulnColIndex = j;
                            }
                        }
                        if (nameColIndex >= 0 || vulnColIndex >= 0) {
                            headerRowIndex = i;
                            break;
                        }
                    }
                    
                    if (nameColIndex < 0) {
                        // Try column C (index 2) as default
                        nameColIndex = 2;
                    }
                    if (vulnColIndex < 0) {
                        // Try column B (index 1) as default
                        vulnColIndex = 1;
                    }
                    
                    // Find Status columns in header row
                    const headerRow = jsonData[headerRowIndex >= 0 ? headerRowIndex : 0];
                    const statusColumns = [];
                    
                    for (let j = 0; j < headerRow.length; j++) {
                        const cellValue = String(headerRow[j] || '').trim();
                        if (cellValue.toLowerCase().startsWith('status')) {
                            // Extract date from "Status - DD.MM.YYYY" format
                            const dateMatch = cellValue.match(/(\d{1,2})\.(\d{1,2})\.(\d{4})/);
                            if (dateMatch) {
                                const day = parseInt(dateMatch[1]);
                                const month = parseInt(dateMatch[2]);
                                const year = parseInt(dateMatch[3]);
                                const dateObj = new Date(year, month - 1, day);
                                statusColumns.push({
                                    colIndex: j,
                                    header: cellValue,
                                    date: dateObj,
                                    dateStr: `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`
                                });
                            }
                        }
                    }
                    
                    // Find the latest Status column
                    let latestStatusCol = null;
                    if (statusColumns.length > 0) {
                        statusColumns.sort((a, b) => b.date - a.date); // Sort descending by date
                        latestStatusCol = statusColumns[0];
                        console.log('Found Status columns:', statusColumns.map(s => s.header));
                        console.log('Using latest Status column:', latestStatusCol.header);
                    }
                    
                    // Extract vulnerabilities
                    const vulnerabilities = [];
                    const filteredVulnerabilities = []; // Track filtered out vulnerabilities
                    const startRow = headerRowIndex >= 0 ? headerRowIndex + 1 : 1;
                    
                    for (let i = startRow; i < jsonData.length; i++) {
                        const row = jsonData[i];
                        const name = String(row[nameColIndex] || '').trim();
                        const vuln = String(row[vulnColIndex] || '').trim();
                        
                        if (name || vuln) {
                            // Check status if Status column exists
                            let shouldShow = true;
                            if (latestStatusCol) {
                                const statusValue = String(row[latestStatusCol.colIndex] || '').trim().toUpperCase();
                                if (statusValue === 'NA' || statusValue === 'CLOSED') {
                                    shouldShow = false;
                                    filteredVulnerabilities.push({
                                        name: name || vuln,
                                        description: vuln,
                                        status: statusValue
                                    });
                                }
                            }
                            
                            if (shouldShow) {
                                vulnerabilities.push({
                                    name: name || vuln,
                                    description: vuln
                                });
                            }
                        }
                    }
                    
                    if (vulnerabilities.length === 0 && filteredVulnerabilities.length > 0) {
                        alert('All vulnerabilities are already Closed or NA. No vulnerabilities to process.');
                        return;
                    }
                    
                    if (vulnerabilities.length === 0) {
                        alert('No vulnerabilities found in the Excel file');
                        return;
                    }
                    
                    console.log(`Showing ${vulnerabilities.length} vulnerabilities, filtered out ${filteredVulnerabilities.length} (NA/Closed)`);
                    
                    // Store filtered vulnerabilities info for backend
                    const form = this;
                    form._filteredVulnerabilities = filteredVulnerabilities;
                    form._latestStatusCol = latestStatusCol;
                    
                    // Show vulnerability management popup
                    showWebAppFollowUpVulnerabilityPopup(vulnerabilities, this);
                    
                } catch (error) {
                    console.error('Error reading Excel file:', error);
                    alert('Error reading Excel file: ' + error.message);
                }
            };
            
            reader.readAsArrayBuffer(userExcelFile);
        });
    }
    
    // API Follow-Up Vulnerability Management Popup
    function showApiFollowUpVulnerabilityPopup(vulnerabilities, form) {
        const dialogOverlay = document.createElement('div');
        dialogOverlay.id = 'apiFollowUpVulnDialog';
        dialogOverlay.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 10000;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow-y: auto;
        `;
        
        const dialog = document.createElement('div');
        dialog.style.cssText = `
            background: white;
            border-radius: 8px;
            padding: 30px;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        `;
        
        const title = document.createElement('h2');
        title.textContent = 'Vulnerability Status Management';
        title.style.cssText = 'margin: 0 0 20px 0; color: #2c3e50;';
        dialog.appendChild(title);
        
        const container = document.createElement('div');
        container.id = 'apiFollowUpVulnContainer';
        container.style.cssText = 'margin-bottom: 20px;';
        
        vulnerabilities.forEach((vuln, index) => {
            const vulnDiv = document.createElement('div');
            vulnDiv.style.cssText = 'margin-bottom: 20px; padding: 15px; border: 1px solid #ddd; border-radius: 5px;';
            vulnDiv.setAttribute('data-index', index);
            
            const nameLabel = document.createElement('div');
            nameLabel.textContent = vuln.name;
            nameLabel.style.cssText = 'font-weight: bold; margin-bottom: 5px; color: #2c3e50;';
            vulnDiv.appendChild(nameLabel);
            
            const descLabel = document.createElement('div');
            descLabel.textContent = vuln.description;
            descLabel.style.cssText = 'font-size: 12px; color: #999; margin-bottom: 15px; opacity: 0.7;';
            vulnDiv.appendChild(descLabel);
            
            const statusDiv = document.createElement('div');
            statusDiv.style.cssText = 'margin-bottom: 10px;';
            
            const statusLabel = document.createElement('label');
            statusLabel.textContent = 'Status: ';
            statusLabel.style.cssText = 'display: inline-block; width: 80px;';
            statusDiv.appendChild(statusLabel);
            
            const statusSelect = document.createElement('select');
            statusSelect.name = `vuln_${index}_status`;
            statusSelect.id = `vuln_${index}_status`;
            statusSelect.required = true;
            statusSelect.style.cssText = 'padding: 5px; width: 150px; border: 1px solid #ddd; border-radius: 4px;';
            statusSelect.innerHTML = '<option value="">Select Status</option><option value="Open">Open</option><option value="Closed">Closed</option><option value="Closed With Exception">Closed With Exception</option>';
            statusSelect.addEventListener('change', function() {
                checkAllFieldsFilled();
            });
            statusDiv.appendChild(statusSelect);
            
            vulnDiv.appendChild(statusDiv);
            
            const remarkDiv = document.createElement('div');
            const remarkLabel = document.createElement('label');
            remarkLabel.textContent = 'Remark: ';
            remarkLabel.style.cssText = 'display: block; margin-bottom: 5px;';
            remarkDiv.appendChild(remarkLabel);
            
            const remarkTextarea = document.createElement('textarea');
            remarkTextarea.name = `vuln_${index}_remark`;
            remarkTextarea.id = `vuln_${index}_remark`;
            remarkTextarea.required = true;
            remarkTextarea.rows = 3;
            remarkTextarea.style.cssText = 'width: 100%; padding: 5px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box;';
            remarkTextarea.addEventListener('input', function() {
                checkAllFieldsFilled();
            });
            remarkDiv.appendChild(remarkTextarea);
            
            vulnDiv.appendChild(remarkDiv);
            container.appendChild(vulnDiv);
        });
        
        dialog.appendChild(container);
        
        const buttonContainer = document.createElement('div');
        buttonContainer.style.cssText = 'display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;';
        
        const cancelButton = document.createElement('button');
        cancelButton.textContent = 'Cancel';
        cancelButton.className = 'cancel-btn';
        cancelButton.style.cssText = 'padding: 10px 20px; background-color: #e74c3c; color: white; border: none; border-radius: 4px; cursor: pointer;';
        cancelButton.onclick = function() {
            dialogOverlay.remove();
        };
        buttonContainer.appendChild(cancelButton);
        
        const submitButton = document.createElement('button');
        submitButton.textContent = 'Submit';
        submitButton.className = 'submit-btn';
        submitButton.id = 'apiFollowUpVulnSubmitBtn';
        submitButton.style.cssText = 'padding: 10px 20px; background-color: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer;';
        submitButton.disabled = true;
        submitButton.onclick = function() {
            submitApiVulnerabilityData(vulnerabilities, form, dialogOverlay);
        };
        buttonContainer.appendChild(submitButton);
        
        dialog.appendChild(buttonContainer);
        dialogOverlay.appendChild(dialog);
        document.body.appendChild(dialogOverlay);
        
        function checkAllFieldsFilled() {
            let allFilled = true;
            vulnerabilities.forEach((vuln, index) => {
                const status = document.getElementById(`vuln_${index}_status`).value;
                const remark = document.getElementById(`vuln_${index}_remark`).value.trim();
                if (!status || !remark) {
                    allFilled = false;
                }
            });
            submitButton.disabled = !allFilled;
        }
    }
    
    function submitApiVulnerabilityData(vulnerabilities, form, dialogOverlay) {
        console.log('Submitting vulnerability data...');
        
        const vulnerabilityData = [];
        vulnerabilities.forEach((vuln, index) => {
            const status = document.getElementById(`vuln_${index}_status`).value;
            const remark = document.getElementById(`vuln_${index}_remark`).value.trim();
            vulnerabilityData.push({
                name: vuln.name,
                description: vuln.description,
                status: status,
                remark: remark
            });
        });
        
        console.log('Vulnerability data:', vulnerabilityData);
        
        // Close popup first
        dialogOverlay.remove();
        
        // Show loading indicator
        showVaptLoadingIndicator();
        
        // Get the form element directly
        const formElement = document.getElementById('apiFollowUpAuditForm');
        if (!formElement) {
            alert('Form not found. Please refresh the page and try again.');
            hideVaptLoadingIndicator();
            return;
        }
        
        // Get the original submit button from the form
        const originalSubmitBtn = formElement.querySelector('.submit-btn');
        const originalText = originalSubmitBtn ? originalSubmitBtn.textContent : 'Submit Report';
        if (originalSubmitBtn) {
            originalSubmitBtn.disabled = true;
            originalSubmitBtn.textContent = 'Processing...';
        }

        // Create FormData and add all form fields
        const formData = new FormData(formElement);
        
        // Add vulnerability data as JSON
        formData.append('vulnerabilityData', JSON.stringify(vulnerabilityData));
        
        // Add filtered vulnerabilities info (for backend to add NA values)
        if (formElement && formElement._filteredVulnerabilities) {
            formData.append('filteredVulnerabilities', JSON.stringify(formElement._filteredVulnerabilities));
        }
        
        // Ensure all file inputs are included
        const userExcelFile = document.getElementById('apiFollowUpUserExcelFile');
        if (!userExcelFile || !userExcelFile.files[0]) {
            alert('User Excel file is missing. Please upload the file again.');
            hideVaptLoadingIndicator();
            if (originalSubmitBtn) {
                originalSubmitBtn.disabled = false;
                originalSubmitBtn.textContent = originalText;
            }
            return;
        }
        formData.append('userExcelFile', userExcelFile.files[0]);
        console.log('User Excel file included:', userExcelFile.files[0].name);
        
        const newPOCFile = document.getElementById('apiFollowUpNewPOCFile');
        if (newPOCFile && newPOCFile.files[0]) {
            formData.append('newPOCFiles', newPOCFile.files[0]);
            console.log('New POC file included:', newPOCFile.files[0].name);
        }
        
        // Ensure date fields are included
        const startDate = document.getElementById('apiFollowUpStartDate');
        if (startDate && startDate.value) {
            formData.append('startDate', startDate.value);
        }
        
        const endDate = document.getElementById('apiFollowUpEndDate');
        if (endDate && endDate.value) {
            formData.append('endDate', endDate.value);
        }
        
        console.log('Submitting form data...');
        
        // Submit form
        fetch('/process_api_vapt_follow_up_audit_report', {
            method: 'POST',
            body: formData
        })
        .then(response => {
            console.log('Response status:', response.status);
            if (response.ok) {
                return response.blob();
            } else {
                return response.json().then(data => {
                    throw new Error(data.error || 'Error submitting form');
                });
            }
        })
        .then(blob => {
            console.log('File received, size:', blob.size);
            
            // Create download link
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'API_VAPT_Follow_Up_Audit_Report.xlsx';
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
            document.body.removeChild(a);
            
            console.log('File download initiated');
            
            // Hide loading indicator
            hideVaptLoadingIndicator();
            
            // Close modal and refresh page
            closeVaptModal('apiFollowUpAuditModal');
            setTimeout(() => {
                location.reload();
            }, 1000);
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Error: ' + error.message);
            if (originalSubmitBtn) {
                originalSubmitBtn.disabled = false;
                originalSubmitBtn.textContent = originalText;
            }
            hideVaptLoadingIndicator();
        });
    }

    // Web Application Follow-Up Vulnerability Management Popup
    function showWebAppFollowUpVulnerabilityPopup(vulnerabilities, form) {
        const dialogOverlay = document.createElement('div');
        dialogOverlay.id = 'webAppFollowUpVulnDialog';
        dialogOverlay.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 10000;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow-y: auto;
        `;
        
        const dialog = document.createElement('div');
        dialog.style.cssText = `
            background: white;
            border-radius: 8px;
            padding: 30px;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        `;
        
        const title = document.createElement('h2');
        title.textContent = 'Vulnerability Status Management';
        title.style.cssText = 'margin: 0 0 20px 0; color: #2c3e50;';
        dialog.appendChild(title);
        
        const container = document.createElement('div');
        container.id = 'webAppFollowUpVulnContainer';
        container.style.cssText = 'margin-bottom: 20px;';
        
        vulnerabilities.forEach((vuln, index) => {
            const vulnDiv = document.createElement('div');
            vulnDiv.style.cssText = 'margin-bottom: 20px; padding: 15px; border: 1px solid #ddd; border-radius: 5px;';
            vulnDiv.setAttribute('data-index', index);
            
            const nameLabel = document.createElement('div');
            nameLabel.textContent = vuln.name;
            nameLabel.style.cssText = 'font-weight: bold; margin-bottom: 5px; color: #2c3e50;';
            vulnDiv.appendChild(nameLabel);
            
            const descLabel = document.createElement('div');
            descLabel.textContent = vuln.description;
            descLabel.style.cssText = 'font-size: 12px; color: #999; margin-bottom: 15px; opacity: 0.7;';
            vulnDiv.appendChild(descLabel);
            
            const statusDiv = document.createElement('div');
            statusDiv.style.cssText = 'margin-bottom: 10px;';
            
            const statusLabel = document.createElement('label');
            statusLabel.textContent = 'Status: ';
            statusLabel.style.cssText = 'display: inline-block; width: 80px;';
            statusDiv.appendChild(statusLabel);
            
            const statusSelect = document.createElement('select');
            statusSelect.name = `vuln_${index}_status`;
            statusSelect.id = `vuln_${index}_status`;
            statusSelect.required = true;
            statusSelect.style.cssText = 'padding: 5px; width: 150px; border: 1px solid #ddd; border-radius: 4px;';
            statusSelect.innerHTML = '<option value="">Select Status</option><option value="Open">Open</option><option value="Closed">Closed</option><option value="Closed With Exception">Closed With Exception</option>';
            statusSelect.addEventListener('change', function() {
                checkAllFieldsFilled();
            });
            statusDiv.appendChild(statusSelect);
            
            vulnDiv.appendChild(statusDiv);
            
            const remarkDiv = document.createElement('div');
            const remarkLabel = document.createElement('label');
            remarkLabel.textContent = 'Remark: ';
            remarkLabel.style.cssText = 'display: block; margin-bottom: 5px;';
            remarkDiv.appendChild(remarkLabel);
            
            const remarkTextarea = document.createElement('textarea');
            remarkTextarea.name = `vuln_${index}_remark`;
            remarkTextarea.id = `vuln_${index}_remark`;
            remarkTextarea.required = true;
            remarkTextarea.rows = 3;
            remarkTextarea.style.cssText = 'width: 100%; padding: 5px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box;';
            remarkTextarea.addEventListener('input', function() {
                checkAllFieldsFilled();
            });
            remarkDiv.appendChild(remarkTextarea);
            
            vulnDiv.appendChild(remarkDiv);
            container.appendChild(vulnDiv);
        });
        
        dialog.appendChild(container);
        
        const buttonContainer = document.createElement('div');
        buttonContainer.style.cssText = 'display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;';
        
        const cancelButton = document.createElement('button');
        cancelButton.textContent = 'Cancel';
        cancelButton.className = 'cancel-btn';
        cancelButton.style.cssText = 'padding: 10px 20px; background-color: #e74c3c; color: white; border: none; border-radius: 4px; cursor: pointer;';
        cancelButton.onclick = function() {
            dialogOverlay.remove();
        };
        buttonContainer.appendChild(cancelButton);
        
        const submitButton = document.createElement('button');
        submitButton.textContent = 'Submit';
        submitButton.className = 'submit-btn';
        submitButton.id = 'webAppFollowUpVulnSubmitBtn';
        submitButton.style.cssText = 'padding: 10px 20px; background-color: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer;';
        submitButton.disabled = true;
        submitButton.onclick = function() {
            submitVulnerabilityData(vulnerabilities, form, dialogOverlay);
        };
        buttonContainer.appendChild(submitButton);
        
        dialog.appendChild(buttonContainer);
        dialogOverlay.appendChild(dialog);
        document.body.appendChild(dialogOverlay);
        
        function checkAllFieldsFilled() {
            let allFilled = true;
            vulnerabilities.forEach((vuln, index) => {
                const status = document.getElementById(`vuln_${index}_status`).value;
                const remark = document.getElementById(`vuln_${index}_remark`).value.trim();
                if (!status || !remark) {
                    allFilled = false;
                }
            });
            submitButton.disabled = !allFilled;
        }
    }
    
    function submitVulnerabilityData(vulnerabilities, form, dialogOverlay) {
        console.log('Submitting vulnerability data...');
        
        const vulnerabilityData = [];
        vulnerabilities.forEach((vuln, index) => {
            const status = document.getElementById(`vuln_${index}_status`).value;
            const remark = document.getElementById(`vuln_${index}_remark`).value.trim();
            vulnerabilityData.push({
                name: vuln.name,
                description: vuln.description,
                status: status,
                remark: remark
            });
        });
        
        console.log('Vulnerability data:', vulnerabilityData);
        
        // Close popup first
        dialogOverlay.remove();
        
        // Show loading indicator
        showVaptLoadingIndicator();
        
        // Get the form element directly
        const formElement = document.getElementById('webAppFollowUpAuditForm');
        if (!formElement) {
            alert('Form not found. Please refresh the page and try again.');
            hideVaptLoadingIndicator();
            return;
        }
        
        // Get the original submit button from the form
        const originalSubmitBtn = formElement.querySelector('.submit-btn');
        const originalText = originalSubmitBtn ? originalSubmitBtn.textContent : 'Submit Report';
        if (originalSubmitBtn) {
            originalSubmitBtn.disabled = true;
            originalSubmitBtn.textContent = 'Processing...';
        }

        // Create FormData and add all form fields
        const formData = new FormData(formElement);
        
        // Add vulnerability data as JSON
        formData.append('vulnerabilityData', JSON.stringify(vulnerabilityData));
        
        // Add filtered vulnerabilities info (for backend to add NA values)
        if (formElement && formElement._filteredVulnerabilities) {
            formData.append('filteredVulnerabilities', JSON.stringify(formElement._filteredVulnerabilities));
        }
        
        // Ensure all file inputs are included
        const userExcelFile = document.getElementById('webAppFollowUpUserExcelFile');
        if (!userExcelFile || !userExcelFile.files[0]) {
            alert('User Excel file is missing. Please upload the file again.');
            hideVaptLoadingIndicator();
            if (originalSubmitBtn) {
                originalSubmitBtn.disabled = false;
                originalSubmitBtn.textContent = originalText;
            }
            return;
        }
        formData.append('userExcelFile', userExcelFile.files[0]);
        console.log('User Excel file included:', userExcelFile.files[0].name);
        
        const newPOCFile = document.getElementById('webAppFollowUpNewPOCFile');
        if (newPOCFile && newPOCFile.files[0]) {
            formData.append('newPOCFiles', newPOCFile.files[0]);
            console.log('New POC file included:', newPOCFile.files[0].name);
        }
        
        // Ensure date fields are included
        const startDate = document.getElementById('webAppFollowUpStartDate');
        if (startDate && startDate.value) {
            formData.append('startDate', startDate.value);
        }
        
        const endDate = document.getElementById('webAppFollowUpEndDate');
        if (endDate && endDate.value) {
            formData.append('endDate', endDate.value);
        }
        
        console.log('Submitting form data...');
        
        // Submit form
        fetch('/process_web_app_vapt_follow_up_audit_report', {
            method: 'POST',
            body: formData
        })
        .then(response => {
            console.log('Response status:', response.status);
            if (response.ok) {
                return response.blob();
            } else {
                return response.json().then(data => {
                    throw new Error(data.error || 'Error submitting form');
                });
            }
        })
        .then(blob => {
            console.log('File received, size:', blob.size);
            
            // Create download link
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Web_Application_VAPT_Follow_Up_Audit_Report.xlsx';
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
            document.body.removeChild(a);
            
            console.log('File download initiated');
            
            // Hide loading indicator
            hideVaptLoadingIndicator();
            
            // Refresh page
            setTimeout(() => {
                location.reload();
            }, 1000);
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Error: ' + error.message);
            if (originalSubmitBtn) {
                originalSubmitBtn.disabled = false;
                originalSubmitBtn.textContent = originalText;
            }
            hideVaptLoadingIndicator();
        });
    }

    </script>
    

    <script>
    // Work Plan Modal Functions
    function openWorkPlanModal() {
        // Check if already disabled
        const workCard = document.getElementById('workPlanCard');
        if (workCard && workCard.classList.contains('work-plan-submitted')) {
            return; // Don't open if already submitted
        }
        
        // Set today's date
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('workPlanDate').value = today;
        
        // Open modal
        document.getElementById('workPlanModal').style.display = 'block';
    }
    
    function closeWorkPlanModal() {
        document.getElementById('workPlanModal').style.display = 'none';
        // Reset form
        const form = document.getElementById('workPlanForm');
        if (form) {
            form.reset();
            // Reset to first task only
            const taskContainer = document.getElementById('workPlanTaskContainer');
            if (taskContainer) {
                const firstTask = taskContainer.querySelector('.task-entry');
                taskContainer.innerHTML = '';
                if (firstTask) {
                    taskContainer.appendChild(firstTask.cloneNode(true));
                    updateTaskIndices();
                }
            }
        }
    }
    
    // Function to check if current time is between 4 AM and 12 PM
    function isWorkPlanTimeAllowed() {
        const now = new Date();
        const currentHour = now.getHours();
        // Check if time is between 4 AM (4) and 12 PM (12)
        return currentHour >= 4 && currentHour < 12;
    }
    
    // Function to enable/disable work plan card based on time
    function updateWorkPlanCardTimeRestriction() {
        const workCard = document.getElementById('workPlanCard');
        if (!workCard) return;
        
        // Don't modify if already submitted (check if onclick is null or has work-plan-submitted class)
        if (workCard.onclick === null || workCard.classList.contains('work-plan-submitted')) {
            return;
        }
        
        const isAllowed = isWorkPlanTimeAllowed();
        
        if (!isAllowed) {
            // Disable the button outside allowed time
            workCard.style.cursor = 'not-allowed';
            workCard.style.opacity = '0.6';
            const originalOnclick = workCard.onclick;
            workCard.onclick = function() {
                alert('Submit Today\'s Work Plan is only available between 4 AM and 12 PM.');
            };
            const icon = workCard.querySelector('i');
            const heading = workCard.querySelector('h3');
            if (icon) icon.style.opacity = '0.5';
            if (heading) heading.style.color = '#888';
        } else {
            // Enable the button during allowed time
            workCard.style.cursor = 'pointer';
            workCard.style.opacity = '1';
            workCard.onclick = openWorkPlanModal;
            const icon = workCard.querySelector('i');
            const heading = workCard.querySelector('h3');
            if (icon) icon.style.opacity = '1';
            if (heading) heading.style.color = '';
        }
    }
    
    // Check work plan status on page load
    document.addEventListener('DOMContentLoaded', function() {
        // Check if work plan has already been submitted today
        const today = new Date().toISOString().split('T')[0];
        const employeeName = document.getElementById('workPlanEmployeeNameForCheck')?.value || '';
        
        if (employeeName) {
            const formData = new FormData();
            formData.append('date', today);
            formData.append('employeeName', employeeName);
            
            fetch('/check_work_plan_status', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.submitted) {
                    const workCard = document.getElementById('workPlanCard');
                    if (workCard) {
                        workCard.classList.add('work-plan-submitted');
                        workCard.style.cursor = 'not-allowed';
                        workCard.style.opacity = '0.6';
                        workCard.onclick = null;
                        
                        // Add visual indicator
                        const icon = workCard.querySelector('i');
                        const heading = workCard.querySelector('h3');
                        if (icon) {
                            icon.style.opacity = '0.5';
                        }
                        if (heading) {
                            heading.textContent = 'Work Plan Submitted Today';
                            heading.style.color = '#888';
                        }
                    }
                } else {
                    // If not submitted, check time restriction
                    updateWorkPlanCardTimeRestriction();
                }
            })
            .catch(error => {
                console.error('Error checking work plan status:', error);
            });
        } else {
            // If no employee name, still check time restriction
            updateWorkPlanCardTimeRestriction();
        }
        
        // Check time restriction periodically (every minute)
        setInterval(updateWorkPlanCardTimeRestriction, 60000);
        
        // Function to check if current time is between 6 PM and 11 PM
        function isUpdateWorkTimeAllowed() {
            const now = new Date();
            const currentHour = now.getHours();
            // Check if time is between 6 PM (18) and 11 PM (23)
            return currentHour >= 18 && currentHour < 23;
        }
        
        // Function to enable/disable update work card based on time
        function updateWorkCardTimeRestriction() {
            const workCard = document.getElementById('updateWorkCard');
            if (!workCard) return;
            
            // Don't modify if already submitted (check if onclick is null or has update-work-submitted class)
            if (workCard.onclick === null || workCard.classList.contains('update-work-submitted')) {
                return;
            }
            
            const isAllowed = isUpdateWorkTimeAllowed();
            
            if (!isAllowed) {
                // Disable the button outside allowed time
                workCard.style.cursor = 'not-allowed';
                workCard.style.opacity = '0.6';
                workCard.onclick = function() {
                    alert('Update Today\'s Work is only available between 6 PM and 11 PM.');
                };
                const icon = workCard.querySelector('i');
                const heading = workCard.querySelector('h3');
                if (icon) icon.style.opacity = '0.5';
                if (heading) heading.style.color = '#888';
            } else {
                // Enable the button during allowed time
                workCard.style.cursor = 'pointer';
                workCard.style.opacity = '1';
                workCard.onclick = openUpdateWorkModal;
                const icon = workCard.querySelector('i');
                const heading = workCard.querySelector('h3');
                if (icon) icon.style.opacity = '1';
                if (heading) heading.style.color = '';
            }
        }
        
        // Apply time restriction immediately on page load (before async status check)
        updateWorkCardTimeRestriction();
        
        // Add Task functionality
        const addTaskBtn = document.getElementById('addWorkPlanTaskBtn');
        if (addTaskBtn) {
            addTaskBtn.addEventListener('click', function() {
                const taskContainer = document.getElementById('workPlanTaskContainer');
                const tasks = taskContainer.querySelectorAll('.task-entry');
                
                if (tasks.length >= 10) {
                    alert('Maximum 10 tasks allowed');
                    return;
                }
                
                const newIndex = tasks.length;
                const newTask = document.createElement('div');
                newTask.className = 'task-entry';
                newTask.setAttribute('data-task-index', newIndex);
                newTask.innerHTML = `
                    <hr style="margin: 20px 0; border: none; border-top: 1px solid #ddd;">
                    <div class="form-group">
                        <label for="workPlanTask_${newIndex}">Task*</label>
                        <input type="text" id="workPlanTask_${newIndex}" name="task[]" placeholder="Enter task name" required>
                    </div>

                    <div class="form-group">
                        <label for="workPlanTaskDescription_${newIndex}">Task Description*</label>
                        <textarea id="workPlanTaskDescription_${newIndex}" name="taskDescription[]" rows="2" placeholder="Enter task description" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="workPlanClientName_${newIndex}">Client Name*</label>
                        <input type="text" id="workPlanClientName_${newIndex}" name="clientName[]" placeholder="Enter client name" required>
                    </div>

                    <div class="form-group">
                        <label for="workPlanTime_${newIndex}">Time Taken (in Hours)*</label>
                        <input type="number" id="workPlanTime_${newIndex}" name="time[]" step="0.01" min="0" placeholder="e.g., 1.25, 2.5" required>
                    </div>
                    
                    <button type="button" onclick="removeWorkPlanTask(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; margin-top: 10px; cursor: pointer;">Remove Task</button>
                `;
                taskContainer.appendChild(newTask);
                updateTaskIndices();
            });
        }
    });
    
    function removeWorkPlanTask(button) {
        const taskEntry = button.closest('.task-entry');
        if (taskEntry) {
            taskEntry.remove();
            updateTaskIndices();
        }
    }
    
    function updateTaskIndices() {
        const tasks = document.querySelectorAll('.task-entry');
        tasks.forEach((task, index) => {
            task.setAttribute('data-task-index', index);
            const inputs = task.querySelectorAll('input, textarea, label');
            inputs.forEach((input, i) => {
                if (input.id) {
                    const baseName = input.id.split('_')[0] + '_' + input.id.split('_')[1].split('_')[0];
                    const rest = input.id.split('_').slice(2).join('_');
                    const newId = baseName + '_' + index + (rest ? '_' + rest : '');
                    input.id = newId;
                }
            });
        });
    }
    
    // Work Plan Form Submission Handler
    function handleWorkPlanSubmit(event) {
        event.preventDefault();
        
        const submitBtn = event.target.querySelector('button[type="submit"]');
        const originalText = submitBtn.textContent;
        submitBtn.disabled = true;
        submitBtn.textContent = 'Processing...';
        
        const formData = new FormData(event.target);
        
        fetch('/submit_work_plan', {
            method: 'POST',
            body: formData
        })
        .then(response => {
            if (response.ok) {
                return response.json();
            }
            throw new Error('Network response was not ok');
        })
        .then(data => {
            if (data.success) {
                alert('Work plan submitted successfully!');
                closeWorkPlanModal();
                
                // Disable the work plan card
                const workCard = document.getElementById('workPlanCard');
                if (workCard) {
                    workCard.classList.add('work-plan-submitted');
                    workCard.style.cursor = 'not-allowed';
                    workCard.style.opacity = '0.6';
                    workCard.onclick = null;
                    
                    // Add visual indicator
                    const icon = workCard.querySelector('i');
                    const heading = workCard.querySelector('h3');
                    if (icon) {
                        icon.style.opacity = '0.5';
                    }
                    if (heading) {
                        heading.textContent = 'Work Plan Submitted Today';
                        heading.style.color = '#888';
                    }
                }
                
                setTimeout(() => {
                    location.reload();
                }, 1000);
            } else {
                alert(data.error || 'Failed to submit work plan');
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred during submission. Please try again.');
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
        });
    }
    
    // Update Work Modal Functions
    function openUpdateWorkModal() {
        // Check if already disabled
        const workCard = document.getElementById('updateWorkCard');
        if (workCard && workCard.classList.contains('update-work-submitted')) {
            return; // Don't open if already submitted
        }
        
        // Set today's date
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('updateWorkDate').value = today;
        
        // Open modal
        document.getElementById('updateWorkModal').style.display = 'block';
    }
    
    function closeUpdateWorkModal() {
        document.getElementById('updateWorkModal').style.display = 'none';
        // Reset form
        const form = document.getElementById('updateWorkForm');
        if (form) {
            form.reset();
            // Reset to first task only
            const taskContainer = document.getElementById('updateWorkTaskContainer');
            if (taskContainer) {
                const firstTask = taskContainer.querySelector('.task-entry');
                taskContainer.innerHTML = '';
                if (firstTask) {
                    taskContainer.appendChild(firstTask.cloneNode(true));
                }
            }
        }
    }
    
    // Add Update Work Task functionality
    document.addEventListener('DOMContentLoaded', function() {
        const addUpdateTaskBtn = document.getElementById('addUpdateWorkTaskBtn');
        if (addUpdateTaskBtn) {
            addUpdateTaskBtn.addEventListener('click', function() {
                const taskContainer = document.getElementById('updateWorkTaskContainer');
                const tasks = taskContainer.querySelectorAll('.task-entry');
                
                if (tasks.length >= 10) {
                    alert('Maximum 10 tasks allowed');
                    return;
                }
                
                const newIndex = tasks.length;
                const newTask = document.createElement('div');
                newTask.className = 'task-entry';
                newTask.setAttribute('data-task-index', newIndex);
                newTask.innerHTML = `
                    <hr style="margin: 20px 0; border: none; border-top: 1px solid #ddd;">
                    <div class="form-group">
                        <label for="updateWorkTask_${newIndex}">Task*</label>
                        <input type="text" id="updateWorkTask_${newIndex}" name="task[]" placeholder="Enter task name" required>
                    </div>

                    <div class="form-group">
                        <label for="updateWorkClientName_${newIndex}">Client Name*</label>
                        <input type="text" id="updateWorkClientName_${newIndex}" name="clientName[]" placeholder="Enter client name" required>
                    </div>

                    <div class="form-group">
                        <label for="updateWorkTime_${newIndex}">Time Taken (in Hours)*</label>
                        <input type="number" id="updateWorkTime_${newIndex}" name="time[]" step="0.01" min="0" placeholder="e.g., 1.25, 2.5" required>
                    </div>

                    <div class="form-group">
                        <label for="updateWorkStatus_${newIndex}">Status*</label>
                        <select id="updateWorkStatus_${newIndex}" name="status[]" required>
                            <option value="">Select Status</option>
                            <option value="Completed">Completed</option>
                            <option value="Pending">Pending</option>
                            <option value="In Progress">In Progress</option>
                            <option value="Remove">Remove</option>
                            <option value="Take over">Take over</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="updateWorkDescription_${newIndex}">Description*</label>
                        <textarea id="updateWorkDescription_${newIndex}" name="description[]" rows="2" placeholder="Enter description" required></textarea>
                    </div>
                    
                    <button type="button" onclick="removeUpdateWorkTask(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; margin-top: 10px; cursor: pointer;">Remove Task</button>
                `;
                taskContainer.appendChild(newTask);
            });
        }
        
        // Check update work status on page load
        const today = new Date().toISOString().split('T')[0];
        const employeeName = document.getElementById('updateWorkEmployeeNameForCheck')?.value || '';
        
        if (employeeName) {
            const formData = new FormData();
            formData.append('date', today);
            formData.append('employeeName', employeeName);
            
            fetch('/check_update_work_status', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.submitted) {
                    const workCard = document.getElementById('updateWorkCard');
                    if (workCard) {
                        workCard.classList.add('update-work-submitted');
                        workCard.style.cursor = 'not-allowed';
                        workCard.style.opacity = '0.6';
                        workCard.onclick = null;
                        
                        const icon = workCard.querySelector('i');
                        const heading = workCard.querySelector('h3');
                        if (icon) icon.style.opacity = '0.5';
                        if (heading) {
                            heading.textContent = 'Work Updated Today';
                            heading.style.color = '#888';
                        }
                    }
                } else {
                    // If not submitted, check time restriction
                    updateWorkCardTimeRestriction();
                }
            })
            .catch(error => console.error('Error checking update work status:', error));
        } else {
            // If no employee name, still check time restriction
            updateWorkCardTimeRestriction();
        }
        
        // Check time restriction periodically (every minute)
        setInterval(updateWorkCardTimeRestriction, 60000);
        
        // Check sprint plan status on page load
        const sprintEmployeeName = document.getElementById('sprintPlanEmployeeNameForCheck')?.value || '';
        
        if (sprintEmployeeName) {
            const sprintFormData = new FormData();
            sprintFormData.append('employeeName', sprintEmployeeName);
            
            fetch('/check_sprint_plan_status', {
                method: 'POST',
                body: sprintFormData
            })
            .then(response => response.json())
            .then(data => {
                if (data.submitted) {
                    const sprintCard = document.getElementById('sprintPlanCard');
                    if (sprintCard) {
                        sprintCard.classList.add('sprint-plan-submitted');
                        sprintCard.style.cursor = 'not-allowed';
                        sprintCard.style.opacity = '0.6';
                        sprintCard.onclick = null;
                        
                        const icon = sprintCard.querySelector('i');
                        const heading = sprintCard.querySelector('h3');
                        if (icon) icon.style.opacity = '0.5';
                        if (heading) {
                            heading.textContent = 'Sprint Plan Submitted';
                            heading.style.color = '#888';
                        }
                    }
                }
            })
            .catch(error => console.error('Error checking sprint plan status:', error));
        }
    });
    
    function removeUpdateWorkTask(button) {
        const taskEntry = button.closest('.task-entry');
        if (taskEntry) {
            taskEntry.remove();
        }
    }
    
    // Update Work Form Submission Handler
    function handleUpdateWorkSubmit(event) {
        event.preventDefault();
        
        const submitBtn = event.target.querySelector('button[type="submit"]');
        const originalText = submitBtn.textContent;
        submitBtn.disabled = true;
        submitBtn.textContent = 'Processing...';
        
        const formData = new FormData(event.target);
        
        fetch('/submit_update_work', {
            method: 'POST',
            body: formData
        })
        .then(response => {
            if (response.ok) {
                return response.json();
            }
            throw new Error('Network response was not ok');
        })
        .then(data => {
            if (data.success) {
                alert('Work updated successfully!');
                closeUpdateWorkModal();
                
                const workCard = document.getElementById('updateWorkCard');
                if (workCard) {
                    workCard.classList.add('update-work-submitted');
                    workCard.style.cursor = 'not-allowed';
                    workCard.style.opacity = '0.6';
                    workCard.onclick = null;
                    
                    const icon = workCard.querySelector('i');
                    const heading = workCard.querySelector('h3');
                    if (icon) icon.style.opacity = '0.5';
                    if (heading) {
                        heading.textContent = 'Work Updated Today';
                        heading.style.color = '#888';
                    }
                }
                
                setTimeout(() => location.reload(), 1000);
            } else {
                alert(data.error || 'Failed to update work');
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred. Please try again.');
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
        });
    }
    
    // Sprint Plan Modal Functions
    function openSprintPlanModal() {
        const sprintCard = document.getElementById('sprintPlanCard');
        if (sprintCard && sprintCard.classList.contains('sprint-plan-submitted')) {
            return;
        }
        
        document.getElementById('sprintPlanModal').style.display = 'block';
    }
    
    function closeSprintPlanModal() {
        document.getElementById('sprintPlanModal').style.display = 'none';
        const form = document.getElementById('sprintPlanForm');
        if (form) {
            form.reset();
            const dayContainer = document.getElementById('sprintPlanDayContainer');
            if (dayContainer) {
                const firstDay = dayContainer.querySelector('.day-entry');
                dayContainer.innerHTML = '';
                if (firstDay) {
                    dayContainer.appendChild(firstDay.cloneNode(true));
                }
            }
        }
    }
    
    // Sprint Plan JavaScript
    let sprintDayIndex = 0;
    
    document.addEventListener('DOMContentLoaded', function() {
        // Add New Day functionality
        const addDayBtn = document.getElementById('addSprintDayBtn');
        if (addDayBtn) {
            addDayBtn.addEventListener('click', function() {
                const dayContainer = document.getElementById('sprintPlanDayContainer');
                const days = dayContainer.querySelectorAll('.day-entry');
                
                if (days.length >= 6) {
                    alert('Maximum 6 days allowed');
                    return;
                }
                
                sprintDayIndex++;
                const newDay = document.createElement('div');
                newDay.className = 'day-entry';
                newDay.setAttribute('data-day-index', sprintDayIndex);
                newDay.innerHTML = `
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid #ddd;">
                    <div class="form-group">
                        <label>Date*</label>
                        <input type="date" class="sprint-date-input" name="dates[]" required>
                    </div>
                    
                    <div class="form-group">
                        <h4 style="margin-bottom: 10px;">Tasks</h4>
                        <div id="sprintDay${sprintDayIndex}TaskContainer" class="task-container">
                            <div class="task-entry" data-task-index="0">
                                <div class="form-group">
                                    <label>Task*</label>
                                    <input type="text" name="tasks[${sprintDayIndex}][]" placeholder="Enter task" required>
                                </div>
                                <div class="form-group">
                                    <label>Client Name*</label>
                                    <input type="text" name="clientNames[${sprintDayIndex}][]" placeholder="Enter client name" required>
                                </div>
                                <div class="form-group">
                                    <label>Time (Hours)*</label>
                                    <input type="number" name="times[${sprintDayIndex}][]" step="0.01" min="0" placeholder="e.g., 1.25" required>
                                </div>
                                <button type="button" onclick="removeSprintTask(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 5px 10px; cursor: pointer;">Remove</button>
                            </div>
                        </div>
                        <button type="button" class="add-member-btn add-sprint-task-btn" data-day="${sprintDayIndex}" style="margin-top: 10px;">+ Add New Task</button>
                    </div>
                    
                    <button type="button" onclick="removeSprintDay(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; margin-top: 15px; cursor: pointer; width: 100%;">Remove This Day</button>
                `;
                dayContainer.appendChild(newDay);
            });
        }
        
        // Add New Task functionality (delegated)
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('add-sprint-task-btn')) {
                const dayIndex = e.target.getAttribute('data-day');
                const taskContainer = document.getElementById(`sprintDay${dayIndex}TaskContainer`);
                const tasks = taskContainer.querySelectorAll('.task-entry');
                
                const newIndex = tasks.length;
                const newTask = document.createElement('div');
                newTask.className = 'task-entry';
                newTask.setAttribute('data-task-index', newIndex);
                newTask.innerHTML = `
                    <div class="form-group">
                        <label>Task*</label>
                        <input type="text" name="tasks[${dayIndex}][]" placeholder="Enter task" required>
                    </div>
                    <div class="form-group">
                        <label>Client Name*</label>
                        <input type="text" name="clientNames[${dayIndex}][]" placeholder="Enter client name" required>
                    </div>
                    <div class="form-group">
                        <label>Time (Hours)*</label>
                        <input type="number" name="times[${dayIndex}][]" step="0.01" min="0" placeholder="e.g., 1.25" required>
                    </div>
                    <button type="button" onclick="removeSprintTask(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 5px 10px; cursor: pointer;">Remove</button>
                `;
                taskContainer.appendChild(newTask);
            }
        });
    });
    
    function removeSprintTask(button) {
        const taskEntry = button.closest('.task-entry');
        if (taskEntry) {
            taskEntry.remove();
        }
    }
    
    function removeSprintDay(button) {
        const dayEntry = button.closest('.day-entry');
        if (dayEntry) {
            dayEntry.remove();
        }
    }
    
    function handleSprintPlanSubmit(event) {
        event.preventDefault();
        
        const submitBtn = event.target.querySelector('button[type="submit"]');
        const originalText = submitBtn.textContent;
        submitBtn.disabled = true;
        submitBtn.textContent = 'Processing...';
        
        const formData = new FormData(event.target);
        
        fetch('/submit_sprint_plan', {
            method: 'POST',
            body: formData
        })
        .then(response => {
            if (response.ok) {
                return response.json();
            }
            throw new Error('Network response was not ok');
        })
        .then(data => {
            if (data.success) {
                alert('Sprint plan submitted successfully!');
                closeSprintPlanModal();
                
                const sprintCard = document.getElementById('sprintPlanCard');
                if (sprintCard) {
                    sprintCard.classList.add('sprint-plan-submitted');
                    sprintCard.style.cursor = 'not-allowed';
                    sprintCard.style.opacity = '0.6';
                    sprintCard.onclick = null;
                    
                    const icon = sprintCard.querySelector('i');
                    const heading = sprintCard.querySelector('h3');
                    if (icon) icon.style.opacity = '0.5';
                    if (heading) {
                        heading.textContent = 'Sprint Plan Submitted';
                        heading.style.color = '#888';
                    }
                }
                
                setTimeout(() => location.reload(), 1000);
            } else {
                alert(data.error || 'Failed to submit sprint plan');
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred. Please try again.');
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
        });
    }
    
    // Last Week Sprint Modal Functions
    function openLastWeekSprintModal() {
        const sprintCard = document.getElementById('lastWeekSprintCard');
        if (sprintCard && sprintCard.classList.contains('last-week-sprint-submitted')) {
            return;
        }
        
        document.getElementById('lastWeekSprintModal').style.display = 'block';
    }
    
    function closeLastWeekSprintModal() {
        document.getElementById('lastWeekSprintModal').style.display = 'none';
        const form = document.getElementById('lastWeekSprintForm');
        if (form) {
            form.reset();
            const dayContainer = document.getElementById('lastWeekSprintDayContainer');
            if (dayContainer) {
                const firstDay = dayContainer.querySelector('.day-entry');
                dayContainer.innerHTML = '';
                if (firstDay) {
                    dayContainer.appendChild(firstDay.cloneNode(true));
                }
            }
        }
    }
    
    // Last Week Sprint JavaScript
    let lastWeekSprintDayIndex = 0;
    
    document.addEventListener('DOMContentLoaded', function() {
        // Add New Day functionality for Last Week Sprint
        const addLastWeekDayBtn = document.getElementById('addLastWeekSprintDayBtn');
        if (addLastWeekDayBtn) {
            addLastWeekDayBtn.addEventListener('click', function() {
                const dayContainer = document.getElementById('lastWeekSprintDayContainer');
                const days = dayContainer.querySelectorAll('.day-entry');
                
                if (days.length >= 6) {
                    alert('Maximum 6 days allowed');
                    return;
                }
                
                lastWeekSprintDayIndex++;
                const newDay = document.createElement('div');
                newDay.className = 'day-entry';
                newDay.setAttribute('data-day-index', lastWeekSprintDayIndex);
                newDay.innerHTML = `
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid #ddd;">
                    <div class="form-group">
                        <label>Date*</label>
                        <input type="date" class="sprint-date-input" name="dates[]" required>
                    </div>
                    
                    <div class="form-group">
                        <h4 style="margin-bottom: 10px;">Tasks</h4>
                        <div id="lastWeekSprintDay${lastWeekSprintDayIndex}TaskContainer" class="task-container">
                            <div class="task-entry" data-task-index="0">
                                <div class="form-group">
                                    <label>Task*</label>
                                    <input type="text" name="tasks[${lastWeekSprintDayIndex}][]" placeholder="Enter task" required>
                                </div>
                                <div class="form-group">
                                    <label>Client Name*</label>
                                    <input type="text" name="clientNames[${lastWeekSprintDayIndex}][]" placeholder="Enter client name" required>
                                </div>
                                <div class="form-group">
                                    <label>Time (Hours)*</label>
                                    <input type="number" name="times[${lastWeekSprintDayIndex}][]" step="0.01" min="0" placeholder="e.g., 1.25" required>
                                </div>
                                <div class="form-group">
                                    <label>Status*</label>
                                    <select name="statuses[${lastWeekSprintDayIndex}][]" required>
                                        <option value="">Select Status</option>
                                        <option value="Completed">Completed</option>
                                        <option value="Pending">Pending</option>
                                        <option value="In Progress">In Progress</option>
                                        <option value="Remove">Remove</option>
                                        <option value="Take over">Take over</option>
                                    </select>
                                </div>
                                <button type="button" onclick="removeLastWeekSprintTask(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 5px 10px; cursor: pointer;">Remove</button>
                            </div>
                        </div>
                        <button type="button" class="add-member-btn add-lastweek-task-btn" data-day="${lastWeekSprintDayIndex}" style="margin-top: 10px;">+ Add New Task</button>
                    </div>
                    
                    <button type="button" onclick="removeLastWeekSprintDay(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; margin-top: 15px; cursor: pointer; width: 100%;">Remove This Day</button>
                `;
                dayContainer.appendChild(newDay);
            });
        }
        
        // Add New Task functionality for Last Week Sprint (delegated)
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('add-lastweek-task-btn')) {
                const dayIndex = e.target.getAttribute('data-day');
                const taskContainer = document.getElementById(`lastWeekSprintDay${dayIndex}TaskContainer`);
                const tasks = taskContainer.querySelectorAll('.task-entry');
                
                const newIndex = tasks.length;
                const newTask = document.createElement('div');
                newTask.className = 'task-entry';
                newTask.setAttribute('data-task-index', newIndex);
                newTask.innerHTML = `
                    <div class="form-group">
                        <label>Task*</label>
                        <input type="text" name="tasks[${dayIndex}][]" placeholder="Enter task" required>
                    </div>
                    <div class="form-group">
                        <label>Client Name*</label>
                        <input type="text" name="clientNames[${dayIndex}][]" placeholder="Enter client name" required>
                    </div>
                    <div class="form-group">
                        <label>Time (Hours)*</label>
                        <input type="number" name="times[${dayIndex}][]" step="0.01" min="0" placeholder="e.g., 1.25" required>
                    </div>
                    <div class="form-group">
                        <label>Status*</label>
                        <select name="statuses[${dayIndex}][]" required>
                            <option value="">Select Status</option>
                            <option value="Completed">Completed</option>
                            <option value="Pending">Pending</option>
                            <option value="In Progress">In Progress</option>
                            <option value="Remove">Remove</option>
                            <option value="Take over">Take over</option>
                        </select>
                    </div>
                    <button type="button" onclick="removeLastWeekSprintTask(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 5px 10px; cursor: pointer;">Remove</button>
                `;
                taskContainer.appendChild(newTask);
            }
        });
        
        // Check last week sprint status on page load
        const lastWeekEmployeeName = document.getElementById('lastWeekSprintEmployeeNameForCheck')?.value || '';
        
        if (lastWeekEmployeeName) {
            const lastWeekFormData = new FormData();
            lastWeekFormData.append('employeeName', lastWeekEmployeeName);
            
            fetch('/check_last_week_sprint_status', {
                method: 'POST',
                body: lastWeekFormData
            })
            .then(response => response.json())
            .then(data => {
                if (data.submitted) {
                    const sprintCard = document.getElementById('lastWeekSprintCard');
                    if (sprintCard) {
                        sprintCard.classList.add('last-week-sprint-submitted');
                        sprintCard.style.cursor = 'not-allowed';
                        sprintCard.style.opacity = '0.6';
                        sprintCard.onclick = null;
                        
                        const icon = sprintCard.querySelector('i');
                        const heading = sprintCard.querySelector('h3');
                        if (icon) icon.style.opacity = '0.5';
                        if (heading) {
                            heading.textContent = 'Last Week Sprint Submitted';
                            heading.style.color = '#888';
                        }
                    }
                }
            })
            .catch(error => console.error('Error checking last week sprint status:', error));
        }
    });
    
    function removeLastWeekSprintTask(button) {
        const taskEntry = button.closest('.task-entry');
        if (taskEntry) {
            taskEntry.remove();
        }
    }
    
    function removeLastWeekSprintDay(button) {
        const dayEntry = button.closest('.day-entry');
        if (dayEntry) {
            dayEntry.remove();
        }
    }
    
    function handleLastWeekSprintSubmit(event) {
        event.preventDefault();
        
        const submitBtn = event.target.querySelector('button[type="submit"]');
        const originalText = submitBtn.textContent;
        submitBtn.disabled = true;
        submitBtn.textContent = 'Processing...';
        
        const formData = new FormData(event.target);
        
        fetch('/submit_last_week_sprint', {
            method: 'POST',
            body: formData
        })
        .then(response => {
            if (response.ok) {
                return response.json();
            }
            throw new Error('Network response was not ok');
        })
        .then(data => {
            if (data.success) {
                alert('Last week sprint submitted successfully!');
                closeLastWeekSprintModal();
                
                const sprintCard = document.getElementById('lastWeekSprintCard');
                if (sprintCard) {
                    sprintCard.classList.add('last-week-sprint-submitted');
                    sprintCard.style.cursor = 'not-allowed';
                    sprintCard.style.opacity = '0.6';
                    sprintCard.onclick = null;
                    
                    const icon = sprintCard.querySelector('i');
                    const heading = sprintCard.querySelector('h3');
                    if (icon) icon.style.opacity = '0.5';
                    if (heading) {
                        heading.textContent = 'Last Week Sprint Submitted';
                        heading.style.color = '#888';
                    }
                }
                
                setTimeout(() => location.reload(), 1000);
            } else {
                alert(data.error || 'Failed to submit last week sprint');
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred. Please try again.');
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
        });
    }
    
    // Extra Work Modal Functions
    function openExtraWorkModal() {
        const extraWorkCard = document.getElementById('extraWorkCard');
        if (extraWorkCard && extraWorkCard.classList.contains('extra-work-submitted')) {
            return;
        }
        
        // Set previous day's date
        const today = new Date();
        today.setDate(today.getDate() - 1);
        const yesterday = today.toISOString().split('T')[0];
        document.getElementById('extraWorkDate').value = yesterday;
        
        document.getElementById('extraWorkModal').style.display = 'block';
    }
    
    function closeExtraWorkModal() {
        document.getElementById('extraWorkModal').style.display = 'none';
        const form = document.getElementById('extraWorkForm');
        if (form) {
            form.reset();
        }
    }
    
    function handleExtraWorkSubmit(event) {
        event.preventDefault();
        
        const submitBtn = event.target.querySelector('button[type="submit"]');
        const originalText = submitBtn.textContent;
        submitBtn.disabled = true;
        submitBtn.textContent = 'Processing...';
        
        const formData = new FormData(event.target);
        
        fetch('/submit_extra_work', {
            method: 'POST',
            body: formData
        })
        .then(response => {
            if (response.ok) {
                return response.json();
            }
            throw new Error('Network response was not ok');
        })
        .then(data => {
            if (data.success) {
                alert('Extra work submitted successfully!');
                closeExtraWorkModal();
                setTimeout(() => location.reload(), 1000);
            } else {
                alert(data.error || 'Failed to submit extra work');
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred. Please try again.');
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
        });
    }
    
    // Leave Approval Modal Functions
    function openLeaveApprovalModal() {
        // Set today's date
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('leaveRequestDate').value = today;
        
        document.getElementById('leaveApprovalModal').style.display = 'block';
    }
    
    function closeLeaveApprovalModal() {
        document.getElementById('leaveApprovalModal').style.display = 'none';
        const form = document.getElementById('leaveApprovalForm');
        if (form) {
            form.reset();
            // Hide current task field
            document.getElementById('currentTaskField').style.display = 'none';
        }
    }
    
    function toggleCurrentTaskField() {
        const leaveType = document.querySelector('input[name="leaveType"]:checked').value;
        const currentTaskField = document.getElementById('currentTaskField');
        const currentTaskInput = document.getElementById('leaveCurrentTask');
        
        if (leaveType === 'Emergency Leave') {
            currentTaskField.style.display = 'block';
            currentTaskInput.required = true;
        } else {
            currentTaskField.style.display = 'none';
            currentTaskInput.required = false;
            currentTaskInput.value = '';
        }
    }
    
    function handleLeaveApprovalSubmit() {
        const form = document.getElementById('leaveApprovalForm');
        const leaveType = document.querySelector('input[name="leaveType"]:checked').value;
        
        // Validate current task for Emergency Leave
        if (leaveType === 'Emergency Leave') {
            const currentTask = document.getElementById('leaveCurrentTask').value.trim();
            if (!currentTask) {
                alert('Please enter your current task for Emergency Leave');
                return;
            }
        }
        
        // Basic validation
        if (!form.checkValidity()) {
            form.reportValidity();
            return;
        }
        
        // Collect form data
        const formData = {
            employeeName: document.getElementById('leaveEmployeeName').value,
            requestDate: document.getElementById('leaveRequestDate').value,
            leaveType: leaveType,
            leaveFrom: document.getElementById('leaveFrom').value,
            leaveTo: document.getElementById('leaveTo').value,
            reason: document.getElementById('leaveReason').value,
            currentTask: document.getElementById('leaveCurrentTask').value || ''
        };
        
        // Disable submit button to prevent double submission
        const submitBtn = form.querySelector('.submit-btn');
        const originalText = submitBtn.textContent;
        submitBtn.disabled = true;
        submitBtn.textContent = 'Submitting...';
        
        // Send request to backend
        fetch('/submit_leave_request', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(formData)
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert(data.message || 'Leave approval request submitted successfully!');
                closeLeaveApprovalModal();
            } else {
                alert(data.message || 'Failed to submit leave request. Please try again.');
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        })
        .catch(error => {
            console.error('Error submitting leave request:', error);
            alert('An error occurred while submitting your request. Please try again.');
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
        });
    }
    
    // Complaint Modal Functions
    function openComplaintModal() {
        // Set today's date
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('complaintDate').value = today;
        
        document.getElementById('complaintModal').style.display = 'block';
    }
    
    function closeComplaintModal() {
        document.getElementById('complaintModal').style.display = 'none';
        const form = document.getElementById('complaintForm');
        if (form) {
            form.reset();
        }
    }
    
    function handleComplaintSubmit() {
        const form = document.getElementById('complaintForm');
        
        // Basic validation
        if (!form.checkValidity()) {
            form.reportValidity();
            return;
        }
        
        // Collect form data
        const formData = {
            employeeName: document.getElementById('complaintEmployeeName').value,
            employeeTeam: document.getElementById('complaintEmployeeTeam').value,
            date: document.getElementById('complaintDate').value,
            personName: document.getElementById('complaintPersonName').value,
            complainDescription: document.getElementById('complaintDescription').value
        };
        
        // Disable submit button to prevent double submission
        const submitBtn = form.querySelector('.submit-btn');
        const originalText = submitBtn.textContent;
        submitBtn.disabled = true;
        submitBtn.textContent = 'Submitting...';
        
        // Send request to backend
        fetch('/submit_complaint', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(formData)
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert(data.message || 'Complaint submitted successfully!');
                closeComplaintModal();
            } else {
                alert(data.message || 'Failed to submit complaint. Please try again.');
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        })
        .catch(error => {
            console.error('Error submitting complaint:', error);
            alert('An error occurred while submitting your complaint. Please try again.');
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
        });
    }
    
    // VAPT First Audit Certificate Form Handler
    document.addEventListener('DOMContentLoaded', function() {
        const vaptFirstAuditCertificateForm = document.getElementById('vaptFirstAuditCertificateForm');
        if (vaptFirstAuditCertificateForm) {
            vaptFirstAuditCertificateForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                
                // Handle organization name (combo-input logic)
                let organization_name = formData.get('organizationName');
                if (organization_name === 'other') {
                    organization_name = formData.get('otherOrganizationName');
                    if (!organization_name || organization_name.trim() === '') {
                        alert('Please enter the organization name');
                        return;
                    }
                }
                
                // Handle city (combo-input logic)
                let city = formData.get('city');
                if (city === 'other') {
                    city = formData.get('otherCity');
                    if (!city || city.trim() === '') {
                        alert('Please enter the city name');
                        return;
                    }
                }
                
                // Handle state (combo-input logic)
                let state = formData.get('state');
                if (state === 'other') {
                    state = formData.get('otherState');
                    if (!state || state.trim() === '') {
                        alert('Please enter the state name');
                        return;
                    }
                }
                
                // Validate required fields
                const requiredFields = ['auditeeDesignation', 'scope', 'startAuditDate', 'endAuditDate', 'reportId'];
                for (const field of requiredFields) {
                    if (!formData.get(field) || formData.get(field).trim() === '') {
                        alert(`Please fill in the ${field.replace(/([A-Z])/g, ' $1').toLowerCase()}`);
                        return;
                    }
                }
                
                // Validate combo-input fields
                if (!organization_name || organization_name.trim() === '') {
                    alert('Please select or enter an organization name');
                    return;
                }
                
                if (!city || city.trim() === '') {
                    alert('Please select or enter a city');
                    return;
                }
                
                if (!state || state.trim() === '') {
                    alert('Please select or enter a state');
                    return;
                }
                
                // Validate date range
                const startDate = new Date(formData.get('startAuditDate'));
                const endDate = new Date(formData.get('endAuditDate'));
                if (startDate >= endDate) {
                    alert('End Audit Date must be after Start Audit Date');
                    return;
                }
                
                // Disable submit button to prevent multiple submissions
                const submitBtn = this.querySelector('button[type="submit"]');
                const originalText = submitBtn ? submitBtn.textContent : 'Generate Certificate';
                if (submitBtn) {
                    submitBtn.disabled = true;
                    submitBtn.textContent = 'Processing...';
                    submitBtn.style.opacity = '0.6';
                    submitBtn.style.cursor = 'not-allowed';
                }
                
                // Prepare form data with correct combo-input values
                const submitFormData = new FormData();
                submitFormData.append('organizationName', organization_name);
                submitFormData.append('city', city);
                submitFormData.append('state', state);
                submitFormData.append('auditeeDesignation', formData.get('auditeeDesignation'));
                submitFormData.append('scope', formData.get('scope'));
                submitFormData.append('startAuditDate', formData.get('startAuditDate'));
                submitFormData.append('endAuditDate', formData.get('endAuditDate'));
                submitFormData.append('reportId', formData.get('reportId'));
                
                fetch('/process_vapt_first_audit_certificate', {
                    method: 'POST',
                    body: submitFormData
                })
                .then(response => {
                    if (response.ok) {
                        return response.blob().then(blob => {
                            // Download the certificate file
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.href = url;
                            a.download = 'Infrastrcture_VAPT_Certificate.docx';
                            document.body.appendChild(a);
                            a.click();
                            window.URL.revokeObjectURL(url);
                            document.body.removeChild(a);
                            
                            // Close modal
                            closeVaptModal('vaptFirstAuditCertificateModal');
                            
                            // Reset form
                            this.reset();
                            
                            // Refresh the page after a short delay to ensure download completes
                            setTimeout(() => {
                                window.location.reload();
                            }, 1000);
                        });
                    } else {
                        return response.json().then(data => {
                            throw new Error(data.error || 'Network response was not ok');
                        });
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Error: ' + error.message);
                    if (submitBtn) {
                        submitBtn.disabled = false;
                        submitBtn.textContent = originalText;
                        submitBtn.style.opacity = '1';
                        submitBtn.style.cursor = 'pointer';
                    }
                });
            });
        }
    });
    
    // Public IP VAPT First Audit Certificate Form Handler
    document.addEventListener('DOMContentLoaded', function() {
        const publicIpFirstAuditCertificateForm = document.getElementById('publicIpFirstAuditCertificateForm');
        if (publicIpFirstAuditCertificateForm) {
            publicIpFirstAuditCertificateForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                
                // Handle organization name (combo-input logic)
                let organization_name = formData.get('organizationName');
                if (organization_name === 'other') {
                    organization_name = formData.get('otherOrganizationName');
                    if (!organization_name || organization_name.trim() === '') {
                        alert('Please enter the organization name');
                        return;
                    }
                }
                
                // Handle city (combo-input logic)
                let city = formData.get('city');
                if (city === 'other') {
                    city = formData.get('otherCity');
                    if (!city || city.trim() === '') {
                        alert('Please enter the city name');
                        return;
                    }
                }
                
                // Handle state (combo-input logic)
                let state = formData.get('state');
                if (state === 'other') {
                    state = formData.get('otherState');
                    if (!state || state.trim() === '') {
                        alert('Please enter the state name');
                        return;
                    }
                }
                
                // Validate required fields
                const requiredFields = ['auditeeDesignation', 'scope', 'startAuditDate', 'endAuditDate', 'reportId'];
                for (const field of requiredFields) {
                    if (!formData.get(field) || formData.get(field).trim() === '') {
                        alert(`Please fill in the ${field.replace(/([A-Z])/g, ' $1').toLowerCase()}`);
                        return;
                    }
                }
                
                // Validate combo-input fields
                if (!organization_name || organization_name.trim() === '') {
                    alert('Please select or enter an organization name');
                    return;
                }
                
                if (!city || city.trim() === '') {
                    alert('Please select or enter a city');
                    return;
                }
                
                if (!state || state.trim() === '') {
                    alert('Please select or enter a state');
                    return;
                }
                
                // Validate date range
                const startDate = new Date(formData.get('startAuditDate'));
                const endDate = new Date(formData.get('endAuditDate'));
                if (startDate >= endDate) {
                    alert('End Audit Date must be after Start Audit Date');
                    return;
                }
                
                // Disable submit button to prevent multiple submissions
                const submitBtn = this.querySelector('button[type="submit"]');
                const originalText = submitBtn ? submitBtn.textContent : 'Generate Certificate';
                if (submitBtn) {
                    submitBtn.disabled = true;
                    submitBtn.textContent = 'Processing...';
                    submitBtn.style.opacity = '0.6';
                    submitBtn.style.cursor = 'not-allowed';
                }
                
                // Prepare form data with correct combo-input values
                const submitFormData = new FormData();
                submitFormData.append('organizationName', organization_name);
                submitFormData.append('city', city);
                submitFormData.append('state', state);
                submitFormData.append('auditeeDesignation', formData.get('auditeeDesignation'));
                submitFormData.append('scope', formData.get('scope'));
                submitFormData.append('startAuditDate', formData.get('startAuditDate'));
                submitFormData.append('endAuditDate', formData.get('endAuditDate'));
                submitFormData.append('reportId', formData.get('reportId'));
                
                fetch('/process_public_ip_vapt_first_audit_certificate', {
                    method: 'POST',
                    body: submitFormData
                })
                .then(response => {
                    if (response.ok) {
                        return response.blob().then(blob => {
                            // Download the certificate file
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.href = url;
                            a.download = 'Public_IP_VAPT_Certificate.docx';
                            document.body.appendChild(a);
                            a.click();
                            window.URL.revokeObjectURL(url);
                            document.body.removeChild(a);
                            
                            // Close modal
                            closeVaptModal('publicIpFirstAuditCertificateModal');
                            
                            // Reset form
                            this.reset();
                            
                            // Refresh the page after a short delay to ensure download completes
                            setTimeout(() => {
                                window.location.reload();
                            }, 1000);
                        });
                    } else {
                        return response.json().then(data => {
                            throw new Error(data.error || 'Network response was not ok');
                        });
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Error: ' + error.message);
                    if (submitBtn) {
                        submitBtn.disabled = false;
                        submitBtn.textContent = originalText;
                        submitBtn.style.opacity = '1';
                        submitBtn.style.cursor = 'pointer';
                    }
                });
            });
        }
    });
    
    // Web Application VAPT First Audit Certificate Form Handler
    document.addEventListener('DOMContentLoaded', function() {
        const webAppVaptFirstAuditCertificateForm = document.getElementById('webAppVaptFirstAuditCertificateForm');
        if (webAppVaptFirstAuditCertificateForm) {
            webAppVaptFirstAuditCertificateForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                
                // Handle organization name (combo-input logic)
                let organization_name = formData.get('organizationName');
                if (organization_name === 'other') {
                    organization_name = formData.get('otherOrganizationName');
                    if (!organization_name || organization_name.trim() === '') {
                        alert('Please enter the organization name');
                        return;
                    }
                }
                
                // Handle city (combo-input logic)
                let city = formData.get('city');
                if (city === 'other') {
                    city = formData.get('otherCity');
                    if (!city || city.trim() === '') {
                        alert('Please enter the city name');
                        return;
                    }
                }
                
                // Handle state (combo-input logic)
                let state = formData.get('state');
                if (state === 'other') {
                    state = formData.get('otherState');
                    if (!state || state.trim() === '') {
                        alert('Please enter the state name');
                        return;
                    }
                }
                
                // Validate required fields
                const requiredFields = ['auditeeDesignation', 'scope', 'startAuditDate', 'endAuditDate', 'reportId'];
                for (const field of requiredFields) {
                    if (!formData.get(field) || formData.get(field).trim() === '') {
                        alert(`Please fill in the ${field.replace(/([A-Z])/g, ' $1').toLowerCase()}`);
                        return;
                    }
                }
                
                // Validate combo-input fields
                if (!organization_name || organization_name.trim() === '') {
                    alert('Please select or enter an organization name');
                    return;
                }
                
                if (!city || city.trim() === '') {
                    alert('Please select or enter a city');
                    return;
                }
                
                if (!state || state.trim() === '') {
                    alert('Please select or enter a state');
                    return;
                }
                
                // Validate date range
                const startDate = new Date(formData.get('startAuditDate'));
                const endDate = new Date(formData.get('endAuditDate'));
                if (startDate >= endDate) {
                    alert('End Audit Date must be after Start Audit Date');
                    return;
                }
                
                // Disable submit button to prevent multiple submissions
                const submitBtn = this.querySelector('button[type="submit"]');
                const originalText = submitBtn ? submitBtn.textContent : 'Generate Certificate';
                if (submitBtn) {
                    submitBtn.disabled = true;
                    submitBtn.textContent = 'Processing...';
                    submitBtn.style.opacity = '0.6';
                    submitBtn.style.cursor = 'not-allowed';
                }
                
                // Prepare form data with correct combo-input values
                const submitFormData = new FormData();
                submitFormData.append('organizationName', organization_name);
                submitFormData.append('city', city);
                submitFormData.append('state', state);
                submitFormData.append('auditeeDesignation', formData.get('auditeeDesignation'));
                submitFormData.append('scope', formData.get('scope'));
                submitFormData.append('startAuditDate', formData.get('startAuditDate'));
                submitFormData.append('endAuditDate', formData.get('endAuditDate'));
                submitFormData.append('reportId', formData.get('reportId'));
                
                fetch('/process_web_app_vapt_first_audit_certificate', {
                    method: 'POST',
                    body: submitFormData
                })
                .then(response => {
                    if (response.ok) {
                        return response.blob().then(blob => {
                            // Download the certificate file
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.href = url;
                            a.download = 'Web_Application_VAPT_Certificate.docx';
                            document.body.appendChild(a);
                            a.click();
                            window.URL.revokeObjectURL(url);
                            document.body.removeChild(a);
                            
                            // Close modal
                            closeVaptModal('webAppVaptFirstAuditCertificateModal');
                            
                            // Reset form
                            this.reset();
                            
                            // Refresh the page after a short delay to ensure download completes
                            setTimeout(() => {
                                window.location.reload();
                            }, 1000);
                        });
                    } else {
                        return response.json().then(data => {
                            throw new Error(data.error || 'Network response was not ok');
                        });
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Error: ' + error.message);
                    if (submitBtn) {
                        submitBtn.disabled = false;
                        submitBtn.textContent = originalText;
                        submitBtn.style.opacity = '1';
                        submitBtn.style.cursor = 'pointer';
                    }
                });
            });
        }
    });
    
    // Android Mobile Application VAPT First Audit Certificate Form Handler
    document.addEventListener('DOMContentLoaded', function() {
        const androidAppVaptFirstAuditCertificateForm = document.getElementById('androidAppVaptFirstAuditCertificateForm');
        if (androidAppVaptFirstAuditCertificateForm) {
            androidAppVaptFirstAuditCertificateForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                
                // Handle organization name (combo-input logic)
                let organization_name = formData.get('organizationName');
                if (organization_name === 'other') {
                    organization_name = formData.get('otherOrganizationName');
                    if (!organization_name || organization_name.trim() === '') {
                        alert('Please enter the organization name');
                        return;
                    }
                }
                
                // Handle city (combo-input logic)
                let city = formData.get('city');
                if (city === 'other') {
                    city = formData.get('otherCity');
                    if (!city || city.trim() === '') {
                        alert('Please enter the city name');
                        return;
                    }
                }
                
                // Handle state (combo-input logic)
                let state = formData.get('state');
                if (state === 'other') {
                    state = formData.get('otherState');
                    if (!state || state.trim() === '') {
                        alert('Please enter the state name');
                        return;
                    }
                }
                
                // Validate required fields
                const requiredFields = ['auditeeDesignation', 'scope', 'startAuditDate', 'endAuditDate', 'reportId'];
                for (const field of requiredFields) {
                    if (!formData.get(field) || formData.get(field).trim() === '') {
                        alert(`Please fill in the ${field.replace(/([A-Z])/g, ' $1').toLowerCase()}`);
                        return;
                    }
                }
                
                // Validate combo-input fields
                if (!organization_name || organization_name.trim() === '') {
                    alert('Please select or enter an organization name');
                    return;
                }
                
                if (!city || city.trim() === '') {
                    alert('Please select or enter a city');
                    return;
                }
                
                if (!state || state.trim() === '') {
                    alert('Please select or enter a state');
                    return;
                }
                
                // Validate date range
                const startDate = new Date(formData.get('startAuditDate'));
                const endDate = new Date(formData.get('endAuditDate'));
                if (startDate >= endDate) {
                    alert('End Audit Date must be after Start Audit Date');
                    return;
                }
                
                // Disable submit button to prevent multiple submissions
                const submitBtn = this.querySelector('button[type="submit"]');
                const originalText = submitBtn ? submitBtn.textContent : 'Generate Certificate';
                if (submitBtn) {
                    submitBtn.disabled = true;
                    submitBtn.textContent = 'Processing...';
                    submitBtn.style.opacity = '0.6';
                    submitBtn.style.cursor = 'not-allowed';
                }
                
                // Prepare form data with correct combo-input values
                const submitFormData = new FormData();
                submitFormData.append('organizationName', organization_name);
                submitFormData.append('city', city);
                submitFormData.append('state', state);
                submitFormData.append('auditeeDesignation', formData.get('auditeeDesignation'));
                submitFormData.append('scope', formData.get('scope'));
                submitFormData.append('startAuditDate', formData.get('startAuditDate'));
                submitFormData.append('endAuditDate', formData.get('endAuditDate'));
                submitFormData.append('reportId', formData.get('reportId'));
                
                fetch('/process_android_app_vapt_first_audit_certificate', {
                    method: 'POST',
                    body: submitFormData
                })
                .then(response => {
                    if (response.ok) {
                        return response.blob().then(blob => {
                            // Download the certificate file
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.href = url;
                            a.download = 'Android_Application_VAPT_Certificate.docx';
                            document.body.appendChild(a);
                            a.click();
                            window.URL.revokeObjectURL(url);
                            document.body.removeChild(a);
                            
                            // Close modal
                            closeVaptModal('androidAppVaptFirstAuditCertificateModal');
                            
                            // Reset form
                            this.reset();
                            
                            // Refresh the page after a short delay to ensure download completes
                            setTimeout(() => {
                                window.location.reload();
                            }, 1000);
                        });
                    } else {
                        return response.json().then(data => {
                            throw new Error(data.error || 'Network response was not ok');
                        });
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Error: ' + error.message);
                    if (submitBtn) {
                        submitBtn.disabled = false;
                        submitBtn.textContent = originalText;
                        submitBtn.style.opacity = '1';
                        submitBtn.style.cursor = 'pointer';
                    }
                });
            });
        }
    });
    
    // IOS Mobile Application VAPT First Audit Certificate Form Handler
    document.addEventListener('DOMContentLoaded', function() {
        const iosAppVaptFirstAuditCertificateForm = document.getElementById('iosAppVaptFirstAuditCertificateForm');
        if (iosAppVaptFirstAuditCertificateForm) {
            iosAppVaptFirstAuditCertificateForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                
                // Handle organization name (combo-input logic)
                let organization_name = formData.get('organizationName');
                if (organization_name === 'other') {
                    organization_name = formData.get('otherOrganizationName');
                    if (!organization_name || organization_name.trim() === '') {
                        alert('Please enter the organization name');
                        return;
                    }
                }
                
                // Handle city (combo-input logic)
                let city = formData.get('city');
                if (city === 'other') {
                    city = formData.get('otherCity');
                    if (!city || city.trim() === '') {
                        alert('Please enter the city name');
                        return;
                    }
                }
                
                // Handle state (combo-input logic)
                let state = formData.get('state');
                if (state === 'other') {
                    state = formData.get('otherState');
                    if (!state || state.trim() === '') {
                        alert('Please enter the state name');
                        return;
                    }
                }
                
                // Validate required fields
                const requiredFields = ['auditeeDesignation', 'scope', 'startAuditDate', 'endAuditDate', 'reportId'];
                for (const field of requiredFields) {
                    if (!formData.get(field) || formData.get(field).trim() === '') {
                        alert(`Please fill in the ${field.replace(/([A-Z])/g, ' $1').toLowerCase()}`);
                        return;
                    }
                }
                
                // Validate combo-input fields
                if (!organization_name || organization_name.trim() === '') {
                    alert('Please select or enter an organization name');
                    return;
                }
                
                if (!city || city.trim() === '') {
                    alert('Please select or enter a city');
                    return;
                }
                
                if (!state || state.trim() === '') {
                    alert('Please select or enter a state');
                    return;
                }
                
                // Validate date range
                const startDate = new Date(formData.get('startAuditDate'));
                const endDate = new Date(formData.get('endAuditDate'));
                if (startDate >= endDate) {
                    alert('End Audit Date must be after Start Audit Date');
                    return;
                }
                
                // Disable submit button to prevent multiple submissions
                const submitBtn = this.querySelector('button[type="submit"]');
                const originalText = submitBtn ? submitBtn.textContent : 'Generate Certificate';
                if (submitBtn) {
                    submitBtn.disabled = true;
                    submitBtn.textContent = 'Processing...';
                    submitBtn.style.opacity = '0.6';
                    submitBtn.style.cursor = 'not-allowed';
                }
                
                // Prepare form data with correct combo-input values
                const submitFormData = new FormData();
                submitFormData.append('organizationName', organization_name);
                submitFormData.append('city', city);
                submitFormData.append('state', state);
                submitFormData.append('auditeeDesignation', formData.get('auditeeDesignation'));
                submitFormData.append('scope', formData.get('scope'));
                submitFormData.append('startAuditDate', formData.get('startAuditDate'));
                submitFormData.append('endAuditDate', formData.get('endAuditDate'));
                submitFormData.append('reportId', formData.get('reportId'));
                
                fetch('/process_ios_app_vapt_first_audit_certificate', {
                    method: 'POST',
                    body: submitFormData
                })
                .then(response => {
                    if (response.ok) {
                        return response.blob().then(blob => {
                            // Download the certificate file
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.href = url;
                            a.download = 'IOS_Application_VAPT_Certificate.docx';
                            document.body.appendChild(a);
                            a.click();
                            window.URL.revokeObjectURL(url);
                            document.body.removeChild(a);
                            
                            // Close modal
                            closeVaptModal('iosAppVaptFirstAuditCertificateModal');
                            
                            // Reset form
                            this.reset();
                            
                            // Refresh the page after a short delay to ensure download completes
                            setTimeout(() => {
                                window.location.reload();
                            }, 1000);
                        });
                    } else {
                        return response.json().then(data => {
                            throw new Error(data.error || 'Network response was not ok');
                        });
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Error: ' + error.message);
                    if (submitBtn) {
                        submitBtn.disabled = false;
                        submitBtn.textContent = originalText;
                        submitBtn.style.opacity = '1';
                        submitBtn.style.cursor = 'pointer';
                    }
                });
            });
        }
    });
    
    // API VAPT First Audit Certificate Form Handler
    document.addEventListener('DOMContentLoaded', function() {
        const apiVaptFirstAuditCertificateForm = document.getElementById('apiVaptFirstAuditCertificateForm');
        if (apiVaptFirstAuditCertificateForm) {
            apiVaptFirstAuditCertificateForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                
                // Handle organization name (combo-input logic)
                let organization_name = formData.get('organizationName');
                if (organization_name === 'other') {
                    organization_name = formData.get('otherOrganizationName');
                    if (!organization_name || organization_name.trim() === '') {
                        alert('Please enter the organization name');
                        return;
                    }
                }
                
                // Handle city (combo-input logic)
                let city = formData.get('city');
                if (city === 'other') {
                    city = formData.get('otherCity');
                    if (!city || city.trim() === '') {
                        alert('Please enter the city name');
                        return;
                    }
                }
                
                // Handle state (combo-input logic)
                let state = formData.get('state');
                if (state === 'other') {
                    state = formData.get('otherState');
                    if (!state || state.trim() === '') {
                        alert('Please enter the state name');
                        return;
                    }
                }
                
                // Validate required fields
                const requiredFields = ['auditeeDesignation', 'scope', 'startAuditDate', 'endAuditDate', 'reportId'];
                for (const field of requiredFields) {
                    if (!formData.get(field) || formData.get(field).trim() === '') {
                        alert(`Please fill in the ${field.replace(/([A-Z])/g, ' $1').toLowerCase()}`);
                        return;
                    }
                }
                
                // Validate combo-input fields
                if (!organization_name || organization_name.trim() === '') {
                    alert('Please select or enter an organization name');
                    return;
                }
                
                if (!city || city.trim() === '') {
                    alert('Please select or enter a city');
                    return;
                }
                
                if (!state || state.trim() === '') {
                    alert('Please select or enter a state');
                    return;
                }
                
                // Validate date range
                const startDate = new Date(formData.get('startAuditDate'));
                const endDate = new Date(formData.get('endAuditDate'));
                if (startDate >= endDate) {
                    alert('End Audit Date must be after Start Audit Date');
                    return;
                }
                
                // Disable submit button to prevent multiple submissions
                const submitBtn = this.querySelector('button[type="submit"]');
                const originalText = submitBtn ? submitBtn.textContent : 'Generate Certificate';
                if (submitBtn) {
                    submitBtn.disabled = true;
                    submitBtn.textContent = 'Processing...';
                    submitBtn.style.opacity = '0.6';
                    submitBtn.style.cursor = 'not-allowed';
                }
                
                // Prepare form data with correct combo-input values
                const submitFormData = new FormData();
                submitFormData.append('organizationName', organization_name);
                submitFormData.append('city', city);
                submitFormData.append('state', state);
                submitFormData.append('auditeeDesignation', formData.get('auditeeDesignation'));
                submitFormData.append('scope', formData.get('scope'));
                submitFormData.append('startAuditDate', formData.get('startAuditDate'));
                submitFormData.append('endAuditDate', formData.get('endAuditDate'));
                submitFormData.append('reportId', formData.get('reportId'));
                
                fetch('/process_api_vapt_first_audit_certificate', {
                    method: 'POST',
                    body: submitFormData
                })
                .then(response => {
                    if (response.ok) {
                        return response.blob().then(blob => {
                            // Download the certificate file
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.href = url;
                            a.download = 'API_VAPT_Certificate.docx';
                            document.body.appendChild(a);
                            a.click();
                            window.URL.revokeObjectURL(url);
                            document.body.removeChild(a);
                            
                            // Close modal
                            closeVaptModal('apiVaptFirstAuditCertificateModal');
                            
                            // Reset form
                            this.reset();
                            
                            // Refresh the page after a short delay to ensure download completes
                            setTimeout(() => {
                                window.location.reload();
                            }, 1000);
                        });
                    } else {
                        return response.json().then(data => {
                            throw new Error(data.error || 'Network response was not ok');
                        });
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Error: ' + error.message);
                    if (submitBtn) {
                        submitBtn.disabled = false;
                        submitBtn.textContent = originalText;
                        submitBtn.style.opacity = '1';
                        submitBtn.style.cursor = 'pointer';
                    }
                });
            });
        }
    });
    
    // Website VAPT First Audit Certificate Form Handler
    document.addEventListener('DOMContentLoaded', function() {
        const websiteVaptFirstAuditCertificateForm = document.getElementById('websiteVaptFirstAuditCertificateForm');
        if (websiteVaptFirstAuditCertificateForm) {
            websiteVaptFirstAuditCertificateForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                
                // Handle organization name (combo-input logic)
                let organization_name = formData.get('organizationName');
                if (organization_name === 'other') {
                    organization_name = formData.get('otherOrganizationName');
                    if (!organization_name || organization_name.trim() === '') {
                        alert('Please enter the organization name');
                        return;
                    }
                }
                
                // Handle city (combo-input logic)
                let city = formData.get('city');
                if (city === 'other') {
                    city = formData.get('otherCity');
                    if (!city || city.trim() === '') {
                        alert('Please enter the city name');
                        return;
                    }
                }
                
                // Handle state (combo-input logic)
                let state = formData.get('state');
                if (state === 'other') {
                    state = formData.get('otherState');
                    if (!state || state.trim() === '') {
                        alert('Please enter the state name');
                        return;
                    }
                }
                
                // Validate required fields
                const requiredFields = ['auditeeDesignation', 'scope', 'startAuditDate', 'endAuditDate', 'reportId'];
                for (const field of requiredFields) {
                    if (!formData.get(field) || formData.get(field).trim() === '') {
                        alert(`Please fill in the ${field.replace(/([A-Z])/g, ' $1').toLowerCase()}`);
                        return;
                    }
                }
                
                // Validate combo-input fields
                if (!organization_name || organization_name.trim() === '') {
                    alert('Please select or enter an organization name');
                    return;
                }
                
                if (!city || city.trim() === '') {
                    alert('Please select or enter a city');
                    return;
                }
                
                if (!state || state.trim() === '') {
                    alert('Please select or enter a state');
                    return;
                }
                
                // Validate date range
                const startDate = new Date(formData.get('startAuditDate'));
                const endDate = new Date(formData.get('endAuditDate'));
                if (startDate >= endDate) {
                    alert('End Audit Date must be after Start Audit Date');
                    return;
                }
                
                // Disable submit button to prevent multiple submissions
                const submitBtn = this.querySelector('button[type="submit"]');
                const originalText = submitBtn ? submitBtn.textContent : 'Generate Certificate';
                if (submitBtn) {
                    submitBtn.disabled = true;
                    submitBtn.textContent = 'Processing...';
                    submitBtn.style.opacity = '0.6';
                    submitBtn.style.cursor = 'not-allowed';
                }
                
                // Prepare form data with correct combo-input values
                const submitFormData = new FormData();
                submitFormData.append('organizationName', organization_name);
                submitFormData.append('city', city);
                submitFormData.append('state', state);
                submitFormData.append('auditeeDesignation', formData.get('auditeeDesignation'));
                submitFormData.append('scope', formData.get('scope'));
                submitFormData.append('startAuditDate', formData.get('startAuditDate'));
                submitFormData.append('endAuditDate', formData.get('endAuditDate'));
                submitFormData.append('reportId', formData.get('reportId'));
                
                fetch('/process_website_vapt_first_audit_certificate', {
                    method: 'POST',
                    body: submitFormData
                })
                .then(response => {
                    if (response.ok) {
                        return response.blob().then(blob => {
                            // Download the certificate file
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.href = url;
                            a.download = 'Website_VAPT_Certificate.docx';
                            document.body.appendChild(a);
                            a.click();
                            window.URL.revokeObjectURL(url);
                            document.body.removeChild(a);
                            
                            // Close modal
                            closeVaptModal('websiteVaptFirstAuditCertificateModal');
                            
                            // Reset form
                            this.reset();
                            
                            // Refresh the page after a short delay to ensure download completes
                            setTimeout(() => {
                                window.location.reload();
                            }, 1000);
                        });
                    } else {
                        return response.json().then(data => {
                            throw new Error(data.error || 'Network response was not ok');
                        });
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Error: ' + error.message);
                    if (submitBtn) {
                        submitBtn.disabled = false;
                        submitBtn.textContent = originalText;
                        submitBtn.style.opacity = '1';
                        submitBtn.style.cursor = 'pointer';
                    }
                });
            });
        }
    });
    
    // VAPT Follow Up Audit Certificate Form Handler
    document.addEventListener('DOMContentLoaded', function() {
        const vaptFollowUpAuditCertificateForm = document.getElementById('vaptFollowUpAuditCertificateForm');
        if (vaptFollowUpAuditCertificateForm) {
            vaptFollowUpAuditCertificateForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                
                // Handle organization name (combo-input logic)
                let organization_name = formData.get('organizationName');
                if (organization_name === 'other') {
                    organization_name = formData.get('otherOrganizationName');
                    if (!organization_name || organization_name.trim() === '') {
                        alert('Please enter the organization name');
                        return;
                    }
                }
                
                // Handle city (combo-input logic)
                let city = formData.get('city');
                if (city === 'other') {
                    city = formData.get('otherCity');
                    if (!city || city.trim() === '') {
                        alert('Please enter the city name');
                        return;
                    }
                }
                
                // Handle state (combo-input logic)
                let state = formData.get('state');
                if (state === 'other') {
                    state = formData.get('otherState');
                    if (!state || state.trim() === '') {
                        alert('Please enter the state name');
                        return;
                    }
                }
                
                // Validate required fields
                const requiredFields = ['auditeeDesignation', 'scope', 'startAuditDate', 'endAuditDate', 'firstReportId', 'reportId'];
                for (const field of requiredFields) {
                    if (!formData.get(field) || formData.get(field).trim() === '') {
                        alert(`Please fill in the ${field.replace(/([A-Z])/g, ' $1').toLowerCase()}`);
                        return;
                    }
                }
                
                // Validate combo-input fields
                if (!organization_name || organization_name.trim() === '') {
                    alert('Please select or enter an organization name');
                    return;
                }
                
                if (!city || city.trim() === '') {
                    alert('Please select or enter a city');
                    return;
                }
                
                if (!state || state.trim() === '') {
                    alert('Please select or enter a state');
                    return;
                }
                
                // Validate date range
                const startDate = new Date(formData.get('startAuditDate'));
                const endDate = new Date(formData.get('endAuditDate'));
                if (startDate >= endDate) {
                    alert('End Audit Date must be after Start Audit Date');
                    return;
                }
                
                // Disable submit button to prevent multiple submissions
                const submitBtn = this.querySelector('button[type="submit"]');
                const originalText = submitBtn ? submitBtn.textContent : 'Generate Certificate';
                if (submitBtn) {
                    submitBtn.disabled = true;
                    submitBtn.textContent = 'Processing...';
                    submitBtn.style.opacity = '0.6';
                    submitBtn.style.cursor = 'not-allowed';
                }
                
                // Prepare form data with correct combo-input values
                const submitFormData = new FormData();
                submitFormData.append('organizationName', organization_name);
                submitFormData.append('city', city);
                submitFormData.append('state', state);
                submitFormData.append('auditeeDesignation', formData.get('auditeeDesignation'));
                submitFormData.append('scope', formData.get('scope'));
                submitFormData.append('startAuditDate', formData.get('startAuditDate'));
                submitFormData.append('endAuditDate', formData.get('endAuditDate'));
                submitFormData.append('firstReportId', formData.get('firstReportId'));
                submitFormData.append('reportId', formData.get('reportId'));
                
                fetch('/process_vapt_follow_up_audit_certificate', {
                    method: 'POST',
                    body: submitFormData
                })
                .then(response => {
                    if (response.ok) {
                        return response.blob().then(blob => {
                            // Download the certificate file
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.href = url;
                            a.download = 'Infrastrcture_VAPT_Follow_Up_Certificate.docx';
                            document.body.appendChild(a);
                            a.click();
                            window.URL.revokeObjectURL(url);
                            document.body.removeChild(a);
                            
                            // Close modal
                            closeVaptModal('vaptFollowUpAuditCertificateModal');
                            
                            // Reset form
                            this.reset();
                            
                            // Refresh the page after a short delay to ensure download completes
                            setTimeout(() => {
                                window.location.reload();
                            }, 1000);
                        });
                    } else {
                        return response.json().then(data => {
                            throw new Error(data.error || 'Network response was not ok');
                        });
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Error: ' + error.message);
                    if (submitBtn) {
                        submitBtn.disabled = false;
                        submitBtn.textContent = originalText;
                        submitBtn.style.opacity = '1';
                        submitBtn.style.cursor = 'pointer';
                    }
                });
            });
        }
    });
    
    // Update close modal handler
    window.onclick = function(event) {
        if (event.target.classList.contains('modal')) {
            closeWorkPlanModal();
            closeUpdateWorkModal();
            closeSprintPlanModal();
            closeLastWeekSprintModal();
            closeExtraWorkModal();
            closeLeaveApprovalModal();
            closeComplaintModal();
        }
    }
    </script>
    
    <script src="{{ url_for('static', filename='JS/vapt_dashboard.js') }}"></script>

<script>
    // Accordion fallback initialization - ensure it works for VAPT Dashboard
    (function() {
        function initAccordion() {
            const accordionButtons = document.querySelectorAll('.accordion-btn');
            console.log('VAPT Dashboard - Initializing accordion buttons:', accordionButtons.length);
            
            accordionButtons.forEach(btn => {
                // Remove existing listeners to avoid duplicates
                const newBtn = btn.cloneNode(true);
                btn.parentNode.replaceChild(newBtn, btn);
                
                newBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    console.log('VAPT Accordion button clicked');
                    this.classList.toggle('active');
                    const content = this.nextElementSibling;
                    const chevron = this.querySelector('.fa-chevron-down');
                    
                    if (!content || !content.classList.contains('accordion-content')) {
                        console.error('VAPT Accordion content not found');
                        return;
                    }
                    
                    // Check current state
                    const currentMaxHeight = content.style.maxHeight;
                    const isOpen = currentMaxHeight && 
                                  currentMaxHeight !== '0px' && 
                                  currentMaxHeight !== '0' &&
                                  currentMaxHeight !== '';
                    
                    if (isOpen) {
                        // Close
                        content.style.maxHeight = '0px';
                        if (chevron) {
                            chevron.style.transform = 'rotate(0deg)';
                        }
                        console.log('VAPT Accordion closed');
                    } else {
                        // Open
                        content.style.maxHeight = content.scrollHeight + "px";
                        if (chevron) {
                            chevron.style.transform = 'rotate(180deg)';
                        }
                        console.log('VAPT Accordion opened, maxHeight:', content.style.maxHeight);
                    }
                });
            });
        }
        
        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function() {
                setTimeout(initAccordion, 100);
            });
        } else {
            setTimeout(initAccordion, 100);
        }
    })();
</script>
</body>
</html>



