<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audit Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/audit_dashboard.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
            // Accordion functionality
    document.querySelectorAll('.accordion-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            this.classList.toggle('active');
            const content = this.nextElementSibling;
            if (content.style.maxHeight) {
                content.style.maxHeight = null;
                this.querySelector('.fa-chevron-down').style.transform = 'rotate(0deg)';
            } else {
                content.style.maxHeight = content.scrollHeight + "px";
                this.querySelector('.fa-chevron-down').style.transform = 'rotate(180deg)';
            }
        });
    });

    </script>
    <style>
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .proceed-btn:disabled {
            opacity: 0.6 !important;
            cursor: not-allowed !important;
        }
        
        /* Remove Member Button Styles */
        .remove-member-btn {
            background-color: #e74c3c;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 10px 20px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 15px;
            display: inline-block;
            box-shadow: 0 2px 5px rgba(231, 76, 60, 0.3);
        }
        
        .remove-member-btn:hover {
            background-color: #c0392b;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(231, 76, 60, 0.4);
        }
        
        .remove-member-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 5px rgba(231, 76, 60, 0.3);
        }
        
        .remove-member-btn:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(231, 76, 60, 0.3);
        }
        
        /* Team Member Container Styles */
        .team-member {
            position: relative;
            padding: 15px;
            margin-bottom: 15px;
            background-color: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .team-member:hover {
            border-color: #d0d0d0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        /* Button Styles for First Audit MetaData and Follow Up Audit MetaData */
        .btn {
            padding: 12px 24px;
            font-size: 1rem;
            font-weight: 500;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            min-width: 120px;
        }
        
        .btn-secondary {
            background-color: #6c757d;
            color: white;
            box-shadow: 0 2px 5px rgba(108, 117, 125, 0.3);
        }
        
        .btn-secondary:hover {
            background-color: #5a6268;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(108, 117, 125, 0.4);
        }
        
        .btn-secondary:active {
            transform: translateY(0);
            box-shadow: 0 2px 5px rgba(108, 117, 125, 0.3);
        }
        
        .btn-secondary:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(108, 117, 125, 0.3);
        }
        
        .btn-primary {
            background-color: #007bff;
            color: white;
            box-shadow: 0 2px 5px rgba(0, 123, 255, 0.3);
        }
        
        .btn-primary:hover {
            background-color: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 123, 255, 0.4);
        }
        
        .btn-primary:active {
            transform: translateY(0);
            box-shadow: 0 2px 5px rgba(0, 123, 255, 0.3);
        }
        
        .btn-primary:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.3);
        }
        
        .btn-primary:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
            opacity: 0.6;
        }
        
        .btn-primary:disabled:hover {
            transform: none;
            box-shadow: 0 2px 5px rgba(108, 117, 125, 0.3);
        }
        
        .btn i {
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <div class="sidebar">
            <div class="sidebar-header">
                <h2><i class="fas fa-clipboard-check"></i> Audit Dashboard</h2>
                <p>Welcome, User</p>
            </div>
            <nav>
                <a href="#employee-section" class="active"><i class="fas fa-users"></i> Employee Details</a>
                <a href="#reporting-section"><i class="fas fa-file-alt"></i> Reporting</a>
                <a href="#chat-section"><i class="fas fa-comments"></i> AI Chat Board</a>
                <a href="#work-section"><i class="fas fa-tasks"></i> Update Your Work</a>
                <a href="{{ url_for('logout') }}"><i class="fas fa-sign-out-alt"></i> Logout</a>
            </nav>
        </div>

        
        <div class="main-content">
            <!-- Update the employee details section -->
<section id="employee-section" class="dashboard-section">
    <h1><i class="fas fa-users"></i> Employee Details</h1>
    <div class="employee-container">
        <div class="employee-card">
            <div class="employee-info">
    <img src="{{ url_for('static', filename='uploads/' + employee_data.photo) if employee_data and employee_data.photo else url_for('static', filename='images/default_avatar.jpg') }}" alt="Employee Photo" class="employee-img">
    <div class="employee-details">
        <h3>{{ current_user.employee_name }}</h3>
        <p><i class="fas fa-briefcase"></i> {{ employee_data.position if employee_data else 'Position not set' }}</p>
        <p><i class="fas fa-building"></i> {{ current_user.department }} Department</p>
        <p><i class="fas fa-clock"></i> {{ employee_data.experience if employee_data else 'Experience not set' }}</p>
    </div>
</div>
<div class="employee-additional-info">
    <div class="info-row">
        <span><i class="fas fa-graduation-cap"></i> <strong>Education:</strong> {{ employee_data.education if employee_data else 'Not set' }}</span>
    </div>
    <div class="info-row">
        <span><i class="fas fa-certificate"></i> <strong>Certification:</strong> {{ employee_data.certifications if employee_data else 'Not set' }}</span>
    </div>
    <div class="info-row">
        <span><i class="fas fa-birthday-cake"></i> <strong>DOB:</strong> {{ employee_data.date_of_birth.strftime('%d/%m/%Y') if employee_data and employee_data.date_of_birth else 'Not set' }}</span>
    </div>
    <div class="info-row">
        <span><i class="fas fa-tint"></i> <strong>Blood Group:</strong> {{ employee_data.blood_group if employee_data else 'Not set' }}</span>
    </div>
    <div class="info-row">
        <span><i class="fas fa-envelope"></i> <strong>Email:</strong> {{ current_user.email }}</span>
    </div>
    <div class="info-row">
        <span><i class="fas fa-phone"></i> <strong>Contact:</strong> {{ employee_data.contact_number if employee_data else 'Not set' }}</span>
    </div>
</div>
        </div>

<div class="progress-chart">
    <span class="chart-title">Previous Month Performance</span>
    <div id="progressChartContainer" style="width: 100%; height: 260px; position: relative; display: block; min-height: 260px;">
        <canvas id="progressChart" style="display: block; width: 100% !important; height: 100% !important;"></canvas>
    </div>
    <span class="chart-title" style="margin-top: 2rem;">Last Year Performance</span>
    <div id="lastYearChartContainer" style="width: 100%; height: 260px; position: relative; display: block; min-height: 260px;">
        <canvas id="lastYearChart" style="display: block; width: 100% !important; height: 100% !important;"></canvas>
    </div>
</div>

    </div>
</section>
     <div id="firstAuditModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Infrastructure VAPT First Audit Details</h3>
   
                    <span class="close-modal" onclick="closeModal('firstAuditModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="firstAuditForm" action="/process_first_audit_report" method="POST" enctype="multipart/form-data">
                        <!-- Organization Section -->
                        <div class="form-group">
                            <label for="organization">Organization Name*</label>
                            <div class="combo-input">
                                <select id="organization" name="organization" required onchange="toggleOtherInput('organization', 'otherOrganization')">
                                    <option value="">Select Organization</option>
                                    <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                    <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                    <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                    <option value="Megasoft Limited">Megasoft Limited</option>
                                    <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                    <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                    <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                    <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                    <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                    <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                    <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                    <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                    <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                    <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                    <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                    <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                    <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                    <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                    <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                    <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                    <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                    <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                    <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                    <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                    <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                    <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                    <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                    <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                    <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                    <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                    <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                    <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                    <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                    <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                    <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                    <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                    <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                    <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                    <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                    <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                    <option value="other">Other (Please specify)</option>
                                </select>
                                <input type="text" id="otherOrganization" name="otherOrganization" class="hidden" placeholder="Enter Organization Name">
                            </div>
                        </div>

                        <!-- Location Section -->
                        <div class="form-row">
                            <div class="form-group">
                                <label for="city">City*</label>
                                <div class="combo-input">
                                    <select id="city" name="city" required onchange="toggleOtherInput('city', 'otherCity')">
                                        <option value="">Select City</option>
                                        <!-- Gujarat -->
                                        <option value="Ahmedabad">Ahmedabad</option>
                                        <option value="Amreli">Amreli</option>
                                        <option value="Anand">Anand</option>
                                        <option value="Aravalli">Aravalli</option>
                                        <option value="Banaskantha">Banaskantha</option>
                                        <option value="Bharuch">Bharuch</option>
                                        <option value="Bhavnagar">Bhavnagar</option>
                                        <option value="Botad">Botad</option>
                                        <option value="Chhota Udaipur">Chhota Udaipur</option>
                                        <option value="Dahod">Dahod</option>
                                        <option value="Dang">Dang</option>
                                        <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                        <option value="Gandhinagar">Gandhinagar</option>
                                        <option value="Gir Somnath">Gir Somnath</option>
                                        <option value="Jamnagar">Jamnagar</option>
                                        <option value="Junagadh">Junagadh</option>
                                        <option value="Kheda">Kheda</option>
                                        <option value="Kutch">Kutch</option>
                                        <option value="Mahisagar">Mahisagar</option>
                                        <option value="Mehsana">Mehsana</option>
                                        <option value="Morbi">Morbi</option>
                                        <option value="Narmada">Narmada</option>
                                        <option value="Navsari">Navsari</option>
                                        <option value="Patan">Patan</option>
                                        <option value="Panchmahal">Panchmahal</option>
                                        <option value="Porbandar">Porbandar</option>
                                        <option value="Rajkot">Rajkot</option>
                                        <option value="Sabarkantha">Sabarkantha</option>
                                        <option value="Surat">Surat</option>
                                        <option value="Surendranagar">Surendranagar</option>
                                        <option value="Tapi">Tapi</option>
                                        <option value="Vadodara">Vadodara</option>
                                        <option value="Valsad">Valsad</option>

                                        <!-- Rajasthan -->
                                        <option value="Ajmer">Ajmer</option>
                                        <option value="Alwar">Alwar</option>
                                        <option value="Banswara">Banswara</option>
                                        <option value="Baran">Baran</option>
                                        <option value="Barmer">Barmer</option>
                                        <option value="Bharatpur">Bharatpur</option>
                                        <option value="Bhilwara">Bhilwara</option>
                                        <option value="Bikaner">Bikaner</option>
                                        <option value="Bundi">Bundi</option>
                                        <option value="Chittorgarh">Chittorgarh</option>
                                        <option value="Churu">Churu</option>
                                        <option value="Dausa">Dausa</option>
                                        <option value="Dholpur">Dholpur</option>
                                        <option value="Dungarpur">Dungarpur</option>
                                        <option value="Hanumangarh">Hanumangarh</option>
                                        <option value="Jaipur">Jaipur</option>
                                        <option value="Jaisalmer">Jaisalmer</option>
                                        <option value="Jalore">Jalore</option>
                                        <option value="Jhalawar">Jhalawar</option>
                                        <option value="Jhunjhunu">Jhunjhunu</option>
                                        <option value="Jodhpur">Jodhpur</option>
                                        <option value="Karauli">Karauli</option>
                                        <option value="Kota">Kota</option>
                                        <option value="Nagaur">Nagaur</option>
                                        <option value="Pali">Pali</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rajsamand">Rajsamand</option>
                                        <option value="Sikar">Sikar</option>
                                        <option value="Sirohi">Sirohi</option>
                                        <option value="Sri Ganganagar">Sri Ganganagar</option>
                                        <option value="Tonk">Tonk</option>
                                        <option value="Udaipur">Udaipur</option>

                                        <!-- Maharashtra -->
                                        <option value="Ahmednagar">Ahmednagar</option>
                                        <option value="Akola">Akola</option>
                                        <option value="Amravati">Amravati</option>
                                        <option value="Aurangabad">Aurangabad</option>
                                        <option value="Beed">Beed</option>
                                        <option value="Bhandara">Bhandara</option>
                                        <option value="Chandrapur">Chandrapur</option>
                                        <option value="Dhule">Dhule</option>
                                        <option value="Gadchiroli">Gadchiroli</option>
                                        <option value="Gondia">Gondia</option>
                                        <option value="Hingoli">Hingoli</option>
                                        <option value="Jalgaon">Jalgaon</option>
                                        <option value="Jalna">Jalna</option>
                                        <option value="Kolhapur">Kolhapur</option>
                                        <option value="Latur">Latur</option>
                                        <option value="Mumbai">Mumbai</option>
                                        <option value="Mumbai Suburban">Mumbai Suburban</option>
                                        <option value="Nagpur">Nagpur</option>
                                        <option value="Nanded">Nanded</option>
                                        <option value="Nandurbar">Nandurbar</option>
                                        <option value="Nashik">Nashik</option>
                                        <option value="Osmanabad">Osmanabad</option>
                                        <option value="Palghar">Palghar</option>
                                        <option value="Parbhani">Parbhani</option>
                                        <option value="Pune">Pune</option>
                                        <option value="Raigad">Raigad</option>
                                        <option value="Ratnagiri">Ratnagiri</option>
                                        <option value="Sangli">Sangli</option>
                                        <option value="Satara">Satara</option>
                                        <option value="Sindhudurg">Sindhudurg</option>
                                        <option value="Solapur">Solapur</option>
                                        <option value="Thane">Thane</option>
                                        <option value="Wardha">Wardha</option>
                                        <option value="Washim">Washim</option>
                                        <option value="Yavatmal">Yavatmal</option>

                                        <!-- Uttar Pradesh -->
                                        <option value="Agra">Agra</option>
                                        <option value="Aligarh">Aligarh</option>
                                        <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                        <option value="Amethi">Amethi</option>
                                        <option value="Amroha">Amroha</option>
                                        <option value="Auraiya">Auraiya</option>
                                        <option value="Ayodhya">Ayodhya</option>
                                        <option value="Azamgarh">Azamgarh</option>
                                        <option value="Bagpat">Bagpat</option>
                                        <option value="Bahraich">Bahraich</option>
                                        <option value="Ballia">Ballia</option>
                                        <option value="Balrampur">Balrampur</option>
                                        <option value="Banda">Banda</option>
                                        <option value="Barabanki">Barabanki</option>
                                        <option value="Bareilly">Bareilly</option>
                                        <option value="Basti">Basti</option>
                                        <option value="Bhadohi">Bhadohi</option>
                                        <option value="Bijnor">Bijnor</option>
                                        <option value="Bulandshahr">Bulandshahr</option>
                                        <option value="Chandauli">Chandauli</option>
                                        <option value="Chitrakoot">Chitrakoot</option>
                                        <option value="Deoria">Deoria</option>
                                        <option value="Etah">Etah</option>
                                        <option value="Etawah">Etawah</option>
                                        <option value="Farrukhabad">Farrukhabad</option>
                                        <option value="Fatehpur">Fatehpur</option>
                                        <option value="Firozabad">Firozabad</option>
                                        <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                        <option value="Ghaziabad">Ghaziabad</option>
                                        <option value="Ghazipur">Ghazipur</option>
                                        <option value="Gonda">Gonda</option>
                                        <option value="Gorakhpur">Gorakhpur</option>
                                        <option value="Hamirpur">Hamirpur</option>
                                        <option value="Hapur">Hapur</option>
                                        <option value="Hardoi">Hardoi</option>
                                        <option value="Hathras">Hathras</option>
                                        <option value="Jalaun">Jalaun</option>
                                        <option value="Jaunpur">Jaunpur</option>
                                        <option value="Jhansi">Jhansi</option>
                                        <option value="Kannauj">Kannauj</option>
                                        <option value="Kanpur Dehat">Kanpur Dehat</option>
                                        <option value="Kanpur Nagar">Kanpur Nagar</option>
                                        <option value="Kasganj">Kasganj</option>
                                        <option value="Kaushambi">Kaushambi</option>
                                        <option value="Kushinagar">Kushinagar</option>
                                        <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                        <option value="Lalitpur">Lalitpur</option>
                                        <option value="Lucknow">Lucknow</option>
                                        <option value="Maharajganj">Maharajganj</option>
                                        <option value="Mahoba">Mahoba</option>
                                        <option value="Mainpuri">Mainpuri</option>
                                        <option value="Mathura">Mathura</option>
                                        <option value="Mau">Mau</option>
                                        <option value="Meerut">Meerut</option>
                                        <option value="Mirzapur">Mirzapur</option>
                                        <option value="Moradabad">Moradabad</option>
                                        <option value="Muzaffarnagar">Muzaffarnagar</option>
                                        <option value="Pilibhit">Pilibhit</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rae Bareli">Rae Bareli</option>
                                        <option value="Rampur">Rampur</option>
                                        <option value="Saharanpur">Saharanpur</option>
                                        <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                        <option value="Shahjahanpur">Shahjahanpur</option>
                                        <option value="Shravasti">Shravasti</option>
                                        <option value="Siddharthnagar">Siddharthnagar</option>
                                        <option value="Sitapur">Sitapur</option>
                                        <option value="Sonbhadra">Sonbhadra</option>
                                        <option value="Sultanpur">Sultanpur</option>
                                        <option value="Unnao">Unnao</option>
                                        <option value="Varanasi">Varanasi</option>

                                        <!-- Uttarakhand -->
                                        <option value="Almora">Almora</option>
                                        <option value="Bageshwar">Bageshwar</option>
                                        <option value="Chamoli">Chamoli</option>
                                        <option value="Champawat">Champawat</option>
                                        <option value="Dehradun">Dehradun</option>
                                        <option value="Haridwar">Haridwar</option>
                                        <option value="Nainital">Nainital</option>
                                        <option value="Pauri Garhwal">Pauri Garhwal</option>
                                        <option value="Pithoragarh">Pithoragarh</option>
                                        <option value="Rudraprayag">Rudraprayag</option>
                                        <option value="Tehri Garhwal">Tehri Garhwal</option>
                                        <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                        <option value="Uttarkashi">Uttarkashi</option>

                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="otherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="state">State*</label>
                                <select id="state" name="state" required>
                                    <option value="">Select State</option>
                                    <!-- States -->
                                    <option value="Andhra Pradesh">Andhra Pradesh</option>
                                    <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                    <option value="Assam">Assam</option>
                                    <option value="Bihar">Bihar</option>
                                    <option value="Chhattisgarh">Chhattisgarh</option>
                                    <option value="Goa">Goa</option>
                                    <option value="Gujarat">Gujarat</option>
                                    <option value="Haryana">Haryana</option>
                                    <option value="Himachal Pradesh">Himachal Pradesh</option>
                                    <option value="Jharkhand">Jharkhand</option>
                                    <option value="Karnataka">Karnataka</option>
                                    <option value="Kerala">Kerala</option>
                                    <option value="Madhya Pradesh">Madhya Pradesh</option>
                                    <option value="Maharashtra">Maharashtra</option>
                                    <option value="Manipur">Manipur</option>
                                    <option value="Meghalaya">Meghalaya</option>
                                    <option value="Mizoram">Mizoram</option>
                                    <option value="Nagaland">Nagaland</option>
                                    <option value="Odisha">Odisha</option>
                                    <option value="Punjab">Punjab</option>
                                    <option value="Rajasthan">Rajasthan</option>
                                    <option value="Sikkim">Sikkim</option>
                                    <option value="Tamil Nadu">Tamil Nadu</option>
                                    <option value="Telangana">Telangana</option>
                                    <option value="Tripura">Tripura</option>
                                    <option value="Uttar Pradesh">Uttar Pradesh</option>
                                    <option value="Uttarakhand">Uttarakhand</option>
                                    <option value="West Bengal">West Bengal</option>

                                    <!-- Union Territories -->
                                    <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                    <option value="Chandigarh">Chandigarh</option>
                                    <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                    <option value="Delhi">Delhi</option>
                                    <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                    <option value="Ladakh">Ladakh</option>
                                    <option value="Lakshadweep">Lakshadweep</option>
                                    <option value="Puducherry">Puducherry</option>

                                </select>
                            </div>
                        </div>

                        <!-- Audit Dates -->
                        <div class="form-row">
                            <div class="form-group">
                                <label for="startDate">Start Audit Date*</label>
                                <input type="date" id="startDate" name="startDate" required>
                            </div>
                            <div class="form-group">
                                <label for="endDate">Finish Audit Date*</label>
                                <input type="date" id="endDate" name="endDate" required>
                            </div>
                        </div>

                        <!-- Report Prepared By -->
                        <div class="form-group">
                            <label>Report Prepared By*</label>
                            <div class="name-input">
                                <select class="title-select" name="preparedByTitle" required>
                                    <option value="Mr.">Mr.</option>
                                    <option value="Ms.">Ms.</option>
                                    <option value="Mrs.">Mrs.</option>
                                    <option value="Dr.">Dr.</option>
                                </select>
                                <input type="text" placeholder="Full Name" name="preparedByName" required>
                            </div>
                        </div>

                        <!-- Auditee Details -->
                        <div class="form-group">
                            <label>Name of Auditee Organization Person*</label>
                            <div class="name-input">
                                <select class="title-select" name="auditeeTitle" required>
                                    <option value="Mr.">Mr.</option>
                                    <option value="Ms.">Ms.</option>
                                    <option value="Mrs.">Mrs.</option>
                                    <option value="Dr.">Dr.</option>
                                </select>
                                <input type="text" placeholder="Full Name" name="auditeeName" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="designation">Designation of the Person*</label>
                            <input type="text" id="designation" name="designation" required>
                        </div>

                        <div class="form-group">
                            <label for="bankEmail">Email ID of the Bank*</label>
                            <div id="emailContainer">
                                <input type="email" name="bankEmail[]" placeholder="Email Address" required>
                            </div>
                            <button type="button" class="add-member-btn" id="addEmailBtn" style="margin-top: 10px;">+ Add Another Email</button>
                        </div>

                        <!-- Auditing Team -->
                        <div class="form-group">
                            <label>Details of Auditing Team* (At least 1 required, max 8)</label>
                            <div id="auditTeamContainer">
                                <div class="team-member" data-index="0">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <input type="text" name="teamName[]" placeholder="Name*" required>
                                        </div>
                                        <div class="form-group">
                                            <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                                        </div>
                                        <div class="form-group">
                                            <input type="text" name="teamQualification[]" placeholder="Qualification/Certification*" required>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label>Certified (Yes/No)*</label>
                                        <div class="radio-group">
                                            <label><input type="radio" name="teamCertified[0]" value="yes" required> Yes</label>
                                            <label><input type="radio" name="teamCertified[0]" value="no"> No</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <button type="button" class="add-member-btn" id="addMemberBtn">+ Add Team Member</button>
                        </div>

                        <!-- File Uploads -->
                        <div class="form-group">
                            <label>File Uploads*</label>
                            
                            <div class="file-upload-group">
                                <label for="nmapFiles">Nmap Zip Files</label>
                                <input type="file" id="nmapFiles" name="nmapFiles" accept=".zip" required>
                                <small class="file-help" style="color: brown;">All Nmap files must be placed directly in the ZIP file (no nested folders) and must be in CSV format.</small>
                            </div>
                            
                            <div class="file-upload-group">
                                <label for="nessusFiles">Nessus Zip Files</label>
                                <input type="file" id="nessusFiles" name="nessusFiles" accept=".zip" required>
                                <small class="file-help" style="color: brown;">All Nessus files must be placed directly inside a single ZIP file with no nested folders. File names should follow branch names (e.g., Head-Office, Althan), and extra text after a space or underscore is acceptable as it will be ignored. Use a dash (-) for multi-word branch names (e.g., Kala-talav). For device reports (Server, Switch, Router, Firewall, Workstations, Access Points), use the device name directly. For specific devices like DR Router or DC Firewall, write them without spaces or underscores (e.g., DRRouter, DCFirewall). File names must follow these rules since the Excel report is generated based on them.</small>
                            </div>
                            
                            <div class="file-upload-group">
                                <label for="evidenceFiles">Evidences Zip Files</label>
                                <input type="file" id="evidenceFiles" name="evidenceFiles" accept=".zip" required>
                                <small class="file-help" style="color: brown;">The evidence ZIP file may contain multiple subfolders for different branches or devices; however, it is mandatory to include a folder named “ALL POC” inside the ZIP. This folder must contain one evidence image for each vulnerability that needs to be mapped and inserted into the Excel report. The name of each evidence image must exactly match the vulnerability name (for example, “SSL Certificate Expiry”). To avoid spelling errors and mismatch issues, always use copy-paste while naming files instead of typing manually. If the image file name does not exactly match the vulnerability name, that image will not be automatically added to the Excel sheet. Additionally, if any special characters are not allowed in a file name (such as /, \, :, *, ?, ", <, >, or |), replace them with a hyphen (-). For example, the vulnerability “User Enumeration / Exposure” should be renamed to “User Enumeration - Exposure” when saving the image. In cases where more than one evidence image is required for the same vulnerability, add numbering at the end of the file name (e.g., “SSL Certificate Expiry 2”, “SSL Certificate Expiry 3”, and so on). Following these instructions ensures accurate automated extraction and mapping of evidence to the respective vulnerability in the Excel report.</small>
                         
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('firstAuditModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Report</button>
                        </div>
                        <br>
                        <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>  
                         </small>

                    </form>
                </div>
            </div>
            
        </div>

        <!-- First Audit Word Report Modal -->
        <div id="firstAuditWordModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>First Audit Word Report</h3>
                    <span class="close-modal" onclick="closeModal('firstAuditWordModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="firstAuditWordForm" action="/process_first_audit_word_report" method="POST" enctype="multipart/form-data">
                        <div class="form-group">
                            <label for="excelFile">Upload Excel File (.xlsx)*</label>
                            <input type="file" id="excelFile" name="excelFile" accept=".xlsx" required>
                            <small class="file-help" style="color: brown;">Please select an Excel (.xlsx) file to generate the Word report. The Excel file must be generated using this tool to ensure proper structure and formatting. If the Excel file is created manually, there is a high chance of formatting errors that may cause issues or failures during the report generation process. Therefore, it is strictly instructed not to create the Excel file manually. Always use the tool-generated Excel file for accurate and error-free report generation. Following this requirement will help avoid processing failures and ensure that the report is generated smoothly.
                            </small>
                            <br>
                            <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>  
                            </small>

                            
                        </div>
                         
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('firstAuditWordModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Word Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Follow Up Audit Report Excel File Modal -->
        <div id="followUpAuditModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Infrastructure VAPT Follow Up Audit Details</h3>
                    <span class="close-modal" onclick="closeModal('followUpAuditModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="followUpAuditForm" action="/process_follow_up_audit_report" method="POST" enctype="multipart/form-data">
                        <!-- Organization Section -->
                        <div class="form-group">
                            <label for="followUpOrganization">Organization Name*</label>
                            <div class="combo-input">
                                <select id="followUpOrganization" name="organization" required onchange="toggleOtherInput('followUpOrganization', 'followUpOtherOrganization')">
                                    <option value="">Select Organization</option>
                                    <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                    <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                    <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                    <option value="Megasoft Limited">Megasoft Limited</option>
                                    <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                    <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                    <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                    <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                    <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                    <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                    <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                    <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                    <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                    <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                    <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                    <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                    <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                    <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                    <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                    <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                    <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                    <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                    <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                    <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                    <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                    <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                    <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                    <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                    <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                    <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                    <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                    <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                    <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                    <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                    <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                    <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                    <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                    <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                    <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                    <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                    
                                    <option value="other">Other (Please specify)</option>
                                </select>
                                <input type="text" id="followUpOtherOrganization" name="otherOrganization" class="hidden" placeholder="Enter Organization Name">
                            </div>
                        </div>

                        <!-- Location Section -->
                        <div class="form-row">
                            <div class="form-group">
                                <label for="followUpCity">City*</label>
                                <div class="combo-input">
                                    <select id="followUpCity" name="city" required onchange="toggleOtherInput('followUpCity', 'followUpOtherCity')">
                                        <option value="">Select City</option>
                                        <!-- Gujarat -->
                                        <option value="Ahmedabad">Ahmedabad</option>
                                        <option value="Amreli">Amreli</option>
                                        <option value="Anand">Anand</option>
                                        <option value="Aravalli">Aravalli</option>
                                        <option value="Banaskantha">Banaskantha</option>
                                        <option value="Bharuch">Bharuch</option>
                                        <option value="Bhavnagar">Bhavnagar</option>
                                        <option value="Botad">Botad</option>
                                        <option value="Chhota Udaipur">Chhota Udaipur</option>
                                        <option value="Dahod">Dahod</option>
                                        <option value="Dang">Dang</option>
                                        <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                        <option value="Gandhinagar">Gandhinagar</option>
                                        <option value="Gir Somnath">Gir Somnath</option>
                                        <option value="Jamnagar">Jamnagar</option>
                                        <option value="Junagadh">Junagadh</option>
                                        <option value="Kheda">Kheda</option>
                                        <option value="Kutch">Kutch</option>
                                        <option value="Mahisagar">Mahisagar</option>
                                        <option value="Mehsana">Mehsana</option>
                                        <option value="Morbi">Morbi</option>
                                        <option value="Narmada">Narmada</option>
                                        <option value="Navsari">Navsari</option>
                                        <option value="Patan">Patan</option>
                                        <option value="Panchmahal">Panchmahal</option>
                                        <option value="Porbandar">Porbandar</option>
                                        <option value="Rajkot">Rajkot</option>
                                        <option value="Sabarkantha">Sabarkantha</option>
                                        <option value="Surat">Surat</option>
                                        <option value="Surendranagar">Surendranagar</option>
                                        <option value="Tapi">Tapi</option>
                                        <option value="Vadodara">Vadodara</option>
                                        <option value="Valsad">Valsad</option>

                                        <!-- Rajasthan -->
                                        <option value="Ajmer">Ajmer</option>
                                        <option value="Alwar">Alwar</option>
                                        <option value="Banswara">Banswara</option>
                                        <option value="Baran">Baran</option>
                                        <option value="Barmer">Barmer</option>
                                        <option value="Bharatpur">Bharatpur</option>
                                        <option value="Bhilwara">Bhilwara</option>
                                        <option value="Bikaner">Bikaner</option>
                                        <option value="Bundi">Bundi</option>
                                        <option value="Chittorgarh">Chittorgarh</option>
                                        <option value="Churu">Churu</option>
                                        <option value="Dausa">Dausa</option>
                                        <option value="Dholpur">Dholpur</option>
                                        <option value="Dungarpur">Dungarpur</option>
                                        <option value="Hanumangarh">Hanumangarh</option>
                                        <option value="Jaipur">Jaipur</option>
                                        <option value="Jaisalmer">Jaisalmer</option>
                                        <option value="Jalore">Jalore</option>
                                        <option value="Jhalawar">Jhalawar</option>
                                        <option value="Jhunjhunu">Jhunjhunu</option>
                                        <option value="Jodhpur">Jodhpur</option>
                                        <option value="Karauli">Karauli</option>
                                        <option value="Kota">Kota</option>
                                        <option value="Nagaur">Nagaur</option>
                                        <option value="Pali">Pali</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rajsamand">Rajsamand</option>
                                        <option value="Sikar">Sikar</option>
                                        <option value="Sirohi">Sirohi</option>
                                        <option value="Sri Ganganagar">Sri Ganganagar</option>
                                        <option value="Tonk">Tonk</option>
                                        <option value="Udaipur">Udaipur</option>

                                        <!-- Maharashtra -->
                                        <option value="Ahmednagar">Ahmednagar</option>
                                        <option value="Akola">Akola</option>
                                        <option value="Amravati">Amravati</option>
                                        <option value="Aurangabad">Aurangabad</option>
                                        <option value="Beed">Beed</option>
                                        <option value="Bhandara">Bhandara</option>
                                        <option value="Chandrapur">Chandrapur</option>
                                        <option value="Dhule">Dhule</option>
                                        <option value="Gadchiroli">Gadchiroli</option>
                                        <option value="Gondia">Gondia</option>
                                        <option value="Hingoli">Hingoli</option>
                                        <option value="Jalgaon">Jalgaon</option>
                                        <option value="Jalna">Jalna</option>
                                        <option value="Kolhapur">Kolhapur</option>
                                        <option value="Latur">Latur</option>
                                        <option value="Mumbai City">Mumbai City</option>
                                        <option value="Mumbai Suburban">Mumbai Suburban</option>
                                        <option value="Nagpur">Nagpur</option>
                                        <option value="Nanded">Nanded</option>
                                        <option value="Nandurbar">Nandurbar</option>
                                        <option value="Nashik">Nashik</option>
                                        <option value="Osmanabad">Osmanabad</option>
                                        <option value="Palghar">Palghar</option>
                                        <option value="Parbhani">Parbhani</option>
                                        <option value="Pune">Pune</option>
                                        <option value="Raigad">Raigad</option>
                                        <option value="Ratnagiri">Ratnagiri</option>
                                        <option value="Sangli">Sangli</option>
                                        <option value="Satara">Satara</option>
                                        <option value="Sindhudurg">Sindhudurg</option>
                                        <option value="Solapur">Solapur</option>
                                        <option value="Thane">Thane</option>
                                        <option value="Wardha">Wardha</option>
                                        <option value="Washim">Washim</option>
                                        <option value="Yavatmal">Yavatmal</option>

                                        <!-- Uttar Pradesh -->
                                        <option value="Agra">Agra</option>
                                        <option value="Aligarh">Aligarh</option>
                                        <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                        <option value="Amethi">Amethi</option>
                                        <option value="Amroha">Amroha</option>
                                        <option value="Auraiya">Auraiya</option>
                                        <option value="Ayodhya">Ayodhya</option>
                                        <option value="Azamgarh">Azamgarh</option>
                                        <option value="Bagpat">Bagpat</option>
                                        <option value="Bahraich">Bahraich</option>
                                        <option value="Ballia">Ballia</option>
                                        <option value="Balrampur">Balrampur</option>
                                        <option value="Banda">Banda</option>
                                        <option value="Barabanki">Barabanki</option>
                                        <option value="Bareilly">Bareilly</option>
                                        <option value="Basti">Basti</option>
                                        <option value="Bhadohi">Bhadohi</option>
                                        <option value="Bijnor">Bijnor</option>
                                        <option value="Bulandshahr">Bulandshahr</option>
                                        <option value="Chandauli">Chandauli</option>
                                        <option value="Chitrakoot">Chitrakoot</option>
                                        <option value="Deoria">Deoria</option>
                                        <option value="Etah">Etah</option>
                                        <option value="Etawah">Etawah</option>
                                        <option value="Farrukhabad">Farrukhabad</option>
                                        <option value="Fatehpur">Fatehpur</option>
                                        <option value="Firozabad">Firozabad</option>
                                        <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                        <option value="Ghaziabad">Ghaziabad</option>
                                        <option value="Ghazipur">Ghazipur</option>
                                        <option value="Gonda">Gonda</option>
                                        <option value="Gorakhpur">Gorakhpur</option>
                                        <option value="Hamirpur">Hamirpur</option>
                                        <option value="Hapur">Hapur</option>
                                        <option value="Hardoi">Hardoi</option>
                                        <option value="Hathras">Hathras</option>
                                        <option value="Jalaun">Jalaun</option>
                                        <option value="Jaunpur">Jaunpur</option>
                                        <option value="Jhansi">Jhansi</option>
                                        <option value="Kannauj">Kannauj</option>
                                        <option value="Kanpur Dehat">Kanpur Dehat</option>
                                        <option value="Kanpur Nagar">Kanpur Nagar</option>
                                        <option value="Kasganj">Kasganj</option>
                                        <option value="Kaushambi">Kaushambi</option>
                                        <option value="Kushinagar">Kushinagar</option>
                                        <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                        <option value="Lalitpur">Lalitpur</option>
                                        <option value="Lucknow">Lucknow</option>
                                        <option value="Maharajganj">Maharajganj</option>
                                        <option value="Mahoba">Mahoba</option>
                                        <option value="Mainpuri">Mainpuri</option>
                                        <option value="Mathura">Mathura</option>
                                        <option value="Mau">Mau</option>
                                        <option value="Meerut">Meerut</option>
                                        <option value="Mirzapur">Mirzapur</option>
                                        <option value="Moradabad">Moradabad</option>
                                        <option value="Muzaffarnagar">Muzaffarnagar</option>
                                        <option value="Pilibhit">Pilibhit</option>
                                        <option value="Pratapgarh">Pratapgarh</option>
                                        <option value="Rae Bareli">Rae Bareli</option>
                                        <option value="Rampur">Rampur</option>
                                        <option value="Saharanpur">Saharanpur</option>
                                        <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                        <option value="Shahjahanpur">Shahjahanpur</option>
                                        <option value="Shravasti">Shravasti</option>
                                        <option value="Siddharthnagar">Siddharthnagar</option>
                                        <option value="Sitapur">Sitapur</option>
                                        <option value="Sonbhadra">Sonbhadra</option>
                                        <option value="Sultanpur">Sultanpur</option>
                                        <option value="Unnao">Unnao</option>
                                        <option value="Varanasi">Varanasi</option>

                                        <!-- Uttarakhand -->
                                        <option value="Almora">Almora</option>
                                        <option value="Bageshwar">Bageshwar</option>
                                        <option value="Chamoli">Chamoli</option>
                                        <option value="Champawat">Champawat</option>
                                        <option value="Dehradun">Dehradun</option>
                                        <option value="Haridwar">Haridwar</option>
                                        <option value="Nainital">Nainital</option>
                                        <option value="Pauri Garhwal">Pauri Garhwal</option>
                                        <option value="Pithoragarh">Pithoragarh</option>
                                        <option value="Rudraprayag">Rudraprayag</option>
                                        <option value="Tehri Garhwal">Tehri Garhwal</option>
                                        <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                        <option value="Uttarkashi">Uttarkashi</option>


                                        <option value="other">Other (Please specify)</option>
                                    </select>
                                    <input type="text" id="followUpOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="followUpState">State*</label>
                                <select id="followUpState" name="state" required>
                                    <option value="">Select State</option>
                                    <option value="Andhra Pradesh">Andhra Pradesh</option>
                                    <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                    <option value="Assam">Assam</option>
                                    <option value="Bihar">Bihar</option>
                                    <option value="Chhattisgarh">Chhattisgarh</option>
                                    <option value="Goa">Goa</option>
                                    <option value="Gujarat">Gujarat</option>
                                    <option value="Haryana">Haryana</option>
                                    <option value="Himachal Pradesh">Himachal Pradesh</option>
                                    <option value="Jharkhand">Jharkhand</option>
                                    <option value="Karnataka">Karnataka</option>
                                    <option value="Kerala">Kerala</option>
                                    <option value="Madhya Pradesh">Madhya Pradesh</option>
                                    <option value="Maharashtra">Maharashtra</option>
                                    <option value="Manipur">Manipur</option>
                                    <option value="Meghalaya">Meghalaya</option>
                                    <option value="Mizoram">Mizoram</option>
                                    <option value="Nagaland">Nagaland</option>
                                    <option value="Odisha">Odisha</option>
                                    <option value="Punjab">Punjab</option>
                                    <option value="Rajasthan">Rajasthan</option>
                                    <option value="Sikkim">Sikkim</option>
                                    <option value="Tamil Nadu">Tamil Nadu</option>
                                    <option value="Telangana">Telangana</option>
                                    <option value="Tripura">Tripura</option>
                                    <option value="Uttar Pradesh">Uttar Pradesh</option>
                                    <option value="Uttarakhand">Uttarakhand</option>
                                    <option value="West Bengal">West Bengal</option>

                                    <!-- Union Territories -->
                     d               <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                    <option value="Chandigarh">Chandigarh</option>
                                    <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                    <option value="Delhi">Delhi</option>
                                    <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                    <option value="Ladakh">Ladakh</option>
                                    <option value="Lakshadweep">Lakshadweep</option>
                                    <option value="Puducherry">Puducherry</option>

                                </select>
                            </div>
                        </div>

                        <!-- First Audit Report Details -->
                        <div class="form-row">
                            <div class="form-group">
                                <label for="followUpFirstAuditReportId">First Audit Report ID*</label>
                                <input type="text" id="followUpFirstAuditReportId" name="firstAuditReportId" placeholder="Enter First Audit Report ID" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="followUpFirstAuditReportDate">First Audit Report Release Date*</label>
                                <input type="date" id="followUpFirstAuditReportDate" name="firstAuditReportDate" required>
                            </div>
                        </div>

                        <!-- Audit Dates -->
                        <div class="form-row">
                            <div class="form-group">
                                <label for="followUpStartDate">Start Audit Date*</label>
                                <input type="date" id="followUpStartDate" name="startDate" required>
                            </div>
                            <div class="form-group">
                                <label for="followUpEndDate">Finish Audit Date*</label>
                                <input type="date" id="followUpEndDate" name="endDate" required>
                            </div>
                        </div>

                        <!-- Report Prepared By -->
                        <div class="form-group">
                            <label>Report Prepared By*</label>
                            <div class="name-input">
                                <select class="title-select" name="preparedByTitle" required>
                                    <option value="Mr.">Mr.</option>
                                    <option value="Ms.">Ms.</option>
                                    <option value="Mrs.">Mrs.</option>
                                    <option value="Dr.">Dr.</option>
                                </select>
                                <input type="text" placeholder="Full Name" name="preparedByName" required>
                            </div>
                        </div>

                        <!-- Auditee Details -->
                        <div class="form-group">
                            <label>Name of Auditee Organization Person*</label>
                            <div class="name-input">
                                <select class="title-select" name="auditeeTitle" required>
                                    <option value="Mr.">Mr.</option>
                                    <option value="Ms.">Ms.</option>
                                    <option value="Mrs.">Mrs.</option>
                                    <option value="Dr.">Dr.</option>
                                </select>
                                <input type="text" placeholder="Full Name" name="auditeeName" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="followUpDesignation">Designation of the Person*</label>
                            <input type="text" id="followUpDesignation" name="designation" required>
                        </div>

                        <div class="form-group">
                            <label for="followUpBankEmail">Email ID of the Bank*</label>
                            <div id="followUpEmailContainer">
                                <input type="email" name="bankEmail[]" placeholder="Email Address" required>
                            </div>
                            <button type="button" class="add-member-btn" id="addFollowUpEmailBtn" style="margin-top: 10px;">+ Add Another Email</button>
                        </div>

                        <!-- Auditing Team -->
                        <div class="form-group">
                            <label>Details of Auditing Team* (At least 1 required, max 8)</label>
                            <div id="followUpAuditTeamContainer">
                                <div class="team-member" data-index="0">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <input type="text" name="teamName[]" placeholder="Name*" required>
                                        </div>
                                        <div class="form-group">
                                            <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                                        </div>
                                        <div class="form-group">
                                            <input type="text" name="teamQualification[]" placeholder="Qualification/Certification*" required>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label>Certified (Yes/No)*</label>
                                        <div class="radio-group">
                                            <label><input type="radio" name="teamCertified[0]" value="yes" required> Yes</label>
                                            <label><input type="radio" name="teamCertified[0]" value="no"> No</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <button type="button" class="add-member-btn" id="addFollowUpMemberBtn">+ Add Team Member</button>
                        </div>

                        <!-- File Uploads -->
                        <div class="form-group">
                            <label>File Uploads*</label>
                            
                            <div class="file-upload-group">
                                <label for="followUpNmapFiles">Nmap Zip Files</label>
                                <input type="file" id="followUpNmapFiles" name="nmapFiles" accept=".zip" required>
                                <small class="file-help" style="color: brown;">All Nmap files must be placed directly in the ZIP file (no nested folders) and must be in CSV format.</small>
                            </div>
                            
                            <div class="file-upload-group">
                                <label for="followUpNessusFiles">Nessus Zip Files</label>
                                <input type="file" id="followUpNessusFiles" name="nessusFiles" accept=".zip" required>
                                <small class="file-help" style="color: brown;">All Nessus files must be placed directly inside a single ZIP file with no nested folders. File names should follow branch names (e.g., Head-Office, Althan), and extra text after a space or underscore is acceptable as it will be ignored. Use a dash (-) for multi-word branch names (e.g., Kala-talav). For device reports (Server, Switch, Router, Firewall, Workstations, Access Points), use the device name directly. For specific devices like DR Router or DC Firewall, write them without spaces or underscores (e.g., DRRouter, DCFirewall). File names must follow these rules since the Excel report is generated based on them.</small>
                            </div>
                            
                            <div class="file-upload-group">
                                <label for="followUpEvidenceFiles">Evidences Zip Files</label>
                                <input type="file" id="followUpEvidenceFiles" name="evidenceFiles" accept=".zip" required>
                                <small class="file-help" style="color: brown;">The evidence ZIP file may contain multiple subfolders for different branches or devices; however, it is mandatory to include a folder named “ALL POC” inside the ZIP. This folder must contain one evidence image for each vulnerability that needs to be mapped and inserted into the Excel report. The name of each evidence image must exactly match the vulnerability name (for example, “SSL Certificate Expiry”). To avoid spelling errors and mismatch issues, always use copy-paste while naming files instead of typing manually. If the image file name does not exactly match the vulnerability name, that image will not be automatically added to the Excel sheet. Additionally, if any special characters are not allowed in a file name (such as /, \, :, *, ?, ", <, >, or |), replace them with a hyphen (-). For example, the vulnerability “User Enumeration / Exposure” should be renamed to “User Enumeration - Exposure” when saving the image. In cases where more than one evidence image is required for the same vulnerability, add numbering at the end of the file name (e.g., “SSL Certificate Expiry 2”, “SSL Certificate Expiry 3”, and so on). Following these instructions ensures accurate automated extraction and mapping of evidence to the respective vulnerability in the Excel report.</small>
                            </div>

                            <div class="file-upload-group">
                                <label for="userExcelFile">First Audit Excel File *</label>
                                <input type="file" id="userExcelFile" name="userExcelFile" accept=".xlsx" required>
                                <small class="file-help" style="color: brown;">Upload Infrastrcture VAPT First Audit Excel File Here.</small>
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('followUpAuditModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Report</button>
                        </div>
                        <br>
                        <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>  
                         </small>

                    </form>
                </div>
            </div>
        </div>

        <!-- Follow Up Audit Word Report Modal -->
        <div id="followUpAuditWordModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Follow Up Audit Word Report</h3>
                    <span class="close-modal" onclick="closeModal('followUpAuditWordModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="followUpAuditWordForm" action="/process_follow_up_audit_word_report" method="POST" enctype="multipart/form-data">
                        <div class="form-group">
                            <label for="followUpExcelFile">Upload Excel File (.xlsx)*</label>
                            <input type="file" id="followUpExcelFile" name="followUpExcelFile" accept=".xlsx" required>
                            <small class="file-help" style="color: brown;">Please select an Excel (.xlsx) file to generate the Word report. The Excel file must be generated using this tool to ensure proper structure and formatting. If the Excel file is created manually, there is a high chance of formatting errors that may cause issues or failures during the report generation process. Therefore, it is strictly instructed not to create the Excel file manually. Always use the tool-generated Excel file for accurate and error-free report generation. Following this requirement will help avoid processing failures and ensure that the report is generated smoothly.
                            </small>
                            <br>
                            <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center>  
                             </small>

                            
                        </div>
                         
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('followUpAuditWordModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Word Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- First Audit Conducted Certificate Modal -->
        <div id="firstAuditCertificateModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>First Audit Conducted Certificate</h3>
                    <span class="close-modal" onclick="closeModal('firstAuditCertificateModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="firstAuditCertificateForm" action="/process_first_audit_certificate" method="POST">
                        <div class="form-group">
                            <label for="firstAuditCertificateOrganizationName">Organization Name*</label>
                            <div class="combo-input">
                                <select id="firstAuditCertificateOrganizationName" name="organizationName" required onchange="toggleOtherInput('firstAuditCertificateOrganizationName', 'firstAuditCertificateOtherOrganizationName')">
                                    <option value="">Select Organization</option>
                                    <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                    <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                    <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                    <option value="Megasoft Limited">Megasoft Limited</option>
                                    <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                    <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                    <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                    <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                    <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                    <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                    <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                    <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                    <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                    <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                    <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                    <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                    <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                    <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                    <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                    <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                    <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                    <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                    <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                    <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                    <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                    <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                    <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                    <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                    <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                    <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                    <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                    <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                    <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                    <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                    <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                    <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                    <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                    <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                    <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                    <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                    
                                    <option value="other">Other (Please specify)</option>
                                </select>
                                <input type="text" id="firstAuditCertificateOtherOrganizationName" name="otherOrganizationName" class="hidden" placeholder="Enter Organization Name">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="firstAuditCertificateCity">City*</label>
                            <div class="combo-input">
                                <select id="firstAuditCertificateCity" name="city" required onchange="toggleOtherInput('firstAuditCertificateCity', 'firstAuditCertificateOtherCity')">
                                    <option value="">Select City</option>
                                    <!-- Gujarat -->
                                    <option value="Ahmedabad">Ahmedabad</option>
                                    <option value="Amreli">Amreli</option>
                                    <option value="Anand">Anand</option>
                                    <option value="Aravalli">Aravalli</option>
                                    <option value="Banaskantha">Banaskantha</option>
                                    <option value="Bharuch">Bharuch</option>
                                    <option value="Bhavnagar">Bhavnagar</option>
                                    <option value="Botad">Botad</option>
                                    <option value="Chhota Udaipur">Chhota Udaipur</option>
                                    <option value="Dahod">Dahod</option>
                                    <option value="Dang">Dang</option>
                                    <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                    <option value="Gandhinagar">Gandhinagar</option>
                                    <option value="Gir Somnath">Gir Somnath</option>
                                    <option value="Jamnagar">Jamnagar</option>
                                    <option value="Junagadh">Junagadh</option>
                                    <option value="Kheda">Kheda</option>
                                    <option value="Kutch">Kutch</option>
                                    <option value="Mahisagar">Mahisagar</option>
                                    <option value="Mehsana">Mehsana</option>
                                    <option value="Morbi">Morbi</option>
                                    <option value="Narmada">Narmada</option>
                                    <option value="Navsari">Navsari</option>
                                    <option value="Patan">Patan</option>
                                    <option value="Panchmahal">Panchmahal</option>
                                    <option value="Porbandar">Porbandar</option>
                                    <option value="Rajkot">Rajkot</option>
                                    <option value="Sabarkantha">Sabarkantha</option>
                                    <option value="Surat">Surat</option>
                                    <option value="Surendranagar">Surendranagar</option>
                                    <option value="Tapi">Tapi</option>
                                    <option value="Vadodara">Vadodara</option>
                                    <option value="Valsad">Valsad</option>

                                    <!-- Rajasthan -->
                                    <option value="Ajmer">Ajmer</option>
                                    <option value="Alwar">Alwar</option>
                                    <option value="Banswara">Banswara</option>
                                    <option value="Baran">Baran</option>
                                    <option value="Barmer">Barmer</option>
                                    <option value="Bharatpur">Bharatpur</option>
                                    <option value="Bhilwara">Bhilwara</option>
                                    <option value="Bikaner">Bikaner</option>
                                    <option value="Bundi">Bundi</option>
                                    <option value="Chittorgarh">Chittorgarh</option>
                                    <option value="Churu">Churu</option>
                                    <option value="Dausa">Dausa</option>
                                    <option value="Dholpur">Dholpur</option>
                                    <option value="Dungarpur">Dungarpur</option>
                                    <option value="Hanumangarh">Hanumangarh</option>
                                    <option value="Jaipur">Jaipur</option>
                                    <option value="Jaisalmer">Jaisalmer</option>
                                    <option value="Jalore">Jalore</option>
                                    <option value="Jhalawar">Jhalawar</option>
                                    <option value="Jhunjhunu">Jhunjhunu</option>
                                    <option value="Jodhpur">Jodhpur</option>
                                    <option value="Karauli">Karauli</option>
                                    <option value="Kota">Kota</option>
                                    <option value="Nagaur">Nagaur</option>
                                    <option value="Pali">Pali</option>
                                    <option value="Pratapgarh">Pratapgarh</option>
                                    <option value="Rajsamand">Rajsamand</option>
                                    <option value="Sikar">Sikar</option>
                                    <option value="Sirohi">Sirohi</option>
                                    <option value="Sri Ganganagar">Sri Ganganagar</option>
                                    <option value="Tonk">Tonk</option>
                                    <option value="Udaipur">Udaipur</option>

                                    <!-- Maharashtra -->
                                    <option value="Ahmednagar">Ahmednagar</option>
                                    <option value="Akola">Akola</option>
                                    <option value="Amravati">Amravati</option>
                                    <option value="Aurangabad">Aurangabad</option>
                                    <option value="Beed">Beed</option>
                                    <option value="Bhandara">Bhandara</option>
                                    <option value="Chandrapur">Chandrapur</option>
                                    <option value="Dhule">Dhule</option>
                                    <option value="Gadchiroli">Gadchiroli</option>
                                    <option value="Gondia">Gondia</option>
                                    <option value="Hingoli">Hingoli</option>
                                    <option value="Jalgaon">Jalgaon</option>
                                    <option value="Jalna">Jalna</option>
                                    <option value="Kolhapur">Kolhapur</option>
                                    <option value="Latur">Latur</option>
                                    <option value="Mumbai City">Mumbai City</option>
                                    <option value="Mumbai Suburban">Mumbai Suburban</option>
                                    <option value="Nagpur">Nagpur</option>
                                    <option value="Nanded">Nanded</option>
                                    <option value="Nandurbar">Nandurbar</option>
                                    <option value="Nashik">Nashik</option>
                                    <option value="Osmanabad">Osmanabad</option>
                                    <option value="Palghar">Palghar</option>
                                    <option value="Parbhani">Parbhani</option>
                                    <option value="Pune">Pune</option>
                                    <option value="Raigad">Raigad</option>
                                    <option value="Ratnagiri">Ratnagiri</option>
                                    <option value="Sangli">Sangli</option>
                                    <option value="Satara">Satara</option>
                                    <option value="Sindhudurg">Sindhudurg</option>
                                    <option value="Solapur">Solapur</option>
                                    <option value="Thane">Thane</option>
                                    <option value="Wardha">Wardha</option>
                                    <option value="Washim">Washim</option>
                                    <option value="Yavatmal">Yavatmal</option>

                                    <!-- Uttar Pradesh -->
                                    <option value="Agra">Agra</option>
                                    <option value="Aligarh">Aligarh</option>
                                    <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                    <option value="Amethi">Amethi</option>
                                    <option value="Amroha">Amroha</option>
                                    <option value="Auraiya">Auraiya</option>
                                    <option value="Ayodhya">Ayodhya</option>
                                    <option value="Azamgarh">Azamgarh</option>
                                    <option value="Bagpat">Bagpat</option>
                                    <option value="Bahraich">Bahraich</option>
                                    <option value="Ballia">Ballia</option>
                                    <option value="Balrampur">Balrampur</option>
                                    <option value="Banda">Banda</option>
                                    <option value="Barabanki">Barabanki</option>
                                    <option value="Bareilly">Bareilly</option>
                                    <option value="Basti">Basti</option>
                                    <option value="Bhadohi">Bhadohi</option>
                                    <option value="Bijnor">Bijnor</option>
                                    <option value="Bulandshahr">Bulandshahr</option>
                                    <option value="Chandauli">Chandauli</option>
                                    <option value="Chitrakoot">Chitrakoot</option>
                                    <option value="Deoria">Deoria</option>
                                    <option value="Etah">Etah</option>
                                    <option value="Etawah">Etawah</option>
                                    <option value="Farrukhabad">Farrukhabad</option>
                                    <option value="Fatehpur">Fatehpur</option>
                                    <option value="Firozabad">Firozabad</option>
                                    <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                    <option value="Ghaziabad">Ghaziabad</option>
                                    <option value="Ghazipur">Ghazipur</option>
                                    <option value="Gonda">Gonda</option>
                                    <option value="Gorakhpur">Gorakhpur</option>
                                    <option value="Hamirpur">Hamirpur</option>
                                    <option value="Hapur">Hapur</option>
                                    <option value="Hardoi">Hardoi</option>
                                    <option value="Hathras">Hathras</option>
                                    <option value="Jalaun">Jalaun</option>
                                    <option value="Jaunpur">Jaunpur</option>
                                    <option value="Jhansi">Jhansi</option>
                                    <option value="Kannauj">Kannauj</option>
                                    <option value="Kanpur Dehat">Kanpur Dehat</option>
                                    <option value="Kanpur Nagar">Kanpur Nagar</option>
                                    <option value="Kasganj">Kasganj</option>
                                    <option value="Kaushambi">Kaushambi</option>
                                    <option value="Kushinagar">Kushinagar</option>
                                    <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                    <option value="Lalitpur">Lalitpur</option>
                                    <option value="Lucknow">Lucknow</option>
                                    <option value="Maharajganj">Maharajganj</option>
                                    <option value="Mahoba">Mahoba</option>
                                    <option value="Mainpuri">Mainpuri</option>
                                    <option value="Mathura">Mathura</option>
                                    <option value="Mau">Mau</option>
                                    <option value="Meerut">Meerut</option>
                                    <option value="Mirzapur">Mirzapur</option>
                                    <option value="Moradabad">Moradabad</option>
                                    <option value="Muzaffarnagar">Muzaffarnagar</option>
                                    <option value="Pilibhit">Pilibhit</option>
                                    <option value="Pratapgarh">Pratapgarh</option>
                                    <option value="Rae Bareli">Rae Bareli</option>
                                    <option value="Rampur">Rampur</option>
                                    <option value="Saharanpur">Saharanpur</option>
                                    <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                    <option value="Shahjahanpur">Shahjahanpur</option>
                                    <option value="Shravasti">Shravasti</option>
                                    <option value="Siddharthnagar">Siddharthnagar</option>
                                    <option value="Sitapur">Sitapur</option>
                                    <option value="Sonbhadra">Sonbhadra</option>
                                    <option value="Sultanpur">Sultanpur</option>
                                    <option value="Unnao">Unnao</option>
                                    <option value="Varanasi">Varanasi</option>

                                    <!-- Uttarakhand -->
                                    <option value="Almora">Almora</option>
                                    <option value="Bageshwar">Bageshwar</option>
                                    <option value="Chamoli">Chamoli</option>
                                    <option value="Champawat">Champawat</option>
                                    <option value="Dehradun">Dehradun</option>
                                    <option value="Haridwar">Haridwar</option>
                                    <option value="Nainital">Nainital</option>
                                    <option value="Pauri Garhwal">Pauri Garhwal</option>
                                    <option value="Pithoragarh">Pithoragarh</option>
                                    <option value="Rudraprayag">Rudraprayag</option>
                                    <option value="Tehri Garhwal">Tehri Garhwal</option>
                                    <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                    <option value="Uttarkashi">Uttarkashi</option>

                                    <option value="other">Other (Please specify)</option>
                                </select>
                                <input type="text" id="firstAuditCertificateOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="firstAuditCertificateState">State*</label>
                            <div class="combo-input">
                                <select id="firstAuditCertificateState" name="state" required onchange="toggleOtherInput('firstAuditCertificateState', 'firstAuditCertificateOtherState')">
                                    <option value="">Select State</option>
                                    <option value="Andhra Pradesh">Andhra Pradesh</option>
                                    <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                    <option value="Assam">Assam</option>
                                    <option value="Bihar">Bihar</option>
                                    <option value="Chhattisgarh">Chhattisgarh</option>
                                    <option value="Goa">Goa</option>
                                    <option value="Gujarat">Gujarat</option>
                                    <option value="Haryana">Haryana</option>
                                    <option value="Himachal Pradesh">Himachal Pradesh</option>
                                    <option value="Jharkhand">Jharkhand</option>
                                    <option value="Karnataka">Karnataka</option>
                                    <option value="Kerala">Kerala</option>
                                    <option value="Madhya Pradesh">Madhya Pradesh</option>
                                    <option value="Maharashtra">Maharashtra</option>
                                    <option value="Manipur">Manipur</option>
                                    <option value="Meghalaya">Meghalaya</option>
                                    <option value="Mizoram">Mizoram</option>
                                    <option value="Nagaland">Nagaland</option>
                                    <option value="Odisha">Odisha</option>
                                    <option value="Punjab">Punjab</option>
                                    <option value="Rajasthan">Rajasthan</option>
                                    <option value="Sikkim">Sikkim</option>
                                    <option value="Tamil Nadu">Tamil Nadu</option>
                                    <option value="Telangana">Telangana</option>
                                    <option value="Tripura">Tripura</option>
                                    <option value="Uttar Pradesh">Uttar Pradesh</option>
                                    <option value="Uttarakhand">Uttarakhand</option>
                                    <option value="West Bengal">West Bengal</option>

                                    <!-- Union Territories -->
                                    <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                    <option value="Chandigarh">Chandigarh</option>
                                    <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                    <option value="Delhi">Delhi</option>
                                    <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                    <option value="Ladakh">Ladakh</option>
                                    <option value="Lakshadweep">Lakshadweep</option>
                                    <option value="Puducherry">Puducherry</option>

                                </select>
                                <input type="text" id="firstAuditCertificateOtherState" name="otherState" class="hidden" placeholder="Enter State Name">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="firstAuditCertificateAuditeeDesignation">Designation of the Auditee Person (Submitted To)*</label>
                            <input type="text" id="firstAuditCertificateAuditeeDesignation" name="auditeeDesignation" required placeholder="Enter auditee designation">
                        </div>

                        <div class="form-group">
                            <label for="firstAuditCertificateScope">Scope*</label>
                            <input type="text" id="firstAuditCertificateScope" name="scope" required placeholder="Enter scope details">
                        </div>

                        <div class="form-group">
                            <label for="firstAuditCertificateStartAuditDate">Start Audit Date*</label>
                            <input type="date" id="firstAuditCertificateStartAuditDate" name="startAuditDate" required>
                        </div>

                        <div class="form-group">
                            <label for="firstAuditCertificateEndAuditDate">End Audit Date*</label>
                            <input type="date" id="firstAuditCertificateEndAuditDate" name="endAuditDate" required>
                        </div>

                        <div class="form-group">
                            <label for="firstAuditCertificateReportId">Report ID*</label>
                            <input type="text" id="firstAuditCertificateReportId" name="reportId" required placeholder="Enter report ID">
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('firstAuditCertificateModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Certificate</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Follow Up Audit Conducted Certificate Modal -->
        <div id="followUpAuditCertificateModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Follow Up Audit Conducted Certificate</h3>
                    <span class="close-modal" onclick="closeModal('followUpAuditCertificateModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="followUpAuditCertificateForm" action="/process_follow_up_audit_certificate" method="POST">
                        <div class="form-group">
                            <label for="followUpOrganizationName">Organization Name*</label>
                            <div class="combo-input">
                                <select id="followUpOrganizationName" name="organizationName" required onchange="toggleOtherInput('followUpOrganizationName', 'followUpOtherOrganizationName')">
                                    <option value="">Select Organization</option>
                                    <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                    <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                    <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                    <option value="Megasoft Limited">Megasoft Limited</option>
                                    <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                    <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                    <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                    <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                    <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                    <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                    <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                    <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                    <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                    <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                    <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                    <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                    <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                    <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                    <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                    <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                    <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                    <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                    <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                    <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                    <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                    <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                    <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                    <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                    <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                    <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                    <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                    <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                    <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                    <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                    <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                    <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                    <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                    <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                    <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                    <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                    
                                    <option value="other">Other (Please specify)</option>
                                </select>
                                <input type="text" id="followUpOtherOrganizationName" name="otherOrganizationName" class="hidden" placeholder="Enter Organization Name">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="followUpAuditCertificateCity">City*</label>
                            <div class="combo-input">
                                <select id="followUpAuditCertificateCity" name="city" required onchange="toggleOtherInput('followUpAuditCertificateCity', 'followUpAuditCertificateOtherCity')">
                                    <option value="">Select City</option>
                                    <!-- Gujarat -->
                                    <option value="Ahmedabad">Ahmedabad</option>
                                    <option value="Amreli">Amreli</option>
                                    <option value="Anand">Anand</option>
                                    <option value="Aravalli">Aravalli</option>
                                    <option value="Banaskantha">Banaskantha</option>
                                    <option value="Bharuch">Bharuch</option>
                                    <option value="Bhavnagar">Bhavnagar</option>
                                    <option value="Botad">Botad</option>
                                    <option value="Chhota Udaipur">Chhota Udaipur</option>
                                    <option value="Dahod">Dahod</option>
                                    <option value="Dang">Dang</option>
                                    <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                    <option value="Gandhinagar">Gandhinagar</option>
                                    <option value="Gir Somnath">Gir Somnath</option>
                                    <option value="Jamnagar">Jamnagar</option>
                                    <option value="Junagadh">Junagadh</option>
                                    <option value="Kheda">Kheda</option>
                                    <option value="Kutch">Kutch</option>
                                    <option value="Mahisagar">Mahisagar</option>
                                    <option value="Mehsana">Mehsana</option>
                                    <option value="Morbi">Morbi</option>
                                    <option value="Narmada">Narmada</option>
                                    <option value="Navsari">Navsari</option>
                                    <option value="Patan">Patan</option>
                                    <option value="Panchmahal">Panchmahal</option>
                                    <option value="Porbandar">Porbandar</option>
                                    <option value="Rajkot">Rajkot</option>
                                    <option value="Sabarkantha">Sabarkantha</option>
                                    <option value="Surat">Surat</option>
                                    <option value="Surendranagar">Surendranagar</option>
                                    <option value="Tapi">Tapi</option>
                                    <option value="Vadodara">Vadodara</option>
                                    <option value="Valsad">Valsad</option>

                                    <!-- Rajasthan -->
                                    <option value="Ajmer">Ajmer</option>
                                    <option value="Alwar">Alwar</option>
                                    <option value="Banswara">Banswara</option>
                                    <option value="Baran">Baran</option>
                                    <option value="Barmer">Barmer</option>
                                    <option value="Bharatpur">Bharatpur</option>
                                    <option value="Bhilwara">Bhilwara</option>
                                    <option value="Bikaner">Bikaner</option>
                                    <option value="Bundi">Bundi</option>
                                    <option value="Chittorgarh">Chittorgarh</option>
                                    <option value="Churu">Churu</option>
                                    <option value="Dausa">Dausa</option>
                                    <option value="Dholpur">Dholpur</option>
                                    <option value="Dungarpur">Dungarpur</option>
                                    <option value="Hanumangarh">Hanumangarh</option>
                                    <option value="Jaipur">Jaipur</option>
                                    <option value="Jaisalmer">Jaisalmer</option>
                                    <option value="Jalore">Jalore</option>
                                    <option value="Jhalawar">Jhalawar</option>
                                    <option value="Jhunjhunu">Jhunjhunu</option>
                                    <option value="Jodhpur">Jodhpur</option>
                                    <option value="Karauli">Karauli</option>
                                    <option value="Kota">Kota</option>
                                    <option value="Nagaur">Nagaur</option>
                                    <option value="Pali">Pali</option>
                                    <option value="Pratapgarh">Pratapgarh</option>
                                    <option value="Rajsamand">Rajsamand</option>
                                    <option value="Sikar">Sikar</option>
                                    <option value="Sirohi">Sirohi</option>
                                    <option value="Sri Ganganagar">Sri Ganganagar</option>
                                    <option value="Tonk">Tonk</option>
                                    <option value="Udaipur">Udaipur</option>

                                    <!-- Maharashtra -->
                                    <option value="Ahmednagar">Ahmednagar</option>
                                    <option value="Akola">Akola</option>
                                    <option value="Amravati">Amravati</option>
                                    <option value="Aurangabad">Aurangabad</option>
                                    <option value="Beed">Beed</option>
                                    <option value="Bhandara">Bhandara</option>
                                    <option value="Chandrapur">Chandrapur</option>
                                    <option value="Dhule">Dhule</option>
                                    <option value="Gadchiroli">Gadchiroli</option>
                                    <option value="Gondia">Gondia</option>
                                    <option value="Hingoli">Hingoli</option>
                                    <option value="Jalgaon">Jalgaon</option>
                                    <option value="Jalna">Jalna</option>
                                    <option value="Kolhapur">Kolhapur</option>
                                    <option value="Latur">Latur</option>
                                    <option value="Mumbai City">Mumbai City</option>
                                    <option value="Mumbai Suburban">Mumbai Suburban</option>
                                    <option value="Nagpur">Nagpur</option>
                                    <option value="Nanded">Nanded</option>
                                    <option value="Nandurbar">Nandurbar</option>
                                    <option value="Nashik">Nashik</option>
                                    <option value="Osmanabad">Osmanabad</option>
                                    <option value="Palghar">Palghar</option>
                                    <option value="Parbhani">Parbhani</option>
                                    <option value="Pune">Pune</option>
                                    <option value="Raigad">Raigad</option>
                                    <option value="Ratnagiri">Ratnagiri</option>
                                    <option value="Sangli">Sangli</option>
                                    <option value="Satara">Satara</option>
                                    <option value="Sindhudurg">Sindhudurg</option>
                                    <option value="Solapur">Solapur</option>
                                    <option value="Thane">Thane</option>
                                    <option value="Wardha">Wardha</option>
                                    <option value="Washim">Washim</option>
                                    <option value="Yavatmal">Yavatmal</option>

                                    <!-- Uttar Pradesh -->
                                    <option value="Agra">Agra</option>
                                    <option value="Aligarh">Aligarh</option>
                                    <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                    <option value="Amethi">Amethi</option>
                                    <option value="Amroha">Amroha</option>
                                    <option value="Auraiya">Auraiya</option>
                                    <option value="Ayodhya">Ayodhya</option>
                                    <option value="Azamgarh">Azamgarh</option>
                                    <option value="Bagpat">Bagpat</option>
                                    <option value="Bahraich">Bahraich</option>
                                    <option value="Ballia">Ballia</option>
                                    <option value="Balrampur">Balrampur</option>
                                    <option value="Banda">Banda</option>
                                    <option value="Barabanki">Barabanki</option>
                                    <option value="Bareilly">Bareilly</option>
                                    <option value="Basti">Basti</option>
                                    <option value="Bhadohi">Bhadohi</option>
                                    <option value="Bijnor">Bijnor</option>
                                    <option value="Bulandshahr">Bulandshahr</option>
                                    <option value="Chandauli">Chandauli</option>
                                    <option value="Chitrakoot">Chitrakoot</option>
                                    <option value="Deoria">Deoria</option>
                                    <option value="Etah">Etah</option>
                                    <option value="Etawah">Etawah</option>
                                    <option value="Farrukhabad">Farrukhabad</option>
                                    <option value="Fatehpur">Fatehpur</option>
                                    <option value="Firozabad">Firozabad</option>
                                    <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                    <option value="Ghaziabad">Ghaziabad</option>
                                    <option value="Ghazipur">Ghazipur</option>
                                    <option value="Gonda">Gonda</option>
                                    <option value="Gorakhpur">Gorakhpur</option>
                                    <option value="Hamirpur">Hamirpur</option>
                                    <option value="Hapur">Hapur</option>
                                    <option value="Hardoi">Hardoi</option>
                                    <option value="Hathras">Hathras</option>
                                    <option value="Jalaun">Jalaun</option>
                                    <option value="Jaunpur">Jaunpur</option>
                                    <option value="Jhansi">Jhansi</option>
                                    <option value="Kannauj">Kannauj</option>
                                    <option value="Kanpur Dehat">Kanpur Dehat</option>
                                    <option value="Kanpur Nagar">Kanpur Nagar</option>
                                    <option value="Kasganj">Kasganj</option>
                                    <option value="Kaushambi">Kaushambi</option>
                                    <option value="Kushinagar">Kushinagar</option>
                                    <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                    <option value="Lalitpur">Lalitpur</option>
                                    <option value="Lucknow">Lucknow</option>
                                    <option value="Maharajganj">Maharajganj</option>
                                    <option value="Mahoba">Mahoba</option>
                                    <option value="Mainpuri">Mainpuri</option>
                                    <option value="Mathura">Mathura</option>
                                    <option value="Mau">Mau</option>
                                    <option value="Meerut">Meerut</option>
                                    <option value="Mirzapur">Mirzapur</option>
                                    <option value="Moradabad">Moradabad</option>
                                    <option value="Muzaffarnagar">Muzaffarnagar</option>
                                    <option value="Pilibhit">Pilibhit</option>
                                    <option value="Pratapgarh">Pratapgarh</option>
                                    <option value="Rae Bareli">Rae Bareli</option>
                                    <option value="Rampur">Rampur</option>
                                    <option value="Saharanpur">Saharanpur</option>
                                    <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                    <option value="Shahjahanpur">Shahjahanpur</option>
                                    <option value="Shravasti">Shravasti</option>
                                    <option value="Siddharthnagar">Siddharthnagar</option>
                                    <option value="Sitapur">Sitapur</option>
                                    <option value="Sonbhadra">Sonbhadra</option>
                                    <option value="Sultanpur">Sultanpur</option>
                                    <option value="Unnao">Unnao</option>
                                    <option value="Varanasi">Varanasi</option>

                                    <!-- Uttarakhand -->
                                    <option value="Almora">Almora</option>
                                    <option value="Bageshwar">Bageshwar</option>
                                    <option value="Chamoli">Chamoli</option>
                                    <option value="Champawat">Champawat</option>
                                    <option value="Dehradun">Dehradun</option>
                                    <option value="Haridwar">Haridwar</option>
                                    <option value="Nainital">Nainital</option>
                                    <option value="Pauri Garhwal">Pauri Garhwal</option>
                                    <option value="Pithoragarh">Pithoragarh</option>
                                    <option value="Rudraprayag">Rudraprayag</option>
                                    <option value="Tehri Garhwal">Tehri Garhwal</option>
                                    <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                    <option value="Uttarkashi">Uttarkashi</option>

                                    <option value="other">Other (Please specify)</option>
                                </select>
                                <input type="text" id="followUpAuditCertificateOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="followUpAuditCertificateState">State*</label>
                            <div class="combo-input">
                                <select id="followUpAuditCertificateState" name="state" required onchange="toggleOtherInput('followUpAuditCertificateState', 'followUpAuditCertificateOtherState')">
                                    <option value="">Select State</option>
                                    <option value="Andhra Pradesh">Andhra Pradesh</option>
                                    <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                    <option value="Assam">Assam</option>
                                    <option value="Bihar">Bihar</option>
                                    <option value="Chhattisgarh">Chhattisgarh</option>
                                    <option value="Goa">Goa</option>
                                    <option value="Gujarat">Gujarat</option>
                                    <option value="Haryana">Haryana</option>
                                    <option value="Himachal Pradesh">Himachal Pradesh</option>
                                    <option value="Jharkhand">Jharkhand</option>
                                    <option value="Karnataka">Karnataka</option>
                                    <option value="Kerala">Kerala</option>
                                    <option value="Madhya Pradesh">Madhya Pradesh</option>
                                    <option value="Maharashtra">Maharashtra</option>
                                    <option value="Manipur">Manipur</option>
                                    <option value="Meghalaya">Meghalaya</option>
                                    <option value="Mizoram">Mizoram</option>
                                    <option value="Nagaland">Nagaland</option>
                                    <option value="Odisha">Odisha</option>
                                    <option value="Punjab">Punjab</option>
                                    <option value="Rajasthan">Rajasthan</option>
                                    <option value="Sikkim">Sikkim</option>
                                    <option value="Tamil Nadu">Tamil Nadu</option>
                                    <option value="Telangana">Telangana</option>
                                    <option value="Tripura">Tripura</option>
                                    <option value="Uttar Pradesh">Uttar Pradesh</option>
                                    <option value="Uttarakhand">Uttarakhand</option>
                                    <option value="West Bengal">West Bengal</option>

                                    <!-- Union Territories -->
                                    <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                    <option value="Chandigarh">Chandigarh</option>
                                    <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                    <option value="Delhi">Delhi</option>
                                    <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                    <option value="Ladakh">Ladakh</option>
                                    <option value="Lakshadweep">Lakshadweep</option>
                                    <option value="Puducherry">Puducherry</option>

                                </select>
                                <input type="text" id="followUpAuditCertificateOtherState" name="otherState" class="hidden" placeholder="Enter State Name">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="followUpAuditCertificateAuditeeDesignation">Designation of the Auditee Person (Submitted To)*</label>
                            <input type="text" id="followUpAuditCertificateAuditeeDesignation" name="auditeeDesignation" required placeholder="Enter auditee designation">
                        </div>

                        <div class="form-group">
                            <label for="followUpAuditCertificateScope">Scope*</label>
                            <input type="text" id="followUpAuditCertificateScope" name="scope" required placeholder="Enter scope details">
                        </div>

                        <div class="form-group">
                            <label for="followUpAuditCertificateStartAuditDate">Start Audit Date*</label>
                            <input type="date" id="followUpAuditCertificateStartAuditDate" name="startAuditDate" required>
                        </div>

                        <div class="form-group">
                            <label for="followUpAuditCertificateEndAuditDate">End Audit Date*</label>
                            <input type="date" id="followUpAuditCertificateEndAuditDate" name="endAuditDate" required>
                        </div>

                        <div class="form-group">
                            <label for="followUpAuditCertificateReportId">Report ID*</label>
                            <input type="text" id="followUpAuditCertificateReportId" name="reportId" required placeholder="Enter report ID">
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('followUpAuditCertificateModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Certificate</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- IS Audit Conducted Certificate Modal -->
        <div id="isAuditCertificateModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>IS Audit Conducted Certificate</h3>
                    <span class="close-modal" onclick="closeModal('isAuditCertificateModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="isAuditCertificateForm" action="/process_is_audit_certificate" method="POST">
                        <div class="form-group">
                            <label for="isAuditCertificateOrganizationName">Organization Name*</label>
                            <div class="combo-input">
                                <select id="isAuditCertificateOrganizationName" name="organizationName" required onchange="toggleOtherInput('isAuditCertificateOrganizationName', 'isAuditCertificateOtherOrganizationName')">
                                    <option value="">Select Organization</option>
                                    <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                    <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                    <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                    <option value="Megasoft Limited">Megasoft Limited</option>
                                    <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                    <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                    <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                    <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                    <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                    <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                    <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                    <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                    <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                    <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                    <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                    <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                    <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                    <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                    <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                    <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                    <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                    <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                    <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                    <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                    <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                    <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                    <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                    <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                    <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                    <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                    <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                    <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                    <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                    <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                    <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                    <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                    <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                    <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                    <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                    <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                    
                                    <option value="other">Other (Please specify)</option>
                                </select>
                                <input type="text" id="isAuditCertificateOtherOrganizationName" name="otherOrganizationName" class="hidden" placeholder="Enter Organization Name">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="isAuditCertificateCity">City*</label>
                            <div class="combo-input">
                                <select id="isAuditCertificateCity" name="city" required onchange="toggleOtherInput('isAuditCertificateCity', 'isAuditCertificateOtherCity')">
                                    <option value="">Select City</option>
                                    <!-- Gujarat -->
                                    <option value="Ahmedabad">Ahmedabad</option>
                                    <option value="Amreli">Amreli</option>
                                    <option value="Anand">Anand</option>
                                    <option value="Aravalli">Aravalli</option>
                                    <option value="Banaskantha">Banaskantha</option>
                                    <option value="Bharuch">Bharuch</option>
                                    <option value="Bhavnagar">Bhavnagar</option>
                                    <option value="Botad">Botad</option>
                                    <option value="Chhota Udaipur">Chhota Udaipur</option>
                                    <option value="Dahod">Dahod</option>
                                    <option value="Dang">Dang</option>
                                    <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                    <option value="Gandhinagar">Gandhinagar</option>
                                    <option value="Gir Somnath">Gir Somnath</option>
                                    <option value="Jamnagar">Jamnagar</option>
                                    <option value="Junagadh">Junagadh</option>
                                    <option value="Kheda">Kheda</option>
                                    <option value="Kutch">Kutch</option>
                                    <option value="Mahisagar">Mahisagar</option>
                                    <option value="Mehsana">Mehsana</option>
                                    <option value="Morbi">Morbi</option>
                                    <option value="Narmada">Narmada</option>
                                    <option value="Navsari">Navsari</option>
                                    <option value="Patan">Patan</option>
                                    <option value="Panchmahal">Panchmahal</option>
                                    <option value="Porbandar">Porbandar</option>
                                    <option value="Rajkot">Rajkot</option>
                                    <option value="Sabarkantha">Sabarkantha</option>
                                    <option value="Surat">Surat</option>
                                    <option value="Surendranagar">Surendranagar</option>
                                    <option value="Tapi">Tapi</option>
                                    <option value="Vadodara">Vadodara</option>
                                    <option value="Valsad">Valsad</option>

                                    <!-- Rajasthan -->
                                    <option value="Ajmer">Ajmer</option>
                                    <option value="Alwar">Alwar</option>
                                    <option value="Banswara">Banswara</option>
                                    <option value="Baran">Baran</option>
                                    <option value="Barmer">Barmer</option>
                                    <option value="Bharatpur">Bharatpur</option>
                                    <option value="Bhilwara">Bhilwara</option>
                                    <option value="Bikaner">Bikaner</option>
                                    <option value="Bundi">Bundi</option>
                                    <option value="Chittorgarh">Chittorgarh</option>
                                    <option value="Churu">Churu</option>
                                    <option value="Dausa">Dausa</option>
                                    <option value="Dholpur">Dholpur</option>
                                    <option value="Dungarpur">Dungarpur</option>
                                    <option value="Hanumangarh">Hanumangarh</option>
                                    <option value="Jaipur">Jaipur</option>
                                    <option value="Jaisalmer">Jaisalmer</option>
                                    <option value="Jalore">Jalore</option>
                                    <option value="Jhalawar">Jhalawar</option>
                                    <option value="Jhunjhunu">Jhunjhunu</option>
                                    <option value="Jodhpur">Jodhpur</option>
                                    <option value="Karauli">Karauli</option>
                                    <option value="Kota">Kota</option>
                                    <option value="Nagaur">Nagaur</option>
                                    <option value="Pali">Pali</option>
                                    <option value="Pratapgarh">Pratapgarh</option>
                                    <option value="Rajsamand">Rajsamand</option>
                                    <option value="Sikar">Sikar</option>
                                    <option value="Sirohi">Sirohi</option>
                                    <option value="Sri Ganganagar">Sri Ganganagar</option>
                                    <option value="Tonk">Tonk</option>
                                    <option value="Udaipur">Udaipur</option>

                                    <!-- Maharashtra -->
                                    <option value="Ahmednagar">Ahmednagar</option>
                                    <option value="Akola">Akola</option>
                                    <option value="Amravati">Amravati</option>
                                    <option value="Aurangabad">Aurangabad</option>
                                    <option value="Beed">Beed</option>
                                    <option value="Bhandara">Bhandara</option>
                                    <option value="Chandrapur">Chandrapur</option>
                                    <option value="Dhule">Dhule</option>
                                    <option value="Gadchiroli">Gadchiroli</option>
                                    <option value="Gondia">Gondia</option>
                                    <option value="Hingoli">Hingoli</option>
                                    <option value="Jalgaon">Jalgaon</option>
                                    <option value="Jalna">Jalna</option>
                                    <option value="Kolhapur">Kolhapur</option>
                                    <option value="Latur">Latur</option>
                                    <option value="Mumbai City">Mumbai City</option>
                                    <option value="Mumbai Suburban">Mumbai Suburban</option>
                                    <option value="Nagpur">Nagpur</option>
                                    <option value="Nanded">Nanded</option>
                                    <option value="Nandurbar">Nandurbar</option>
                                    <option value="Nashik">Nashik</option>
                                    <option value="Osmanabad">Osmanabad</option>
                                    <option value="Palghar">Palghar</option>
                                    <option value="Parbhani">Parbhani</option>
                                    <option value="Pune">Pune</option>
                                    <option value="Raigad">Raigad</option>
                                    <option value="Ratnagiri">Ratnagiri</option>
                                    <option value="Sangli">Sangli</option>
                                    <option value="Satara">Satara</option>
                                    <option value="Sindhudurg">Sindhudurg</option>
                                    <option value="Solapur">Solapur</option>
                                    <option value="Thane">Thane</option>
                                    <option value="Wardha">Wardha</option>
                                    <option value="Washim">Washim</option>
                                    <option value="Yavatmal">Yavatmal</option>

                                    <!-- Uttar Pradesh -->
                                    <option value="Agra">Agra</option>
                                    <option value="Aligarh">Aligarh</option>
                                    <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                    <option value="Amethi">Amethi</option>
                                    <option value="Amroha">Amroha</option>
                                    <option value="Auraiya">Auraiya</option>
                                    <option value="Ayodhya">Ayodhya</option>
                                    <option value="Azamgarh">Azamgarh</option>
                                    <option value="Bagpat">Bagpat</option>
                                    <option value="Bahraich">Bahraich</option>
                                    <option value="Ballia">Ballia</option>
                                    <option value="Balrampur">Balrampur</option>
                                    <option value="Banda">Banda</option>
                                    <option value="Barabanki">Barabanki</option>
                                    <option value="Bareilly">Bareilly</option>
                                    <option value="Basti">Basti</option>
                                    <option value="Bhadohi">Bhadohi</option>
                                    <option value="Bijnor">Bijnor</option>
                                    <option value="Bulandshahr">Bulandshahr</option>
                                    <option value="Chandauli">Chandauli</option>
                                    <option value="Chitrakoot">Chitrakoot</option>
                                    <option value="Deoria">Deoria</option>
                                    <option value="Etah">Etah</option>
                                    <option value="Etawah">Etawah</option>
                                    <option value="Farrukhabad">Farrukhabad</option>
                                    <option value="Fatehpur">Fatehpur</option>
                                    <option value="Firozabad">Firozabad</option>
                                    <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                    <option value="Ghaziabad">Ghaziabad</option>
                                    <option value="Ghazipur">Ghazipur</option>
                                    <option value="Gonda">Gonda</option>
                                    <option value="Gorakhpur">Gorakhpur</option>
                                    <option value="Hamirpur">Hamirpur</option>
                                    <option value="Hapur">Hapur</option>
                                    <option value="Hardoi">Hardoi</option>
                                    <option value="Hathras">Hathras</option>
                                    <option value="Jalaun">Jalaun</option>
                                    <option value="Jaunpur">Jaunpur</option>
                                    <option value="Jhansi">Jhansi</option>
                                    <option value="Kannauj">Kannauj</option>
                                    <option value="Kanpur Dehat">Kanpur Dehat</option>
                                    <option value="Kanpur Nagar">Kanpur Nagar</option>
                                    <option value="Kasganj">Kasganj</option>
                                    <option value="Kaushambi">Kaushambi</option>
                                    <option value="Kushinagar">Kushinagar</option>
                                    <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                    <option value="Lalitpur">Lalitpur</option>
                                    <option value="Lucknow">Lucknow</option>
                                    <option value="Maharajganj">Maharajganj</option>
                                    <option value="Mahoba">Mahoba</option>
                                    <option value="Mainpuri">Mainpuri</option>
                                    <option value="Mathura">Mathura</option>
                                    <option value="Mau">Mau</option>
                                    <option value="Meerut">Meerut</option>
                                    <option value="Mirzapur">Mirzapur</option>
                                    <option value="Moradabad">Moradabad</option>
                                    <option value="Muzaffarnagar">Muzaffarnagar</option>
                                    <option value="Pilibhit">Pilibhit</option>
                                    <option value="Pratapgarh">Pratapgarh</option>
                                    <option value="Rae Bareli">Rae Bareli</option>
                                    <option value="Rampur">Rampur</option>
                                    <option value="Saharanpur">Saharanpur</option>
                                    <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                    <option value="Shahjahanpur">Shahjahanpur</option>
                                    <option value="Shravasti">Shravasti</option>
                                    <option value="Siddharthnagar">Siddharthnagar</option>
                                    <option value="Sitapur">Sitapur</option>
                                    <option value="Sonbhadra">Sonbhadra</option>
                                    <option value="Sultanpur">Sultanpur</option>
                                    <option value="Unnao">Unnao</option>
                                    <option value="Varanasi">Varanasi</option>

                                    <!-- Uttarakhand -->
                                    <option value="Almora">Almora</option>
                                    <option value="Bageshwar">Bageshwar</option>
                                    <option value="Chamoli">Chamoli</option>
                                    <option value="Champawat">Champawat</option>
                                    <option value="Dehradun">Dehradun</option>
                                    <option value="Haridwar">Haridwar</option>
                                    <option value="Nainital">Nainital</option>
                                    <option value="Pauri Garhwal">Pauri Garhwal</option>
                                    <option value="Pithoragarh">Pithoragarh</option>
                                    <option value="Rudraprayag">Rudraprayag</option>
                                    <option value="Tehri Garhwal">Tehri Garhwal</option>
                                    <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                    <option value="Uttarkashi">Uttarkashi</option>

                                    <option value="other">Other (Please specify)</option>
                                </select>
                                <input type="text" id="isAuditCertificateOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="isAuditCertificateState">State*</label>
                            <div class="combo-input">
                                <select id="isAuditCertificateState" name="state" required onchange="toggleOtherInput('isAuditCertificateState', 'isAuditCertificateOtherState')">
                                    <option value="">Select State</option>
                                    <option value="Andhra Pradesh">Andhra Pradesh</option>
                                    <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                    <option value="Assam">Assam</option>
                                    <option value="Bihar">Bihar</option>
                                    <option value="Chhattisgarh">Chhattisgarh</option>
                                    <option value="Goa">Goa</option>
                                    <option value="Gujarat">Gujarat</option>
                                    <option value="Haryana">Haryana</option>
                                    <option value="Himachal Pradesh">Himachal Pradesh</option>
                                    <option value="Jharkhand">Jharkhand</option>
                                    <option value="Karnataka">Karnataka</option>
                                    <option value="Kerala">Kerala</option>
                                    <option value="Madhya Pradesh">Madhya Pradesh</option>
                                    <option value="Maharashtra">Maharashtra</option>
                                    <option value="Manipur">Manipur</option>
                                    <option value="Meghalaya">Meghalaya</option>
                                    <option value="Mizoram">Mizoram</option>
                                    <option value="Nagaland">Nagaland</option>
                                    <option value="Odisha">Odisha</option>
                                    <option value="Punjab">Punjab</option>
                                    <option value="Rajasthan">Rajasthan</option>
                                    <option value="Sikkim">Sikkim</option>
                                    <option value="Tamil Nadu">Tamil Nadu</option>
                                    <option value="Telangana">Telangana</option>
                                    <option value="Tripura">Tripura</option>
                                    <option value="Uttar Pradesh">Uttar Pradesh</option>
                                    <option value="Uttarakhand">Uttarakhand</option>
                                    <option value="West Bengal">West Bengal</option>

                                    <!-- Union Territories -->
                                    <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                    <option value="Chandigarh">Chandigarh</option>
                                    <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                    <option value="Delhi">Delhi</option>
                                    <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                    <option value="Ladakh">Ladakh</option>
                                    <option value="Lakshadweep">Lakshadweep</option>
                                    <option value="Puducherry">Puducherry</option>

                                </select>
                                <input type="text" id="isAuditCertificateOtherState" name="otherState" class="hidden" placeholder="Enter State Name">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="isAuditCertificateAuditeeDesignation">Designation of the Auditee Person (Submitted To)*</label>
                            <input type="text" id="isAuditCertificateAuditeeDesignation" name="auditeeDesignation" required placeholder="Enter auditee designation">
                        </div>

                        <div class="form-group">
                            <label for="isAuditCertificateScope">Scope*</label>
                            <input type="text" id="isAuditCertificateScope" name="scope" required placeholder="Enter scope details">
                        </div>

                        <div class="form-group">
                            <label for="isAuditCertificateStartAuditDate">Start Audit Date*</label>
                            <input type="date" id="isAuditCertificateStartAuditDate" name="startAuditDate" required>
                        </div>

                        <div class="form-group">
                            <label for="isAuditCertificateEndAuditDate">End Audit Date*</label>
                            <input type="date" id="isAuditCertificateEndAuditDate" name="endAuditDate" required>
                        </div>

                        <div class="form-group">
                            <label for="isAuditCertificateReportId">Report ID*</label>
                            <input type="text" id="isAuditCertificateReportId" name="reportId" required placeholder="Enter report ID">
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('isAuditCertificateModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Certificate</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Cyber Security Audit Conducted Certificate Modal -->
        <div id="cyberSecurityAuditCertificateModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Cyber Security Audit Conducted Certificate</h3>
                    <span class="close-modal" onclick="closeModal('cyberSecurityAuditCertificateModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="cyberSecurityAuditCertificateForm" action="/process_cyber_security_audit_certificate" method="POST">
                        <div class="form-group">
                            <label for="cyberSecurityAuditCertificateOrganizationName">Organization Name*</label>
                            <div class="combo-input">
                                <select id="cyberSecurityAuditCertificateOrganizationName" name="organizationName" required onchange="toggleOtherInput('cyberSecurityAuditCertificateOrganizationName', 'cyberSecurityAuditCertificateOtherOrganizationName')">
                                    <option value="">Select Organization</option>
                                    <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                    <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                    <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                    <option value="Megasoft Limited">Megasoft Limited</option>
                                    <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                    <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                    <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                    <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                    <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                    <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                    <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                    <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                    <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                    <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                    <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                    <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                    <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                    <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                    <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                    <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                    <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                    <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                    <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                    <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                    <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                    <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                    <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                    <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                    <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                    <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                    <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                    <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                    <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                    <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                    <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                    <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                    <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                    <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                    <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                    <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                    
                                    <option value="other">Other (Please specify)</option>
                                </select>
                                <input type="text" id="cyberSecurityAuditCertificateOtherOrganizationName" name="otherOrganizationName" class="hidden" placeholder="Enter Organization Name">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="cyberSecurityAuditCertificateCity">City*</label>
                            <div class="combo-input">
                                <select id="cyberSecurityAuditCertificateCity" name="city" required onchange="toggleOtherInput('cyberSecurityAuditCertificateCity', 'cyberSecurityAuditCertificateOtherCity')">
                                    <option value="">Select City</option>
                                    <!-- Gujarat -->
                                    <option value="Ahmedabad">Ahmedabad</option>
                                    <option value="Amreli">Amreli</option>
                                    <option value="Anand">Anand</option>
                                    <option value="Aravalli">Aravalli</option>
                                    <option value="Banaskantha">Banaskantha</option>
                                    <option value="Bharuch">Bharuch</option>
                                    <option value="Bhavnagar">Bhavnagar</option>
                                    <option value="Botad">Botad</option>
                                    <option value="Chhota Udaipur">Chhota Udaipur</option>
                                    <option value="Dahod">Dahod</option>
                                    <option value="Dang">Dang</option>
                                    <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                    <option value="Gandhinagar">Gandhinagar</option>
                                    <option value="Gir Somnath">Gir Somnath</option>
                                    <option value="Jamnagar">Jamnagar</option>
                                    <option value="Junagadh">Junagadh</option>
                                    <option value="Kheda">Kheda</option>
                                    <option value="Kutch">Kutch</option>
                                    <option value="Mahisagar">Mahisagar</option>
                                    <option value="Mehsana">Mehsana</option>
                                    <option value="Morbi">Morbi</option>
                                    <option value="Narmada">Narmada</option>
                                    <option value="Navsari">Navsari</option>
                                    <option value="Patan">Patan</option>
                                    <option value="Panchmahal">Panchmahal</option>
                                    <option value="Porbandar">Porbandar</option>
                                    <option value="Rajkot">Rajkot</option>
                                    <option value="Sabarkantha">Sabarkantha</option>
                                    <option value="Surat">Surat</option>
                                    <option value="Surendranagar">Surendranagar</option>
                                    <option value="Tapi">Tapi</option>
                                    <option value="Vadodara">Vadodara</option>
                                    <option value="Valsad">Valsad</option>

                                    <!-- Rajasthan -->
                                    <option value="Ajmer">Ajmer</option>
                                    <option value="Alwar">Alwar</option>
                                    <option value="Banswara">Banswara</option>
                                    <option value="Baran">Baran</option>
                                    <option value="Barmer">Barmer</option>
                                    <option value="Bharatpur">Bharatpur</option>
                                    <option value="Bhilwara">Bhilwara</option>
                                    <option value="Bikaner">Bikaner</option>
                                    <option value="Bundi">Bundi</option>
                                    <option value="Chittorgarh">Chittorgarh</option>
                                    <option value="Churu">Churu</option>
                                    <option value="Dausa">Dausa</option>
                                    <option value="Dholpur">Dholpur</option>
                                    <option value="Dungarpur">Dungarpur</option>
                                    <option value="Hanumangarh">Hanumangarh</option>
                                    <option value="Jaipur">Jaipur</option>
                                    <option value="Jaisalmer">Jaisalmer</option>
                                    <option value="Jalore">Jalore</option>
                                    <option value="Jhalawar">Jhalawar</option>
                                    <option value="Jhunjhunu">Jhunjhunu</option>
                                    <option value="Jodhpur">Jodhpur</option>
                                    <option value="Karauli">Karauli</option>
                                    <option value="Kota">Kota</option>
                                    <option value="Nagaur">Nagaur</option>
                                    <option value="Pali">Pali</option>
                                    <option value="Pratapgarh">Pratapgarh</option>
                                    <option value="Rajsamand">Rajsamand</option>
                                    <option value="Sikar">Sikar</option>
                                    <option value="Sirohi">Sirohi</option>
                                    <option value="Sri Ganganagar">Sri Ganganagar</option>
                                    <option value="Tonk">Tonk</option>
                                    <option value="Udaipur">Udaipur</option>

                                    <!-- Maharashtra -->
                                    <option value="Ahmednagar">Ahmednagar</option>
                                    <option value="Akola">Akola</option>
                                    <option value="Amravati">Amravati</option>
                                    <option value="Aurangabad">Aurangabad</option>
                                    <option value="Beed">Beed</option>
                                    <option value="Bhandara">Bhandara</option>
                                    <option value="Chandrapur">Chandrapur</option>
                                    <option value="Dhule">Dhule</option>
                                    <option value="Gadchiroli">Gadchiroli</option>
                                    <option value="Gondia">Gondia</option>
                                    <option value="Hingoli">Hingoli</option>
                                    <option value="Jalgaon">Jalgaon</option>
                                    <option value="Jalna">Jalna</option>
                                    <option value="Kolhapur">Kolhapur</option>
                                    <option value="Latur">Latur</option>
                                    <option value="Mumbai City">Mumbai City</option>
                                    <option value="Mumbai Suburban">Mumbai Suburban</option>
                                    <option value="Nagpur">Nagpur</option>
                                    <option value="Nanded">Nanded</option>
                                    <option value="Nandurbar">Nandurbar</option>
                                    <option value="Nashik">Nashik</option>
                                    <option value="Osmanabad">Osmanabad</option>
                                    <option value="Palghar">Palghar</option>
                                    <option value="Parbhani">Parbhani</option>
                                    <option value="Pune">Pune</option>
                                    <option value="Raigad">Raigad</option>
                                    <option value="Ratnagiri">Ratnagiri</option>
                                    <option value="Sangli">Sangli</option>
                                    <option value="Satara">Satara</option>
                                    <option value="Sindhudurg">Sindhudurg</option>
                                    <option value="Solapur">Solapur</option>
                                    <option value="Thane">Thane</option>
                                    <option value="Wardha">Wardha</option>
                                    <option value="Washim">Washim</option>
                                    <option value="Yavatmal">Yavatmal</option>

                                    <!-- Uttar Pradesh -->
                                    <option value="Agra">Agra</option>
                                    <option value="Aligarh">Aligarh</option>
                                    <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                    <option value="Amethi">Amethi</option>
                                    <option value="Amroha">Amroha</option>
                                    <option value="Auraiya">Auraiya</option>
                                    <option value="Ayodhya">Ayodhya</option>
                                    <option value="Azamgarh">Azamgarh</option>
                                    <option value="Bagpat">Bagpat</option>
                                    <option value="Bahraich">Bahraich</option>
                                    <option value="Ballia">Ballia</option>
                                    <option value="Balrampur">Balrampur</option>
                                    <option value="Banda">Banda</option>
                                    <option value="Barabanki">Barabanki</option>
                                    <option value="Bareilly">Bareilly</option>
                                    <option value="Basti">Basti</option>
                                    <option value="Bhadohi">Bhadohi</option>
                                    <option value="Bijnor">Bijnor</option>
                                    <option value="Bulandshahr">Bulandshahr</option>
                                    <option value="Chandauli">Chandauli</option>
                                    <option value="Chitrakoot">Chitrakoot</option>
                                    <option value="Deoria">Deoria</option>
                                    <option value="Etah">Etah</option>
                                    <option value="Etawah">Etawah</option>
                                    <option value="Farrukhabad">Farrukhabad</option>
                                    <option value="Fatehpur">Fatehpur</option>
                                    <option value="Firozabad">Firozabad</option>
                                    <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                    <option value="Ghaziabad">Ghaziabad</option>
                                    <option value="Ghazipur">Ghazipur</option>
                                    <option value="Gonda">Gonda</option>
                                    <option value="Gorakhpur">Gorakhpur</option>
                                    <option value="Hamirpur">Hamirpur</option>
                                    <option value="Hapur">Hapur</option>
                                    <option value="Hardoi">Hardoi</option>
                                    <option value="Hathras">Hathras</option>
                                    <option value="Jalaun">Jalaun</option>
                                    <option value="Jaunpur">Jaunpur</option>
                                    <option value="Jhansi">Jhansi</option>
                                    <option value="Kannauj">Kannauj</option>
                                    <option value="Kanpur Dehat">Kanpur Dehat</option>
                                    <option value="Kanpur Nagar">Kanpur Nagar</option>
                                    <option value="Kasganj">Kasganj</option>
                                    <option value="Kaushambi">Kaushambi</option>
                                    <option value="Kushinagar">Kushinagar</option>
                                    <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                    <option value="Lalitpur">Lalitpur</option>
                                    <option value="Lucknow">Lucknow</option>
                                    <option value="Maharajganj">Maharajganj</option>
                                    <option value="Mahoba">Mahoba</option>
                                    <option value="Mainpuri">Mainpuri</option>
                                    <option value="Mathura">Mathura</option>
                                    <option value="Mau">Mau</option>
                                    <option value="Meerut">Meerut</option>
                                    <option value="Mirzapur">Mirzapur</option>
                                    <option value="Moradabad">Moradabad</option>
                                    <option value="Muzaffarnagar">Muzaffarnagar</option>
                                    <option value="Pilibhit">Pilibhit</option>
                                    <option value="Pratapgarh">Pratapgarh</option>
                                    <option value="Rae Bareli">Rae Bareli</option>
                                    <option value="Rampur">Rampur</option>
                                    <option value="Saharanpur">Saharanpur</option>
                                    <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                    <option value="Shahjahanpur">Shahjahanpur</option>
                                    <option value="Shravasti">Shravasti</option>
                                    <option value="Siddharthnagar">Siddharthnagar</option>
                                    <option value="Sitapur">Sitapur</option>
                                    <option value="Sonbhadra">Sonbhadra</option>
                                    <option value="Sultanpur">Sultanpur</option>
                                    <option value="Unnao">Unnao</option>
                                    <option value="Varanasi">Varanasi</option>

                                    <!-- Uttarakhand -->
                                    <option value="Almora">Almora</option>
                                    <option value="Bageshwar">Bageshwar</option>
                                    <option value="Chamoli">Chamoli</option>
                                    <option value="Champawat">Champawat</option>
                                    <option value="Dehradun">Dehradun</option>
                                    <option value="Haridwar">Haridwar</option>
                                    <option value="Nainital">Nainital</option>
                                    <option value="Pauri Garhwal">Pauri Garhwal</option>
                                    <option value="Pithoragarh">Pithoragarh</option>
                                    <option value="Rudraprayag">Rudraprayag</option>
                                    <option value="Tehri Garhwal">Tehri Garhwal</option>
                                    <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                    <option value="Uttarkashi">Uttarkashi</option>

                                    <option value="other">Other (Please specify)</option>
                                </select>
                                <input type="text" id="cyberSecurityAuditCertificateOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="cyberSecurityAuditCertificateState">State*</label>
                            <div class="combo-input">
                                <select id="cyberSecurityAuditCertificateState" name="state" required onchange="toggleOtherInput('cyberSecurityAuditCertificateState', 'cyberSecurityAuditCertificateOtherState')">
                                    <option value="">Select State</option>
                                    <option value="Andhra Pradesh">Andhra Pradesh</option>
                                    <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                    <option value="Assam">Assam</option>
                                    <option value="Bihar">Bihar</option>
                                    <option value="Chhattisgarh">Chhattisgarh</option>
                                    <option value="Goa">Goa</option>
                                    <option value="Gujarat">Gujarat</option>
                                    <option value="Haryana">Haryana</option>
                                    <option value="Himachal Pradesh">Himachal Pradesh</option>
                                    <option value="Jharkhand">Jharkhand</option>
                                    <option value="Karnataka">Karnataka</option>
                                    <option value="Kerala">Kerala</option>
                                    <option value="Madhya Pradesh">Madhya Pradesh</option>
                                    <option value="Maharashtra">Maharashtra</option>
                                    <option value="Manipur">Manipur</option>
                                    <option value="Meghalaya">Meghalaya</option>
                                    <option value="Mizoram">Mizoram</option>
                                    <option value="Nagaland">Nagaland</option>
                                    <option value="Odisha">Odisha</option>
                                    <option value="Punjab">Punjab</option>
                                    <option value="Rajasthan">Rajasthan</option>
                                    <option value="Sikkim">Sikkim</option>
                                    <option value="Tamil Nadu">Tamil Nadu</option>
                                    <option value="Telangana">Telangana</option>
                                    <option value="Tripura">Tripura</option>
                                    <option value="Uttar Pradesh">Uttar Pradesh</option>
                                    <option value="Uttarakhand">Uttarakhand</option>
                                    <option value="West Bengal">West Bengal</option>

                                    <!-- Union Territories -->
                                    <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                    <option value="Chandigarh">Chandigarh</option>
                                    <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                    <option value="Delhi">Delhi</option>
                                    <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                    <option value="Ladakh">Ladakh</option>
                                    <option value="Lakshadweep">Lakshadweep</option>
                                    <option value="Puducherry">Puducherry</option>

                                </select>
                                <input type="text" id="cyberSecurityAuditCertificateOtherState" name="otherState" class="hidden" placeholder="Enter State Name">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="cyberSecurityAuditCertificateAuditeeDesignation">Designation of the Auditee Person (Submitted To)*</label>
                            <input type="text" id="cyberSecurityAuditCertificateAuditeeDesignation" name="auditeeDesignation" required placeholder="Enter auditee designation">
                        </div>

                        <div class="form-group">
                            <label for="cyberSecurityAuditCertificateStartAuditDate">Start Audit Date*</label>
                            <input type="date" id="cyberSecurityAuditCertificateStartAuditDate" name="startAuditDate" required>
                        </div>

                        <div class="form-group">
                            <label for="cyberSecurityAuditCertificateEndAuditDate">End Audit Date*</label>
                            <input type="date" id="cyberSecurityAuditCertificateEndAuditDate" name="endAuditDate" required>
                        </div>

                        <div class="form-group">
                            <label for="cyberSecurityAuditCertificateReportId">Report ID*</label>
                            <input type="text" id="cyberSecurityAuditCertificateReportId" name="reportId" required placeholder="Enter report ID">
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('cyberSecurityAuditCertificateModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Certificate</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Gap Assessment Audit Conducted Certificate Modal -->
        <div id="gapAssessmentAuditCertificateModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Gap Assessment Audit Conducted Certificate</h3>
                    <span class="close-modal" onclick="closeModal('gapAssessmentAuditCertificateModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="gapAssessmentAuditCertificateForm" action="/process_gap_assessment_audit_certificate" method="POST">
                        <div class="form-group">
                            <label for="gapAssessmentAuditCertificateOrganizationName">Organization Name*</label>
                            <div class="combo-input">
                                <select id="gapAssessmentAuditCertificateOrganizationName" name="organizationName" required onchange="toggleOtherInput('gapAssessmentAuditCertificateOrganizationName', 'gapAssessmentAuditCertificateOtherOrganizationName')">
                                    <option value="">Select Organization</option>
                                    <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                                    <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                                    <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                                    <option value="Megasoft Limited">Megasoft Limited</option>
                                    <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                                    <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                                    <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                                    <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                                    <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                                    <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                                    <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                                    <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                                    <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                                    <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                                    <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                                    <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                                    <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                                    <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                                    <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                                    <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                                    <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                                    <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                                    <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                                    <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                                    <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                                    <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                                    <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                                    <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                                    <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                                    <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                                    <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                                    <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                                    <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                                    <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                                    <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                                    <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                                    <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                                    <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                                    <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                                    <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                                    
                                    <option value="other">Other (Please specify)</option>
                                </select>
                                <input type="text" id="gapAssessmentAuditCertificateOtherOrganizationName" name="otherOrganizationName" class="hidden" placeholder="Enter Organization Name">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="gapAssessmentAuditCertificateCity">City*</label>
                            <div class="combo-input">
                                <select id="gapAssessmentAuditCertificateCity" name="city" required onchange="toggleOtherInput('gapAssessmentAuditCertificateCity', 'gapAssessmentAuditCertificateOtherCity')">
                                    <option value="">Select City</option>
                                    <!-- Gujarat -->
                                    <option value="Ahmedabad">Ahmedabad</option>
                                    <option value="Amreli">Amreli</option>
                                    <option value="Anand">Anand</option>
                                    <option value="Aravalli">Aravalli</option>
                                    <option value="Banaskantha">Banaskantha</option>
                                    <option value="Bharuch">Bharuch</option>
                                    <option value="Bhavnagar">Bhavnagar</option>
                                    <option value="Botad">Botad</option>
                                    <option value="Chhota Udaipur">Chhota Udaipur</option>
                                    <option value="Dahod">Dahod</option>
                                    <option value="Dang">Dang</option>
                                    <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                                    <option value="Gandhinagar">Gandhinagar</option>
                                    <option value="Gir Somnath">Gir Somnath</option>
                                    <option value="Jamnagar">Jamnagar</option>
                                    <option value="Junagadh">Junagadh</option>
                                    <option value="Kheda">Kheda</option>
                                    <option value="Kutch">Kutch</option>
                                    <option value="Mahisagar">Mahisagar</option>
                                    <option value="Mehsana">Mehsana</option>
                                    <option value="Morbi">Morbi</option>
                                    <option value="Narmada">Narmada</option>
                                    <option value="Navsari">Navsari</option>
                                    <option value="Patan">Patan</option>
                                    <option value="Panchmahal">Panchmahal</option>
                                    <option value="Porbandar">Porbandar</option>
                                    <option value="Rajkot">Rajkot</option>
                                    <option value="Sabarkantha">Sabarkantha</option>
                                    <option value="Surat">Surat</option>
                                    <option value="Surendranagar">Surendranagar</option>
                                    <option value="Tapi">Tapi</option>
                                    <option value="Vadodara">Vadodara</option>
                                    <option value="Valsad">Valsad</option>

                                    <!-- Rajasthan -->
                                    <option value="Ajmer">Ajmer</option>
                                    <option value="Alwar">Alwar</option>
                                    <option value="Banswara">Banswara</option>
                                    <option value="Baran">Baran</option>
                                    <option value="Barmer">Barmer</option>
                                    <option value="Bharatpur">Bharatpur</option>
                                    <option value="Bhilwara">Bhilwara</option>
                                    <option value="Bikaner">Bikaner</option>
                                    <option value="Bundi">Bundi</option>
                                    <option value="Chittorgarh">Chittorgarh</option>
                                    <option value="Churu">Churu</option>
                                    <option value="Dausa">Dausa</option>
                                    <option value="Dholpur">Dholpur</option>
                                    <option value="Dungarpur">Dungarpur</option>
                                    <option value="Hanumangarh">Hanumangarh</option>
                                    <option value="Jaipur">Jaipur</option>
                                    <option value="Jaisalmer">Jaisalmer</option>
                                    <option value="Jalore">Jalore</option>
                                    <option value="Jhalawar">Jhalawar</option>
                                    <option value="Jhunjhunu">Jhunjhunu</option>
                                    <option value="Jodhpur">Jodhpur</option>
                                    <option value="Karauli">Karauli</option>
                                    <option value="Kota">Kota</option>
                                    <option value="Nagaur">Nagaur</option>
                                    <option value="Pali">Pali</option>
                                    <option value="Pratapgarh">Pratapgarh</option>
                                    <option value="Rajsamand">Rajsamand</option>
                                    <option value="Sikar">Sikar</option>
                                    <option value="Sirohi">Sirohi</option>
                                    <option value="Sri Ganganagar">Sri Ganganagar</option>
                                    <option value="Tonk">Tonk</option>
                                    <option value="Udaipur">Udaipur</option>

                                    <!-- Maharashtra -->
                                    <option value="Ahmednagar">Ahmednagar</option>
                                    <option value="Akola">Akola</option>
                                    <option value="Amravati">Amravati</option>
                                    <option value="Aurangabad">Aurangabad</option>
                                    <option value="Beed">Beed</option>
                                    <option value="Bhandara">Bhandara</option>
                                    <option value="Chandrapur">Chandrapur</option>
                                    <option value="Dhule">Dhule</option>
                                    <option value="Gadchiroli">Gadchiroli</option>
                                    <option value="Gondia">Gondia</option>
                                    <option value="Hingoli">Hingoli</option>
                                    <option value="Jalgaon">Jalgaon</option>
                                    <option value="Jalna">Jalna</option>
                                    <option value="Kolhapur">Kolhapur</option>
                                    <option value="Latur">Latur</option>
                                    <option value="Mumbai City">Mumbai City</option>
                                    <option value="Mumbai Suburban">Mumbai Suburban</option>
                                    <option value="Nagpur">Nagpur</option>
                                    <option value="Nanded">Nanded</option>
                                    <option value="Nandurbar">Nandurbar</option>
                                    <option value="Nashik">Nashik</option>
                                    <option value="Osmanabad">Osmanabad</option>
                                    <option value="Palghar">Palghar</option>
                                    <option value="Parbhani">Parbhani</option>
                                    <option value="Pune">Pune</option>
                                    <option value="Raigad">Raigad</option>
                                    <option value="Ratnagiri">Ratnagiri</option>
                                    <option value="Sangli">Sangli</option>
                                    <option value="Satara">Satara</option>
                                    <option value="Sindhudurg">Sindhudurg</option>
                                    <option value="Solapur">Solapur</option>
                                    <option value="Thane">Thane</option>
                                    <option value="Wardha">Wardha</option>
                                    <option value="Washim">Washim</option>
                                    <option value="Yavatmal">Yavatmal</option>

                                    <!-- Uttar Pradesh -->
                                    <option value="Agra">Agra</option>
                                    <option value="Aligarh">Aligarh</option>
                                    <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                                    <option value="Amethi">Amethi</option>
                                    <option value="Amroha">Amroha</option>
                                    <option value="Auraiya">Auraiya</option>
                                    <option value="Ayodhya">Ayodhya</option>
                                    <option value="Azamgarh">Azamgarh</option>
                                    <option value="Bagpat">Bagpat</option>
                                    <option value="Bahraich">Bahraich</option>
                                    <option value="Ballia">Ballia</option>
                                    <option value="Balrampur">Balrampur</option>
                                    <option value="Banda">Banda</option>
                                    <option value="Barabanki">Barabanki</option>
                                    <option value="Bareilly">Bareilly</option>
                                    <option value="Basti">Basti</option>
                                    <option value="Bhadohi">Bhadohi</option>
                                    <option value="Bijnor">Bijnor</option>
                                    <option value="Bulandshahr">Bulandshahr</option>
                                    <option value="Chandauli">Chandauli</option>
                                    <option value="Chitrakoot">Chitrakoot</option>
                                    <option value="Deoria">Deoria</option>
                                    <option value="Etah">Etah</option>
                                    <option value="Etawah">Etawah</option>
                                    <option value="Farrukhabad">Farrukhabad</option>
                                    <option value="Fatehpur">Fatehpur</option>
                                    <option value="Firozabad">Firozabad</option>
                                    <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                                    <option value="Ghaziabad">Ghaziabad</option>
                                    <option value="Ghazipur">Ghazipur</option>
                                    <option value="Gonda">Gonda</option>
                                    <option value="Gorakhpur">Gorakhpur</option>
                                    <option value="Hamirpur">Hamirpur</option>
                                    <option value="Hapur">Hapur</option>
                                    <option value="Hardoi">Hardoi</option>
                                    <option value="Hathras">Hathras</option>
                                    <option value="Jalaun">Jalaun</option>
                                    <option value="Jaunpur">Jaunpur</option>
                                    <option value="Jhansi">Jhansi</option>
                                    <option value="Kannauj">Kannauj</option>
                                    <option value="Kanpur Dehat">Kanpur Dehat</option>
                                    <option value="Kanpur Nagar">Kanpur Nagar</option>
                                    <option value="Kasganj">Kasganj</option>
                                    <option value="Kaushambi">Kaushambi</option>
                                    <option value="Kushinagar">Kushinagar</option>
                                    <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                                    <option value="Lalitpur">Lalitpur</option>
                                    <option value="Lucknow">Lucknow</option>
                                    <option value="Maharajganj">Maharajganj</option>
                                    <option value="Mahoba">Mahoba</option>
                                    <option value="Mainpuri">Mainpuri</option>
                                    <option value="Mathura">Mathura</option>
                                    <option value="Mau">Mau</option>
                                    <option value="Meerut">Meerut</option>
                                    <option value="Mirzapur">Mirzapur</option>
                                    <option value="Moradabad">Moradabad</option>
                                    <option value="Muzaffarnagar">Muzaffarnagar</option>
                                    <option value="Pilibhit">Pilibhit</option>
                                    <option value="Pratapgarh">Pratapgarh</option>
                                    <option value="Rae Bareli">Rae Bareli</option>
                                    <option value="Rampur">Rampur</option>
                                    <option value="Saharanpur">Saharanpur</option>
                                    <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                                    <option value="Shahjahanpur">Shahjahanpur</option>
                                    <option value="Shravasti">Shravasti</option>
                                    <option value="Siddharthnagar">Siddharthnagar</option>
                                    <option value="Sitapur">Sitapur</option>
                                    <option value="Sonbhadra">Sonbhadra</option>
                                    <option value="Sultanpur">Sultanpur</option>
                                    <option value="Unnao">Unnao</option>
                                    <option value="Varanasi">Varanasi</option>

                                    <!-- Uttarakhand -->
                                    <option value="Almora">Almora</option>
                                    <option value="Bageshwar">Bageshwar</option>
                                    <option value="Chamoli">Chamoli</option>
                                    <option value="Champawat">Champawat</option>
                                    <option value="Dehradun">Dehradun</option>
                                    <option value="Haridwar">Haridwar</option>
                                    <option value="Nainital">Nainital</option>
                                    <option value="Pauri Garhwal">Pauri Garhwal</option>
                                    <option value="Pithoragarh">Pithoragarh</option>
                                    <option value="Rudraprayag">Rudraprayag</option>
                                    <option value="Tehri Garhwal">Tehri Garhwal</option>
                                    <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                                    <option value="Uttarkashi">Uttarkashi</option>

                                    <option value="other">Other (Please specify)</option>
                                </select>
                                <input type="text" id="gapAssessmentAuditCertificateOtherCity" name="otherCity" class="hidden" placeholder="Enter City Name">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="gapAssessmentAuditCertificateState">State*</label>
                            <div class="combo-input">
                                <select id="gapAssessmentAuditCertificateState" name="state" required onchange="toggleOtherInput('gapAssessmentAuditCertificateState', 'gapAssessmentAuditCertificateOtherState')">
                                    <option value="">Select State</option>
                                    <option value="Andhra Pradesh">Andhra Pradesh</option>
                                    <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                    <option value="Assam">Assam</option>
                                    <option value="Bihar">Bihar</option>
                                    <option value="Chhattisgarh">Chhattisgarh</option>
                                    <option value="Goa">Goa</option>
                                    <option value="Gujarat">Gujarat</option>
                                    <option value="Haryana">Haryana</option>
                                    <option value="Himachal Pradesh">Himachal Pradesh</option>
                                    <option value="Jharkhand">Jharkhand</option>
                                    <option value="Karnataka">Karnataka</option>
                                    <option value="Kerala">Kerala</option>
                                    <option value="Madhya Pradesh">Madhya Pradesh</option>
                                    <option value="Maharashtra">Maharashtra</option>
                                    <option value="Manipur">Manipur</option>
                                    <option value="Meghalaya">Meghalaya</option>
                                    <option value="Mizoram">Mizoram</option>
                                    <option value="Nagaland">Nagaland</option>
                                    <option value="Odisha">Odisha</option>
                                    <option value="Punjab">Punjab</option>
                                    <option value="Rajasthan">Rajasthan</option>
                                    <option value="Sikkim">Sikkim</option>
                                    <option value="Tamil Nadu">Tamil Nadu</option>
                                    <option value="Telangana">Telangana</option>
                                    <option value="Tripura">Tripura</option>
                                    <option value="Uttar Pradesh">Uttar Pradesh</option>
                                    <option value="Uttarakhand">Uttarakhand</option>
                                    <option value="West Bengal">West Bengal</option>

                                    <!-- Union Territories -->
                                    <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                    <option value="Chandigarh">Chandigarh</option>
                                    <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                                    <option value="Delhi">Delhi</option>
                                    <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                    <option value="Ladakh">Ladakh</option>
                                    <option value="Lakshadweep">Lakshadweep</option>
                                    <option value="Puducherry">Puducherry</option>

                                </select>
                                <input type="text" id="gapAssessmentAuditCertificateOtherState" name="otherState" class="hidden" placeholder="Enter State Name">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="gapAssessmentAuditCertificateAuditeeDesignation">Designation of the Auditee Person (Submitted To)*</label>
                            <input type="text" id="gapAssessmentAuditCertificateAuditeeDesignation" name="auditeeDesignation" required placeholder="Enter auditee designation">
                        </div>

                        <div class="form-group">
                            <label for="gapAssessmentAuditCertificateStartAuditDate">Start Audit Date*</label>
                            <input type="date" id="gapAssessmentAuditCertificateStartAuditDate" name="startAuditDate" required>
                        </div>

                        <div class="form-group">
                            <label for="gapAssessmentAuditCertificateEndAuditDate">End Audit Date*</label>
                            <input type="date" id="gapAssessmentAuditCertificateEndAuditDate" name="endAuditDate" required>
                        </div>

                        <div class="form-group">
                            <label for="gapAssessmentAuditCertificateReportId">Report ID*</label>
                            <input type="text" id="gapAssessmentAuditCertificateReportId" name="reportId" required placeholder="Enter report ID">
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('gapAssessmentAuditCertificateModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Certificate</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Branch Excel Without POC Modal -->
        <div id="branchExcelWithoutPOCModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Branch Excel Without POC Details</h3>
                    <span class="close-modal" onclick="closeModal('branchExcelWithoutPOCModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="branchExcelWithoutPOCForm" action="/process_branch_excel_without_poc" method="POST" enctype="multipart/form-data">
                        <!-- Basic Information Section -->
                        <div class="form-group">
                            <label for="srNo">Sr.No*</label>
                            <input type="number" id="srNo" name="srNo" required placeholder="Enter Serial Number" min="0">
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="branchCode">Branch Code*</label>
                                <input type="text" id="branchCode" name="branchCode" required placeholder="Enter Branch Code">
                            </div>
                            <div class="form-group">
                                <label for="branchName">Branch Name*</label>
                                <input type="text" id="branchName" name="branchName" required placeholder="Enter Branch Name">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="dateOfVisit">Date of Visit*</label>
                                <input type="date" id="dateOfVisit" name="dateOfVisit" required>
                            </div>
                            <!-- Assisted By Section -->
                            <div class="form-group">
                                <label>Assisted By*</label>
                                <div class="combo-input">
                                    <select id="assistedByPrefix" name="assistedByPrefix" required>
                                        <option value="">Select</option>
                                        <option value="Mr.">Mr.</option>
                                        <option value="Ms.">Ms.</option>
                                        <option value="Mrs.">Mrs.</option>
                                        <option value="Dr.">Dr.</option>
                                    </select>
                                    <input type="text" id="assistedByName" name="assistedByName" required placeholder="Enter Name">
                                </div>
                            </div>
                        </div>

                        <!-- Auditor Name Section -->
                        <div class="form-group">
                            <label>Auditor Name* (At least 1 required)</label>
                            <div id="auditorContainer">
                                <div class="auditor-details" data-index="0">
                                    <div class="combo-input">
                                        <select id="auditorNamePrefix_0" name="auditorNamePrefix[]" required>
                                            <option value="">Select</option>
                                            <option value="Mr.">Mr.</option>
                                            <option value="Ms.">Ms.</option>
                                            <option value="Mrs.">Mrs.</option>
                                            <option value="Dr.">Dr.</option>
                                        </select>
                                        <input type="text" id="auditorName_0" name="auditorName[]" required placeholder="Enter Name">
                                    </div>
                                </div>
                            </div>
                            <button type="button" class="add-member-btn" id="addAuditorBtn">+ Add Auditor</button>
                        </div>

                        <!-- Systems Information Section -->
                        <div class="form-group">
                            <label>System Details* (At least 1 required)</label>
                            <div id="systemsContainer">
                                <div class="system-details" data-index="0">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="systemIp_0">System's IP Address*</label>
                                            <input type="text" id="systemIp_0" name="systemIp[]" required placeholder="Enter IP Address">
                                        </div>
                                        <div class="form-group">
                                            <label for="macAddress_0">MAC Address*</label>
                                            <input type="text" id="macAddress_0" name="macAddress[]" required placeholder="Enter MAC Address">
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="employeeName_0">Employee Name*</label>
                                            <input type="text" id="employeeName_0" name="employeeName[]" required placeholder="Enter Employee Name">
                                        </div>
                                        <div class="form-group">
                                            <label for="designation_0">Designation*</label>
                                            <input type="text" id="designation_0" name="designation[]" required placeholder="Enter Designation">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <button type="button" class="add-member-btn" id="addSystemBtn">+ Add More Systems</button>
                        </div>

                        <!-- ATM Details Section -->
                        <div class="form-group">
                            <label>ATM Details*</label>
                            <div class="radio-group">
                                <label><input type="radio" name="hasAtm" value="yes" required onchange="toggleAtmSection()"> Has ATM</label>
                                <label><input type="radio" name="hasAtm" value="no" onchange="toggleAtmSection()"> Do not have ATM</label>
                            </div>
                            <div id="atmContainer" class="hidden">
                                <div class="atm-ip-section">
                                    <label>ATM IP Addresses*</label>
                                    <div id="atmIpContainer">
                                        <div class="atm-ip-details first-atm-ip" data-index="0">
                                            <div class="form-group">
                                                <input type="text" id="atmIp_0" name="atmIp[]" required placeholder="Enter ATM IP Address">
                                            </div>
                                        </div>
                                    </div>
                                    <button type="button" class="add-member-btn" id="addAtmIpBtn">+ Add Another ATM IP Address</button>
                                </div>
                            </div>
                        </div>

                        <!-- Security Assessment Section -->
                        <div class="form-group">
                            <h3 style="margin: 20px 0 10px 0; color: #2c3e50; font-size: 1.2rem;">CBS ACCESS CONTROL</h3>
                            <hr style="border: none; height: 2px; background: linear-gradient(to right, #3498db, #2c3e50, #3498db); margin: 15px 0 25px 0;">
                        </div>

                        <!-- Security Questions -->
                        <div class="form-group security-question-row">
                            <label for="strongPasswords" class="security-question-label">1. Do employees are using strong passwords?*</label>
                            <select id="strongPasswords" name="strongPasswords" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="passwordChanges" class="security-question-label">2. Do you mandate periodical password changes?*</label>
                            <input type="number" id="passwordChanges" name="passwordChanges" class="security-question-input" required placeholder="Enter number of days" min="1">
                        </div>

                        <div class="form-group security-question-row">
                            <label for="passwordSharing" class="security-question-label">3. Do passwords are shared among employees?*</label>
                            <select id="passwordSharing" name="passwordSharing" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="failedLoginAttempts" class="security-question-label">4. What happens after consecutive failed login attempts?*</label>
                            <select id="failedLoginAttempts" name="failedLoginAttempts" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="sessionTimeout" class="security-question-label">5. Is session timeout enforced after a pre-defined period of inactivity?*</label>
                            <input type="number" id="sessionTimeout" name="sessionTimeout" class="security-question-input" required placeholder="Enter timeout in minutes" min="1">
                        </div>

                        <div class="form-group security-question-row">
                            <label for="multipleLogins" class="security-question-label">6. Whether Multiple Logins is enabled?*</label>
                            <select id="multipleLogins" name="multipleLogins" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="cbsIsolation" class="security-question-label">7. Is the CBS System isolated from the internet?*</label>
                            <select id="cbsIsolation" name="cbsIsolation" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="internetRestriction" class="security-question-label">8. Is internet access restricted to only trusted and officially approved sites?*</label>
                            <select id="internetRestriction" name="internetRestriction" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="defaultPasswordPolicy" class="security-question-label">9. Is there any policy for default password while unlocking the account?*</label>
                            <select id="defaultPasswordPolicy" name="defaultPasswordPolicy" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="userCredentials" class="security-question-label">10. When a new user joins then how do you give the user ID and Password for the user by using mail or telephonic conversation?*</label>
                            <select id="userCredentials" name="userCredentials" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="sslUsage" class="security-question-label">11. SSL is using or not in CBS Application?*</label>
                            <select id="sslUsage" name="sslUsage" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="cbsType" class="security-question-label">12. CBS is browser based or desktop based?*</label>
                            <select id="cbsType" name="cbsType" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Browser Based">Browser Based</option>
                                <option value="Desktop Based">Desktop Based</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="browserCompatibility" class="security-question-label">13. Is the CBS compatible with the latest version of the browser?*</label>
                            <select id="browserCompatibility" name="browserCompatibility" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="twoFactorAuth" class="security-question-label">14. Whether Two Factor Authentication is implemented for CBS login?*</label>
                            <select id="twoFactorAuth" name="twoFactorAuth" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Biometric Based Compliance">Biometric Based Compliance</option>
                                <option value="OTP-Based Compliance">OTP-Based Compliance</option>
                                <option value="Biometric and OTP Both">Biometric and OTP Both</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Physical and Environmental Security Section -->
                        <div class="form-group">
                            <h3 style="margin: 20px 0 10px 0; color: #2c3e50; font-size: 1.2rem;">PHYSICAL AND ENVIRONMENTAL SECURITY</h3>
                            <hr style="border: none; height: 2px; background: linear-gradient(to right, #3498db, #2c3e50, #3498db); margin: 15px 0 25px 0;">
                        </div>

                        <!-- CCTV Camera Present -->
                        <div class="form-group security-question-row">
                            <label for="cctvCameraPresent" class="security-question-label">15. CCTV Camera Present?*</label>
                            <select id="cctvCameraPresent" name="cctvCameraPresent" class="security-question-input" required onchange="toggleCctvNumberField()">
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Unable to Check">Unable to Check</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row" id="cctvNumberField" style="display: none;">
                            <label for="cctvCameraNumber" class="security-question-label">15a. Number of CCTV Cameras*</label>
                            <input type="number" id="cctvCameraNumber" name="cctvCameraNumber" class="security-question-input" placeholder="Enter number of cameras" min="1">
                        </div>

                        <!-- Branch Locker CCTV Camera Present -->
                        <div class="form-group security-question-row">
                            <label for="branchLockerCctv" class="security-question-label">16. Branch Locker CCTV Camera Present?*</label>
                            <select id="branchLockerCctv" name="branchLockerCctv" class="security-question-input" required onchange="toggleLockerCctvNumberField()">
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Unable to Check">Unable to Check</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row" id="lockerCctvNumberField" style="display: none;">
                            <label for="branchLockerCctvNumber" class="security-question-label">16a. Number of Locker CCTV Cameras*</label>
                            <input type="number" id="branchLockerCctvNumber" name="branchLockerCctvNumber" class="security-question-input" placeholder="Enter number of cameras" min="1">
                        </div>

                        <!-- CCTV camera covering complete branch area -->
                        <div class="form-group security-question-row">
                            <label for="cctvCoveringCompleteArea" class="security-question-label">17. CCTV camera covering complete branch area?*</label>
                            <select id="cctvCoveringCompleteArea" name="cctvCoveringCompleteArea" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Unable to Check">Unable to Check</option>
                            </select>
                        </div>

                        <!-- Check DVR working properly -->
                        <div class="form-group security-question-row">
                            <label for="dvrWorkingProperly" class="security-question-label">18. Check DVR working properly?*</label>
                            <select id="dvrWorkingProperly" name="dvrWorkingProperly" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Is NTP configured in the DVR -->
                        <div class="form-group security-question-row">
                            <label for="ntpConfiguredDvr" class="security-question-label">19. Is NTP configured in the DVR?*</label>
                            <select id="ntpConfiguredDvr" name="ntpConfiguredDvr" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Unable to Check">Unable to Check</option>
                            </select>
                        </div>

                        <!-- DVR is available in bank network or not -->
                        <div class="form-group security-question-row">
                            <label for="dvrInBankNetwork" class="security-question-label">20. DVR is available in bank network or not?*</label>
                            <select id="dvrInBankNetwork" name="dvrInBankNetwork" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Camera is working in night vision -->
                        <div class="form-group security-question-row">
                            <label for="cameraNightVision" class="security-question-label">21. Camera is working in night vision?*</label>
                            <select id="cameraNightVision" name="cameraNightVision" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Unable to Check">Unable to Check</option>
                            </select>
                        </div>

                        <!-- CCTV camera history recording duration -->
                        <div class="form-group security-question-row">
                            <label for="cctvHistoryDuration" class="security-question-label">22. CCTV camera history recording duration (in days)*</label>
                            <div>
                                <label><input type="radio" name="cctvHistoryDurationMode" value="number" checked onchange="toggleCctvHistoryInput(true)"> Input Number</label>
                                <label style="margin-left: 12px;"><input type="radio" name="cctvHistoryDurationMode" value="unable" onchange="toggleCctvHistoryInput(false)"> Unable to Check</label>
                            </div>
                            <input type="number" id="cctvHistoryDuration" name="cctvHistoryDuration" class="security-question-input" placeholder="Enter duration in days" min="1">
                        </div>

                        <!-- Locker CCTV camera history recording duration -->
                        <div class="form-group security-question-row">
                            <label for="lockerCctvHistoryDuration" class="security-question-label">23. Locker CCTV camera history recording duration (in days)*</label>
                            <div>
                                <label><input type="radio" name="lockerCctvHistoryDurationMode" value="number" checked onchange="toggleLockerCctvHistoryInput(true)"> Input Number</label>
                                <label style="margin-left: 12px;"><input type="radio" name="lockerCctvHistoryDurationMode" value="unable" onchange="toggleLockerCctvHistoryInput(false)"> Unable to Check</label>
                            </div>
                            <input type="number" id="lockerCctvHistoryDuration" name="lockerCctvHistoryDuration" class="security-question-input" placeholder="Enter duration in days" min="1">
                        </div>

                        <!-- Biometric Devices or Proximity Card is available or not -->
                        <div class="form-group security-question-row">
                            <label for="biometricDevices" class="security-question-label">24. Biometric Devices or Proximity Card is available or not?*</label>
                            <select id="biometricDevices" name="biometricDevices" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- ID card issues to the Employee -->
                        <div class="form-group security-question-row">
                            <label for="idCardIssued" class="security-question-label">25. ID card issues to the Employee?*</label>
                            <select id="idCardIssued" name="idCardIssued" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Whether guard is available at branch or not -->
                        <div class="form-group security-question-row">
                            <label for="guardAvailable" class="security-question-label">26. Whether guard is available at branch or not?*</label>
                            <select id="guardAvailable" name="guardAvailable" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Are secure areas controlled -->
                        <div class="form-group security-question-row">
                            <label for="secureAreasControlled" class="security-question-label">27. Are secure areas controlled?*</label>
                            <select id="secureAreasControlled" name="secureAreasControlled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Smoke Detector is installed in the branch -->
                        <div class="form-group security-question-row">
                            <label for="smokeDetectorInstalled" class="security-question-label">28. Smoke Detector is installed in the branch?*</label>
                            <select id="smokeDetectorInstalled" name="smokeDetectorInstalled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Whether Panic Switch installed -->
                        <div class="form-group security-question-row">
                            <label for="panicSwitchInstalled" class="security-question-label">29. Whether Panic Switch installed?*</label>
                            <select id="panicSwitchInstalled" name="panicSwitchInstalled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- If a panic switch or smoke detector is installed at the branch or head office does the notification reach higher authorities when triggered -->
                        <div class="form-group security-question-row">
                            <label for="notificationReachAuthorities" class="security-question-label">30. If a panic switch or smoke detector is installed at the branch or head office does the notification reach higher authorities when triggered?*</label>
                            <select id="notificationReachAuthorities" name="notificationReachAuthorities" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Panic Switch">Panic Switch</option>
                                <option value="Smoke Detector">Smoke Detector</option>
                                <option value="Panic and Smoke">Panic and Smoke</option>
                                <option value="Non Compliance">Non Compliance</option>
                            </select>
                        </div>

                        <!-- LAN ports are open or not -->
                        <div class="form-group security-question-row">
                            <label for="lanPortsOpen" class="security-question-label">31. LAN ports are open or not?*</label>
                            <select id="lanPortsOpen" name="lanPortsOpen" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Visitor Register is maintained or not -->
                        <div class="form-group security-question-row">
                            <label for="visitorRegisterMaintained" class="security-question-label">32. Visitor Register is maintained or not?*</label>
                            <select id="visitorRegisterMaintained" name="visitorRegisterMaintained" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Any record maintains for drill the environmental controls -->
                        <div class="form-group security-question-row">
                            <label for="environmentalControlsDrill" class="security-question-label">33. Any record maintains for drill the environmental controls?*</label>
                            <select id="environmentalControlsDrill" name="environmentalControlsDrill" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Whether external modems, data cards etc., are being used in the Branch to access internet -->
                        <div class="form-group security-question-row">
                            <label for="externalModemsUsed" class="security-question-label">34. Whether external modems, data cards etc., are being used in the Branch to access internet?*</label>
                            <select id="externalModemsUsed" name="externalModemsUsed" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Fire extinguisher is available or not -->
                        <div class="form-group security-question-row">
                            <label for="fireExtinguisherAvailable" class="security-question-label">35. Fire extinguisher is available or not?*</label>
                            <select id="fireExtinguisherAvailable" name="fireExtinguisherAvailable" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Enough fire-extinguisher is available for area -->
                        <div class="form-group security-question-row">
                            <label for="enoughFireExtinguisher" class="security-question-label">36. Enough fire-extinguisher is available for area?*</label>
                            <select id="enoughFireExtinguisher" name="enoughFireExtinguisher" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Power Back Up Section -->
                        <div class="form-group">
                            <h3 style="margin: 20px 0 10px 0; color: #2c3e50; font-size: 1.2rem;">POWER BACK UP</h3>
                            <hr style="border: none; height: 2px; background: linear-gradient(to right, #3498db, #2c3e50, #3498db); margin: 15px 0 25px 0;">
                        </div>

                        <!-- Battery Backup Support -->
                        <div class="form-group security-question-row">
                            <label for="batteryBackupSupport" class="security-question-label">37. Does the Bank have made enough Battery Backup which supports Computer Systems? (in hours)*</label>
                            <input type="number" id="batteryBackupSupport" name="batteryBackupSupport" class="security-question-input" required placeholder="Enter backup duration in hours" min="1">
                        </div>

                        <!-- AMC for Power Backup Systems -->
                        <div class="form-group security-question-row">
                            <label for="amcPowerBackup" class="security-question-label">38. Do the AMC is given for power backup systems?*</label>
                            <select id="amcPowerBackup" name="amcPowerBackup" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Generator Available -->
                        <div class="form-group security-question-row">
                            <label for="generatorAvailable" class="security-question-label">39. Generator is available or not?*</label>
                            <select id="generatorAvailable" name="generatorAvailable" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <!-- User Awareness Section -->
                        <div class="form-group">
                            <h3 style="margin: 20px 0 10px 0; color: #2c3e50; font-size: 1.2rem;">USER AWARENESS</h3>
                            <hr style="border: none; height: 2px; background: linear-gradient(to right, #3498db, #2c3e50, #3498db); margin: 15px 0 25px 0;">
                        </div>

                        <!-- Information Security Training -->
                        <div class="form-group security-question-row">
                            <label for="infoSecurityTraining" class="security-question-label">40. Is training conducted for end user with respect to the Information Security?*</label>
                            <select id="infoSecurityTraining" name="infoSecurityTraining" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Application Usage Training -->
                        <div class="form-group security-question-row">
                            <label for="applicationUsageTraining" class="security-question-label">41. Is training conducted for end user with respect to the application usage?*</label>
                            <select id="applicationUsageTraining" name="applicationUsageTraining" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Fire Extinguisher & Panic Switch Awareness -->
                        <div class="form-group security-question-row">
                            <label for="fireExtinguisherPanicSwitchAwareness" class="security-question-label">42. Employees are aware about using of fire extinguisher & Panic Switch?*</label>
                            <select id="fireExtinguisherPanicSwitchAwareness" name="fireExtinguisherPanicSwitchAwareness" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Fire Extinguishers">Fire Extinguishers</option>
                                <option value="Panic Switch">Panic Switch</option>
                                <option value="Both">Both</option>
                                <option value="Non Compliance">Non Compliance</option>
                            </select>
                        </div>

                        <!-- CCTV Recording History Awareness -->
                        <div class="form-group security-question-row">
                            <label for="cctvRecordingHistoryAwareness" class="security-question-label">43. User was aware about checking CCTV recording history?*</label>
                            <select id="cctvRecordingHistoryAwareness" name="cctvRecordingHistoryAwareness" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Maintenance and Business Continuity Controls Section -->
                        <div class="form-group">
                            <h3 style="margin: 20px 0 10px 0; color: #2c3e50; font-size: 1.2rem;">MAINTENANCE AND BUSINESS CONTINUITY CONTROLS</h3>
                            <hr style="border: none; height: 2px; background: linear-gradient(to right, #3498db, #2c3e50, #3498db); margin: 15px 0 25px 0;">
                        </div>

                        <!-- AMC for Computer Systems -->
                        <div class="form-group security-question-row">
                            <label for="amcComputerSystems" class="security-question-label">44. Is AMC is given for computer and related systems?*</label>
                            <select id="amcComputerSystems" name="amcComputerSystems" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Complaint Register Maintained -->
                        <div class="form-group security-question-row">
                            <label for="complaintRegisterMaintained" class="security-question-label">45. Is Complaint register maintained?*</label>
                            <select id="complaintRegisterMaintained" name="complaintRegisterMaintained" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Patch Management Section -->
                        <div class="form-group">
                            <h3 style="margin: 20px 0 10px 0; color: #2c3e50; font-size: 1.2rem;">PATCH MANAGEMENT</h3>
                            <hr style="border: none; height: 2px; background: linear-gradient(to right, #3498db, #2c3e50, #3498db); margin: 15px 0 25px 0;">
                        </div>

                        <!-- Antivirus Available -->
                        <div class="form-group security-question-row">
                            <label for="antivirusAvailable" class="security-question-label">46. Antivirus available in all the desktop?*</label>
                            <select id="antivirusAvailable" name="antivirusAvailable" class="security-question-input" required onchange="toggleAntivirusAvailableField()">
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row" id="antivirusAvailableField" style="display: none;">
                            <label for="antivirusAvailableIps" class="security-question-label">46a. IP Addresses without Antivirus*</label>
                            <textarea id="antivirusAvailableIps" name="antivirusAvailableIps" class="security-question-input" placeholder="Enter IP addresses separated by commas" rows="3"></textarea>
                        </div>

                        <!-- Antivirus Updated -->
                        <div class="form-group security-question-row">
                            <label for="antivirusUpdated" class="security-question-label">47. Antivirus updated in all the desktop?*</label>
                            <select id="antivirusUpdated" name="antivirusUpdated" class="security-question-input" required onchange="toggleAntivirusUpdatedField()">
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Do not Antivirus">Do not Antivirus</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row" id="antivirusUpdatedField" style="display: none;">
                            <label for="antivirusUpdatedIps" class="security-question-label">47a. IP Addresses with outdated Antivirus and Date*</label>
                            <textarea id="antivirusUpdatedIps" name="antivirusUpdatedIps" class="security-question-input" placeholder="Enter IP addresses and dates (e.g., 192.168.1.1 - 2024-01-15, 192.168.1.2 - 2024-01-20)" rows="3"></textarea>
                        </div>

                        <!-- Windows Patch Updated -->
                        <div class="form-group security-question-row">
                            <label for="windowsPatchUpdated" class="security-question-label">48. Windows patch updated in all the system?*</label>
                            <select id="windowsPatchUpdated" name="windowsPatchUpdated" class="security-question-input" required onchange="toggleWindowsPatchField()">
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row" id="windowsPatchField" style="display: none;">
                            <label for="windowsPatchIps" class="security-question-label">48a. IP Addresses with outdated Windows patches and Date*</label>
                            <textarea id="windowsPatchIps" name="windowsPatchIps" class="security-question-input" placeholder="Enter IP addresses and dates (e.g., 192.168.1.1 - 2024-01-15, 192.168.1.2 - 2024-01-20)" rows="3"></textarea>
                        </div>

                        <!-- Outdated Windows Version -->
                        <div class="form-group security-question-row">
                            <label for="outdatedWindowsVersion" class="security-question-label">49. Are there any system on which outdated version of windows is installed?*</label>
                            <select id="outdatedWindowsVersion" name="outdatedWindowsVersion" class="security-question-input" required onchange="toggleOutdatedWindowsField()">
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row" id="outdatedWindowsField" style="display: none;">
                            <label for="outdatedWindowsIps" class="security-question-label">49a. IP Addresses with outdated Windows versions*</label>
                            <textarea id="outdatedWindowsIps" name="outdatedWindowsIps" class="security-question-input" placeholder="Enter IP addresses separated by commas" rows="3"></textarea>
                        </div>

                        <!-- Expired License Antivirus -->
                        <div class="form-group security-question-row">
                            <label for="expiredLicenseAntivirus" class="security-question-label">50. Expired License antivirus installed?*</label>
                            <select id="expiredLicenseAntivirus" name="expiredLicenseAntivirus" class="security-question-input" required onchange="toggleExpiredLicenseField()">
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row" id="expiredLicenseField" style="display: none;">
                            <label for="expiredLicenseIps" class="security-question-label">50a. IP Addresses with expired antivirus licenses*</label>
                            <textarea id="expiredLicenseIps" name="expiredLicenseIps" class="security-question-input" placeholder="Enter IP addresses separated by commas" rows="3"></textarea>
                        </div>

                        <!-- Network Security Section -->
                        <div class="form-group">
                            <h3 style="margin: 20px 0 10px 0; color: #2c3e50; font-size: 1.2rem;">NETWORK SECURITY</h3>
                            <hr style="border: none; height: 2px; background: linear-gradient(to right, #3498db, #2c3e50, #3498db); margin: 15px 0 25px 0;">
                        </div>

                        <!-- Network Access Controls -->
                        <div class="form-group security-question-row">
                            <label for="networkAccessControls" class="security-question-label">51. Are controls in place to ensure users only have access to the network resources they have been specially authorized to use and are required for their duties?*</label>
                            <select id="networkAccessControls" name="networkAccessControls" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Network Diagram Available -->
                        <div class="form-group security-question-row">
                            <label for="networkDiagramAvailable" class="security-question-label">52. Is there network diagram available?*</label>
                            <select id="networkDiagramAvailable" name="networkDiagramAvailable" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Structured Cabling -->
                        <div class="form-group security-question-row">
                            <label for="structuredCabling" class="security-question-label">53. Is structured cabling is observed?*</label>
                            <select id="structuredCabling" name="structuredCabling" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Cable Tagging -->
                        <div class="form-group security-question-row">
                            <label for="cableTagging" class="security-question-label">54. Is cable tagging is observed?*</label>
                            <select id="cableTagging" name="cableTagging" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Backup Network -->
                        <div class="form-group security-question-row">
                            <label for="backupNetwork" class="security-question-label">55. Is provision made for backup network?*</label>
                            <select id="backupNetwork" name="backupNetwork" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Networking Devices Security -->
                        <div class="form-group security-question-row">
                            <label for="networkingDevicesSecurity" class="security-question-label">56. Networking devices are under secure location and there is any cabinet facility is provided or not?*</label>
                            <select id="networkingDevicesSecurity" name="networkingDevicesSecurity" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Cooling for Networking Devices -->
                        <div class="form-group security-question-row">
                            <label for="networkingDevicesCooling" class="security-question-label">57. Proper Cooling for Networking Devices available or not?*</label>
                            <select id="networkingDevicesCooling" name="networkingDevicesCooling" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Wi-Fi Available -->
                        <div class="form-group security-question-row">
                            <label for="wifiAvailable" class="security-question-label">58. Wi-Fi is available or not?*</label>
                            <select id="wifiAvailable" name="wifiAvailable" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Firewall Available -->
                        <div class="form-group security-question-row">
                            <label for="firewallAvailable" class="security-question-label">59. Whether Firewall is available in Branch?*</label>
                            <select id="firewallAvailable" name="firewallAvailable" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Endpoints Vulnerability Section -->
                        <div class="form-group">
                            <h3 style="margin: 20px 0 10px 0; color: #2c3e50; font-size: 1.2rem;">ENDPOINTS VULNERABILITY</h3>
                            <hr style="border: none; height: 2px; background: linear-gradient(to right, #3498db, #2c3e50, #3498db); margin: 15px 0 25px 0;">
                        </div>

                        <!-- User Login with Administrator Rights -->
                        <div class="form-group security-question-row">
                            <label for="adminRightsLogin" class="security-question-label">60. Does User login with Administrator Rights?*</label>
                            <select id="adminRightsLogin" name="adminRightsLogin" class="security-question-input" required onchange="toggleAdminRightsField()">
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row" id="adminRightsField" style="display: none;">
                            <label for="adminRightsIps" class="security-question-label">60a. IP Addresses with Administrator Rights*</label>
                            <textarea id="adminRightsIps" name="adminRightsIps" class="security-question-input" placeholder="Enter IP addresses separated by commas" rows="3"></textarea>
                        </div>

                        <!-- Group Policy Modification -->
                        <div class="form-group security-question-row">
                            <label for="groupPolicyModification" class="security-question-label">61. Can Group Policy be modified?*</label>
                            <select id="groupPolicyModification" name="groupPolicyModification" class="security-question-input" required onchange="toggleGroupPolicyField()">
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row" id="groupPolicyField" style="display: none;">
                            <label for="groupPolicyIps" class="security-question-label">61a. IP Addresses where Group Policy can be modified*</label>
                            <textarea id="groupPolicyIps" name="groupPolicyIps" class="security-question-input" placeholder="Enter IP addresses separated by commas" rows="3"></textarea>
                        </div>

                        <!-- Security Configuration Policy Modification -->
                        <div class="form-group security-question-row">
                            <label for="securityConfigModification" class="security-question-label">62. Can Security Configuration Policy be modified?*</label>
                            <select id="securityConfigModification" name="securityConfigModification" class="security-question-input" required onchange="toggleSecurityConfigField()">
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row" id="securityConfigField" style="display: none;">
                            <label for="securityConfigIps" class="security-question-label">62a. IP Addresses where Security Configuration can be modified*</label>
                            <textarea id="securityConfigIps" name="securityConfigIps" class="security-question-input" placeholder="Enter IP addresses separated by commas" rows="3"></textarea>
                        </div>

                        <!-- Proxy Modification -->
                        <div class="form-group security-question-row">
                            <label for="proxyModification" class="security-question-label">63. Whether Proxy can be modified by branch users?*</label>
                            <select id="proxyModification" name="proxyModification" class="security-question-input" required onchange="toggleProxyField()">
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row" id="proxyField" style="display: none;">
                            <label for="proxyIps" class="security-question-label">63a. IP Addresses where Proxy can be modified*</label>
                            <textarea id="proxyIps" name="proxyIps" class="security-question-input" placeholder="Enter IP addresses separated by commas" rows="3"></textarea>
                        </div>

                        <!-- Internet Allowed -->
                        <div class="form-group security-question-row">
                            <label for="internetAllowed" class="security-question-label">64. Whether internet is allowed or not?*</label>
                            <select id="internetAllowed" name="internetAllowed" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Internet Access Restricted -->
                        <div class="form-group security-question-row">
                            <label for="internetAccessRestricted" class="security-question-label">65. Whether internet access is restricted or unrestricted?*</label>
                            <select id="internetAccessRestricted" name="internetAccessRestricted" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Authentication Policy for Internet -->
                        <div class="form-group security-question-row">
                            <label for="internetAuthPolicy" class="security-question-label">66. Authentication Policy for internet is available or not?*</label>
                            <select id="internetAuthPolicy" name="internetAuthPolicy" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="NA">NA</option>
                            </select>
                        </div>

                        <!-- System Password Weak -->
                        <div class="form-group security-question-row">
                            <label for="systemPasswordWeak" class="security-question-label">67. System Password is weak or not?*</label>
                            <select id="systemPasswordWeak" name="systemPasswordWeak" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- System Tagging -->
                        <div class="form-group security-question-row">
                            <label for="systemTagging" class="security-question-label">68. System tagging is available or not?*</label>
                            <select id="systemTagging" name="systemTagging" class="security-question-input" required onchange="toggleSystemTaggingField()">
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row" id="systemTaggingField" style="display: none;">
                            <label for="systemTaggingIps" class="security-question-label">68a. IP Addresses and Device Names without tagging*</label>
                            <textarea id="systemTaggingIps" name="systemTaggingIps" class="security-question-input" placeholder="Enter IP addresses and device names (e.g., 192.168.1.1 - mouse, 192.168.1.2 - keyboard)" rows="3"></textarea>
                        </div>

                        <!-- NTP Configured -->
                        <div class="form-group security-question-row">
                            <label for="ntpConfigured" class="security-question-label">69. Is NTP configured in the systems?*</label>
                            <select id="ntpConfigured" name="ntpConfigured" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- USB Ports/CD Drives Enabled -->
                        <div class="form-group security-question-row">
                            <label for="usbPortsEnabled" class="security-question-label">70. Whether USB ports/CD drives enabled in the System?*</label>
                            <select id="usbPortsEnabled" name="usbPortsEnabled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- USB Approval Process -->
                        <div class="form-group security-question-row">
                            <label for="usbApprovalProcess" class="security-question-label">71. USB Approval process?*</label>
                            <select id="usbApprovalProcess" name="usbApprovalProcess" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Trusted USB Check -->
                        <div class="form-group security-question-row">
                            <label for="trustedUsbCheck" class="security-question-label">72. If bank have trusted USB, then check the USB open outside the network?*</label>
                            <select id="trustedUsbCheck" name="trustedUsbCheck" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="NA">NA</option>
                            </select>
                        </div>

                        <!-- Firewall Enabled -->
                        <div class="form-group security-question-row">
                            <label for="firewallEnabled" class="security-question-label">73. Whether Firewall is enable in systems?*</label>
                            <select id="firewallEnabled" name="firewallEnabled" class="security-question-input" required onchange="toggleFirewallEnabledField()">
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row" id="firewallEnabledField" style="display: none;">
                            <label for="firewallEnabledIps" class="security-question-label">73a. IP Addresses without Firewall enabled*</label>
                            <textarea id="firewallEnabledIps" name="firewallEnabledIps" class="security-question-input" placeholder="Enter IP addresses separated by commas" rows="3"></textarea>
                        </div>

                        <!-- External Storage Media Virus Check -->
                        <div class="form-group security-question-row">
                            <label for="externalStorageVirusCheck" class="security-question-label">74. Whether all external storage media are checked for virus?*</label>
                            <select id="externalStorageVirusCheck" name="externalStorageVirusCheck" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Remote Desktop Protocol -->
                        <div class="form-group security-question-row">
                            <label for="rdpEnabled" class="security-question-label">75. Whether Remote Desktop Protocol is enabled or disabled?*</label>
                            <select id="rdpEnabled" name="rdpEnabled" class="security-question-input" required onchange="toggleRdpField()">
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row" id="rdpField" style="display: none;">
                            <label for="rdpIps" class="security-question-label">75a. IP Addresses with RDP enabled*</label>
                            <textarea id="rdpIps" name="rdpIps" class="security-question-input" placeholder="Enter IP addresses separated by commas" rows="3"></textarea>
                        </div>

                        <!-- ATM Machine Room Section -->
                        <div class="form-group">
                            <h3 style="margin: 20px 0 10px 0; color: #2c3e50; font-size: 1.2rem;">ATM MACHINE ROOM</h3>
                            <hr style="border: none; height: 2px; background: linear-gradient(to right, #3498db, #2c3e50, #3498db); margin: 15px 0 25px 0;">
                        </div>

                        <!-- CCTV Camera LAN Cable and Power Cable Concealed -->
                        <div class="form-group security-question-row">
                            <label for="atmCctvCableConcealed" class="security-question-label">76. Check the CCTV camera LAN cable and ATM machine power cable concealed?*</label>
                            <select id="atmCctvCableConcealed" name="atmCctvCableConcealed" class="security-question-input atm-field" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <!-- Guard Available -->
                        <div class="form-group security-question-row">
                            <label for="atmGuardAvailable" class="security-question-label">77. Guard is available or not?*</label>
                            <select id="atmGuardAvailable" name="atmGuardAvailable" class="security-question-input atm-field" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <!-- CCTV Camera Position -->
                        <div class="form-group security-question-row">
                            <label for="atmCctvPosition" class="security-question-label">78. CCTV Camera and check the position of camera?*</label>
                            <select id="atmCctvPosition" name="atmCctvPosition" class="security-question-input atm-field" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <!-- ATM Working 24x7 -->
                        <div class="form-group security-question-row">
                            <label for="atmWorking247" class="security-question-label">79. ATM is working 24*7?*</label>
                            <select id="atmWorking247" name="atmWorking247" class="security-question-input atm-field" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <!-- Do's and Don't User Awareness -->
                        <div class="form-group security-question-row">
                            <label for="atmDosDontsAwareness" class="security-question-label">80. Whether the Do's and Don't for the user awareness is available or not?*</label>
                            <select id="atmDosDontsAwareness" name="atmDosDontsAwareness" class="security-question-input atm-field" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <!-- ATM Network Segmented -->
                        <div class="form-group security-question-row">
                            <label for="atmNetworkSegmented" class="security-question-label">81. Whether the ATM is network segmented or not?*</label>
                            <select id="atmNetworkSegmented" name="atmNetworkSegmented" class="security-question-input atm-field" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <!-- ATM Machine Properly Grouted -->
                        <div class="form-group security-question-row">
                            <label for="atmMachineGrouted" class="security-question-label">82. Whether ATM Machine is properly grouted (floor and wall)?*</label>
                            <select id="atmMachineGrouted" name="atmMachineGrouted" class="security-question-input atm-field" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <!-- ATM Room Access Restricted -->
                        <div class="form-group security-question-row">
                            <label for="atmRoomAccessRestricted" class="security-question-label">83. Whether access to ATM room for maintenance purpose is restricted to the authorized persons only?*</label>
                            <select id="atmRoomAccessRestricted" name="atmRoomAccessRestricted" class="security-question-input atm-field" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <!-- ATM Power Backup UPS -->
                        <div class="form-group security-question-row">
                            <label for="atmPowerBackupUps" class="security-question-label">84. Whether ATM power back up is supported by UPS.*</label>
                            <select id="atmPowerBackupUps" name="atmPowerBackupUps" class="security-question-input atm-field" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <!-- ATM Cash Replenishment Dual Control -->
                        <div class="form-group security-question-row">
                            <label for="atmCashReplenishmentDualControl" class="security-question-label">85. System of ATM cash replenishment, adherence to dual control mechanism records is maintained properly?*</label>
                            <select id="atmCashReplenishmentDualControl" name="atmCashReplenishmentDualControl" class="security-question-input atm-field" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <!-- ATM Reconciliation Status -->
                        <div class="form-group security-question-row">
                            <label for="atmReconciliationStatus" class="security-question-label">86. Check system of ATM reconciliation status maintained?*</label>
                            <select id="atmReconciliationStatus" name="atmReconciliationStatus" class="security-question-input atm-field" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <!-- ATM Journal Print Preservation -->
                        <div class="form-group security-question-row">
                            <label for="atmJournalPrintPreservation" class="security-question-label">87. Whether ATM machine preservation is done of journal print for future reference?*</label>
                            <select id="atmJournalPrintPreservation" name="atmJournalPrintPreservation" class="security-question-input atm-field" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <!-- Email Security Section -->
                        <div class="form-group">
                            <h3 style="margin: 20px 0 10px 0; color: #2c3e50; font-size: 1.2rem;">EMAIL-SECURITY</h3>
                            <hr style="border: none; height: 2px; background: linear-gradient(to right, #3498db, #2c3e50, #3498db); margin: 15px 0 25px 0;">
                        </div>

                        <!-- Personal Mail Used -->
                        <div class="form-group security-question-row">
                            <label for="personalMailUsed" class="security-question-label">88. Personal Mail used or not?*</label>
                            <select id="personalMailUsed" name="personalMailUsed" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Two Factor Authentication -->
                        <div class="form-group security-question-row">
                            <label for="emailTwoFactorAuth" class="security-question-label">89. Two factor authentications are in used or not?*</label>
                            <select id="emailTwoFactorAuth" name="emailTwoFactorAuth" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Single Mail with Multiple Users -->
                        <div class="form-group security-question-row">
                            <label for="singleMailMultipleUsers" class="security-question-label">90. Single mail with multiple users?*</label>
                            <select id="singleMailMultipleUsers" name="singleMailMultipleUsers" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Official Email Outside Bank Network -->
                        <div class="form-group security-question-row">
                            <label for="officialEmailOutsideNetwork" class="security-question-label">91. Whether official email ID gets open outside bank N/w?*</label>
                            <select id="officialEmailOutsideNetwork" name="officialEmailOutsideNetwork" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Remote Access Section -->
                        <div class="form-group">
                            <h3 style="margin: 20px 0 10px 0; color: #2c3e50; font-size: 1.2rem;">REMOTE ACCESS</h3>
                            <hr style="border: none; height: 2px; background: linear-gradient(to right, #3498db, #2c3e50, #3498db); margin: 15px 0 25px 0;">
                        </div>

                        <!-- Department Using Remote Access -->
                        <div class="form-group security-question-row">
                            <label for="departmentRemoteAccess" class="security-question-label">92. Which Department is using Remote Access?*</label>
                            <select id="departmentRemoteAccess" name="departmentRemoteAccess" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="NA">NA</option>
                            </select>
                        </div>

                        <!-- Remote Access Approval Process -->
                        <div class="form-group security-question-row">
                            <label for="remoteAccessApprovalProcess" class="security-question-label">93. Remote Access approval process?*</label>
                            <select id="remoteAccessApprovalProcess" name="remoteAccessApprovalProcess" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="NA">NA</option>
                            </select>
                        </div>

                        <!-- Unauthorized Applications / Personal Data Section -->
                        <div class="form-group">
                            <h3 style="margin: 20px 0 10px 0; color: #2c3e50; font-size: 1.2rem;">UNAUTHORIZED APPLICATIONS / PERSONAL DATA</h3>
                            <hr style="border: none; height: 2px; background: linear-gradient(to right, #3498db, #2c3e50, #3498db); margin: 15px 0 25px 0;">
                        </div>

                        <!-- Unauthorized Applications -->
                        <div class="form-group security-question-row">
                            <label for="unauthorizedApplications" class="security-question-label">94. Does any system have unauthorized applications?*</label>
                            <select id="unauthorizedApplications" name="unauthorizedApplications" class="security-question-input" required onchange="toggleUnauthorizedAppsField()">
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row" id="unauthorizedAppsField" style="display: none;">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="unauthorizedAppsIps" class="security-question-label">94a. IP Addresses with Unauthorized Applications*</label>
                                    <textarea id="unauthorizedAppsIps" name="unauthorizedAppsIps" class="security-question-input" placeholder="Enter IP addresses separated by commas" rows="3"></textarea>
                                </div>
                                <div class="form-group">
                                    <label for="unauthorizedAppsNames" class="security-question-label">94b. Application Names*</label>
                                    <textarea id="unauthorizedAppsNames" name="unauthorizedAppsNames" class="security-question-input" placeholder="Enter application names separated by commas" rows="3"></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Personal Data -->
                        <div class="form-group security-question-row">
                            <label for="personalDataPresent" class="security-question-label">95. Does any system contain personal data?*</label>
                            <select id="personalDataPresent" name="personalDataPresent" class="security-question-input" required onchange="togglePersonalDataField()">
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row" id="personalDataField" style="display: none;">
                            <label for="personalDataIps" class="security-question-label">95a. IP Addresses with Personal Data*</label>
                            <textarea id="personalDataIps" name="personalDataIps" class="security-question-input" placeholder="Enter IP addresses separated by commas" rows="3"></textarea>
                        </div>

                        <!-- Important Note Section -->
                        <div class="form-group">
                            <h3 style="margin: 20px 0 10px 0; color: #2c3e50; font-size: 1.2rem;">Important Note (If any)</h3>
                            <hr style="border: none; height: 2px; background: linear-gradient(to right, #3498db, #2c3e50, #3498db); margin: 15px 0 25px 0;">
                        </div>

                        <!-- Auditor Identity Not Verified -->
                        <div class="form-group security-question-row">
                            <label for="auditorIdentityNotVerified" class="security-question-label">96. Auditor Identity was not verified.*</label>
                            <select id="auditorIdentityNotVerified" name="auditorIdentityNotVerified" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Windows Not Activated -->
                        <div class="form-group security-question-row">
                            <label for="windowsNotActivated" class="security-question-label">97. Windows was not activated.*</label>
                            <select id="windowsNotActivated" name="windowsNotActivated" class="security-question-input" required onchange="toggleWindowsActivatedField()">
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row" id="windowsActivatedField" style="display: none;">
                            <label for="windowsNotActivatedIps" class="security-question-label">97a. IP Addresses with Windows not activated*</label>
                            <textarea id="windowsNotActivatedIps" name="windowsNotActivatedIps" class="security-question-input" placeholder="Enter IP addresses separated by commas" rows="3"></textarea>
                        </div>

                        <!-- Password Saved in Browser -->
                        <div class="form-group security-question-row">
                            <label for="passwordSavedInBrowser" class="security-question-label">98. Password was saved in browser.*</label>
                            <select id="passwordSavedInBrowser" name="passwordSavedInBrowser" class="security-question-input" required onchange="togglePasswordBrowserField()">
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row" id="passwordBrowserField" style="display: none;">
                            <label for="passwordBrowserIps" class="security-question-label">98a. IP Addresses with passwords saved in browser*</label>
                            <textarea id="passwordBrowserIps" name="passwordBrowserIps" class="security-question-input" placeholder="Enter IP addresses separated by commas" rows="3"></textarea>
                        </div>

                        <!-- Password Written on Wall/Desk/Notepad/Diary -->
                        <div class="form-group security-question-row">
                            <label for="passwordWrittenOnWall" class="security-question-label">99. Password was written on wall, desk, notepad, diary.*</label>
                            <select id="passwordWrittenOnWall" name="passwordWrittenOnWall" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Asset Movement Register Not Available -->
                        <div class="form-group security-question-row">
                            <label for="assetMovementRegisterNotAvailable" class="security-question-label">100. Asset Movement Register was not available.*</label>
                            <select id="assetMovementRegisterNotAvailable" name="assetMovementRegisterNotAvailable" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Dust Present on Network Devices -->
                        <div class="form-group security-question-row">
                            <label for="dustPresentOnDevices" class="security-question-label">101. Dust was present on the network devices & systems.*</label>
                            <select id="dustPresentOnDevices" name="dustPresentOnDevices" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Auto Switchable Mode Not Available -->
                        <div class="form-group security-question-row">
                            <label for="autoSwitchableModeNotAvailable" class="security-question-label">102. Auto switchable mode was not available for connectivity.*</label>
                            <select id="autoSwitchableModeNotAvailable" name="autoSwitchableModeNotAvailable" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>

                        <!-- Preventive Maintenance Not Carried Out -->
                        <div class="form-group security-question-row">
                            <label for="preventiveMaintenanceNotCarriedOut" class="security-question-label">103. Preventive Maintenance is not carried out for Systems/UPS/Network Devices.*</label>
                            <select id="preventiveMaintenanceNotCarriedOut" name="preventiveMaintenanceNotCarriedOut" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('branchExcelWithoutPOCModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                        <br>
                        <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center></small>
                    </form>
                </div>
            </div>
        </div>

        <!-- Branch Excel With POC Modal -->
        <div id="branchExcelWithPOCModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Branch Excel With POC Details</h3>
                    <span class="close-modal" onclick="closeModal('branchExcelWithPOCModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="branchExcelWithPOCForm" action="/process_branch_excel_with_poc" method="POST" enctype="multipart/form-data" target="downloadFrame" onsubmit="handleBranchExcelWithPOCSubmit(event)">
                        <!-- File Upload Section -->
                        <div class="form-group">
                            <label for="excelFile">Excel File*</label>
                            <input type="file" id="excelFile" name="excelFile" accept=".xlsx,.xls" required>
                            <small class="file-help">Please select an Excel file (Branch Excel Without POC) (.xlsx or .xls format)</small>
                        </div>

                        <div class="form-group">
                            <label for="zipFile">ZIP File*</label>
                            <input type="file" id="zipFile" name="zipFile" accept=".zip" required>
                            <small class="file-help">Please select a ZIP file (Evidance File) (.zip format) In Zip File, The Evidence (POC) file name must match exactly with the corresponding point number mentioned in the Branch Excel sheet (Without POC Pop-up). For instance, if the point is “1. Do employees use strong passwords?”, the evidence file should be named as 1.jpg, 1.png, or 1_1.png. It is important to avoid file names like 11.jpg, as the system will read it as point number 11 instead of point number 1. Therefore, ensure that the first number in the filename is clearly separated by an underscore or space to maintain accurate numbering and proper recognition by the system.</small>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('branchExcelWithPOCModal')">Cancel</button>
                            <button type="submit" class="submit-btn" id="branchExcelSubmitBtn">Generate Report</button>
                        </div>
                        <br>
                        <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center></small>
                    </form>
                    
                    <!-- Hidden iframe for download -->
                    <iframe name="downloadFrame" style="display: none;"></iframe>
                </div>
            </div>
        </div>

        <!-- Combine Branch Excel Without POC Modal -->
        <div id="combineBranchExcelWithoutPOCModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Combine Branch Excel Without POC</h3>
                    <span class="close-modal" onclick="closeModal('combineBranchExcelWithoutPOCModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="combineBranchExcelWithoutPOCForm" action="/combine_branch_excel_without_poc" method="POST" enctype="multipart/form-data" onsubmit="handleCombineBranchExcelWithoutPOCSubmit(event)">
                        <!-- File Upload Section -->
                        <div class="form-group">
                            <label for="combineZipFile">Branch Excel ZIP (No Evidence)*</label>
                            <input type="file" id="combineZipFile" name="zipFile" accept=".zip" required>
                            <small class="file-help">Attached is the ZIP file containing all the Excel files for the branches, without evidence.</small>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('combineBranchExcelWithoutPOCModal')">Cancel</button>
                            <button type="submit" class="submit-btn" id="combineBranchExcelSubmitBtn">Generate Report</button>
                        </div>
                        <br>
                        <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center></small>
                    </form>
                    
                    <!-- Hidden iframe for download -->
                    <iframe name="combineDownloadFrame" style="display: none;"></iframe>
                </div>
            </div>
        </div>

        <!-- Combine Branch Excel With POC Modal -->
        <div id="combineBranchExcelWithPOCModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Combine Branch Excel With POC</h3>
                    <span class="close-modal" onclick="closeModal('combineBranchExcelWithPOCModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="combineBranchExcelWithPOCForm" action="/combine_branch_excel_with_poc" method="POST" enctype="multipart/form-data" onsubmit="handleCombineBranchExcelWithPOCSubmit(event)">
                        <!-- File Upload Section -->
                        <div class="form-group">
                            <label for="combineWithPOCZipFile">Branch Excel ZIP - With Evidance*</label>
                            <input type="file" id="combineWithPOCZipFile" name="zipFile" accept=".zip" required>
                            <small class="file-help">Attached is the ZIP file containing all the Excel files for the branches, including evidence.</small>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('combineBranchExcelWithPOCModal')">Cancel</button>
                            <button type="submit" class="submit-btn" id="combineBranchExcelWithPOCSubmitBtn">Generate Report</button>
                        </div>
                        <br>
                        <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center></small>
                    </form>
                    
                    <!-- Hidden iframe for download -->
                    <iframe name="combineWithPOCDownloadFrame" style="display: none;"></iframe>
                </div>
            </div>
        </div>

        <!-- Combine Asset Review Excels Modal -->
        <div id="combineAssetReviewExcelsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Combine Asset Review Excels</h3>
                    <span class="close-modal" onclick="closeModal('combineAssetReviewExcelsModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="combineAssetReviewExcelsForm" action="/combine_assets_excels" method="POST" enctype="multipart/form-data" onsubmit="handleCombineAssetReviewExcelsSubmit(event)">
                        <!-- File Upload Section -->
                        <div class="form-group">
                            <label for="combineAssetsZipFile">All Assets - ZIP File*</label>
                            <input type="file" id="combineAssetsZipFile" name="zipFile" accept=".zip" required>
                            <small class="file-help">Please select a ZIP file (.zip) containing all separate asset files with evidence in .xlsx format. Make sure each file is named properly, such as ‘Firewall Review’ or ‘H2H Audit Review’. Incorrect file names may cause issues while generating the word report.</small>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('combineAssetReviewExcelsModal')">Cancel</button>
                            <button type="submit" class="submit-btn" id="combineAssetReviewExcelsSubmitBtn">Generate Report</button>
                        </div>
                        <br>
                        <small class="file-help" style="color: red; font-weight: bold;"><center>This tool follows the given instructions and may produce errors, so human review is mandatory. Any mistakes will be treated as human errors, and the responsible person must take accountability.</center></small>
                    </form>
                    
                    <!-- Hidden iframe for download -->
                    <iframe name="combineAssetsDownloadFrame" style="display: none;"></iframe>
                </div>
            </div>
        </div>

        <!-- Separate Assets Modal -->
        <div id="separateAssetsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Separate Assets</h3>
                    <span class="close-modal" onclick="closeModal('separateAssetsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <div class="assets-list">
                        <ol>
                            <li onclick="openModal('networkReviewQuestionsModal')" style="cursor: pointer;">Network Review</li>
                            <li onclick="openModal('dataCentreQuestionsModal')" style="cursor: pointer;">Data Centre</li>
                            <li onclick="openModal('disasterRecoveryQuestionsModal')" style="cursor: pointer;">Disaster Recovery</li>
                            <li onclick="openModal('firewallQuestionsModal')" style="cursor: pointer;">Firewall</li>
                            <li onclick="openModal('coreSwitchQuestionsModal')" style="cursor: pointer;">Core Switch</li>
                            <li onclick="openModal('routerQuestionsModal')" style="cursor: pointer;">Router</li>
                            <li onclick="openModal('domainControllerQuestionsModal')" style="cursor: pointer;">Domain Controller (AD)</li>
                            <li onclick="openModal('h2hQuestionsModal')" style="cursor: pointer;">H2H Audit</li>
                            <li onclick="openModal('antivirusQuestionsModal')" style="cursor: pointer;">Antivirus</li>
                            <li onclick="openModal('atmQuestionsModal')" style="cursor: pointer;">ATM</li>
                            <li onclick="openModal('mailMessagingQuestionsModal')" style="cursor: pointer;">Mail and Messaging</li>
                            <li onclick="openModal('hoWinServerQuestionsModal')" style="cursor: pointer;">HO Win_Server Logical Review</li>
                            <li onclick="openModal('linuxServerQuestionsModal')" style="cursor: pointer;">Linux_Server_Logical Review</li>
                            <li onclick="openModal('esxiServerQuestionsModal')" style="cursor: pointer;">ESXi Server_Logical Review</li>
                            <li onclick="openModal('accessControlOSQuestionsModal')" style="cursor: pointer;">Access Control – OS Level</li>
                            <li onclick="openModal('accessControlApplicationQuestionsModal')" style="cursor: pointer;">Access Control Application</li>
                            <li onclick="openModal('applicationQuestionsModal')" style="cursor: pointer;">Application</li>
                        <li onclick="openModal('internetBankingQuestionsModal')" style="cursor: pointer;">Internet Banking</li>
                        <li onclick="openModal('internalControlQuestionsModal')" style="cursor: pointer;">Internal Control Evaluation</li>
                        <li onclick="openModal('fireProtectionQuestionsModal')" style="cursor: pointer;">Fire Protection</li>
                        <li onclick="openModal('amcQuestionsModal')" style="cursor: pointer;">AMC</li>
                        <li onclick="openModal('dataInputControlQuestionsModal')" style="cursor: pointer;">Data Input Controls</li>
                        <li onclick="openModal('purgingDataFilesQuestionsModal')" style="cursor: pointer;">Purging of Data Files</li>
                        <li onclick="openModal('businessContinuityPlanningQuestionsModal')" style="cursor: pointer;">Business Continuity Planning</li>
                        <li onclick="openModal('inhouseOutsourcedQuestionsModal')" style="cursor: pointer;">In-house and Out-sourced</li>
                        <li onclick="openModal('auditTrailQuestionsModal')" style="cursor: pointer;">Audit Trail</li>
                        <li onclick="openModal('packagedSoftwareQuestionsModal')" style="cursor: pointer;">Packaged Software</li>
                        <li onclick="openModal('userAccountMaintenanceQuestionsModal')" style="cursor: pointer;">User Account Maintenance</li>
                        <li onclick="openModal('logicalAccessControlsQuestionsModal')" style="cursor: pointer;">Logical Access Controls</li>
                        <li onclick="openModal('databaseControlsQuestionsModal')" style="cursor: pointer;">Database Controls</li>
                        <li onclick="openModal('penetrationTestingQuestionsModal')" style="cursor: pointer;">Penetration Testing</li>
                        <li onclick="openModal('trainingQuestionsModal')" style="cursor: pointer;">Training</li>
                        <li onclick="openModal('remoteAccessQuestionsModal')" style="cursor: pointer;">Remote Access</li>
                        <li onclick="openModal('powerSupplyQuestionsModal')" style="cursor: pointer;">Power Supply (UPS)</li>
                        <li onclick="openModal('backupRestorationQuestionsModal')" style="cursor: pointer;">Backup and Restoration</li>
                        <li onclick="openModal('maintenancePatchesQuestionsModal')" style="cursor: pointer;">Maintenance & App Patches</li>
                        <li onclick="openModal('networkMonitorToolQuestionsModal')" style="cursor: pointer;">Network Monitor Tool</li>
                        <li onclick="openModal('sanSwitchCiscoQuestionsModal')" style="cursor: pointer;">SAN Switch CISCO</li>
                        <li onclick="openModal('sanStorageQuestionsModal')" style="cursor: pointer;">SAN Storage</li>
                        <li onclick="openModal('nasQuestionsModal')" style="cursor: pointer;">NAS</li>
                        <li onclick="openModal('loadBalancerArrayQuestionsModal')" style="cursor: pointer;">Load Balancer Array</li>
                        <li onclick="openModal('pamQuestionsModal')" style="cursor: pointer;">PAM</li>
                        <li onclick="openModal('socQuestionsModal')" style="cursor: pointer;">SOC</li>
                        <li onclick="openModal('changeManagementQuestionsModal')" style="cursor: pointer;">Change Management</li>
                        <li onclick="openModal('assetManagementQuestionsModal')" style="cursor: pointer;">Asset Management</li>
                        <li onclick="openModal('othersQuestionsModal')" style="cursor: pointer;">Others</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>

        <!-- Attach Evidence Asset Modal -->
        <div id="attachEvidenceAssetModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Attach Evidence in Asset Excel</h3>
                    <span class="close-modal" onclick="closeModal('attachEvidenceAssetModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <div class="assets-list">
                        <ol>
                            <li onclick="openModal('networkReviewEvidenceModal')" style="cursor: pointer;">Network Review</li>
                            <li onclick="openModal('dataCentreEvidenceModal')" style="cursor: pointer;">Data Centre</li>
                            <li onclick="openModal('disasterRecoveryEvidenceModal')" style="cursor: pointer;">Disaster Recovery</li>
                            <li onclick="openModal('firewallEvidenceModal')" style="cursor: pointer;">Firewall</li>
                            <li onclick="openModal('coreSwitchEvidenceModal')" style="cursor: pointer;">Core Switch</li>
                            <li onclick="openModal('routerEvidenceModal')" style="cursor: pointer;">Router</li>
                            <li onclick="openModal('domainControllerEvidenceModal')" style="cursor: pointer;">Domain Controller (AD)</li>
                            <li onclick="openModal('h2hEvidenceModal')" style="cursor: pointer;">H2H Audit</li>
                            <li onclick="openModal('antivirusEvidenceModal')" style="cursor: pointer;">Antivirus</li>
                            <li onclick="openModal('atmEvidenceModal')" style="cursor: pointer;">ATM</li>
                            <li onclick="openModal('mailMessagingEvidenceModal')" style="cursor: pointer;">Mail and Messaging</li>
                            <li onclick="openModal('hoWinServerEvidenceModal')" style="cursor: pointer;">HO Win_Server Logical Review</li>
                            <li onclick="openModal('linuxServerEvidenceModal')" style="cursor: pointer;">Linux_Server_Logical Review</li>
                            <li onclick="openModal('esxiServerEvidenceModal')" style="cursor: pointer;">ESXi Server_Logical Review</li>
                            <li onclick="openModal('accessControlOSEvidenceModal')" style="cursor: pointer;">Access Control – OS Level</li>
                            <li onclick="openModal('accessControlApplicationEvidenceModal')" style="cursor: pointer;">Access Control Application</li>
                            <li onclick="openModal('applicationEvidenceModal')" style="cursor: pointer;">Application</li>
                            <li onclick="openModal('internetBankingEvidenceModal')" style="cursor: pointer;">Internet Banking</li>
                            <li onclick="openModal('internalControlEvidenceModal')" style="cursor: pointer;">Internal Control Evaluation</li>
                            <li onclick="openModal('fireProtectionEvidenceModal')" style="cursor: pointer;">Fire Protection</li>
                            <li onclick="openModal('amcEvidenceModal')" style="cursor: pointer;">AMC</li>
                            <li onclick="openModal('dataInputControlEvidenceModal')" style="cursor: pointer;">Data Input Controls</li>
                            <li onclick="openModal('purgingDataFilesEvidenceModal')" style="cursor: pointer;">Purging of Data Files</li>
                            <li onclick="openModal('businessContinuityPlanningEvidenceModal')" style="cursor: pointer;">Business Continuity Planning</li>
                            <li onclick="openModal('inhouseOutsourcedEvidenceModal')" style="cursor: pointer;">In-house and Out-sourced</li>
                            <li onclick="openModal('auditTrailEvidenceModal')" style="cursor: pointer;">Audit Trail</li>
                            <li onclick="openModal('packagedSoftwareEvidenceModal')" style="cursor: pointer;">Packaged Software</li>
                            <li onclick="openModal('userAccountMaintenanceEvidenceModal')" style="cursor: pointer;">User Account Maintenance</li>
                            <li onclick="openModal('logicalAccessControlsEvidenceModal')" style="cursor: pointer;">Logical Access Controls</li>
                            <li onclick="openModal('databaseControlsEvidenceModal')" style="cursor: pointer;">Database Controls</li>
                            <li onclick="openModal('penetrationTestingEvidenceModal')" style="cursor: pointer;">Penetration Testing</li>
                            <li onclick="openModal('trainingEvidenceModal')" style="cursor: pointer;">Training</li>
                            <li onclick="openModal('remoteAccessEvidenceModal')" style="cursor: pointer;">Remote Access</li>
                            <li onclick="openModal('powerSupplyEvidenceModal')" style="cursor: pointer;">Power Supply (UPS)</li>
                            <li onclick="openModal('backupRestorationEvidenceModal')" style="cursor: pointer;">Backup and Restoration</li>
                            <li onclick="openModal('maintenancePatchesEvidenceModal')" style="cursor: pointer;">Maintenance & App Patches</li>
                            <li onclick="openModal('networkMonitorToolEvidenceModal')" style="cursor: pointer;">Network Monitor Tool</li>
                            <li onclick="openModal('sanSwitchCiscoEvidenceModal')" style="cursor: pointer;">SAN Switch CISCO</li>
                            <li onclick="openModal('sanStorageEvidenceModal')" style="cursor: pointer;">SAN Storage</li>
                            <li onclick="openModal('nasEvidenceModal')" style="cursor: pointer;">NAS</li>
                            <li onclick="openModal('loadBalancerArrayEvidenceModal')" style="cursor: pointer;">Load Balancer Array</li>
                            <li onclick="openModal('pamEvidenceModal')" style="cursor: pointer;">PAM</li>
                            <li onclick="openModal('socEvidenceModal')" style="cursor: pointer;">SOC</li>
                            <li onclick="openModal('changeManagementEvidenceModal')" style="cursor: pointer;">Change Management</li>
                            <li onclick="openModal('assetManagementEvidenceModal')" style="cursor: pointer;">Asset Management</li>
                            <li onclick="openModal('othersEvidenceModal')" style="cursor: pointer;">Others</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>

        <!-- Network Review Evidence Modal -->
        <div id="networkReviewEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Network Review - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('networkReviewEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="networkReviewEvidenceForm" action="/process_network_review_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleNetworkReviewEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="excelFile" class="form-label">Network Review Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="excelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file which is for the Network Review.</small>
                        </div>

                        <div class="form-group">
                            <label for="zipFile" class="form-label">Network Review Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="zipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Network Review Questions pop-up. For example, for the question “1.1 Whether the Secondary Connectivity is available or not?*”, the corresponding evidence image must be named starting with “1.1”. Accepted file name formats include examples such as 1.1.jpg, 1.1.png, 1.1 sdbvjdsbvb.png, or 1.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('networkReviewEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Data Centre Evidence Modal -->
        <div id="dataCentreEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Data Centre - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('dataCentreEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="dataCentreEvidenceForm" action="/process_data_centre_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleDataCentreEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="dataCentreExcelFile" class="form-label">Data Centre Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="dataCentreExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file which is for the Data Centre.</small>
                        </div>

                        <div class="form-group">
                            <label for="dataCentreZipFile" class="form-label">Data Centre Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="dataCentreZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Data Centre Questions pop-up. For example, for the question "2.1 Is there a separate room for the server?*", the corresponding evidence image must be named starting with "2.1". Accepted file name formats include examples such as 2.1.jpg, 2.1.png, 2.1 sdbvjdsbvb.png, or 2.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('dataCentreEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Disaster Recovery Evidence Modal -->
        <div id="disasterRecoveryEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Disaster Recovery - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('disasterRecoveryEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="disasterRecoveryEvidenceForm" action="/process_disaster_recovery_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleDisasterRecoveryEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="disasterRecoveryExcelFile" class="form-label">Disaster Recovery Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="disasterRecoveryExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Disaster Recovery data</small>
                        </div>

                        <div class="form-group">
                            <label for="disasterRecoveryZipFile" class="form-label">Disaster Recovery Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="disasterRecoveryZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Disaster Recovery Questions pop-up. For example, for the question "3.1 Is there a separate room for the server?*", the corresponding evidence image must be named starting with "3.1". Accepted file name formats include examples such as 3.1.jpg, 3.1.png, 3.1 sdbvjdsbvb.png, or 3.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('disasterRecoveryEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Firewall Evidence Modal -->
        <div id="firewallEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Firewall - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('firewallEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="firewallEvidenceForm" action="/process_firewall_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleFirewallEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="firewallExcelFile" class="form-label">Firewall Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="firewallExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Firewall data</small>
                        </div>

                        <div class="form-group">
                            <label for="firewallZipFile" class="form-label">Firewall Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="firewallZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Firewall Questions pop-up. For example, for the question "4.1 Is the firewall in HA (High Availability) mode?", the corresponding evidence image must be named starting with "4.1". Accepted file name formats include examples such as 4.1.jpg, 4.1.png, 4.1 sdbvjdsbvb.png, or 4.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('firewallEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Core Switch Evidence Modal -->
        <div id="coreSwitchEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Core Switch - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('coreSwitchEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="coreSwitchEvidenceForm" action="/process_core_switch_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleCoreSwitchEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="coreSwitchExcelFile" class="form-label">Core Switch Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="coreSwitchExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Core Switch data</small>
                        </div>

                        <div class="form-group">
                            <label for="coreSwitchZipFile" class="form-label">Core Switch Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="coreSwitchZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Core Switch Questions pop-up. For example, for the question "5.1 Is Inbound TCP Connection Keep Alives message disabled?", the corresponding evidence image must be named starting with "5.1". Accepted file name formats include examples such as 5.1.jpg, 5.1.png, 5.1 sdbvjdsbvb.png, or 5.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('coreSwitchEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Router Evidence Modal -->
        <div id="routerEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Router - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('routerEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="routerEvidenceForm" action="/process_router_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleRouterEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="routerExcelFile" class="form-label">Router Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="routerExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Router data</small>
                        </div>

                        <div class="form-group">
                            <label for="routerZipFile" class="form-label">Router Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="routerZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Router Questions pop-up. For example, for the question "6.1 Whether Router is used to provide Wi-Fi?", the corresponding evidence image must be named starting with "6.1". Accepted file name formats include examples such as 6.1.jpg, 6.1.png, 6.1 sdbvjdsbvb.png, or 6.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('routerEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Domain Controller Evidence Modal -->
        <div id="domainControllerEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Domain Controller - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('domainControllerEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="domainControllerEvidenceForm" action="/process_domain_controller_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleDomainControllerEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="domainControllerExcelFile" class="form-label">Domain Controller Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="domainControllerExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Domain Controller data</small>
                        </div>

                        <div class="form-group">
                            <label for="domainControllerZipFile" class="form-label">Domain Controller Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="domainControllerZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Domain Controller (AD) Questions pop-up. For example, for the question "7.1 Are scheduled tasks set to Disabled for server operators on the domain controller?", the corresponding evidence image must be named starting with "7.1". Accepted file name formats include examples such as 7.1.jpg, 7.1.png, 7.1 sdbvjdsbvb.png, or 7.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('domainControllerEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- H2H Audit Evidence Modal -->
        <div id="h2hEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>H2H Audit - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('h2hEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="h2hEvidenceForm" action="/process_h2h_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleH2HEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="h2hExcelFile" class="form-label">H2H Audit Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="h2hExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the H2H Audit data</small>
                        </div>

                        <div class="form-group">
                            <label for="h2hZipFile" class="form-label">H2H Audit Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="h2hZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the H2H Audit Questions pop-up. For example, for the question "8.1 Is an administrative portal login accessed only by Whitelisted IP Addresses?", the corresponding evidence image must be named starting with "8.1". Accepted file name formats include examples such as 8.1.jpg, 8.1.png, 8.1 sdbvjdsbvb.png, or 8.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('h2hEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Antivirus Evidence Modal -->
        <div id="antivirusEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Antivirus - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('antivirusEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="antivirusEvidenceForm" action="/process_antivirus_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleAntivirusEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="antivirusExcelFile" class="form-label">Antivirus Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="antivirusExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Antivirus data</small>
                        </div>

                        <div class="form-group">
                            <label for="antivirusZipFile" class="form-label">Antivirus Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="antivirusZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Antivirus Questions pop-up. For example, for the question "9.1 Is the antivirus available?", the corresponding evidence image must be named starting with "9.1". Accepted file name formats include examples such as 9.1.jpg, 9.1.png, 9.1 sdbvjdsbvb.png, or 9.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('antivirusEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- ATM Evidence Modal -->
        <div id="atmEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>ATM - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('atmEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="atmEvidenceForm" action="/process_atm_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleATMEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="atmExcelFile" class="form-label">ATM Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="atmExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the ATM data</small>
                        </div>

                        <div class="form-group">
                            <label for="atmZipFile" class="form-label">ATM Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="atmZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the ATM Questions pop-up. For example, for the question "10.1 Are there any physical, local attacks that target account data/card readers?", the corresponding evidence image must be named starting with "10.1". Accepted file name formats include examples such as 10.1.jpg, 10.1.png, 10.1 sdbvjdsbvb.png, or 10.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('atmEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Mail and Messaging Evidence Modal -->
        <div id="mailMessagingEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Mail and Messaging - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('mailMessagingEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="mailMessagingEvidenceForm" action="/process_mail_messaging_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleMailMessagingEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="mailMessagingExcelFile" class="form-label">Mail and Messaging Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="mailMessagingExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Mail and Messaging data</small>
                        </div>

                        <div class="form-group">
                            <label for="mailMessagingZipFile" class="form-label">Mail and Messaging Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="mailMessagingZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Mail and Messaging Questions pop-up. For example, for the question "11.1 Is Public Domain Email used?", the corresponding evidence image must be named starting with "11.1". Accepted file name formats include examples such as 11.1.jpg, 11.1.png, 11.1 sdbvjdsbvb.png, or 11.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('mailMessagingEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- HO Win_Server Logical Review Evidence Modal -->
        <div id="hoWinServerEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>HO Win_Server Logical Review - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('hoWinServerEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="hoWinServerEvidenceForm" action="/process_ho_win_server_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleHoWinServerEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="hoWinServerExcelFile" class="form-label">HO Win_Server Logical Review Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="hoWinServerExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the HO Win_Server Logical Review data</small>
                        </div>

                        <div class="form-group">
                            <label for="hoWinServerZipFile" class="form-label">HO Win_Server Logical Review Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="hoWinServerZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the HO Win_Server Logical Review Questions pop-up. For example, for the question "12.1 Is Antivirus installed on the server?", the corresponding evidence image must be named starting with "12.1". Accepted file name formats include examples such as 12.1.jpg, 12.1.png, 12.1 sdbvjdsbvb.png, or 12.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('hoWinServerEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Linux_Server_Logical Review Evidence Modal -->
        <div id="linuxServerEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Linux_Server_Logical Review - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('linuxServerEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="linuxServerEvidenceForm" action="/process_linux_server_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleLinuxServerEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="linuxServerExcelFile" class="form-label">Linux_Server_Logical Review Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="linuxServerExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Linux_Server_Logical Review data</small>
                        </div>

                        <div class="form-group">
                            <label for="linuxServerZipFile" class="form-label">Linux_Server_Logical Review Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="linuxServerZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Linux_Server_Logical Review Questions pop-up. For example, for the question "13.1 Is there a separate room for the server?", the corresponding evidence image must be named starting with "13.1". Accepted file name formats include examples such as 13.1.jpg, 13.1.png, 13.1 sdbvjdsbvb.png, or 13.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('linuxServerEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- ESXi Server_Logical Review Evidence Modal -->
        <div id="esxiServerEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>ESXi Server_Logical Review - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('esxiServerEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="esxiServerEvidenceForm" action="/process_esxi_server_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleEsxiServerEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="esxiServerExcelFile" class="form-label">ESXi Server_Logical Review Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="esxiServerExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the ESXi Server_Logical Review data</small>
                        </div>

                        <div class="form-group">
                            <label for="esxiServerZipFile" class="form-label">ESXi Server_Logical Review Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="esxiServerZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the ESXi Server_Logical Review Questions pop-up. For example, for the question "14.1 Is there a separate room for the server?", the corresponding evidence image must be named starting with "14.1". Accepted file name formats include examples such as 14.1.jpg, 14.1.png, 14.1 sdbvjdsbvb.png, or 14.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('esxiServerEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Access Control – OS Level Evidence Modal -->
        <div id="accessControlOSEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Access Control – OS Level - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('accessControlOSEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="accessControlOSEvidenceForm" action="/process_access_control_os_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleAccessControlOSEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="accessControlOSExcelFile" class="form-label">Access Control – OS Level Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="accessControlOSExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Access Control – OS Level data</small>
                        </div>

                        <div class="form-group">
                            <label for="accessControlOSZipFile" class="form-label">Access Control – OS Level Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="accessControlOSZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Access Control – OS Level Questions pop-up. For example, for the question "15.1 Is access to the systems only through password-protected user IDs?", the corresponding evidence image must be named starting with "15.1". Accepted file name formats include examples such as 15.1.jpg, 15.1.png, 15.1 sdbvjdsbvb.png, or 15.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('accessControlOSEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Access Control Application Evidence Modal -->
        <div id="accessControlApplicationEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Access Control Application - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('accessControlApplicationEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="accessControlApplicationEvidenceForm" action="/process_access_control_application_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleAccessControlApplicationEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="accessControlApplicationExcelFile" class="form-label">Access Control Application Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="accessControlApplicationExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Access Control Application data</small>
                        </div>

                        <div class="form-group">
                            <label for="accessControlApplicationZipFile" class="form-label">Access Control Application Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="accessControlApplicationZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Access Control Application Questions pop-up. For example, for the question "16.1 Does the system provide unique user IDs and passwords for all users?", the corresponding evidence image must be named starting with "16.1". Accepted file name formats include examples such as 16.1.jpg, 16.1.png, 16.1 sdbvjdsbvb.png, or 16.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('accessControlApplicationEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Application Evidence Modal -->
        <div id="applicationEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Application - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('applicationEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="applicationEvidenceForm" action="/process_application_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleApplicationEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="applicationExcelFile" class="form-label">Application Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="applicationExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Application data</small>
                        </div>

                        <div class="form-group">
                            <label for="applicationZipFile" class="form-label">Application Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="applicationZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Application Questions pop-up. For example, for the question "17.1 Verify whether the password is displayed in an encrypted format or not?", the corresponding evidence image must be named starting with "17.1". Accepted file name formats include examples such as 17.1.jpg, 17.1.png, 17.1 sdbvjdsbvb.png, or 17.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('applicationEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Internet Banking Evidence Modal -->
        <div id="internetBankingEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Internet Banking - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('internetBankingEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="internetBankingEvidenceForm" action="/process_internet_banking_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleInternetBankingEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="internetBankingExcelFile" class="form-label">Internet Banking Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="internetBankingExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Internet Banking data</small>
                        </div>

                        <div class="form-group">
                            <label for="internetBankingZipFile" class="form-label">Internet Banking Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="internetBankingZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Internet Banking Questions pop-up. For example, for the question "18.1 Are server and database separate with VLANs?", the corresponding evidence image must be named starting with "18.1". Accepted file name formats include examples such as 18.1.jpg, 18.1.png, 18.1 sdbvjdsbvb.png, or 18.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('internetBankingEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Internal Control Evaluation Evidence Modal -->
        <div id="internalControlEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Internal Control Evaluation - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('internalControlEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="internalControlEvidenceForm" action="/process_internal_control_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleInternalControlEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="internalControlExcelFile" class="form-label">Internal Control Evaluation Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="internalControlExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Internal Control Evaluation data</small>
                        </div>

                        <div class="form-group">
                            <label for="internalControlZipFile" class="form-label">Internal Control Evaluation Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="internalControlZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Internal Control Evaluation Questions pop-up. For example, for the question "19.1 Are the internal controls in place to provide reliance on the control procedures for the information/evidence gathered during the audit?", the corresponding evidence image must be named starting with "19.1". Accepted file name formats include examples such as 19.1.jpg, 19.1.png, 19.1 sdbvjdsbvb.png, or 19.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('internalControlEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Fire Protection Evidence Modal -->
        <div id="fireProtectionEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Fire Protection - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('fireProtectionEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="fireProtectionEvidenceForm" action="/process_fire_protection_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleFireProtectionEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="fireProtectionExcelFile" class="form-label">Fire Protection Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="fireProtectionExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Fire Protection data</small>
                        </div>

                        <div class="form-group">
                            <label for="fireProtectionZipFile" class="form-label">Fire Protection Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="fireProtectionZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Fire Protection Questions pop-up. For example, for the question "20.1 Is the fire alarm system installed?", the corresponding evidence image must be named starting with "20.1". Accepted file name formats include examples such as 20.1.jpg, 20.1.png, 20.1 sdbvjdsbvb.png, or 20.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('fireProtectionEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- AMC Evidence Modal -->
        <div id="amcEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>AMC - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('amcEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="amcEvidenceForm" action="/process_amc_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleAmcEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="amcExcelFile" class="form-label">AMC Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="amcExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the AMC data</small>
                        </div>

                        <div class="form-group">
                            <label for="amcZipFile" class="form-label">AMC Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="amcZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the AMC Questions pop-up. For example, for the question "21.1 Is access for maintenance purposes granted only after verifying the identity of the service person?", the corresponding evidence image must be named starting with "21.1". Accepted file name formats include examples such as 21.1.jpg, 21.1.png, 21.1 sdbvjdsbvb.png, or 21.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('amcEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Data Input Controls Evidence Modal -->
        <div id="dataInputControlEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Data Input Controls - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('dataInputControlEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="dataInputControlEvidenceForm" action="/process_data_input_control_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleDataInputControlEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="dataInputControlExcelFile" class="form-label">Data Input Controls Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="dataInputControlExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Data Input Controls data</small>
                        </div>

                        <div class="form-group">
                            <label for="dataInputControlZipFile" class="form-label">Data Input Controls Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="dataInputControlZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Data Input Controls Questions pop-up. For example, for the question "22.1 Is the history of signatures scanned available in the system?", the corresponding evidence image must be named starting with "22.1". Accepted file name formats include examples such as 22.1.jpg, 22.1.png, 22.1 sdbvjdsbvb.png, or 22.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('dataInputControlEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Purging of Data Files Evidence Modal -->
        <div id="purgingDataFilesEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Purging of Data Files - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('purgingDataFilesEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="purgingDataFilesEvidenceForm" action="/process_purging_data_files_evidence" method="POST" enctype="multipart/form-data" onsubmit="handlePurgingDataFilesEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="purgingDataFilesExcelFile" class="form-label">Purging of Data Files Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="purgingDataFilesExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Purging of Data Files data</small>
                        </div>

                        <div class="form-group">
                            <label for="purgingDataFilesZipFile" class="form-label">Purging of Data Files Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="purgingDataFilesZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Purging of Data Files Questions pop-up. For example, for the question "23.1 Is purged backup media kept properly under safe custody?", the corresponding evidence image must be named starting with "23.1". Accepted file name formats include examples such as 23.1.jpg, 23.1.png, 23.1 sdbvjdsbvb.png, or 23.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('purgingDataFilesEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Business Continuity Planning Evidence Modal -->
        <div id="businessContinuityPlanningEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Business Continuity Planning - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('businessContinuityPlanningEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="businessContinuityPlanningEvidenceForm" action="/process_business_continuity_planning_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleBusinessContinuityPlanningEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="businessContinuityPlanningExcelFile" class="form-label">Business Continuity Planning Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="businessContinuityPlanningExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Business Continuity Planning data</small>
                        </div>

                        <div class="form-group">
                            <label for="businessContinuityPlanningZipFile" class="form-label">Business Continuity Planning Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="businessContinuityPlanningZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Business Continuity Planning Questions pop-up. For example, for the question "24.1 Has the business continuity plan (BCP) been documented?", the corresponding evidence image must be named starting with "24.1". Accepted file name formats include examples such as 24.1.jpg, 24.1.png, 24.1 sdbvjdsbvb.png, or 24.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('businessContinuityPlanningEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- In-house and Out-sourced Evidence Modal -->
        <div id="inhouseOutsourcedEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>In-house and Out-sourced - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('inhouseOutsourcedEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="inhouseOutsourcedEvidenceForm" action="/process_inhouse_outsourced_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleInhouseOutsourcedEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="inhouseOutsourcedExcelFile" class="form-label">In-house and Out-sourced Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="inhouseOutsourcedExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the In-house and Out-sourced data</small>
                        </div>

                        <div class="form-group">
                            <label for="inhouseOutsourcedZipFile" class="form-label">In-house and Out-sourced Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="inhouseOutsourcedZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the In-house and Out-sourced Questions pop-up. For example, for the question "25.1 Is the software designed using pre-defined formats at three levels: program level, application level, and organization level?", the corresponding evidence image must be named starting with "25.1". Accepted file name formats include examples such as 25.1.jpg, 25.1.png, 25.1 sdbvjdsbvb.png, or 25.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('inhouseOutsourcedEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Audit Trail Evidence Modal -->
        <div id="auditTrailEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Audit Trail - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('auditTrailEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="auditTrailEvidenceForm" action="/process_audit_trail_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleAuditTrailEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="auditTrailExcelFile" class="form-label">Audit Trail Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="auditTrailExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Audit Trail data</small>
                        </div>

                        <div class="form-group">
                            <label for="auditTrailZipFile" class="form-label">Audit Trail Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="auditTrailZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Audit Trail Questions pop-up. For example, for the question "26.1 Does the audit trail report generate the user ID of the operator and official for any addition/modification/deletion of transaction data in the database?", the corresponding evidence image must be named starting with "26.1". Accepted file name formats include examples such as 26.1.jpg, 26.1.png, 26.1 sdbvjdsbvb.png, or 26.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('auditTrailEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Packaged Software Evidence Modal -->
        <div id="packagedSoftwareEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Packaged Software - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('packagedSoftwareEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="packagedSoftwareEvidenceForm" action="/process_packaged_software_evidence" method="POST" enctype="multipart/form-data" onsubmit="handlePackagedSoftwareEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="packagedSoftwareExcelFile" class="form-label">Packaged Software Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="packagedSoftwareExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Packaged Software data</small>
                        </div>

                        <div class="form-group">
                            <label for="packagedSoftwareZipFile" class="form-label">Packaged Software Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="packagedSoftwareZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Packaged Software Questions pop-up. For example, for the question "27.1 Is the plan in line with the bank's overall IS strategy?", the corresponding evidence image must be named starting with "27.1". Accepted file name formats include examples such as 27.1.jpg, 27.1.png, 27.1 sdbvjdsbvb.png, or 27.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('packagedSoftwareEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- User Account Maintenance Evidence Modal -->
        <div id="userAccountMaintenanceEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>User Account Maintenance - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('userAccountMaintenanceEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="userAccountMaintenanceEvidenceForm" action="/process_user_account_maintenance_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleUserAccountMaintenanceEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="userAccountMaintenanceExcelFile" class="form-label">User Account Maintenance Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="userAccountMaintenanceExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the User Account Maintenance data</small>
                        </div>

                        <div class="form-group">
                            <label for="userAccountMaintenanceZipFile" class="form-label">User Account Maintenance Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="userAccountMaintenanceZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the User Account Maintenance Questions pop-up. For example, for the question "28.1 Is every user ID at the operating system level created only after specific approval from the Branch Manager/Department Head in writing on a request form signed by the respective user?", the corresponding evidence image must be named starting with "28.1". Accepted file name formats include examples such as 28.1.jpg, 28.1.png, 28.1 sdbvjdsbvb.png, or 28.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('userAccountMaintenanceEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Logical Access Controls Evidence Modal -->
        <div id="logicalAccessControlsEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Logical Access Controls - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('logicalAccessControlsEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="logicalAccessControlsEvidenceForm" action="/process_logical_access_controls_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleLogicalAccessControlsEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="logicalAccessControlsExcelFile" class="form-label">Logical Access Controls Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="logicalAccessControlsExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Logical Access Controls data</small>
                        </div>

                        <div class="form-group">
                            <label for="logicalAccessControlsZipFile" class="form-label">Logical Access Controls Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="logicalAccessControlsZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Logical Access Controls Questions pop-up. For example, for the question "29.1 Is access to the operating system command prompt disabled for general users in the branch/office?", the corresponding evidence image must be named starting with "29.1". Accepted file name formats include examples such as 29.1.jpg, 29.1.png, 29.1 sdbvjdsbvb.png, or 29.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('logicalAccessControlsEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Database Controls Evidence Modal -->
        <div id="databaseControlsEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Database Controls - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('databaseControlsEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="databaseControlsEvidenceForm" action="/process_database_controls_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleDatabaseControlsEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="databaseControlsExcelFile" class="form-label">Database Controls Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="databaseControlsExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Database Controls data</small>
                        </div>

                        <div class="form-group">
                            <label for="databaseControlsZipFile" class="form-label">Database Controls Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="databaseControlsZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Database Controls Questions pop-up. For example, for the question "30.1 Is there a backup schedule?", the corresponding evidence image must be named starting with "30.1". Accepted file name formats include examples such as 30.1.jpg, 30.1.png, 30.1 sdbvjdsbvb.png, or 30.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('databaseControlsEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Penetration Testing Evidence Modal -->
        <div id="penetrationTestingEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Penetration Testing - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('penetrationTestingEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="penetrationTestingEvidenceForm" action="/process_penetration_testing_evidence" method="POST" enctype="multipart/form-data" onsubmit="handlePenetrationTestingEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="penetrationTestingExcelFile" class="form-label">Penetration Testing Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="penetrationTestingExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Penetration Testing data</small>
                        </div>

                        <div class="form-group">
                            <label for="penetrationTestingZipFile" class="form-label">Penetration Testing Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="penetrationTestingZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Penetration Testing Questions pop-up. For example, for the question "31.1 Is it ensured that products/services using the Internet for connectivity or communications have undergone a successful penetration test prior to production implementation?", the corresponding evidence image must be named starting with "31.1". Accepted file name formats include examples such as 31.1.jpg, 31.1.png, 31.1 sdbvjdsbvb.png, or 31.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('penetrationTestingEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Training Evidence Modal -->
        <div id="trainingEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Training - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('trainingEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="trainingEvidenceForm" action="/process_training_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleTrainingEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="trainingExcelFile" class="form-label">Training Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="trainingExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Training data</small>
                        </div>

                        <div class="form-group">
                            <label for="trainingZipFile" class="form-label">Training Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="trainingZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Training Questions pop-up. For example, for the question "32.1 Are users given adequate training on the application systems' functionalities?", the corresponding evidence image must be named starting with "32.1". Accepted file name formats include examples such as 32.1.jpg, 32.1.png, 32.1 sdbvjdsbvb.png, or 32.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('trainingEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Remote Access Evidence Modal -->
        <div id="remoteAccessEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Remote Access - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('remoteAccessEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="remoteAccessEvidenceForm" action="/process_remote_access_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleRemoteAccessEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="remoteAccessExcelFile" class="form-label">Remote Access Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="remoteAccessExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Remote Access data</small>
                        </div>

                        <div class="form-group">
                            <label for="remoteAccessZipFile" class="form-label">Remote Access Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="remoteAccessZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Remote Access Questions pop-up. For example, for the question "33.1 Whether remote access logs are maintained and reviewed periodically?", the corresponding evidence image must be named starting with "33.1". Accepted file name formats include examples such as 33.1.jpg, 33.1.png, 33.1 sdbvjdsbvb.png, or 33.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('remoteAccessEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Power Supply (UPS) Evidence Modal -->
        <div id="powerSupplyEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Power Supply (UPS) - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('powerSupplyEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="powerSupplyEvidenceForm" action="/process_power_supply_evidence" method="POST" enctype="multipart/form-data" onsubmit="handlePowerSupplyEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="powerSupplyExcelFile" class="form-label">Power Supply (UPS) Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="powerSupplyExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Power Supply (UPS) data</small>
                        </div>

                        <div class="form-group">
                            <label for="powerSupplyZipFile" class="form-label">Power Supply (UPS) Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="powerSupplyZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Power Supply (UPS) Questions pop-up. For example, for the question "34.1 Is there a separate enclosure and locking arrangement for the UPS?", the corresponding evidence image must be named starting with "34.1". Accepted file name formats include examples such as 34.1.jpg, 34.1.png, 34.1 sdbvjdsbvb.png, or 34.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('powerSupplyEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Backup and Restoration Evidence Modal -->
        <div id="backupRestorationEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Backup and Restoration - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('backupRestorationEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="backupRestorationEvidenceForm" action="/process_backup_restoration_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleBackupRestorationEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="backupRestorationExcelFile" class="form-label">Backup and Restoration Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="backupRestorationExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Backup and Restoration data</small>
                        </div>

                        <div class="form-group">
                            <label for="backupRestorationZipFile" class="form-label">Backup and Restoration Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="backupRestorationZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Backup and Restoration Questions pop-up. For example, for the question "35.1 Are all the floppies/CDs/tapes purchased for OS software, application software, utility programs, drivers, etc., recorded in a register and properly stored?", the corresponding evidence image must be named starting with "35.1". Accepted file name formats include examples such as 35.1.jpg, 35.1.png, 35.1 sdbvjdsbvb.png, or 35.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('backupRestorationEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Maintenance & App Patches Evidence Modal -->
        <div id="maintenancePatchesEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Maintenance & App Patches - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('maintenancePatchesEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="maintenancePatchesEvidenceForm" action="/process_maintenance_patches_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleMaintenancePatchesEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="maintenancePatchesExcelFile" class="form-label">Maintenance & App Patches Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="maintenancePatchesExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Maintenance & App Patches data</small>
                        </div>

                        <div class="form-group">
                            <label for="maintenancePatchesZipFile" class="form-label">Maintenance & App Patches Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="maintenancePatchesZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Maintenance & App Patches Questions pop-up. For example, for the question "36.1 Is the system configuration such as memory, clock speed, hard disk size, and OS version as per the order or terms stipulated by CPPD / IT Department?", the corresponding evidence image must be named starting with "36.1". Accepted file name formats include examples such as 36.1.jpg, 36.1.png, 36.1 sdbvjdsbvb.png, or 36.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('maintenancePatchesEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Network Monitor Tool Evidence Modal -->
        <div id="networkMonitorToolEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Network Monitor Tool - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('networkMonitorToolEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="networkMonitorToolEvidenceForm" action="/process_network_monitoring_tool_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleNetworkMonitorToolEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="networkMonitorToolExcelFile" class="form-label">Network Monitor Tool Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="networkMonitorToolExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Network Monitor Tool data</small>
                        </div>

                        <div class="form-group">
                            <label for="networkMonitorToolZipFile" class="form-label">Network Monitor Tool Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="networkMonitorToolZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Network Monitor Tool Questions pop-up. For example, for the question "37.1 Does the bank have a Network Monitoring Tool implemented?", the corresponding evidence image must be named starting with "37.1". Accepted file name formats include examples such as 37.1.jpg, 37.1.png, 37.1 sdbvjdsbvb.png, or 37.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('networkMonitorToolEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- SAN Switch CISCO Evidence Modal -->
        <div id="sanSwitchCiscoEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>SAN Switch CISCO - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('sanSwitchCiscoEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="sanSwitchCiscoEvidenceForm" action="/process_san_switch_cisco_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleSanSwitchCiscoEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="sanSwitchCiscoExcelFile" class="form-label">SAN Switch CISCO Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="sanSwitchCiscoExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the SAN Switch CISCO data</small>
                        </div>

                        <div class="form-group">
                            <label for="sanSwitchCiscoZipFile" class="form-label">SAN Switch CISCO Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="sanSwitchCiscoZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the SAN Switch CISCO Questions pop-up. For example, for the question "38.1 Is telnet service enabled?", the corresponding evidence image must be named starting with "38.1". Accepted file name formats include examples such as 38.1.jpg, 38.1.png, 38.1 sdbvjdsbvb.png, or 38.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('sanSwitchCiscoEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- SAN Storage Evidence Modal -->
        <div id="sanStorageEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>SAN Storage - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('sanStorageEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="sanStorageEvidenceForm" action="/process_san_storage_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleSanStorageEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="sanStorageExcelFile" class="form-label">SAN Storage Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="sanStorageExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the SAN Storage data</small>
                        </div>

                        <div class="form-group">
                            <label for="sanStorageZipFile" class="form-label">SAN Storage Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="sanStorageZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the SAN Storage Questions pop-up. For example, for the question "39.1 Is an administrative portal login accessed only by whitelisted IP addresses?", the corresponding evidence image must be named starting with "39.1". Accepted file name formats include examples such as 39.1.jpg, 39.1.png, 39.1 sdbvjdsbvb.png, or 39.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('sanStorageEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- NAS Evidence Modal -->
        <div id="nasEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>NAS - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('nasEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="nasEvidenceForm" action="/process_nas_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleNasEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="nasExcelFile" class="form-label">NAS Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="nasExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the NAS data</small>
                        </div>

                        <div class="form-group">
                            <label for="nasZipFile" class="form-label">NAS Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="nasZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the NAS Questions pop-up. For example, for the question "40.1 Is an administrative portal login accessed only by Whitelisted IP Addresses?", the corresponding evidence image must be named starting with "40.1". Accepted file name formats include examples such as 40.1.jpg, 40.1.png, 40.1 sdbvjdsbvb.png, or 40.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('nasEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Load Balancer Array Evidence Modal -->
        <div id="loadBalancerArrayEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Load Balancer Array - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('loadBalancerArrayEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="loadBalancerArrayEvidenceForm" action="/process_load_balancer_array_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleLoadBalancerArrayEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="loadBalancerArrayExcelFile" class="form-label">Load Balancer Array Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="loadBalancerArrayExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Load Balancer Array data</small>
                        </div>

                        <div class="form-group">
                            <label for="loadBalancerArrayZipFile" class="form-label">Load Balancer Array Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="loadBalancerArrayZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Load Balancer Array Questions pop-up. For example, for the question "41.1 Is an administrative portal login accessed only by Whitelisted IP Addresses?", the corresponding evidence image must be named starting with "41.1". Accepted file name formats include examples such as 41.1.jpg, 41.1.png, 41.1 sdbvjdsbvb.png, or 41.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('loadBalancerArrayEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- PAM Evidence Modal -->
        <div id="pamEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>PAM - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('pamEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="pamEvidenceForm" action="/process_pam_evidence" method="POST" enctype="multipart/form-data" onsubmit="handlePamEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="pamExcelFile" class="form-label">PAM Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="pamExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the PAM data</small>
                        </div>

                        <div class="form-group">
                            <label for="pamZipFile" class="form-label">PAM Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="pamZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the PAM Questions pop-up. For example, for the question "42.1 Is Access to all servers, databases, network devices, and critical devices managed through PAM solution?", the corresponding evidence image must be named starting with "42.1". Accepted file name formats include examples such as 42.1.jpg, 42.1.png, 42.1 sdbvjdsbvb.png, or 42.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('pamEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- SOC Evidence Modal -->
        <div id="socEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>SOC - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('socEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="socEvidenceForm" action="/process_soc_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleSocEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="socExcelFile" class="form-label">SOC Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="socExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the SOC data</small>
                        </div>

                        <div class="form-group">
                            <label for="socZipFile" class="form-label">SOC Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="socZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the SOC Questions pop-up. For example, for the question "43.1 Real Time Protection/Detection available or not?", the corresponding evidence image must be named starting with "43.1". Accepted file name formats include examples such as 43.1.jpg, 43.1.png, 43.1 sdbvjdsbvb.png, or 43.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('socEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Change Management Evidence Modal -->
        <div id="changeManagementEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Change Management - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('changeManagementEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="changeManagementEvidenceForm" action="/process_change_management_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleChangeManagementEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="changeManagementExcelFile" class="form-label">Change Management Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="changeManagementExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Change Management data</small>
                        </div>

                        <div class="form-group">
                            <label for="changeManagementZipFile" class="form-label">Change Management Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="changeManagementZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Change Management Questions pop-up. For example, for the question "44.1 Are changes made with proper approval from authorities and communicated to all the respective personnel that may get affected by the changes made?", the corresponding evidence image must be named starting with "44.1". Accepted file name formats include examples such as 44.1.jpg, 44.1.png, 44.1 sdbvjdsbvb.png, or 44.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('changeManagementEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Asset Management Evidence Modal -->
        <div id="assetManagementEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Asset Management - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('assetManagementEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="assetManagementEvidenceForm" action="/process_asset_management_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleAssetManagementEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="assetManagementExcelFile" class="form-label">Asset Management Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="assetManagementExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Asset Management data</small>
                        </div>

                        <div class="form-group">
                            <label for="assetManagementZipFile" class="form-label">Asset Management Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="assetManagementZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Asset Management Questions pop-up. For example, for the question "45.1 Whether IT assets have been documented in a separate Inventory Register or Asset Inventory Management tool/software?", the corresponding evidence image must be named starting with "45.1". Accepted file name formats include examples such as 45.1.jpg, 45.1.png, 45.1 sdbvjdsbvb.png, or 45.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('assetManagementEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Others Evidence Modal -->
        <div id="othersEvidenceModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Others - Evidence</h3>
                    <span class="close-modal" onclick="closeModal('othersEvidenceModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="othersEvidenceForm" action="/process_others_evidence" method="POST" enctype="multipart/form-data" onsubmit="handleOthersEvidenceSubmit(event)">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                        </div>

                        <div class="form-group">
                            <label for="othersExcelFile" class="form-label">Others Excel File (.xlsx, .xls)*</label>
                            <input type="file" id="othersExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                            <small class="form-help">Please upload the Excel file containing the Others data</small>
                        </div>

                        <div class="form-group">
                            <label for="othersZipFile" class="form-label">Others Evidance - ZIP File (.zip)*</label>
                            <input type="file" id="othersZipFile" name="zipFile" class="form-input" accept=".zip" required>
                            <small class="form-help">Please upload a ZIP file containing all the evidence images. Ensure that each image inside the ZIP file is named according to the point number listed in the Others Questions pop-up. For example, for the question "46.1 Whether the bank performs due diligence of vendors before on-boarding.", the corresponding evidence image must be named starting with "46.1". Accepted file name formats include examples such as 46.1.jpg, 46.1.png, 46.1 sdbvjdsbvb.png, or 46.1 2.png (in case of multiple images for the same point). Following this naming format is mandatory to ensure accurate automated mapping of evidence during report generation.</small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('othersEvidenceModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Generate Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Network Review Questions Modal -->
        <div id="networkReviewQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Network Review Questions</h3>
                    <span class="close-modal" onclick="closeModal('networkReviewQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="networkReviewQuestionsForm" action="/generate_network_review_excel" method="POST" enctype="multipart/form-data" onsubmit="handleNetworkReviewSubmit(event)">
                        <!-- Network Review Questions -->
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Network Review Assessment</h4>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="secondaryConnectivity" class="security-question-label">1.1 Whether the Secondary Connectivity is available or not?*</label>
                            <select id="secondaryConnectivity" name="secondaryConnectivity" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="coreSwitchManageable" class="security-question-label">1.2 Whether the Core Switch is manageable or not?*</label>
                            <select id="coreSwitchManageable" name="coreSwitchManageable" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="hoRouterHA" class="security-question-label">1.3 Is HO router in HA (High Availability) mode?*</label>
                            <select id="hoRouterHA" name="hoRouterHA" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="ipPoolDecided" class="security-question-label">1.4 Is the IP pool decided or not?*</label>
                            <select id="ipPoolDecided" name="ipPoolDecided" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="ipRangeSame" class="security-question-label">1.5 Is the IP range for different branches the same or not?*</label>
                            <select id="ipRangeSame" name="ipRangeSame" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="atmConnected" class="security-question-label">1.6 Is ATM connected to the branch switch or not?*</label>
                            <select id="atmConnected" name="atmConnected" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="cbsInternetSame" class="security-question-label">1.7 Are CBS and Internet working on the same system or not?*</label>
                            <select id="cbsInternetSame" name="cbsInternetSame" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="firewallAvailable" class="security-question-label">1.8 Is a firewall available?*</label>
                            <select id="firewallAvailable" name="firewallAvailable" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="networkMonitoringTools" class="security-question-label">1.9 Are network data monitoring tools available?*</label>
                            <select id="networkMonitoringTools" name="networkMonitoringTools" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="secondaryConnectivityAuto" class="security-question-label">1.10 Whether Secondary Connectivity is on auto switchable mode or not?*</label>
                            <select id="secondaryConnectivityAuto" name="secondaryConnectivityAuto" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="wifiAvailable" class="security-question-label">1.11 Is WIFI available or not?*</label>
                            <select id="wifiAvailable" name="wifiAvailable" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="dataTransferMethod" class="security-question-label">1.12 How is the Data transferred from CTS infrastructure to CBS infrastructure?*</label>
                            <select id="dataTransferMethod" name="dataTransferMethod" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="centralLogCollector" class="security-question-label">1.13 Is there a central log collector?*</label>
                            <select id="centralLogCollector" name="centralLogCollector" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="powerRedundancy" class="security-question-label">1.14 Is there adequate redundancy for Power Failure? Do critical appliances have dual power cords?*</label>
                            <select id="powerRedundancy" name="powerRedundancy" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="coolingMechanism" class="security-question-label">1.15 Is there an adequate cooling mechanism available?*</label>
                            <select id="coolingMechanism" name="coolingMechanism" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="singlePointFailure" class="security-question-label">1.16 Is there any single point of failure?*</label>
                            <select id="singlePointFailure" name="singlePointFailure" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="firewallHA" class="security-question-label">1.17 Whether a firewall is in HA mode or not?*</label>
                            <select id="firewallHA" name="firewallHA" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="vlanImplemented" class="security-question-label">1.18 Is VLAN implemented on the networks?*</label>
                            <select id="vlanImplemented" name="vlanImplemented" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="ruralConnectivity" class="security-question-label">1.19 How is the connectivity placed in rural area branches?*</label>
                            <select id="ruralConnectivity" name="ruralConnectivity" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="vpnOrDirect" class="security-question-label">1.20 Do they use VPNs or connect via direct internet?*</label>
                            <select id="vpnOrDirect" name="vpnOrDirect" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="serverFarmVlan" class="security-question-label">1.21 Is the server farm on a different VLAN?*</label>
                            <select id="serverFarmVlan" name="serverFarmVlan" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="atmNetworkIsolated" class="security-question-label">1.22 Is the ATM network isolated?*</label>
                            <select id="atmNetworkIsolated" name="atmNetworkIsolated" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="unusedPortsOpen" class="security-question-label">1.23 Are unused ports in the switch open and in use?*</label>
                            <select id="unusedPortsOpen" name="unusedPortsOpen" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="networkIdsIps" class="security-question-label">1.24 Are Network IDS/IPS in place?*</label>
                            <select id="networkIdsIps" name="networkIdsIps" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="ntpServerConfigured" class="security-question-label">1.25 Is there an NTP server configured?*</label>
                            <select id="ntpServerConfigured" name="ntpServerConfigured" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="branchToHoPing" class="security-question-label">1.26 Is Branch to HO ping allowed?*</label>
                            <select id="branchToHoPing" name="branchToHoPing" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="branchToBranchPing" class="security-question-label">1.27 Is Branch to Branch ping allowed?*</label>
                            <select id="branchToBranchPing" name="branchToBranchPing" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="cablesTagged" class="security-question-label">1.28 Are all cables well tagged and organized?*</label>
                            <select id="cablesTagged" name="cablesTagged" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="deviceMonitoring" class="security-question-label">1.29 Is there a mechanism to monitor the availability status of important network devices/servers?*</label>
                            <select id="deviceMonitoring" name="deviceMonitoring" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="waterRisk" class="security-question-label">1.30 Is there a risk of water entering the data center by any means (e.g., AC Vents)?*</label>
                            <select id="waterRisk" name="waterRisk" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="networkSegmentation" class="security-question-label">1.31 Is Network Segmentation done?*</label>
                            <select id="networkSegmentation" name="networkSegmentation" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="dhcpEnabled" class="security-question-label">1.32 Is DHCP enabled in the bank network?*</label>
                            <select id="dhcpEnabled" name="dhcpEnabled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="networkDiagram" class="security-question-label">1.33 Is Network Diagram available?*</label>
                            <select id="networkDiagram" name="networkDiagram" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <!-- Form Actions -->
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('networkReviewQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Data Centre Questions Modal -->
        <div id="dataCentreQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Data Centre Questions</h3>
                    <span class="close-modal" onclick="closeModal('dataCentreQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="dataCentreQuestionsForm" action="/generate_data_centre_excel" method="POST" enctype="multipart/form-data" onsubmit="handleDataCentreSubmit(event)">
                        <!-- Data Centre Questions -->
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Data Centre Assessment</h4>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="separateServerRoom" class="security-question-label">2.1 Is there a separate room for the server?*</label>
                            <select id="separateServerRoom" name="separateServerRoom" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="internetAllowed" class="security-question-label">2.2 Is the Internet allowed or not?*</label>
                            <select id="internetAllowed" name="internetAllowed" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="osVersion" class="security-question-label">2.3 Which OS version is currently running?*</label>
                            <select id="osVersion" name="osVersion" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="eventLogsPresent" class="security-question-label">2.4 Are event logs for server OS present and up to date?*</label>
                            <select id="eventLogsPresent" name="eventLogsPresent" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="windowsOSGenuine" class="security-question-label">2.5 Is Windows OS genuine or not?*</label>
                            <select id="windowsOSGenuine" name="windowsOSGenuine" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="osOutdated" class="security-question-label">2.6 Is the currently running OS outdated or not?*</label>
                            <select id="osOutdated" name="osOutdated" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="passwordPolicyPresent" class="security-question-label">2.7 Is a password policy present for server OS authentication?*</label>
                            <select id="passwordPolicyPresent" name="passwordPolicyPresent" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="antivirusAvailable" class="security-question-label">2.8 Is antivirus available?*</label>
                            <select id="antivirusAvailable" name="antivirusAvailable" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="serverOSUpdated" class="security-question-label">2.9 Is server OS updated?*</label>
                            <select id="serverOSUpdated" name="serverOSUpdated" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="cctvCamerasCount" class="security-question-label">2.10 How many CCTV cameras are present in the server room? (Recommended two)*</label>
                            <select id="cctvCamerasCount" name="cctvCamerasCount" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="antivirusExpired" class="security-question-label">2.11 Is antivirus expired?*</label>
                            <select id="antivirusExpired" name="antivirusExpired" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="antivirusConfigured" class="security-question-label">2.12 Is antivirus configured properly?*</label>
                            <select id="antivirusConfigured" name="antivirusConfigured" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="usbDevicesAllowed" class="security-question-label">2.13 Are USB devices allowed or not?*</label>
                            <select id="usbDevicesAllowed" name="usbDevicesAllowed" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="remoteAccessLogs" class="security-question-label">2.14 Are logs maintained for remote access?*</label>
                            <select id="remoteAccessLogs" name="remoteAccessLogs" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="remoteConnectionApp" class="security-question-label">2.15 Which application is being used for remote connection?*</label>
                            <select id="remoteConnectionApp" name="remoteConnectionApp" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="lastDRDrill" class="security-question-label">2.16 When was the last DR drill conducted?*</label>
                            <select id="lastDRDrill" name="lastDRDrill" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="serverAdequateSpace" class="security-question-label">2.17 Does the server have adequate space for operational requirements?*</label>
                            <select id="serverAdequateSpace" name="serverAdequateSpace" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="serverRoomVisible" class="security-question-label">2.18 Is the server room visible from a distance and easily accessible?*</label>
                            <select id="serverRoomVisible" name="serverRoomVisible" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="serverRoomAwayFromBasement" class="security-question-label">2.19 Is the server room away from the basement and water/drainage systems?*</label>
                            <select id="serverRoomAwayFromBasement" name="serverRoomAwayFromBasement" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="serverCloseToUPS" class="security-question-label">2.20 Is the server close to the UPS room?*</label>
                            <select id="serverCloseToUPS" name="serverCloseToUPS" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="smokingProhibited" class="security-question-label">2.21 Is smoking, eating, and drinking prohibited in the server room to prevent spillage of food or liquid into sensitive computer equipment?*</label>
                            <select id="smokingProhibited" name="smokingProhibited" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="authorizedPersonsCount" class="security-question-label">2.22 How many persons are authorized to access the server room?*</label>
                            <select id="authorizedPersonsCount" name="authorizedPersonsCount" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="biometricAccessPresent" class="security-question-label">2.23 Is a biometric or proximity card machine present for access in the server room?*</label>
                            <select id="biometricAccessPresent" name="biometricAccessPresent" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="biometricLogsPresent" class="security-question-label">2.24 Are biometric logs or proximity card logs present and maintained to the current date?*</label>
                            <select id="biometricLogsPresent" name="biometricLogsPresent" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="cablesStructured" class="security-question-label">2.25 Are cables for network devices properly structured or not?*</label>
                            <select id="cablesStructured" name="cablesStructured" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="serverRackOpen" class="security-question-label">2.26 Is the server rack open or not?*</label>
                            <select id="serverRackOpen" name="serverRackOpen" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="wireTaggingAvailable" class="security-question-label">2.27 Is wire tagging available?*</label>
                            <select id="wireTaggingAvailable" name="wireTaggingAvailable" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="cctvCablesConcealed" class="security-question-label">2.28 Are cables for CCTV cameras concealed or not?*</label>
                            <select id="cctvCablesConcealed" name="cctvCablesConcealed" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="cctvBackupAvailable" class="security-question-label">2.29 Is CCTV footage backup available for at least 30 days or not?*</label>
                            <select id="cctvBackupAvailable" name="cctvBackupAvailable" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="fireExtinguishersCount" class="security-question-label">2.30 How many fire extinguishers are available?*</label>
                            <select id="fireExtinguishersCount" name="fireExtinguishersCount" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="automaticFireExtinguisher" class="security-question-label">2.31 Is an automatic fire extinguisher present or not?*</label>
                            <select id="automaticFireExtinguisher" name="automaticFireExtinguisher" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="hygrometerPresent" class="security-question-label">2.32 Is a hygrometer present or not?*</label>
                            <select id="hygrometerPresent" name="hygrometerPresent" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="smokeDetectorAvailable" class="security-question-label">2.33 Is a smoke detector available or not?*</label>
                            <select id="smokeDetectorAvailable" name="smokeDetectorAvailable" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="fireAlarmPresent" class="security-question-label">2.34 Is a fire alarm present or not?*</label>
                            <select id="fireAlarmPresent" name="fireAlarmPresent" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="antivirusUpdated" class="security-question-label">2.35 Is antivirus updated or not?*</label>
                            <select id="antivirusUpdated" name="antivirusUpdated" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="unauthorizedSoftwarePresent" class="security-question-label">2.36 Is unauthorized software present or not?*</label>
                            <select id="unauthorizedSoftwarePresent" name="unauthorizedSoftwarePresent" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="remoteAccessByITTeam" class="security-question-label">2.37 Is remote access taken by the IT team or any other?*</label>
                            <select id="remoteAccessByITTeam" name="remoteAccessByITTeam" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="drLocation" class="security-question-label">2.38 At which location is DR present?*</label>
                            <select id="drLocation" name="drLocation" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="drDrillLogsMaintained" class="security-question-label">2.39 Are logs for DR drills properly maintained or not?*</label>
                            <select id="drDrillLogsMaintained" name="drDrillLogsMaintained" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="serverRoomClean" class="security-question-label">2.40 Is the server room neat and clean to ensure a dust-free environment?*</label>
                            <select id="serverRoomClean" name="serverRoomClean" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="serverRoomAccessLog" class="security-question-label">2.41 Is a server room access log registered, present, and maintained?*</label>
                            <select id="serverRoomAccessLog" name="serverRoomAccessLog" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="networkDevicesPlacedProperly" class="security-question-label">2.42 Are network devices placed properly in the server rack?*</label>
                            <select id="networkDevicesPlacedProperly" name="networkDevicesPlacedProperly" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="serverRoomCooling" class="security-question-label">2.43 Is the server room adequately cooled, and how is the air-conditioning system configured in terms of number of units and automatic or manual operation?*</label>
                            <select id="serverRoomCooling" name="serverRoomCooling" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="serverRoomLeakage" class="security-question-label">2.44 Is there any leakage in server room walls or any other dangerous cause affecting servers in the room?*</label>
                            <select id="serverRoomLeakage" name="serverRoomLeakage" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="powerBackupPresent" class="security-question-label">2.45 Is power backup present or not?*</label>
                            <select id="powerBackupPresent" name="powerBackupPresent" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('dataCentreQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Disaster Recovery Questions Modal -->
        <div id="disasterRecoveryQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Disaster Recovery Questions</h3>
                    <span class="close-modal" onclick="closeModal('disasterRecoveryQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="disasterRecoveryQuestionsForm" action="/generate_disaster_recovery_excel" method="POST" enctype="multipart/form-data" onsubmit="handleDisasterRecoverySubmit(event)">
                        <!-- Disaster Recovery Questions -->
                        <div class="form-group security-question-row">
                            <label for="separateServerRoom" class="security-question-label">3.1 Is there a separate room for the server?*</label>
                            <select id="separateServerRoom" name="separateServerRoom" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="internetAllowed" class="security-question-label">3.2 Is the Internet allowed or not?*</label>
                            <select id="internetAllowed" name="internetAllowed" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="osVersion" class="security-question-label">3.3 Which OS version is currently running?*</label>
                            <select id="osVersion" name="osVersion" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="eventLogsUpToDate" class="security-question-label">3.4 Are event logs for server OS present up to date?*</label>
                            <select id="eventLogsUpToDate" name="eventLogsUpToDate" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="windowsOSGenuine" class="security-question-label">3.5 Is Windows OS genuine or not?*</label>
                            <select id="windowsOSGenuine" name="windowsOSGenuine" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="osOutdated" class="security-question-label">3.6 Is the currently running OS outdated or not?*</label>
                            <select id="osOutdated" name="osOutdated" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="passwordPolicyPresent" class="security-question-label">3.7 Is password policy present for server OS authentication?*</label>
                            <select id="passwordPolicyPresent" name="passwordPolicyPresent" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="antivirusAvailable" class="security-question-label">3.8 Is antivirus available?*</label>
                            <select id="antivirusAvailable" name="antivirusAvailable" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="serverOSUpdated" class="security-question-label">3.9 Is server OS updated?*</label>
                            <select id="serverOSUpdated" name="serverOSUpdated" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="cctvCamerasCount" class="security-question-label">3.10 How many CCTV cameras are present in the server room? (Recommended two)*</label>
                            <select id="cctvCamerasCount" name="cctvCamerasCount" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="antivirusExpired" class="security-question-label">3.11 Is antivirus expired?*</label>
                            <select id="antivirusExpired" name="antivirusExpired" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="antivirusConfigured" class="security-question-label">3.12 Is antivirus configured properly?*</label>
                            <select id="antivirusConfigured" name="antivirusConfigured" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="usbDevicesAllowed" class="security-question-label">3.13 Are USB devices allowed or not?*</label>
                            <select id="usbDevicesAllowed" name="usbDevicesAllowed" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="remoteAccessLogs" class="security-question-label">3.14 Are logs maintained for remote access?*</label>
                            <select id="remoteAccessLogs" name="remoteAccessLogs" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="remoteConnectionApp" class="security-question-label">3.15 Which application is being used for remote connection?*</label>
                            <select id="remoteConnectionApp" name="remoteConnectionApp" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="lastDRDrill" class="security-question-label">3.16 When is the last DR drill conducted?*</label>
                            <select id="lastDRDrill" name="lastDRDrill" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="adequateSpace" class="security-question-label">3.17 Does server have adequate space for operational requirements?*</label>
                            <select id="adequateSpace" name="adequateSpace" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="serverRoomVisible" class="security-question-label">3.18 Is the server room visible from a distance and easily accessible?*</label>
                            <select id="serverRoomVisible" name="serverRoomVisible" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="serverRoomAwayFromBasement" class="security-question-label">3.19 Is the server room away from the basement and water/drainage systems?*</label>
                            <select id="serverRoomAwayFromBasement" name="serverRoomAwayFromBasement" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="serverCloseToUPS" class="security-question-label">3.20 Is the server close to the UPS room?*</label>
                            <select id="serverCloseToUPS" name="serverCloseToUPS" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="smokingEatingProhibited" class="security-question-label">3.21 Is smoking, eating, and drinking prohibited in the server room to prevent spillage of food or liquid into sensitive computer equipment?*</label>
                            <select id="smokingEatingProhibited" name="smokingEatingProhibited" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="authorizedPersonsCount" class="security-question-label">3.22 How many persons are authorized to access the server room?*</label>
                            <select id="authorizedPersonsCount" name="authorizedPersonsCount" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="biometricProximityPresent" class="security-question-label">3.23 Is a biometric or proximity card machine present for access in the server room?*</label>
                            <select id="biometricProximityPresent" name="biometricProximityPresent" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="biometricLogsMaintained" class="security-question-label">3.24 Are biometric logs or proximity card present and maintained to the current date?*</label>
                            <select id="biometricLogsMaintained" name="biometricLogsMaintained" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="cablesStructured" class="security-question-label">3.25 Are cables for network devices properly structured or not?*</label>
                            <select id="cablesStructured" name="cablesStructured" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="serverRackOpen" class="security-question-label">3.26 Is the server rack open or not?*</label>
                            <select id="serverRackOpen" name="serverRackOpen" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="wireTaggingAvailable" class="security-question-label">3.27 Is wire tagging available?*</label>
                            <select id="wireTaggingAvailable" name="wireTaggingAvailable" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="cctvCablesConcealed" class="security-question-label">3.28 Are cables for CCTV cameras concealed or not?*</label>
                            <select id="cctvCablesConcealed" name="cctvCablesConcealed" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="cctvBackup30Days" class="security-question-label">3.29 Is there CCTV footage backup available for at least 30 days or not?*</label>
                            <select id="cctvBackup30Days" name="cctvBackup30Days" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="fireExtinguishersCount" class="security-question-label">3.30 How many fire extinguishers are available?*</label>
                            <select id="fireExtinguishersCount" name="fireExtinguishersCount" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="automaticFireExtinguisher" class="security-question-label">3.31 Is an automatic fire extinguisher present or not?*</label>
                            <select id="automaticFireExtinguisher" name="automaticFireExtinguisher" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="hygrometerPresent" class="security-question-label">3.32 Is a hygrometer present or not?*</label>
                            <select id="hygrometerPresent" name="hygrometerPresent" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="smokeDetectorAvailable" class="security-question-label">3.33 Is smoke detector available or not?*</label>
                            <select id="smokeDetectorAvailable" name="smokeDetectorAvailable" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="fireAlarmPresent" class="security-question-label">3.34 Is a fire alarm present or not?*</label>
                            <select id="fireAlarmPresent" name="fireAlarmPresent" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="antivirusUpdated" class="security-question-label">3.35 Is antivirus updated or not?*</label>
                            <select id="antivirusUpdated" name="antivirusUpdated" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="unauthorizedSoftwarePresent" class="security-question-label">3.36 Is unauthorized software present or not?*</label>
                            <select id="unauthorizedSoftwarePresent" name="unauthorizedSoftwarePresent" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="remoteAccessByITTeam" class="security-question-label">3.37 Is remote access taken by IT team or any other?*</label>
                            <select id="remoteAccessByITTeam" name="remoteAccessByITTeam" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="dcAndDRLocation" class="security-question-label">3.38 At which location the DC and DR present?*</label>
                            <select id="dcAndDRLocation" name="dcAndDRLocation" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="drDrillLogsMaintained" class="security-question-label">3.39 Are logs for DR drills properly maintained or not?*</label>
                            <select id="drDrillLogsMaintained" name="drDrillLogsMaintained" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="serverRoomClean" class="security-question-label">3.40 Is the server room neat and clean to ensure a dust-free environment?*</label>
                            <select id="serverRoomClean" name="serverRoomClean" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="serverRoomAccessLog" class="security-question-label">3.41 Is a server room access log registered, present, and maintained?*</label>
                            <select id="serverRoomAccessLog" name="serverRoomAccessLog" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="networkDevicesPlacedProperly" class="security-question-label">3.42 Are network devices placed properly in the server rack?*</label>
                            <select id="networkDevicesPlacedProperly" name="networkDevicesPlacedProperly" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="properCoolingPresent" class="security-question-label">3.43 Is there proper cooling present in the server room?*</label>
                            <select id="properCoolingPresent" name="properCoolingPresent" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="acCount" class="security-question-label">3.44 How many A/Cs are present in the server room?*</label>
                            <select id="acCount" name="acCount" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="acAutomaticManual" class="security-question-label">3.45 Is switching ON/OFF of AC automatic or manual?*</label>
                            <select id="acAutomaticManual" name="acAutomaticManual" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="wallLeakagePresent" class="security-question-label">3.46 Is there any leakage in server room walls or any other dangerous cause affecting servers in the room?*</label>
                            <select id="wallLeakagePresent" name="wallLeakagePresent" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="powerBackupPresent" class="security-question-label">3.47 Is power backup present or not?*</label>
                            <select id="powerBackupPresent" name="powerBackupPresent" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('disasterRecoveryQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Firewall Questions Modal -->
        <div id="firewallQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Firewall Questions</h3>
                    <span class="close-modal" onclick="closeModal('firewallQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="firewallQuestionsForm" onsubmit="handleFirewallSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="firewallHA" class="security-question-label">4.1 Is the firewall in HA (High Availability) mode?</label>
                            <select id="firewallHA" name="firewallHA" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="firewallRuleAny" class="security-question-label">4.2 Is the firewall rule set to any any any?</label>
                            <select id="firewallRuleAny" name="firewallRuleAny" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="internetThroughFirewall" class="security-question-label">4.3 Are all Internet connections routed through a firewall?</label>
                            <select id="internetThroughFirewall" name="internetThroughFirewall" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="firewallAntivirus" class="security-question-label">4.4 Are the firewall rules scanned through antivirus or not?</label>
                            <select id="firewallAntivirus" name="firewallAntivirus" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="firewallATP" class="security-question-label">4.5 Is ATP (Advanced Threat Protection) enabled or not?</label>
                            <select id="firewallATP" name="firewallATP" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="firewallUSB" class="security-question-label">4.6 Is USB access allowed in the firewall?</label>
                            <select id="firewallUSB" name="firewallUSB" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="webFiltering" class="security-question-label">4.7 Is web filtering enabled or not?</label>
                            <select id="webFiltering" name="webFiltering" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="webProxy" class="security-question-label">4.8 Is web-based proxy enabled?</label>
                            <select id="webProxy" name="webProxy" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="icmpDisabled" class="security-question-label">4.9 Are ICMP requests disabled, or is the ping flooding feature enabled?</label>
                            <select id="icmpDisabled" name="icmpDisabled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="guiHttpsCliSSH" class="security-question-label">4.10 Does the GUI only have HTTPS access, and CLI only have SSH access?</label>
                            <select id="guiHttpsCliSSH" name="guiHttpsCliSSH" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="auditTrail" class="security-question-label">4.11 Is audit trail enabled on the firewall to log changes made to rule base settings, and are the logged entries approved by higher authorities in the IT Department?</label>
                            <select id="auditTrail" name="auditTrail" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="defaultCredentials" class="security-question-label">4.12 Are default credentials in use, or are accounts named 'Admin', 'root', or 'Administrator' for administrator login?</label>
                            <select id="defaultCredentials" name="defaultCredentials" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="dosSpoofProtection" class="security-question-label">4.13 Are DoS and spoof protection enabled or not?</label>
                            <select id="dosSpoofProtection" name="dosSpoofProtection" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="firmwareUpdated" class="security-question-label">4.14 Is the firmware up to date?</label>
                            <select id="firmwareUpdated" name="firmwareUpdated" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="supportLicense" class="security-question-label">4.15 Does the firewall have a valid support license available?</label>
                            <select id="supportLicense" name="supportLicense" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="firewallBranches" class="security-question-label">4.16 Is a firewall present in branches?</label>
                            <select id="firewallBranches" name="firewallBranches" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="systemLogs" class="security-question-label">4.17 Are system logs configured?</label>
                            <select id="systemLogs" name="systemLogs" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="backupFrequency" class="security-question-label">4.18 How frequently is backup done for the firewall configuration?</label>
                            <select id="backupFrequency" name="backupFrequency" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="adminWhitelistIP" class="security-question-label">4.19 Is the administrative portal login accessed only by whitelisted IP addresses?</label>
                            <select id="adminWhitelistIP" name="adminWhitelistIP" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="syslogServer" class="security-question-label">4.20 Is a Syslog server present or not?</label>
                            <select id="syslogServer" name="syslogServer" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="adminHttpsTls" class="security-question-label">4.21 Is administrator access portal HTTPS on TLS 1.2 or greater?</label>
                            <select id="adminHttpsTls" name="adminHttpsTls" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="httpLoginDisabled" class="security-question-label">4.22 Are HTTP logins disabled, and redirected to HTTPS?</label>
                            <select id="httpLoginDisabled" name="httpLoginDisabled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="multipleAdminAccounts" class="security-question-label">4.23 Are there multiple admin accounts or not?</label>
                            <select id="multipleAdminAccounts" name="multipleAdminAccounts" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="vpnSecure" class="security-question-label">4.24 Is VPN (Virtual Private Network) in use? If yes, is a secured channel used?</label>
                            <select id="vpnSecure" name="vpnSecure" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="ntpConfigured" class="security-question-label">4.25 Is NTP (Network Time Protocol) configured?</label>
                            <select id="ntpConfigured" name="ntpConfigured" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="firewallPhysicallySecured" class="security-question-label">4.26 Is the firewall physically secured or not?</label>
                            <select id="firewallPhysicallySecured" name="firewallPhysicallySecured" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="alertsMonitored" class="security-question-label">4.27 Are alerts being monitored regularly or not?</label>
                            <select id="alertsMonitored" name="alertsMonitored" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="passwordPolicies" class="security-question-label">4.28 Are password policies configured as per the organization's password management policy?</label>
                            <select id="passwordPolicies" name="passwordPolicies" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="unusedPortsClosed" class="security-question-label">4.29 Are unused ports closed on the firewall?</label>
                            <select id="unusedPortsClosed" name="unusedPortsClosed" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="idsLogsMonitored" class="security-question-label">4.30 Are system administrators monitoring the logs produced by the Intrusion Detection System?</label>
                            <select id="idsLogsMonitored" name="idsLogsMonitored" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="twoFactorAuth" class="security-question-label">4.31 Do administrators have two-factor authentication enabled?</label>
                            <select id="twoFactorAuth" name="twoFactorAuth" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="loginDisclaimer" class="security-question-label">4.32 Is a login disclaimer message set or not?</label>
                            <select id="loginDisclaimer" name="loginDisclaimer" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="aclConfigured" class="security-question-label">4.33 Is ACL configured or not?</label>
                            <select id="aclConfigured" name="aclConfigured" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="loginTimeout" class="security-question-label">4.34 Are login timeout settings as per organization policies?</label>
                            <select id="loginTimeout" name="loginTimeout" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Non-Compliance">Non-Compliance</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('firewallQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Core Switch Questions Modal -->
        <div id="coreSwitchQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Core Switch Assessment</h3>
                    <span class="close-modal" onclick="closeModal('coreSwitchQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="coreSwitchQuestionsForm" onsubmit="handleCoreSwitchSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="tcpKeepAlives" class="security-question-label">5.1 Is Inbound TCP Connection Keep Alives message disabled?</label>
                            <select id="tcpKeepAlives" name="tcpKeepAlives" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="telnetEnabled" class="security-question-label">5.2 Is telnet service enabled?</label>
                            <select id="telnetEnabled" name="telnetEnabled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="guiHttpsCliSSH" class="security-question-label">5.3 Does the GUI only has HTTPS Access? And CLI only has SSH Access?</label>
                            <select id="guiHttpsCliSSH" name="guiHttpsCliSSH" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="usbAccess" class="security-question-label">5.4 Is USB access allowed in switch?</label>
                            <select id="usbAccess" name="usbAccess" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="cdpEnabled" class="security-question-label">5.5 Are CDP (Cisco Discovery Protocol) Packets enabled?</label>
                            <select id="cdpEnabled" name="cdpEnabled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="tcpUdpSmallServers" class="security-question-label">5.6 Does Cisco enable TCP and UDP Small Servers by default?</label>
                            <select id="tcpUdpSmallServers" name="tcpUdpSmallServers" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="defaultCredentials" class="security-question-label">5.7 Does default credentials are in use? Or are accounts name by the 'Admin' or 'root' or 'Administrator' to access administrator login?</label>
                            <select id="defaultCredentials" name="defaultCredentials" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="unusedPortsClosed" class="security-question-label">5.8 Are unused ports closed on the switch?</label>
                            <select id="unusedPortsClosed" name="unusedPortsClosed" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="physicallySecured" class="security-question-label">5.9 Is the Switch Physically Secured or not?</label>
                            <select id="physicallySecured" name="physicallySecured" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="ntpConfigured" class="security-question-label">5.10 Is NTP (Network Time Protocol) configured?</label>
                            <select id="ntpConfigured" name="ntpConfigured" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="httpLoginsDisabled" class="security-question-label">5.11 Are HTTP logins disabled or not? And whether it redirected to HTTPS?</label>
                            <select id="httpLoginsDisabled" name="httpLoginsDisabled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="firmwareUpdated" class="security-question-label">5.12 Is the firmware up to date?</label>
                            <select id="firmwareUpdated" name="firmwareUpdated" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="adminWhitelistIP" class="security-question-label">5.13 Is an administrative portal login accessed only by Whitelisted IP Addresses?</label>
                            <select id="adminWhitelistIP" name="adminWhitelistIP" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="adminLockout" class="security-question-label">5.14 Is Admin lockout set to 3 or more failed login attempts or as per the organisation's policy?</label>
                            <select id="adminLockout" name="adminLockout" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="loggingEnabled" class="security-question-label">5.15 Is logging enabled? Is the Syslog server implemented?</label>
                            <select id="loggingEnabled" name="loggingEnabled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="passwordPolicies" class="security-question-label">5.16 Are Password Policies configured as per the organization's password management policy?</label>
                            <select id="passwordPolicies" name="passwordPolicies" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="backupFrequency" class="security-question-label">5.17 How frequent is backup done for the switch configuration?</label>
                            <select id="backupFrequency" name="backupFrequency" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="securePassword" class="security-question-label">5.18 Does the core switch have a secure password enabled?</label>
                            <select id="securePassword" name="securePassword" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="bootpDisabled" class="security-question-label">5.19 Was the BOOTP not disabled?</label>
                            <select id="bootpDisabled" name="bootpDisabled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="loginDisclaimer" class="security-question-label">5.20 Is the login disclaimer message set or not?</label>
                            <select id="loginDisclaimer" name="loginDisclaimer" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="loginTimeout" class="security-question-label">5.21 Is login timeout as per organization policies?</label>
                            <select id="loginTimeout" name="loginTimeout" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="icmpUnreachable" class="security-question-label">5.22 Are ICMP IP unreachable messages enabled on the interface mgmt0?</label>
                            <select id="icmpUnreachable" name="icmpUnreachable" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="domainLookups" class="security-question-label">5.23 Are Domain lookups disabled and DNS servers configured?</label>
                            <select id="domainLookups" name="domainLookups" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="padService" class="security-question-label">5.24 Is Packet Assembler / Disassembler (PAD) service-disabled?</label>
                            <select id="padService" name="padService" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="mopDisabled" class="security-question-label">5.25 Is Maintenance Operations Protocol (MOP) disabled on all ethernet interfaces?</label>
                            <select id="mopDisabled" name="mopDisabled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="httpsSshPorts" class="security-question-label">5.26 Are HTTPS and SSH ports changed to nonstandard ports?</label>
                            <select id="httpsSshPorts" name="httpsSshPorts" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="directedBroadcasts" class="security-question-label">5.27 Are Directed broadcasts enabled by default?</label>
                            <select id="directedBroadcasts" name="directedBroadcasts" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="icmpRedirects" class="security-question-label">5.28 Does the device have support for ICMP redirects enabled on the network interface mgmt0?</label>
                            <select id="icmpRedirects" name="icmpRedirects" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="proxyArp" class="security-question-label">5.29 Does the Auditor identified any interface that had Proxy ARP enabled, mgmt0?</label>
                            <select id="proxyArp" name="proxyArp" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('coreSwitchQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Router Questions Modal -->
        <div id="routerQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Router Assessment</h3>
                    <span class="close-modal" onclick="closeModal('routerQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="routerQuestionsForm" onsubmit="handleRouterSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="routerWifi" class="security-question-label">6.1 Whether Router is used to provide Wi-Fi?</label>
                            <select id="routerWifi" name="routerWifi" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="sessionTimeout" class="security-question-label">6.2 Whether Session timeout was defined?</label>
                            <select id="sessionTimeout" name="sessionTimeout" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="telnetDisabled" class="security-question-label">6.3 Is Telnet service Disabled?</label>
                            <select id="telnetDisabled" name="telnetDisabled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="idleTimeout" class="security-question-label">6.4 Is Idle access/login timeout set to 15 minutes/lower or according to policy?</label>
                            <select id="idleTimeout" name="idleTimeout" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="routerHA" class="security-question-label">6.5 Is Router in HA (High Availability) Mode?</label>
                            <select id="routerHA" name="routerHA" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="icmpRedirects" class="security-question-label">6.6 Is ICMP Redirects Disabled?</label>
                            <select id="icmpRedirects" name="icmpRedirects" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="unusedProtocols" class="security-question-label">6.7 Are unused management protocols disabled?</label>
                            <select id="unusedProtocols" name="unusedProtocols" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="unusedInterfaces" class="security-question-label">6.8 Are unused router interfaces disabled?</label>
                            <select id="unusedInterfaces" name="unusedInterfaces" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="deviceNotification" class="security-question-label">6.9 Is configuration for new device notification available?</label>
                            <select id="deviceNotification" name="deviceNotification" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="ipMacFiltering" class="security-question-label">6.10 Is IP filtering and MAC filtering enabled?</label>
                            <select id="ipMacFiltering" name="ipMacFiltering" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="weakPassword" class="security-question-label">6.11 Is Weak Password in use?</label>
                            <select id="weakPassword" name="weakPassword" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="dhcpEnabled" class="security-question-label">6.12 Whether DHCP (Dynamic Host Configuration Protocol) enabled in the router?</label>
                            <select id="dhcpEnabled" name="dhcpEnabled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="systemLogs" class="security-question-label">6.13 Is System logs configured?</label>
                            <select id="systemLogs" name="systemLogs" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="urlFiltering" class="security-question-label">6.14 Is URL filtering configured?</label>
                            <select id="urlFiltering" name="urlFiltering" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="firmwareUpdated" class="security-question-label">6.15 Is Firmware updated?</label>
                            <select id="firmwareUpdated" name="firmwareUpdated" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="defaultPassword" class="security-question-label">6.16 Is Default Password in use?</label>
                            <select id="defaultPassword" name="defaultPassword" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="arpDisabled" class="security-question-label">6.17 Are gratuitous ARP and Proxy ARP disabled?</label>
                            <select id="arpDisabled" name="arpDisabled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="ipDirectedBroadcast" class="security-question-label">6.18 Is IP-directed broadcast disabled?</label>
                            <select id="ipDirectedBroadcast" name="ipDirectedBroadcast" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="twoFactorAuth" class="security-question-label">6.19 Do Administrators have two-factor authentication enabled?</label>
                            <select id="twoFactorAuth" name="twoFactorAuth" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="credentialManagement" class="security-question-label">6.20 Are router login IDs and passwords treated as sensitive information and managed by authorized administrators?</label>
                            <select id="credentialManagement" name="credentialManagement" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="usbAccess" class="security-question-label">6.21 Whether USB Access Disabled?</label>
                            <select id="usbAccess" name="usbAccess" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="ipSourceRouting" class="security-question-label">6.22 Is IP Source Routing Disabled?</label>
                            <select id="ipSourceRouting" name="ipSourceRouting" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="privateVlan" class="security-question-label">6.23 Is Private VLAN in use?</label>
                            <select id="privateVlan" name="privateVlan" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="dynamicArpInspection" class="security-question-label">6.24 Is Dynamic ARP Inspection performed?</label>
                            <select id="dynamicArpInspection" name="dynamicArpInspection" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="passwordPolicies" class="security-question-label">6.25 Are Password Policies configured as per the organization's password management policy?</label>
                            <select id="passwordPolicies" name="passwordPolicies" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="notificationBanners" class="security-question-label">6.26 Are Notification Banners Implemented?</label>
                            <select id="notificationBanners" name="notificationBanners" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="ntpConfigured" class="security-question-label">6.27 Whether NTP (Network Time Protocol) is configured?</label>
                            <select id="ntpConfigured" name="ntpConfigured" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="wifiUserLimit" class="security-question-label">6.28 Is the User limit for accessing the Wi-Fi Set?</label>
                            <select id="wifiUserLimit" name="wifiUserLimit" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="adminAccessExternal" class="security-question-label">6.29 Is the Administrative access to the external (Internet-facing) interfaces disabled?</label>
                            <select id="adminAccessExternal" name="adminAccessExternal" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="passwordRecovery" class="security-question-label">6.30 Is No Service Password-Recovery Disabled?</label>
                            <select id="passwordRecovery" name="passwordRecovery" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="secureManagement" class="security-question-label">6.31 Are Secure Interactive Management Sessions available?</label>
                            <select id="secureManagement" name="secureManagement" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="consoleAuxPorts" class="security-question-label">6.32 Are console and auxiliary (AUX) ports configured?</label>
                            <select id="consoleAuxPorts" name="consoleAuxPorts" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="antiSpoofing" class="security-question-label">6.33 Is Anti-Spoofing Protection Disabled?</label>
                            <select id="antiSpoofing" name="antiSpoofing" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('routerQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Domain Controller (AD) Questions Modal -->
        <div id="domainControllerQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Domain Controller (AD) Assessment</h3>
                    <span class="close-modal" onclick="closeModal('domainControllerQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="domainControllerQuestionsForm" onsubmit="handleDomainControllerSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="scheduledTasks" class="security-question-label">7.1 Are scheduled tasks set to Disabled for server operators on the domain controller?</label>
                            <select id="scheduledTasks" name="scheduledTasks" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="ldapSigning" class="security-question-label">7.2 Is Domain controller: LDAP server signing requirements set to 'Require signing' or not?</label>
                            <select id="ldapSigning" name="ldapSigning" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="secureChannelEncryption" class="security-question-label">7.3 Is Digitally encrypt or sign secure channel data set to Enabled or not?</label>
                            <select id="secureChannelEncryption" name="secureChannelEncryption" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="adServerPatched" class="security-question-label">7.4 Is the AD server patched regularly?</label>
                            <select id="adServerPatched" name="adServerPatched" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="strongSessionKey" class="security-question-label">7.5 Is Domain member Required strong (Windows 2000 or later) session key set to Enabled?</label>
                            <select id="strongSessionKey" name="strongSessionKey" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="passwordLength" class="security-question-label">7.6 Is the Minimum password length set to 14 or more characters?</label>
                            <select id="passwordLength" name="passwordLength" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="passwordValidation" class="security-question-label">7.7 Is there any validation to follow the standard password policy?</label>
                            <select id="passwordValidation" name="passwordValidation" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="vaptAudits" class="security-question-label">7.8 Are regular VAPT and third-party audits done for the AD server?</label>
                            <select id="vaptAudits" name="vaptAudits" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="adminPasswordComplex" class="security-question-label">7.9 Is the Password of the domain administrator/controller user complex and never shared with anyone?</label>
                            <select id="adminPasswordComplex" name="adminPasswordComplex" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="credentialCaching" class="security-question-label">7.10 Is domain credential caching disabled?</label>
                            <select id="credentialCaching" name="credentialCaching" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="passwordEncrypted" class="security-question-label">7.11 Is the password displayed in encrypted mode?</label>
                            <select id="passwordEncrypted" name="passwordEncrypted" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="networkAccess" class="security-question-label">7.12 Are Access computers from the network configured?</label>
                            <select id="networkAccess" name="networkAccess" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="actAsOS" class="security-question-label">7.13 Is 'Act as part of the operating system' set to 'No One'?</label>
                            <select id="actAsOS" name="actAsOS" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="backupPermissions" class="security-question-label">7.14 Is Back up files and directories set to Administrators/ IT team only or not?</label>
                            <select id="backupPermissions" name="backupPermissions" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="domainAuthUnlock" class="security-question-label">7.15 For Interactive logon: Is Domain Controller Authentication required to unlock the workstation?</label>
                            <select id="domainAuthUnlock" name="domainAuthUnlock" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="smbSigning" class="security-question-label">7.16 Is Microsoft network client: Digitally sign communications set to Enabled?</label>
                            <select id="smbSigning" name="smbSigning" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="singleAdmin" class="security-question-label">7.17 Is there only one domain administrator/controller user in the list?</label>
                            <select id="singleAdmin" name="singleAdmin" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="anonymousSID" class="security-question-label">7.18 Is Network access: Allow anonymous SID/Name translation set to Disabled or not?</label>
                            <select id="anonymousSID" name="anonymousSID" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="auditLogs" class="security-question-label">7.19 Are event audit logs enabled on the server?</label>
                            <select id="auditLogs" name="auditLogs" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="ntlmComputerIdentity" class="security-question-label">7.20 Is Network security: Allow Local System to use computer identity for NTLM set to Enabled?</label>
                            <select id="ntlmComputerIdentity" name="ntlmComputerIdentity" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="vssadminRestricted" class="security-question-label">7.21 Is the vssadmin tool disabled or restricted on the AD server?</label>
                            <select id="vssadminRestricted" name="vssadminRestricted" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="accessControl" class="security-question-label">7.22 Whether Access control is Configured or not for the AD server?</label>
                            <select id="accessControl" name="accessControl" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="nullSessionFallback" class="security-question-label">7.23 Is Network security: Allow Local System NULL session fallback set to Disabled?</label>
                            <select id="nullSessionFallback" name="nullSessionFallback" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="logonMessage" class="security-question-label">7.24 Is Interactive logon text Message configured for users attempting to log on?</label>
                            <select id="logonMessage" name="logonMessage" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="remoteLogonLocal" class="security-question-label">7.25 Can the local accounts and guest users log in through remote log-on protocols?</label>
                            <select id="remoteLogonLocal" name="remoteLogonLocal" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="securityAuditGeneration" class="security-question-label">7.26 Is Generated security audit set to LOCAL SERVICE, NETWORK SERVICE?</label>
                            <select id="securityAuditGeneration" name="securityAuditGeneration" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('domainControllerQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- H2H Audit Questions Modal -->
        <div id="h2hQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>H2H Audit Assessment</h3>
                    <span class="close-modal" onclick="closeModal('h2hQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="h2hQuestionsForm" onsubmit="handleH2HSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="whitelistedIP" class="security-question-label">8.1 Is an administrative portal login accessed only by Whitelisted IP Addresses?</label>
                            <select id="whitelistedIP" name="whitelistedIP" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="admin2FA" class="security-question-label">8.2 Are Administrators having two factor authentications enabled?</label>
                            <select id="admin2FA" name="admin2FA" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="defaultCredentials" class="security-question-label">8.3 Are default credentials in use or Are accounts named by the 'Admin' or 'root' or 'Administrator' to access administrator login?</label>
                            <select id="defaultCredentials" name="defaultCredentials" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="firewallConfigured" class="security-question-label">8.4 Is the firewall Configured?</label>
                            <select id="firewallConfigured" name="firewallConfigured" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="encryptedAPIs" class="security-question-label">8.5 Are APIs using encrypted/tunnel connections, any APIs permitted over unencrypted protocols like HTTP, FTP, or TELNET?</label>
                            <select id="encryptedAPIs" name="encryptedAPIs" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="transactionReconciliation" class="security-question-label">8.6 Are UCBs ensuring to reconcile the transactions put through the sponsor bank mandatorily daily and preferably more than once a day to identify unauthorized transactions?</label>
                            <select id="transactionReconciliation" name="transactionReconciliation" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="transaction2FA" class="security-question-label">8.7 Is 2FA being used for transaction authorization?</label>
                            <select id="transaction2FA" name="transaction2FA" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="bankEmailDomain" class="security-question-label">8.8 Are communications with the sponsor bank done through bank domain email id?</label>
                            <select id="bankEmailDomain" name="bankEmailDomain" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="cbs2FA" class="security-question-label">8.9 Is 2FA being used for CBS login?</label>
                            <select id="cbs2FA" name="cbs2FA" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="iocAntivirus" class="security-question-label">8.10 Are Below attached IOCs (Indicators of Compromise) blocked through Anti-Virus?</label>
                            <select id="iocAntivirus" name="iocAntivirus" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="iocFirewall" class="security-question-label">8.11 Are Below attached IOCs (Indicators of Compromise) blocked through Firewall?</label>
                            <select id="iocFirewall" name="iocFirewall" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="securityAdvisor" class="security-question-label">8.12 Is the Security Advisor provided?</label>
                            <select id="securityAdvisor" name="securityAdvisor" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="dosProtection" class="security-question-label">8.13 Whether the DoS protection is enabled or not?</label>
                            <select id="dosProtection" name="dosProtection" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="firmwareUpdated" class="security-question-label">8.14 Is the firmware/DSM up to date?</label>
                            <select id="firmwareUpdated" name="firmwareUpdated" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="adminLockout" class="security-question-label">8.15 Is Admin lockout set to 3 or more failed login attempts or as per the organization policy?</label>
                            <select id="adminLockout" name="adminLockout" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="passwordExpiry" class="security-question-label">8.16 Is the administrative password expiry set as per the organization's password policy?</label>
                            <select id="passwordExpiry" name="passwordExpiry" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="passwordPolicy" class="security-question-label">8.17 Is the administrative password set as per the organization's password policy?</label>
                            <select id="passwordPolicy" name="passwordPolicy" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="gpoPolicies" class="security-question-label">8.18 Is Bank implementing policies through GPOs for periodic password expiry, password age, and history?</label>
                            <select id="gpoPolicies" name="gpoPolicies" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="executableWhitelisting" class="security-question-label">8.19 Has the bank employed whitelisting of executables/software?</label>
                            <select id="executableWhitelisting" name="executableWhitelisting" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="dongleUsage" class="security-question-label">8.20 Is the dongle plugged in only during the time of signing the transactions or not?</label>
                            <select id="dongleUsage" name="dongleUsage" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="donglePIN" class="security-question-label">8.21 Is access to the dongle secured using a PIN/password?</label>
                            <select id="donglePIN" name="donglePIN" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="dongleCustody" class="security-question-label">8.22 Is the dongle, when not in use, in the safe custody of the owner of the digital signing certificate and not left unattended at the terminal/H2H (Host to Host) client?</label>
                            <select id="dongleCustody" name="dongleCustody" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="emailNotifications" class="security-question-label">8.23 Are Email Notifications enabled?</label>
                            <select id="emailNotifications" name="emailNotifications" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('h2hQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Antivirus Questions Modal -->
        <div id="antivirusQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Antivirus Assessment</h3>
                    <span class="close-modal" onclick="closeModal('antivirusQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="antivirusQuestionsForm" onsubmit="handleAntivirusSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="antivirusAvailable" class="security-question-label">9.1 Is the antivirus available?</label>
                            <select id="antivirusAvailable" name="antivirusAvailable" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="adminConsoleAccess" class="security-question-label">9.2 How is the antivirus administrator console accessed? Is access to the administrative console limited to whitelisted computers only?</label>
                            <select id="adminConsoleAccess" name="adminConsoleAccess" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="databaseUpdated" class="security-question-label">9.3 Is the Antivirus database up to date? Is the virus definition updated automatically?</label>
                            <select id="databaseUpdated" name="databaseUpdated" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="behaviorMode" class="security-question-label">9.4 Does Antivirus have behavior mode enabled?</label>
                            <select id="behaviorMode" name="behaviorMode" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="adminPassword" class="security-question-label">9.5 Is the administrative password set as per the organization's password policy?</label>
                            <select id="adminPassword" name="adminPassword" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="enterpriseGrade" class="security-question-label">9.6 Is the bank using an enterprise-grade antivirus that is managed centrally?</label>
                            <select id="enterpriseGrade" name="enterpriseGrade" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="antivirusUpdated" class="security-question-label">9.7 Is the Antivirus Application up to date? Or Is Authorized version of Antivirus software with its latest updates available?</label>
                            <select id="antivirusUpdated" name="antivirusUpdated" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="floppyCdScan" class="security-question-label">9.8 Is the Antivirus software configured to check viruses even from the floppy drive / CD ROM drive?</label>
                            <select id="floppyCdScan" name="floppyCdScan" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="usbEnabled" class="security-question-label">9.9 Is USB enabled in the antivirus server?</label>
                            <select id="usbEnabled" name="usbEnabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="antiApt" class="security-question-label">9.10 Does the antivirus have Anti-APT functionality to detect advanced or signature-less threats? Is this feature enabled?</label>
                            <select id="antiApt" name="antiApt" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="hipsEnabled" class="security-question-label">9.11 Does the antivirus include HIPS to detect and block any scanning or exploitation attempts? Is this feature enabled?</label>
                            <select id="hipsEnabled" name="hipsEnabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="firewallEnabled" class="security-question-label">9.12 Does the antivirus provide a firewall to block unauthorized port access? Is the firewall enabled?</label>
                            <select id="firewallEnabled" name="firewallEnabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="deviceControl" class="security-question-label">9.13 Does the antivirus support device control to block USB storage, CD/DVD-ROM, and other external devices? Is this feature enabled?</label>
                            <select id="deviceControl" name="deviceControl" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="quarantineConfig" class="security-question-label">9.14 Is the antivirus configured to quarantine/repair or delete infected files?</label>
                            <select id="quarantineConfig" name="quarantineConfig" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="patchServer" class="security-question-label">9.15 Is the patch server configured?</label>
                            <select id="patchServer" name="patchServer" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="exclusionsConfig" class="security-question-label">9.16 Does the antivirus have any exclusions configured? If yes, are they reviewed and approved? Is there a plan to remove these exclusions?</label>
                            <select id="exclusionsConfig" name="exclusionsConfig" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="adIntegration" class="security-question-label">9.17 Is the antivirus integrated with Active Directory for user management?</label>
                            <select id="adIntegration" name="adIntegration" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="ddosProtection" class="security-question-label">9.18 Are DDOS and Port scanning attacks Enabled?</label>
                            <select id="ddosProtection" name="ddosProtection" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="dlpEnabled" class="security-question-label">9.19 Is Data Loss Prevention enabled?</label>
                            <select id="dlpEnabled" name="dlpEnabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="realtimeScanning" class="security-question-label">9.20 Does the antivirus have real-time scanning enabled?</label>
                            <select id="realtimeScanning" name="realtimeScanning" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="allFileTypes" class="security-question-label">9.21 Is the antivirus configured to scan all file extensions? Are zip/compressed files scanned?</label>
                            <select id="allFileTypes" name="allFileTypes" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="scheduledScans" class="security-question-label">9.22 Has the bank scheduled periodic (at least weekly) full system scans?</label>
                            <select id="scheduledScans" name="scheduledScans" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="selfDefense" class="security-question-label">9.23 Does the antivirus client have a self-defense module enabled which restricts the user/program from performing changes or disabling them to the client antivirus software?</label>
                            <select id="selfDefense" name="selfDefense" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="webContentControl" class="security-question-label">9.24 Is there any mechanism to control web content?</label>
                            <select id="webContentControl" name="webContentControl" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="dashboardMonitoring" class="security-question-label">9.25 Is the antivirus dashboard monitored regularly for security events?</label>
                            <select id="dashboardMonitoring" name="dashboardMonitoring" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="ntpServer" class="security-question-label">9.26 Is there an NTP server configured?</label>
                            <select id="ntpServer" name="ntpServer" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="centralizedLogging" class="security-question-label">9.27 Is logging enabled and the logs stored on a centralized logging server?</label>
                            <select id="centralizedLogging" name="centralizedLogging" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="notificationsEnabled" class="security-question-label">9.28 Is the notifications option enabled?</label>
                            <select id="notificationsEnabled" name="notificationsEnabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="applicationControl" class="security-question-label">9.29 Is application control enabled?</label>
                            <select id="applicationControl" name="applicationControl" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('antivirusQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- ATM Questions Modal -->
        <div id="atmQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>ATM Assessment</h3>
                    <span class="close-modal" onclick="closeModal('atmQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="atmQuestionsForm" onsubmit="handleATMSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="physicalAttacksCardReaders" class="security-question-label">10.1 Are there any physical, local attacks that target account data/card readers?</label>
                            <select id="physicalAttacksCardReaders" name="physicalAttacksCardReaders" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="physicalAttacksPINs" class="security-question-label">10.2 Are there any physical, local attacks that target PINs?</label>
                            <select id="physicalAttacksPINs" name="physicalAttacksPINs" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="sensitiveAreasRestricted" class="security-question-label">10.3 Is the access to sensitive areas and resources in the cabinet restricted or not?</label>
                            <select id="sensitiveAreasRestricted" name="sensitiveAreasRestricted" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="eppValidApproval" class="security-question-label">10.4 Whether the EPP has valid approval or not?</label>
                            <select id="eppValidApproval" name="eppValidApproval" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="visualObservationPIN" class="security-question-label">10.5 Whether visual observation of PIN values is possible as the cardholder enters them?</label>
                            <select id="visualObservationPIN" name="visualObservationPIN" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="pinPolicy" class="security-question-label">10.6 Does the Bank have a policy for the Personal Identification Numbers, used by various sets of customers who access the Banks systems directly using channels like ATMs?</label>
                            <select id="pinPolicy" name="pinPolicy" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="cctvCamerasInstalled" class="security-question-label">10.7 Are there CCTV cameras installed in the proper position?</label>
                            <select id="cctvCamerasInstalled" name="cctvCamerasInstalled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="usbAccessDisabled" class="security-question-label">10.8 Whether the USB access is disabled or not?</label>
                            <select id="usbAccessDisabled" name="usbAccessDisabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="osUpToDate" class="security-question-label">10.9 Whether the OS is up-to-date with patches or not?</label>
                            <select id="osUpToDate" name="osUpToDate" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="expiredOS" class="security-question-label">10.10 Whether the expired or unlicensed version of OS is used?</label>
                            <select id="expiredOS" name="expiredOS" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="unwantedSoftware" class="security-question-label">10.11 Is there any unwanted software installed in the ATM?</label>
                            <select id="unwantedSoftware" name="unwantedSoftware" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="rogueSoftwareInstallation" class="security-question-label">10.12 Whether the installation of rogue software is possible or not?</label>
                            <select id="rogueSoftwareInstallation" name="rogueSoftwareInstallation" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="logsAvailable" class="security-question-label">10.13 Whether the logs are available or not?</label>
                            <select id="logsAvailable" name="logsAvailable" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="atmGrouted" class="security-question-label">10.14 Whether the ATM is grouted to a wall, pillar, floor, etc or not?</label>
                            <select id="atmGrouted" name="atmGrouted" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="cablesConcealed" class="security-question-label">10.15 Whether the Cables of ATM and CCTV are concealed or not?</label>
                            <select id="cablesConcealed" name="cablesConcealed" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="networkPortsAccessible" class="security-question-label">10.16 Are the network ports openly accessible?</label>
                            <select id="networkPortsAccessible" name="networkPortsAccessible" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="atmNetworkSegmented" class="security-question-label">10.17 Whether the ATM is network-segmented or not?</label>
                            <select id="atmNetworkSegmented" name="atmNetworkSegmented" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="atmSoftwareUpdated" class="security-question-label">10.18 Whether the ATM software is up-to-date with patches or not?</label>
                            <select id="atmSoftwareUpdated" name="atmSoftwareUpdated" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="unauthorizedLogChanges" class="security-question-label">10.19 Whether the unauthorized change in logs is possible or not?</label>
                            <select id="unauthorizedLogChanges" name="unauthorizedLogChanges" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="licensedAntivirus" class="security-question-label">10.20 Whether the licensed Antivirus is available and up-to-date with the latest database or not?</label>
                            <select id="licensedAntivirus" name="licensedAntivirus" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="cabinetDualPINs" class="security-question-label">10.21 Do the ATM cabinet properly locked and has two PINs from two different personnel to open the safe?</label>
                            <select id="cabinetDualPINs" name="cabinetDualPINs" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="preventiveMaintenance" class="security-question-label">10.22 Whether the preventive maintenance is performed with a defined periodicity or not?</label>
                            <select id="preventiveMaintenance" name="preventiveMaintenance" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="userAwareness" class="security-question-label">10.23 Whether the Do's and Don'ts for the user awareness available or not?</label>
                            <select id="userAwareness" name="userAwareness" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="guardAvailable" class="security-question-label">10.24 Whether the guard is available during non-banking hours or not?</label>
                            <select id="guardAvailable" name="guardAvailable" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('atmQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Mail and Messaging Questions Modal -->
        <div id="mailMessagingQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Mail and Messaging Assessment</h3>
                    <span class="close-modal" onclick="closeModal('mailMessagingQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="mailMessagingQuestionsForm" onsubmit="handleMailMessagingSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="publicDomainEmail" class="security-question-label">11.1 Is Public Domain Email used?</label>
                            <select id="publicDomainEmail" name="publicDomainEmail" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="twoStepVerification" class="security-question-label">11.2 Is Two-step verification present?</label>
                            <select id="twoStepVerification" name="twoStepVerification" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="deviceApproval" class="security-question-label">11.3 Is Device Approval configured?</label>
                            <select id="deviceApproval" name="deviceApproval" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="dkimDmarc" class="security-question-label">11.4 Is DKIM, and DMARC implemented in the Mail domain?</label>
                            <select id="dkimDmarc" name="dkimDmarc" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="emailSpoofing" class="security-question-label">11.5 Is Email Spoofing possible from the external and internal domains?</label>
                            <select id="emailSpoofing" name="emailSpoofing" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="virusSpamProtection" class="security-question-label">11.6 Is virus & spam protection Enabled?</label>
                            <select id="virusSpamProtection" name="virusSpamProtection" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="mailMonitoring" class="security-question-label">11.7 Is mail monitoring done?</label>
                            <select id="mailMonitoring" name="mailMonitoring" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="directoryHarvestPrevention" class="security-question-label">11.8 Is Directory Harvest prevention Enabled?</label>
                            <select id="directoryHarvestPrevention" name="directoryHarvestPrevention" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="senderAuthentication" class="security-question-label">11.9 Is there sender authentication for all approved senders?</label>
                            <select id="senderAuthentication" name="senderAuthentication" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="malwareScanning" class="security-question-label">11.10 Are all incoming emails scanned for malware?</label>
                            <select id="malwareScanning" name="malwareScanning" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="bankRecords" class="security-question-label">11.11 Whether all e-mails sent and received by employees via Bank's network are treated as Bank records?</label>
                            <select id="bankRecords" name="bankRecords" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="virusScanningProcedures" class="security-question-label">11.12 Whether there are procedures, which require that all the incoming e-mail messages be scanned for the virus to prevent virus infection to the Bank's network?</label>
                            <select id="virusScanningProcedures" name="virusScanningProcedures" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="imapPopDisabled" class="security-question-label">11.13 Is IMAP/POP access disabled?</label>
                            <select id="imapPopDisabled" name="imapPopDisabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="spfEnabled" class="security-question-label">11.14 Is Sender Policy Framework (SPF) enabled?</label>
                            <select id="spfEnabled" name="spfEnabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="addonsRestricted" class="security-question-label">11.15 Are Add-ons restricted for email and file sharing services?</label>
                            <select id="addonsRestricted" name="addonsRestricted" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="singleMailMultipleUsers" class="security-question-label">11.16 Whether Single mail is used by multiple user?</label>
                            <select id="singleMailMultipleUsers" name="singleMailMultipleUsers" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="passwordExpiry" class="security-question-label">11.17 Whether password expiry date is defined?</label>
                            <select id="passwordExpiry" name="passwordExpiry" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="lessSecureApps" class="security-question-label">11.18 Can less secure apps access user accounts?</label>
                            <select id="lessSecureApps" name="lessSecureApps" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="phishingDetection" class="security-question-label">11.19 Is Early phishing detection disabled?</label>
                            <select id="phishingDetection" name="phishingDetection" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="externalReplyWarning" class="security-question-label">11.20 Is an Unintended external reply warning off?</label>
                            <select id="externalReplyWarning" name="externalReplyWarning" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="inboundOutboundFiltering" class="security-question-label">11.21 Is Inbound and outbound filtering available?</label>
                            <select id="inboundOutboundFiltering" name="inboundOutboundFiltering" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="superAdminDailyUse" class="security-question-label">11.22 Is the Super Admin account used for daily administration?</label>
                            <select id="superAdminDailyUse" name="superAdminDailyUse" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="multipleAdminAccounts" class="security-question-label">11.23 Are multiple admin accounts set up to avoid any admin lockout?</label>
                            <select id="multipleAdminAccounts" name="multipleAdminAccounts" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="loggingEnabled" class="security-question-label">11.24 Is logging enabled as per the organization's logging policy?</label>
                            <select id="loggingEnabled" name="loggingEnabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="autoEmailForwarding" class="security-question-label">11.25 Is automatic Email forwarding Disabled?</label>
                            <select id="autoEmailForwarding" name="autoEmailForwarding" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="externalEmailBanner" class="security-question-label">11.26 Is the banner set for the external emails for users?</label>
                            <select id="externalEmailBanner" name="externalEmailBanner" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="vaptRegular" class="security-question-label">11.27 Is VAPT done regularly for the mail exchange server hosted internally?</label>
                            <select id="vaptRegular" name="vaptRegular" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="domainPolicyEnforced" class="security-question-label">11.28 Are mails outside of the domain policy enforced for internal users?</label>
                            <select id="domainPolicyEnforced" name="domainPolicyEnforced" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="ntpConfigured" class="security-question-label">11.29 Whether NTP is configured?</label>
                            <select id="ntpConfigured" name="ntpConfigured" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="spamFilterBypass" class="security-question-label">11.30 Are mails/domains configured to bypass spam filters?</label>
                            <select id="spamFilterBypass" name="spamFilterBypass" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="loginActivityReview" class="security-question-label">11.31 Are all login activities periodically reviewed?</label>
                            <select id="loginActivityReview" name="loginActivityReview" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="adminRecoveryOptions" class="security-question-label">11.32 Do all admin accounts have recovery options configured to recover from forgotten passwords, etc?</label>
                            <select id="adminRecoveryOptions" name="adminRecoveryOptions" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="adminAlertNotifications" class="security-question-label">11.33 Is admin email configured to receive alert notifications?</label>
                            <select id="adminAlertNotifications" name="adminAlertNotifications" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="thirdPartyAccessRestricted" class="security-question-label">11.34 Is Access from third-party services/applications restricted to drive?</label>
                            <select id="thirdPartyAccessRestricted" name="thirdPartyAccessRestricted" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="externalCalendarSharing" class="security-question-label">11.35 Is external calendar sharing limited to authorized users only?</label>
                            <select id="externalCalendarSharing" name="externalCalendarSharing" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="driveSharingRestricted" class="security-question-label">11.36 Is sharing option for Google Drive and OneDrive limited to authorized domains only?</label>
                            <select id="driveSharingRestricted" name="driveSharingRestricted" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="anonymousFileSharing" class="security-question-label">11.37 Is Anonymous file sharing disabled?</label>
                            <select id="anonymousFileSharing" name="anonymousFileSharing" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="internalSenderBypass" class="security-question-label">11.38 Is the Bypass spam filters option off for internal senders?</label>
                            <select id="internalSenderBypass" name="internalSenderBypass" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="uniqueEmailPerUser" class="security-question-label">11.39 Whether e-mail ID allotted to a user prevented from being used by another user?</label>
                            <select id="uniqueEmailPerUser" name="uniqueEmailPerUser" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="emailIdentification" class="security-question-label">11.40 Whether all e-mails are identified with a user's name or e-mail ID to facilitate tracking?</label>
                            <select id="emailIdentification" name="emailIdentification" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('mailMessagingQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- HO Win_Server Logical Review Questions Modal -->
        <div id="hoWinServerQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>HO Win_Server Logical Review Assessment</h3>
                    <span class="close-modal" onclick="closeModal('hoWinServerQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body scrollable-content">
                    <form id="hoWinServerQuestionsForm" onsubmit="handleHoWinServerSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="antivirusInstalled" class="security-question-label">12.1 Is Antivirus installed on the server?</label>
                            <select id="antivirusInstalled" name="antivirusInstalled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="physicalControlsAntivirus" class="security-question-label">12.2 Are physical controls established for Antivirus Server?</label>
                            <select id="physicalControlsAntivirus" name="physicalControlsAntivirus" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="internetAllowedServers" class="security-question-label">12.3 Is the Internet allowed on servers?</label>
                            <select id="internetAllowedServers" name="internetAllowedServers" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="reversibleEncryptionDisabled" class="security-question-label">12.4 Is 'Storing passwords using reversible encryption' set to 'Disabled'?</label>
                            <select id="reversibleEncryptionDisabled" name="reversibleEncryptionDisabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="accountLockoutDuration" class="security-question-label">12.5 Is 'Account lockout duration' set to '15 or more minutes'?</label>
                            <select id="accountLockoutDuration" name="accountLockoutDuration" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="administratorAccountDisabled" class="security-question-label">12.6 Is 'Accounts: Administrator account status' set to 'Disabled'?</label>
                            <select id="administratorAccountDisabled" name="administratorAccountDisabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="passwordExpirationPolicy" class="security-question-label">12.7 Is 'Do not allow password expiration time longer than required by policy' set to 'Enabled'?</label>
                            <select id="passwordExpirationPolicy" name="passwordExpirationPolicy" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="autoAdminLogonDisabled" class="security-question-label">12.8 Is 'MSS: (AutoAdminLogon) Enable Automatic Logon' set to 'Disabled'?</label>
                            <select id="autoAdminLogonDisabled" name="autoAdminLogonDisabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="firewallOutboundConnections" class="security-question-label">12.9 Is 'Windows Firewall: Domain: Outbound connections' set to 'Allow (default)'?</label>
                            <select id="firewallOutboundConnections" name="firewallOutboundConnections" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="anonymousSIDTranslationDisabled" class="security-question-label">12.10 Is 'Allow anonymous SID/Name translation' set to 'Disabled'?</label>
                            <select id="anonymousSIDTranslationDisabled" name="anonymousSIDTranslationDisabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="enforcePasswordHistory" class="security-question-label">12.11 Is 'Enforce password history' set to '24 or more passwords'?</label>
                            <select id="enforcePasswordHistory" name="enforcePasswordHistory" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="passwordComplexityEnabled" class="security-question-label">12.12 Is 'Password must meet complexity requirements' set to 'Enabled'?</label>
                            <select id="passwordComplexityEnabled" name="passwordComplexityEnabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="minimumPasswordAge" class="security-question-label">12.13 Is the 'Minimum password age' set to '1 or more day(s)'?</label>
                            <select id="minimumPasswordAge" name="minimumPasswordAge" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="dataEncryptionAES" class="security-question-label">12.14 Is all data between client and server encrypted using AES or other techniques?</label>
                            <select id="dataEncryptionAES" name="dataEncryptionAES" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="serverPatched" class="security-question-label">12.15 Is the server ported with the latest versions of patches and service pack?</label>
                            <select id="serverPatched" name="serverPatched" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="serverUpToDate" class="security-question-label">12.16 Is the server up to date?</label>
                            <select id="serverUpToDate" name="serverUpToDate" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="weakPasswordsInUse" class="security-question-label">12.17 Are Weak and Guessable passwords in use?</label>
                            <select id="weakPasswordsInUse" name="weakPasswordsInUse" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="administratorRightsInUse" class="security-question-label">12.18 Are Administrator Rights in use?</label>
                            <select id="administratorRightsInUse" name="administratorRightsInUse" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="usbAccessDisabled" class="security-question-label">12.19 Whether USB Access is disabled?</label>
                            <select id="usbAccessDisabled" name="usbAccessDisabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="authenticationPolicyDefined" class="security-question-label">12.20 Is the Authentication policy defined?</label>
                            <select id="authenticationPolicyDefined" name="authenticationPolicyDefined" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="restoreFilesPolicyDefined" class="security-question-label">12.21 Is the restore files and directories policy defined?</label>
                            <select id="restoreFilesPolicyDefined" name="restoreFilesPolicyDefined" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="credentialManagerAccess" class="security-question-label">12.22 Is 'Access Credential Manager as a trusted caller' set to 'No One'?</label>
                            <select id="credentialManagerAccess" name="credentialManagerAccess" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="allowLogonLocally" class="security-question-label">12.23 Is 'Allow log on locally' configured to authorized users only?</label>
                            <select id="allowLogonLocally" name="allowLogonLocally" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="allowLogonRDS" class="security-question-label">12.24 Is 'Allow log on through Remote Desktop Services' configured for authorized users only?</label>
                            <select id="allowLogonRDS" name="allowLogonRDS" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="blankPasswordsConsoleOnly" class="security-question-label">12.25 Is 'Accounts: Limit local account use of blank passwords to console logon only' set to 'Enabled'?</label>
                            <select id="blankPasswordsConsoleOnly" name="blankPasswordsConsoleOnly" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="firewallLoggingEnabled" class="security-question-label">12.26 Is 'Firewall: Domain: Logging: Log successful connections' set to 'Yes'?</label>
                            <select id="firewallLoggingEnabled" name="firewallLoggingEnabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="separateServerRoom" class="security-question-label">12.27 Is there a separate room for the server?</label>
                            <select id="separateServerRoom" name="separateServerRoom" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="adequateServerSpace" class="security-question-label">12.28 Is Server have adequate space for operational requirements?</label>
                            <select id="adequateServerSpace" name="adequateServerSpace" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="serverRoomVisible" class="security-question-label">12.29 Is the Server room visible from a distance, but not easily accessible?</label>
                            <select id="serverRoomVisible" name="serverRoomVisible" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="serverRoomAwayFromWater" class="security-question-label">12.30 Is the Server room away from the basement, and water/drainage systems?</label>
                            <select id="serverRoomAwayFromWater" name="serverRoomAwayFromWater" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="ipSourceRoutingEnabled" class="security-question-label">12.31 Is (Disable IP Source Routing) 'IP source routing protection level (protects against packet spoofing)' set to 'Enabled'?</label>
                            <select id="ipSourceRoutingEnabled" name="ipSourceRoutingEnabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="ipv6Disabled" class="security-question-label">12.32 Is IPv6 disabled?</label>
                            <select id="ipv6Disabled" name="ipv6Disabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="groupPolicyRefreshDisabled" class="security-question-label">12.33 Is 'Turn off background refresh of Group Policy' set to 'Disabled'?</label>
                            <select id="groupPolicyRefreshDisabled" name="groupPolicyRefreshDisabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="lockScreenCameraEnabled" class="security-question-label">12.34 Is 'Prevent enabling lock screen camera' set to 'Enabled'?</label>
                            <select id="lockScreenCameraEnabled" name="lockScreenCameraEnabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="auditLogonEnabled" class="security-question-label">12.35 Is 'Audit Logon' set to 'Success and Failure'?</label>
                            <select id="auditLogonEnabled" name="auditLogonEnabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="secureDesktopElevation" class="security-question-label">12.36 Is 'Switch to the secure desktop when prompting for elevation' set to 'Enabled'?</label>
                            <select id="secureDesktopElevation" name="secureDesktopElevation" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="adminApprovalModeEnabled" class="security-question-label">12.37 Is 'Run all administrators in Admin Approval Mode' set to 'Enabled'?</label>
                            <select id="adminApprovalModeEnabled" name="adminApprovalModeEnabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="forceLogoffEnabled" class="security-question-label">12.38 Is 'Force logoff when logon hours expire' set to 'Enabled'?</label>
                            <select id="forceLogoffEnabled" name="forceLogoffEnabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="passwordExpirationPrompt" class="security-question-label">12.39 Is 'Interactive logon: Prompt user to change the password before expiration' set to 'between 5 and 14 days'?</label>
                            <select id="passwordExpirationPrompt" name="passwordExpirationPrompt" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="hideLastUsername" class="security-question-label">12.40 Is 'Interactive logon: Do not display last user name' set to 'Enabled'?</label>
                            <select id="hideLastUsername" name="hideLastUsername" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="loadUnloadDrivers" class="security-question-label">12.41 Is 'Load and unload device drivers' set to 'Administrators'?</label>
                            <select id="loadUnloadDrivers" name="loadUnloadDrivers" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="debugPrograms" class="security-question-label">12.42 Is 'Debug programs' set to 'Administrators' only'?</label>
                            <select id="debugPrograms" name="debugPrograms" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('hoWinServerQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Linux Server Logical Review Questions Modal -->
        <div id="linuxServerQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Linux Server Logical Review Assessment</h3>
                    <span class="close-modal" onclick="closeModal('linuxServerQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="linuxServerQuestionsForm" onsubmit="handleLinuxServerSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="separateServerRoom" class="security-question-label">13.1 Is there a separate room for the server?</label>
                            <select id="separateServerRoom" name="separateServerRoom" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="antivirusInstalled" class="security-question-label">13.2 Is Anti-Virus installed on server?</label>
                            <select id="antivirusInstalled" name="antivirusInstalled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="physicalControlsAntivirus" class="security-question-label">13.3 Are physical controls established for Anti-Virus Server?</label>
                            <select id="physicalControlsAntivirus" name="physicalControlsAntivirus" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="internetAllowedServers" class="security-question-label">13.4 Is Internet allowed on servers?</label>
                            <select id="internetAllowedServers" name="internetAllowedServers" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="nisServerInstalled" class="security-question-label">13.5 Is NIS Server installed?</label>
                            <select id="nisServerInstalled" name="nisServerInstalled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="firewalldInstalled" class="security-question-label">13.6 Is firewalld installed?</label>
                            <select id="firewalldInstalled" name="firewalldInstalled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="selinuxConfigured" class="security-question-label">13.7 Is SELinux policy configured?</label>
                            <select id="selinuxConfigured" name="selinuxConfigured" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="telnetClientNotInstalled" class="security-question-label">13.8 Is telnet client not installed?</label>
                            <select id="telnetClientNotInstalled" name="telnetClientNotInstalled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="nodevOptionTmp" class="security-question-label">13.9 Is nodev option set on /tmp partition?</label>
                            <select id="nodevOptionTmp" name="nodevOptionTmp" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="updatesPatchesInstalled" class="security-question-label">13.10 Are updates, patches, and additional security software installed?</label>
                            <select id="updatesPatchesInstalled" name="updatesPatchesInstalled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="setroubleshootInstalled" class="security-question-label">13.11 Is SETroubleshoot installed?</label>
                            <select id="setroubleshootInstalled" name="setroubleshootInstalled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="rshClientNotInstalled" class="security-question-label">13.12 Is rsh client not installed?</label>
                            <select id="rshClientNotInstalled" name="rshClientNotInstalled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="nisClientNotInstalled" class="security-question-label">13.13 Is NIS Client not installed?</label>
                            <select id="nisClientNotInstalled" name="nisClientNotInstalled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="nisServerNotInstalled" class="security-question-label">13.14 Is NIS Server not installed?</label>
                            <select id="nisServerNotInstalled" name="nisServerNotInstalled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="tftpServerInstalled" class="security-question-label">13.15 Is tftp server installed?</label>
                            <select id="tftpServerInstalled" name="tftpServerInstalled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="telnetServerNotInstalled" class="security-question-label">13.16 Is telnet-server not installed?</label>
                            <select id="telnetServerNotInstalled" name="telnetServerNotInstalled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="talkClientNotInstalled" class="security-question-label">13.17 Is talk client not installed?</label>
                            <select id="talkClientNotInstalled" name="talkClientNotInstalled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="xinetdInstalled" class="security-question-label">13.18 Is xinetd installed?</label>
                            <select id="xinetdInstalled" name="xinetdInstalled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="dhcpServerInstalled" class="security-question-label">13.19 Is DHCP Server installed?</label>
                            <select id="dhcpServerInstalled" name="dhcpServerInstalled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="ldapServerInstalled" class="security-question-label">13.20 Is LDAP server installed?</label>
                            <select id="ldapServerInstalled" name="ldapServerInstalled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="imapPop3ServerInstalled" class="security-question-label">13.21 Is IMAP and POP3 server installed?</label>
                            <select id="imapPop3ServerInstalled" name="imapPop3ServerInstalled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="dnsServerInstalled" class="security-question-label">13.22 Is DNS Server installed?</label>
                            <select id="dnsServerInstalled" name="dnsServerInstalled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="ftpServerInstalled" class="security-question-label">13.23 Is FTP Server installed?</label>
                            <select id="ftpServerInstalled" name="ftpServerInstalled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="httpServerInstalled" class="security-question-label">13.24 Is HTTP server installed?</label>
                            <select id="httpServerInstalled" name="httpServerInstalled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="packetRedirectDisabled" class="security-question-label">13.25 Is packet redirect sending disabled - files 'net.ipv4.conf.all.send_redirects = 0'?</label>
                            <select id="packetRedirectDisabled" name="packetRedirectDisabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="secureIcmpRedirectsNotAccepted" class="security-question-label">13.26 Is secure ICMP redirects not accepted - 'net.ipv4.conf.all.secure_redirects = 0'?</label>
                            <select id="secureIcmpRedirectsNotAccepted" name="secureIcmpRedirectsNotAccepted" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="suspiciousPacketsLogged" class="security-question-label">13.27 Are suspicious packets logged - 'net.ipv4.conf.all.log_martians = 1'?</label>
                            <select id="suspiciousPacketsLogged" name="suspiciousPacketsLogged" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="sshAccessLimited" class="security-question-label">13.28 Is SSH access limited?</label>
                            <select id="sshAccessLimited" name="sshAccessLimited" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="adequateServerSpace" class="security-question-label">13.29 Does the server have adequate space for operational requirements?</label>
                            <select id="adequateServerSpace" name="adequateServerSpace" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="serverRoomVisible" class="security-question-label">13.30 Is the Server room visible from a distance, but not easily accessible?</label>
                            <select id="serverRoomVisible" name="serverRoomVisible" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="serverRoomAwayFromWater" class="security-question-label">13.31 Is the Server room away from the basement, water/drainage systems?</label>
                            <select id="serverRoomAwayFromWater" name="serverRoomAwayFromWater" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="tmpConfigured" class="security-question-label">13.32 Is /tmp configured?</label>
                            <select id="tmpConfigured" name="tmpConfigured" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="noexecOptionTmp" class="security-question-label">13.33 Is noexec option set on /tmp partition?</label>
                            <select id="noexecOptionTmp" name="noexecOptionTmp" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="sshMaxAuthTries" class="security-question-label">13.34 Is SSH MaxAuthTries set to 4 or less?</label>
                            <select id="sshMaxAuthTries" name="sshMaxAuthTries" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="homeNodevOption" class="security-question-label">13.35 Does /home partition include the nodev option?</label>
                            <select id="homeNodevOption" name="homeNodevOption" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="ntpConfigured" class="security-question-label">13.36 Is NTP configured?</label>
                            <select id="ntpConfigured" name="ntpConfigured" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="mailTransferAgentLocalOnly" class="security-question-label">13.37 Is mail transfer agent configured for local-only mode?</label>
                            <select id="mailTransferAgentLocalOnly" name="mailTransferAgentLocalOnly" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="rsyslogInstalled" class="security-question-label">13.38 Is rsyslog installed?</label>
                            <select id="rsyslogInstalled" name="rsyslogInstalled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="usbStorageModprobeDisabled" class="security-question-label">13.39 Is USB Storage - modprobe disabled?</label>
                            <select id="usbStorageModprobeDisabled" name="usbStorageModprobeDisabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="usbStorageLsmodDisabled" class="security-question-label">13.40 Is USB Storage - lsmod disabled?</label>
                            <select id="usbStorageLsmodDisabled" name="usbStorageLsmodDisabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="lastLoggedUserDisplayDisabled" class="security-question-label">13.41 Is last logged in user display disabled - disable user list?</label>
                            <select id="lastLoggedUserDisplayDisabled" name="lastLoggedUserDisplayDisabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="sambaUninstalled" class="security-question-label">13.42 Is Samba uninstalled?</label>
                            <select id="sambaUninstalled" name="sambaUninstalled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="sshRootLoginDisabled" class="security-question-label">13.43 Is SSH root login disabled?</label>
                            <select id="sshRootLoginDisabled" name="sshRootLoginDisabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="sshIdleTimeoutConfigured" class="security-question-label">13.44 Is SSH Idle Timeout Interval configured - ClientAliveCountMax?</label>
                            <select id="sshIdleTimeoutConfigured" name="sshIdleTimeoutConfigured" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="sshLoginGraceTime" class="security-question-label">13.45 Is SSH LoginGraceTime set to one minute or less?</label>
                            <select id="sshLoginGraceTime" name="sshLoginGraceTime" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="passwordCreationRequirements" class="security-question-label">13.46 Are password creation requirements configured - dcredit?</label>
                            <select id="passwordCreationRequirements" name="passwordCreationRequirements" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="passwordExpiration365Days" class="security-question-label">13.47 Is password expiration 365 days or less - login.defs?</label>
                            <select id="passwordExpiration365Days" name="passwordExpiration365Days" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="inactivePasswordLock30Days" class="security-question-label">13.48 Is inactive password lock 30 days or less - /etc/default/useradd?</label>
                            <select id="inactivePasswordLock30Days" name="inactivePasswordLock30Days" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="nosuidOptionTmp" class="security-question-label">13.49 Is nosuid option set on /tmp partition?</label>
                            <select id="nosuidOptionTmp" name="nosuidOptionTmp" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="sshX11ForwardingDisabled" class="security-question-label">13.50 Is SSH X11 forwarding disabled?</label>
                            <select id="sshX11ForwardingDisabled" name="sshX11ForwardingDisabled" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="sshWarningBannerConfigured" class="security-question-label">13.51 Is SSH warning banner configured?</label>
                            <select id="sshWarningBannerConfigured" name="sshWarningBannerConfigured" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="lockoutFailedPasswordAttempts" class="security-question-label">13.52 Is lockout for failed password attempts configured - password-auth 'auth sufficient pam_unix.so'?</label>
                            <select id="lockoutFailedPasswordAttempts" name="lockoutFailedPasswordAttempts" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="passwordReuseLimited" class="security-question-label">13.53 Is password reuse limited?</label>
                            <select id="passwordReuseLimited" name="passwordReuseLimited" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-group security-question-row">
                            <label for="minimumDaysPasswordChanges" class="security-question-label">13.54 Is minimum days between password changes configured - /etc/login.defs?</label>
                            <select id="minimumDaysPasswordChanges" name="minimumDaysPasswordChanges" class="security-question-input" required>
                                <option value="">Select Option</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('linuxServerQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- ESXi Server Logical Review Questions Modal -->
        <div id="esxiServerQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>ESXi Server Logical Review Assessment</h3>
                    <span class="close-modal" onclick="closeModal('esxiServerQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="esxiServerQuestionsForm" onsubmit="handleESXiServerSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="esxiSeparateServerRoom" class="security-question-label">14.1 Is there a separate room for the server?</label>
                            <select id="esxiSeparateServerRoom" name="esxiSeparateServerRoom" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="esxiAntivirusInstalled" class="security-question-label">14.2 Is Anti-Virus installed on server?</label>
                            <select id="esxiAntivirusInstalled" name="esxiAntivirusInstalled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="esxiPhysicalControlsAntivirus" class="security-question-label">14.3 Are physical controls established for Anti-Virus Server?</label>
                            <select id="esxiPhysicalControlsAntivirus" name="esxiPhysicalControlsAntivirus" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="esxiInternetAllowedServers" class="security-question-label">14.4 Is Internet allowed on servers?</label>
                            <select id="esxiInternetAllowedServers" name="esxiInternetAllowedServers" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="esxiSshAuthorizedKeysEmpty" class="security-question-label">14.5 Is SSH authorized_keys file empty?</label>
                            <select id="esxiSshAuthorizedKeysEmpty" name="esxiSshAuthorizedKeysEmpty" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="esxiImageProfileVibAcceptance" class="security-question-label">14.6 Is Image Profile VIB acceptance level configured properly?</label>
                            <select id="esxiImageProfileVibAcceptance" name="esxiImageProfileVibAcceptance" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="esxiUnauthorizedKernelModules" class="security-question-label">14.7 Are unauthorized kernel modules loaded on the host?</label>
                            <select id="esxiUnauthorizedKernelModules" name="esxiUnauthorizedKernelModules" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="esxiHostFirewallConfigured" class="security-question-label">14.8 Is ESXi host firewall configured to restrict access to services running on the host?</label>
                            <select id="esxiHostFirewallConfigured" name="esxiHostFirewallConfigured" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="esxiNonRootUserAccount" class="security-question-label">14.9 Does a non-root user account exist for local admin access?</label>
                            <select id="esxiNonRootUserAccount" name="esxiNonRootUserAccount" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="esxiAdequateServerSpace" class="security-question-label">14.10 Does the server have adequate space for operational requirements?</label>
                            <select id="esxiAdequateServerSpace" name="esxiAdequateServerSpace" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="esxiServerRoomVisible" class="security-question-label">14.11 Is the server room visible from a distance, but not easily accessible?</label>
                            <select id="esxiServerRoomVisible" name="esxiServerRoomVisible" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="esxiServerRoomAwayFromWater" class="security-question-label">14.12 Is the server room away from the basement, water/drainage systems?</label>
                            <select id="esxiServerRoomAwayFromWater" name="esxiServerRoomAwayFromWater" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="esxiDefaultSelfSignedCertificates" class="security-question-label">14.13 Are default self-signed certificates for ESXi communication not used?</label>
                            <select id="esxiDefaultSelfSignedCertificates" name="esxiDefaultSelfSignedCertificates" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="esxiExpiredRevokedCertificates" class="security-question-label">14.14 Are expired and revoked SSL certificates removed from the ESXi server?</label>
                            <select id="esxiExpiredRevokedCertificates" name="esxiExpiredRevokedCertificates" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="esxiCentralizedCoreDumps" class="security-question-label">14.15 Is a centralized location configured to collect ESXi host core dumps?</label>
                            <select id="esxiCentralizedCoreDumps" name="esxiCentralizedCoreDumps" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('esxiServerQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Access Control – OS Level Questions Modal -->
        <div id="accessControlOSQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Access Control – OS Level Assessment</h3>
                    <span class="close-modal" onclick="closeModal('accessControlOSQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="accessControlOSQuestionsForm" onsubmit="handleAccessControlOSSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="accessControlPasswordProtected" class="security-question-label">15.1 Is access to the systems only through password-protected user IDs?</label>
                            <select id="accessControlPasswordProtected" name="accessControlPasswordProtected" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="accessControlUnrestrictedAccess" class="security-question-label">15.2 Is unrestricted access to the systems provided only to the System Administrator?</label>
                            <select id="accessControlUnrestrictedAccess" name="accessControlUnrestrictedAccess" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="accessControlAdminRestricted" class="security-question-label">15.3 Is administration level access restricted to authorized and limited persons?</label>
                            <select id="accessControlAdminRestricted" name="accessControlAdminRestricted" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="accessControlUniqueUserID" class="security-question-label">15.4 Does the Operating System (OS) allot a unique user identity (ID) for all users?</label>
                            <select id="accessControlUniqueUserID" name="accessControlUniqueUserID" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="accessControlPasswordChangePrompt" class="security-question-label">15.5 Does the OS prompt for a change of the user password after the lapse of the specified period?</label>
                            <select id="accessControlPasswordChangePrompt" name="accessControlPasswordChangePrompt" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="accessControlOSInstallationRecord" class="security-question-label">15.6 Is a record maintained and authenticated regarding the installation of the Operating System, its up-gradation, re-installation, and maintenance?</label>
                            <select id="accessControlOSInstallationRecord" name="accessControlOSInstallationRecord" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="accessControlUserRegister" class="security-question-label">15.7 Is a register maintained in respect of all the OS level users, giving details such as the date of creation, suspension, cancellation, access rights granted, and the purpose of creation, etc?</label>
                            <select id="accessControlUserRegister" name="accessControlUserRegister" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="accessControlTemporaryUsersDisabled" class="security-question-label">15.8 Are users created for audit/maintenance purposes disabled immediately after the work is over?</label>
                            <select id="accessControlTemporaryUsersDisabled" name="accessControlTemporaryUsersDisabled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="accessControlSecurityFeaturesEnabled" class="security-question-label">15.9 Are all the security features available in the OS enabled/taken advantage of as far as possible for ensuring better security?</label>
                            <select id="accessControlSecurityFeaturesEnabled" name="accessControlSecurityFeaturesEnabled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="accessControlExitingPersonnelAccess" class="security-question-label">15.10 Is administration access available to officials who are under notice period, retiring shortly, or under disciplinary action?</label>
                            <select id="accessControlExitingPersonnelAccess" name="accessControlExitingPersonnelAccess" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="accessControlVirusPrevention" class="security-question-label">15.11 Does the OS provide for loading of virus prevention software and is it implemented?</label>
                            <select id="accessControlVirusPrevention" name="accessControlVirusPrevention" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="accessControlUserReview" class="security-question-label">15.12 Does the department review the number of OS-level users periodically?</label>
                            <select id="accessControlUserReview" name="accessControlUserReview" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('accessControlOSQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Access Control Application Questions Modal -->
        <div id="accessControlApplicationQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Access Control Application Assessment</h3>
                    <span class="close-modal" onclick="closeModal('accessControlApplicationQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="accessControlApplicationQuestionsForm" onsubmit="handleAccessControlApplicationSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="accessControlAppUniqueUserIDs" class="security-question-label">16.1 Does the system provide unique user IDs and passwords for all users?</label>
                            <select id="accessControlAppUniqueUserIDs" name="accessControlAppUniqueUserIDs" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="accessControlAppDifferentAccessLevels" class="security-question-label">16.2 Does the system provide different levels of access?</label>
                            <select id="accessControlAppDifferentAccessLevels" name="accessControlAppDifferentAccessLevels" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="accessControlAppDummyUserID" class="security-question-label">16.3 Is there a dummy user ID created in the system?</label>
                            <select id="accessControlAppDummyUserID" name="accessControlAppDummyUserID" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="accessControlAppPasswordSecrecy" class="security-question-label">16.4 Do users write their passwords on walls, desk diaries, etc.? Are they aware of the need for password secrecy?</label>
                            <select id="accessControlAppPasswordSecrecy" name="accessControlAppPasswordSecrecy" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="accessControlAppPasswordChangePrompt" class="security-question-label">16.5 Does the system prompt for a change of user password after the lapse of a specified period?</label>
                            <select id="accessControlAppPasswordChangePrompt" name="accessControlAppPasswordChangePrompt" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="accessControlAppSuperUserAccess" class="security-question-label">16.6 Is super user access at the application level not given to staff who are under notice period, retiring shortly, or under disciplinary action?</label>
                            <select id="accessControlAppSuperUserAccess" name="accessControlAppSuperUserAccess" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="accessControlAppConcurrentLogin" class="security-question-label">16.7 Does the system allow concurrent login to a single user ID from different nodes?</label>
                            <select id="accessControlAppConcurrentLogin" name="accessControlAppConcurrentLogin" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="accessControlAppAutoLogout" class="security-question-label">16.8 Does the system log out automatically if the user is inactive for a specified time?</label>
                            <select id="accessControlAppAutoLogout" name="accessControlAppAutoLogout" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="accessControlAppUserCancelID" class="security-question-label">16.9 Does the system allow users to cancel their user ID?</label>
                            <select id="accessControlAppUserCancelID" name="accessControlAppUserCancelID" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="accessControlAppPasswordSharing" class="security-question-label">16.10 Do users share their passwords?</label>
                            <select id="accessControlAppPasswordSharing" name="accessControlAppPasswordSharing" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="accessControlAppSecurityFeatures" class="security-question-label">16.11 Does the application make use of all the security features available at the application system level?</label>
                            <select id="accessControlAppSecurityFeatures" name="accessControlAppSecurityFeatures" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="accessControlAppUserListReview" class="security-question-label">16.12 Is the application system user list periodically reviewed?</label>
                            <select id="accessControlAppUserListReview" name="accessControlAppUserListReview" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('accessControlApplicationQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Application Questions Modal -->
        <div id="applicationQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Application Assessment</h3>
                    <span class="close-modal" onclick="closeModal('applicationQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="applicationQuestionsForm" onsubmit="handleApplicationSubmit(event)">
                        <div class="form-group">
                            <label for="applicationName" class="form-label">Application Name:</label>
                            <input type="text" id="applicationName" name="applicationName" class="form-input" placeholder="Enter application name" required>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="appPasswordEncrypted" class="security-question-label">17.1 Verify whether the password is displayed in an encrypted format or not?</label>
                            <select id="appPasswordEncrypted" name="appPasswordEncrypted" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appPasswordRules" class="security-question-label">17.2 Verify whether the password rules are implemented on pages like signup, forgot password, and change password?</label>
                            <select id="appPasswordRules" name="appPasswordRules" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appOldPasswordLogin" class="security-question-label">17.3 Whether the user is allowed to log in with an old password after a password change?</label>
                            <select id="appOldPasswordLogin" name="appOldPasswordLogin" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appPasswordInCookies" class="security-question-label">17.4 Whether passwords are stored in cookies or not?</label>
                            <select id="appPasswordInCookies" name="appPasswordInCookies" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appSessionTimeout" class="security-question-label">17.5 Is session timeout functionality properly working?</label>
                            <select id="appSessionTimeout" name="appSessionTimeout" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appFileUpload" class="security-question-label">17.6 Whether the user can upload a file?</label>
                            <select id="appFileUpload" name="appFileUpload" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appHTTPS" class="security-question-label">17.7 Whether the web application is using HTTPS (SSL certificate) or not?</label>
                            <select id="appHTTPS" name="appHTTPS" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appAccountLockout" class="security-question-label">17.8 Does the software lock the user ID if it is used for 3 unsuccessful login attempts?</label>
                            <select id="appAccountLockout" name="appAccountLockout" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appMakerCheckerSame" class="security-question-label">17.9 Does the software allow the same user to be both maker and checker of the same transaction?</label>
                            <select id="appMakerCheckerSame" name="appMakerCheckerSame" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appConcurrencyControl" class="security-question-label">17.10 Whether proper consistency/concurrency of user inputs is maintained if two users access the same record simultaneously?</label>
                            <select id="appConcurrencyControl" name="appConcurrencyControl" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appKeyDataAuthorization" class="security-question-label">17.11 Whether the key data is authorized by an appropriate level of users and kept secure?</label>
                            <select id="appKeyDataAuthorization" name="appKeyDataAuthorization" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appTransactionIdentifiable" class="security-question-label">17.12 Are the transactions for the day identifiable?</label>
                            <select id="appTransactionIdentifiable" name="appTransactionIdentifiable" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appBatchEventLog" class="security-question-label">17.13 Is there an event log for the batch processes?</label>
                            <select id="appBatchEventLog" name="appBatchEventLog" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appAuditTrail" class="security-question-label">17.14 Whether the software maintains an audit trail to uniquely trace any modification/deletion/addition with user ID?</label>
                            <select id="appAuditTrail" name="appAuditTrail" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appReportFormat" class="security-question-label">17.15 Whether the format, contents, accuracy, and utility of the reports generated by the system are appropriate?</label>
                            <select id="appReportFormat" name="appReportFormat" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appOutputControlInfo" class="security-question-label">17.16 Does the output contain key control information necessary to validate the accuracy and completeness?</label>
                            <select id="appOutputControlInfo" name="appOutputControlInfo" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appManualIntervention" class="security-question-label">17.17 Is manual intervention possible when data passes from one process to another?</label>
                            <select id="appManualIntervention" name="appManualIntervention" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appMakerCheckerPrevention" class="security-question-label">17.18 Does the software prevent the same user from performing both the functions of entering a transaction and verifying the same?</label>
                            <select id="appMakerCheckerPrevention" name="appMakerCheckerPrevention" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appManualAuthorizationControl" class="security-question-label">17.19 If transactions are authorized manually, are there controls to ensure that?</label>
                            <select id="appManualAuthorizationControl" name="appManualAuthorizationControl" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appChangeManagementProcedure" class="security-question-label">17.20 Is Change Management procedure including testing &amp; documentation of change followed?</label>
                            <select id="appChangeManagementProcedure" name="appChangeManagementProcedure" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appWrongPasswordPolicy" class="security-question-label">17.21 Verify whether the wrong password policy is defined or not?</label>
                            <select id="appWrongPasswordPolicy" name="appWrongPasswordPolicy" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="app2FA" class="security-question-label">17.22 Whether 2FA is available or not?</label>
                            <select id="app2FA" name="app2FA" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appCookieDeletion" class="security-question-label">17.23 What happens if a user deletes cookies while on the site?</label>
                            <select id="appCookieDeletion" name="appCookieDeletion" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appCustomErrorPage" class="security-question-label">17.24 Whether the user gets redirected to a custom error page during functionality failure?</label>
                            <select id="appCustomErrorPage" name="appCustomErrorPage" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appBrowserCompatibility" class="security-question-label">17.25 Does the application open in a different browser?</label>
                            <select id="appBrowserCompatibility" name="appBrowserCompatibility" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appResponsive" class="security-question-label">17.26 Whether the application is responsive or not?</label>
                            <select id="appResponsive" name="appResponsive" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appErrorMessages" class="security-question-label">17.27 Whether the error messages display any important information?</label>
                            <select id="appErrorMessages" name="appErrorMessages" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appNegativeNumbers" class="security-question-label">17.28 Whether negative numbers are allowed for numeric fields?</label>
                            <select id="appNegativeNumbers" name="appNegativeNumbers" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appConfirmationMessage" class="security-question-label">17.29 Whether a confirmation message is displayed for update and delete operations?</label>
                            <select id="appConfirmationMessage" name="appConfirmationMessage" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appMaxSizePopup" class="security-question-label">17.30 Whether a pop-up message displays if the data reaches the maximum size of the field?</label>
                            <select id="appMaxSizePopup" name="appMaxSizePopup" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appSpecialCharacters" class="security-question-label">17.31 Whether special characters are accepted in input fields?</label>
                            <select id="appSpecialCharacters" name="appSpecialCharacters" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appButtonFunctionality" class="security-question-label">17.32 Whether the functionality of the buttons is available and properly working?</label>
                            <select id="appButtonFunctionality" name="appButtonFunctionality" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appErrorDisplay" class="security-question-label">17.33 Whether error messages are displayed correctly?</label>
                            <select id="appErrorDisplay" name="appErrorDisplay" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appDuplicateUserID" class="security-question-label">17.34 Does the software allow the creation of user IDs with the same name more than once?</label>
                            <select id="appDuplicateUserID" name="appDuplicateUserID" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appOutdatedLibrariesMechanism" class="security-question-label">17.35 Is there a mechanism to identify and remove outdated libraries, frameworks, or plugins that introduce vulnerabilities?</label>
                            <select id="appOutdatedLibrariesMechanism" name="appOutdatedLibrariesMechanism" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appDataTransmissionEncrypted" class="security-question-label">17.36 Is data transmission encrypted using TLS 1.2/1.3 to prevent interception?</label>
                            <select id="appDataTransmissionEncrypted" name="appDataTransmissionEncrypted" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appCBSBackupEnsured" class="security-question-label">17.37 Is CBS backup ensured? What is the duration of backup? Whether backup is secure?</label>
                            <select id="appCBSBackupEnsured" name="appCBSBackupEnsured" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appPasswordHistory" class="security-question-label">17.38 Does the software maintain password history?</label>
                            <select id="appPasswordHistory" name="appPasswordHistory" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appAssetMovementAuth" class="security-question-label">17.39 Are all asset movements supported by suitable written authorizations?</label>
                            <select id="appAssetMovementAuth" name="appAssetMovementAuth" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appNameFieldValidation" class="security-question-label">17.40 Whether input validation for name fields is available?</label>
                            <select id="appNameFieldValidation" name="appNameFieldValidation" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-group security-question-row">
                            <label for="appNumericFieldValidation" class="security-question-label">17.41 Whether input validation for numeric fields is available?</label>
                            <select id="appNumericFieldValidation" name="appNumericFieldValidation" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('applicationQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Internet Banking Questions Modal -->
        <div id="internetBankingQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Internet Banking Assessment</h3>
                    <span class="close-modal" onclick="closeModal('internetBankingQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="internetBankingQuestionsForm" onsubmit="handleInternetBankingSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="ibServerDatabaseVLAN" class="security-question-label">18.1 Are server and database separate with VLANs?</label>
                            <select id="ibServerDatabaseVLAN" name="ibServerDatabaseVLAN" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibDisasterRecoveryPlan" class="security-question-label">18.2 Does the disaster recoverability testing plan exist?</label>
                            <select id="ibDisasterRecoveryPlan" name="ibDisasterRecoveryPlan" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibWebServerDMZ" class="security-question-label">18.3 Is the IB Web server hosted in a Demilitarized Zone (DMZ)?</label>
                            <select id="ibWebServerDMZ" name="ibWebServerDMZ" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibServerDatabaseUpdated" class="security-question-label">18.4 Is the server and database of internet banking updated and secured?</label>
                            <select id="ibServerDatabaseUpdated" name="ibServerDatabaseUpdated" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibPasswordPolicyValidation" class="security-question-label">18.5 Is there any validation to follow the standard password policy?</label>
                            <select id="ibPasswordPolicyValidation" name="ibPasswordPolicyValidation" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibApplicationLatestTested" class="security-question-label">18.6 Is the internet banking application the latest and well tested?</label>
                            <select id="ibApplicationLatestTested" name="ibApplicationLatestTested" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibSSLUsed" class="security-question-label">18.7 Is SSL used?</label>
                            <select id="ibSSLUsed" name="ibSSLUsed" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibVAPTPerformed" class="security-question-label">18.8 Is VAPT performed on the IB server and application?</label>
                            <select id="ibVAPTPerformed" name="ibVAPTPerformed" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibWAFIPSUsed" class="security-question-label">18.9 Is WAF or IPS used by the bank?</label>
                            <select id="ibWAFIPSUsed" name="ibWAFIPSUsed" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibTLSVersion" class="security-question-label">18.10 Is IB running on HTTP TLS version 1.2 or greater?</label>
                            <select id="ibTLSVersion" name="ibTLSVersion" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibUnusedServicesDisabled" class="security-question-label">18.11 Are unused services like FTP, NFS, and TELNET disabled?</label>
                            <select id="ibUnusedServicesDisabled" name="ibUnusedServicesDisabled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibApplicationWhitelisting" class="security-question-label">18.12 Are only whitelisted applications allowed to execute on the IB Server?</label>
                            <select id="ibApplicationWhitelisting" name="ibApplicationWhitelisting" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibDataEncryptionAES" class="security-question-label">18.13 Are all data between client and server encrypted using AES or other techniques?</label>
                            <select id="ibDataEncryptionAES" name="ibDataEncryptionAES" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibPIIEncrypted" class="security-question-label">18.14 Are all PII and sensitive customer information stored in encrypted form in the database?</label>
                            <select id="ibPIIEncrypted" name="ibPIIEncrypted" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibAccessControlPolicy" class="security-question-label">18.15 Is there an access control policy on the web and database server?</label>
                            <select id="ibAccessControlPolicy" name="ibAccessControlPolicy" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibServerHardened" class="security-question-label">18.16 Is the server hosting the IB application & DB hardened?</label>
                            <select id="ibServerHardened" name="ibServerHardened" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibOSSecurityReview" class="security-question-label">18.17 Is operating system security review done on all servers used for internet banking?</label>
                            <select id="ibOSSecurityReview" name="ibOSSecurityReview" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibPasswordHistory" class="security-question-label">18.18 Does the software maintain password history (prevent reuse)?</label>
                            <select id="ibPasswordHistory" name="ibPasswordHistory" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibPINPolicy" class="security-question-label">18.19 Does the bank have a policy for the Personal Identification Numbers used by customers accessing internet banking?</label>
                            <select id="ibPINPolicy" name="ibPINPolicy" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibLoggingEnabled" class="security-question-label">18.20 Is logging enabled?</label>
                            <select id="ibLoggingEnabled" name="ibLoggingEnabled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibMultiFactorAuth" class="security-question-label">18.21 Is multi-factor authentication present?</label>
                            <select id="ibMultiFactorAuth" name="ibMultiFactorAuth" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibLoadBalancer" class="security-question-label">18.22 Is a load balancer in use?</label>
                            <select id="ibLoadBalancer" name="ibLoadBalancer" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibPCIDSSAudit" class="security-question-label">18.23 Has a PCI-DSS audit been done?</label>
                            <select id="ibPCIDSSAudit" name="ibPCIDSSAudit" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibPasswordEncryptedMode" class="security-question-label">18.24 Is the password displayed in encrypted mode?</label>
                            <select id="ibPasswordEncryptedMode" name="ibPasswordEncryptedMode" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibPasswordComplexity" class="security-question-label">18.25 Does the system enforce a minimum password length with alpha, numeric, and special character combinations?</label>
                            <select id="ibPasswordComplexity" name="ibPasswordComplexity" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibPasswordExpiration" class="security-question-label">18.26 Does the software force the user to change the password at set periodic intervals?</label>
                            <select id="ibPasswordExpiration" name="ibPasswordExpiration" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibDigitalCertificates" class="security-question-label">18.27 Are digital certificates available?</label>
                            <select id="ibDigitalCertificates" name="ibDigitalCertificates" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibBrowserProtection" class="security-question-label">18.28 Is there any browser protection mechanism?</label>
                            <select id="ibBrowserProtection" name="ibBrowserProtection" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ibBehaviorAnalytics" class="security-question-label">18.29 Is user and entity behavior analytics implemented for fraud detection?</label>
                            <select id="ibBehaviorAnalytics" name="ibBehaviorAnalytics" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('internetBankingQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Internal Control Evaluation Questions Modal -->
        <div id="internalControlQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Internal Control Evaluation Assessment</h3>
                    <span class="close-modal" onclick="closeModal('internalControlQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="internalControlQuestionsForm" onsubmit="handleInternalControlSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="iceAuditEvidenceReliability" class="security-question-label">19.1 Are the internal controls in place to provide reliance on the control procedures for the information/evidence gathered during the audit?</label>
                            <select id="iceAuditEvidenceReliability" name="iceAuditEvidenceReliability" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="iceInternalAuditConducted" class="security-question-label">19.2 Is internal audit conducted by the bank?</label>
                            <select id="iceInternalAuditConducted" name="iceInternalAuditConducted" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('internalControlQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Fire Protection Questions Modal -->
        <div id="fireProtectionQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Fire Protection Assessment</h3>
                    <span class="close-modal" onclick="closeModal('fireProtectionQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="fireProtectionQuestionsForm" onsubmit="handleFireProtectionSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="fpFireAlarmSystem" class="security-question-label">20.1 Is the fire alarm system installed?</label>
                            <select id="fpFireAlarmSystem" name="fpFireAlarmSystem" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="fpSmokeDetectors" class="security-question-label">20.2 Are smoke detectors provided in the server room and other areas of computer installations?</label>
                            <select id="fpSmokeDetectors" name="fpSmokeDetectors" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="fpSmokeDetectorsTested" class="security-question-label">20.3 Are smoke detectors tested regularly to ensure they are working properly?</label>
                            <select id="fpSmokeDetectorsTested" name="fpSmokeDetectorsTested" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="fpFireExtinguishersInstalled" class="security-question-label">20.4 Are fire extinguishers installed at strategic places like the server room, UPS room, and near the nodes and printers?</label>
                            <select id="fpFireExtinguishersInstalled" name="fpFireExtinguishersInstalled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="fpFireExtinguishersMaintained" class="security-question-label">20.5 Are fire extinguishers regularly refilled/maintained?</label>
                            <select id="fpFireExtinguishersMaintained" name="fpFireExtinguishersMaintained" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="fpStaffTraining" class="security-question-label">20.6 Does staff know how to use the fire extinguishers?</label>
                            <select id="fpStaffTraining" name="fpStaffTraining" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="fpEvacuationPlan" class="security-question-label">20.7 Is the evacuation plan documented and rehearsed at regular intervals for immediate action in case of a fire outbreak?</label>
                            <select id="fpEvacuationPlan" name="fpEvacuationPlan" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('fireProtectionQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- AMC Questions Modal -->
        <div id="amcQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>AMC Assessment</h3>
                    <span class="close-modal" onclick="closeModal('amcQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="amcQuestionsForm" onsubmit="handleAMCSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="amcIdentityVerification" class="security-question-label">21.1 Is access for maintenance purposes granted only after verifying the identity of the service person?</label>
                            <select id="amcIdentityVerification" name="amcIdentityVerification" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="amcStampedAgreements" class="security-question-label">21.2 Are stamped agreements for maintenance contracts executed and available?</label>
                            <select id="amcStampedAgreements" name="amcStampedAgreements" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="amcActivityReporting" class="security-question-label">21.3 Are activities carried out during maintenance reported in the registers and duly authenticated?</label>
                            <select id="amcActivityReporting" name="amcActivityReporting" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="amcContractRenewalRates" class="security-question-label">21.4 Are contract renewal rates maintained in the register?</label>
                            <select id="amcContractRenewalRates" name="amcContractRenewalRates" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="amcStaffSupportAvailability" class="security-question-label">21.5 Is the maintenance staff support available in time?</label>
                            <select id="amcStaffSupportAvailability" name="amcStaffSupportAvailability" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('amcQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Data Input Controls Questions Modal -->
        <div id="dataInputControlQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Data Input Controls Assessment</h3>
                    <span class="close-modal" onclick="closeModal('dataInputControlQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="dataInputControlQuestionsForm" onsubmit="handleDataInputControlSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="dicSignatureHistory" class="security-question-label">22.1 Is the history of signatures scanned available in the system?</label>
                            <select id="dicSignatureHistory" name="dicSignatureHistory" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="dicChequeBookStock" class="security-question-label">22.2 Is the entire stock of cheque books fed into the system?</label>
                            <select id="dicChequeBookStock" name="dicChequeBookStock" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="dicDailyChequeBookEntry" class="security-question-label">22.3 Are the issued cheque books entered and confirmed in the system on a day-to-day basis?</label>
                            <select id="dicDailyChequeBookEntry" name="dicDailyChequeBookEntry" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('dataInputControlQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Purging of Data Files Questions Modal -->
        <div id="purgingDataFilesQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Purging of Data Files Assessment</h3>
                    <span class="close-modal" onclick="closeModal('purgingDataFilesQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="purgingDataFilesQuestionsForm" onsubmit="handlePurgingDataFilesSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="pdfBackupMediaCustody" class="security-question-label">23.1 Is purged backup media kept properly under safe custody?</label>
                            <select id="pdfBackupMediaCustody" name="pdfBackupMediaCustody" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="pdfPurgingActivityRecorded" class="security-question-label">23.2 Is the purging activity recorded and maintained in a register?</label>
                            <select id="pdfPurgingActivityRecorded" name="pdfPurgingActivityRecorded" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="pdfAccessRestricted" class="security-question-label">23.3 Is access to purged data restricted?</label>
                            <select id="pdfAccessRestricted" name="pdfAccessRestricted" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('purgingDataFilesQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Business Continuity Planning Questions Modal -->
        <div id="businessContinuityPlanningQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Business Continuity Planning Assessment</h3>
                    <span class="close-modal" onclick="closeModal('businessContinuityPlanningQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="businessContinuityPlanningQuestionsForm" onsubmit="handleBusinessContinuityPlanningSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="bcpDocumented" class="security-question-label">24.1 Has the business continuity plan (BCP) been documented?</label>
                            <select id="bcpDocumented" name="bcpDocumented" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="bcpCoversAllDisasterLevels" class="security-question-label">24.2 Does the BCP cover all levels of disaster, from partial to total destruction of facilities, and provide guidelines to determine the level of recovery necessary?</label>
                            <select id="bcpCoversAllDisasterLevels" name="bcpCoversAllDisasterLevels" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="bcpAlternateHardwareSoftware" class="security-question-label">24.3 Is a ready or alternate source of hardware/software available to resume business activity within the shortest possible time after disruption?</label>
                            <select id="bcpAlternateHardwareSoftware" name="bcpAlternateHardwareSoftware" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="bcpReliableBackup" class="security-question-label">24.4 Is a reliable backup of data and software available at all times for restoration?</label>
                            <select id="bcpReliableBackup" name="bcpReliableBackup" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="bcpTestsConducted" class="security-question-label">24.5 Are BCP tests conducted regularly, and what are the results?</label>
                            <select id="bcpTestsConducted" name="bcpTestsConducted" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="bcpWeaknessesAddressed" class="security-question-label">24.6 How are identified weaknesses in the BCP addressed?</label>
                            <select id="bcpWeaknessesAddressed" name="bcpWeaknessesAddressed" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="bcpOffSiteStorage" class="security-question-label">24.7 Is a copy of the BCP stored securely off-site?</label>
                            <select id="bcpOffSiteStorage" name="bcpOffSiteStorage" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('businessContinuityPlanningQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- In-house and Out-sourced Questions Modal -->
        <div id="inhouseOutsourcedQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>In-house and Out-sourced Assessment</h3>
                    <span class="close-modal" onclick="closeModal('inhouseOutsourcedQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="inhouseOutsourcedQuestionsForm" onsubmit="handleInhouseOutsourcedSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="ioPreDefinedFormats" class="security-question-label">25.1 Is the software designed using pre-defined formats at three levels: program level, application level, and organization level?</label>
                            <select id="ioPreDefinedFormats" name="ioPreDefinedFormats" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ioStandardizedQualityProcesses" class="security-question-label">25.2 Has the IT department adopted any standardized quality processes such as ISO, SEI CMM, etc., for software development?</label>
                            <select id="ioStandardizedQualityProcesses" name="ioStandardizedQualityProcesses" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ioSoftwareTestedQA" class="security-question-label">25.3 Is software tested for quality assurance?</label>
                            <select id="ioSoftwareTestedQA" name="ioSoftwareTestedQA" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ioInputValidationChecks" class="security-question-label">25.4 Are adequate input validation checks built into data entry programs?</label>
                            <select id="ioInputValidationChecks" name="ioInputValidationChecks" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ioSecurityRequirements" class="security-question-label">25.5 Does the development process consider security requirements as per the approved security policy?</label>
                            <select id="ioSecurityRequirements" name="ioSecurityRequirements" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ioPatchUpdateAuthorization" class="security-question-label">25.6 Is every patch/update authorized by a competent authority?</label>
                            <select id="ioPatchUpdateAuthorization" name="ioPatchUpdateAuthorization" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ioQATeamSeparate" class="security-question-label">25.7 Is the quality assurance team separate from the development team?</label>
                            <select id="ioQATeamSeparate" name="ioQATeamSeparate" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ioTestDataPreserved" class="security-question-label">25.8 Are data/test results preserved for future reference?</label>
                            <select id="ioTestDataPreserved" name="ioTestDataPreserved" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ioTestingProcedures" class="security-question-label">25.9 Are well-established testing procedures in place?</label>
                            <select id="ioTestingProcedures" name="ioTestingProcedures" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('inhouseOutsourcedQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Audit Trail Questions Modal -->
        <div id="auditTrailQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Audit Trail Assessment</h3>
                    <span class="close-modal" onclick="closeModal('auditTrailQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="auditTrailQuestionsForm" onsubmit="handleAuditTrailSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="atUserIDGeneration" class="security-question-label">26.1 Does the audit trail report generate the user ID of the operator and official for any addition/modification/deletion of transaction data in the database?</label>
                            <select id="atUserIDGeneration" name="atUserIDGeneration" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="atDailyReportGeneration" class="security-question-label">26.2 Is the audit trail report generated daily, and are entries scrutinized and verified?</label>
                            <select id="atDailyReportGeneration" name="atDailyReportGeneration" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="atIdentificationAuthentication" class="security-question-label">26.3 Does the audit trail for products/services record all identification and authentication processes?</label>
                            <select id="atIdentificationAuthentication" name="atIdentificationAuthentication" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="atPrivilegedUserActions" class="security-question-label">26.4 Is there a process to log and review all actions performed by system operators, system managers, system engineers, system administrators, security administrators, and highly privileged IDs?</label>
                            <select id="atPrivilegedUserActions" name="atPrivilegedUserActions" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="atCanceledEntriesReview" class="security-question-label">26.5 Is a list of canceled entries scrutinized, and are reasons for cancellation recorded?</label>
                            <select id="atCanceledEntriesReview" name="atCanceledEntriesReview" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('auditTrailQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Packaged Software Questions Modal -->
        <div id="packagedSoftwareQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Packaged Software Assessment</h3>
                    <span class="close-modal" onclick="closeModal('packagedSoftwareQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="packagedSoftwareQuestionsForm" onsubmit="handlePackagedSoftwareSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="psPlanISStrategy" class="security-question-label">27.1 Is the plan in line with the bank's overall IS strategy?</label>
                            <select id="psPlanISStrategy" name="psPlanISStrategy" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="psSponsorApproval" class="security-question-label">27.2 Has the sponsor approved the requirement document?</label>
                            <select id="psSponsorApproval" name="psSponsorApproval" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="psRequirementsDocumented" class="security-question-label">27.3 Has a document been prepared clearly detailing the requirements?</label>
                            <select id="psRequirementsDocumented" name="psRequirementsDocumented" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="psTechnologyStandards" class="security-question-label">27.4 Does the IT department have a technology standard for product selection?</label>
                            <select id="psTechnologyStandards" name="psTechnologyStandards" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="psLicensingTerms" class="security-question-label">27.5 Does the bank have approved terms and conditions for product licensing agreements?</label>
                            <select id="psLicensingTerms" name="psLicensingTerms" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="psContractSegregation" class="security-question-label">27.6 Does the contract segregate the duties and responsibilities of the bank and the vendor?</label>
                            <select id="psContractSegregation" name="psContractSegregation" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="psBackupDRPerformance" class="security-question-label">27.7 Has the IT department taken the required consequential actions for backup, disaster recovery, and performance tuning?</label>
                            <select id="psBackupDRPerformance" name="psBackupDRPerformance" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="psSystemAdministrator" class="security-question-label">27.8 Is there an identified system administrator responsible for managing access, backups, and ensuring database controls?</label>
                            <select id="psSystemAdministrator" name="psSystemAdministrator" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="psScoringModel" class="security-question-label">27.9 Does the IT department use a scoring model for evaluating products and vendors?</label>
                            <select id="psScoringModel" name="psScoringModel" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="psScoringCriteria" class="security-question-label">27.10 Do the scoring criteria consider all relevant aspects?</label>
                            <select id="psScoringCriteria" name="psScoringCriteria" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="psVendorSupportMeasurement" class="security-question-label">27.11 Is there a system for measuring vendors' support against agreed service levels?</label>
                            <select id="psVendorSupportMeasurement" name="psVendorSupportMeasurement" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="psAcceptanceCriteria" class="security-question-label">27.12 Has the requirements document been clearly translated into product acceptance criteria?</label>
                            <select id="psAcceptanceCriteria" name="psAcceptanceCriteria" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('packagedSoftwareQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- User Account Maintenance Questions Modal -->
        <div id="userAccountMaintenanceQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>User Account Maintenance Assessment</h3>
                    <span class="close-modal" onclick="closeModal('userAccountMaintenanceQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="userAccountMaintenanceQuestionsForm" onsubmit="handleUserAccountMaintenanceSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="uamUserIDApproval" class="security-question-label">28.1 Is every user ID at the operating system level created only after specific approval from the Branch Manager/Department Head in writing on a request form signed by the respective user?</label>
                            <select id="uamUserIDApproval" name="uamUserIDApproval" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="uamPasswordProtection" class="security-question-label">28.2 Are all user IDs protected with passwords?</label>
                            <select id="uamPasswordProtection" name="uamPasswordProtection" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="uamUserProfileRegister" class="security-question-label">28.3 Is the branch/office maintaining a user profile register apart from the approved request forms?</label>
                            <select id="uamUserProfileRegister" name="uamUserProfileRegister" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="uamSuperUserPrivileges" class="security-question-label">28.4 Do the operating system user IDs have security equivalence to Super User?</label>
                            <select id="uamSuperUserPrivileges" name="uamSuperUserPrivileges" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="uamDefaultAccountsDisabled" class="security-question-label">28.5 Are all default system login accounts disabled?</label>
                            <select id="uamDefaultAccountsDisabled" name="uamDefaultAccountsDisabled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('userAccountMaintenanceQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Logical Access Controls Questions Modal -->
        <div id="logicalAccessControlsQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Logical Access Controls Assessment</h3>
                    <span class="close-modal" onclick="closeModal('logicalAccessControlsQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="logicalAccessControlsQuestionsForm" onsubmit="handleLogicalAccessControlsSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="lacCommandPromptDisabled" class="security-question-label">29.1 Is access to the operating system command prompt disabled for general users in the branch/office?</label>
                            <select id="lacCommandPromptDisabled" name="lacCommandPromptDisabled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="lacAdminMenuUtility" class="security-question-label">29.2 Are some or more system administration-related activities, driven through a menu-based utility, assigned to any user ID?</label>
                            <select id="lacAdminMenuUtility" name="lacAdminMenuUtility" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="lacSystemLogModification" class="security-question-label">29.3 Can any user other than the Super User modify the system activity log file?</label>
                            <select id="lacSystemLogModification" name="lacSystemLogModification" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('logicalAccessControlsQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Database Controls Questions Modal -->
        <div id="databaseControlsQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Database Controls Assessment</h3>
                    <span class="close-modal" onclick="closeModal('databaseControlsQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="databaseControlsQuestionsForm" onsubmit="handleDatabaseControlsSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="dcBackupSchedule" class="security-question-label">30.1 Is there a backup schedule?</label>
                            <select id="dcBackupSchedule" name="dcBackupSchedule" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="dcExceptionalUpdates" class="security-question-label">30.2 If entries in the database are updated/deleted due to any exceptional circumstances, are they approved in writing and recorded?</label>
                            <select id="dcExceptionalUpdates" name="dcExceptionalUpdates" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="dcJointResponsibility" class="security-question-label">30.3 Is there joint responsibility of the user department and the IT department for administration of mission-critical databases?</label>
                            <select id="dcJointResponsibility" name="dcJointResponsibility" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="dcDatabaseStandards" class="security-question-label">30.4 Does the IT department have laid down standards/conventions for database creation, storage, naming, and archival?</label>
                            <select id="dcDatabaseStandards" name="dcDatabaseStandards" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="dcTriggersQueriesMonitoring" class="security-question-label">30.5 Is the use of triggers and large queries monitored to prevent overloading of the database and consequent system failure?</label>
                            <select id="dcTriggersQueriesMonitoring" name="dcTriggersQueriesMonitoring" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="dcUserCreationRestricted" class="security-question-label">30.6 Is the creation of users restricted and need-based?</label>
                            <select id="dcUserCreationRestricted" name="dcUserCreationRestricted" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="dcAuditTrails" class="security-question-label">30.7 Is the database configured to ensure audit trails, logging of user sessions, and session auditing?</label>
                            <select id="dcAuditTrails" name="dcAuditTrails" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="dcBatchErrorLogs" class="security-question-label">30.8 Are batch error logs reviewed and corrective action taken by the administrator periodically?</label>
                            <select id="dcBatchErrorLogs" name="dcBatchErrorLogs" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="dcConfidentialityUndertakings" class="security-question-label">30.9 In cases where customer data is provided to external service providers, does the bank have confidentiality undertakings from these service providers?</label>
                            <select id="dcConfidentialityUndertakings" name="dcConfidentialityUndertakings" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="dcControlReports" class="security-question-label">30.10 Are standard sets of database control reports designed?</label>
                            <select id="dcControlReports" name="dcControlReports" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="dcDataMigrationVerification" class="security-question-label">30.11 In cases when data is migrated from one system to another, is the user department verified and satisfied with the accuracy of the information migrated?</label>
                            <select id="dcDataMigrationVerification" name="dcDataMigrationVerification" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="dcUserListReview" class="security-question-label">30.12 Does the system administrator periodically review the list of users of the database?</label>
                            <select id="dcUserListReview" name="dcUserListReview" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="dcBackupRestorationTest" class="security-question-label">30.13 Are databases periodically retrieved from the backup in the test environment to ensure accuracy in the physical environment?</label>
                            <select id="dcBackupRestorationTest" name="dcBackupRestorationTest" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="dcInactiveUsersDeactivated" class="security-question-label">30.14 Are inactive users deactivated?</label>
                            <select id="dcInactiveUsersDeactivated" name="dcInactiveUsersDeactivated" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('databaseControlsQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Penetration Testing Questions Modal -->
        <div id="penetrationTestingQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Penetration Testing Assessment</h3>
                    <span class="close-modal" onclick="closeModal('penetrationTestingQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="penetrationTestingQuestionsForm" onsubmit="handlePenetrationTestingSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="ptInternetConnectivity" class="security-question-label">31.1 Is it ensured that products/services using the Internet for connectivity or communications have undergone a successful penetration test prior to production implementation?</label>
                            <select id="ptInternetConnectivity" name="ptInternetConnectivity" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ptIntrusionDetection" class="security-question-label">31.2 Is there an intrusion detection system in place for all external IP connections?</label>
                            <select id="ptIntrusionDetection" name="ptIntrusionDetection" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('penetrationTestingQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Training Questions Modal -->
        <div id="trainingQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Training Assessment</h3>
                    <span class="close-modal" onclick="closeModal('trainingQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="trainingQuestionsForm" onsubmit="handleTrainingSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="trUserApplicationTraining" class="security-question-label">32.1 Are users given adequate training on the application systems' functionalities?</label>
                            <select id="trUserApplicationTraining" name="trUserApplicationTraining" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="trTechnicalPersonnelTraining" class="security-question-label">32.2 Are technical personnel given adequate training in the technical details of the application system to provide necessary troubleshooting/help to users?</label>
                            <select id="trTechnicalPersonnelTraining" name="trTechnicalPersonnelTraining" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="trContingencyAwareness" class="security-question-label">32.3 Are users aware of the steps to be carried out in case of contingency due to the unavailability of systems?</label>
                            <select id="trContingencyAwareness" name="trContingencyAwareness" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('trainingQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Remote Access Questions Modal -->
        <div id="remoteAccessQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Remote Access Assessment</h3>
                    <span class="close-modal" onclick="closeModal('remoteAccessQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="remoteAccessQuestionsForm" onsubmit="handleRemoteAccessSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="raCppdGuidelines" class="security-question-label">33.1 Whether remote access logs are maintained and reviewed periodically?</label>
                            <select id="raCppdGuidelines" name="raCppdGuidelines" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="raInsecureServicesDisabled" class="security-question-label">33.2 Is remote logon through services such as FTP, Telnet disabled?</label>
                            <select id="raInsecureServicesDisabled" name="raInsecureServicesDisabled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="raUserIdentifiable" class="security-question-label">33.3 Whether remote access is disabled when not in use? </label>
                            <select id="raUserIdentifiable" name="raUserIdentifiable" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="raExceptionalApproval" class="security-question-label">33.4 Are proper approvals taken before granting exceptional remote access to users?</label>
                            <select id="raExceptionalApproval" name="raExceptionalApproval" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('remoteAccessQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Power Supply (UPS) Questions Modal -->
        <div id="powerSupplyQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Power Supply (UPS) Assessment</h3>
                    <span class="close-modal" onclick="closeModal('powerSupplyQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="powerSupplyQuestionsForm" onsubmit="handlePowerSupplySubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="psSeparateEnclosure" class="security-question-label">34.1 Is there a separate enclosure and locking arrangement for the UPS?</label>
                            <select id="psSeparateEnclosure" name="psSeparateEnclosure" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="psBatteryService" class="security-question-label">34.2 Does the maintenance agency provide battery service regularly?</label>
                            <select id="psBatteryService" name="psBatteryService" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="psFunctionProperly" class="security-question-label">34.3 Does the UPS function properly when electricity fails?</label>
                            <select id="psFunctionProperly" name="psFunctionProperly" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="psMaintenanceContract" class="security-question-label">34.4 Is there a regular contract for maintenance of the UPS, and is preventive maintenance carried out as per the contract?</label>
                            <select id="psMaintenanceContract" name="psMaintenanceContract" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="psTestRecords" class="security-question-label">34.5 Is a record of the tests undertaken maintained to verify the satisfactory functioning of the UPS?</label>
                            <select id="psTestRecords" name="psTestRecords" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('powerSupplyQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Backup and Restoration Questions Modal -->
        <div id="backupRestorationQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Backup and Restoration Assessment</h3>
                    <span class="close-modal" onclick="closeModal('backupRestorationQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="backupRestorationQuestionsForm" onsubmit="handleBackupRestorationSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="brSoftwareMediaRegister" class="security-question-label">35.1 Are all the floppies/CDs/tapes purchased for OS software, application software, utility programs, drivers, etc., recorded in a register and properly stored?</label>
                            <select id="brSoftwareMediaRegister" name="brSoftwareMediaRegister" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="brBackupSchedule" class="security-question-label">35.2 Is daily/weekly/monthly and quarterly backup of data taken without fail and available as per requirements?</label>
                            <select id="brBackupSchedule" name="brBackupSchedule" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="brDataIntegrityVerification" class="security-question-label">35.3 Is the data integrity verified after the restoration work is completed?</label>
                            <select id="brDataIntegrityVerification" name="brDataIntegrityVerification" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="brBackupTapeTesting" class="security-question-label">35.4 Are backup tapes verified/tested periodically by restoring the data, and is a record maintained?</label>
                            <select id="brBackupTapeTesting" name="brBackupTapeTesting" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="brBackupTapeLabeling" class="security-question-label">35.5 Are backup tapes properly labeled and numbered?</label>
                            <select id="brBackupTapeLabeling" name="brBackupTapeLabeling" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="brStorageProcedures" class="security-question-label">35.6 Are proper storage procedures and facilities in place for backup copies?</label>
                            <select id="brStorageProcedures" name="brStorageProcedures" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="brMediaReadabilityVerification" class="security-question-label">35.7 Is backup media verified periodically for readability?</label>
                            <select id="brMediaReadabilityVerification" name="brMediaReadabilityVerification" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="brSoftwareBackupPreservation" class="security-question-label">35.8 Is the latest copy of the backup of software (Operating System, RDBMS, application, etc.) taken and preserved at the user site?</label>
                            <select id="brSoftwareBackupPreservation" name="brSoftwareBackupPreservation" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="brManualsMaintenance" class="security-question-label">35.9 Are hardware, software, operating system, and printer manuals properly labeled and maintained?</label>
                            <select id="brManualsMaintenance" name="brManualsMaintenance" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('backupRestorationQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Maintenance & App Patches Questions Modal -->
        <div id="maintenancePatchesQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Maintenance & App Patches Assessment</h3>
                    <span class="close-modal" onclick="closeModal('maintenancePatchesQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="maintenancePatchesQuestionsForm" onsubmit="handleMaintenancePatchesSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="mpSystemConfiguration" class="security-question-label">36.1 Is the system configuration such as memory, clock speed, hard disk size, and OS version as per the order or terms stipulated by CPPD / IT Department?</label>
                            <select id="mpSystemConfiguration" name="mpSystemConfiguration" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="mpPatchManagementProcess" class="security-question-label">36.2 Is there a well-defined patch management process in place?</label>
                            <select id="mpPatchManagementProcess" name="mpPatchManagementProcess" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="mpPatchesApplied" class="security-question-label">36.3 Are all the installed patches properly applied and running on the operating system?</label>
                            <select id="mpPatchesApplied" name="mpPatchesApplied" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="mpServerPatchProcess" class="security-question-label">36.4 Is a patch management process available for the server operating system?</label>
                            <select id="mpServerPatchProcess" name="mpServerPatchProcess" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="mpLatestUpdates" class="security-question-label">36.5 Are the latest updates/patches released by the OS vendor regularly applied?</label>
                            <select id="mpLatestUpdates" name="mpLatestUpdates" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="mpPatchRegister" class="security-question-label">36.6 Is a patch management register maintained and updated properly?</label>
                            <select id="mpPatchRegister" name="mpPatchRegister" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="mpSystemPatchProcess" class="security-question-label">36.7 Is a patch management process available for the system operating system?</label>
                            <select id="mpSystemPatchProcess" name="mpSystemPatchProcess" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="mpPatchPolicy" class="security-question-label">36.8 Is there a well-defined patch management policy and procedure in place?</label>
                            <select id="mpPatchPolicy" name="mpPatchPolicy" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('maintenancePatchesQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Network Monitor Tool Questions Modal -->
        <div id="networkMonitorToolQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Network Monitor Tool Assessment</h3>
                    <span class="close-modal" onclick="closeModal('networkMonitorToolQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="networkMonitorToolQuestionsForm" onsubmit="handleNetworkMonitorToolSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="nmtNetworkMonitoringTool" class="security-question-label">37.1 Does the bank have a Network Monitoring Tool implemented?</label>
                            <select id="nmtNetworkMonitoringTool" name="nmtNetworkMonitoringTool" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="nmtToolsApproved" class="security-question-label">37.2 Have the Network data monitoring tools (e.g., sniffers, data scopes, and probes) utilized by the product/service been approved by the Bank's IT Department?</label>
                            <select id="nmtToolsApproved" name="nmtToolsApproved" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('networkMonitorToolQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- SAN Switch CISCO Questions Modal -->
        <div id="sanSwitchCiscoQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>SAN Switch CISCO Assessment</h3>
                    <span class="close-modal" onclick="closeModal('sanSwitchCiscoQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="sanSwitchCiscoQuestionsForm" onsubmit="handleSanSwitchCiscoSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="sscTelnetService" class="security-question-label">38.1 Is telnet service enabled?</label>
                            <select id="sscTelnetService" name="sscTelnetService" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="sscGuiHttpsCliSsh" class="security-question-label">38.2 Does the GUI only have HTTPS access and CLI only have SSH access?</label>
                            <select id="sscGuiHttpsCliSsh" name="sscGuiHttpsCliSsh" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="sscUsbAccess" class="security-question-label">38.3 Is USB access allowed on the switch?</label>
                            <select id="sscUsbAccess" name="sscUsbAccess" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="sscCdpPackets" class="security-question-label">38.4 Are CDP (Cisco Discovery Protocol) packets enabled?</label>
                            <select id="sscCdpPackets" name="sscCdpPackets" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="sscDefaultCredentials" class="security-question-label">38.5 Are default credentials in use, or are accounts named 'Admin', 'root', or 'Administrator' to access the administrator login?</label>
                            <select id="sscDefaultCredentials" name="sscDefaultCredentials" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="sscSecurePassword" class="security-question-label">38.6 Does the core switch have a secure password enabled?</label>
                            <select id="sscSecurePassword" name="sscSecurePassword" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="sscTcpUdpSmallServers" class="security-question-label">38.7 Does Cisco enable TCP and UDP Small Servers by default?</label>
                            <select id="sscTcpUdpSmallServers" name="sscTcpUdpSmallServers" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="sscIcmpRedirects" class="security-question-label">38.8 Is ICMP redirects enabled on the network interface mgmt0?</label>
                            <select id="sscIcmpRedirects" name="sscIcmpRedirects" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="sscProxyArp" class="security-question-label">38.9 Is Proxy ARP enabled on mgmt0?</label>
                            <select id="sscProxyArp" name="sscProxyArp" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="sscUnusedPortsClosed" class="security-question-label">38.10 Are unused ports closed on the switch?</label>
                            <select id="sscUnusedPortsClosed" name="sscUnusedPortsClosed" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="sscPhysicallySecured" class="security-question-label">38.11 Is the switch physically secured?</label>
                            <select id="sscPhysicallySecured" name="sscPhysicallySecured" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="sscNtpConfigured" class="security-question-label">38.12 Is NTP configured?</label>
                            <select id="sscNtpConfigured" name="sscNtpConfigured" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="sscAdminPortalWhitelisted" class="security-question-label">38.13 Is an administrative portal login accessed only by whitelisted IP addresses?</label>
                            <select id="sscAdminPortalWhitelisted" name="sscAdminPortalWhitelisted" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="sscAdminLockout" class="security-question-label">38.14 Is admin lockout set to 3 or more failed login attempts or as per the organization's policy?</label>
                            <select id="sscAdminLockout" name="sscAdminLockout" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="sscLoggingSyslog" class="security-question-label">38.15 Is logging enabled and is the Syslog server implemented?</label>
                            <select id="sscLoggingSyslog" name="sscLoggingSyslog" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="sscPasswordPolicies" class="security-question-label">38.16 Are password policies configured as per the organization's password management policy?</label>
                            <select id="sscPasswordPolicies" name="sscPasswordPolicies" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="sscBackupFrequency" class="security-question-label">38.17 How frequently is backup done for the switch configuration?</label>
                            <select id="sscBackupFrequency" name="sscBackupFrequency" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="sscMopDisabled" class="security-question-label">38.18 Is Maintenance Operations Protocol (MOP) disabled on all ethernet interfaces?</label>
                            <select id="sscMopDisabled" name="sscMopDisabled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="sscDirectedBroadcasts" class="security-question-label">38.19 Are directed broadcasts enabled by default?</label>
                            <select id="sscDirectedBroadcasts" name="sscDirectedBroadcasts" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="sscTcpKeepAlives" class="security-question-label">38.20 Is inbound TCP connection keep-alives message disabled?</label>
                            <select id="sscTcpKeepAlives" name="sscTcpKeepAlives" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="sscBootpDisabled" class="security-question-label">38.21 Is BOOTP disabled?</label>
                            <select id="sscBootpDisabled" name="sscBootpDisabled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="sscLoginDisclaimer" class="security-question-label">38.22 Is the login disclaimer message set?</label>
                            <select id="sscLoginDisclaimer" name="sscLoginDisclaimer" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="sscLoginTimeout" class="security-question-label">38.23 Is login timeout configured as per organization policies?</label>
                            <select id="sscLoginTimeout" name="sscLoginTimeout" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="sscIcmpUnreachable" class="security-question-label">38.24 Are ICMP IP unreachable messages enabled on the interface mgmt0?</label>
                            <select id="sscIcmpUnreachable" name="sscIcmpUnreachable" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="sscDomainLookups" class="security-question-label">38.25 Are domain lookups enabled and DNS servers configured?</label>
                            <select id="sscDomainLookups" name="sscDomainLookups" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="sscPadService" class="security-question-label">38.26 Is the Packet Assembler/Disassembler (PAD) service disabled?</label>
                            <select id="sscPadService" name="sscPadService" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('sanSwitchCiscoQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- SAN Storage Questions Modal -->
        <div id="sanStorageQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>SAN Storage Assessment</h3>
                    <span class="close-modal" onclick="closeModal('sanStorageQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="sanStorageQuestionsForm" onsubmit="handleSanStorageSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="ssAdminPortalWhitelisted" class="security-question-label">39.1 Is an administrative portal login accessed only by whitelisted IP addresses?</label>
                            <select id="ssAdminPortalWhitelisted" name="ssAdminPortalWhitelisted" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ssFullDiskEncryption" class="security-question-label">39.2 Is Full Disk Encryption configured?</label>
                            <select id="ssFullDiskEncryption" name="ssFullDiskEncryption" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ssFtpUsed" class="security-question-label">39.3 Is FTP being used?</label>
                            <select id="ssFtpUsed" name="ssFtpUsed" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ssNtpConfigured" class="security-question-label">39.4 Is NTP configured?</label>
                            <select id="ssNtpConfigured" name="ssNtpConfigured" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ssSyslogServer" class="security-question-label">39.5 Is the Syslog server implemented?</label>
                            <select id="ssSyslogServer" name="ssSyslogServer" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ssEmailNotification" class="security-question-label">39.6 Is Email Notification enabled?</label>
                            <select id="ssEmailNotification" name="ssEmailNotification" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="ssLoginTimeout" class="security-question-label">39.7 Is login timeout as per organization policies?</label>
                            <select id="ssLoginTimeout" name="ssLoginTimeout" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('sanStorageQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- NAS Questions Modal -->
        <div id="nasQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>NAS Assessment</h3>
                    <span class="close-modal" onclick="closeModal('nasQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="nasQuestionsForm" onsubmit="handleNasSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="nasAdminPortalWhitelisted" class="security-question-label">40.1 Is an administrative portal login accessed only by Whitelisted IP Addresses?</label>
                            <select id="nasAdminPortalWhitelisted" name="nasAdminPortalWhitelisted" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="nasDefaultCredentials" class="security-question-label">40.2 Are default credentials in use, or are accounts named 'Admin', 'root', or 'Administrator' to access administrator login?</label>
                            <select id="nasDefaultCredentials" name="nasDefaultCredentials" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="nasDosProtection" class="security-question-label">40.3 Is the DoS protection enabled or not?</label>
                            <select id="nasDosProtection" name="nasDosProtection" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="nasFirmwareUpToDate" class="security-question-label">40.4 Is the firmware/DSM up to date?</label>
                            <select id="nasFirmwareUpToDate" name="nasFirmwareUpToDate" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="nasAdminPasswordPolicy" class="security-question-label">40.5 Is the administrative password set as per the organization's password policy?</label>
                            <select id="nasAdminPasswordPolicy" name="nasAdminPasswordPolicy" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="nasAdminLockout" class="security-question-label">40.6 Is Admin lockout set to 3 or more failed login attempts or as per the organization policy?</label>
                            <select id="nasAdminLockout" name="nasAdminLockout" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="nasFirewallConfigured" class="security-question-label">40.7 Is the firewall configured?</label>
                            <select id="nasFirewallConfigured" name="nasFirewallConfigured" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="nasPasswordExpiry" class="security-question-label">40.8 Is the administrative password expiry set as per the organization's password policy?</label>
                            <select id="nasPasswordExpiry" name="nasPasswordExpiry" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="nasSecurityAdvisor" class="security-question-label">40.9 Is Security Advisor provided and used?</label>
                            <select id="nasSecurityAdvisor" name="nasSecurityAdvisor" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="nasEmailNotification" class="security-question-label">40.10 Is Email Notification enabled?</label>
                            <select id="nasEmailNotification" name="nasEmailNotification" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="nasTwoFactorAuth" class="security-question-label">40.11 Are Administrators having two-factor authentications enabled?</label>
                            <select id="nasTwoFactorAuth" name="nasTwoFactorAuth" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('nasQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Load Balancer Array Questions Modal -->
        <div id="loadBalancerArrayQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Load Balancer Array Assessment</h3>
                    <span class="close-modal" onclick="closeModal('loadBalancerArrayQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="loadBalancerArrayQuestionsForm" onsubmit="handleLoadBalancerArraySubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="lbaAdminPortalWhitelisted" class="security-question-label">41.1 Is an administrative portal login accessed only by Whitelisted IP Addresses?</label>
                            <select id="lbaAdminPortalWhitelisted" name="lbaAdminPortalWhitelisted" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="lbaDosProtection" class="security-question-label">41.2 Whether the DoS protection is enabled or not?</label>
                            <select id="lbaDosProtection" name="lbaDosProtection" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="lbaLicensesExpired" class="security-question-label">41.3 Are some of the supportive licenses expired?</label>
                            <select id="lbaLicensesExpired" name="lbaLicensesExpired" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="lbaDpiConfigured" class="security-question-label">41.4 Is Data Packet Inspection (DPI) configured?</label>
                            <select id="lbaDpiConfigured" name="lbaDpiConfigured" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="lbaNtpConfigured" class="security-question-label">41.5 Is NTP configured?</label>
                            <select id="lbaNtpConfigured" name="lbaNtpConfigured" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="lbaSyslogServer" class="security-question-label">41.6 Is the Syslog server implemented?</label>
                            <select id="lbaSyslogServer" name="lbaSyslogServer" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="lbaTwoFactorAuth" class="security-question-label">41.7 Are Administrators having two-factor authentications enabled?</label>
                            <select id="lbaTwoFactorAuth" name="lbaTwoFactorAuth" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="lbaEmailNotification" class="security-question-label">41.8 Is Email Notification enabled?</label>
                            <select id="lbaEmailNotification" name="lbaEmailNotification" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('loadBalancerArrayQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- PAM Questions Modal -->
        <div id="pamQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>PAM Assessment</h3>
                    <span class="close-modal" onclick="closeModal('pamQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="pamQuestionsForm" onsubmit="handlePamSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="pamAccessManaged" class="security-question-label">42.1 Is Access to all servers, databases, network devices, and critical devices managed through PAM solution?</label>
                            <select id="pamAccessManaged" name="pamAccessManaged" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="pamExclusiveAccess" class="security-question-label">42.2 Is Access to all servers, databases, network devices, and critical devices exclusively granted through PAM solution only?</label>
                            <select id="pamExclusiveAccess" name="pamExclusiveAccess" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="pamExclusionsApproved" class="security-question-label">42.3 Are exclusions to PAM solution approved by the respective authority and granted according to need-to-know basis?</label>
                            <select id="pamExclusionsApproved" name="pamExclusionsApproved" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="pamCompatible" class="security-question-label">42.4 Is PAM solution compatible with other assets?</label>
                            <select id="pamCompatible" name="pamCompatible" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="pamHaMode" class="security-question-label">42.5 Is PAM solution available in HA mode?</label>
                            <select id="pamHaMode" name="pamHaMode" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="pamLogsServer" class="security-question-label">42.6 Whether Logs server is configured for PAM?</label>
                            <select id="pamLogsServer" name="pamLogsServer" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="pamAdequateLogs" class="security-question-label">42.7 Does system logs contain adequate information for identification purpose?</label>
                            <select id="pamAdequateLogs" name="pamAdequateLogs" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="pamVideoLogs" class="security-question-label">42.8 Check whether Video logs are enabled for PAM user sessions?</label>
                            <select id="pamVideoLogs" name="pamVideoLogs" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="pamTwoFactorAuth" class="security-question-label">42.9 Check whether Two Factor Authentication is available for PAM Access?</label>
                            <select id="pamTwoFactorAuth" name="pamTwoFactorAuth" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="pamMultipleAdmin" class="security-question-label">42.10 Are there multiple admin accounts to avoid lockout?</label>
                            <select id="pamMultipleAdmin" name="pamMultipleAdmin" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="pamUnusedAccountsDisabled" class="security-question-label">42.11 Are unused accounts disabled?</label>
                            <select id="pamUnusedAccountsDisabled" name="pamUnusedAccountsDisabled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="pamSolutionUpdated" class="security-question-label">42.12 Whether PAM solution is updated?</label>
                            <select id="pamSolutionUpdated" name="pamSolutionUpdated" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="pamPasswordPolicy" class="security-question-label">42.13 Check whether PAM password policy is configured as per organizational password policy?</label>
                            <select id="pamPasswordPolicy" name="pamPasswordPolicy" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="pamDevicePasswordPolicy" class="security-question-label">42.14 Check whether password policy for devices integrated into PAM is managed through PAM?</label>
                            <select id="pamDevicePasswordPolicy" name="pamDevicePasswordPolicy" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="pam2FAConfigured" class="security-question-label">42.15 Check whether 2FA Access is configured properly?</label>
                            <select id="pam2FAConfigured" name="pam2FAConfigured" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="pamConfigBackup" class="security-question-label">42.16 Whether configuration backup of PAM solution is taken on a regular basis?</label>
                            <select id="pamConfigBackup" name="pamConfigBackup" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="pamAdIntegration" class="security-question-label">42.17 Check whether PAM solution is integrated with Active Directory?</label>
                            <select id="pamAdIntegration" name="pamAdIntegration" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="pamFilePermissions" class="security-question-label">42.18 Whether file type permissions are configured properly through PAM?</label>
                            <select id="pamFilePermissions" name="pamFilePermissions" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="pamPasswordExpiry" class="security-question-label">42.19 Does the password expire periodically (preferably after 30 days)?</label>
                            <select id="pamPasswordExpiry" name="pamPasswordExpiry" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="pamSessionMonitoring" class="security-question-label">42.20 Does PAM admin monitor the users' session activity?</label>
                            <select id="pamSessionMonitoring" name="pamSessionMonitoring" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="pamUserAccessPolicy" class="security-question-label">42.21 Whether user access policy is configured properly?</label>
                            <select id="pamUserAccessPolicy" name="pamUserAccessPolicy" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="pam2FAEnabledAllUsers" class="security-question-label">42.22 Whether 2FA is enabled in all user accounts?</label>
                            <select id="pam2FAEnabledAllUsers" name="pam2FAEnabledAllUsers" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="pamCredentialBackup" class="security-question-label">42.23 Is there a backup process for storage of usernames and passwords used for accessing PAM?</label>
                            <select id="pamCredentialBackup" name="pamCredentialBackup" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('pamQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- SOC Questions Modal -->
        <div id="socQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>SOC Assessment</h3>
                    <span class="close-modal" onclick="closeModal('socQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="socQuestionsForm" onsubmit="handleSocSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="socRealTimeProtection" class="security-question-label">43.1 Real Time Protection/Detection available or not?</label>
                            <select id="socRealTimeProtection" name="socRealTimeProtection" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="socEventCorrelation" class="security-question-label">43.2 Real-time Event Correlation configured or not?</label>
                            <select id="socEventCorrelation" name="socEventCorrelation" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="socCriticalDevicesIntegrated" class="security-question-label">43.3 Are all critical devices integrated into SOC or not?</label>
                            <select id="socCriticalDevicesIntegrated" name="socCriticalDevicesIntegrated" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="socAdminLockout" class="security-question-label">43.4 Is Admin lockout set to 3 or more failed login attempts or as per the organisation policy?</label>
                            <select id="socAdminLockout" name="socAdminLockout" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="socDefaultCredentials" class="security-question-label">43.5 Are default credentials in use or are accounts named 'Admin', 'root', or 'Administrator' to access administrator login?</label>
                            <select id="socDefaultCredentials" name="socDefaultCredentials" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="socSoftwareUpdated" class="security-question-label">43.6 Is the software up to date?</label>
                            <select id="socSoftwareUpdated" name="socSoftwareUpdated" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="socSyslogServer" class="security-question-label">43.7 Is Syslog server configured or not?</label>
                            <select id="socSyslogServer" name="socSyslogServer" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="socEventLogAnalyzer" class="security-question-label">43.8 Is Event Log Analyzer configured or not?</label>
                            <select id="socEventLogAnalyzer" name="socEventLogAnalyzer" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="socSslUsed" class="security-question-label">43.9 Is SSL used?</label>
                            <select id="socSslUsed" name="socSslUsed" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="socTwoFactorAuth" class="security-question-label">43.10 Are Administrators having Two Factor Authentication enabled?</label>
                            <select id="socTwoFactorAuth" name="socTwoFactorAuth" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="socSecureAccess" class="security-question-label">43.11 Does the GUI only have HTTPS Access and CLI only have SSH Access?</label>
                            <select id="socSecureAccess" name="socSecureAccess" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="socSessionTimeout" class="security-question-label">43.12 Whether Session timeout was defined?</label>
                            <select id="socSessionTimeout" name="socSessionTimeout" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="socLoggingEnabled" class="security-question-label">43.13 Is logging enabled?</label>
                            <select id="socLoggingEnabled" name="socLoggingEnabled" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="socPasswordPolicies" class="security-question-label">43.14 Are Password Policies configured as per the organization's password management policy?</label>
                            <select id="socPasswordPolicies" name="socPasswordPolicies" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="socNtpConfigured" class="security-question-label">43.15 Is NTP configured?</label>
                            <select id="socNtpConfigured" name="socNtpConfigured" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="socFileMonitoring" class="security-question-label">43.16 Is File monitoring configured or not?</label>
                            <select id="socFileMonitoring" name="socFileMonitoring" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="socLogRetention" class="security-question-label">43.17 Whether Log Retention is followed as per agreed T&C & organization policy?</label>
                            <select id="socLogRetention" name="socLogRetention" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="socAdminPortalWhitelisted" class="security-question-label">43.18 Is an administrative portal login accessed only by Whitelisted IP Addresses?</label>
                            <select id="socAdminPortalWhitelisted" name="socAdminPortalWhitelisted" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="socSiemHaMode" class="security-question-label">43.19 Is the SIEM tool configured with High Availability (HA) mode?</label>
                            <select id="socSiemHaMode" name="socSiemHaMode" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="socSiemBackup" class="security-question-label">43.20 How frequently is backup done for the SIEM Tool configuration?</label>
                            <select id="socSiemBackup" name="socSiemBackup" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="socMultipleAdmin" class="security-question-label">43.21 Are there multiple admin accounts to avoid lockout?</label>
                            <select id="socMultipleAdmin" name="socMultipleAdmin" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="socAdIntegration" class="security-question-label">43.22 Is the SIEM Tool integrated with Active Directory for user management?</label>
                            <select id="socAdIntegration" name="socAdIntegration" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="socAlertsConfigured" class="security-question-label">43.23 Are alerts configured or not?</label>
                            <select id="socAlertsConfigured" name="socAlertsConfigured" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="socLoginTimeouts" class="security-question-label">43.24 Are login timeouts set as per organization policies?</label>
                            <select id="socLoginTimeouts" name="socLoginTimeouts" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('socQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Change Management Questions Modal -->
        <div id="changeManagementQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Change Management Assessment</h3>
                    <span class="close-modal" onclick="closeModal('changeManagementQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="changeManagementQuestionsForm" onsubmit="handleChangeManagementSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="changeApprovalCommunication" class="security-question-label">44.1 Are changes made with proper approval from authorities and communicated to all the respective personnel that may get affected by the changes made?</label>
                            <select id="changeApprovalCommunication" name="changeApprovalCommunication" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="changeManagedRecorded" class="security-question-label">44.2 Are changes managed and recorded properly?</label>
                            <select id="changeManagedRecorded" name="changeManagedRecorded" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="changeManagementProcess" class="security-question-label">44.3 Is there a proper change management process in place for all types of changes made in the Data Centre?</label>
                            <select id="changeManagementProcess" name="changeManagementProcess" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="changeMajorApprovals" class="security-question-label">44.4 Are approvals taken for major changes made and documented?</label>
                            <select id="changeMajorApprovals" name="changeMajorApprovals" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="changePolicyProcedure" class="security-question-label">44.5 Is a well-defined Change Management Policy and Procedure in place?</label>
                            <select id="changePolicyProcedure" name="changePolicyProcedure" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="changeApprovalForm" class="security-question-label">44.6 Is there an approval form/document available for requesting changes?</label>
                            <select id="changeApprovalForm" name="changeApprovalForm" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="changeDocumentedRegister" class="security-question-label">44.7 Are changes documented in a register with proper date, time, device, and types of changes made?</label>
                            <select id="changeDocumentedRegister" name="changeDocumentedRegister" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="changeAllTypesRecorded" class="security-question-label">44.8 Are all types of changes made, including changes in critical devices, systems, servers, networking devices, databases, and applications, recorded in the Change Management Register?</label>
                            <select id="changeAllTypesRecorded" name="changeAllTypesRecorded" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('changeManagementQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Asset Management Questions Modal -->
        <div id="assetManagementQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Asset Management Assessment</h3>
                    <span class="close-modal" onclick="closeModal('assetManagementQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="assetManagementQuestionsForm" onsubmit="handleAssetManagementSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="assetInventoryRegister" class="security-question-label">45.1 Whether IT assets have been documented in a separate Inventory Register or Asset Inventory Management tool/software?</label>
                            <select id="assetInventoryRegister" name="assetInventoryRegister" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="assetInventoryDetails" class="security-question-label">45.2 Does the inventory include minimum details of the IT assets (e.g., hardware, software, network devices, key personnel, services, associated business applications, criticality of the IT asset such as High/Medium/Low, etc.)?</label>
                            <select id="assetInventoryDetails" name="assetInventoryDetails" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="assetPeriodicUpdate" class="security-question-label">45.3 Whether the IT assets are updated and reviewed periodically?</label>
                            <select id="assetPeriodicUpdate" name="assetPeriodicUpdate" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="assetCriticalityReview" class="security-question-label">45.4 Whether the IT assets' criticality is updated and reviewed regularly?</label>
                            <select id="assetCriticalityReview" name="assetCriticalityReview" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="assetSoftwareInventory" class="security-question-label">45.5 Whether the bank has a centralized authorized software inventory/register?</label>
                            <select id="assetSoftwareInventory" name="assetSoftwareInventory" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="assetHardwareLabels" class="security-question-label">45.6 Are All hardware's are Labels properly?</label>
                            <select id="assetHardwareLabels" name="assetHardwareLabels" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="assetDeviceInventory" class="security-question-label">45.7 Does the bank have a centralized inventory of authorized devices and other related network devices connected to the bank's network (within/outside bank premises)?</label>
                            <select id="assetDeviceInventory" name="assetDeviceInventory" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="assetManagementPolicy" class="security-question-label">45.8 Does the bank have an Asset Management Policy?</label>
                            <select id="assetManagementPolicy" name="assetManagementPolicy" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="assetAuthorizedAccess" class="security-question-label">45.9 Is the Asset Inventory accessed only by authorized users?</label>
                            <select id="assetAuthorizedAccess" name="assetAuthorizedAccess" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('assetManagementQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Others Questions Modal -->
        <div id="othersQuestionsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Others Assessment</h3>
                    <span class="close-modal" onclick="closeModal('othersQuestionsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="othersQuestionsForm" onsubmit="handleOthersSubmit(event)">
                        <div class="form-group security-question-row">
                            <label for="vendorDueDiligence" class="security-question-label">46.1 Whether the bank performs due diligence of vendors before on-boarding.</label>
                            <select id="vendorDueDiligence" name="vendorDueDiligence" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="vendorAgreements" class="security-question-label">46.2 Whether the bank has signed agreements with all vendors.</label>
                            <select id="vendorAgreements" name="vendorAgreements" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="fraudPrevention" class="security-question-label">46.3 Whether the bank has a fraud prevention mechanism.</label>
                            <select id="fraudPrevention" name="fraudPrevention" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="databaseEncryption" class="security-question-label">46.4 How is data encryption and access control managed for databases.</label>
                            <select id="databaseEncryption" name="databaseEncryption" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="dataTransitEncryption" class="security-question-label">46.5 How is data encryption and access control managed for data in transit.</label>
                            <select id="dataTransitEncryption" name="dataTransitEncryption" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="isPolicy" class="security-question-label">46.6 Whether the bank has an IS (Information Security) policy.</label>
                            <select id="isPolicy" name="isPolicy" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="cyberSecurityPolicy" class="security-question-label">46.7 Whether the bank has a Cyber Security policy.</label>
                            <select id="cyberSecurityPolicy" name="cyberSecurityPolicy" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="vendorSelectionCriteria" class="security-question-label">46.8 What criteria are used to evaluate and select software products and vendors.</label>
                            <select id="vendorSelectionCriteria" name="vendorSelectionCriteria" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="vendorSelectionProcess" class="security-question-label">46.9 Is there a documented process for product and vendor selection.</label>
                            <select id="vendorSelectionProcess" name="vendorSelectionProcess" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="contractProvisions" class="security-question-label">46.10 Do the contracts include all necessary provisions/clauses.</label>
                            <select id="contractProvisions" name="contractProvisions" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="outsourcingPolicy" class="security-question-label">46.11 Whether the bank has an outsourcing policy.</label>
                            <select id="outsourcingPolicy" name="outsourcingPolicy" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="securityStandards" class="security-question-label">46.12 What security standards or frameworks are in place in the bank (e.g., ISO 27001, NIST).</label>
                            <select id="securityStandards" name="securityStandards" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="itPolicy" class="security-question-label">46.13 Whether the bank has an IT policy.</label>
                            <select id="itPolicy" name="itPolicy" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="boardCyberTraining" class="security-question-label">46.14 Whether Board members/Administrator/CEO of the bank have attended any programme on Cyber Security.</label>
                            <select id="boardCyberTraining" name="boardCyberTraining" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="userAwarenessPolicy" class="security-question-label">46.15 Whether the bank has a User Awareness policy.</label>
                            <select id="userAwarenessPolicy" name="userAwarenessPolicy" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="securityEducation" class="security-question-label">46.16 Are employees and customers educated about security best practices.</label>
                            <select id="securityEducation" name="securityEducation" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-group security-question-row">
                            <label for="awarenessPrograms" class="security-question-label">46.17 Whether awareness programmes are conducted for all staff on cyber security and information security.</label>
                            <select id="awarenessPrograms" name="awarenessPrograms" class="security-question-input" required>
                                <option value="">Select</option>
                                <option value="compliance">Compliance</option>
                                <option value="non_compliance">Non-Compliance</option>
                                <option value="not_applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cancel-btn" onclick="closeModal('othersQuestionsModal')">Cancel</button>
                            <button type="submit" class="submit-btn">Submit Assessment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

            <section id="reporting-section" class="dashboard-section">
                <h1><i class="fas fa-file-alt"></i> Reporting Section</h1>
                <div class="report-accordion">
                    <div class="accordion-item">
                        <button class="accordion-btn">
                            <i class="fas fa-shield-alt"></i>
                            <span>Infra VAPT Report</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="accordion-content">
                            <button class="report-option" onclick="openModal('firstAuditModal')"><i class="fas fa-file-alt"></i> First Audit Report Excel File</button>
                            <button class="report-option" onclick="openModal('firstAuditWordModal')"><i class="fas fa-file-alt"></i> First Audit Word Report</button>
                            <button class="report-option" onclick="openModal('followUpAuditModal')"><i class="fas fa-sync-alt"></i> Follow Up Audit Report Excel File</button>
                            <button class="report-option" onclick="openModal('followUpAuditWordModal')"><i class="fas fa-sync-alt"></i> Follow Up Audit Word Report</button>
                            <button class="report-option" onclick="openModal('firstAuditMetaDataModal')"><i class="fas fa-certificate"></i> First Audit MetaData</button>
                            <button class="report-option" onclick="openModal('followUpAuditMetaDataModal')"><i class="fas fa-certificate"></i> Follow Up Audit MetaData</button>
                            <button class="report-option" onclick="openModal('firstAuditCertificateModal')"><i class="fas fa-certificate"></i> First Audit Conducted Certificate</button>
                            <button class="report-option" onclick="openModal('followUpAuditCertificateModal')"><i class="fas fa-certificate"></i> Follow Up Audit Conducted Certificate</button>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <button class="accordion-btn">
                            <i class="fas fa-search"></i>
                            <span>IS Audit Report</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="accordion-content">
                            <button class="report-option" onclick="openModal('branchExcelWithoutPOCModal')"><i class="fas fa-file-excel"></i> Branch Excel Without POC</button>
                            
                            <button class="report-option" onclick="openModal('branchExcelWithPOCModal')"><i class="fas fa-file-excel"></i> Branch Excel With POC</button>
                            <button class="report-option" onclick="openModal('combineBranchExcelWithoutPOCModal')"><i class="fas fa-file-excel"></i> Combine Branch Excel without POC</button>
                            <button class="report-option" onclick="openModal('combineBranchExcelWithPOCModal')"><i class="fas fa-file-excel"></i> Combine Branch Excel With POC</button>
                            <button class="report-option" onclick="openModal('separateAssetsModal')"><i class="fas fa-server"></i> Seperate Assets</button>
                            <button class="report-option" onclick="openModal('attachEvidenceAssetModal')"><i class="fas fa-server"></i>Attach Evidances in Asset Excel</button>
                            <button class="report-option" onclick="openModal('combineAssetReviewExcelsModal')"><i class="fas fa-server"></i> Combine Asset Review Excels</button>
                            <button class="report-option" onclick="openModal('assetReviewNonComplianceModal')"><i class="fas fa-exclamation-triangle"></i> Asset Review Non Compliance Points</button>
                            <button class="report-option" onclick="openModal('branchConsoleModal')"><i class="fas fa-terminal"></i> Branch Console</button>
                            <button class="report-option" onclick="openModal('isAuditWordReportModal')"><i class="fas fa-file-word"></i> IS Audit Word Report</button>
                            <button class="report-option" onclick="openModal('isAuditCertificateModal')"><i class="fas fa-certificate"></i> Certificate</button>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <button class="accordion-btn">
                            <i class="fas fa-chart-bar"></i>
                            <span>GAP Assessment Report</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="accordion-content">
                            <button class="report-option" onclick="openModal('vicsModal')"><i class="fas fa-file-alt"></i> VICS Seperate Parts</button>
                            <button class="report-option" onclick="openModal('createVICSWorksheetModal')"><i class="fas fa-file-alt"></i> Create VICS Worksheet</button>
                            <button class="report-option" onclick="openModal('createVICSWithBankInputModal')"><i class="fas fa-file-alt"></i> Create VICS Worksheet with bank input column</button>           
                            <button class="report-option" onclick="openModal('locModal')"><i class="fas fa-file-alt"></i> LOC Seperate Parts</button>
                            <button class="report-option" onclick="openModal('createLOCWorksheetModal')"><i class="fas fa-file-alt"></i> Create LOC Worksheet</button>        
                            <button class="report-option" onclick="openModal('createLOCWithBankInputModal')"><i class="fas fa-file-alt"></i> Create LOC Worksheet with bank input column</button>           
                            <button class="report-option" onclick="openModal('loeModal')"><i class="fas fa-file-alt"></i> LOE</button>
                            <button class="report-option" onclick="openModal('gapAssessmentExcelModal')"><i class="fas fa-file-alt"></i> Gap Assessment Excel</button>
                            <button class="report-option" onclick="openModal('gapAssessmentReportModal')"><i class="fas fa-certificate"></i> Gap Assessment Report</button>
                            <button class="report-option" onclick="openModal('gapAssessmentReportBankInputModal')"><i class="fas fa-certificate"></i> Gap Assessment Report - with Bank Column</button>
                            <button class="report-option" onclick="openModal('vicsCertificateModal')"><i class="fas fa-certificate"></i> VICS Certificate</button>
                            <button class="report-option" onclick="openModal('gapAssessmentAuditCertificateModal')"><i class="fas fa-certificate"></i> Certificate</button>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <button class="accordion-btn">
                            <i class="fas fa-clipboard-list"></i>
                            <span>Compliance Worksheet</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="accordion-content">
                            <button class="report-option" onclick="openModal('complianceExcelModal')"><i class="fas fa-file-excel"></i> Compliance Excel</button>
                            <button class="report-option" onclick="openModal('complianceCertificateModal')"><i class="fas fa-certificate"></i> Compliance Certificate</button>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <button class="accordion-btn">
                            <i class="fas fa-shield-alt"></i>
                            <span>Cyber Security Audit Report</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="accordion-content">
                            <button class="report-option" onclick="openModal('cyberSecurityAuditExcelModal')"><i class="fas fa-file-alt"></i>Cyber Security Audit Excel - Separate Parts</button>
                            <button class="report-option" onclick="openModal('createCyberSecurityAuditExcelModal')"><i class="fas fa-file-alt"></i>Create Cyber Security Audit Excel</button>
                            <button class="report-option" onclick="openModal('cyberSecurityAuditReportModal')"><i class="fas fa-file-alt"></i>Cyber Security Audit Report</button>
                            <button class="report-option" onclick="openModal('cyberSecurityAuditCertificateModal')"><i class="fas fa-certificate"></i> Certificate</button>
                        </div>
                    </div>
                </div>
            </section>

            <section id="chat-section" class="dashboard-section">
                <h1><i class="fas fa-comments"></i> AI Chat Board</h1>
                <div class="chat-container">
                    <div class="chat-messages">
                        <div class="message ai-message">
                            <p>Hello! How can I assist you with your audit tasks today?</p>
                        </div>
                    </div>
                    <div class="chat-input">
                        <select id="prompt-select">
                            <option value="">Select a prompt...</option>
                            <option value="correct-grammar">Correct grammar in this text</option>
                            <option value="professional-email">Write a professional email</option>
                            <option value="audit-checklist">Generate audit checklist</option>
                            <option value="risk-assessment">Help with risk assessment</option>
                            <option value="compliance-query">Compliance query</option>
                            <option value="report-template">Need report template</option>
                            <option value="data-analysis">Help with data analysis</option>
                            <option value="presentation-tips">Presentation tips</option>
                            <option value="meeting-agenda">Create meeting agenda</option>
                            <option value="time-management">Time management tips</option>
                        </select>
                        <input type="text" placeholder="Type your message...">
                        <button><i class="fas fa-paper-plane"></i></button>
                    </div>
                </div>
            </section>

            <section id="work-section" class="dashboard-section">
                <h1><i class="fas fa-tasks"></i> Update Your Work</h1>
                <div class="work-cards" style="display: flex; flex-direction: column; align-items: center; gap: 40px;">
                    <!-- First Row: 4 cards -->
                    <div style="display: flex; justify-content: center; gap: 30px; flex-wrap: wrap; width: 100%;">
                        <div class="work-card" id="workPlanCard" onclick="openWorkPlanModal()" style="cursor: pointer; width: 180px; height: 180px; padding: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; box-sizing: border-box;">
                            <i class="fas fa-calendar-plus"></i>
                            <h3>Submit Today's Work Plan</h3>
                        </div>
                        <div class="work-card" id="updateWorkCard" onclick="openUpdateWorkModal()" style="cursor: pointer; width: 180px; height: 180px; padding: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; box-sizing: border-box;">
                            <i class="fas fa-edit"></i>
                            <h3>Update Today's Work</h3>
                        </div>
                        <div class="work-card" id="sprintPlanCard" onclick="openSprintPlanModal()" style="cursor: pointer; width: 180px; height: 180px; padding: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; box-sizing: border-box;">
                            <i class="fas fa-calendar-week"></i>
                            <h3>Submit Sprint Plan</h3>
                        </div>
                        <div class="work-card" id="lastWeekSprintCard" onclick="openLastWeekSprintModal()" style="cursor: pointer; width: 180px; height: 180px; padding: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; box-sizing: border-box;">
                            <i class="fas fa-calendar-check"></i>
                            <h3>Submit Last Week Sprint</h3>
                        </div>
                    </div>
                    
                    <!-- Second Row: 3 cards -->
                    <div style="display: flex; justify-content: center; gap: 30px; flex-wrap: wrap; width: 100%;">
                        <div class="work-card" id="extraWorkCard" onclick="openExtraWorkModal()" style="cursor: pointer; width: 180px; height: 180px; padding: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; box-sizing: border-box;">
                            <i class="fas fa-plus-circle"></i>
                            <h3>Extra Work</h3>
                        </div>
                        <div class="work-card" id="leaveApprovalCard" onclick="openLeaveApprovalModal()" style="cursor: pointer; width: 180px; height: 180px; padding: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; box-sizing: border-box;">
                            <i class="fas fa-umbrella-beach"></i>
                            <h3>Leave Approval Request</h3>
                        </div>
                        <div class="work-card" id="complaintCard" onclick="openComplaintModal()" style="cursor: pointer; width: 180px; height: 180px; padding: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; box-sizing: border-box;">
                            <i class="fas fa-exclamation-triangle"></i>
                            <h3>Complaint About Team</h3>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <!-- Work Plan Modal -->
    <div id="workPlanModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>Submit Today's Work Plan</h3>
                <span class="close-modal" onclick="closeWorkPlanModal()">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="workPlanForm" onsubmit="handleWorkPlanSubmit(event)">
                    <!-- Hidden field for status check -->
                    <input type="hidden" id="workPlanEmployeeNameForCheck" value="{{ user.employee_name if user else '' }}">
                    
                    <!-- Read-only fields -->
                    <div class="form-group">
                        <label for="workPlanDate">Date</label>
                        <input type="date" id="workPlanDate" name="date" readonly style="background-color: #f5f5f5;">
                    </div>

                    <div class="form-group">
                        <label for="workPlanEmployeeName">Employee Name</label>
                        <input type="text" id="workPlanEmployeeName" name="employeeName" readonly style="background-color: #f5f5f5;" value="{{ user.employee_name if user else '' }}">
                    </div>

                    <div class="form-group">
                        <label for="workPlanEmployeeTeam">Employee Team</label>
                        <input type="text" id="workPlanEmployeeTeam" name="employeeTeam" readonly style="background-color: #f5f5f5;" value="{{ user.department if user else '' }}">
                    </div>

                    <!-- Task Section -->
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid #ddd;">
                    <div class="form-group">
                        <h3 style="margin-bottom: 15px;">Task Details</h3>
                        
                        <div id="workPlanTaskContainer">
                            <div class="task-entry" data-task-index="0">
                                <div class="form-group">
                                    <label for="workPlanTask_0">Task*</label>
                                    <input type="text" id="workPlanTask_0" name="task[]" placeholder="Enter task name" required>
                                </div>

                                <div class="form-group">
                                    <label for="workPlanTaskDescription_0">Task Description*</label>
                                    <textarea id="workPlanTaskDescription_0" name="taskDescription[]" rows="2" placeholder="Enter task description" required></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="workPlanClientName_0">Client Name*</label>
                                    <input type="text" id="workPlanClientName_0" name="clientName[]" placeholder="Enter client name" required>
                                </div>

                                <div class="form-group">
                                    <label for="workPlanTime_0">Time Taken (in Hours)*</label>
                                    <input type="number" id="workPlanTime_0" name="time[]" step="0.01" min="0" placeholder="e.g., 1.25, 2.5" required>
                                </div>
                            </div>
                        </div>
                        
                        <button type="button" class="add-member-btn" id="addWorkPlanTaskBtn" style="margin-top: 15px;">+ Add New Task</button>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeWorkPlanModal()">Cancel</button>
                        <button type="submit" class="submit-btn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Update Work Modal -->
    <div id="updateWorkModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>Update Today's Work</h3>
                <span class="close-modal" onclick="closeUpdateWorkModal()">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="updateWorkForm" onsubmit="handleUpdateWorkSubmit(event)">
                    <!-- Hidden field for status check -->
                    <input type="hidden" id="updateWorkEmployeeNameForCheck" value="{{ user.employee_name if user else '' }}">
                    
                    <!-- Read-only fields -->
                    <div class="form-group">
                        <label for="updateWorkDate">Date</label>
                        <input type="date" id="updateWorkDate" name="date" readonly style="background-color: #f5f5f5;">
                    </div>

                    <div class="form-group">
                        <label for="updateWorkEmployeeName">Employee Name</label>
                        <input type="text" id="updateWorkEmployeeName" name="employeeName" readonly style="background-color: #f5f5f5;" value="{{ user.employee_name if user else '' }}">
                    </div>

                    <div class="form-group">
                        <label for="updateWorkEmployeeTeam">Employee Team</label>
                        <input type="text" id="updateWorkEmployeeTeam" name="employeeTeam" readonly style="background-color: #f5f5f5;" value="{{ user.department if user else '' }}">
                    </div>

                    <!-- Task Section -->
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid #ddd;">
                    <div class="form-group">
                        <h3 style="margin-bottom: 15px;">Task Details</h3>
                        
                        <div id="updateWorkTaskContainer">
                            <div class="task-entry" data-task-index="0">
                                <div class="form-group">
                                    <label for="updateWorkTask_0">Task*</label>
                                    <input type="text" id="updateWorkTask_0" name="task[]" placeholder="Enter task name" required>
                                </div>

                                <div class="form-group">
                                    <label for="updateWorkClientName_0">Client Name*</label>
                                    <input type="text" id="updateWorkClientName_0" name="clientName[]" placeholder="Enter client name" required>
                                </div>

                                <div class="form-group">
                                    <label for="updateWorkTime_0">Time Taken (in Hours)*</label>
                                    <input type="number" id="updateWorkTime_0" name="time[]" step="0.01" min="0" placeholder="e.g., 1.25, 2.5" required>
                                </div>

                                <div class="form-group">
                                    <label for="updateWorkStatus_0">Status*</label>
                                    <select id="updateWorkStatus_0" name="status[]" required>
                                        <option value="">Select Status</option>
                                        <option value="Completed">Completed</option>
                                        <option value="Pending">Pending</option>
                                        <option value="In Progress">In Progress</option>
                                        <option value="Remove">Remove</option>
                                        <option value="Take over">Take over</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="updateWorkDescription_0">Description*</label>
                                    <textarea id="updateWorkDescription_0" name="description[]" rows="2" placeholder="Enter description" required></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <button type="button" class="add-member-btn" id="addUpdateWorkTaskBtn" style="margin-top: 15px;">+ Add New Task</button>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeUpdateWorkModal()">Cancel</button>
                        <button type="submit" class="submit-btn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Sprint Plan Modal -->
    <div id="sprintPlanModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h3>Submit Sprint Plan</h3>
                <span class="close-modal" onclick="closeSprintPlanModal()">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="sprintPlanForm" onsubmit="handleSprintPlanSubmit(event)">
                    <!-- Hidden field for status check -->
                    <input type="hidden" id="sprintPlanEmployeeNameForCheck" value="{{ user.employee_name if user else '' }}">
                    
                    <!-- Read-only fields -->
                    <div class="form-group">
                        <label for="sprintPlanEmployeeName">Employee Name</label>
                        <input type="text" id="sprintPlanEmployeeName" name="employeeName" readonly style="background-color: #f5f5f5;" value="{{ user.employee_name if user else '' }}">
                    </div>

                    <div class="form-group">
                        <label for="sprintPlanEmployeeTeam">Employee Team</label>
                        <input type="text" id="sprintPlanEmployeeTeam" name="employeeTeam" readonly style="background-color: #f5f5f5;" value="{{ user.department if user else '' }}">
                    </div>

                    <!-- Day Section -->
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid #ddd;">
                    <div class="form-group">
                        <h3 style="margin-bottom: 15px;">Sprint Plan for Next 6 Days</h3>
                        
                        <div id="sprintPlanDayContainer">
                            <div class="day-entry" data-day-index="0">
                                <div class="form-group">
                                    <label>Date*</label>
                                    <input type="date" class="sprint-date-input" name="dates[]" required>
                                </div>
                                
                                <div class="form-group">
                                    <h4 style="margin-bottom: 10px;">Tasks</h4>
                                    <div id="sprintDay0TaskContainer" class="task-container">
                                        <div class="task-entry" data-task-index="0">
                                            <div class="form-group">
                                                <label>Task*</label>
                                                <input type="text" name="tasks[0][]" placeholder="Enter task" required>
                                            </div>
                                            <div class="form-group">
                                                <label>Client Name*</label>
                                                <input type="text" name="clientNames[0][]" placeholder="Enter client name" required>
                                            </div>
                                            <div class="form-group">
                                                <label>Time (Hours)*</label>
                                                <input type="number" name="times[0][]" step="0.01" min="0" placeholder="e.g., 1.25" required>
                                            </div>
                                            <button type="button" onclick="removeSprintTask(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 5px 10px; cursor: pointer;">Remove</button>
                                        </div>
                                    </div>
                                    <button type="button" class="add-member-btn add-sprint-task-btn" data-day="0" style="margin-top: 10px;">+ Add New Task</button>
                                </div>
                                
                                <button type="button" onclick="removeSprintDay(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; margin-top: 15px; cursor: pointer; width: 100%;">Remove This Day</button>
                            </div>
                        </div>
                        
                        <button type="button" class="add-member-btn" id="addSprintDayBtn" style="margin-top: 15px;">+ Add New Day</button>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeSprintPlanModal()">Cancel</button>
                        <button type="submit" class="submit-btn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Last Week Sprint Modal -->
    <div id="lastWeekSprintModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h3>Submit Last Week Sprint</h3>
                <span class="close-modal" onclick="closeLastWeekSprintModal()">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="lastWeekSprintForm" onsubmit="handleLastWeekSprintSubmit(event)">
                    <!-- Hidden field for status check -->
                    <input type="hidden" id="lastWeekSprintEmployeeNameForCheck" value="{{ user.employee_name if user else '' }}">
                    
                    <!-- Read-only fields -->
                    <div class="form-group">
                        <label for="lastWeekSprintEmployeeName">Employee Name</label>
                        <input type="text" id="lastWeekSprintEmployeeName" name="employeeName" readonly style="background-color: #f5f5f5;" value="{{ user.employee_name if user else '' }}">
                    </div>

                    <div class="form-group">
                        <label for="lastWeekSprintEmployeeTeam">Employee Team</label>
                        <input type="text" id="lastWeekSprintEmployeeTeam" name="employeeTeam" readonly style="background-color: #f5f5f5;" value="{{ user.department if user else '' }}">
                    </div>

                    <!-- Special Comment Field -->
                    <div class="form-group">
                        <label for="lastWeekSprintSpecialComment">Special Comment or Extra Comment</label>
                        <textarea id="lastWeekSprintSpecialComment" name="specialComment" rows="3" placeholder="Enter any specific comment or extra information"></textarea>
                    </div>

                    <!-- Day Section -->
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid #ddd;">
                    <div class="form-group">
                        <h3 style="margin-bottom: 15px;">Last Week Sprint Work</h3>
                        
                        <div id="lastWeekSprintDayContainer">
                            <div class="day-entry" data-day-index="0">
                                <div class="form-group">
                                    <label>Date*</label>
                                    <input type="date" class="sprint-date-input" name="dates[]" required>
                                </div>
                                
                                <div class="form-group">
                                    <h4 style="margin-bottom: 10px;">Tasks</h4>
                                    <div id="lastWeekSprintDay0TaskContainer" class="task-container">
                                        <div class="task-entry" data-task-index="0">
                                            <div class="form-group">
                                                <label>Task*</label>
                                                <input type="text" name="tasks[0][]" placeholder="Enter task" required>
                                            </div>
                                            <div class="form-group">
                                                <label>Client Name*</label>
                                                <input type="text" name="clientNames[0][]" placeholder="Enter client name" required>
                                            </div>
                                            <div class="form-group">
                                                <label>Time (Hours)*</label>
                                                <input type="number" name="times[0][]" step="0.01" min="0" placeholder="e.g., 1.25" required>
                                            </div>
                                            <div class="form-group">
                                                <label>Status*</label>
                                                <select name="statuses[0][]" required>
                                                    <option value="">Select Status</option>
                                                    <option value="Completed">Completed</option>
                                                    <option value="Pending">Pending</option>
                                                    <option value="In Progress">In Progress</option>
                                                    <option value="Remove">Remove</option>
                                                    <option value="Take over">Take over</option>
                                                </select>
                                            </div>
                                            <button type="button" onclick="removeLastWeekSprintTask(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 5px 10px; cursor: pointer;">Remove</button>
                                        </div>
                                    </div>
                                    <button type="button" class="add-member-btn add-lastweek-task-btn" data-day="0" style="margin-top: 10px;">+ Add New Task</button>
                                </div>
                                
                                <button type="button" onclick="removeLastWeekSprintDay(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; margin-top: 15px; cursor: pointer; width: 100%;">Remove This Day</button>
                            </div>
                        </div>
                        
                        <button type="button" class="add-member-btn" id="addLastWeekSprintDayBtn" style="margin-top: 15px;">+ Add New Day</button>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeLastWeekSprintModal()">Cancel</button>
                        <button type="submit" class="submit-btn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Extra Work Modal -->
    <div id="extraWorkModal" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h3>Submit Extra Work</h3>
                <span class="close-modal" onclick="closeExtraWorkModal()">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="extraWorkForm" onsubmit="handleExtraWorkSubmit(event)">
                    <!-- Read-only fields -->
                    <div class="form-group">
                        <label for="extraWorkEmployeeName">Employee Name</label>
                        <input type="text" id="extraWorkEmployeeName" name="employeeName" readonly style="background-color: #f5f5f5;" value="{{ user.employee_name if user else '' }}">
                    </div>

                    <div class="form-group">
                        <label for="extraWorkEmployeeTeam">Employee Team</label>
                        <input type="text" id="extraWorkEmployeeTeam" name="employeeTeam" readonly style="background-color: #f5f5f5;" value="{{ user.department if user else '' }}">
                    </div>

                    <div class="form-group">
                        <label for="extraWorkDate">Date</label>
                        <input type="date" id="extraWorkDate" name="date" readonly style="background-color: #f5f5f5;">
                    </div>

                    <div class="form-group">
                        <label for="extraWorkTime">Time (Hours)*</label>
                        <input type="number" id="extraWorkTime" name="time" step="0.01" min="0" placeholder="e.g., 1.25, 2.5" required>
                    </div>

                    <div class="form-group">
                        <label for="extraWorkTask">Task*</label>
                        <input type="text" id="extraWorkTask" name="task" placeholder="Enter task" required>
                    </div>

                    <div class="form-group">
                        <label for="extraWorkTaskDescription">Task Description*</label>
                        <textarea id="extraWorkTaskDescription" name="taskDescription" rows="3" placeholder="Enter task description" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="extraWorkClient">Client Name*</label>
                        <input type="text" id="extraWorkClient" name="clientName" placeholder="Enter client name" required>
                    </div>

                    <div class="form-group">
                        <label for="extraWorkConcernedPerson">Concerned Person*</label>
                        <input type="text" id="extraWorkConcernedPerson" name="concernedPerson" placeholder="Enter concerned person name" required>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeExtraWorkModal()">Cancel</button>
                        <button type="submit" class="submit-btn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Leave Approval Request Modal -->
    <div id="leaveApprovalModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>Leave Approval Request</h3>
                <span class="close-modal" onclick="closeLeaveApprovalModal()">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="leaveApprovalForm">
                    <!-- Employee Name (Default) -->
                    <div class="form-group">
                        <label for="leaveEmployeeName">Employee Name</label>
                        <input type="text" id="leaveEmployeeName" name="employeeName" readonly style="background-color: #f5f5f5;" value="{{ user.employee_name if user else '' }}">
                    </div>

                    <!-- Date (Today's Date by Default) -->
                    <div class="form-group">
                        <label for="leaveRequestDate">Date</label>
                        <input type="date" id="leaveRequestDate" name="requestDate" readonly style="background-color: #f5f5f5;">
                    </div>

                    <!-- Leave Type Radio Buttons -->
                    <div class="form-group">
                        <label>Leave Type*</label>
                        <div class="radio-group">
                            <label><input type="radio" name="leaveType" value="Preplan Leave" checked onchange="toggleCurrentTaskField()"> Preplan Leave</label>
                            <label><input type="radio" name="leaveType" value="Emergency Leave" onchange="toggleCurrentTaskField()"> Emergency Leave</label>
                        </div>
                    </div>

                    <!-- Leave From -->
                    <div class="form-group">
                        <label for="leaveFrom">Leave From*</label>
                        <input type="date" id="leaveFrom" name="leaveFrom" required>
                    </div>

                    <!-- Leave To -->
                    <div class="form-group">
                        <label for="leaveTo">Leave To*</label>
                        <input type="date" id="leaveTo" name="leaveTo" required>
                    </div>

                    <!-- Reason -->
                    <div class="form-group">
                        <label for="leaveReason">Reason*</label>
                        <input type="text" id="leaveReason" name="reason" placeholder="Enter reason for leave" required>
                    </div>

                    <!-- Your current task (Only shown if Emergency Leave is selected) -->
                    <div class="form-group" id="currentTaskField" style="display: none;">
                        <label for="leaveCurrentTask">Your Current Task*</label>
                        <textarea id="leaveCurrentTask" name="currentTask" rows="3" placeholder="Enter your current task details"></textarea>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeLeaveApprovalModal()">Cancel</button>
                        <button type="button" class="submit-btn" onclick="handleLeaveApprovalSubmit()">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Complaint About Team Modal -->
    <div id="complaintModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>Complaint About Team</h3>
                <span class="close-modal" onclick="closeComplaintModal()">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="complaintForm">
                    <!-- Employee Name (Default) -->
                    <div class="form-group">
                        <label for="complaintEmployeeName">Employee Name</label>
                        <input type="text" id="complaintEmployeeName" name="employeeName" readonly style="background-color: #f5f5f5;" value="{{ user.employee_name if user else '' }}">
                    </div>

                    <!-- Employee Team (Default) -->
                    <div class="form-group">
                        <label for="complaintEmployeeTeam">Employee Team</label>
                        <input type="text" id="complaintEmployeeTeam" name="employeeTeam" readonly style="background-color: #f5f5f5;" value="{{ user.department if user else '' }}">
                    </div>

                    <!-- Date (Current date by default) -->
                    <div class="form-group">
                        <label for="complaintDate">Date</label>
                        <input type="date" id="complaintDate" name="date" readonly style="background-color: #f5f5f5;">
                    </div>

                    <!-- Person Name -->
                    <div class="form-group">
                        <label for="complaintPersonName">Person Name*</label>
                        <input type="text" id="complaintPersonName" name="personName" placeholder="Enter person name" required>
                    </div>

                    <!-- Complain Description -->
                    <div class="form-group">
                        <label for="complaintDescription">Complain Description*</label>
                        <textarea id="complaintDescription" name="complainDescription" rows="4" placeholder="Enter complaint details" required></textarea>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeComplaintModal()">Cancel</button>
                        <button type="button" class="submit-btn" onclick="handleComplaintSubmit()">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

      <script>
        // Risk Factor and CVSS Score Validation Function
        function setupRiskFactorCVSSValidation(riskFactorId, cvssScoreId) {
            const riskFactorSelect = document.getElementById(riskFactorId);
            const cvssScoreInput = document.getElementById(cvssScoreId);
            
            if (!riskFactorSelect || !cvssScoreInput) return;
            
            // Risk Factor ranges
            const riskRanges = {
                'LOW': { min: 0.1, max: 3.9 },
                'MEDIUM': { min: 4.0, max: 6.9 },
                'HIGH': { min: 7.0, max: 8.9 },
                'CRITICAL': { min: 9.0, max: 10.0 }
            };
            
            // Function to validate CVSS Score against Risk Factor
            function validateCVSSScore() {
                const riskFactor = riskFactorSelect.value.toUpperCase();
                const cvssScore = parseFloat(cvssScoreInput.value.trim());
                
                // Clear previous error styling
                cvssScoreInput.style.borderColor = '';
                cvssScoreInput.style.backgroundColor = '';
                
                // If CVSS Score is empty, no validation needed
                if (!cvssScoreInput.value.trim()) {
                    return true;
                }
                
                // If Risk Factor is not selected, no validation
                if (!riskFactor || !riskRanges[riskFactor]) {
                    return true;
                }
                
                // Validate CVSS Score range
                const range = riskRanges[riskFactor];
                if (isNaN(cvssScore) || cvssScore < range.min || cvssScore > range.max) {
                    cvssScoreInput.style.borderColor = '#e74c3c';
                    cvssScoreInput.style.backgroundColor = '#ffe6e6';
                    cvssScoreInput.setCustomValidity(
                        `CVSS Score must be between ${range.min} and ${range.max} for ${riskFactor} risk factor.`
                    );
                    return false;
                } else {
                    cvssScoreInput.setCustomValidity('');
                    return true;
                }
            }
            
            // Function to update CVSS Score placeholder based on Risk Factor
            function updateCVSSPlaceholder() {
                const riskFactor = riskFactorSelect.value.toUpperCase();
                if (riskRanges[riskFactor]) {
                    const range = riskRanges[riskFactor];
                    cvssScoreInput.placeholder = `e.g., ${range.min} - ${range.max} (for ${riskFactor})`;
                } else {
                    cvssScoreInput.placeholder = 'e.g., 7.5';
                }
                
                // Validate existing CVSS Score when Risk Factor changes
                if (cvssScoreInput.value.trim()) {
                    validateCVSSScore();
                }
            }
            
            // Add event listeners
            riskFactorSelect.addEventListener('change', function() {
                updateCVSSPlaceholder();
                validateCVSSScore();
            });
            
            cvssScoreInput.addEventListener('input', function() {
                validateCVSSScore();
            });
            
            cvssScoreInput.addEventListener('blur', function() {
                validateCVSSScore();
            });
            
            // Initialize placeholder on load
            updateCVSSPlaceholder();
        }
        
        // Validation function for form submission
        function validateRiskFactorCVSS(riskFactorId, cvssScoreId) {
            const riskFactorSelect = document.getElementById(riskFactorId);
            const cvssScoreInput = document.getElementById(cvssScoreId);
            
            if (!riskFactorSelect || !cvssScoreInput) return true;
            
            const riskRanges = {
                'LOW': { min: 0.1, max: 3.9 },
                'MEDIUM': { min: 4.0, max: 6.9 },
                'HIGH': { min: 7.0, max: 8.9 },
                'CRITICAL': { min: 9.0, max: 10.0 }
            };
            
            const riskFactor = riskFactorSelect.value.toUpperCase();
            const cvssScore = parseFloat(cvssScoreInput.value.trim());
            
            // If CVSS Score is empty, no validation needed
            if (!cvssScoreInput.value.trim()) {
                return true;
            }
            
            // If Risk Factor is not selected, no validation
            if (!riskFactor || !riskRanges[riskFactor]) {
                return true;
            }
            
            // Validate CVSS Score range
            const range = riskRanges[riskFactor];
            if (isNaN(cvssScore) || cvssScore < range.min || cvssScore > range.max) {
                alert(`CVSS Score must be between ${range.min} and ${range.max} for ${riskFactor} risk factor.`);
                cvssScoreInput.focus();
                return false;
            }
            
            return true;
        }
    window.performanceData = {
        punctuality: {% if performance_data %}{{ performance_data.punctuality|default(0) }}{% else %}0{% endif %},
        clientSatisfaction: {% if performance_data %}{{ performance_data.client_satisfaction|default(0) }}{% else %}0{% endif %},
        behaviour: {% if performance_data %}{{ performance_data.behaviour|default(0) }}{% else %}0{% endif %},
        communicationSkills: {% if performance_data %}{{ performance_data.communication_skills|default(0) }}{% else %}0{% endif %},
        technicalSkills: {% if performance_data %}{{ performance_data.technical_skills|default(0) }}{% else %}0{% endif %},
        teamCoordination: {% if performance_data %}{{ performance_data.team_coordination|default(0) }}{% else %}0{% endif %}
    };
    </script>
    <script>
    window.performanceHistory = {% if performance_history %}{{ performance_history | tojson }}{% else %}[]{% endif %};
    
    // Debug logging for chart data
    console.log('Chart Data Setup:');
    console.log('- Performance Data:', window.performanceData);
    console.log('- Performance History:', window.performanceHistory);
    console.log('- Chart.js available:', typeof Chart !== 'undefined');
    </script>
    
    <script>
    // Chart initialization fallback - ensures charts render even if external JS fails
    (function() {
        let fallbackRetries = 0;
        const MAX_FALLBACK_RETRIES = 50; // Maximum 10 seconds (50 * 200ms)
        
        function initChartsFallback() {
            // Check if charts already initialized
            const progressCtx = document.getElementById('progressChart');
            const lastYearCtx = document.getElementById('lastYearChart');
            
            if (!progressCtx || !lastYearCtx) {
                fallbackRetries++;
                if (fallbackRetries >= MAX_FALLBACK_RETRIES) {
                    console.error('Chart canvas elements not found after maximum retries.');
                    return;
                }
                console.warn('Chart canvas elements not found yet, retrying... (' + fallbackRetries + '/' + MAX_FALLBACK_RETRIES + ')');
                setTimeout(initChartsFallback, 200);
                return;
            }
            
            // Wait for Chart.js
            if (typeof Chart === 'undefined') {
                fallbackRetries++;
                if (fallbackRetries >= MAX_FALLBACK_RETRIES) {
                    console.error('Chart.js failed to load after maximum retries. Please check your internet connection or CDN availability.');
                    return;
                }
                console.warn('Chart.js not loaded yet, retrying... (' + fallbackRetries + '/' + MAX_FALLBACK_RETRIES + ')');
                setTimeout(initChartsFallback, 200);
                return;
            }
            
            // Reset retry counter on success
            fallbackRetries = 0;
            
            // Check if charts are already initialized (have a chart instance)
            if (progressCtx.chartInstance || lastYearCtx.chartInstance) {
                console.log('Charts already initialized');
                return;
            }
            
            // Wait a bit more to let external JS initialize first, but not too long
            setTimeout(function() {
                // Force re-check canvas visibility
                if (progressCtx) {
                    const container = progressCtx.parentElement;
                    if (container) {
                        container.style.display = 'block';
                        container.style.width = '100%';
                        container.style.height = '260px';
                    }
                    progressCtx.style.display = 'block';
                }
                
                if (!progressCtx.chartInstance) {
                    console.log('Fallback: Initializing progress chart...');
                    try {
                        const perfData = window.performanceData || {};
                        const perfScores = [
                            perfData.punctuality || 0,
                            perfData.clientSatisfaction || 0,
                            perfData.behaviour || 0,
                            perfData.communicationSkills || 0,
                            perfData.technicalSkills || 0,
                            perfData.teamCoordination || 0
                        ];
                        
                        function getBarColor(score) {
                            if (score <= 6) return 'rgba(255, 99, 132, 0.8)';
                            if (score <= 8) return 'rgba(255, 206, 86, 0.8)';
                            return 'rgba(75, 192, 192, 0.8)';
                        }
                        
                        progressCtx.chartInstance = new Chart(progressCtx.getContext('2d'), {
                            type: 'bar',
                            data: {
                                labels: ['Punctuality', 'Client\nSatisfaction', 'Behaviour', 'Communication\nSkills', 'Technical\nSkills', 'Team\nCoordination'],
                                datasets: [{
                                    label: 'Performance Metrics',
                                    data: perfScores,
                                    backgroundColor: perfScores.map(getBarColor),
                                    borderColor: perfScores.map(s => getBarColor(s).replace('0.8', '1')),
                                    borderWidth: 2
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: { legend: { display: false } },
                                scales: {
                                    x: { ticks: { font: { size: 12 } } },
                                    y: { beginAtZero: true, max: 10, ticks: { stepSize: 1 } }
                                }
                            }
                        });
                        console.log('Fallback: Progress chart initialized');
                    } catch (e) {
                        console.error('Fallback: Error initializing progress chart:', e);
                    }
                }
                
                // Force re-check canvas visibility for last year chart
                if (lastYearCtx) {
                    const container = lastYearCtx.parentElement;
                    if (container) {
                        container.style.display = 'block';
                        container.style.width = '100%';
                        container.style.height = '260px';
                    }
                    lastYearCtx.style.display = 'block';
                }
                
                if (!lastYearCtx.chartInstance) {
                    console.log('Fallback: Initializing last year chart...');
                    try {
                        const historyData = window.performanceHistory && Array.isArray(window.performanceHistory) 
                            ? window.performanceHistory 
                            : [];
                        
                        if (historyData.length > 0) {
                            const labels = [];
                            const data = [];
                            for (let i = 0; i < historyData.length; i++) {
                                const item = historyData[i];
                                if (item && item.month_name && item.year_short) {
                                    labels.push(`${item.month_name}\n'${item.year_short}`);
                                    data.push(item.average !== undefined ? item.average : 0);
                                }
                            }
                            
                            if (labels.length > 0) {
                                const validData = data.filter(d => !isNaN(d) && d >= 0);
                                const dataMin = validData.length > 0 ? Math.min(...validData) : 0;
                                
                                lastYearCtx.chartInstance = new Chart(lastYearCtx.getContext('2d'), {
                                    type: 'line',
                                    data: {
                                        labels: labels,
                                        datasets: [{
                                            label: 'Performance Trend',
                                            data: data,
                                            borderColor: 'rgba(75, 192, 192, 1)',
                                            backgroundColor: 'rgba(75, 192, 192, 0.2)',
                                            tension: 0.1,
                                            fill: true,
                                            pointRadius: 4
                                        }]
                                    },
                                    options: {
                                        responsive: true,
                                        maintainAspectRatio: false,
                                        plugins: { legend: { display: false } },
                                        scales: {
                                            y: { 
                                                beginAtZero: dataMin === 0, 
                                                min: dataMin > 0 ? Math.max(0, dataMin - 1) : 0, 
                                                max: 10, 
                                                ticks: { stepSize: 1 } 
                                            },
                                            x: { ticks: { maxRotation: 90, minRotation: 90, font: { size: 12 } } }
                                        }
                                    }
                                });
                                console.log('Fallback: Last year chart initialized');
                            } else {
                                throw new Error('No valid labels');
                            }
                        } else {
                            // Empty chart
                            lastYearCtx.chartInstance = new Chart(lastYearCtx.getContext('2d'), {
                                type: 'line',
                                data: {
                                    labels: ['No Data'],
                                    datasets: [{ label: 'Performance Trend', data: [0], borderColor: 'rgba(200, 200, 200, 0.5)' }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    plugins: { legend: { display: false } },
                                    scales: { y: { beginAtZero: true, max: 10 } }
                                }
                            });
                        }
                    } catch (e) {
                        console.error('Fallback: Error initializing last year chart:', e);
                    }
                }
            }, 500);
        }
        
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initChartsFallback);
        } else {
            initChartsFallback();
        }
    })();
    
    // Work Plan Modal Functions
    function openWorkPlanModal() {
        // Check if already disabled
        const workCard = document.getElementById('workPlanCard');
        if (workCard && workCard.classList.contains('work-plan-submitted')) {
            return; // Don't open if already submitted
        }
        
        // Set today's date
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('workPlanDate').value = today;
        
        // Open modal
        document.getElementById('workPlanModal').style.display = 'block';
    }
    
    function closeWorkPlanModal() {
        document.getElementById('workPlanModal').style.display = 'none';
        // Reset form
        const form = document.getElementById('workPlanForm');
        if (form) {
            form.reset();
            // Reset to first task only
            const taskContainer = document.getElementById('workPlanTaskContainer');
            if (taskContainer) {
                const firstTask = taskContainer.querySelector('.task-entry');
                taskContainer.innerHTML = '';
                if (firstTask) {
                    taskContainer.appendChild(firstTask.cloneNode(true));
                }
            }
        }
    }
    
    // Function to check if current time is between 4 AM and 12 PM
    function isWorkPlanTimeAllowed() {
        const now = new Date();
        const currentHour = now.getHours();
        // Check if time is between 4 AM (4) and 12 PM (12)
        return currentHour >= 4 && currentHour < 12;
    }
    
    // Function to enable/disable work plan card based on time
    function updateWorkPlanCardTimeRestriction() {
        const workCard = document.getElementById('workPlanCard');
        if (!workCard) return;
        
        // Don't modify if already submitted (check if onclick is null or has work-plan-submitted class)
        if (workCard.onclick === null || workCard.classList.contains('work-plan-submitted')) {
            return;
        }
        
        const isAllowed = isWorkPlanTimeAllowed();
        
        if (!isAllowed) {
            // Disable the button outside allowed time
            workCard.style.cursor = 'not-allowed';
            workCard.style.opacity = '0.6';
            const originalOnclick = workCard.onclick;
            workCard.onclick = function() {
                alert('Submit Today\'s Work Plan is only available between 4 AM and 12 PM.');
            };
            const icon = workCard.querySelector('i');
            const heading = workCard.querySelector('h3');
            if (icon) icon.style.opacity = '0.5';
            if (heading) heading.style.color = '#888';
        } else {
            // Enable the button during allowed time
            workCard.style.cursor = 'pointer';
            workCard.style.opacity = '1';
            workCard.onclick = openWorkPlanModal;
            const icon = workCard.querySelector('i');
            const heading = workCard.querySelector('h3');
            if (icon) icon.style.opacity = '1';
            if (heading) heading.style.color = '';
        }
    }
    
    // Check work plan status on page load
    document.addEventListener('DOMContentLoaded', function() {
        // Check if work plan has already been submitted today
        const today = new Date().toISOString().split('T')[0];
        const employeeName = document.getElementById('workPlanEmployeeNameForCheck')?.value || '';
        
        if (employeeName) {
            const formData = new FormData();
            formData.append('date', today);
            formData.append('employeeName', employeeName);
            
            fetch('/check_work_plan_status', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.submitted) {
                    const workCard = document.getElementById('workPlanCard');
                    if (workCard) {
                        workCard.classList.add('work-plan-submitted');
                        workCard.style.cursor = 'not-allowed';
                        workCard.style.opacity = '0.6';
                        workCard.onclick = null;
                        
                        const icon = workCard.querySelector('i');
                        const heading = workCard.querySelector('h3');
                        if (icon) icon.style.opacity = '0.5';
                        if (heading) {
                            heading.textContent = 'Work Plan Submitted Today';
                            heading.style.color = '#888';
                        }
                    }
                } else {
                    // If not submitted, check time restriction
                    updateWorkPlanCardTimeRestriction();
                }
            })
            .catch(error => console.error('Error checking work plan status:', error));
        } else {
            // If no employee name, still check time restriction
            updateWorkPlanCardTimeRestriction();
        }
        
        // Check time restriction periodically (every minute)
        setInterval(updateWorkPlanCardTimeRestriction, 60000);
        
        // Function to check if current time is between 6 PM and 11 PM
        function isUpdateWorkTimeAllowed() {
            const now = new Date();
            const currentHour = now.getHours();
            // Check if time is between 6 PM (18) and 11 PM (23)
            return currentHour >= 18 && currentHour < 23;
        }
        
        // Function to enable/disable update work card based on time
        function updateWorkCardTimeRestriction() {
            const workCard = document.getElementById('updateWorkCard');
            if (!workCard) return;
            
            // Don't modify if already submitted (check if onclick is null or has update-work-submitted class)
            if (workCard.onclick === null || workCard.classList.contains('update-work-submitted')) {
                return;
            }
            
            const isAllowed = isUpdateWorkTimeAllowed();
            
            if (!isAllowed) {
                // Disable the button outside allowed time
                workCard.style.cursor = 'not-allowed';
                workCard.style.opacity = '0.6';
                workCard.onclick = function() {
                    alert('Update Today\'s Work is only available between 6 PM and 11 PM.');
                };
                const icon = workCard.querySelector('i');
                const heading = workCard.querySelector('h3');
                if (icon) icon.style.opacity = '0.5';
                if (heading) heading.style.color = '#888';
            } else {
                // Enable the button during allowed time
                workCard.style.cursor = 'pointer';
                workCard.style.opacity = '1';
                workCard.onclick = openUpdateWorkModal;
                const icon = workCard.querySelector('i');
                const heading = workCard.querySelector('h3');
                if (icon) icon.style.opacity = '1';
                if (heading) heading.style.color = '';
            }
        }
        
        // Apply time restriction immediately on page load (before async status check)
        updateWorkCardTimeRestriction();
        
        // Add Task functionality
        const addTaskBtn = document.getElementById('addWorkPlanTaskBtn');
        if (addTaskBtn) {
            addTaskBtn.addEventListener('click', function() {
                const taskContainer = document.getElementById('workPlanTaskContainer');
                const tasks = taskContainer.querySelectorAll('.task-entry');
                
                if (tasks.length >= 10) {
                    alert('Maximum 10 tasks allowed');
                    return;
                }
                
                const newIndex = tasks.length;
                const newTask = document.createElement('div');
                newTask.className = 'task-entry';
                newTask.setAttribute('data-task-index', newIndex);
                newTask.innerHTML = `
                    <hr style="margin: 20px 0; border: none; border-top: 1px solid #ddd;">
                    <div class="form-group">
                        <label for="workPlanTask_${newIndex}">Task*</label>
                        <input type="text" id="workPlanTask_${newIndex}" name="task[]" placeholder="Enter task name" required>
                    </div>

                    <div class="form-group">
                        <label for="workPlanTaskDescription_${newIndex}">Task Description*</label>
                        <textarea id="workPlanTaskDescription_${newIndex}" name="taskDescription[]" rows="2" placeholder="Enter task description" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="workPlanClientName_${newIndex}">Client Name*</label>
                        <input type="text" id="workPlanClientName_${newIndex}" name="clientName[]" placeholder="Enter client name" required>
                    </div>

                    <div class="form-group">
                        <label for="workPlanTime_${newIndex}">Time Taken (in Hours)*</label>
                        <input type="number" id="workPlanTime_${newIndex}" name="time[]" step="0.01" min="0" placeholder="e.g., 1.25, 2.5" required>
                    </div>
                    
                    <button type="button" onclick="removeWorkPlanTask(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; margin-top: 10px; cursor: pointer;">Remove Task</button>
                `;
                taskContainer.appendChild(newTask);
            });
        }
    });
    
    function removeWorkPlanTask(button) {
        const taskEntry = button.closest('.task-entry');
        if (taskEntry) {
            taskEntry.remove();
        }
    }
    
    // Work Plan Form Submission Handler
    function handleWorkPlanSubmit(event) {
        event.preventDefault();
        
        const submitBtn = event.target.querySelector('button[type="submit"]');
        const originalText = submitBtn.textContent;
        submitBtn.disabled = true;
        submitBtn.textContent = 'Processing...';
        
        const formData = new FormData(event.target);
        
        fetch('/submit_work_plan', {
            method: 'POST',
            body: formData
        })
        .then(response => {
            if (response.ok) {
                return response.json();
            }
            throw new Error('Network response was not ok');
        })
        .then(data => {
            if (data.success) {
                alert('Work plan submitted successfully!');
                closeWorkPlanModal();
                
                const workCard = document.getElementById('workPlanCard');
                if (workCard) {
                    workCard.classList.add('work-plan-submitted');
                    workCard.style.cursor = 'not-allowed';
                    workCard.style.opacity = '0.6';
                    workCard.onclick = null;
                    
                    const icon = workCard.querySelector('i');
                    const heading = workCard.querySelector('h3');
                    if (icon) icon.style.opacity = '0.5';
                    if (heading) {
                        heading.textContent = 'Work Plan Submitted Today';
                        heading.style.color = '#888';
                    }
                }
                
                setTimeout(() => location.reload(), 1000);
            } else {
                alert(data.error || 'Failed to submit work plan');
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred during submission. Please try again.');
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
        });
    }
    
    // Update Work Modal Functions
    function openUpdateWorkModal() {
        const workCard = document.getElementById('updateWorkCard');
        if (workCard && workCard.classList.contains('update-work-submitted')) {
            return;
        }
        
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('updateWorkDate').value = today;
        document.getElementById('updateWorkModal').style.display = 'block';
    }
    
    function closeUpdateWorkModal() {
        document.getElementById('updateWorkModal').style.display = 'none';
        const form = document.getElementById('updateWorkForm');
        if (form) {
            form.reset();
            const taskContainer = document.getElementById('updateWorkTaskContainer');
            if (taskContainer) {
                const firstTask = taskContainer.querySelector('.task-entry');
                taskContainer.innerHTML = '';
                if (firstTask) {
                    taskContainer.appendChild(firstTask.cloneNode(true));
                }
            }
        }
    }
    
    // Add Update Work Task functionality
    document.addEventListener('DOMContentLoaded', function() {
        const addUpdateTaskBtn = document.getElementById('addUpdateWorkTaskBtn');
        if (addUpdateTaskBtn) {
            addUpdateTaskBtn.addEventListener('click', function() {
                const taskContainer = document.getElementById('updateWorkTaskContainer');
                const tasks = taskContainer.querySelectorAll('.task-entry');
                
                if (tasks.length >= 10) {
                    alert('Maximum 10 tasks allowed');
                    return;
                }
                
                const newIndex = tasks.length;
                const newTask = document.createElement('div');
                newTask.className = 'task-entry';
                newTask.setAttribute('data-task-index', newIndex);
                newTask.innerHTML = `
                    <hr style="margin: 20px 0; border: none; border-top: 1px solid #ddd;">
                    <div class="form-group">
                        <label for="updateWorkTask_${newIndex}">Task*</label>
                        <input type="text" id="updateWorkTask_${newIndex}" name="task[]" placeholder="Enter task name" required>
                    </div>

                    <div class="form-group">
                        <label for="updateWorkClientName_${newIndex}">Client Name*</label>
                        <input type="text" id="updateWorkClientName_${newIndex}" name="clientName[]" placeholder="Enter client name" required>
                    </div>

                    <div class="form-group">
                        <label for="updateWorkTime_${newIndex}">Time Taken (in Hours)*</label>
                        <input type="number" id="updateWorkTime_${newIndex}" name="time[]" step="0.01" min="0" placeholder="e.g., 1.25, 2.5" required>
                    </div>

                    <div class="form-group">
                        <label for="updateWorkStatus_${newIndex}">Status*</label>
                        <select id="updateWorkStatus_${newIndex}" name="status[]" required>
                            <option value="">Select Status</option>
                            <option value="Completed">Completed</option>
                            <option value="Pending">Pending</option>
                            <option value="In Progress">In Progress</option>
                            <option value="Remove">Remove</option>
                            <option value="Take over">Take over</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="updateWorkDescription_${newIndex}">Description*</label>
                        <textarea id="updateWorkDescription_${newIndex}" name="description[]" rows="2" placeholder="Enter description" required></textarea>
                    </div>
                    
                    <button type="button" onclick="removeUpdateWorkTask(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; margin-top: 10px; cursor: pointer;">Remove Task</button>
                `;
                taskContainer.appendChild(newTask);
            });
        }
        
        // Check update work status on page load
        const today = new Date().toISOString().split('T')[0];
        const employeeName = document.getElementById('updateWorkEmployeeNameForCheck')?.value || '';
        
        if (employeeName) {
            const formData = new FormData();
            formData.append('date', today);
            formData.append('employeeName', employeeName);
            
            fetch('/check_update_work_status', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.submitted) {
                    const workCard = document.getElementById('updateWorkCard');
                    if (workCard) {
                        workCard.classList.add('update-work-submitted');
                        workCard.style.cursor = 'not-allowed';
                        workCard.style.opacity = '0.6';
                        workCard.onclick = null;
                        
                        const icon = workCard.querySelector('i');
                        const heading = workCard.querySelector('h3');
                        if (icon) icon.style.opacity = '0.5';
                        if (heading) {
                            heading.textContent = 'Work Updated Today';
                            heading.style.color = '#888';
                        }
                    }
                } else {
                    // If not submitted, check time restriction
                    updateWorkCardTimeRestriction();
                }
            })
            .catch(error => console.error('Error checking update work status:', error));
        } else {
            // If no employee name, still check time restriction
            updateWorkCardTimeRestriction();
        }
        
        // Check time restriction periodically (every minute)
        setInterval(updateWorkCardTimeRestriction, 60000);
        
        // Check sprint plan status on page load
        const sprintEmployeeName = document.getElementById('sprintPlanEmployeeNameForCheck')?.value || '';
        
        if (sprintEmployeeName) {
            const sprintFormData = new FormData();
            sprintFormData.append('employeeName', sprintEmployeeName);
            
            fetch('/check_sprint_plan_status', {
                method: 'POST',
                body: sprintFormData
            })
            .then(response => response.json())
            .then(data => {
                if (data.submitted) {
                    const sprintCard = document.getElementById('sprintPlanCard');
                    if (sprintCard) {
                        sprintCard.classList.add('sprint-plan-submitted');
                        sprintCard.style.cursor = 'not-allowed';
                        sprintCard.style.opacity = '0.6';
                        sprintCard.onclick = null;
                        
                        const icon = sprintCard.querySelector('i');
                        const heading = sprintCard.querySelector('h3');
                        if (icon) icon.style.opacity = '0.5';
                        if (heading) {
                            heading.textContent = 'Sprint Plan Submitted';
                            heading.style.color = '#888';
                        }
                    }
                }
            })
            .catch(error => console.error('Error checking sprint plan status:', error));
        }
        
        // Check last week sprint status on page load
        const lastWeekEmployeeName = document.getElementById('lastWeekSprintEmployeeNameForCheck')?.value || '';
        
        if (lastWeekEmployeeName) {
            const lastWeekFormData = new FormData();
            lastWeekFormData.append('employeeName', lastWeekEmployeeName);
            
            fetch('/check_last_week_sprint_status', {
                method: 'POST',
                body: lastWeekFormData
            })
            .then(response => response.json())
            .then(data => {
                if (data.submitted) {
                    const sprintCard = document.getElementById('lastWeekSprintCard');
                    if (sprintCard) {
                        sprintCard.classList.add('last-week-sprint-submitted');
                        sprintCard.style.cursor = 'not-allowed';
                        sprintCard.style.opacity = '0.6';
                        sprintCard.onclick = null;
                        
                        const icon = sprintCard.querySelector('i');
                        const heading = sprintCard.querySelector('h3');
                        if (icon) icon.style.opacity = '0.5';
                        if (heading) {
                            heading.textContent = 'Last Week Sprint Submitted';
                            heading.style.color = '#888';
                        }
                    }
                }
            })
            .catch(error => console.error('Error checking last week sprint status:', error));
        }
    });
    
    function removeUpdateWorkTask(button) {
        const taskEntry = button.closest('.task-entry');
        if (taskEntry) {
            taskEntry.remove();
        }
    }
    
    // Update Work Form Submission Handler
    function handleUpdateWorkSubmit(event) {
        event.preventDefault();
        
        const submitBtn = event.target.querySelector('button[type="submit"]');
        const originalText = submitBtn.textContent;
        submitBtn.disabled = true;
        submitBtn.textContent = 'Processing...';
        
        const formData = new FormData(event.target);
        
        fetch('/submit_update_work', {
            method: 'POST',
            body: formData
        })
        .then(response => {
            if (response.ok) {
                return response.json();
            }
            throw new Error('Network response was not ok');
        })
        .then(data => {
            if (data.success) {
                alert('Work updated successfully!');
                closeUpdateWorkModal();
                
                const workCard = document.getElementById('updateWorkCard');
                if (workCard) {
                    workCard.classList.add('update-work-submitted');
                    workCard.style.cursor = 'not-allowed';
                    workCard.style.opacity = '0.6';
                    workCard.onclick = null;
                    
                    const icon = workCard.querySelector('i');
                    const heading = workCard.querySelector('h3');
                    if (icon) icon.style.opacity = '0.5';
                    if (heading) {
                        heading.textContent = 'Work Updated Today';
                        heading.style.color = '#888';
                    }
                }
                
                setTimeout(() => location.reload(), 1000);
            } else {
                alert(data.error || 'Failed to update work');
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred. Please try again.');
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
        });
    }
    
    // Sprint Plan Modal Functions
    function openSprintPlanModal() {
        const sprintCard = document.getElementById('sprintPlanCard');
        if (sprintCard && sprintCard.classList.contains('sprint-plan-submitted')) {
            return;
        }
        document.getElementById('sprintPlanModal').style.display = 'block';
    }
    
    function closeSprintPlanModal() {
        document.getElementById('sprintPlanModal').style.display = 'none';
        const form = document.getElementById('sprintPlanForm');
        if (form) {
            form.reset();
            const dayContainer = document.getElementById('sprintPlanDayContainer');
            if (dayContainer) {
                const firstDay = dayContainer.querySelector('.day-entry');
                dayContainer.innerHTML = '';
                if (firstDay) {
                    dayContainer.appendChild(firstDay.cloneNode(true));
                }
            }
        }
    }
    
    // Sprint Plan JavaScript
    let sprintDayIndex = 0;
    
    document.addEventListener('DOMContentLoaded', function() {
        // Add New Day functionality
        const addDayBtn = document.getElementById('addSprintDayBtn');
        if (addDayBtn) {
            addDayBtn.addEventListener('click', function() {
                const dayContainer = document.getElementById('sprintPlanDayContainer');
                const days = dayContainer.querySelectorAll('.day-entry');
                
                if (days.length >= 6) {
                    alert('Maximum 6 days allowed');
                    return;
                }
                
                sprintDayIndex++;
                const newDay = document.createElement('div');
                newDay.className = 'day-entry';
                newDay.setAttribute('data-day-index', sprintDayIndex);
                newDay.innerHTML = `
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid #ddd;">
                    <div class="form-group">
                        <label>Date*</label>
                        <input type="date" class="sprint-date-input" name="dates[]" required>
                    </div>
                    
                    <div class="form-group">
                        <h4 style="margin-bottom: 10px;">Tasks</h4>
                        <div id="sprintDay${sprintDayIndex}TaskContainer" class="task-container">
                            <div class="task-entry" data-task-index="0">
                                <div class="form-group">
                                    <label>Task*</label>
                                    <input type="text" name="tasks[${sprintDayIndex}][]" placeholder="Enter task" required>
                                </div>
                                <div class="form-group">
                                    <label>Client Name*</label>
                                    <input type="text" name="clientNames[${sprintDayIndex}][]" placeholder="Enter client name" required>
                                </div>
                                <div class="form-group">
                                    <label>Time (Hours)*</label>
                                    <input type="number" name="times[${sprintDayIndex}][]" step="0.01" min="0" placeholder="e.g., 1.25" required>
                                </div>
                                <button type="button" onclick="removeSprintTask(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 5px 10px; cursor: pointer;">Remove</button>
                            </div>
                        </div>
                        <button type="button" class="add-member-btn add-sprint-task-btn" data-day="${sprintDayIndex}" style="margin-top: 10px;">+ Add New Task</button>
                    </div>
                    
                    <button type="button" onclick="removeSprintDay(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; margin-top: 15px; cursor: pointer; width: 100%;">Remove This Day</button>
                `;
                dayContainer.appendChild(newDay);
            });
        }
        
        // Add New Task functionality (delegated)
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('add-sprint-task-btn')) {
                const dayIndex = e.target.getAttribute('data-day');
                const taskContainer = document.getElementById(`sprintDay${dayIndex}TaskContainer`);
                const tasks = taskContainer.querySelectorAll('.task-entry');
                
                const newIndex = tasks.length;
                const newTask = document.createElement('div');
                newTask.className = 'task-entry';
                newTask.setAttribute('data-task-index', newIndex);
                newTask.innerHTML = `
                    <div class="form-group">
                        <label>Task*</label>
                        <input type="text" name="tasks[${dayIndex}][]" placeholder="Enter task" required>
                    </div>
                    <div class="form-group">
                        <label>Client Name*</label>
                        <input type="text" name="clientNames[${dayIndex}][]" placeholder="Enter client name" required>
                    </div>
                    <div class="form-group">
                        <label>Time (Hours)*</label>
                        <input type="number" name="times[${dayIndex}][]" step="0.01" min="0" placeholder="e.g., 1.25" required>
                    </div>
                    <button type="button" onclick="removeSprintTask(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 5px 10px; cursor: pointer;">Remove</button>
                `;
                taskContainer.appendChild(newTask);
            }
        });
    });
    
    function removeSprintTask(button) {
        const taskEntry = button.closest('.task-entry');
        if (taskEntry) {
            taskEntry.remove();
        }
    }
    
    function removeSprintDay(button) {
        const dayEntry = button.closest('.day-entry');
        if (dayEntry) {
            dayEntry.remove();
        }
    }
    
    function handleSprintPlanSubmit(event) {
        event.preventDefault();
        
        const submitBtn = event.target.querySelector('button[type="submit"]');
        const originalText = submitBtn.textContent;
        submitBtn.disabled = true;
        submitBtn.textContent = 'Processing...';
        
        const formData = new FormData(event.target);
        
        fetch('/submit_sprint_plan', {
            method: 'POST',
            body: formData
        })
        .then(response => {
            if (response.ok) {
                return response.json();
            }
            throw new Error('Network response was not ok');
        })
        .then(data => {
            if (data.success) {
                alert('Sprint plan submitted successfully!');
                closeSprintPlanModal();
                
                const sprintCard = document.getElementById('sprintPlanCard');
                if (sprintCard) {
                    sprintCard.classList.add('sprint-plan-submitted');
                    sprintCard.style.cursor = 'not-allowed';
                    sprintCard.style.opacity = '0.6';
                    sprintCard.onclick = null;
                    
                    const icon = sprintCard.querySelector('i');
                    const heading = sprintCard.querySelector('h3');
                    if (icon) icon.style.opacity = '0.5';
                    if (heading) {
                        heading.textContent = 'Sprint Plan Submitted';
                        heading.style.color = '#888';
                    }
                }
                
                setTimeout(() => location.reload(), 1000);
            } else {
                alert(data.error || 'Failed to submit sprint plan');
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred. Please try again.');
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
        });
    }
    
    // Last Week Sprint Modal Functions
    function openLastWeekSprintModal() {
        const sprintCard = document.getElementById('lastWeekSprintCard');
        if (sprintCard && sprintCard.classList.contains('last-week-sprint-submitted')) {
            return;
        }
        document.getElementById('lastWeekSprintModal').style.display = 'block';
    }
    
    function closeLastWeekSprintModal() {
        document.getElementById('lastWeekSprintModal').style.display = 'none';
        const form = document.getElementById('lastWeekSprintForm');
        if (form) {
            form.reset();
            const dayContainer = document.getElementById('lastWeekSprintDayContainer');
            if (dayContainer) {
                const firstDay = dayContainer.querySelector('.day-entry');
                dayContainer.innerHTML = '';
                if (firstDay) {
                    dayContainer.appendChild(firstDay.cloneNode(true));
                }
            }
        }
    }
    
    // Last Week Sprint JavaScript
    let lastWeekSprintDayIndex = 0;
    
    document.addEventListener('DOMContentLoaded', function() {
        // Add New Day functionality for Last Week Sprint
        const addLastWeekDayBtn = document.getElementById('addLastWeekSprintDayBtn');
        if (addLastWeekDayBtn) {
            addLastWeekDayBtn.addEventListener('click', function() {
                const dayContainer = document.getElementById('lastWeekSprintDayContainer');
                const days = dayContainer.querySelectorAll('.day-entry');
                
                if (days.length >= 6) {
                    alert('Maximum 6 days allowed');
                    return;
                }
                
                lastWeekSprintDayIndex++;
                const newDay = document.createElement('div');
                newDay.className = 'day-entry';
                newDay.setAttribute('data-day-index', lastWeekSprintDayIndex);
                newDay.innerHTML = `
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid #ddd;">
                    <div class="form-group">
                        <label>Date*</label>
                        <input type="date" class="sprint-date-input" name="dates[]" required>
                    </div>
                    
                    <div class="form-group">
                        <h4 style="margin-bottom: 10px;">Tasks</h4>
                        <div id="lastWeekSprintDay${lastWeekSprintDayIndex}TaskContainer" class="task-container">
                            <div class="task-entry" data-task-index="0">
                                <div class="form-group">
                                    <label>Task*</label>
                                    <input type="text" name="tasks[${lastWeekSprintDayIndex}][]" placeholder="Enter task" required>
                                </div>
                                <div class="form-group">
                                    <label>Client Name*</label>
                                    <input type="text" name="clientNames[${lastWeekSprintDayIndex}][]" placeholder="Enter client name" required>
                                </div>
                                <div class="form-group">
                                    <label>Time (Hours)*</label>
                                    <input type="number" name="times[${lastWeekSprintDayIndex}][]" step="0.01" min="0" placeholder="e.g., 1.25" required>
                                </div>
                                <div class="form-group">
                                    <label>Status*</label>
                                    <select name="statuses[${lastWeekSprintDayIndex}][]" required>
                                        <option value="">Select Status</option>
                                        <option value="Completed">Completed</option>
                                        <option value="Pending">Pending</option>
                                        <option value="In Progress">In Progress</option>
                                        <option value="Remove">Remove</option>
                                        <option value="Take over">Take over</option>
                                    </select>
                                </div>
                                <button type="button" onclick="removeLastWeekSprintTask(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 5px 10px; cursor: pointer;">Remove</button>
                            </div>
                        </div>
                        <button type="button" class="add-member-btn add-lastweek-task-btn" data-day="${lastWeekSprintDayIndex}" style="margin-top: 10px;">+ Add New Task</button>
                    </div>
                    
                    <button type="button" onclick="removeLastWeekSprintDay(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px; margin-top: 15px; cursor: pointer; width: 100%;">Remove This Day</button>
                `;
                dayContainer.appendChild(newDay);
            });
        }
        
        // Add New Task functionality for Last Week Sprint (delegated)
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('add-lastweek-task-btn')) {
                const dayIndex = e.target.getAttribute('data-day');
                const taskContainer = document.getElementById(`lastWeekSprintDay${dayIndex}TaskContainer`);
                const tasks = taskContainer.querySelectorAll('.task-entry');
                
                const newIndex = tasks.length;
                const newTask = document.createElement('div');
                newTask.className = 'task-entry';
                newTask.setAttribute('data-task-index', newIndex);
                newTask.innerHTML = `
                    <div class="form-group">
                        <label>Task*</label>
                        <input type="text" name="tasks[${dayIndex}][]" placeholder="Enter task" required>
                    </div>
                    <div class="form-group">
                        <label>Client Name*</label>
                        <input type="text" name="clientNames[${dayIndex}][]" placeholder="Enter client name" required>
                    </div>
                    <div class="form-group">
                        <label>Time (Hours)*</label>
                        <input type="number" name="times[${dayIndex}][]" step="0.01" min="0" placeholder="e.g., 1.25" required>
                    </div>
                    <div class="form-group">
                        <label>Status*</label>
                        <select name="statuses[${dayIndex}][]" required>
                            <option value="">Select Status</option>
                            <option value="Completed">Completed</option>
                            <option value="Pending">Pending</option>
                            <option value="In Progress">In Progress</option>
                            <option value="Remove">Remove</option>
                            <option value="Take over">Take over</option>
                        </select>
                    </div>
                    <button type="button" onclick="removeLastWeekSprintTask(this)" style="background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 5px 10px; cursor: pointer;">Remove</button>
                `;
                taskContainer.appendChild(newTask);
            }
        });
    });
    
    function removeLastWeekSprintTask(button) {
        const taskEntry = button.closest('.task-entry');
        if (taskEntry) {
            taskEntry.remove();
        }
    }
    
    function removeLastWeekSprintDay(button) {
        const dayEntry = button.closest('.day-entry');
        if (dayEntry) {
            dayEntry.remove();
        }
    }
    
    function handleLastWeekSprintSubmit(event) {
        event.preventDefault();
        
        const submitBtn = event.target.querySelector('button[type="submit"]');
        const originalText = submitBtn.textContent;
        submitBtn.disabled = true;
        submitBtn.textContent = 'Processing...';
        
        const formData = new FormData(event.target);
        
        fetch('/submit_last_week_sprint', {
            method: 'POST',
            body: formData
        })
        .then(response => {
            if (response.ok) {
                return response.json();
            }
            throw new Error('Network response was not ok');
        })
        .then(data => {
            if (data.success) {
                alert('Last week sprint submitted successfully!');
                closeLastWeekSprintModal();
                
                const sprintCard = document.getElementById('lastWeekSprintCard');
                if (sprintCard) {
                    sprintCard.classList.add('last-week-sprint-submitted');
                    sprintCard.style.cursor = 'not-allowed';
                    sprintCard.style.opacity = '0.6';
                    sprintCard.onclick = null;
                    
                    const icon = sprintCard.querySelector('i');
                    const heading = sprintCard.querySelector('h3');
                    if (icon) icon.style.opacity = '0.5';
                    if (heading) {
                        heading.textContent = 'Last Week Sprint Submitted';
                        heading.style.color = '#888';
                    }
                }
                
                setTimeout(() => location.reload(), 1000);
            } else {
                alert(data.error || 'Failed to submit last week sprint');
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred. Please try again.');
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
        });
    }
    
    // Extra Work Modal Functions
    function openExtraWorkModal() {
        const today = new Date();
        today.setDate(today.getDate() - 1);
        const yesterday = today.toISOString().split('T')[0];
        document.getElementById('extraWorkDate').value = yesterday;
        document.getElementById('extraWorkModal').style.display = 'block';
    }
    
    function closeExtraWorkModal() {
        document.getElementById('extraWorkModal').style.display = 'none';
        const form = document.getElementById('extraWorkForm');
        if (form) {
            form.reset();
        }
    }
    
    function handleExtraWorkSubmit(event) {
        event.preventDefault();
        
        const submitBtn = event.target.querySelector('button[type="submit"]');
        const originalText = submitBtn.textContent;
        submitBtn.disabled = true;
        submitBtn.textContent = 'Processing...';
        
        const formData = new FormData(event.target);
        
        fetch('/submit_extra_work', {
            method: 'POST',
            body: formData
        })
        .then(response => {
            if (response.ok) {
                return response.json();
            }
            throw new Error('Network response was not ok');
        })
        .then(data => {
            if (data.success) {
                alert('Extra work submitted successfully!');
                closeExtraWorkModal();
                setTimeout(() => location.reload(), 1000);
            } else {
                alert(data.error || 'Failed to submit extra work');
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred. Please try again.');
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
        });
    }
    
    // Leave Approval Modal Functions
    function openLeaveApprovalModal() {
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('leaveRequestDate').value = today;
        document.getElementById('leaveApprovalModal').style.display = 'block';
    }
    
    function closeLeaveApprovalModal() {
        document.getElementById('leaveApprovalModal').style.display = 'none';
        const form = document.getElementById('leaveApprovalForm');
        if (form) {
            form.reset();
            document.getElementById('currentTaskField').style.display = 'none';
        }
    }
    
    function toggleCurrentTaskField() {
        const leaveType = document.querySelector('input[name="leaveType"]:checked').value;
        const currentTaskField = document.getElementById('currentTaskField');
        const currentTaskInput = document.getElementById('leaveCurrentTask');
        
        if (leaveType === 'Emergency Leave') {
            currentTaskField.style.display = 'block';
            currentTaskInput.required = true;
        } else {
            currentTaskField.style.display = 'none';
            currentTaskInput.required = false;
            currentTaskInput.value = '';
        }
    }
    
    function handleLeaveApprovalSubmit() {
        const form = document.getElementById('leaveApprovalForm');
        const leaveType = document.querySelector('input[name="leaveType"]:checked').value;
        
        if (leaveType === 'Emergency Leave') {
            const currentTask = document.getElementById('leaveCurrentTask').value.trim();
            if (!currentTask) {
                alert('Please enter your current task for Emergency Leave');
                return;
            }
        }
        
        if (!form.checkValidity()) {
            form.reportValidity();
            return;
        }
        
        // Collect form data
        const formData = {
            employeeName: document.getElementById('leaveEmployeeName').value,
            requestDate: document.getElementById('leaveRequestDate').value,
            leaveType: leaveType,
            leaveFrom: document.getElementById('leaveFrom').value,
            leaveTo: document.getElementById('leaveTo').value,
            reason: document.getElementById('leaveReason').value,
            currentTask: document.getElementById('leaveCurrentTask').value || ''
        };
        
        // Disable submit button to prevent double submission
        const submitBtn = form.querySelector('.submit-btn');
        const originalText = submitBtn.textContent;
        submitBtn.disabled = true;
        submitBtn.textContent = 'Submitting...';
        
        // Send request to backend
        fetch('/submit_leave_request', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(formData)
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert(data.message || 'Leave approval request submitted successfully!');
                closeLeaveApprovalModal();
            } else {
                alert(data.message || 'Failed to submit leave request. Please try again.');
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        })
        .catch(error => {
            console.error('Error submitting leave request:', error);
            alert('An error occurred while submitting your request. Please try again.');
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
        });
    }
    
    // Complaint Modal Functions
    function openComplaintModal() {
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('complaintDate').value = today;
        document.getElementById('complaintModal').style.display = 'block';
    }
    
    function closeComplaintModal() {
        document.getElementById('complaintModal').style.display = 'none';
        const form = document.getElementById('complaintForm');
        if (form) {
            form.reset();
        }
    }
    
    function handleComplaintSubmit() {
        const form = document.getElementById('complaintForm');
        
        if (!form.checkValidity()) {
            form.reportValidity();
            return;
        }
        
        // Collect form data
        const formData = {
            employeeName: document.getElementById('complaintEmployeeName').value,
            employeeTeam: document.getElementById('complaintEmployeeTeam').value,
            date: document.getElementById('complaintDate').value,
            personName: document.getElementById('complaintPersonName').value,
            complainDescription: document.getElementById('complaintDescription').value
        };
        
        // Disable submit button to prevent double submission
        const submitBtn = form.querySelector('.submit-btn');
        const originalText = submitBtn.textContent;
        submitBtn.disabled = true;
        submitBtn.textContent = 'Submitting...';
        
        // Send request to backend
        fetch('/submit_complaint', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(formData)
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert(data.message || 'Complaint submitted successfully!');
                closeComplaintModal();
            } else {
                alert(data.message || 'Failed to submit complaint. Please try again.');
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        })
        .catch(error => {
            console.error('Error submitting complaint:', error);
            alert('An error occurred while submitting your complaint. Please try again.');
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
        });
    }
    </script>
    

    
    <script>
        // Modal functions
        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
            
            // Handle default values for First Audit MetaData modal
            if (modalId === 'firstAuditMetaDataModal') {
                // Ensure default selected values are properly set and sub-sector is populated
                setTimeout(() => {
                    const sectorSelect = document.getElementById('metaSectorOrg');
                    if (sectorSelect) {
                        // The selected attribute ensures the value is set, but we verify it
                        const selectedOption = sectorSelect.options[sectorSelect.selectedIndex];
                        if (selectedOption && selectedOption.value === 'Finance') {
                            // Trigger sub-sector update to populate Finance sub-sectors
                            if (typeof updateSubSectorOptions === 'function') {
                                updateSubSectorOptions();
                            }
                        }
                    }
                    
                    // Initialize date last audit field - ensure NA is selected and date input is hidden
                    const dateLastAuditType = document.getElementById('metaDateLastAuditType');
                    if (dateLastAuditType && typeof toggleLastAuditDateInput === 'function') {
                        toggleLastAuditDateInput('metaDateLastAuditType', 'metaDateLastAudit');
                    }
                }, 50);
            }
            
            // Handle default values for Follow Up Audit MetaData modal
            if (modalId === 'followUpAuditMetaDataModal') {
                // Ensure default selected values are properly set and sub-sector is populated
                setTimeout(() => {
                    const sectorSelect = document.getElementById('followUpMetaSectorOrg');
                    if (sectorSelect) {
                        // The selected attribute ensures the value is set, but we verify it
                        const selectedOption = sectorSelect.options[sectorSelect.selectedIndex];
                        if (selectedOption && selectedOption.value === 'Finance') {
                            // Trigger sub-sector update to populate Finance sub-sectors
                            if (typeof updateFollowUpSubSectorOptions === 'function') {
                                updateFollowUpSubSectorOptions();
                            }
                        }
                    }
                }, 50);
            }
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        // Close modal when clicking outside
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        }
        
        // Toggle other input field based on selection
        function toggleOtherInput(selectId, inputId) {
            const select = document.getElementById(selectId);
            const otherInput = document.getElementById(inputId);
            
            if (!select || !otherInput) {
                console.error('toggleOtherInput: Element not found', { selectId, inputId });
                return;
            }
            
            if (select.value === 'other') {
                otherInput.classList.remove('hidden');
                otherInput.style.display = 'block';
                otherInput.required = true;
            } else {
                otherInput.classList.add('hidden');
                otherInput.style.display = 'none';
                otherInput.required = false;
                otherInput.value = '';
            }
        }
        
        // Toggle last audit date input based on selection
        function toggleLastAuditDateInput(selectId, dateInputId) {
            const select = document.getElementById(selectId);
            const dateInput = document.getElementById(dateInputId);
            const hiddenInput = document.getElementById(dateInputId + 'Value');
            
            if (select.value === 'NA') {
                // Hide date input and set hidden value to NA
                dateInput.style.display = 'none';
                dateInput.required = false;
                dateInput.value = '';
                if (hiddenInput) {
                    hiddenInput.value = 'NA';
                }
            } else if (select.value === 'EnterDate') {
                // Show date input and make it required
                dateInput.style.display = 'block';
                dateInput.required = true;
                if (hiddenInput) {
                    // Clear hidden input, will be set from date input on form submit
                    hiddenInput.value = '';
                }
            } else {
                // Default: hide and clear
                dateInput.style.display = 'none';
                dateInput.required = false;
                dateInput.value = '';
                if (hiddenInput) {
                    hiddenInput.value = '';
                }
            }
        }
        
        // Add team member functionality
        let teamMemberCount = 1;
        const maxTeamMembers = 8;
        
        document.getElementById('addMemberBtn').addEventListener('click', function() {
            if (teamMemberCount < maxTeamMembers) {
                const teamContainer = document.getElementById('auditTeamContainer');
                const newMember = document.createElement('div');
                newMember.className = 'team-member';
                newMember.dataset.index = teamMemberCount;
                
                newMember.innerHTML = `
                    <div class="form-row">
                        <div class="form-group">
                            <input type="text" name="teamName[]" placeholder="Name*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamQualification[]" placeholder="Qualification/Certification*" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Certified (Yes/No)*</label>
                        <div class="radio-group">
                            <label><input type="radio" name="teamCertified[${teamMemberCount}]" value="yes" required> Yes</label>
                            <label><input type="radio" name="teamCertified[${teamMemberCount}]" value="no"> No</label>
                        </div>
                    </div>
                    <button type="button" class="remove-member-btn" onclick="removeTeamMember(this)">Remove</button>
                `;
                
                teamContainer.appendChild(newMember);
                teamMemberCount++;
                
                if (teamMemberCount >= maxTeamMembers) {
                    document.getElementById('addMemberBtn').disabled = true;
                }
            }
        });
        
        // Remove team member
        function removeTeamMember(button) {
            const memberDiv = button.closest('.team-member');
            memberDiv.remove();
            teamMemberCount--;
            document.getElementById('addMemberBtn').disabled = false;
            
            // Reindex remaining members
            const members = document.querySelectorAll('.team-member');
            members.forEach((member, index) => {
                member.dataset.index = index;
                const radioInputs = member.querySelectorAll('input[type="radio"]');
                radioInputs.forEach(input => {
                    input.name = `teamCertified[${index}]`;
                });
            });
        }
        
        // Add email field functionality
        document.getElementById('addEmailBtn').addEventListener('click', function() {
            const emailContainer = document.getElementById('emailContainer');
            const newEmailField = document.createElement('div');
            newEmailField.style.display = 'flex';
            newEmailField.style.marginTop = '10px';
            newEmailField.innerHTML = `
                <input type="email" name="bankEmail[]" placeholder="Additional Email Address" style="flex: 1;">
                <button type="button" onclick="removeEmailField(this)" style="margin-left: 10px; background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px;">Remove</button>
            `;
            emailContainer.appendChild(newEmailField);
        });
        
        // Remove email field
        function removeEmailField(button) {
            button.parentElement.remove();
        }
        
        // Follow Up Audit Modal functionality
        let followUpTeamMemberCount = 1;
        const maxFollowUpTeamMembers = 8;
        
        // Add Follow Up team member functionality
        document.getElementById('addFollowUpMemberBtn').addEventListener('click', function() {
            if (followUpTeamMemberCount < maxFollowUpTeamMembers) {
                const teamContainer = document.getElementById('followUpAuditTeamContainer');
                const newMember = document.createElement('div');
                newMember.className = 'team-member';
                newMember.dataset.index = followUpTeamMemberCount;
                
                newMember.innerHTML = `
                    <div class="form-row">
                        <div class="form-group">
                            <input type="text" name="teamName[]" placeholder="Name*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamDesignation[]" placeholder="Designation*" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <input type="email" name="teamEmail[]" placeholder="Email Address*" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="teamQualification[]" placeholder="Qualification/Certification*" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Certified (Yes/No)*</label>
                        <div class="radio-group">
                            <label><input type="radio" name="teamCertified[${followUpTeamMemberCount}]" value="yes" required> Yes</label>
                            <label><input type="radio" name="teamCertified[${followUpTeamMemberCount}]" value="no"> No</label>
                        </div>
                    </div>
                    <button type="button" class="remove-member-btn" onclick="removeFollowUpTeamMember(this)">Remove Member</button>
                `;
                
                teamContainer.appendChild(newMember);
                followUpTeamMemberCount++;
                
                // Hide add button if max reached
                if (followUpTeamMemberCount >= maxFollowUpTeamMembers) {
                    document.getElementById('addFollowUpMemberBtn').style.display = 'none';
                }
            }
        });
        
        // Remove Follow Up team member
        function removeFollowUpTeamMember(button) {
            button.parentElement.remove();
            followUpTeamMemberCount--;
            
            // Show add button if under max
            if (followUpTeamMemberCount < maxFollowUpTeamMembers) {
                document.getElementById('addFollowUpMemberBtn').style.display = 'block';
            }
            
            // Update indices for remaining members
            const members = document.querySelectorAll('#followUpAuditTeamContainer .team-member');
            members.forEach((member, index) => {
                member.dataset.index = index;
                const radioButtons = member.querySelectorAll('input[type="radio"]');
                radioButtons.forEach(radio => {
                    radio.name = `teamCertified[${index}]`;
                });
            });
        }
        
        // Add Follow Up email field functionality
        document.getElementById('addFollowUpEmailBtn').addEventListener('click', function() {
            const emailContainer = document.getElementById('followUpEmailContainer');
            const newEmailField = document.createElement('div');
            newEmailField.style.display = 'flex';
            newEmailField.style.marginTop = '10px';
            newEmailField.innerHTML = `
                <input type="email" name="bankEmail[]" placeholder="Additional Email Address" style="flex: 1;">
                <button type="button" onclick="removeFollowUpEmailField(this)" style="margin-left: 10px; background: #e74c3c; color: white; border: none; border-radius: 4px; padding: 10px;">Remove</button>
            `;
            emailContainer.appendChild(newEmailField);
        });
        
        // Remove Follow Up email field
        function removeFollowUpEmailField(button) {
            button.parentElement.remove();
        }
        
        // Form validation and submission
        // Form validation and submission
document.getElementById('firstAuditForm').addEventListener('submit', function(e) {
    // Validate dates
    const startDateInput = document.getElementById('startDate');
    const endDateInput = document.getElementById('endDate');
    
    if (!startDateInput.value || !endDateInput.value) {
        e.preventDefault();
        alert('Please select both start and end dates');
        return false;
    }
    
    const startDate = new Date(startDateInput.value);
    const endDate = new Date(endDateInput.value);
    
    if (startDate >= endDate) {
        e.preventDefault();
        alert('Finish date must be after start date');
        return false;
    }
    
    // Handle organization name (combo-input logic)
    const organizationSelect = document.getElementById('organization');
    const otherOrganizationInput = document.getElementById('otherOrganization');
    if (organizationSelect.value === 'other') {
        if (!otherOrganizationInput.value || otherOrganizationInput.value.trim() === '') {
            e.preventDefault();
            alert('Please enter the organization name');
            return false;
        }
    }
    
    // Handle city (combo-input logic)
    const citySelect = document.getElementById('city');
    const otherCityInput = document.getElementById('otherCity');
    if (citySelect.value === 'other') {
        if (!otherCityInput.value || otherCityInput.value.trim() === '') {
            e.preventDefault();
            alert('Please enter the city name');
            return false;
        }
    }
    
    // Validate at least one team member
    const teamMembers = document.querySelectorAll('.team-member');
    if (teamMembers.length === 0) {
        e.preventDefault();
        alert('Please add at least one team member');
        return false;
    }
    
    // Prevent default form submission
    e.preventDefault();
    
    // Disable submit button to prevent multiple submissions
    const submitBtn = this.querySelector('button[type="submit"]');
    if (submitBtn) {
        submitBtn.disabled = true;
        submitBtn.textContent = 'Processing...';
        submitBtn.style.opacity = '0.6';
        submitBtn.style.cursor = 'not-allowed';
        
        // Add spinner to button
        const spinner = document.createElement('span');
        spinner.innerHTML = ' <span style="display: inline-block; width: 16px; height: 16px; border: 2px solid #ffffff; border-radius: 50%; border-top-color: transparent; animation: spin 1s linear infinite;"></span>';
        submitBtn.appendChild(spinner);
    }
    
    // First, check for vulnerabilities
    checkVulnerabilitiesBeforeReport(this);
    
    return false;
});
        // Function to check vulnerabilities before generating report
        // Function to check vulnerabilities before generating report
function checkVulnerabilitiesBeforeReport(form) {
    const formData = new FormData(form);
    
    // Handle organization name (combo-input logic)
    const organizationSelect = document.getElementById('organization');
    if (organizationSelect.value === 'other') {
        const otherOrganizationInput = document.getElementById('otherOrganization');
        if (otherOrganizationInput.value && otherOrganizationInput.value.trim() !== '') {
            formData.set('organization', otherOrganizationInput.value);
        }
    }
    
    // Handle city (combo-input logic)
    const citySelect = document.getElementById('city');
    if (citySelect.value === 'other') {
        const otherCityInput = document.getElementById('otherCity');
        if (otherCityInput.value && otherCityInput.value.trim() !== '') {
            formData.set('city', otherCityInput.value);
        }
    }
    
    // Show loading indicator
    showLoadingIndicator();
    
    fetch('/check_vulnerabilities', {
        method: 'POST',
        body: formData
    })
    .then(response => {
        if (!response.ok) {
            throw new Error('Network response was not ok');
        }
        return response.json();
    })
    .then(data => {
        hideLoadingIndicator();
        
        if (data.error) {
            alert('Error: ' + data.error);
            // Reset button state on error
            const submitBtn = form.querySelector('button[type="submit"]');
            if (submitBtn) {
                resetSubmitButtonState(submitBtn, 'Submit Report');
            }
            return;
        }
        
        // Show confirmation dialog with vulnerability information
        showVulnerabilityConfirmationDialog(data, form);
    })
    .catch(error => {
        hideLoadingIndicator();
        console.error('Error:', error);
        alert('Error checking vulnerabilities. Please try again.');
        // Reset button state on error
        const submitBtn = form.querySelector('button[type="submit"]');
        if (submitBtn) {
            resetSubmitButtonState(submitBtn, 'Submit Report');
        }
    });
}
        // Function to show vulnerability confirmation dialog
        // Global state for vulnerability merge management
let vulnerabilityMergeState = {
    matchedGroups: [],
    unmatchedVulnerabilities: [],
    currentForm: null,
    isFollowUp: false  // Track if this is follow-up audit
};

function showVulnerabilityConfirmationDialog(vulnData, form) {
    // Store form reference and determine if this is follow-up audit
    vulnerabilityMergeState.currentForm = form;
    vulnerabilityMergeState.isFollowUp = (form.id === 'followUpAuditForm');
    
    // Initialize state from server response
    vulnerabilityMergeState.matchedGroups = vulnData.matched_groups || [];
    vulnerabilityMergeState.unmatchedVulnerabilities = vulnData.unmatched_vulnerabilities || [];
    
    const dialog = document.createElement('div');
    dialog.className = 'vuln-confirmation-dialog';
    dialog.id = 'mainVulnDialog';
    
    const dialogContent = document.createElement('div');
    dialogContent.className = 'dialog-content';
    dialogContent.style.maxWidth = '1400px';
    dialogContent.style.maxHeight = '90vh';
    dialogContent.style.overflow = 'auto';
    
    const title = document.createElement('h2');
    title.textContent = 'Vulnerability Management - Match & Merge';
    title.style.marginBottom = '20px';
    
    const items = Array.isArray(vulnData.unmatched_vulnerabilities) ? vulnData.unmatched_vulnerabilities : [];
    
    // Build the comprehensive vulnerability management UI
    dialogContent.appendChild(title);
    
    // Add undo button at the top
    const headerActions = document.createElement('div');
    headerActions.style.marginBottom = '20px';
    headerActions.style.display = 'flex';
    headerActions.style.justifyContent = 'space-between';
    headerActions.style.alignItems = 'center';
    
    const undoButton = document.createElement('button');
    undoButton.textContent = '↶ Undo Last Operation';
    undoButton.className = 'undo-btn';
    undoButton.style.padding = '8px 16px';
    undoButton.style.backgroundColor = '#f39c12';
    undoButton.style.color = 'white';
    undoButton.style.border = 'none';
    undoButton.style.borderRadius = '4px';
    undoButton.style.cursor = 'pointer';
    undoButton.onclick = undoLastMergeOperation;
    headerActions.appendChild(undoButton);
    
    const refreshInfo = document.createElement('span');
    refreshInfo.textContent = `Matched: ${vulnerabilityMergeState.matchedGroups.length} | Unmatched: ${vulnerabilityMergeState.unmatchedVulnerabilities.length}`;
    refreshInfo.style.fontSize = '14px';
    refreshInfo.style.color = '#666';
    refreshInfo.id = 'vulnCountInfo';
    headerActions.appendChild(refreshInfo);
    
    dialogContent.appendChild(headerActions);
    
    // Check if all vulnerabilities are matched (no unmatched ones)
    if (items.length === 0 && vulnerabilityMergeState.matchedGroups.length > 0) {
        const noVulnMsg = document.createElement('div');
        noVulnMsg.textContent = '✅ All vulnerabilities have been matched with the catalog!';
        noVulnMsg.className = 'no-vulnerabilities';
        noVulnMsg.style.color = '#27ae60';
        noVulnMsg.style.padding = '20px';
        noVulnMsg.style.backgroundColor = '#d5f4e6';
        noVulnMsg.style.borderRadius = '8px';
        noVulnMsg.style.marginBottom = '20px';
        dialogContent.appendChild(noVulnMsg);
        
        // Show matched groups summary
        renderMatchedVulnerabilitiesSection(dialogContent);
        
        const buttonContainer = document.createElement('div');
        buttonContainer.className = 'button-container';
        buttonContainer.style.marginTop = '20px';
        
        const proceedButton = document.createElement('button');
        proceedButton.textContent = 'Generate Report';
        proceedButton.className = 'proceed-btn';
        proceedButton.onclick = function() {
            if (vulnerabilityMergeState.unmatchedVulnerabilities && vulnerabilityMergeState.unmatchedVulnerabilities.length > 0) {
                alert('Please resolve all items under \u26a0 Unmatched Vulnerabilities before generating the report.');
                return;
            }
            proceedButton.disabled = true;
            proceedButton.textContent = 'Processing...';
            dialog.remove();
            if (form.id === 'followUpAuditForm') {
                generateFollowUpReport(form);
            } else {
                generateReport(form);
            }
        };
        
        const cancelButton = document.createElement('button');
        cancelButton.textContent = 'Cancel';
        cancelButton.className = 'cancel-btn';
        cancelButton.onclick = function() {
            dialog.remove();
        };
        
        buttonContainer.appendChild(proceedButton);
        buttonContainer.appendChild(cancelButton);
        dialogContent.appendChild(buttonContainer);
    } else if (items.length === 0 && vulnerabilityMergeState.matchedGroups.length === 0) {
        // No vulnerabilities at all
        const noVulnMsg = document.createElement('div');
        noVulnMsg.textContent = 'No vulnerabilities found.';
        noVulnMsg.className = 'no-vulnerabilities';
        dialogContent.appendChild(noVulnMsg);
        
        const buttonContainer = document.createElement('div');
        buttonContainer.className = 'button-container';
        
        const proceedButton = document.createElement('button');
        proceedButton.textContent = 'Generate Report';
        proceedButton.className = 'proceed-btn';
        proceedButton.onclick = function() {
            if (vulnerabilityMergeState.unmatchedVulnerabilities && vulnerabilityMergeState.unmatchedVulnerabilities.length > 0) {
                alert('Please resolve all items under \u26a0 Unmatched Vulnerabilities before generating the report.');
                return;
            }
            proceedButton.disabled = true;
            proceedButton.textContent = 'Processing...';
            dialog.remove();
            if (form.id === 'followUpAuditForm') {
                generateFollowUpReport(form);
            } else {
                generateReport(form);
            }
        };
        
        const cancelButton = document.createElement('button');
        cancelButton.textContent = 'Cancel';
        cancelButton.className = 'cancel-btn';
        cancelButton.onclick = function() {
            dialog.remove();
        };
        
        // Disable proceed if there are unmatched vulnerabilities; enable otherwise
        if (vulnerabilityMergeState.unmatchedVulnerabilities && vulnerabilityMergeState.unmatchedVulnerabilities.length > 0) {
            proceedButton.disabled = true;
            proceedButton.style.opacity = '0.5';
            proceedButton.style.cursor = 'not-allowed';
        }
        buttonContainer.appendChild(proceedButton);
        buttonContainer.appendChild(cancelButton);
        dialogContent.appendChild(buttonContainer);
    } else {
        // Create main container with matched and unmatched sections
        const mainContainer = document.createElement('div');
        mainContainer.className = 'vulnerability-management-container';
        mainContainer.id = 'vulnManagementContainer';
        
        // Section 1: Matched Vulnerabilities
        if (vulnerabilityMergeState.matchedGroups.length > 0) {
            renderMatchedVulnerabilitiesSection(mainContainer);
        }
        
        // Section 2: Unmatched Vulnerabilities
        if (vulnerabilityMergeState.unmatchedVulnerabilities.length > 0) {
            renderUnmatchedVulnerabilitiesSection(mainContainer);
        }
        
        dialogContent.appendChild(mainContainer);
        
        // Add action buttons at bottom
        const buttonContainer = document.createElement('div');
        buttonContainer.className = 'button-container';
        buttonContainer.style.marginTop = '30px';
        buttonContainer.style.padding = '20px';
        buttonContainer.style.borderTop = '2px solid #e0e0e0';
        
        const proceedButton = document.createElement('button');
        proceedButton.textContent = 'Generate Report';
        proceedButton.className = 'proceed-btn';
        // Disable until condition: no unmatched and at least one matched group
        if (!(vulnerabilityMergeState.unmatchedVulnerabilities.length === 0 && vulnerabilityMergeState.matchedGroups.length > 0)) {
            proceedButton.disabled = true;
            proceedButton.style.opacity = '0.5';
            proceedButton.style.cursor = 'not-allowed';
        }
        proceedButton.onclick = function() {
            proceedButton.disabled = true;
            proceedButton.textContent = 'Processing...';
            dialog.remove();
            if (form.id === 'followUpAuditForm') {
                generateFollowUpReport(form);
            } else {
                generateReport(form);
            }
        };
        
        const cancelButton = document.createElement('button');
        cancelButton.textContent = 'Cancel';
        cancelButton.className = 'cancel-btn';
        cancelButton.onclick = function() {
            dialog.remove();
        };
        
        buttonContainer.appendChild(proceedButton);
        buttonContainer.appendChild(cancelButton);
        dialogContent.appendChild(buttonContainer);
    }
    
    dialog.appendChild(dialogContent);
    document.body.appendChild(dialog);
    
    dialog.addEventListener('click', function(e) {
        if (e.target === dialog) {
            // Don't close on backdrop click to prevent accidental closure
        }
    });
}

// Function to render matched vulnerabilities section
function renderMatchedVulnerabilitiesSection(container) {
    const matchedSection = document.createElement('div');
    matchedSection.className = 'matched-vulnerabilities-section';
    matchedSection.style.marginBottom = '30px';
    matchedSection.id = 'matchedVulnSection';
    
    const matchedTitle = document.createElement('h3');
    matchedTitle.textContent = '✓ Matched Vulnerabilities';
    matchedTitle.style.color = '#27ae60';
    matchedTitle.style.borderBottom = '2px solid #27ae60';
    matchedTitle.style.paddingBottom = '10px';
    matchedTitle.style.marginBottom = '15px';
    matchedSection.appendChild(matchedTitle);
    
    const matchedList = document.createElement('div');
    matchedList.className = 'matched-list';
    matchedList.id = 'matchedVulnList';
    
    vulnerabilityMergeState.matchedGroups.forEach((group, groupIndex) => {
        const groupDiv = document.createElement('div');
        groupDiv.className = 'matched-group';
        groupDiv.style.marginBottom = '15px';
        groupDiv.style.padding = '15px';
        groupDiv.style.backgroundColor = '#f8f9fa';
        groupDiv.style.borderRadius = '8px';
        groupDiv.style.border = '1px solid #dee2e6';
        
        const groupHeader = document.createElement('div');
        groupHeader.style.display = 'flex';
        groupHeader.style.justifyContent = 'space-between';
        groupHeader.style.alignItems = 'center';
        groupHeader.style.marginBottom = '10px';
        
        const groupInfo = document.createElement('div');
        groupInfo.style.flex = '1';
        
        const groupName = document.createElement('strong');
        groupName.textContent = group.group_name;
        groupName.style.fontSize = '16px';
        groupName.style.color = '#2c3e50';
        groupInfo.appendChild(groupName);
        
        const riskBadge = document.createElement('span');
        riskBadge.textContent = group.risk_factor;
        riskBadge.style.marginLeft = '10px';
        riskBadge.style.padding = '4px 8px';
        riskBadge.style.borderRadius = '4px';
        riskBadge.style.fontSize = '12px';
        riskBadge.style.fontWeight = 'bold';
        
        const riskLower = (group.risk_factor || '').trim().toLowerCase();
        if (riskLower === 'critical') {
            riskBadge.style.backgroundColor = '#8b0000';
            riskBadge.style.color = 'white';
        } else if (riskLower === 'high') {
            riskBadge.style.backgroundColor = '#dc3545';
            riskBadge.style.color = 'white';
        } else if (riskLower === 'medium') {
            riskBadge.style.backgroundColor = '#ffc107';
            riskBadge.style.color = 'white';
        } else if (riskLower === 'low') {
            riskBadge.style.backgroundColor = '#28a745';
            riskBadge.style.color = 'white';
        }
        groupInfo.appendChild(riskBadge);
        
        const mergeButton = document.createElement('button');
        mergeButton.textContent = '🔗 Merge';
        mergeButton.style.padding = '6px 12px';
        mergeButton.style.backgroundColor = '#3498db';
        mergeButton.style.color = 'white';
        mergeButton.style.border = 'none';
        mergeButton.style.borderRadius = '4px';
        mergeButton.style.cursor = 'pointer';
        mergeButton.style.fontSize = '13px';
        mergeButton.onclick = function() {
            showMergeMatchedGroupsDialog(group.catalog_id);
        };
        
        groupHeader.appendChild(groupInfo);
        groupHeader.appendChild(mergeButton);
        groupDiv.appendChild(groupHeader);
        
        const vulnList = document.createElement('ul');
        vulnList.style.marginTop = '10px';
        vulnList.style.marginLeft = '20px';
        vulnList.style.fontSize = '14px';
        vulnList.style.color = '#555';
        
        group.matched_vulnerabilities.forEach(vuln => {
            const vulnItem = document.createElement('li');
            vulnItem.textContent = vuln;
            vulnItem.style.marginBottom = '5px';
            vulnList.appendChild(vulnItem);
        });
        
        groupDiv.appendChild(vulnList);
        matchedList.appendChild(groupDiv);
    });
    
    matchedSection.appendChild(matchedList);
    container.appendChild(matchedSection);
}

// Function to render unmatched vulnerabilities section
function renderUnmatchedVulnerabilitiesSection(container) {
    const unmatchedSection = document.createElement('div');
    unmatchedSection.className = 'unmatched-vulnerabilities-section';
    unmatchedSection.id = 'unmatchedVulnSection';
    
    const unmatchedTitle = document.createElement('h3');
    unmatchedTitle.textContent = '⚠ Unmatched Vulnerabilities';
    unmatchedTitle.style.color = '#e74c3c';
    unmatchedTitle.style.borderBottom = '2px solid #e74c3c';
    unmatchedTitle.style.paddingBottom = '10px';
    unmatchedTitle.style.marginBottom = '15px';
    unmatchedSection.appendChild(unmatchedTitle);
    
    const unmatchedList = document.createElement('div');
    unmatchedList.className = 'unmatched-list';
    unmatchedList.id = 'unmatchedVulnList';
    
    vulnerabilityMergeState.unmatchedVulnerabilities.forEach((vuln, vulnIndex) => {
        const vulnDiv = document.createElement('div');
        vulnDiv.className = 'unmatched-vuln-item';
        vulnDiv.style.marginBottom = '15px';
        vulnDiv.style.padding = '15px';
        vulnDiv.style.backgroundColor = '#fff3cd';
        vulnDiv.style.borderRadius = '8px';
        vulnDiv.style.border = '1px solid #ffc107';
        vulnDiv.style.display = 'flex';
        vulnDiv.style.justifyContent = 'space-between';
        vulnDiv.style.alignItems = 'center';
        
        const vulnName = document.createElement('span');
        vulnName.textContent = vuln;
        vulnName.style.flex = '1';
        vulnName.style.fontSize = '14px';
        vulnName.style.fontWeight = '500';
        
        const actionsDiv = document.createElement('div');
        actionsDiv.style.display = 'flex';
        actionsDiv.style.gap = '8px';
        
        // Button 1: Merge with Matched
        const mergeMatchedBtn = document.createElement('button');
        mergeMatchedBtn.textContent = 'Merge with Matched';
        mergeMatchedBtn.style.padding = '6px 12px';
        mergeMatchedBtn.style.backgroundColor = '#3498db';
        mergeMatchedBtn.style.color = 'white';
        mergeMatchedBtn.style.border = 'none';
        mergeMatchedBtn.style.borderRadius = '4px';
        mergeMatchedBtn.style.cursor = 'pointer';
        mergeMatchedBtn.style.fontSize = '12px';
        mergeMatchedBtn.onclick = function() {
            showMergeWithMatchedDialog(vuln);
        };
        
        // Button 2: Merge with Unmatched
        const mergeUnmatchedBtn = document.createElement('button');
        mergeUnmatchedBtn.textContent = 'Merge with Unmatched';
        mergeUnmatchedBtn.style.padding = '6px 12px';
        mergeUnmatchedBtn.style.backgroundColor = '#9b59b6';
        mergeUnmatchedBtn.style.color = 'white';
        mergeUnmatchedBtn.style.border = 'none';
        mergeUnmatchedBtn.style.borderRadius = '4px';
        mergeUnmatchedBtn.style.cursor = 'pointer';
        mergeUnmatchedBtn.style.fontSize = '12px';
        mergeUnmatchedBtn.onclick = function() {
            showMergeWithUnmatchedDialog(vuln);
        };
        
        // Button 3: Add Details
        const addDetailsBtn = document.createElement('button');
        addDetailsBtn.textContent = 'Add Details';
        addDetailsBtn.style.padding = '6px 12px';
        addDetailsBtn.style.backgroundColor = '#27ae60';
        addDetailsBtn.style.color = 'white';
        addDetailsBtn.style.border = 'none';
        addDetailsBtn.style.borderRadius = '4px';
        addDetailsBtn.style.cursor = 'pointer';
        addDetailsBtn.style.fontSize = '12px';
        addDetailsBtn.onclick = function() {
            showAddDetailsDialog(vuln);
        };
        
        actionsDiv.appendChild(mergeMatchedBtn);
        actionsDiv.appendChild(mergeUnmatchedBtn);
        actionsDiv.appendChild(addDetailsBtn);
        
        vulnDiv.appendChild(vulnName);
        vulnDiv.appendChild(actionsDiv);
        unmatchedList.appendChild(vulnDiv);
    });
    
    unmatchedSection.appendChild(unmatchedList);
    container.appendChild(unmatchedSection);
}

// Helper function to refresh the vulnerability management UI
function refreshVulnerabilityUI() {
    const container = document.getElementById('vulnManagementContainer');
    if (!container) return;
    
    // Clear and rebuild
    container.innerHTML = '';
    
    if (vulnerabilityMergeState.matchedGroups.length > 0) {
        renderMatchedVulnerabilitiesSection(container);
    }
    
    if (vulnerabilityMergeState.unmatchedVulnerabilities.length > 0) {
        renderUnmatchedVulnerabilitiesSection(container);
    }
    
    // Update counter
    const countInfo = document.getElementById('vulnCountInfo');
    if (countInfo) {
        countInfo.textContent = `Matched: ${vulnerabilityMergeState.matchedGroups.length} | Unmatched: ${vulnerabilityMergeState.unmatchedVulnerabilities.length}`;
    }
    
    // If all vulnerabilities are now matched, show success and generate button
    if (vulnerabilityMergeState.unmatchedVulnerabilities.length === 0 && vulnerabilityMergeState.matchedGroups.length > 0) {
        const successMsg = document.createElement('div');
        successMsg.textContent = '✅ All vulnerabilities matched! Ready to generate report.';
        successMsg.style.color = '#27ae60';
        successMsg.style.padding = '15px';
        successMsg.style.backgroundColor = '#d5f4e6';
        successMsg.style.borderRadius = '8px';
        successMsg.style.marginTop = '20px';
        successMsg.style.textAlign = 'center';
        successMsg.style.fontWeight = 'bold';
        container.appendChild(successMsg);
    }

    // Keep the proceed button state in sync with unmatched vulnerabilities
    const proceedBtn = document.querySelector('.proceed-btn');
    if (proceedBtn) {
        if (vulnerabilityMergeState.unmatchedVulnerabilities && vulnerabilityMergeState.unmatchedVulnerabilities.length > 0) {
            proceedBtn.disabled = true;
            proceedBtn.style.opacity = '0.5';
            proceedBtn.style.cursor = 'not-allowed';
        } else {
            proceedBtn.disabled = false;
            proceedBtn.style.opacity = '1';
            proceedBtn.style.cursor = 'pointer';
        }
    }
}

// Helper function to get correct endpoint based on audit type
function getEndpoint(baseName) {
    if (vulnerabilityMergeState.isFollowUp) {
        return '/followup_' + baseName;
    }
    return '/' + baseName;
}

// Dialog 1: Merge with Matched - Select target matched group
function showMergeWithMatchedDialog(unmatchedVuln) {
    const dialog = document.createElement('div');
    dialog.className = 'vuln-confirmation-dialog';
    dialog.style.zIndex = '10001';
    
    const dialogContent = document.createElement('div');
    dialogContent.className = 'dialog-content';
    dialogContent.style.maxWidth = '600px';
    
    const title = document.createElement('h3');
    title.textContent = 'Merge with Matched Group';
    title.style.marginBottom = '15px';
    dialogContent.appendChild(title);
    
    const instruction = document.createElement('p');
    instruction.textContent = `Select a matched group to merge "${unmatchedVuln}" into:`;
    instruction.style.marginBottom = '20px';
    instruction.style.fontSize = '14px';
    dialogContent.appendChild(instruction);
    
    const form = document.createElement('div');
    
    vulnerabilityMergeState.matchedGroups.forEach((group, idx) => {
        const radioDiv = document.createElement('div');
        radioDiv.style.marginBottom = '12px';
        radioDiv.style.padding = '10px';
        radioDiv.style.backgroundColor = '#f8f9fa';
        radioDiv.style.borderRadius = '4px';
        
        const radio = document.createElement('input');
        radio.type = 'radio';
        radio.name = 'target_matched_group';
        radio.value = group.catalog_id;
        radio.id = `matched_group_${idx}`;
        
        const label = document.createElement('label');
        label.setAttribute('for', `matched_group_${idx}`);
        label.style.marginLeft = '8px';
        label.style.cursor = 'pointer';
        label.textContent = group.group_name;
        
        radioDiv.appendChild(radio);
        radioDiv.appendChild(label);
        form.appendChild(radioDiv);
    });
    
    dialogContent.appendChild(form);
    
    const buttonContainer = document.createElement('div');
    buttonContainer.className = 'button-container';
    buttonContainer.style.marginTop = '20px';
    
    const confirmBtn = document.createElement('button');
    confirmBtn.textContent = 'Confirm Merge';
    confirmBtn.className = 'proceed-btn';
    confirmBtn.onclick = function() {
        const selectedRadio = document.querySelector('input[name="target_matched_group"]:checked');
        if (!selectedRadio) {
            alert('Please select a group to merge with');
            return;
        }
        
        confirmBtn.disabled = true;
        confirmBtn.textContent = 'Merging...';
        
        fetch(getEndpoint('merge_with_matched'), {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
                unmatched_vulnerability: unmatchedVuln,
                target_group_id: parseInt(selectedRadio.value)
            })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                vulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups;
                vulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities;
                refreshVulnerabilityUI();
                dialog.remove();
                alert('Vulnerability merged successfully!');
            } else {
                alert('Error: ' + data.error);
                confirmBtn.disabled = false;
                confirmBtn.textContent = 'Confirm Merge';
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Error merging vulnerability');
            confirmBtn.disabled = false;
            confirmBtn.textContent = 'Confirm Merge';
        });
    };
    
    const cancelBtn = document.createElement('button');
    cancelBtn.textContent = 'Cancel';
    cancelBtn.className = 'cancel-btn';
    cancelBtn.onclick = function() {
        dialog.remove();
    };
    
    buttonContainer.appendChild(confirmBtn);
    buttonContainer.appendChild(cancelBtn);
    dialogContent.appendChild(buttonContainer);
    
    dialog.appendChild(dialogContent);
    document.body.appendChild(dialog);
}

// Dialog 2: Merge with Unmatched - Select other unmatched + provide details
function showMergeWithUnmatchedDialog(primaryVuln) {
    const dialog = document.createElement('div');
    dialog.className = 'vuln-confirmation-dialog';
    dialog.style.zIndex = '10001';
    
    const dialogContent = document.createElement('div');
    dialogContent.className = 'dialog-content';
    dialogContent.style.maxWidth = '800px';
    dialogContent.style.maxHeight = '80vh';
    dialogContent.style.overflow = 'auto';
    
    const title = document.createElement('h3');
    title.textContent = 'Merge with Other Unmatched Vulnerabilities';
    title.style.marginBottom = '15px';
    dialogContent.appendChild(title);
    
    const instruction = document.createElement('p');
    instruction.innerHTML = `<strong>Primary:</strong> ${primaryVuln}<br><br>Select other unmatched vulnerabilities to merge with:`;
    instruction.style.marginBottom = '20px';
    instruction.style.fontSize = '14px';
    dialogContent.appendChild(instruction);
    
    const checkboxContainer = document.createElement('div');
    checkboxContainer.style.marginBottom = '20px';
    checkboxContainer.style.maxHeight = '200px';
    checkboxContainer.style.overflow = 'auto';
    checkboxContainer.style.border = '1px solid #ddd';
    checkboxContainer.style.padding = '10px';
    checkboxContainer.style.borderRadius = '4px';
    
    vulnerabilityMergeState.unmatchedVulnerabilities.forEach((vuln, idx) => {
        if (vuln === primaryVuln) return; // Skip the primary vulnerability
        
        const checkDiv = document.createElement('div');
        checkDiv.style.marginBottom = '8px';
        
        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.value = vuln;
        checkbox.id = `unmatched_vuln_${idx}`;
        checkbox.className = 'merge-unmatched-checkbox';
        
        const label = document.createElement('label');
        label.setAttribute('for', `unmatched_vuln_${idx}`);
        label.style.marginLeft = '8px';
        label.style.cursor = 'pointer';
        label.textContent = vuln;
        
        checkDiv.appendChild(checkbox);
        checkDiv.appendChild(label);
        checkboxContainer.appendChild(checkDiv);
    });
    
    dialogContent.appendChild(checkboxContainer);
    
    const nextBtn = document.createElement('button');
    nextBtn.textContent = 'Next: Provide Group Details';
    nextBtn.className = 'proceed-btn';
    nextBtn.style.width = '100%';
    nextBtn.style.marginBottom = '10px';
    nextBtn.onclick = function() {
        const checkboxes = document.querySelectorAll('.merge-unmatched-checkbox:checked');
        const selectedVulns = [primaryVuln, ...Array.from(checkboxes).map(cb => cb.value)];
        
        if (selectedVulns.length < 1) {
            alert('No vulnerabilities selected');
            return;
        }
        
        dialog.remove();
        showVulnerabilityDetailsForm(selectedVulns, 'merge_with_unmatched');
    };
    
    const cancelBtn = document.createElement('button');
    cancelBtn.textContent = 'Cancel';
    cancelBtn.className = 'cancel-btn';
    cancelBtn.style.width = '100%';
    cancelBtn.onclick = function() {
        dialog.remove();
    };
    
    dialogContent.appendChild(nextBtn);
    dialogContent.appendChild(cancelBtn);
    
    dialog.appendChild(dialogContent);
    document.body.appendChild(dialog);
}

// Dialog 3: Add Details - Form for single vulnerability
function showAddDetailsDialog(vuln) {
    showVulnerabilityDetailsForm([vuln], 'add_details');
}

// Dialog 4: Merge Matched Groups - Select target for merging
function showMergeMatchedGroupsDialog(sourceGroupId) {
    const dialog = document.createElement('div');
    dialog.className = 'vuln-confirmation-dialog';
    dialog.style.zIndex = '10001';
    
    const dialogContent = document.createElement('div');
    dialogContent.className = 'dialog-content';
    dialogContent.style.maxWidth = '600px';
    
    const sourceGroup = vulnerabilityMergeState.matchedGroups.find(g => g.catalog_id === sourceGroupId);
    if (!sourceGroup) {
        alert('Source group not found');
        return;
    }
    
    const title = document.createElement('h3');
    title.textContent = 'Merge Matched Groups';
    title.style.marginBottom = '15px';
    dialogContent.appendChild(title);
    
    const instruction = document.createElement('p');
    instruction.innerHTML = `<strong>Merge FROM:</strong> ${sourceGroup.group_name}<br><br>Select target group to merge INTO:`;
    instruction.style.marginBottom = '20px';
    instruction.style.fontSize = '14px';
    dialogContent.appendChild(instruction);
    
    const form = document.createElement('div');
    
    vulnerabilityMergeState.matchedGroups.forEach((group, idx) => {
        if (group.catalog_id === sourceGroupId) return; // Skip source group
        
        const radioDiv = document.createElement('div');
        radioDiv.style.marginBottom = '12px';
        radioDiv.style.padding = '10px';
        radioDiv.style.backgroundColor = '#f8f9fa';
        radioDiv.style.borderRadius = '4px';
        
        const radio = document.createElement('input');
        radio.type = 'radio';
        radio.name = 'target_group';
        radio.value = group.catalog_id;
        radio.id = `target_group_${idx}`;
        
        const label = document.createElement('label');
        label.setAttribute('for', `target_group_${idx}`);
        label.style.marginLeft = '8px';
        label.style.cursor = 'pointer';
        label.textContent = group.group_name;
        
        radioDiv.appendChild(radio);
        radioDiv.appendChild(label);
        form.appendChild(radioDiv);
    });
    
    dialogContent.appendChild(form);
    
    const buttonContainer = document.createElement('div');
    buttonContainer.className = 'button-container';
    buttonContainer.style.marginTop = '20px';
    
    const confirmBtn = document.createElement('button');
    confirmBtn.textContent = 'Confirm Merge';
    confirmBtn.className = 'proceed-btn';
    confirmBtn.onclick = function() {
        const selectedRadio = document.querySelector('input[name="target_group"]:checked');
        if (!selectedRadio) {
            alert('Please select a target group');
            return;
        }
        
        confirmBtn.disabled = true;
        confirmBtn.textContent = 'Merging...';
        
        fetch(getEndpoint('merge_matched_groups'), {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
                source_group_id: sourceGroupId,
                target_group_id: parseInt(selectedRadio.value)
            })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                vulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups;
                vulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities;
                refreshVulnerabilityUI();
                dialog.remove();
                alert('Groups merged successfully!');
            } else {
                alert('Error: ' + data.error);
                confirmBtn.disabled = false;
                confirmBtn.textContent = 'Confirm Merge';
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Error merging groups');
            confirmBtn.disabled = false;
            confirmBtn.textContent = 'Confirm Merge';
        });
    };
    
    const cancelBtn = document.createElement('button');
    cancelBtn.textContent = 'Cancel';
    cancelBtn.className = 'cancel-btn';
    cancelBtn.onclick = function() {
        dialog.remove();
    };
    
    buttonContainer.appendChild(confirmBtn);
    buttonContainer.appendChild(cancelBtn);
    dialogContent.appendChild(buttonContainer);
    
    dialog.appendChild(dialogContent);
    document.body.appendChild(dialog);
}

// Comprehensive vulnerability details form
function showVulnerabilityDetailsForm(vulnerabilities, actionType) {
    const dialog = document.createElement('div');
    dialog.className = 'vuln-confirmation-dialog';
    dialog.style.zIndex = '10002';
    
    const dialogContent = document.createElement('div');
    dialogContent.className = 'dialog-content';
    dialogContent.style.maxWidth = '900px';
    dialogContent.style.maxHeight = '85vh';
    dialogContent.style.overflow = 'auto';
    
    const title = document.createElement('h3');
    title.textContent = actionType === 'add_details' ? 'Add Vulnerability Details' : 'Provide Group Details for Merged Vulnerabilities';
    title.style.marginBottom = '15px';
    dialogContent.appendChild(title);
    
    if (vulnerabilities.length > 1) {
        const vulnList = document.createElement('div');
        vulnList.style.marginBottom = '20px';
        vulnList.style.padding = '10px';
        vulnList.style.backgroundColor = '#f8f9fa';
        vulnList.style.borderRadius = '4px';
        
        const listTitle = document.createElement('strong');
        listTitle.textContent = 'Vulnerabilities in this group:';
        listTitle.style.display = 'block';
        listTitle.style.marginBottom = '8px';
        vulnList.appendChild(listTitle);
        
        const ul = document.createElement('ul');
        ul.style.marginLeft = '20px';
        vulnerabilities.forEach(v => {
            const li = document.createElement('li');
            li.textContent = v;
            li.style.marginBottom = '4px';
            ul.appendChild(li);
        });
        vulnList.appendChild(ul);
        dialogContent.appendChild(vulnList);
    }
    
    const formContainer = document.createElement('div');
    formContainer.style.marginBottom = '20px';
    
    // Create input fields
    const fields = [
        { name: 'vulnerabilityName', label: 'Vulnerability Group Name', type: 'text', placeholder: 'e.g., Apache Multiple Vulnerabilities', required: true },
        { name: 'riskFactor', label: 'Risk Factor', type: 'select', options: ['', 'LOW', 'MEDIUM', 'HIGH', 'CRITICAL'], required: true },
        { name: 'cveId', label: 'CVE ID', type: 'text', placeholder: 'e.g., CVE-2023-1234 or Multiple', required: true },
        { name: 'cvssScore', label: 'CVSS Score', type: 'text', placeholder: 'e.g., 7.5', required: true },
        { name: 'auditObservation', label: 'Audit Observation', type: 'textarea', required: true },
        { name: 'impact', label: 'Impact', type: 'textarea', required: true },
        { name: 'recommendation', label: 'Recommendation', type: 'textarea', required: true },
        { name: 'referenceLink', label: 'Reference Link', type: 'textarea', placeholder: 'https://...', required: true }
    ];
    
    fields.forEach(field => {
        const fieldDiv = document.createElement('div');
        fieldDiv.style.marginBottom = '15px';
        
        const label = document.createElement('label');
        label.textContent = field.label + (field.required ? ' *' : '');
        label.style.display = 'block';
        label.style.marginBottom = '5px';
        label.style.fontWeight = '500';
        label.style.fontSize = '14px';
        fieldDiv.appendChild(label);
        
        let input;
        if (field.type === 'select') {
            input = document.createElement('select');
            input.id = field.name;
            input.name = field.name;
            input.style.width = '100%';
            input.style.padding = '8px';
            input.style.borderRadius = '4px';
            input.style.border = '1px solid #ced4da';
            if (field.required) input.required = true;
            
            field.options.forEach(option => {
                const optionElement = document.createElement('option');
                optionElement.value = option;
                optionElement.textContent = option || 'Select Risk Factor';
                input.appendChild(optionElement);
            });
        } else if (field.type === 'textarea') {
            input = document.createElement('textarea');
            input.id = field.name;
            input.name = field.name;
            input.rows = 4;
            input.style.width = '100%';
            input.style.padding = '8px';
            input.style.borderRadius = '4px';
            input.style.border = '1px solid #ced4da';
            input.style.resize = 'vertical';
            if (field.placeholder) input.placeholder = field.placeholder;
            if (field.required) input.required = true;
        } else {
            input = document.createElement('input');
            input.type = field.type;
            input.id = field.name;
            input.name = field.name;
            input.style.width = '100%';
            input.style.padding = '8px';
            input.style.borderRadius = '4px';
            input.style.border = '1px solid #ced4da';
            if (field.placeholder) input.placeholder = field.placeholder;
            if (field.required) input.required = true;
        }
        
        fieldDiv.appendChild(input);
        formContainer.appendChild(fieldDiv);
    });
    
    // Add Risk Factor and CVSS Score validation
    setupRiskFactorCVSSValidation('riskFactor', 'cvssScore');
    
    dialogContent.appendChild(formContainer);
    
    const buttonContainer = document.createElement('div');
    buttonContainer.className = 'button-container';
    buttonContainer.style.marginTop = '20px';
    
    const submitBtn = document.createElement('button');
    submitBtn.textContent = 'Submit & Update Catalog';
    submitBtn.className = 'proceed-btn';
    submitBtn.onclick = function() {
        // Validate all required fields
        const vulnName = document.getElementById('vulnerabilityName').value.trim();
        const riskFactor = document.getElementById('riskFactor').value;
        const observation = document.getElementById('auditObservation').value.trim();
        const impact = document.getElementById('impact').value.trim();
        const recommendation = document.getElementById('recommendation').value.trim();
        
        // Validate all required fields (all fields are now required)
        const cveId = document.getElementById('cveId').value.trim();
        const cvssScore = document.getElementById('cvssScore').value.trim();
        const referenceLink = document.getElementById('referenceLink').value.trim();
        
        if (!vulnName || !riskFactor || !cveId || !cvssScore || !observation || 
            !impact || !recommendation || !referenceLink) {
            alert('Please fill in all required fields');
            return;
        }
        
        // Validate CVSS Score against Risk Factor
        if (!validateRiskFactorCVSS('riskFactor', 'cvssScore')) {
            return;
        }
        
        submitBtn.disabled = true;
        submitBtn.textContent = 'Submitting...';
        
        const details = {
            vulnerabilityName: vulnName,
            riskFactor: riskFactor,
            cveId: document.getElementById('cveId').value.trim(),
            cvssScore: document.getElementById('cvssScore').value.trim(),
            auditObservation: observation,
            impact: impact,
            recommendation: recommendation,
            referenceLink: document.getElementById('referenceLink').value.trim()
        };
        
        const endpointBase = actionType === 'add_details' ? 'add_vulnerability_details' : 'merge_with_unmatched';
        const endpoint = getEndpoint(endpointBase);
        const payload = actionType === 'add_details' 
            ? { vulnerability_name: vulnerabilities[0], vulnerability_details: details }
            : { vulnerabilities: vulnerabilities, vulnerability_details: details };
        
        fetch(endpoint, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(payload)
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                vulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups;
                vulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities;
                refreshVulnerabilityUI();
                dialog.remove();
                alert(actionType === 'add_details' ? 'Details added successfully!' : 'Vulnerabilities merged successfully!');
            } else {
                alert('Error: ' + (data.error || 'Unknown error'));
                submitBtn.disabled = false;
                submitBtn.textContent = 'Submit & Update Catalog';
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Error submitting details');
            submitBtn.disabled = false;
            submitBtn.textContent = 'Submit & Update Catalog';
        });
    };
    
    const cancelBtn = document.createElement('button');
    cancelBtn.textContent = 'Cancel';
    cancelBtn.className = 'cancel-btn';
    cancelBtn.onclick = function() {
        dialog.remove();
    };
    
    buttonContainer.appendChild(submitBtn);
    buttonContainer.appendChild(cancelBtn);
    dialogContent.appendChild(buttonContainer);
    
    dialog.appendChild(dialogContent);
    document.body.appendChild(dialog);
}


// Undo last merge operation
function undoLastMergeOperation() {
    if (!confirm('Are you sure you want to undo the last operation?')) {
        return;
    }
    
    fetch(getEndpoint('undo_last_merge'), {
        method: 'POST',
        headers: {'Content-Type': 'application/json'}
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            vulnerabilityMergeState.matchedGroups = data.updated_state.matched_groups;
            vulnerabilityMergeState.unmatchedVulnerabilities = data.updated_state.unmatched_vulnerabilities;
            refreshVulnerabilityUI();
            alert('Operation undone successfully!');
        } else {
            alert('Error: ' + (data.error || 'No operations to undo'));
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('Error undoing operation');
    });
}

// OLD DEPRECATED FUNCTIONS - REMOVED
// mergeSelectedVulnerabilities and createMergedVulnerabilitySection have been replaced
// with new merge management system

function OLD_createMergedVulnerabilitySection_REMOVED(groupId, vulnerabilities, indices) {
    const formContainer = document.querySelector('.vulnerability-details-form');
    
    const mergedSection = document.createElement('div');
    mergedSection.className = 'vulnerability-section merged-section';
    mergedSection.id = `merged-section-${groupId}`;
    
    // Create heading with merged vulnerability names (non-editable)
    const mergedTitle = document.createElement('h3');
    mergedTitle.textContent = `Merged Group: ${vulnerabilities.join(', ')}`;
    mergedTitle.className = 'merged-vulnerability-title';
    mergedTitle.style.color = '#3553E8';
    mergedTitle.style.fontWeight = 'bold';
    mergedSection.appendChild(mergedTitle);
    
    // Create input fields for the merged group
    const fields = [
        { name: 'vulnerabilityName', label: 'Vulnerability Name', type: 'text', value: vulnerabilities[0], required: true },
        { name: 'riskFactor', label: 'Risk Factor', type: 'select', options: ['', 'LOW', 'MEDIUM', 'HIGH', 'CRITICAL'], required: true },
        { name: 'cveId', label: 'CVE ID', type: 'text', placeholder: 'e.g., CVE-2023-1234', required: true },
        { name: 'cvssScore', label: 'CVSS Score', type: 'text', placeholder: 'e.g., 7.5', required: true },
        { name: 'auditObservation', label: 'Audit Observation', type: 'textarea', required: true },
        { name: 'impact', label: 'Impact', type: 'textarea', required: true },
        { name: 'recommendation', label: 'Recommendation / Countermeasure', type: 'textarea', required: true },
        { name: 'referenceLink', label: 'Reference Link', type: 'textarea', placeholder: 'https://...', required: true }
    ];
    
    fields.forEach(field => {
        const fieldContainer = document.createElement('div');
        fieldContainer.className = 'form-field';
        
        const label = document.createElement('label');
        label.textContent = field.label + (field.required ? ' *' : '');
        label.setAttribute('for', `${field.name}_${groupId}`);
        fieldContainer.appendChild(label);
        
        let input;
        if (field.type === 'select') {
            input = document.createElement('select');
            input.id = `${field.name}_${groupId}`;
            input.name = `${field.name}_${groupId}`;
            if (field.required) input.required = true;
            
            field.options.forEach(option => {
                const optionElement = document.createElement('option');
                optionElement.value = option;
                optionElement.textContent = option || 'Select Risk Factor';
                input.appendChild(optionElement);
            });
        } else if (field.type === 'textarea') {
            input = document.createElement('textarea');
            input.id = `${field.name}_${groupId}`;
            input.name = `${field.name}_${groupId}`;
            input.rows = 3;
            input.placeholder = `Enter ${field.label.toLowerCase()}...`;
            if (field.required) input.required = true;
        } else {
            input = document.createElement('input');
            input.type = field.type;
            input.id = `${field.name}_${groupId}`;
            input.name = `${field.name}_${groupId}`;
            if (field.placeholder) input.placeholder = field.placeholder;
            if (field.required) input.required = true;
        }
        
        if (field.value) input.value = field.value;
        
        fieldContainer.appendChild(input);
        mergedSection.appendChild(fieldContainer);
    });
    
    // Add Risk Factor and CVSS Score validation for merged group fields
    setupRiskFactorCVSSValidation(`riskFactor_${groupId}`, `cvssScore_${groupId}`);
    
    // Add unmerge button
    const unmergeButton = document.createElement('button');
    unmergeButton.type = 'button';
    unmergeButton.textContent = 'Unmerge This Group';
    unmergeButton.className = 'unmerge-group-btn';
    unmergeButton.onclick = function() {
        unmergeVulnerabilityGroup(groupId);
    };
    mergedSection.appendChild(unmergeButton);
    
    formContainer.appendChild(mergedSection);
}

// Function to unmerge a specific vulnerability group
function unmergeVulnerabilityGroup_DEPRECATED(groupId) {
    const mergedGroup = mergedVulnerabilities[groupId];
    if (!mergedGroup) return;
    
    // Show individual vulnerability sections
    mergedGroup.indices.forEach(idx => {
        const section = document.getElementById(`vuln-section-${idx}`);
        if (section) {
            section.style.display = 'block';
        }
    });
    
    // Remove merged section
    const mergedSection = document.getElementById(`merged-section-${groupId}`);
    if (mergedSection) {
        mergedSection.remove();
    }
    
    // Remove from merged vulnerabilities
    delete mergedVulnerabilities[groupId];
}

// Function to unmerge all vulnerabilities
function unmergeAllVulnerabilities_DEPRECATED() {
    Object.keys(mergedVulnerabilities).forEach(groupId => {
        unmergeVulnerabilityGroup(groupId);
    });
}

// Helper function to reset button state
function resetButtonState(button) {
    if (button) {
        button.disabled = false;
        button.textContent = 'Save Details & Generate Report';
        button.style.opacity = '1';
        button.style.cursor = 'pointer';
        // Remove spinner
        const spinner = button.querySelector('span');
        if (spinner) {
            spinner.remove();
        }
    }
}

// Helper function to reset submit button state
function resetSubmitButtonState(button, originalText) {
    if (button) {
        button.disabled = false;
        button.textContent = originalText;
        button.style.opacity = '1';
        button.style.cursor = 'pointer';
        // Remove spinner
        const spinner = button.querySelector('span');
        if (spinner) {
            spinner.remove();
        }
    }
}

// Function to save vulnerability details and generate report
function saveVulnerabilityDetails(vulnerabilities, dialog, form, saveButton = null) {
    const vulnerabilityDetails = {};
    
    // Collect data from individual vulnerability fields
    vulnerabilities.forEach((vuln, index) => {
        const section = document.getElementById(`vuln-section-${index}`);
        if (section && section.style.display !== 'none') {
            const details = {
                vulnerabilityName: document.getElementById(`vulnerabilityName_${index}`).value.trim(),
                riskFactor: document.getElementById(`riskFactor_${index}`).value.trim(),
                cveId: document.getElementById(`cveId_${index}`).value.trim(),
                cvssScore: document.getElementById(`cvssScore_${index}`).value.trim(),
                auditObservation: document.getElementById(`auditObservation_${index}`).value.trim(),
                impact: document.getElementById(`impact_${index}`).value.trim(),
                recommendation: document.getElementById(`recommendation_${index}`).value.trim(),
                referenceLink: document.getElementById(`referenceLink_${index}`).value.trim(),
                isMerged: false
            };
            
            // Validate all required fields (all fields are now required)
            if (!details.vulnerabilityName || !details.riskFactor || !details.cveId || 
                !details.cvssScore || !details.auditObservation || !details.impact || 
                !details.recommendation || !details.referenceLink) {
                alert(`Please fill in all required fields for vulnerability: ${vuln}`);
                resetButtonState(saveButton);
                return;
            }
            
            // Validate CVSS Score against Risk Factor
            if (!validateRiskFactorCVSS(`riskFactor_${index}`, `cvssScore_${index}`)) {
                resetButtonState(saveButton);
                return;
            }
            
            vulnerabilityDetails[vuln] = details;
        }
    });
    
    // Collect data from merged vulnerability groups
    Object.keys(mergedVulnerabilities).forEach(groupId => {
        const mergedGroup = mergedVulnerabilities[groupId];
        const details = {
            vulnerabilityName: document.getElementById(`vulnerabilityName_${groupId}`).value.trim(),
            riskFactor: document.getElementById(`riskFactor_${groupId}`).value.trim(),
            cveId: document.getElementById(`cveId_${groupId}`).value.trim(),
            cvssScore: document.getElementById(`cvssScore_${groupId}`).value.trim(),
            auditObservation: document.getElementById(`auditObservation_${groupId}`).value.trim(),
            impact: document.getElementById(`impact_${groupId}`).value.trim(),
            recommendation: document.getElementById(`recommendation_${groupId}`).value.trim(),
            referenceLink: document.getElementById(`referenceLink_${groupId}`).value.trim(),
            isMerged: true,
            mergedVulnerabilities: mergedGroup.vulnerabilities
        };
        
        // Validate all required fields (all fields are now required)
        if (!details.vulnerabilityName || !details.riskFactor || !details.cveId || 
            !details.cvssScore || !details.auditObservation || !details.impact || 
            !details.recommendation || !details.referenceLink) {
            alert(`Please fill in all required fields for merged vulnerability group.`);
            resetButtonState(saveButton);
            return;
        }
        
        // Validate CVSS Score against Risk Factor
        if (!validateRiskFactorCVSS(`riskFactor_${groupId}`, `cvssScore_${groupId}`)) {
            resetButtonState(saveButton);
            return;
        }
        
        // Use the first vulnerability name as the key for the merged group
        vulnerabilityDetails[mergedGroup.vulnerabilities[0]] = details;
    });
    
    // Send vulnerability details to server
    fetch('/submit_vulnerability_details', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({
            vulnerability_details: vulnerabilityDetails
        })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            dialog.remove();
            // Check if this is the follow-up audit form
            if (form.id === 'followUpAuditForm') {
                generateFollowUpReport(form);
            } else {
                generateReport(form);
            }
        } else {
            alert('Error saving vulnerability details: ' + (data.error || 'Unknown error'));
            resetButtonState(saveButton);
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('Error saving vulnerability details. Please try again.');
        resetButtonState(saveButton);
    });
}
        
        // Function to generate report after confirmation
        function generateReport(form) {
            const formData = new FormData(form);
            
            // Handle organization name (combo-input logic)
            const organizationSelect = document.getElementById('organization');
            if (organizationSelect.value === 'other') {
                const otherOrganizationInput = document.getElementById('otherOrganization');
                if (otherOrganizationInput.value && otherOrganizationInput.value.trim() !== '') {
                    formData.set('organization', otherOrganizationInput.value);
                }
            }
            
            // Handle city (combo-input logic)
            const citySelect = document.getElementById('city');
            if (citySelect.value === 'other') {
                const otherCityInput = document.getElementById('otherCity');
                if (otherCityInput.value && otherCityInput.value.trim() !== '') {
                    formData.set('city', otherCityInput.value);
                }
            }
            
            // Show loading indicator
            showLoadingIndicator();
            
            fetch('/process_first_audit_report', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    // Create blob for download
                    return response.blob().then(blob => {
                        // Hide loading indicator first
                        hideLoadingIndicator();
                        
                        // Download the file
                        const url = window.URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        // Get filename from response headers if available
                        const filename = response.headers.get('X-Filename') || 'combined_scan_results.xlsx';
                        a.download = filename;
                        document.body.appendChild(a);
                        a.click();
                        window.URL.revokeObjectURL(url);
                        document.body.removeChild(a);
                        
                        // Close modal
                        closeModal('firstAuditModal');
                        
                        // Refresh page to clear form data
                        setTimeout(() => {
                            window.location.reload();
                        }, 1000);
                    });
                } else {
                    throw new Error('Network response was not ok');
                }
            })
            .catch(error => {
                hideLoadingIndicator();
                console.error('Error:', error);
                alert('Error generating report. Please try again.');
            });
        }
        
        // Function to show loading indicator
        function showLoadingIndicator() {
            const loading = document.createElement('div');
            loading.id = 'loadingIndicator';
            
            const loadingContent = document.createElement('div');
            loadingContent.className = 'loading-content';
            
            const spinner = document.createElement('div');
            spinner.className = 'spinner';
            
            const loadingText = document.createElement('p');
            loadingText.textContent = 'Processing...';
            
            loadingContent.appendChild(spinner);
            loadingContent.appendChild(loadingText);
            loading.appendChild(loadingContent);
            document.body.appendChild(loading);
        }
        
        // Function to hide loading indicator
        function hideLoadingIndicator() {
            const loading = document.getElementById('loadingIndicator');
            if (loading) {
                loading.remove();
            }
        }
        
        // Word Report Form Submission
        document.getElementById('firstAuditWordForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const fileInput = document.getElementById('excelFile');
            
            // Validate file selection
            if (!fileInput.files[0]) {
                alert('Please select an Excel file (.xlsx)');
                return;
            }
            
            // Validate file extension
            const fileName = fileInput.files[0].name;
            if (!fileName.toLowerCase().endsWith('.xlsx')) {
                alert('Please select a valid Excel file (.xlsx)');
                return;
            }
            
            // Disable submit button to prevent multiple submissions
            const submitBtn = this.querySelector('button[type="submit"]');
            if (submitBtn) {
                submitBtn.disabled = true;
                submitBtn.textContent = 'Processing...';
                submitBtn.style.opacity = '0.6';
                submitBtn.style.cursor = 'not-allowed';
                
                // Add spinner to button
                const spinner = document.createElement('span');
                spinner.innerHTML = ' <span style="display: inline-block; width: 16px; height: 16px; border: 2px solid #ffffff; border-radius: 50%; border-top-color: transparent; animation: spin 1s linear infinite;"></span>';
                submitBtn.appendChild(spinner);
            }
            
            // Show loading indicator
            showLoadingIndicator();
            
            fetch('/process_first_audit_word_report', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    return response.blob().then(blob => {
                        // Hide loading indicator
                        hideLoadingIndicator();
                        
                        // Download the file with name based on uploaded Excel file
                        const url = window.URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        
                        // Use hardcoded filename for Word report
                        a.download = 'Infrastructure_VAPT_First_Audit_Report.docx';
                        
                        document.body.appendChild(a);
                        a.click();
                        window.URL.revokeObjectURL(url);
                        document.body.removeChild(a);
                        
                        // Close modal
                        closeModal('firstAuditWordModal');
                        
                        // Refresh page to clear form data
                        setTimeout(() => {
                            window.location.reload();
                        }, 1000);
                    });
                } else {
                    throw new Error('Network response was not ok');
                }
            })
            .catch(error => {
                hideLoadingIndicator();
                console.error('Error:', error);
                alert('Error generating Word report. Please try again.');
                // Reset button state
                resetSubmitButtonState(submitBtn, 'Generate Word Report');
            });
        });

        // Follow Up Audit Word Report Form Submission
        document.getElementById('followUpAuditWordForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const fileInput = document.getElementById('followUpExcelFile');
            
            // Validate file selection
            if (!fileInput.files[0]) {
                alert('Please select an Excel file (.xlsx)');
                return;
            }
            
            // Validate file extension
            const fileName = fileInput.files[0].name;
            if (!fileName.toLowerCase().endsWith('.xlsx')) {
                alert('Please select a valid Excel file (.xlsx)');
                return;
            }
            
            // Disable submit button to prevent multiple submissions
            const submitBtn = this.querySelector('button[type="submit"]');
            if (submitBtn) {
                submitBtn.disabled = true;
                submitBtn.textContent = 'Processing...';
                submitBtn.style.opacity = '0.6';
                submitBtn.style.cursor = 'not-allowed';
                
                // Add spinner to button
                const spinner = document.createElement('span');
                spinner.innerHTML = ' <span style="display: inline-block; width: 16px; height: 16px; border: 2px solid #ffffff; border-radius: 50%; border-top-color: transparent; animation: spin 1s linear infinite;"></span>';
                submitBtn.appendChild(spinner);
            }
            
            // Show loading indicator
            showLoadingIndicator();
            
            fetch('/process_follow_up_audit_word_report', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    return response.blob().then(blob => {
                        // Hide loading indicator
                        hideLoadingIndicator();
                        
                        // Download the file with name based on uploaded Excel file
                        const url = window.URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        
                        // Use hardcoded filename for Word report
                        a.download = 'Infrastructure_VAPT_Follow_Up_Audit_Report.docx';
                        
                        document.body.appendChild(a);
                        a.click();
                        window.URL.revokeObjectURL(url);
                        document.body.removeChild(a);
                        
                        // Close modal
                        closeModal('followUpAuditWordModal');
                        
                        // Refresh page to clear form data
                        setTimeout(() => {
                            window.location.reload();
                        }, 1000);
                    });
                } else {
                    throw new Error('Network response was not ok');
                }
            })
            .catch(error => {
                hideLoadingIndicator();
                console.error('Error:', error);
                alert('Error generating Word report. Please try again.');
                // Reset button state
                resetSubmitButtonState(submitBtn, 'Generate Word Report');
            });
        });

        // First Audit Certificate Form Submission
        document.getElementById('firstAuditCertificateForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            
            // Handle organization name (combo-input logic)
            let organization_name = formData.get('organizationName');
            if (organization_name === 'other') {
                organization_name = formData.get('otherOrganizationName');
                if (!organization_name || organization_name.trim() === '') {
                    alert('Please enter the organization name');
                    return;
                }
            }
            
            // Handle city (combo-input logic)
            let city = formData.get('city');
            if (city === 'other') {
                city = formData.get('otherCity');
                if (!city || city.trim() === '') {
                    alert('Please enter the city name');
                    return;
                }
            }
            
            // Handle state (combo-input logic)
            let state = formData.get('state');
            if (state === 'other') {
                state = formData.get('otherState');
                if (!state || state.trim() === '') {
                    alert('Please enter the state name');
                    return;
                }
            }
            
            const report_id = formData.get('reportId');
            
            // Validate required fields
            const requiredFields = ['auditeeDesignation', 'scope', 'startAuditDate', 'endAuditDate', 'reportId'];
            for (const field of requiredFields) {
                if (!formData.get(field) || formData.get(field).trim() === '') {
                    alert(`Please fill in the ${field.replace(/([A-Z])/g, ' $1').toLowerCase()}`);
                    return;
                }
            }
            
            // Validate combo-input fields
            if (!organization_name || organization_name.trim() === '') {
                alert('Please select or enter an organization name');
                return;
            }
            
            if (!city || city.trim() === '') {
                alert('Please select or enter a city');
                return;
            }
            
            if (!state || state.trim() === '') {
                alert('Please select or enter a state');
                return;
            }
            
            // Validate date range
            const startDate = new Date(formData.get('startAuditDate'));
            const endDate = new Date(formData.get('endAuditDate'));
            if (startDate >= endDate) {
                alert('End Audit Date must be after Start Audit Date');
                return;
            }
            
            // Disable submit button to prevent multiple submissions
            const submitBtn = this.querySelector('button[type="submit"]');
            if (submitBtn) {
                submitBtn.disabled = true;
                submitBtn.textContent = 'Processing...';
                submitBtn.style.opacity = '0.6';
                submitBtn.style.cursor = 'not-allowed';
                
                // Add spinner to button
                const spinner = document.createElement('span');
                spinner.innerHTML = ' <span style="display: inline-block; width: 16px; height: 16px; border: 2px solid #ffffff; border-radius: 50%; border-top-color: transparent; animation: spin 1s linear infinite;"></span>';
                submitBtn.appendChild(spinner);
            }
            
            // Prepare form data with correct combo-input values
            const submitFormData = new FormData();
            submitFormData.append('organizationName', organization_name);
            submitFormData.append('city', city);
            submitFormData.append('state', state);
            submitFormData.append('auditeeDesignation', formData.get('auditeeDesignation'));
            submitFormData.append('scope', formData.get('scope'));
            submitFormData.append('startAuditDate', formData.get('startAuditDate'));
            submitFormData.append('endAuditDate', formData.get('endAuditDate'));
            submitFormData.append('reportId', formData.get('reportId'));
            
            // Show loading indicator
            showLoadingIndicator();
            
            fetch('/process_first_audit_certificate', {
                method: 'POST',
                body: submitFormData
            })
            .then(response => {
                if (response.ok) {
                    return response.blob().then(blob => {
                        // Hide loading indicator
                        hideLoadingIndicator();
                        
                        // Download the certificate file
                        const url = window.URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = 'Infrastrcture_VAPT_Certificate.docx';
                        document.body.appendChild(a);
                        a.click();
                        window.URL.revokeObjectURL(url);
                        document.body.removeChild(a);
                        
                        // Close modal
                        closeModal('firstAuditCertificateModal');
                        
                        // Reset form
                        this.reset();
                        
                        // Reload the page after download
                        setTimeout(() => {
                            window.location.reload();
                        }, 500); // Small delay to ensure download starts
                    });
                } else {
                    return response.json().then(data => {
                        throw new Error(data.error || 'Network response was not ok');
                    });
                }
            })
            .catch(error => {
                console.error('Error:', error);
                hideLoadingIndicator();
                alert('Error: ' + error.message);
            })
            .finally(() => {
                // Reset submit button state
                if (submitBtn) {
                    resetSubmitButtonState(submitBtn, 'Generate Certificate');
                }
            });
        });

        // Follow Up Audit Certificate Form Handler
        document.getElementById('followUpAuditCertificateForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            
            // Handle organization name (combo-input logic)
            let organization_name = formData.get('organizationName');
            if (organization_name === 'other') {
                organization_name = formData.get('otherOrganizationName');
                if (!organization_name || organization_name.trim() === '') {
                    alert('Please enter the organization name');
                    return;
                }
            }
            
            // Handle city (combo-input logic)
            let city = formData.get('city');
            if (city === 'other') {
                city = formData.get('otherCity');
                if (!city || city.trim() === '') {
                    alert('Please enter the city name');
                    return;
                }
            }
            
            // Handle state (combo-input logic)
            let state = formData.get('state');
            if (state === 'other') {
                state = formData.get('otherState');
                if (!state || state.trim() === '') {
                    alert('Please enter the state name');
                    return;
                }
            }
            
            const report_id = formData.get('reportId');
            
            // Validate required fields
            const requiredFields = ['auditeeDesignation', 'scope', 'startAuditDate', 'endAuditDate', 'reportId'];
            for (const field of requiredFields) {
                if (!formData.get(field) || formData.get(field).trim() === '') {
                    alert(`Please fill in the ${field.replace(/([A-Z])/g, ' $1').toLowerCase()}`);
                    return;
                }
            }
            
            // Validate combo-input fields
            if (!organization_name || organization_name.trim() === '') {
                alert('Please select or enter an organization name');
                return;
            }
            
            if (!city || city.trim() === '') {
                alert('Please select or enter a city');
                return;
            }
            
            if (!state || state.trim() === '') {
                alert('Please select or enter a state');
                return;
            }
            
            // Validate date range
            const startDate = new Date(formData.get('startAuditDate'));
            const endDate = new Date(formData.get('endAuditDate'));
            if (startDate >= endDate) {
                alert('End Audit Date must be after Start Audit Date');
                return;
            }
            
            // Disable submit button to prevent multiple submissions
            const submitBtn = this.querySelector('button[type="submit"]');
            if (submitBtn) {
                submitBtn.disabled = true;
                submitBtn.textContent = 'Processing...';
                submitBtn.style.opacity = '0.6';
                submitBtn.style.cursor = 'not-allowed';
                
                // Add spinner to button
                const spinner = document.createElement('span');
                spinner.innerHTML = ' <span style="display: inline-block; width: 16px; height: 16px; border: 2px solid #ffffff; border-radius: 50%; border-top-color: transparent; animation: spin 1s linear infinite;"></span>';
                submitBtn.appendChild(spinner);
            }
            
            // Prepare form data with correct combo-input values
            const submitFormData = new FormData();
            submitFormData.append('organizationName', organization_name);
            submitFormData.append('city', city);
            submitFormData.append('state', state);
            submitFormData.append('auditeeDesignation', formData.get('auditeeDesignation'));
            submitFormData.append('scope', formData.get('scope'));
            submitFormData.append('startAuditDate', formData.get('startAuditDate'));
            submitFormData.append('endAuditDate', formData.get('endAuditDate'));
            submitFormData.append('reportId', formData.get('reportId'));
            
            // Show loading indicator
            showLoadingIndicator();
            
            fetch('/process_follow_up_audit_certificate', {
                method: 'POST',
                body: submitFormData
            })
            .then(response => {
                if (response.ok) {
                    return response.blob().then(blob => {
                        // Hide loading indicator
                        hideLoadingIndicator();
                        
                        // Download the certificate file
                        const url = window.URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = 'Infrastrcture_VAPT_Follow_Up_Certificate.docx';
                        document.body.appendChild(a);
                        a.click();
                        window.URL.revokeObjectURL(url);
                        document.body.removeChild(a);
                        
                        // Close modal
                        closeModal('followUpAuditCertificateModal');
                        
                        // Reset form
                        this.reset();
                        
                        // Reload the page after download
                        setTimeout(() => {
                            window.location.reload();
                        }, 500); // Small delay to ensure download starts
                    });
                } else {
                    return response.json().then(data => {
                        throw new Error(data.error || 'Network response was not ok');
                    });
                }
            })
            .catch(error => {
                console.error('Error:', error);
                hideLoadingIndicator();
                alert('Error: ' + error.message);
            })
            .finally(() => {
                // Reset submit button state
                if (submitBtn) {
                    resetSubmitButtonState(submitBtn, 'Generate Certificate');
                }
            });
        });

        // IS Audit Certificate Form Handler
        document.getElementById('isAuditCertificateForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            
            // Handle organization name (combo-input logic)
            let organization_name = formData.get('organizationName');
            if (organization_name === 'other') {
                organization_name = formData.get('otherOrganizationName');
                if (!organization_name || organization_name.trim() === '') {
                    alert('Please enter the organization name');
                    return;
                }
            }
            
            // Handle city (combo-input logic)
            let city = formData.get('city');
            if (city === 'other') {
                city = formData.get('otherCity');
                if (!city || city.trim() === '') {
                    alert('Please enter the city name');
                    return;
                }
            }
            
            // Handle state (combo-input logic)
            let state = formData.get('state');
            if (state === 'other') {
                state = formData.get('otherState');
                if (!state || state.trim() === '') {
                    alert('Please enter the state name');
                    return;
                }
            }
            
            const report_id = formData.get('reportId');
            
            // Validate required fields
            const requiredFields = ['auditeeDesignation', 'scope', 'startAuditDate', 'endAuditDate', 'reportId'];
            for (const field of requiredFields) {
                if (!formData.get(field) || formData.get(field).trim() === '') {
                    alert(`Please fill in the ${field.replace(/([A-Z])/g, ' $1').toLowerCase()}`);
                    return;
                }
            }
            
            // Validate combo-input fields
            if (!organization_name || organization_name.trim() === '') {
                alert('Please select or enter an organization name');
                return;
            }
            
            if (!city || city.trim() === '') {
                alert('Please select or enter a city');
                return;
            }
            
            if (!state || state.trim() === '') {
                alert('Please select or enter a state');
                return;
            }
            
            // Validate date range
            const startDate = new Date(formData.get('startAuditDate'));
            const endDate = new Date(formData.get('endAuditDate'));
            if (startDate >= endDate) {
                alert('End Audit Date must be after Start Audit Date');
                return;
            }
            
            // Disable submit button to prevent multiple submissions
            const submitBtn = this.querySelector('button[type="submit"]');
            if (submitBtn) {
                submitBtn.disabled = true;
                submitBtn.textContent = 'Processing...';
                submitBtn.style.opacity = '0.6';
                submitBtn.style.cursor = 'not-allowed';
                
                // Add spinner to button
                const spinner = document.createElement('span');
                spinner.innerHTML = ' <span style="display: inline-block; width: 16px; height: 16px; border: 2px solid #ffffff; border-radius: 50%; border-top-color: transparent; animation: spin 1s linear infinite;"></span>';
                submitBtn.appendChild(spinner);
            }
            
            // Prepare form data with correct combo-input values
            const submitFormData = new FormData();
            submitFormData.append('organizationName', organization_name);
            submitFormData.append('city', city);
            submitFormData.append('state', state);
            submitFormData.append('auditeeDesignation', formData.get('auditeeDesignation'));
            submitFormData.append('scope', formData.get('scope'));
            submitFormData.append('startAuditDate', formData.get('startAuditDate'));
            submitFormData.append('endAuditDate', formData.get('endAuditDate'));
            submitFormData.append('reportId', formData.get('reportId'));
            
            // Show loading indicator
            showLoadingIndicator();
            
            fetch('/process_is_audit_certificate', {
                method: 'POST',
                body: submitFormData
            })
            .then(response => {
                if (response.ok) {
                    return response.blob().then(blob => {
                        // Hide loading indicator
                        hideLoadingIndicator();
                        
                        // Download the certificate file
                        const url = window.URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = 'IS_Audit_Certificate.docx';
                        document.body.appendChild(a);
                        a.click();
                        window.URL.revokeObjectURL(url);
                        document.body.removeChild(a);
                        
                        // Close modal
                        closeModal('isAuditCertificateModal');
                        
                        // Reset form
                        this.reset();
                    });
                } else {
                    return response.json().then(data => {
                        throw new Error(data.error || 'Network response was not ok');
                    });
                }
            })
            .catch(error => {
                console.error('Error:', error);
                hideLoadingIndicator();
                alert('Error: ' + error.message);
            })
            .finally(() => {
                // Reset submit button state
                if (submitBtn) {
                    resetSubmitButtonState(submitBtn, 'Generate Certificate');
                }
            });
        });

        // Cyber Security Audit Certificate Form Handler
        document.getElementById('cyberSecurityAuditCertificateForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            
            // Handle organization name (combo-input logic)
            let organization_name = formData.get('organizationName');
            if (organization_name === 'other') {
                organization_name = formData.get('otherOrganizationName');
                if (!organization_name || organization_name.trim() === '') {
                    alert('Please enter the organization name');
                    return;
                }
            }
            
            // Handle city (combo-input logic)
            let city = formData.get('city');
            if (city === 'other') {
                city = formData.get('otherCity');
                if (!city || city.trim() === '') {
                    alert('Please enter the city name');
                    return;
                }
            }
            
            // Handle state (combo-input logic)
            let state = formData.get('state');
            if (state === 'other') {
                state = formData.get('otherState');
                if (!state || state.trim() === '') {
                    alert('Please enter the state name');
                    return;
                }
            }
            
            const report_id = formData.get('reportId');
            
            // Validate required fields
            const requiredFields = ['auditeeDesignation', 'startAuditDate', 'endAuditDate', 'reportId'];
            for (const field of requiredFields) {
                if (!formData.get(field) || formData.get(field).trim() === '') {
                    alert(`Please fill in the ${field.replace(/([A-Z])/g, ' $1').toLowerCase()}`);
                    return;
                }
            }
            
            // Validate combo-input fields
            if (!organization_name || organization_name.trim() === '') {
                alert('Please select or enter an organization name');
                return;
            }
            
            if (!city || city.trim() === '') {
                alert('Please select or enter a city');
                return;
            }
            
            if (!state || state.trim() === '') {
                alert('Please select or enter a state');
                return;
            }
            
            // Validate date range
            const startDate = new Date(formData.get('startAuditDate'));
            const endDate = new Date(formData.get('endAuditDate'));
            if (startDate >= endDate) {
                alert('End Audit Date must be after Start Audit Date');
                return;
            }
            
            // Disable submit button to prevent multiple submissions
            const submitBtn = this.querySelector('button[type="submit"]');
            if (submitBtn) {
                submitBtn.disabled = true;
                submitBtn.textContent = 'Processing...';
                submitBtn.style.opacity = '0.6';
                submitBtn.style.cursor = 'not-allowed';
                
                // Add spinner to button
                const spinner = document.createElement('span');
                spinner.innerHTML = ' <span style="display: inline-block; width: 16px; height: 16px; border: 2px solid #ffffff; border-radius: 50%; border-top-color: transparent; animation: spin 1s linear infinite;"></span>';
                submitBtn.appendChild(spinner);
            }
            
            // Prepare form data with correct combo-input values
            const submitFormData = new FormData();
            submitFormData.append('organizationName', organization_name);
            submitFormData.append('city', city);
            submitFormData.append('state', state);
            submitFormData.append('auditeeDesignation', formData.get('auditeeDesignation'));
            submitFormData.append('startAuditDate', formData.get('startAuditDate'));
            submitFormData.append('endAuditDate', formData.get('endAuditDate'));
            submitFormData.append('reportId', formData.get('reportId'));
            
            // Show loading indicator
            showLoadingIndicator();
            
            fetch('/process_cyber_security_audit_certificate', {
                method: 'POST',
                body: submitFormData
            })
            .then(response => {
                if (response.ok) {
                    return response.blob().then(blob => {
                        // Hide loading indicator
                        hideLoadingIndicator();
                        
                        // Download the certificate file
                        const url = window.URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = 'Cyber_Security_Audit_Certificate.docx';
                        document.body.appendChild(a);
                        a.click();
                        window.URL.revokeObjectURL(url);
                        document.body.removeChild(a);
                        
                        // Close modal
                        closeModal('cyberSecurityAuditCertificateModal');
                        
                        // Reset form
                        this.reset();
                    });
                } else {
                    return response.json().then(data => {
                        throw new Error(data.error || 'Network response was not ok');
                    });
                }
            })
            .catch(error => {
                console.error('Error:', error);
                hideLoadingIndicator();
                alert('Error: ' + error.message);
            })
            .finally(() => {
                // Reset submit button state
                if (submitBtn) {
                    resetSubmitButtonState(submitBtn, 'Generate Certificate');
                }
            });
        });

        // Gap Assessment Audit Certificate Form Handler
        document.getElementById('gapAssessmentAuditCertificateForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            
            // Handle organization name (combo-input logic)
            let organization_name = formData.get('organizationName');
            if (organization_name === 'other') {
                organization_name = formData.get('otherOrganizationName');
                if (!organization_name || organization_name.trim() === '') {
                    alert('Please enter the organization name');
                    return;
                }
            }
            
            // Handle city (combo-input logic)
            let city = formData.get('city');
            if (city === 'other') {
                city = formData.get('otherCity');
                if (!city || city.trim() === '') {
                    alert('Please enter the city name');
                    return;
                }
            }
            
            // Handle state (combo-input logic)
            let state = formData.get('state');
            if (state === 'other') {
                state = formData.get('otherState');
                if (!state || state.trim() === '') {
                    alert('Please enter the state name');
                    return;
                }
            }
            
            const report_id = formData.get('reportId');
            
            // Validate required fields
            const requiredFields = ['auditeeDesignation', 'startAuditDate', 'endAuditDate', 'reportId'];
            for (const field of requiredFields) {
                if (!formData.get(field) || formData.get(field).trim() === '') {
                    alert(`Please fill in the ${field.replace(/([A-Z])/g, ' $1').toLowerCase()}`);
                    return;
                }
            }
            
            // Validate combo-input fields
            if (!organization_name || organization_name.trim() === '') {
                alert('Please select or enter an organization name');
                return;
            }
            
            if (!city || city.trim() === '') {
                alert('Please select or enter a city');
                return;
            }
            
            if (!state || state.trim() === '') {
                alert('Please select or enter a state');
                return;
            }
            
            // Validate date range
            const startDate = new Date(formData.get('startAuditDate'));
            const endDate = new Date(formData.get('endAuditDate'));
            if (startDate >= endDate) {
                alert('End Audit Date must be after Start Audit Date');
                return;
            }
            
            // Disable submit button to prevent multiple submissions
            const submitBtn = this.querySelector('button[type="submit"]');
            if (submitBtn) {
                submitBtn.disabled = true;
                submitBtn.textContent = 'Processing...';
                submitBtn.style.opacity = '0.6';
                submitBtn.style.cursor = 'not-allowed';
                
                // Add spinner to button
                const spinner = document.createElement('span');
                spinner.innerHTML = ' <span style="display: inline-block; width: 16px; height: 16px; border: 2px solid #ffffff; border-radius: 50%; border-top-color: transparent; animation: spin 1s linear infinite;"></span>';
                submitBtn.appendChild(spinner);
            }
            
            // Prepare form data with correct combo-input values
            const submitFormData = new FormData();
            submitFormData.append('organizationName', organization_name);
            submitFormData.append('city', city);
            submitFormData.append('state', state);
            submitFormData.append('auditeeDesignation', formData.get('auditeeDesignation'));
            submitFormData.append('startAuditDate', formData.get('startAuditDate'));
            submitFormData.append('endAuditDate', formData.get('endAuditDate'));
            submitFormData.append('reportId', formData.get('reportId'));
            
            // Show loading indicator
            showLoadingIndicator();
            
            fetch('/process_gap_assessment_audit_certificate', {
                method: 'POST',
                body: submitFormData
            })
            .then(response => {
                if (response.ok) {
                    return response.blob().then(blob => {
                        // Hide loading indicator
                        hideLoadingIndicator();
                        
                        // Download the certificate file
                        const url = window.URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = 'Gap_Assessment_Audit_Certificate.docx';
                        document.body.appendChild(a);
                        a.click();
                        window.URL.revokeObjectURL(url);
                        document.body.removeChild(a);
                        
                        // Close modal
                        closeModal('gapAssessmentAuditCertificateModal');
                        
                        // Reset form
                        this.reset();
                    });
                } else {
                    return response.json().then(data => {
                        throw new Error(data.error || 'Network response was not ok');
                    });
                }
            })
            .catch(error => {
                console.error('Error:', error);
                hideLoadingIndicator();
                alert('Error: ' + error.message);
            })
            .finally(() => {
                // Reset submit button state
                if (submitBtn) {
                    resetSubmitButtonState(submitBtn, 'Generate Certificate');
                }
            });
        });

        // Date validation functionality
        function setupDateValidation() {
            const startDateInput = document.getElementById('startDate');
            const endDateInput = document.getElementById('endDate');
            
            // Handle start date change
            startDateInput.addEventListener('change', function() {
                const startDate = new Date(this.value);
                
                if (this.value) {
                    // Set minimum date for end date to be the day after start date
                    const minEndDate = new Date(startDate);
                    minEndDate.setDate(minEndDate.getDate() + 1);
                    endDateInput.min = minEndDate.toISOString().split('T')[0];
                    
                    // If end date is already selected and is before or equal to start date, clear it
                    if (endDateInput.value && new Date(endDateInput.value) <= startDate) {
                        endDateInput.value = '';
                        alert('End date must be after start date. Please select a new end date.');
                    }
                } else {
                    // If start date is cleared, remove min restriction from end date
                    endDateInput.min = '';
                }
            });
            
            // Handle end date change
            endDateInput.addEventListener('change', function() {
                const endDate = new Date(this.value);
                
                if (this.value) {
                    // Set maximum date for start date to be the day before end date
                    const maxStartDate = new Date(endDate);
                    maxStartDate.setDate(maxStartDate.getDate() - 1);
                    startDateInput.max = maxStartDate.toISOString().split('T')[0];
                    
                    // If start date is already selected and is after or equal to end date, clear it
                    if (startDateInput.value && new Date(startDateInput.value) >= endDate) {
                        startDateInput.value = '';
                        alert('Start date must be before end date. Please select a new start date.');
                    }
                } else {
                    // If end date is cleared, remove max restriction from start date
                    startDateInput.max = '';
                }
            });
        }
        
        // Date validation functionality for Follow-up Audit form
        function setupFollowUpDateValidation() {
            const startDateInput = document.getElementById('followUpStartDate');
            const endDateInput = document.getElementById('followUpEndDate');
            
            // Handle start date change
            startDateInput.addEventListener('change', function() {
                const startDate = new Date(this.value);
                
                if (this.value) {
                    // Set minimum date for end date to be the day after start date
                    const minEndDate = new Date(startDate);
                    minEndDate.setDate(minEndDate.getDate() + 1);
                    endDateInput.min = minEndDate.toISOString().split('T')[0];
                    
                    // If end date is already selected and is before or equal to start date, clear it
                    if (endDateInput.value && new Date(endDateInput.value) <= startDate) {
                        endDateInput.value = '';
                        alert('End date must be after start date. Please select a new end date.');
                    }
                } else {
                    // If start date is cleared, remove min restriction from end date
                    endDateInput.min = '';
                }
            });
            
            // Handle end date change
            endDateInput.addEventListener('change', function() {
                const endDate = new Date(this.value);
                
                if (this.value) {
                    // Set maximum date for start date to be the day before end date
                    const maxStartDate = new Date(endDate);
                    maxStartDate.setDate(maxStartDate.getDate() - 1);
                    startDateInput.max = maxStartDate.toISOString().split('T')[0];
                    
                    // If start date is already selected and is after or equal to end date, clear it
                    if (startDateInput.value && new Date(startDateInput.value) >= endDate) {
                        startDateInput.value = '';
                        alert('Start date must be before end date. Please select a new start date.');
                    }
                } else {
                    // If end date is cleared, remove max restriction from start date
                    startDateInput.max = '';
                }
            });
        }
        
        // Initialize date validation when page loads
        document.addEventListener('DOMContentLoaded', function() {
            setupDateValidation();
            setupFollowUpDateValidation();
        });

    document.addEventListener('DOMContentLoaded', function() {
        const startAuditInput = document.getElementById('cyberStartDate');
        const endAuditInput = document.getElementById('cyberEndDate');

        if (!startAuditInput || !endAuditInput) {
            return;
        }

        const applyEndConstraints = () => {
            if (startAuditInput.value) {
                endAuditInput.min = startAuditInput.value;
                if (endAuditInput.value && endAuditInput.value < startAuditInput.value) {
                    endAuditInput.value = startAuditInput.value;
                }
            } else {
                endAuditInput.removeAttribute('min');
            }
        };

        const applyStartConstraints = () => {
            if (endAuditInput.value) {
                startAuditInput.max = endAuditInput.value;
                if (startAuditInput.value && startAuditInput.value > endAuditInput.value) {
                    startAuditInput.value = endAuditInput.value;
                }
            } else {
                startAuditInput.removeAttribute('max');
            }
        };

        const syncConstraints = () => {
            applyEndConstraints();
            applyStartConstraints();
        };

        startAuditInput.addEventListener('change', syncConstraints);
        endAuditInput.addEventListener('change', syncConstraints);

        syncConstraints();
    });

    document.addEventListener('DOMContentLoaded', function() {
        const startAuditInput = document.getElementById('startAuditDate');
        const endAuditInput = document.getElementById('endAuditDate');

        if (!startAuditInput || !endAuditInput) {
            return;
        }

        const applyEndConstraints = () => {
            if (startAuditInput.value) {
                endAuditInput.min = startAuditInput.value;
                if (endAuditInput.value && endAuditInput.value < startAuditInput.value) {
                    endAuditInput.value = startAuditInput.value;
                }
            } else {
                endAuditInput.removeAttribute('min');
            }
        };

        const applyStartConstraints = () => {
            if (endAuditInput.value) {
                startAuditInput.max = endAuditInput.value;
                if (startAuditInput.value && startAuditInput.value > endAuditInput.value) {
                    startAuditInput.value = endAuditInput.value;
                }
            } else {
                startAuditInput.removeAttribute('max');
            }
        };

        startAuditInput.addEventListener('change', () => {
            applyEndConstraints();
            applyStartConstraints();
        });

        endAuditInput.addEventListener('change', () => {
            applyStartConstraints();
            applyEndConstraints();
        });

        applyStartConstraints();
        applyEndConstraints();
    });

    document.addEventListener('DOMContentLoaded', function() {
        const startAuditInput = document.getElementById('followUpAuditCertificateStartAuditDate');
        const endAuditInput = document.getElementById('followUpAuditCertificateEndAuditDate');

        if (!startAuditInput || !endAuditInput) {
            return;
        }

        const applyEndConstraints = () => {
            if (startAuditInput.value) {
                endAuditInput.min = startAuditInput.value;
                if (endAuditInput.value && endAuditInput.value < startAuditInput.value) {
                    endAuditInput.value = startAuditInput.value;
                }
            } else {
                endAuditInput.removeAttribute('min');
            }
        };

        const applyStartConstraints = () => {
            if (endAuditInput.value) {
                startAuditInput.max = endAuditInput.value;
                if (startAuditInput.value && startAuditInput.value > endAuditInput.value) {
                    startAuditInput.value = endAuditInput.value;
                }
            } else {
                startAuditInput.removeAttribute('max');
            }
        };

        startAuditInput.addEventListener('change', () => {
            applyEndConstraints();
            applyStartConstraints();
        });

        endAuditInput.addEventListener('change', () => {
            applyStartConstraints();
            applyEndConstraints();
        });

        applyStartConstraints();
        applyEndConstraints();
    });

    document.addEventListener('DOMContentLoaded', function() {
        const startDateInput = document.getElementById('followUpMetaStartDate');
        const endDateInput = document.getElementById('followUpMetaEndDate');

        if (!startDateInput || !endDateInput) {
            return;
        }
        
        // Date constraint logic for Start Audit Date and Date of Audit Completion
        const completionDateInput = document.getElementById('followUpMetaDateCompletion');
        
        if (completionDateInput) {
            // When Start Audit Date changes, set minimum date for Date of Audit Completion
            startDateInput.addEventListener('change', function() {
                if (startDateInput.value) {
                    completionDateInput.setAttribute('min', startDateInput.value);
                    // If completion date is before start date, clear it
                    if (completionDateInput.value && completionDateInput.value < startDateInput.value) {
                        completionDateInput.value = '';
                    }
                } else {
                    completionDateInput.removeAttribute('min');
                }
            });
            
            // When Date of Audit Completion changes, set maximum date for Start Audit Date
            completionDateInput.addEventListener('change', function() {
                if (completionDateInput.value) {
                    startDateInput.setAttribute('max', completionDateInput.value);
                    // If start date is after completion date, clear it
                    if (startDateInput.value && startDateInput.value > completionDateInput.value) {
                        startDateInput.value = '';
                    }
                } else {
                    startDateInput.removeAttribute('max');
                }
            });
        }

        const applyEndConstraints = () => {
            if (startDateInput.value) {
                endDateInput.min = startDateInput.value;
                if (endDateInput.value && endDateInput.value < startDateInput.value) {
                    endDateInput.value = startDateInput.value;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const applyStartConstraints = () => {
            if (endDateInput.value) {
                startDateInput.max = endDateInput.value;
                if (startDateInput.value && startDateInput.value > endDateInput.value) {
                    startDateInput.value = endDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('max');
            }
        };

        startDateInput.addEventListener('change', () => {
            applyEndConstraints();
            applyStartConstraints();
        });

        endDateInput.addEventListener('change', () => {
            applyStartConstraints();
            applyEndConstraints();
        });

        applyStartConstraints();
        applyEndConstraints();
    });

    document.addEventListener('DOMContentLoaded', function() {
        const startAuditInput = document.getElementById('firstAuditCertificateStartAuditDate');
        const endAuditInput = document.getElementById('firstAuditCertificateEndAuditDate');

        if (!startAuditInput || !endAuditInput) {
            return;
        }

        const applyEndConstraints = () => {
            if (startAuditInput.value) {
                endAuditInput.min = startAuditInput.value;
                if (endAuditInput.value && endAuditInput.value < startAuditInput.value) {
                    endAuditInput.value = startAuditInput.value;
                }
            } else {
                endAuditInput.removeAttribute('min');
            }
        };

        const applyStartConstraints = () => {
            if (endAuditInput.value) {
                startAuditInput.max = endAuditInput.value;
                if (startAuditInput.value && startAuditInput.value > endAuditInput.value) {
                    startAuditInput.value = endAuditInput.value;
                }
            } else {
                startAuditInput.removeAttribute('max');
            }
        };

        startAuditInput.addEventListener('change', () => {
            applyEndConstraints();
            applyStartConstraints();
        });

        endAuditInput.addEventListener('change', () => {
            applyStartConstraints();
            applyEndConstraints();
        });

        applyStartConstraints();
        applyEndConstraints();
    });

    document.addEventListener('DOMContentLoaded', function() {
        const releaseDateInput = document.getElementById('followUpFirstAuditReportDate');
        const startAuditInput = document.getElementById('followUpStartDate');
        const endAuditInput = document.getElementById('followUpEndDate');

        if (!releaseDateInput || !startAuditInput || !endAuditInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        const applyStartEndMinFromRelease = () => {
            if (!releaseDateInput.value) {
                startAuditInput.removeAttribute('min');
                endAuditInput.removeAttribute('min');
                return;
            }

            const releaseDate = new Date(releaseDateInput.value);
            const minDate = formatDate(releaseDate);

            startAuditInput.min = minDate;
            endAuditInput.min = minDate;

            if (startAuditInput.value && startAuditInput.value < minDate) {
                startAuditInput.value = minDate;
            }
            if (endAuditInput.value && endAuditInput.value < minDate) {
                endAuditInput.value = minDate;
            }
        };

        const applyReleaseMaxFromStart = () => {
            if (!startAuditInput.value) {
                releaseDateInput.removeAttribute('max');
                return;
            }

            const startDate = new Date(startAuditInput.value);
            const maxDate = formatDate(startDate);

            releaseDateInput.max = maxDate;
            if (releaseDateInput.value && releaseDateInput.value > maxDate) {
                releaseDateInput.value = maxDate;
            }
        };

        releaseDateInput.addEventListener('change', () => {
            applyStartEndMinFromRelease();
        });

        startAuditInput.addEventListener('change', () => {
            applyReleaseMaxFromStart();
        });

        endAuditInput.addEventListener('change', () => {
            applyStartEndMinFromRelease();
        });

        applyReleaseMaxFromStart();
        applyStartEndMinFromRelease();
    });

    document.addEventListener('DOMContentLoaded', function() {
        const startDateInput = document.getElementById('metaStartDate');
        const endDateInput = document.getElementById('metaEndDate');

        if (!startDateInput || !endDateInput) {
            return;
        }
        
        // Date constraint logic for Start Audit Date and Date of Audit Completion
        const completionDateInput = document.getElementById('metaDateCompletion');
        
        if (completionDateInput) {
            // When Start Audit Date changes, set minimum date for Date of Audit Completion
            startDateInput.addEventListener('change', function() {
                if (startDateInput.value) {
                    completionDateInput.setAttribute('min', startDateInput.value);
                    // If completion date is before start date, clear it
                    if (completionDateInput.value && completionDateInput.value < startDateInput.value) {
                        completionDateInput.value = '';
                    }
                } else {
                    completionDateInput.removeAttribute('min');
                }
            });
            
            // When Date of Audit Completion changes, set maximum date for Start Audit Date
            completionDateInput.addEventListener('change', function() {
                if (completionDateInput.value) {
                    startDateInput.setAttribute('max', completionDateInput.value);
                    // If start date is after completion date, clear it
                    if (startDateInput.value && startDateInput.value > completionDateInput.value) {
                        startDateInput.value = '';
                    }
                } else {
                    startDateInput.removeAttribute('max');
                }
            });
        }

        const applyEndConstraints = () => {
            if (startDateInput.value) {
                endDateInput.min = startDateInput.value;
                if (endDateInput.value && endDateInput.value < startDateInput.value) {
                    endDateInput.value = startDateInput.value;
                }
            } else {
                endDateInput.removeAttribute('min');
            }
        };

        const applyStartConstraints = () => {
            if (endDateInput.value) {
                startDateInput.max = endDateInput.value;
                if (startDateInput.value && startDateInput.value > endDateInput.value) {
                    startDateInput.value = endDateInput.value;
                }
            } else {
                startDateInput.removeAttribute('max');
            }
        };

        startDateInput.addEventListener('change', () => {
            applyEndConstraints();
            applyStartConstraints();
        });

        endDateInput.addEventListener('change', () => {
            applyStartConstraints();
            applyEndConstraints();
        });

        applyStartConstraints();
        applyEndConstraints();
    });

    // Date constraints for IS Audit Certificate form
    document.addEventListener('DOMContentLoaded', function() {
        const startAuditInput = document.getElementById('isAuditCertificateStartAuditDate');
        const endAuditInput = document.getElementById('isAuditCertificateEndAuditDate');

        if (!startAuditInput || !endAuditInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        // When start audit date changes, set minimum date for end audit date (start date + 1 day)
        const applyEndDateMinConstraint = () => {
            if (startAuditInput.value) {
                const startDate = new Date(startAuditInput.value);
                // Set minimum to start date + 1 day (so end date must be after start date)
                const minDate = new Date(startDate);
                minDate.setDate(minDate.getDate() + 1);
                const minDateStr = formatDate(minDate);
                endAuditInput.setAttribute('min', minDateStr);
                // If end date is before or equal to start date, clear it
                if (endAuditInput.value && endAuditInput.value <= startAuditInput.value) {
                    endAuditInput.value = '';
                }
            } else {
                endAuditInput.removeAttribute('min');
            }
        };

        // When end audit date changes, set maximum date for start audit date (end date - 1 day)
        const applyStartDateMaxConstraint = () => {
            if (endAuditInput.value) {
                const endDate = new Date(endAuditInput.value);
                // Set maximum to end date - 1 day (so start date must be before end date)
                const maxDate = new Date(endDate);
                maxDate.setDate(maxDate.getDate() - 1);
                const maxDateStr = formatDate(maxDate);
                startAuditInput.setAttribute('max', maxDateStr);
                // If start date is after or equal to end date, clear it
                if (startAuditInput.value && startAuditInput.value >= endAuditInput.value) {
                    startAuditInput.value = '';
                }
            } else {
                startAuditInput.removeAttribute('max');
            }
        };

        // Add event listeners
        startAuditInput.addEventListener('change', () => {
            applyEndDateMinConstraint();
        });

        endAuditInput.addEventListener('change', () => {
            applyStartDateMaxConstraint();
        });

        // Apply constraints on page load if values are already set
        applyEndDateMinConstraint();
        applyStartDateMaxConstraint();
    });

        // Function to show unmatched vulnerabilities popup (kept for backward compatibility)
        function showUnmatchedVulnerabilitiesPopup(count) {
            const popup = document.createElement('div');
            popup.className = 'unmatched-vuln-popup';
            popup.innerHTML = `
                <div class="popup-content">
                    <div class="popup-header">
                        <h3>⚠️ Unmatched Vulnerabilities Detected</h3>
                        <span class="close-popup" onclick="this.parentElement.parentElement.parentElement.remove()">&times;</span>
                    </div>
                    <div class="popup-body">
                        <p><strong>${count}</strong> vulnerabilities were found that do not match the Infrastructure VAPT Catalog.</p>
                        <p>These vulnerabilities have been included in the report but may require manual review and categorization.</p>
                        <div class="popup-actions">
                            <button onclick="this.parentElement.parentElement.parentElement.remove()" class="popup-ok-btn">OK</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(popup);
            
            // Auto-remove popup after 10 seconds
            setTimeout(() => {
                if (popup.parentElement) {
                    popup.remove();
                }
            }, 10000);
        }
        
        // Follow Up Audit Form submission handler
        document.getElementById('followUpAuditForm').addEventListener('submit', function(e) {
            // Validate dates
            const startDateInput = document.getElementById('followUpStartDate');
            const endDateInput = document.getElementById('followUpEndDate');
            
            if (!startDateInput.value || !endDateInput.value) {
                e.preventDefault();
                alert('Please select both start and end dates');
                return false;
            }
            
            const startDate = new Date(startDateInput.value);
            const endDate = new Date(endDateInput.value);
            
            if (startDate >= endDate) {
                e.preventDefault();
                alert('Finish date must be after start date');
                return false;
            }
            
            // Validate at least one team member
            const teamMembers = document.querySelectorAll('#followUpAuditTeamContainer .team-member');
            if (teamMembers.length === 0) {
                e.preventDefault();
                alert('Please add at least one team member');
                return false;
            }
            
            // Prevent default form submission
            e.preventDefault();
            
            // Disable submit button to prevent multiple submissions
            const submitBtn = this.querySelector('button[type="submit"]');
            if (submitBtn) {
                submitBtn.disabled = true;
                submitBtn.textContent = 'Processing...';
                submitBtn.style.opacity = '0.6';
                submitBtn.style.cursor = 'not-allowed';
                
                // Add spinner to button
                const spinner = document.createElement('span');
                spinner.innerHTML = ' <span style="display: inline-block; width: 16px; height: 16px; border: 2px solid #ffffff; border-radius: 50%; border-top-color: transparent; animation: spin 1s linear infinite;"></span>';
                submitBtn.appendChild(spinner);
            }
            
            // First, check for vulnerabilities
            checkFollowUpVulnerabilitiesBeforeReport(this);
            
            return false;
        });
        
        // Function to check vulnerabilities before generating follow-up report
        function checkFollowUpVulnerabilitiesBeforeReport(form) {
            const formData = new FormData(form);
            
            // Show loading indicator
            showLoadingIndicator();
            
            fetch('/followup_check_vulnerabilities', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                hideLoadingIndicator();
                
                if (data.error) {
                    alert('Error: ' + data.error);
                    // Reset button state on error
                    const submitBtn = form.querySelector('button[type="submit"]');
                    if (submitBtn) {
                        resetSubmitButtonState(submitBtn, 'Submit Report');
                    }
                    return;
                }
                
                // Show confirmation dialog with vulnerability information
                showVulnerabilityConfirmationDialog(data, form);
            })
            .catch(error => {
                hideLoadingIndicator();
                console.error('Error:', error);
                alert('Error checking vulnerabilities. Please try again.');
                // Reset button state on error
                const submitBtn = form.querySelector('button[type="submit"]');
                if (submitBtn) {
                    resetSubmitButtonState(submitBtn, 'Submit Report');
                }
            });
        }
        
        // Function to generate follow-up report after confirmation
        function generateFollowUpReport(form) {
            const formData = new FormData(form);
            
            // Show loading indicator
            showLoadingIndicator();
            
            fetch('/process_follow_up_audit_report', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    // Extract filename from Content-Disposition header or use fixed name
                    let filename = 'Infrastructure_VAPT_Follow_UP_Audit_Worksheet.xlsx';
                    try {
                        const contentDisposition = response.headers.get('Content-Disposition');
                        if (contentDisposition) {
                            const filenameMatch = contentDisposition.match(/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/);
                            if (filenameMatch && filenameMatch[1]) {
                                filename = filenameMatch[1].replace(/['"]/g, '');
                            }
                        }
                    } catch (e) {
                        console.log('Could not extract filename from header, using default');
                    }
                    // Return both blob and filename
                    return response.blob().then(blob => ({ blob, filename }));
                } else {
                    throw new Error('Network response was not ok');
                }
            })
            .then(({ blob, filename }) => {
                hideLoadingIndicator();
                
                // Create download link
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                // Close modal
                closeModal('followUpAuditModal');
                
                // Refresh page to clear form data
                setTimeout(() => {
                    window.location.reload();
                }, 1000);
            })
            .catch(error => {
                hideLoadingIndicator();
                console.error('Error:', error);
                alert('Error generating follow-up report. Please try again.');
            });
        }

        // Branch Excel Without POC Modal Functions
        let systemCount = 0;
        let auditorCount = 0;
        let atmCount = 0;

        // Add system functionality
        document.getElementById('addSystemBtn').addEventListener('click', function() {
            const systemsContainer = document.getElementById('systemsContainer');
            const currentSystemCount = systemsContainer.querySelectorAll('.system-details').length;
            
            // Check if limit of 200 systems is reached
            if (currentSystemCount >= 200) {
                alert('Maximum limit of 200 systems has been reached. You cannot add more systems.');
                return;
            }
            
            systemCount++;
            const newSystem = document.createElement('div');
            newSystem.className = 'system-details';
            newSystem.dataset.index = systemCount;
            
            newSystem.innerHTML = `
                <div class="form-row">
                    <div class="form-group">
                        <label for="systemIp_${systemCount}">System's IP Address*</label>
                        <input type="text" id="systemIp_${systemCount}" name="systemIp[]" required placeholder="Enter IP Address">
                    </div>
                    <div class="form-group">
                        <label for="macAddress_${systemCount}">MAC Address*</label>
                        <input type="text" id="macAddress_${systemCount}" name="macAddress[]" required placeholder="Enter MAC Address">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="employeeName_${systemCount}">Employee Name*</label>
                        <input type="text" id="employeeName_${systemCount}" name="employeeName[]" required placeholder="Enter Employee Name">
                    </div>
                    <div class="form-group">
                        <label for="designation_${systemCount}">Designation*</label>
                        <input type="text" id="designation_${systemCount}" name="designation[]" required placeholder="Enter Designation">
                    </div>
                </div>
                <button type="button" class="remove-system-btn" onclick="removeSystem(this)">Remove System</button>
            `;
            
            systemsContainer.appendChild(newSystem);
            
            // Update button state after adding
            const addSystemBtn = document.getElementById('addSystemBtn');
            const updatedCount = systemsContainer.querySelectorAll('.system-details').length;
            if (updatedCount >= 200) {
                addSystemBtn.disabled = true;
                addSystemBtn.style.opacity = '0.5';
                addSystemBtn.style.cursor = 'not-allowed';
                addSystemBtn.title = 'Maximum limit of 200 systems reached';
            }
        });

        // Add auditor functionality
        document.getElementById('addAuditorBtn').addEventListener('click', function() {
            auditorCount++;
            const auditorContainer = document.getElementById('auditorContainer');
            const newAuditor = document.createElement('div');
            newAuditor.className = 'auditor-details';
            newAuditor.dataset.index = auditorCount;
            
            newAuditor.innerHTML = `
                <div class="combo-input">
                    <select id="auditorNamePrefix_${auditorCount}" name="auditorNamePrefix[]" required>
                        <option value="">Select</option>
                        <option value="Mr.">Mr.</option>
                        <option value="Ms.">Ms.</option>
                        <option value="Mrs.">Mrs.</option>
                        <option value="Dr.">Dr.</option>
                    </select>
                    <input type="text" id="auditorName_${auditorCount}" name="auditorName[]" required placeholder="Enter Name">
                </div>
                <button type="button" class="remove-auditor-btn" onclick="removeAuditor(this)">Remove Auditor</button>
            `;
            
            auditorContainer.appendChild(newAuditor);
        });

        // Add ATM IP functionality
        document.getElementById('addAtmIpBtn').addEventListener('click', function() {
            atmCount++;
            const atmIpContainer = document.getElementById('atmIpContainer');
            const newAtmIp = document.createElement('div');
            newAtmIp.className = 'atm-ip-details';
            newAtmIp.dataset.index = atmCount;
            
            newAtmIp.innerHTML = `
                <div class="form-group">
                    <input type="text" id="atmIp_${atmCount}" name="atmIp[]" required placeholder="Enter ATM IP Address">
                    <button type="button" class="remove-atm-ip-btn" onclick="removeAtmIp(this)">Remove IP</button>
                </div>
            `;
            
            atmIpContainer.appendChild(newAtmIp);
        });

        // Remove system functionality
        function removeSystem(button) {
            const systemDiv = button.closest('.system-details');
            systemDiv.remove();
            
            // Reindex remaining systems
            const systems = document.querySelectorAll('.system-details');
            systems.forEach((system, index) => {
                system.dataset.index = index;
            });
            
            // Re-enable button if count goes below 200
            const systemsContainer = document.getElementById('systemsContainer');
            const currentCount = systemsContainer.querySelectorAll('.system-details').length;
            const addSystemBtn = document.getElementById('addSystemBtn');
            if (currentCount < 200) {
                addSystemBtn.disabled = false;
                addSystemBtn.style.opacity = '1';
                addSystemBtn.style.cursor = 'pointer';
                addSystemBtn.title = '';
            }
        }

        // Remove auditor functionality
        function removeAuditor(button) {
            const auditorDiv = button.closest('.auditor-details');
            auditorDiv.remove();
            
            // Reindex remaining auditors
            const auditors = document.querySelectorAll('.auditor-details');
            auditors.forEach((auditor, index) => {
                auditor.dataset.index = index;
            });
        }

        // Remove ATM IP functionality
        function removeAtmIp(button) {
            const atmIpDiv = button.closest('.atm-ip-details');
            // Don't allow removing the first ATM IP
            if (!atmIpDiv.classList.contains('first-atm-ip')) {
                atmIpDiv.remove();
                
                // Reindex remaining ATM IPs
                const atmIps = document.querySelectorAll('.atm-ip-details:not(.first-atm-ip)');
                atmIps.forEach((atmIp, index) => {
                    atmIp.dataset.index = index + 1;
                });
                // Update ATM count
                atmCount = atmIps.length;
            }
        }

        // Toggle ATM section visibility
        function toggleAtmSection() {
            const atmContainer = document.getElementById('atmContainer');
            const hasAtmYes = document.querySelector('input[name="hasAtm"][value="yes"]');
            const hasAtmNo = document.querySelector('input[name="hasAtm"][value="no"]');
            
            if (hasAtmYes && hasAtmYes.checked) {
                atmContainer.classList.remove('hidden');
                // Make all ATM IP fields required
                const atmIpInputs = document.querySelectorAll('input[name="atmIp[]"]');
                atmIpInputs.forEach(input => {
                    input.required = true;
                });
                // Enable ATM Machine Room fields
                enableAtmMachineRoomFields();
            } else if (hasAtmNo && hasAtmNo.checked) {
                atmContainer.classList.add('hidden');
                // Make all ATM IP fields not required and clear values
                const atmIpInputs = document.querySelectorAll('input[name="atmIp[]"]');
                atmIpInputs.forEach(input => {
                    input.required = false;
                    input.value = '';
                });
                // Remove all additional ATM IPs (keep only the first one)
                const additionalAtmIps = document.querySelectorAll('.atm-ip-details:not(.first-atm-ip)');
                additionalAtmIps.forEach(ip => ip.remove());
                // Reset ATM count
                atmCount = 0;
                // Disable ATM Machine Room fields and set to Not Applicable
                disableAtmMachineRoomFields();
            }
        }

        // Enable ATM Machine Room fields
        function enableAtmMachineRoomFields() {
            const atmFields = document.querySelectorAll('.atm-field');
            atmFields.forEach(field => {
                field.disabled = false;
                field.style.opacity = '1';
                field.style.cursor = 'pointer';
            });
        }

        // Disable ATM Machine Room fields and set to Not Applicable
        function disableAtmMachineRoomFields() {
            const atmFields = document.querySelectorAll('.atm-field');
            atmFields.forEach(field => {
                field.disabled = true;
                field.value = 'Not Applicable';
                field.style.opacity = '0.6';
                field.style.cursor = 'not-allowed';
            });
        }

        // Toggle CCTV Camera Number Field
        function toggleCctvNumberField() {
            const cctvSelect = document.getElementById('cctvCameraPresent');
            const cctvNumberField = document.getElementById('cctvNumberField');
            const cctvNumberInput = document.getElementById('cctvCameraNumber');
            
            if (cctvSelect.value === 'Compliance') {
                cctvNumberField.style.display = 'block';
                cctvNumberInput.required = true;
            } else {
                cctvNumberField.style.display = 'none';
                cctvNumberInput.required = false;
                cctvNumberInput.value = '';
            }
        }

        // Toggle Locker CCTV Camera Number Field
        function toggleLockerCctvNumberField() {
            const lockerCctvSelect = document.getElementById('branchLockerCctv');
            const lockerCctvNumberField = document.getElementById('lockerCctvNumberField');
            const lockerCctvNumberInput = document.getElementById('branchLockerCctvNumber');
            
            if (lockerCctvSelect.value === 'Compliance') {
                lockerCctvNumberField.style.display = 'block';
                lockerCctvNumberInput.required = true;
            } else {
                lockerCctvNumberField.style.display = 'none';
                lockerCctvNumberInput.required = false;
                lockerCctvNumberInput.value = '';
            }
        }

        // Toggle Antivirus Available Field
        function toggleAntivirusAvailableField() {
            const antivirusSelect = document.getElementById('antivirusAvailable');
            const antivirusField = document.getElementById('antivirusAvailableField');
            const antivirusTextarea = document.getElementById('antivirusAvailableIps');
            
            if (antivirusSelect.value === 'Non-Compliance') {
                antivirusField.style.display = 'block';
                antivirusTextarea.required = true;
            } else {
                antivirusField.style.display = 'none';
                antivirusTextarea.required = false;
                antivirusTextarea.value = '';
            }
        }

        // Toggle Antivirus Updated Field
        function toggleAntivirusUpdatedField() {
            const antivirusSelect = document.getElementById('antivirusUpdated');
            const antivirusField = document.getElementById('antivirusUpdatedField');
            const antivirusTextarea = document.getElementById('antivirusUpdatedIps');
            
            if (antivirusSelect.value === 'Non-Compliance') {
                antivirusField.style.display = 'block';
                antivirusTextarea.required = true;
            } else {
                antivirusField.style.display = 'none';
                antivirusTextarea.required = false;
                antivirusTextarea.value = '';
            }
        }

        // Toggle Windows Patch Field
        function toggleWindowsPatchField() {
            const windowsSelect = document.getElementById('windowsPatchUpdated');
            const windowsField = document.getElementById('windowsPatchField');
            const windowsTextarea = document.getElementById('windowsPatchIps');
            
            if (windowsSelect.value === 'Non-Compliance') {
                windowsField.style.display = 'block';
                windowsTextarea.required = true;
            } else {
                windowsField.style.display = 'none';
                windowsTextarea.required = false;
                windowsTextarea.value = '';
            }
        }

        // Toggle Outdated Windows Field
        function toggleOutdatedWindowsField() {
            const windowsSelect = document.getElementById('outdatedWindowsVersion');
            const windowsField = document.getElementById('outdatedWindowsField');
            const windowsTextarea = document.getElementById('outdatedWindowsIps');
            
            if (windowsSelect.value === 'Non-Compliance') {
                windowsField.style.display = 'block';
                windowsTextarea.required = true;
            } else {
                windowsField.style.display = 'none';
                windowsTextarea.required = false;
                windowsTextarea.value = '';
            }
        }

        // Toggle Expired License Field
        function toggleExpiredLicenseField() {
            const licenseSelect = document.getElementById('expiredLicenseAntivirus');
            const licenseField = document.getElementById('expiredLicenseField');
            const licenseTextarea = document.getElementById('expiredLicenseIps');
            
            if (licenseSelect.value === 'Non-Compliance') {
                licenseField.style.display = 'block';
                licenseTextarea.required = true;
            } else {
                licenseField.style.display = 'none';
                licenseTextarea.required = false;
                licenseTextarea.value = '';
            }
        }

        // Toggle Admin Rights Field
        function toggleAdminRightsField() {
            const adminSelect = document.getElementById('adminRightsLogin');
            const adminField = document.getElementById('adminRightsField');
            const adminTextarea = document.getElementById('adminRightsIps');
            
            if (adminSelect.value === 'Non-Compliance') {
                adminField.style.display = 'block';
                adminTextarea.required = true;
            } else {
                adminField.style.display = 'none';
                adminTextarea.required = false;
                adminTextarea.value = '';
            }
        }

        // Toggle Group Policy Field
        function toggleGroupPolicyField() {
            const groupSelect = document.getElementById('groupPolicyModification');
            const groupField = document.getElementById('groupPolicyField');
            const groupTextarea = document.getElementById('groupPolicyIps');
            
            if (groupSelect.value === 'Non-Compliance') {
                groupField.style.display = 'block';
                groupTextarea.required = true;
            } else {
                groupField.style.display = 'none';
                groupTextarea.required = false;
                groupTextarea.value = '';
            }
        }

        // Toggle Security Config Field
        function toggleSecurityConfigField() {
            const securitySelect = document.getElementById('securityConfigModification');
            const securityField = document.getElementById('securityConfigField');
            const securityTextarea = document.getElementById('securityConfigIps');
            
            if (securitySelect.value === 'Non-Compliance') {
                securityField.style.display = 'block';
                securityTextarea.required = true;
            } else {
                securityField.style.display = 'none';
                securityTextarea.required = false;
                securityTextarea.value = '';
            }
        }

        // Toggle Proxy Field
        function toggleProxyField() {
            const proxySelect = document.getElementById('proxyModification');
            const proxyField = document.getElementById('proxyField');
            const proxyTextarea = document.getElementById('proxyIps');
            
            if (proxySelect.value === 'Non-Compliance') {
                proxyField.style.display = 'block';
                proxyTextarea.required = true;
            } else {
                proxyField.style.display = 'none';
                proxyTextarea.required = false;
                proxyTextarea.value = '';
            }
        }

        // Toggle System Tagging Field
        function toggleSystemTaggingField() {
            const taggingSelect = document.getElementById('systemTagging');
            const taggingField = document.getElementById('systemTaggingField');
            const taggingTextarea = document.getElementById('systemTaggingIps');
            
            if (taggingSelect.value === 'Non-Compliance') {
                taggingField.style.display = 'block';
                taggingTextarea.required = true;
            } else {
                taggingField.style.display = 'none';
                taggingTextarea.required = false;
                taggingTextarea.value = '';
            }
        }

        // Toggle Firewall Enabled Field
        function toggleFirewallEnabledField() {
            const firewallSelect = document.getElementById('firewallEnabled');
            const firewallField = document.getElementById('firewallEnabledField');
            const firewallTextarea = document.getElementById('firewallEnabledIps');
            
            if (firewallSelect.value === 'Non-Compliance') {
                firewallField.style.display = 'block';
                firewallTextarea.required = true;
            } else {
                firewallField.style.display = 'none';
                firewallTextarea.required = false;
                firewallTextarea.value = '';
            }
        }

        // Toggle RDP Field
        function toggleRdpField() {
            const rdpSelect = document.getElementById('rdpEnabled');
            const rdpField = document.getElementById('rdpField');
            const rdpTextarea = document.getElementById('rdpIps');
            
            if (rdpSelect.value === 'Non-Compliance') {
                rdpField.style.display = 'block';
                rdpTextarea.required = true;
            } else {
                rdpField.style.display = 'none';
                rdpTextarea.required = false;
                rdpTextarea.value = '';
            }
        }

        // Toggle Unauthorized Applications Field
        function toggleUnauthorizedAppsField() {
            const unauthorizedSelect = document.getElementById('unauthorizedApplications');
            const unauthorizedField = document.getElementById('unauthorizedAppsField');
            const unauthorizedIpsTextarea = document.getElementById('unauthorizedAppsIps');
            const unauthorizedNamesTextarea = document.getElementById('unauthorizedAppsNames');
            
            if (unauthorizedSelect.value === 'Non-Compliance') {
                unauthorizedField.style.display = 'block';
                unauthorizedIpsTextarea.required = true;
                unauthorizedNamesTextarea.required = true;
            } else {
                unauthorizedField.style.display = 'none';
                unauthorizedIpsTextarea.required = false;
                unauthorizedNamesTextarea.required = false;
                unauthorizedIpsTextarea.value = '';
                unauthorizedNamesTextarea.value = '';
            }
        }

        // Toggle Personal Data Field
        function togglePersonalDataField() {
            const personalDataSelect = document.getElementById('personalDataPresent');
            const personalDataField = document.getElementById('personalDataField');
            const personalDataTextarea = document.getElementById('personalDataIps');
            
            if (personalDataSelect.value === 'Non-Compliance') {
                personalDataField.style.display = 'block';
                personalDataTextarea.required = true;
            } else {
                personalDataField.style.display = 'none';
                personalDataTextarea.required = false;
                personalDataTextarea.value = '';
            }
        }

        // Toggle Windows Activated Field
        function toggleWindowsActivatedField() {
            const windowsSelect = document.getElementById('windowsNotActivated');
            const windowsField = document.getElementById('windowsActivatedField');
            const windowsTextarea = document.getElementById('windowsNotActivatedIps');
            
            if (windowsSelect.value === 'Non-Compliance') {
                windowsField.style.display = 'block';
                windowsTextarea.required = true;
            } else {
                windowsField.style.display = 'none';
                windowsTextarea.required = false;
                windowsTextarea.value = '';
            }
        }

        // Toggle Password Browser Field
        function togglePasswordBrowserField() {
            const passwordSelect = document.getElementById('passwordSavedInBrowser');
            const passwordField = document.getElementById('passwordBrowserField');
            const passwordTextarea = document.getElementById('passwordBrowserIps');
            
            if (passwordSelect.value === 'Non-Compliance') {
                passwordField.style.display = 'block';
                passwordTextarea.required = true;
            } else {
                passwordField.style.display = 'none';
                passwordTextarea.required = false;
                passwordTextarea.value = '';
            }
        }

        // File validation for Branch Excel With POC modal
        document.addEventListener('DOMContentLoaded', function() {
            const excelFileInput = document.getElementById('excelFile');
            const zipFileInput = document.getElementById('zipFile');
            
            if (excelFileInput) {
                excelFileInput.addEventListener('change', function() {
                    validateFileType(this, ['.xlsx', '.xls'], 'Excel file');
                });
            }
            
            if (zipFileInput) {
                zipFileInput.addEventListener('change', function() {
                    validateFileType(this, ['.zip'], 'ZIP file');
                });
            }
        });

        function validateFileType(input, allowedExtensions, fileTypeName) {
            const file = input.files[0];
            if (file) {
                const fileName = file.name.toLowerCase();
                const isValid = allowedExtensions.some(ext => fileName.endsWith(ext));
                
                if (!isValid) {
                    alert(`Please select a valid ${fileTypeName}. Allowed formats: ${allowedExtensions.join(', ')}`);
                    input.value = '';
                    return false;
                }
            }
            return true;
        }
        
        // Handle Branch Excel With POC form submission using fetch to avoid premature page refresh
        function handleBranchExcelWithPOCSubmit(event) {
            event.preventDefault();

            const form = document.getElementById('branchExcelWithPOCForm');
            const submitBtn = document.getElementById('branchExcelSubmitBtn');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            const formData = new FormData(form);

            fetch('/process_branch_excel_with_poc', {
                method: 'POST',
                body: formData,
                credentials: 'include'
            })
            .then(response => {
                // Check for 413 error (Request Entity Too Large) before checking response.ok
                if (response.status === 413) {
                    throw new Error('FILE_TOO_LARGE');
                }
                
                if (!response.ok) {
                    // Try to get error message from response
                    return response.text().then(text => {
                        throw new Error(`HTTP ${response.status}: ${text}`);
                    });
                }

                const contentDisposition = response.headers.get('content-disposition');
                let downloadName = 'Branch Excel With POC.xlsx';

                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename[^;]*=([^;]*)/i);
                    if (filenameMatch) {
                        const extracted = filenameMatch[1].trim().replace(/^["']|["']$/g, '');
                        if (extracted) {
                            downloadName = extracted;
                        }
                    }
                }

                return response.blob().then(blob => ({
                    blob,
                    downloadName
                }));
            })
            .then(({ blob, downloadName }) => {
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = downloadName;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);

                handleDownloadComplete(submitBtn, originalText, true);
            })
            .catch(error => {
                console.error('Error processing Branch Excel With POC:', error);
                
                // Handle specific error types
                if (error.message === 'FILE_TOO_LARGE' || error.message.includes('413') || error.message.includes('Request Entity Too Large')) {
                    alert('File size too large! The maximum file size is 1GB. Please compress your ZIP file or split it into smaller files. If the file is still too large, consider using image compression tools to reduce the size of images in the ZIP file.');
                } else if (error.message.includes('Network response was not ok')) {
                    // Try to get more details from the error
                    alert('An error occurred while uploading the file. Please check:\n1. File size is under 1GB\n2. Your internet connection is stable\n3. Try again after a few moments');
                } else {
                    alert('An error occurred while generating the report. Please try again.\n\nError: ' + error.message);
                }
                
                handleDownloadComplete(submitBtn, originalText, false);
            });
        }
        
        // Handle download completion
        function handleDownloadComplete(submitBtn, originalText, shouldReload = false) {
            // Reset button state
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('branchExcelWithPOCModal');
            } catch (e) {
                console.log('Could not close modal:', e);
            }
            
            if (shouldReload) {
                setTimeout(() => {
                    window.location.reload();
                }, 500);
            }
        }
        
        // Handle Combine Branch Excel Without POC form submission with page refresh
        function handleCombineBranchExcelWithoutPOCSubmit(event) {
            console.log('Combine form submission started');
            event.preventDefault(); // Prevent default form submission
            
            // Show loading state
            const submitBtn = document.getElementById('combineBranchExcelSubmitBtn');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            // Get form data
            const form = document.getElementById('combineBranchExcelWithoutPOCForm');
            const formData = new FormData(form);
            
            console.log('Submitting form with fetch...');
            
            // Submit form using fetch
            fetch('/combine_branch_excel_without_poc', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Response received:', response);
                
                if (response.ok) {
                    // Check if response is a file download
                    const contentType = response.headers.get('content-type');
                    const contentDisposition = response.headers.get('content-disposition');
                    
                    console.log('Content-Type:', contentType);
                    console.log('Content-Disposition:', contentDisposition);
                    
                    if (contentDisposition && contentDisposition.includes('attachment')) {
                        console.log('File download detected, processing...');
                        
                        // Get filename from content-disposition header
                        const filenameMatch = contentDisposition.match(/filename="(.+)"/);
                        const filename = filenameMatch ? filenameMatch[1] : 'Branch_Excel_Without_Evidence.xlsx';
                        
                        // Create download link
                        response.blob().then(blob => {
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.style.display = 'none';
                            a.href = url;
                            a.download = filename;
                            document.body.appendChild(a);
                            a.click();
                            window.URL.revokeObjectURL(url);
                            document.body.removeChild(a);
                            
                            console.log('File download initiated');
                            handleCombineDownloadComplete(submitBtn, originalText);
                        });
                    } else {
                        console.log('No file download detected, checking response...');
                        return response.text().then(text => {
                            console.log('Response text:', text);
                            handleCombineDownloadComplete(submitBtn, originalText);
                        });
                    }
                } else {
                    console.error('Response not OK:', response.status);
                    handleCombineDownloadComplete(submitBtn, originalText);
                }
            })
            .catch(error => {
                console.error('Fetch error:', error);
                handleCombineDownloadComplete(submitBtn, originalText);
            });
        }
        
        // Handle combine download completion
        function handleCombineDownloadComplete(submitBtn, originalText) {
            console.log('Combine download completion triggered');
            
            // Reset button state
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('combineBranchExcelWithoutPOCModal');
                console.log('Modal closed successfully');
            } catch (e) {
                console.log('Could not close modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }
        
        // Handle Combine Branch Excel With POC form submission with page refresh
        function handleCombineBranchExcelWithPOCSubmit(event) {
            console.log('Combine With POC form submission started');
            event.preventDefault(); // Prevent default form submission
            
            // Show loading state
            const submitBtn = document.getElementById('combineBranchExcelWithPOCSubmitBtn');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            // Get form data
            const form = document.getElementById('combineBranchExcelWithPOCForm');
            const formData = new FormData(form);
            
            console.log('Submitting form with fetch...');
            
            // Submit form using fetch
            fetch('/combine_branch_excel_with_poc', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Response received:', response);
                
                if (response.ok) {
                    // Check if response is a file download
                    const contentType = response.headers.get('content-type');
                    const contentDisposition = response.headers.get('content-disposition');
                    
                    console.log('Content-Type:', contentType);
                    console.log('Content-Disposition:', contentDisposition);
                    
                    if (contentDisposition && contentDisposition.includes('attachment')) {
                        console.log('File download detected, processing...');
                        
                        // Get filename from content-disposition header
                        const filenameMatch = contentDisposition.match(/filename="(.+)"/);
                        const filename = filenameMatch ? filenameMatch[1] : 'Branch_Excel_With_Evidence.xlsx';
                        
                        // Create download link
                        response.blob().then(blob => {
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.style.display = 'none';
                            a.href = url;
                            a.download = filename;
                            document.body.appendChild(a);
                            a.click();
                            window.URL.revokeObjectURL(url);
                            document.body.removeChild(a);
                            
                            console.log('File download initiated');
                            handleCombineWithPOCDownloadComplete(submitBtn, originalText);
                        });
                    } else {
                        console.log('No file download detected, checking response...');
                        return response.text().then(text => {
                            console.log('Response text:', text);
                            handleCombineWithPOCDownloadComplete(submitBtn, originalText);
                        });
                    }
                } else {
                    console.error('Response not OK:', response.status);
                    handleCombineWithPOCDownloadComplete(submitBtn, originalText);
                }
            })
            .catch(error => {
                console.error('Fetch error:', error);
                handleCombineWithPOCDownloadComplete(submitBtn, originalText);
            });
        }
        
        // Handle combine With POC download completion
        function handleCombineWithPOCDownloadComplete(submitBtn, originalText) {
            console.log('Combine With POC download completion triggered');
            
            // Reset button state
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('combineBranchExcelWithPOCModal');
                console.log('Modal closed successfully');
            } catch (e) {
                console.log('Could not close modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }
        
        // Handle Network Review form submission with page refresh
        function handleNetworkReviewSubmit(event) {
            console.log('Network Review form submission started');
            event.preventDefault(); // Prevent default form submission
            
            // Show loading state
            const submitBtn = document.querySelector('#networkReviewQuestionsForm button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            // Get form data
            const form = document.getElementById('networkReviewQuestionsForm');
            const formData = new FormData(form);
            
            console.log('Submitting Network Review form with fetch...');
            
            // Submit form using fetch
            fetch('/generate_network_review_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Response received:', response);
                
                if (response.ok) {
                    // Check if response is a file download
                    const contentType = response.headers.get('content-type');
                    const contentDisposition = response.headers.get('content-disposition');
                    
                    console.log('Content-Type:', contentType);
                    console.log('Content-Disposition:', contentDisposition);
                    
                    if (contentDisposition && contentDisposition.includes('attachment')) {
                        console.log('File download detected, processing...');
                        
                        // Get filename from content-disposition header
                        const filenameMatch = contentDisposition.match(/filename="(.+)"/);
                        const filename = filenameMatch ? filenameMatch[1] : 'Network Review.xlsx';
                        
                        // Create download link
                        response.blob().then(blob => {
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.style.display = 'none';
                            a.href = url;
                            a.download = filename;
                            document.body.appendChild(a);
                            a.click();
                            window.URL.revokeObjectURL(url);
                            document.body.removeChild(a);
                            
                            console.log('File download initiated');
                            handleNetworkReviewDownloadComplete(submitBtn, originalText);
                        });
                    } else {
                        console.log('No file download detected, checking response...');
                        return response.text().then(text => {
                            console.log('Response text:', text);
                            handleNetworkReviewDownloadComplete(submitBtn, originalText);
                        });
                    }
                } else {
                    console.error('Response not OK:', response.status);
                    handleNetworkReviewDownloadComplete(submitBtn, originalText);
                }
            })
            .catch(error => {
                console.error('Fetch error:', error);
                handleNetworkReviewDownloadComplete(submitBtn, originalText);
            });
        }
        
        // Handle Network Review download completion
        function handleNetworkReviewDownloadComplete(submitBtn, originalText) {
            console.log('Network Review download completion triggered');
            
            // Reset button state
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('networkReviewQuestionsModal');
                console.log('Modal closed successfully');
            } catch (e) {
                console.log('Could not close modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }
        
        // Handle Data Centre form submission with page refresh
        function handleDataCentreSubmit(event) {
            console.log('Data Centre form submission started');
            event.preventDefault(); // Prevent default form submission
            
            // Show loading state
            const submitBtn = document.querySelector('#dataCentreQuestionsForm button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            // Get form data
            const form = document.getElementById('dataCentreQuestionsForm');
            const formData = new FormData(form);
            
            console.log('Submitting Data Centre form with fetch...');
            
            // Submit form using fetch
            fetch('/generate_data_centre_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Response received:', response);
                
                if (response.ok) {
                    // Check if response is a file download
                    const contentType = response.headers.get('content-type');
                    const contentDisposition = response.headers.get('content-disposition');
                    
                    console.log('Content-Type:', contentType);
                    console.log('Content-Disposition:', contentDisposition);
                    
                    if (contentDisposition && contentDisposition.includes('attachment')) {
                        console.log('File download detected, processing...');
                        
                        // Get filename from content-disposition header
                        const filenameMatch = contentDisposition.match(/filename="(.+)"/);
                        const filename = filenameMatch ? filenameMatch[1] : 'Data Centre Review.xlsx';
                        
                        // Create download link
                        response.blob().then(blob => {
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.style.display = 'none';
                            a.href = url;
                            a.download = filename;
                            document.body.appendChild(a);
                            a.click();
                            window.URL.revokeObjectURL(url);
                            document.body.removeChild(a);
                            
                            console.log('File download initiated');
                            handleDataCentreDownloadComplete(submitBtn, originalText);
                        });
                    } else {
                        console.log('No file download detected, checking response...');
                        return response.text().then(text => {
                            console.log('Response text:', text);
                            handleDataCentreDownloadComplete(submitBtn, originalText);
                        });
                    }
                } else {
                    console.error('Response not OK:', response.status);
                    handleDataCentreDownloadComplete(submitBtn, originalText);
                }
            })
            .catch(error => {
                console.error('Fetch error:', error);
                handleDataCentreDownloadComplete(submitBtn, originalText);
            });
        }
        
        // Handle Data Centre download completion
        function handleDataCentreDownloadComplete(submitBtn, originalText) {
            console.log('Data Centre download completion triggered');
            
            // Reset button state
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('dataCentreQuestionsModal');
                console.log('Modal closed successfully');
            } catch (e) {
                console.log('Could not close modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }
        
        // Handle Disaster Recovery form submission
        function handleDisasterRecoverySubmit(event) {
            console.log('Disaster Recovery form submission started');
            event.preventDefault(); // Prevent default form submission
            
            // Show loading state
            const submitBtn = document.querySelector('#disasterRecoveryQuestionsForm button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Excel...';
            submitBtn.disabled = true;
            
            // Get form data
            const formData = new FormData(event.target);
            
            // Submit form data
            fetch('/generate_disaster_recovery_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Disaster Recovery response received:', response);
                if (response.ok) {
                    console.log('Disaster Recovery response OK, checking for file download...');
                    
                    // Check if response is a file download
                    const contentType = response.headers.get('content-type');
                    console.log('Content-Type:', contentType);
                    
                    if (contentType && contentType.includes('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')) {
                        console.log('File download detected, processing...');
                        // Extract filename from Content-Disposition header
                        const contentDisposition = response.headers.get('Content-Disposition');
                        let filename = 'Disaster Recovery Review.xlsx';
                        if (contentDisposition) {
                            const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                            if (filenameMatch) {
                                filename = filenameMatch[1];
                            }
                        }
                        return response.blob().then(blob => {
                            console.log('Blob created, size:', blob.size);
                            
                            // Create download link
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.href = url;
                            a.download = filename;
                            document.body.appendChild(a);
                            a.click();
                            window.URL.revokeObjectURL(url);
                            document.body.removeChild(a);
                            
                            console.log('File download initiated');
                            handleDisasterRecoveryDownloadComplete(submitBtn, originalText);
                        });
                    } else {
                        console.log('No file download detected, checking response...');
                        return response.text().then(text => {
                            console.log('Response text:', text);
                            handleDisasterRecoveryDownloadComplete(submitBtn, originalText);
                        });
                    }
                } else {
                    console.error('Response not OK:', response.status);
                    handleDisasterRecoveryDownloadComplete(submitBtn, originalText);
                }
            })
            .catch(error => {
                console.error('Fetch error:', error);
                handleDisasterRecoveryDownloadComplete(submitBtn, originalText);
            });
        }
        
        // Handle Disaster Recovery download completion
        function handleDisasterRecoveryDownloadComplete(submitBtn, originalText) {
            console.log('Disaster Recovery download completion triggered');
            
            // Reset button state
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('disasterRecoveryQuestionsModal');
                console.log('Modal closed successfully');
            } catch (e) {
                console.log('Could not close modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Handle Firewall form submission
        function handleFirewallSubmit(event) {
            console.log('Firewall form submission started');
            event.preventDefault(); // Prevent default form submission
            
            // Show loading state
            const submitBtn = document.querySelector('#firewallQuestionsForm button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Excel...';
            submitBtn.disabled = true;
            
            // Get form data
            const formData = new FormData(event.target);
            console.log('Form data collected:', formData);
            
            // Submit form data
            fetch('/generate_firewall_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Firewall response received:', response);
                if (response.ok) {
                    console.log('Firewall response OK, checking for file download...');
                    
                    // Check if response is a file download
                    const contentType = response.headers.get('content-type');
                    console.log('Content-Type:', contentType);
                    
                    if (contentType && contentType.includes('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')) {
                        console.log('File download detected, processing...');
                        // Extract filename from Content-Disposition header
                        const contentDisposition = response.headers.get('Content-Disposition');
                        let filename = 'Firewall Review.xlsx';
                        if (contentDisposition) {
                            const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                            if (filenameMatch) {
                                filename = filenameMatch[1];
                            }
                        }
                        return response.blob().then(blob => {
                            console.log('Blob created, size:', blob.size);
                            
                            // Create download link
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.href = url;
                            a.download = filename;
                            a.style.display = 'none';
                            document.body.appendChild(a);
                            
                            // Trigger download
                            console.log('Triggering download...');
                            a.click();
                            
                            // Clean up
                            setTimeout(() => {
                                window.URL.revokeObjectURL(url);
                                document.body.removeChild(a);
                                console.log('Download cleanup completed');
                            }, 100);
                            
                            console.log('File download initiated');
                            handleFirewallDownloadComplete(submitBtn, originalText);
                        });
                    } else {
                        console.log('No file download detected, trying alternative download method...');
                        // Extract filename from Content-Disposition header
                        const contentDisposition2 = response.headers.get('Content-Disposition');
                        let filename2 = 'Firewall Review.xlsx';
                        if (contentDisposition2) {
                            const filenameMatch = contentDisposition2.match(/filename="([^"]+)"/);
                            if (filenameMatch) {
                                filename2 = filenameMatch[1];
                            }
                        }
                        return response.blob().then(blob => {
                            console.log('Alternative blob created, size:', blob.size);
                            
                            // Try alternative download method
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.href = url;
                            a.download = filename2;
                            a.style.display = 'none';
                            document.body.appendChild(a);
                            a.click();
                            
                            setTimeout(() => {
                                window.URL.revokeObjectURL(url);
                                document.body.removeChild(a);
                            }, 100);
                            
                            handleFirewallDownloadComplete(submitBtn, originalText);
                        });
                    }
                } else {
                    console.error('Response not OK:', response.status);
                    handleFirewallDownloadComplete(submitBtn, originalText);
                }
            })
            .catch(error => {
                console.error('Fetch error:', error);
                alert('Error generating Excel file: ' + error.message);
                handleFirewallDownloadComplete(submitBtn, originalText);
            });
        }
        
        // Handle Firewall download completion
        function handleFirewallDownloadComplete(submitBtn, originalText) {
            console.log('Firewall download completion triggered');
            
            // Reset button state
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('firewallQuestionsModal');
                console.log('Modal closed successfully');
            } catch (e) {
                console.log('Could not close modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Handle Core Switch form submission
        function handleCoreSwitchSubmit(event) {
            console.log('Core Switch form submission started');
            event.preventDefault(); // Prevent default form submission
            
            // Show loading state
            const submitBtn = document.querySelector('#coreSwitchQuestionsForm button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Excel...';
            submitBtn.disabled = true;
            
            // Collect form data
            const formData = new FormData(event.target);
            const formDataObj = {};
            for (let [key, value] of formData.entries()) {
                formDataObj[key] = value;
            }
            
            console.log('Form data collected:', formDataObj);
            
            // Submit form data
            fetch('/generate_core_switch_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Response received:', response);
                if (response.ok) {
                    const contentType = response.headers.get('content-type');
                    console.log('Content type:', contentType);
                    
                    // Extract filename from Content-Disposition header (once, before branching)
                    const contentDisposition = response.headers.get('Content-Disposition');
                    let filename = 'Core Switch Review.xlsx';
                    if (contentDisposition) {
                        const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                        if (filenameMatch) {
                            filename = filenameMatch[1];
                        }
                    }
                    
                    if (contentType && contentType.includes('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')) {
                        console.log('Excel file detected, starting download...');
                        return response.blob().then(blob => {
                            console.log('Blob created, size:', blob.size);
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.style.display = 'none';
                            a.href = url;
                            a.download = filename;
                            document.body.appendChild(a);
                            a.click();
                            window.URL.revokeObjectURL(url);
                            document.body.removeChild(a);
                            
                            handleCoreSwitchDownloadComplete(submitBtn, originalText);
                        });
                    } else {
                        console.log('No file download detected, trying alternative download method...');
                        return response.blob().then(blob => {
                            console.log('Alternative blob created, size:', blob.size);
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.style.display = 'none';
                            a.href = url;
                            a.download = filename;
                            document.body.appendChild(a);
                            a.click();
                            window.URL.revokeObjectURL(url);
                            document.body.removeChild(a);
                            
                            handleCoreSwitchDownloadComplete(submitBtn, originalText);
                        });
                    }
                } else {
                    console.error('Response not OK:', response.status);
                    handleCoreSwitchDownloadComplete(submitBtn, originalText);
                }
            })
            .catch(error => {
                console.error('Fetch error:', error);
                alert('Error generating Excel file: ' + error.message);
                handleCoreSwitchDownloadComplete(submitBtn, originalText);
            });
        }

        // Handle Core Switch download completion
        function handleCoreSwitchDownloadComplete(submitBtn, originalText) {
            console.log('Core Switch download completion triggered');
            
            // Reset button state
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('coreSwitchQuestionsModal');
                console.log('Modal closed successfully');
            } catch (e) {
                console.log('Could not close modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Router form submission handler
        function handleRouterSubmit(event) {
            event.preventDefault();
            console.log('Router form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Router form data:', Object.fromEntries(formData));
            
            fetch('/generate_router_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Router response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Router Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Router blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Router file download initiated');
                setTimeout(() => {
                    handleRouterDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Router Error:', error);
                alert('Error generating Router report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleRouterDownloadComplete() {
            console.log('Router download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#routerQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('routerQuestionsModal');
                console.log('Router modal closed successfully');
            } catch (e) {
                console.log('Could not close Router modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Domain Controller form submission handler
        function handleDomainControllerSubmit(event) {
            event.preventDefault();
            console.log('Domain Controller form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Domain Controller form data:', Object.fromEntries(formData));
            
            fetch('/generate_domain_controller_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Domain Controller response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Domain Controller AD Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Domain Controller blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Domain Controller file download initiated');
                setTimeout(() => {
                    handleDomainControllerDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Domain Controller Error:', error);
                alert('Error generating Domain Controller report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleDomainControllerDownloadComplete() {
            console.log('Domain Controller download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#domainControllerQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('domainControllerQuestionsModal');
                console.log('Domain Controller modal closed successfully');
            } catch (e) {
                console.log('Could not close Domain Controller modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // H2H Audit form submission handler
        function handleH2HSubmit(event) {
            event.preventDefault();
            console.log('H2H Audit form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('H2H Audit form data:', Object.fromEntries(formData));
            
            fetch('/generate_h2h_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('H2H Audit response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'H2H Audit Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('H2H Audit blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('H2H Audit file download initiated');
                setTimeout(() => {
                    handleH2HDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('H2H Audit Error:', error);
                alert('Error generating H2H Audit report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleH2HDownloadComplete() {
            console.log('H2H Audit download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#h2hQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('h2hQuestionsModal');
                console.log('H2H Audit modal closed successfully');
            } catch (e) {
                console.log('Could not close H2H Audit modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Antivirus form submission handler
        function handleAntivirusSubmit(event) {
            event.preventDefault();
            console.log('Antivirus form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Antivirus form data:', Object.fromEntries(formData));
            
            fetch('/generate_antivirus_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Antivirus response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Antivirus Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Antivirus blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Antivirus file download initiated');
                setTimeout(() => {
                    handleAntivirusDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Antivirus Error:', error);
                alert('Error generating Antivirus report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleAntivirusDownloadComplete() {
            console.log('Antivirus download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#antivirusQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('antivirusQuestionsModal');
                console.log('Antivirus modal closed successfully');
            } catch (e) {
                console.log('Could not close Antivirus modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // ATM form submission handler
        function handleATMSubmit(event) {
            event.preventDefault();
            console.log('ATM form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('ATM form data:', Object.fromEntries(formData));
            
            fetch('/generate_atm_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('ATM response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'ATM Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('ATM blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('ATM file download initiated');
                setTimeout(() => {
                    handleATMDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('ATM Error:', error);
                alert('Error generating ATM report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleATMDownloadComplete() {
            console.log('ATM download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#atmQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('atmQuestionsModal');
                console.log('ATM modal closed successfully');
            } catch (e) {
                console.log('Could not close ATM modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Mail and Messaging form submission handler
        function handleMailMessagingSubmit(event) {
            event.preventDefault();
            console.log('Mail and Messaging form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Mail and Messaging form data:', Object.fromEntries(formData));
            
            fetch('/generate_mail_messaging_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Mail and Messaging response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Mail and Messaging Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Mail and Messaging blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Mail and Messaging file download initiated');
                setTimeout(() => {
                    handleMailMessagingDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Mail and Messaging Error:', error);
                alert('Error generating Mail and Messaging report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleMailMessagingDownloadComplete() {
            console.log('Mail and Messaging download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#mailMessagingQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('mailMessagingQuestionsModal');
                console.log('Mail and Messaging modal closed successfully');
            } catch (e) {
                console.log('Could not close Mail and Messaging modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // HO Win_Server Logical Review form submission handler
        function handleHoWinServerSubmit(event) {
            event.preventDefault();
            console.log('HO Win_Server Logical Review form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('HO Win_Server Logical Review form data:', Object.fromEntries(formData));
            
            fetch('/generate_ho_win_server_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('HO Win_Server Logical Review response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'HO Win Server Logical Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('HO Win_Server Logical Review blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('HO Win_Server Logical Review file download initiated');
                setTimeout(() => {
                    handleHoWinServerDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('HO Win_Server Logical Review Error:', error);
                alert('Error generating HO Win_Server Logical Review report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleHoWinServerDownloadComplete() {
            console.log('HO Win_Server Logical Review download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#hoWinServerQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('hoWinServerQuestionsModal');
                console.log('HO Win_Server Logical Review modal closed successfully');
            } catch (e) {
                console.log('Could not close HO Win_Server Logical Review modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Linux Server Logical Review form submission handler
        function handleLinuxServerSubmit(event) {
            event.preventDefault();
            console.log('Linux Server Logical Review form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Linux Server Logical Review form data:', Object.fromEntries(formData));
            
            fetch('/generate_linux_server_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Linux Server Logical Review response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Linux Server Logical Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Linux Server Logical Review blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Linux Server Logical Review file download initiated');
                setTimeout(() => {
                    handleLinuxServerDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Linux Server Logical Review Error:', error);
                alert('Error generating Linux Server Logical Review report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleLinuxServerDownloadComplete() {
            console.log('Linux Server Logical Review download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#linuxServerQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('linuxServerQuestionsModal');
                console.log('Linux Server Logical Review modal closed successfully');
            } catch (e) {
                console.log('Could not close Linux Server Logical Review modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // ESXi Server Logical Review form submission handler
        function handleESXiServerSubmit(event) {
            event.preventDefault();
            console.log('ESXi Server Logical Review form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('ESXi Server Logical Review form data:', Object.fromEntries(formData));
            
            fetch('/generate_esxi_server_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('ESXi Server Logical Review response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'ESXi Server Logical Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('ESXi Server Logical Review blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('ESXi Server Logical Review file download initiated');
                setTimeout(() => {
                    handleESXiServerDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('ESXi Server Logical Review Error:', error);
                alert('Error generating ESXi Server Logical Review report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleESXiServerDownloadComplete() {
            console.log('ESXi Server Logical Review download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#esxiServerQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('esxiServerQuestionsModal');
                console.log('ESXi Server Logical Review modal closed successfully');
            } catch (e) {
                console.log('Could not close ESXi Server Logical Review modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Access Control – OS Level form submission handler
        function handleAccessControlOSSubmit(event) {
            event.preventDefault();
            console.log('Access Control – OS Level form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Access Control – OS Level form data:', Object.fromEntries(formData));
            
            fetch('/generate_access_control_os_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Access Control – OS Level response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Access Control OS Level Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Access Control – OS Level blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Access Control – OS Level file download initiated');
                setTimeout(() => {
                    handleAccessControlOSDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Access Control – OS Level Error:', error);
                alert('Error generating Access Control – OS Level report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleAccessControlOSDownloadComplete() {
            console.log('Access Control – OS Level download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#accessControlOSQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('accessControlOSQuestionsModal');
                console.log('Access Control – OS Level modal closed successfully');
            } catch (e) {
                console.log('Could not close Access Control – OS Level modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Access Control Application form submission handler
        function handleAccessControlApplicationSubmit(event) {
            event.preventDefault();
            console.log('Access Control Application form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Access Control Application form data:', Object.fromEntries(formData));
            
            fetch('/generate_access_control_application_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Access Control Application response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Access Control Application Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Access Control Application blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Access Control Application file download initiated');
                setTimeout(() => {
                    handleAccessControlApplicationDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Access Control Application Error:', error);
                alert('Error generating Access Control Application report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleAccessControlApplicationDownloadComplete() {
            console.log('Access Control Application download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#accessControlApplicationQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('accessControlApplicationQuestionsModal');
                console.log('Access Control Application modal closed successfully');
            } catch (e) {
                console.log('Could not close Access Control Application modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Application form submission handler
        function handleApplicationSubmit(event) {
            event.preventDefault();
            console.log('Application form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Application form data:', Object.fromEntries(formData));
            
            fetch('/generate_application_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Application response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Application Review.xlsx';
                if (contentDisposition) {
                    // Try both quoted and unquoted filename formats
                    const filenameMatch = contentDisposition.match(/filename[^;]*=([^;]*)/);
                    if (filenameMatch) {
                        let extracted = filenameMatch[1].trim().replace(/^["']|["']$/g, '').trim();
                        if (extracted && extracted !== '') {
                            filename = extracted;
                        }
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Application blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Application file download initiated');
                setTimeout(() => {
                    handleApplicationDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Application Error:', error);
                alert('Error generating Application report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleApplicationDownloadComplete() {
            console.log('Application download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#applicationQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('applicationQuestionsModal');
                console.log('Application modal closed successfully');
            } catch (e) {
                console.log('Could not close Application modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Internet Banking form submission handler
        function handleInternetBankingSubmit(event) {
            event.preventDefault();
            console.log('Internet Banking form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Internet Banking form data:', Object.fromEntries(formData));
            
            fetch('/generate_internet_banking_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Internet Banking response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Internet Banking Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Internet Banking blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Internet Banking file download initiated');
                setTimeout(() => {
                    handleInternetBankingDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Internet Banking Error:', error);
                alert('Error generating Internet Banking report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleInternetBankingDownloadComplete() {
            console.log('Internet Banking download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#internetBankingQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('internetBankingQuestionsModal');
                console.log('Internet Banking modal closed successfully');
            } catch (e) {
                console.log('Could not close Internet Banking modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Internal Control Evaluation form submission handler
        function handleInternalControlSubmit(event) {
            event.preventDefault();
            console.log('Internal Control Evaluation form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Internal Control Evaluation form data:', Object.fromEntries(formData));
            
            fetch('/generate_internal_control_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Internal Control Evaluation response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Internal Control Evaluation Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Internal Control Evaluation blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Internal Control Evaluation file download initiated');
                setTimeout(() => {
                    handleInternalControlDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Internal Control Evaluation Error:', error);
                alert('Error generating Internal Control Evaluation report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleInternalControlDownloadComplete() {
            console.log('Internal Control Evaluation download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#internalControlQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('internalControlQuestionsModal');
                console.log('Internal Control Evaluation modal closed successfully');
            } catch (e) {
                console.log('Could not close Internal Control Evaluation modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Fire Protection form submission handler
        function handleFireProtectionSubmit(event) {
            event.preventDefault();
            console.log('Fire Protection form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Fire Protection form data:', Object.fromEntries(formData));
            
            fetch('/generate_fire_protection_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Fire Protection response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Fire Protection Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Fire Protection blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Fire Protection file download initiated');
                setTimeout(() => {
                    handleFireProtectionDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Fire Protection Error:', error);
                alert('Error generating Fire Protection report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleFireProtectionDownloadComplete() {
            console.log('Fire Protection download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#fireProtectionQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('fireProtectionQuestionsModal');
                console.log('Fire Protection modal closed successfully');
            } catch (e) {
                console.log('Could not close Fire Protection modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // AMC form submission handler
        function handleAMCSubmit(event) {
            event.preventDefault();
            console.log('AMC form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('AMC form data:', Object.fromEntries(formData));
            
            fetch('/generate_amc_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('AMC response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'AMC Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('AMC blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('AMC file download initiated');
                setTimeout(() => {
                    handleAMCDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('AMC Error:', error);
                alert('Error generating AMC report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleAMCDownloadComplete() {
            console.log('AMC download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#amcQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('amcQuestionsModal');
                console.log('AMC modal closed successfully');
            } catch (e) {
                console.log('Could not close AMC modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Data Input Controls form submission handler
        function handleDataInputControlSubmit(event) {
            event.preventDefault();
            console.log('Data Input Controls form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Data Input Controls form data:', Object.fromEntries(formData));
            
            fetch('/generate_data_input_control_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Data Input Controls response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Data Input Control Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Data Input Controls blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Data Input Controls file download initiated');
                setTimeout(() => {
                    handleDataInputControlDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Data Input Controls Error:', error);
                alert('Error generating Data Input Controls report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleDataInputControlDownloadComplete() {
            console.log('Data Input Controls download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#dataInputControlQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('dataInputControlQuestionsModal');
                console.log('Data Input Controls modal closed successfully');
            } catch (e) {
                console.log('Could not close Data Input Controls modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Purging of Data Files form submission handler
        function handlePurgingDataFilesSubmit(event) {
            event.preventDefault();
            console.log('Purging of Data Files form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Purging of Data Files form data:', Object.fromEntries(formData));
            
            fetch('/generate_purging_data_files_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Purging of Data Files response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Purging of Data Files Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Purging of Data Files blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Purging of Data Files file download initiated');
                setTimeout(() => {
                    handlePurgingDataFilesDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Purging of Data Files Error:', error);
                alert('Error generating Purging of Data Files report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handlePurgingDataFilesDownloadComplete() {
            console.log('Purging of Data Files download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#purgingDataFilesQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('purgingDataFilesQuestionsModal');
                console.log('Purging of Data Files modal closed successfully');
            } catch (e) {
                console.log('Could not close Purging of Data Files modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Business Continuity Planning form submission handler
        function handleBusinessContinuityPlanningSubmit(event) {
            event.preventDefault();
            console.log('Business Continuity Planning form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Business Continuity Planning form data:', Object.fromEntries(formData));
            
            fetch('/generate_business_continuity_planning_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Business Continuity Planning response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Business Continuity Planning Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Business Continuity Planning blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Business Continuity Planning file download initiated');
                setTimeout(() => {
                    handleBusinessContinuityPlanningDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Business Continuity Planning Error:', error);
                alert('Error generating Business Continuity Planning report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleBusinessContinuityPlanningDownloadComplete() {
            console.log('Business Continuity Planning download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#businessContinuityPlanningQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('businessContinuityPlanningQuestionsModal');
                console.log('Business Continuity Planning modal closed successfully');
            } catch (e) {
                console.log('Could not close Business Continuity Planning modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // In-house and Out-sourced form submission handler
        function handleInhouseOutsourcedSubmit(event) {
            event.preventDefault();
            console.log('In-house and Out-sourced form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('In-house and Out-sourced form data:', Object.fromEntries(formData));
            
            fetch('/generate_inhouse_outsourced_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('In-house and Out-sourced response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'In-house and Out-sourced Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('In-house and Out-sourced blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('In-house and Out-sourced file download initiated');
                setTimeout(() => {
                    handleInhouseOutsourcedDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('In-house and Out-sourced Error:', error);
                alert('Error generating In-house and Out-sourced report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleInhouseOutsourcedDownloadComplete() {
            console.log('In-house and Out-sourced download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#inhouseOutsourcedQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('inhouseOutsourcedQuestionsModal');
                console.log('In-house and Out-sourced modal closed successfully');
            } catch (e) {
                console.log('Could not close In-house and Out-sourced modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Audit Trail form submission handler
        function handleAuditTrailSubmit(event) {
            event.preventDefault();
            console.log('Audit Trail form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Audit Trail form data:', Object.fromEntries(formData));
            
            fetch('/generate_audit_trail_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Audit Trail response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Audit Trail Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Audit Trail blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Audit Trail file download initiated');
                setTimeout(() => {
                    handleAuditTrailDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Audit Trail Error:', error);
                alert('Error generating Audit Trail report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleAuditTrailDownloadComplete() {
            console.log('Audit Trail download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#auditTrailQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('auditTrailQuestionsModal');
                console.log('Audit Trail modal closed successfully');
            } catch (e) {
                console.log('Could not close Audit Trail modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Packaged Software form submission handler
        function handlePackagedSoftwareSubmit(event) {
            event.preventDefault();
            console.log('Packaged Software form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Packaged Software form data:', Object.fromEntries(formData));
            
            fetch('/generate_packaged_software_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Packaged Software response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Packaged Software Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Packaged Software blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Packaged Software file download initiated');
                setTimeout(() => {
                    handlePackagedSoftwareDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Packaged Software Error:', error);
                alert('Error generating Packaged Software report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handlePackagedSoftwareDownloadComplete() {
            console.log('Packaged Software download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#packagedSoftwareQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('packagedSoftwareQuestionsModal');
                console.log('Packaged Software modal closed successfully');
            } catch (e) {
                console.log('Could not close Packaged Software modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // User Account Maintenance form submission handler
        function handleUserAccountMaintenanceSubmit(event) {
            event.preventDefault();
            console.log('User Account Maintenance form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('User Account Maintenance form data:', Object.fromEntries(formData));
            
            fetch('/generate_user_account_maintenance_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('User Account Maintenance response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'User Account Maintenance Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('User Account Maintenance blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('User Account Maintenance file download initiated');
                setTimeout(() => {
                    handleUserAccountMaintenanceDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('User Account Maintenance Error:', error);
                alert('Error generating User Account Maintenance report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleUserAccountMaintenanceDownloadComplete() {
            console.log('User Account Maintenance download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#userAccountMaintenanceQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('userAccountMaintenanceQuestionsModal');
                console.log('User Account Maintenance modal closed successfully');
            } catch (e) {
                console.log('Could not close User Account Maintenance modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Logical Access Controls form submission handler
        function handleLogicalAccessControlsSubmit(event) {
            event.preventDefault();
            console.log('Logical Access Controls form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Logical Access Controls form data:', Object.fromEntries(formData));
            
            fetch('/generate_logical_access_controls_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Logical Access Controls response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Logical Access Controls Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Logical Access Controls blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Logical Access Controls file download initiated');
                setTimeout(() => {
                    handleLogicalAccessControlsDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Logical Access Controls Error:', error);
                alert('Error generating Logical Access Controls report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleLogicalAccessControlsDownloadComplete() {
            console.log('Logical Access Controls download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#logicalAccessControlsQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('logicalAccessControlsQuestionsModal');
                console.log('Logical Access Controls modal closed successfully');
            } catch (e) {
                console.log('Could not close Logical Access Controls modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Database Controls form submission handler
        function handleDatabaseControlsSubmit(event) {
            event.preventDefault();
            console.log('Database Controls form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Database Controls form data:', Object.fromEntries(formData));
            
            fetch('/generate_database_controls_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Database Controls response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Database Controls Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Database Controls blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Database Controls file download initiated');
                setTimeout(() => {
                    handleDatabaseControlsDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Database Controls Error:', error);
                alert('Error generating Database Controls report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleDatabaseControlsDownloadComplete() {
            console.log('Database Controls download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#databaseControlsQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('databaseControlsQuestionsModal');
                console.log('Database Controls modal closed successfully');
            } catch (e) {
                console.log('Could not close Database Controls modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Penetration Testing form submission handler
        function handlePenetrationTestingSubmit(event) {
            event.preventDefault();
            console.log('Penetration Testing form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Penetration Testing form data:', Object.fromEntries(formData));
            
            fetch('/generate_penetration_testing_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Penetration Testing response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Penetration Testing Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Penetration Testing blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Penetration Testing file download initiated');
                setTimeout(() => {
                    handlePenetrationTestingDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Penetration Testing Error:', error);
                alert('Error generating Penetration Testing report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handlePenetrationTestingDownloadComplete() {
            console.log('Penetration Testing download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#penetrationTestingQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('penetrationTestingQuestionsModal');
                console.log('Penetration Testing modal closed successfully');
            } catch (e) {
                console.log('Could not close Penetration Testing modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Training form submission handler
        function handleTrainingSubmit(event) {
            event.preventDefault();
            console.log('Training form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Training form data:', Object.fromEntries(formData));
            
            fetch('/generate_training_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Training response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Training Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Training blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Training file download initiated');
                setTimeout(() => {
                    handleTrainingDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Training Error:', error);
                alert('Error generating Training report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleTrainingDownloadComplete() {
            console.log('Training download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#trainingQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('trainingQuestionsModal');
                console.log('Training modal closed successfully');
            } catch (e) {
                console.log('Could not close Training modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Remote Access form submission handler
        function handleRemoteAccessSubmit(event) {
            event.preventDefault();
            console.log('Remote Access form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Remote Access form data:', Object.fromEntries(formData));
            
            fetch('/generate_remote_access_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Remote Access response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Remote Access Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Remote Access blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Remote Access file download initiated');
                setTimeout(() => {
                    handleRemoteAccessDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Remote Access Error:', error);
                alert('Error generating Remote Access report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleRemoteAccessDownloadComplete() {
            console.log('Remote Access download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#remoteAccessQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('remoteAccessQuestionsModal');
                console.log('Remote Access modal closed successfully');
            } catch (e) {
                console.log('Could not close Remote Access modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Power Supply form submission handler
        function handlePowerSupplySubmit(event) {
            event.preventDefault();
            console.log('Power Supply form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Power Supply form data:', Object.fromEntries(formData));
            
            fetch('/generate_power_supply_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Power Supply response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Power Supply UPS Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Power Supply blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Power Supply file download initiated');
                setTimeout(() => {
                    handlePowerSupplyDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Power Supply Error:', error);
                alert('Error generating Power Supply report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handlePowerSupplyDownloadComplete() {
            console.log('Power Supply download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#powerSupplyQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('powerSupplyQuestionsModal');
                console.log('Power Supply modal closed successfully');
            } catch (e) {
                console.log('Could not close Power Supply modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Backup and Restoration form submission handler
        function handleBackupRestorationSubmit(event) {
            event.preventDefault();
            console.log('Backup and Restoration form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Backup and Restoration form data:', Object.fromEntries(formData));
            
            fetch('/generate_backup_restoration_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Backup and Restoration response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Backup and Restoration Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Backup and Restoration blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Backup and Restoration file download initiated');
                setTimeout(() => {
                    handleBackupRestorationDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Backup and Restoration Error:', error);
                alert('Error generating Backup and Restoration report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleBackupRestorationDownloadComplete() {
            console.log('Backup and Restoration download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#backupRestorationQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('backupRestorationQuestionsModal');
                console.log('Backup and Restoration modal closed successfully');
            } catch (e) {
                console.log('Could not close Backup and Restoration modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Maintenance & App Patches form submission handler
        function handleMaintenancePatchesSubmit(event) {
            event.preventDefault();
            console.log('Maintenance & App Patches form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Maintenance & App Patches form data:', Object.fromEntries(formData));
            
            fetch('/generate_maintenance_patches_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Maintenance & App Patches response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Maintenance and App Patches Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Maintenance & App Patches blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Maintenance & App Patches file download initiated');
                setTimeout(() => {
                    handleMaintenancePatchesDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Maintenance & App Patches Error:', error);
                alert('Error generating Maintenance & App Patches report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleMaintenancePatchesDownloadComplete() {
            console.log('Maintenance & App Patches download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#maintenancePatchesQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('maintenancePatchesQuestionsModal');
                console.log('Maintenance & App Patches modal closed successfully');
            } catch (e) {
                console.log('Could not close Maintenance & App Patches modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Network Monitor Tool form submission handler
        function handleNetworkMonitorToolSubmit(event) {
            event.preventDefault();
            console.log('Network Monitor Tool form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Network Monitor Tool form data:', Object.fromEntries(formData));
            
            fetch('/generate_network_monitor_tool_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Network Monitor Tool response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Network Monitor Tool Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Network Monitor Tool blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Network Monitor Tool file download initiated');
                setTimeout(() => {
                    handleNetworkMonitorToolDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Network Monitor Tool Error:', error);
                alert('Error generating Network Monitor Tool report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleNetworkMonitorToolDownloadComplete() {
            console.log('Network Monitor Tool download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#networkMonitorToolQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('networkMonitorToolQuestionsModal');
                console.log('Network Monitor Tool modal closed successfully');
            } catch (e) {
                console.log('Could not close Network Monitor Tool modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // SAN Switch CISCO form submission handler
        function handleSanSwitchCiscoSubmit(event) {
            event.preventDefault();
            console.log('SAN Switch CISCO form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('SAN Switch CISCO form data:', Object.fromEntries(formData));
            
            fetch('/generate_san_switch_cisco_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('SAN Switch CISCO response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'SAN Switch CISCO Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('SAN Switch CISCO blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('SAN Switch CISCO file download initiated');
                setTimeout(() => {
                    handleSanSwitchCiscoDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('SAN Switch CISCO Error:', error);
                alert('Error generating SAN Switch CISCO report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleSanSwitchCiscoDownloadComplete() {
            console.log('SAN Switch CISCO download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#sanSwitchCiscoQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('sanSwitchCiscoQuestionsModal');
                console.log('SAN Switch CISCO modal closed successfully');
            } catch (e) {
                console.log('Could not close SAN Switch CISCO modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // SAN Storage form submission handler
        function handleSanStorageSubmit(event) {
            event.preventDefault();
            console.log('SAN Storage form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('SAN Storage form data:', Object.fromEntries(formData));
            
            fetch('/generate_san_storage_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('SAN Storage response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'SAN Storage Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('SAN Storage blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('SAN Storage file download initiated');
                setTimeout(() => {
                    handleSanStorageDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('SAN Storage Error:', error);
                alert('Error generating SAN Storage report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleSanStorageDownloadComplete() {
            console.log('SAN Storage download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#sanStorageQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('sanStorageQuestionsModal');
                console.log('SAN Storage modal closed successfully');
            } catch (e) {
                console.log('Could not close SAN Storage modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // NAS form submission handler
        function handleNasSubmit(event) {
            event.preventDefault();
            console.log('NAS form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('NAS form data:', Object.fromEntries(formData));
            
            fetch('/generate_nas_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('NAS response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'NAS Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('NAS blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('NAS file download initiated');
                setTimeout(() => {
                    handleNasDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('NAS Error:', error);
                alert('Error generating NAS report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleNasDownloadComplete() {
            console.log('NAS download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#nasQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('nasQuestionsModal');
                console.log('NAS modal closed successfully');
            } catch (e) {
                console.log('Could not close NAS modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Load Balancer Array form submission handler
        function handleLoadBalancerArraySubmit(event) {
            event.preventDefault();
            console.log('Load Balancer Array form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Load Balancer Array form data:', Object.fromEntries(formData));
            
            fetch('/generate_load_balancer_array_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Load Balancer Array response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Load Balancer Array Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Load Balancer Array blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Load Balancer Array file download initiated');
                setTimeout(() => {
                    handleLoadBalancerArrayDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Load Balancer Array Error:', error);
                alert('Error generating Load Balancer Array report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleLoadBalancerArrayDownloadComplete() {
            console.log('Load Balancer Array download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#loadBalancerArrayQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('loadBalancerArrayQuestionsModal');
                console.log('Load Balancer Array modal closed successfully');
            } catch (e) {
                console.log('Could not close Load Balancer Array modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // PAM form submission handler
        function handlePamSubmit(event) {
            event.preventDefault();
            console.log('PAM form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('PAM form data:', Object.fromEntries(formData));
            
            fetch('/generate_pam_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('PAM response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'PAM Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('PAM blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('PAM file download initiated');
                setTimeout(() => {
                    handlePamDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('PAM Error:', error);
                alert('Error generating PAM report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handlePamDownloadComplete() {
            console.log('PAM download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#pamQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('pamQuestionsModal');
                console.log('PAM modal closed successfully');
            } catch (e) {
                console.log('Could not close PAM modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // SOC form submission handler
        function handleSocSubmit(event) {
            event.preventDefault();
            console.log('SOC form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('SOC form data:', Object.fromEntries(formData));
            
            fetch('/generate_soc_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('SOC response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'SOC Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('SOC blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('SOC file download initiated');
                setTimeout(() => {
                    handleSocDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('SOC Error:', error);
                alert('Error generating SOC report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleSocDownloadComplete() {
            console.log('SOC download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#socQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('socQuestionsModal');
                console.log('SOC modal closed successfully');
            } catch (e) {
                console.log('Could not close SOC modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Change Management form submission handler
        function handleChangeManagementSubmit(event) {
            event.preventDefault();
            console.log('Change Management form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Change Management form data:', Object.fromEntries(formData));
            
            fetch('/generate_change_management_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Change Management response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Change Management Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Change Management blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Change Management file download initiated');
                setTimeout(() => {
                    handleChangeManagementDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Change Management Error:', error);
                alert('Error generating Change Management report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleChangeManagementDownloadComplete() {
            console.log('Change Management download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#changeManagementQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('changeManagementQuestionsModal');
                console.log('Change Management modal closed successfully');
            } catch (e) {
                console.log('Could not close Change Management modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Asset Management form submission handler
        function handleAssetManagementSubmit(event) {
            event.preventDefault();
            console.log('Asset Management form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Asset Management form data:', Object.fromEntries(formData));
            
            fetch('/generate_asset_management_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Asset Management response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Asset Management Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Asset Management blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Asset Management file download initiated');
                setTimeout(() => {
                    handleAssetManagementDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Asset Management Error:', error);
                alert('Error generating Asset Management report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleAssetManagementDownloadComplete() {
            console.log('Asset Management download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#assetManagementQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('assetManagementQuestionsModal');
                console.log('Asset Management modal closed successfully');
            } catch (e) {
                console.log('Could not close Asset Management modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Others form submission handler
        function handleOthersSubmit(event) {
            event.preventDefault();
            console.log('Others form submitted');
            
            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            console.log('Others form data:', Object.fromEntries(formData));
            
            fetch('/generate_others_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Others response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // Extract filename from Content-Disposition header
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'Others Review.xlsx';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                    if (filenameMatch) {
                        filename = filenameMatch[1];
                    }
                }
                return response.blob().then(blob => ({ blob, filename }));
            })
            .then(({ blob, filename }) => {
                console.log('Others blob received:', blob);
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                console.log('Others file download initiated');
                setTimeout(() => {
                    handleOthersDownloadComplete();
                }, 1000);
            })
            .catch(error => {
                console.error('Others Error:', error);
                alert('Error generating Others report: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        function handleOthersDownloadComplete() {
            console.log('Others download completion triggered');
            
            // Reset button state
            const submitBtn = document.querySelector('#othersQuestionsForm .submit-btn');
            const originalText = 'Submit Assessment';
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Close modal and refresh page immediately
            try {
                closeModal('othersQuestionsModal');
                console.log('Others modal closed successfully');
            } catch (e) {
                console.log('Could not close Others modal:', e);
            }
            
            console.log('Refreshing page...');
            window.location.reload();
        }

        // Handle Asset Review Non Compliance Points form submission
        function handleAssetReviewNonComplianceSubmit(event) {
            console.log('Asset Review Non Compliance Points form submission started');
            event.preventDefault();
            
            // Show loading state
            const submitBtn = document.getElementById('assetReviewNonComplianceSubmitBtn');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            // Get form data
            const form = document.getElementById('assetReviewNonComplianceForm');
            const formData = new FormData(form);
            
            console.log('Submitting Asset Review Non Compliance Points form with fetch...');
            
            // Submit form using fetch
            fetch('/process_asset_review_non_compliance', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Asset Review Non Compliance Points response received:', response);
                
                if (response.ok) {
                    // Check if response is a file download
                    const contentType = response.headers.get('content-type');
                    const contentDisposition = response.headers.get('content-disposition');
                    
                    console.log('Content-Type:', contentType);
                    console.log('Content-Disposition:', contentDisposition);
                    
                    if (contentType && contentType.includes('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')) {
                        // Extract filename from content-disposition header
                        let filename = 'Asset_Review_Non_Compliance_Points.xlsx';
                        if (contentDisposition) {
                            const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                            if (filenameMatch) {
                                filename = filenameMatch[1];
                            }
                        }
                        
                        console.log('Downloading Asset Review Non Compliance Points file:', filename);
                        
                        // Convert response to blob and create download link
                        return response.blob().then(blob => {
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.style.display = 'none';
                            a.href = url;
                            a.download = filename;
                            document.body.appendChild(a);
                            a.click();
                            window.URL.revokeObjectURL(url);
                            document.body.removeChild(a);
                            
                            console.log('Asset Review Non Compliance Points file downloaded successfully');
                            
                            // Close modal and refresh page
                            closeModal('assetReviewNonComplianceModal');
                            setTimeout(() => {
                                window.location.reload();
                            }, 1000);
                        });
                    } else {
                        // Handle non-file response
                        return response.text().then(text => {
                            console.log('Asset Review Non Compliance Points response text:', text);
                            alert('Unexpected response format');
                        });
                    }
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .catch(error => {
                console.error('Asset Review Non Compliance Points Error:', error);
                alert('An error occurred: ' + error.message);
            })
            .finally(() => {
                // Reset button state
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // Handle Branch Console form submission
        function handleBranchConsoleSubmit(event) {
            console.log('Branch Console form submission started');
            event.preventDefault(); // Prevent default form submission
            
            // Show loading state
            const submitBtn = document.getElementById('branchConsoleSubmitBtn');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Analyzing...';
            submitBtn.disabled = true;
            
            // Get form data
            const form = document.getElementById('branchConsoleForm');
            const formData = new FormData(form);
            
            console.log('Submitting Branch Console form with fetch...');
            
            // Submit form using fetch
            fetch('/process_branch_console', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Branch Console response received:', response);
                
                if (response.ok) {
                    // Check if response is a file download
                    const contentType = response.headers.get('content-type');
                    const contentDisposition = response.headers.get('content-disposition');
                    
                    console.log('Content-Type:', contentType);
                    console.log('Content-Disposition:', contentDisposition);
                    
                    if (contentType && contentType.includes('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')) {
                        // Extract filename from content-disposition header
                        let filename = 'Branch_Console_Report.xlsx';
                        if (contentDisposition) {
                            const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                            if (filenameMatch) {
                                filename = filenameMatch[1];
                            }
                        }
                        
                        console.log('Downloading Branch Console Excel report:', filename);
                        
                        // Convert response to blob and create download link
                        return response.blob().then(blob => {
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.style.display = 'none';
                            a.href = url;
                            a.download = filename;
                            document.body.appendChild(a);
                            a.click();
                            window.URL.revokeObjectURL(url);
                            document.body.removeChild(a);
                            
                            console.log('Branch Console report downloaded successfully');
                            
                            // Close modal and refresh page
                            closeModal('branchConsoleModal');
                            setTimeout(() => {
                                window.location.reload();
                            }, 1000);
                        });
                    } else {
                        // Handle non-file response
                        return response.text().then(text => {
                            console.log('Branch Console response text:', text);
                            alert('Unexpected response format');
                        });
                    }
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .catch(error => {
                console.error('Branch Console Error:', error);
                alert('An error occurred: ' + error.message);
            })
            .finally(() => {
                // Reset button state
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }
    </script>

    <!-- Asset Review Non Compliance Points Modal -->
    <div id="assetReviewNonComplianceModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Asset Review Non Compliance Points</h3>
                <span class="close-modal" onclick="closeModal('assetReviewNonComplianceModal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="assetReviewNonComplianceForm" action="/process_asset_review_non_compliance" method="POST" enctype="multipart/form-data" onsubmit="handleAssetReviewNonComplianceSubmit(event)">
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Kindly Upload the Required Files</h4>
                    </div>

                    <div class="form-group">
                        <label for="assetReviewNonComplianceExcelFile" class="form-label">Combined Asset Review Excel File (.xlsx, .xls)*</label>
                        <input type="file" id="assetReviewNonComplianceExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                        <small class="form-help">Please upload the Combined Asset Review Excel file.</small>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeModal('assetReviewNonComplianceModal')">Cancel</button>
                        <button type="submit" class="submit-btn" id="assetReviewNonComplianceSubmitBtn">Generate Report</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Branch Console Modal -->
    <div id="branchConsoleModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Branch Console</h3>
                <span class="close-modal" onclick="closeModal('branchConsoleModal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="branchConsoleForm" action="/process_branch_console" method="POST" enctype="multipart/form-data" onsubmit="handleBranchConsoleSubmit(event)">
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Analyze Excel File for Branch Console</h4>
                    </div>

                    <div class="form-group">
                        <label for="branchConsoleExcelFile" class="form-label">Combine Branch Excel with POC File (.xlsx, .xls)*</label>
                        <input type="file" id="branchConsoleExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                        <small class="form-help">Upload the Combined Branch Excel with POC Excel File.</small>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeModal('branchConsoleModal')">Cancel</button>
                        <button type="submit" class="submit-btn" id="branchConsoleSubmitBtn">Analyze</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- IS Audit Word Report Modal -->
    <div id="isAuditWordReportModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h3>IS Audit Word Report</h3>
                <span class="close-modal" onclick="closeModal('isAuditWordReportModal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="isAuditWordReportForm" action="/process_is_audit_word_report" method="POST" enctype="multipart/form-data" onsubmit="handleISAuditWordReportSubmit(event)">
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Organization Details</h4>
                    </div>

                    <!-- Organization Name -->
                    <div class="form-group">
                        <label for="organizationName" class="form-label">Organization Name*</label>
                        <select id="organizationName" name="organizationName" class="form-input" required onchange="toggleOtherField('organizationName', 'organizationNameOther')">
                            <option value="">Select Organization</option>
                            <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                            <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                            <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                            <option value="Megasoft Limited">Megasoft Limited</option>
                            <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                            <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                            <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                            <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                            <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                            <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                            <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                            <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                            <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                            <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                            <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                            <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                            <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                            <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                            <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                            <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                            <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                            <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                            <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                            <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                            <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                            <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                            <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                            <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                            <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                            <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                            <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                            <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                            <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                            <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                            <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                            <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                            <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                            <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                            <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                            <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                            
                            <option value="Other">Other (Specify)</option>
                        </select>
                        <input type="text" id="organizationNameOther" name="organizationNameOther" class="form-input" placeholder="Specify organization name" style="display: none; margin-top: 10px;">
                    </div>

                    <!-- City -->
                    <div class="form-group">
                        <label for="isAuditWordReportCity" class="form-label">City*</label>
                        <select id="isAuditWordReportCity" name="city" class="form-input" required onchange="toggleOtherField('isAuditWordReportCity', 'isAuditWordReportCityOther')">
                            <option value="">Select City</option>
                            <!-- Gujarat -->
                            <option value="Ahmedabad">Ahmedabad</option>
                            <option value="Amreli">Amreli</option>
                            <option value="Anand">Anand</option>
                            <option value="Aravalli">Aravalli</option>
                            <option value="Banaskantha">Banaskantha</option>
                            <option value="Bharuch">Bharuch</option>
                            <option value="Bhavnagar">Bhavnagar</option>
                            <option value="Botad">Botad</option>
                            <option value="Chhota Udaipur">Chhota Udaipur</option>
                            <option value="Dahod">Dahod</option>
                            <option value="Dang">Dang</option>
                            <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                            <option value="Gandhinagar">Gandhinagar</option>
                            <option value="Gir Somnath">Gir Somnath</option>
                            <option value="Jamnagar">Jamnagar</option>
                            <option value="Junagadh">Junagadh</option>
                            <option value="Kheda">Kheda</option>
                            <option value="Kutch">Kutch</option>
                            <option value="Mahisagar">Mahisagar</option>
                            <option value="Mehsana">Mehsana</option>
                            <option value="Morbi">Morbi</option>
                            <option value="Narmada">Narmada</option>
                            <option value="Navsari">Navsari</option>
                            <option value="Patan">Patan</option>
                            <option value="Panchmahal">Panchmahal</option>
                            <option value="Porbandar">Porbandar</option>
                            <option value="Rajkot">Rajkot</option>
                            <option value="Sabarkantha">Sabarkantha</option>
                            <option value="Surat">Surat</option>
                            <option value="Surendranagar">Surendranagar</option>
                            <option value="Tapi">Tapi</option>
                            <option value="Vadodara">Vadodara</option>
                            <option value="Valsad">Valsad</option>

                            <!-- Rajasthan -->
                            <option value="Ajmer">Ajmer</option>
                            <option value="Alwar">Alwar</option>
                            <option value="Banswara">Banswara</option>
                            <option value="Baran">Baran</option>
                            <option value="Barmer">Barmer</option>
                            <option value="Bharatpur">Bharatpur</option>
                            <option value="Bhilwara">Bhilwara</option>
                            <option value="Bikaner">Bikaner</option>
                            <option value="Bundi">Bundi</option>
                            <option value="Chittorgarh">Chittorgarh</option>
                            <option value="Churu">Churu</option>
                            <option value="Dausa">Dausa</option>
                            <option value="Dholpur">Dholpur</option>
                            <option value="Dungarpur">Dungarpur</option>
                            <option value="Hanumangarh">Hanumangarh</option>
                            <option value="Jaipur">Jaipur</option>
                            <option value="Jaisalmer">Jaisalmer</option>
                            <option value="Jalore">Jalore</option>
                            <option value="Jhalawar">Jhalawar</option>
                            <option value="Jhunjhunu">Jhunjhunu</option>
                            <option value="Jodhpur">Jodhpur</option>
                            <option value="Karauli">Karauli</option>
                            <option value="Kota">Kota</option>
                            <option value="Nagaur">Nagaur</option>
                            <option value="Pali">Pali</option>
                            <option value="Pratapgarh">Pratapgarh</option>
                            <option value="Rajsamand">Rajsamand</option>
                            <option value="Sikar">Sikar</option>
                            <option value="Sirohi">Sirohi</option>
                            <option value="Sri Ganganagar">Sri Ganganagar</option>
                            <option value="Tonk">Tonk</option>
                            <option value="Udaipur">Udaipur</option>

                            <!-- Maharashtra -->
                            <option value="Ahmednagar">Ahmednagar</option>
                            <option value="Akola">Akola</option>
                            <option value="Amravati">Amravati</option>
                            <option value="Aurangabad">Aurangabad</option>
                            <option value="Beed">Beed</option>
                            <option value="Bhandara">Bhandara</option>
                            <option value="Chandrapur">Chandrapur</option>
                            <option value="Dhule">Dhule</option>
                            <option value="Gadchiroli">Gadchiroli</option>
                            <option value="Gondia">Gondia</option>
                            <option value="Hingoli">Hingoli</option>
                            <option value="Jalgaon">Jalgaon</option>
                            <option value="Jalna">Jalna</option>
                            <option value="Kolhapur">Kolhapur</option>
                            <option value="Latur">Latur</option>
                            <option value="Mumbai City">Mumbai City</option>
                            <option value="Mumbai Suburban">Mumbai Suburban</option>
                            <option value="Nagpur">Nagpur</option>
                            <option value="Nanded">Nanded</option>
                            <option value="Nandurbar">Nandurbar</option>
                            <option value="Nashik">Nashik</option>
                            <option value="Osmanabad">Osmanabad</option>
                            <option value="Palghar">Palghar</option>
                            <option value="Parbhani">Parbhani</option>
                            <option value="Pune">Pune</option>
                            <option value="Raigad">Raigad</option>
                            <option value="Ratnagiri">Ratnagiri</option>
                            <option value="Sangli">Sangli</option>
                            <option value="Satara">Satara</option>
                            <option value="Sindhudurg">Sindhudurg</option>
                            <option value="Solapur">Solapur</option>
                            <option value="Thane">Thane</option>
                            <option value="Wardha">Wardha</option>
                            <option value="Washim">Washim</option>
                            <option value="Yavatmal">Yavatmal</option>

                            <!-- Uttar Pradesh -->
                            <option value="Agra">Agra</option>
                            <option value="Aligarh">Aligarh</option>
                            <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                            <option value="Amethi">Amethi</option>
                            <option value="Amroha">Amroha</option>
                            <option value="Auraiya">Auraiya</option>
                            <option value="Ayodhya">Ayodhya</option>
                            <option value="Azamgarh">Azamgarh</option>
                            <option value="Bagpat">Bagpat</option>
                            <option value="Bahraich">Bahraich</option>
                            <option value="Ballia">Ballia</option>
                            <option value="Balrampur">Balrampur</option>
                            <option value="Banda">Banda</option>
                            <option value="Barabanki">Barabanki</option>
                            <option value="Bareilly">Bareilly</option>
                            <option value="Basti">Basti</option>
                            <option value="Bhadohi">Bhadohi</option>
                            <option value="Bijnor">Bijnor</option>
                            <option value="Bulandshahr">Bulandshahr</option>
                            <option value="Chandauli">Chandauli</option>
                            <option value="Chitrakoot">Chitrakoot</option>
                            <option value="Deoria">Deoria</option>
                            <option value="Etah">Etah</option>
                            <option value="Etawah">Etawah</option>
                            <option value="Farrukhabad">Farrukhabad</option>
                            <option value="Fatehpur">Fatehpur</option>
                            <option value="Firozabad">Firozabad</option>
                            <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                            <option value="Ghaziabad">Ghaziabad</option>
                            <option value="Ghazipur">Ghazipur</option>
                            <option value="Gonda">Gonda</option>
                            <option value="Gorakhpur">Gorakhpur</option>
                            <option value="Hamirpur">Hamirpur</option>
                            <option value="Hapur">Hapur</option>
                            <option value="Hardoi">Hardoi</option>
                            <option value="Hathras">Hathras</option>
                            <option value="Jalaun">Jalaun</option>
                            <option value="Jaunpur">Jaunpur</option>
                            <option value="Jhansi">Jhansi</option>
                            <option value="Kannauj">Kannauj</option>
                            <option value="Kanpur Dehat">Kanpur Dehat</option>
                            <option value="Kanpur Nagar">Kanpur Nagar</option>
                            <option value="Kasganj">Kasganj</option>
                            <option value="Kaushambi">Kaushambi</option>
                            <option value="Kushinagar">Kushinagar</option>
                            <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                            <option value="Lalitpur">Lalitpur</option>
                            <option value="Lucknow">Lucknow</option>
                            <option value="Maharajganj">Maharajganj</option>
                            <option value="Mahoba">Mahoba</option>
                            <option value="Mainpuri">Mainpuri</option>
                            <option value="Mathura">Mathura</option>
                            <option value="Mau">Mau</option>
                            <option value="Meerut">Meerut</option>
                            <option value="Mirzapur">Mirzapur</option>
                            <option value="Moradabad">Moradabad</option>
                            <option value="Muzaffarnagar">Muzaffarnagar</option>
                            <option value="Pilibhit">Pilibhit</option>
                            <option value="Pratapgarh">Pratapgarh</option>
                            <option value="Rae Bareli">Rae Bareli</option>
                            <option value="Rampur">Rampur</option>
                            <option value="Saharanpur">Saharanpur</option>
                            <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                            <option value="Shahjahanpur">Shahjahanpur</option>
                            <option value="Shravasti">Shravasti</option>
                            <option value="Siddharthnagar">Siddharthnagar</option>
                            <option value="Sitapur">Sitapur</option>
                            <option value="Sonbhadra">Sonbhadra</option>
                            <option value="Sultanpur">Sultanpur</option>
                            <option value="Unnao">Unnao</option>
                            <option value="Varanasi">Varanasi</option>

                            <!-- Uttarakhand -->
                            <option value="Almora">Almora</option>
                            <option value="Bageshwar">Bageshwar</option>
                            <option value="Chamoli">Chamoli</option>
                            <option value="Champawat">Champawat</option>
                            <option value="Dehradun">Dehradun</option>
                            <option value="Haridwar">Haridwar</option>
                            <option value="Nainital">Nainital</option>
                            <option value="Pauri Garhwal">Pauri Garhwal</option>
                            <option value="Pithoragarh">Pithoragarh</option>
                            <option value="Rudraprayag">Rudraprayag</option>
                            <option value="Tehri Garhwal">Tehri Garhwal</option>
                            <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                            <option value="Uttarkashi">Uttarkashi</option>


                            <option value="Other">Other (Specify)</option>
                        </select>
                        <input type="text" id="isAuditWordReportCityOther" name="cityOther" class="form-input" placeholder="Specify city" style="display: none; margin-top: 10px;">
                    </div>

                    <!-- State -->
                    <div class="form-group">
                        <label for="state" class="form-label">State*</label>
                        <select id="state" name="state" class="form-input" required>
                            <option value="">Select State</option>
                            <option value="Andhra Pradesh">Andhra Pradesh</option>
                            <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                            <option value="Assam">Assam</option>
                            <option value="Bihar">Bihar</option>
                            <option value="Chhattisgarh">Chhattisgarh</option>
                            <option value="Goa">Goa</option>
                            <option value="Gujarat">Gujarat</option>
                            <option value="Haryana">Haryana</option>
                            <option value="Himachal Pradesh">Himachal Pradesh</option>
                            <option value="Jharkhand">Jharkhand</option>
                            <option value="Karnataka">Karnataka</option>
                            <option value="Kerala">Kerala</option>
                            <option value="Madhya Pradesh">Madhya Pradesh</option>
                            <option value="Maharashtra">Maharashtra</option>
                            <option value="Manipur">Manipur</option>
                            <option value="Meghalaya">Meghalaya</option>
                            <option value="Mizoram">Mizoram</option>
                            <option value="Nagaland">Nagaland</option>
                            <option value="Odisha">Odisha</option>
                            <option value="Punjab">Punjab</option>
                            <option value="Rajasthan">Rajasthan</option>
                            <option value="Sikkim">Sikkim</option>
                            <option value="Tamil Nadu">Tamil Nadu</option>
                            <option value="Telangana">Telangana</option>
                            <option value="Tripura">Tripura</option>
                            <option value="Uttar Pradesh">Uttar Pradesh</option>
                            <option value="Uttarakhand">Uttarakhand</option>
                            <option value="West Bengal">West Bengal</option>

                            <!-- Union Territories -->
                            <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                            <option value="Chandigarh">Chandigarh</option>
                            <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                            <option value="Delhi">Delhi</option>
                            <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                            <option value="Ladakh">Ladakh</option>
                            <option value="Lakshadweep">Lakshadweep</option>
                            <option value="Puducherry">Puducherry</option>

                        </select>
                    </div>

                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Auditor Details</h4>
                    </div>

                    <!-- Prepared By -->
                    <div class="form-group">
                        <label for="preparedByPrefix" class="form-label">Prepared By*</label>
                        <div style="display: flex; gap: 10px;">
                            <select id="preparedByPrefix" name="preparedByPrefix" class="form-input" required style="flex: 0 0 100px;">
                                <option value="Mr.">Mr.</option>
                                <option value="Mrs.">Mrs.</option>
                                <option value="Dr.">Dr.</option>
                                <option value="Miss">Miss</option>
                            </select>
                            <input type="text" id="preparedByName" name="preparedByName" class="form-input" placeholder="Enter name" required style="flex: 1;">
                        </div>
                    </div>

                    <!-- Audit Dates -->
                    <div class="form-group">
                        <label for="startAuditDate" class="form-label">Start Audit Date*</label>
                        <input type="date" id="startAuditDate" name="startAuditDate" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label for="endAuditDate" class="form-label">End Audit Date*</label>
                        <input type="date" id="endAuditDate" name="endAuditDate" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Auditee Details</h4>
                    </div>

                    <!-- Auditee Person Name -->
                    <div class="form-group">
                        <label for="auditeePersonPrefix" class="form-label">Auditee Organization Person Name*</label>
                        <div style="display: flex; gap: 10px;">
                            <select id="auditeePersonPrefix" name="auditeePersonPrefix" class="form-input" required style="flex: 0 0 100px;">
                                <option value="Mr.">Mr.</option>
                                <option value="Mrs.">Mrs.</option>
                                <option value="Dr.">Dr.</option>
                                <option value="Miss">Miss</option>
                            </select>
                            <input type="text" id="auditeePersonName" name="auditeePersonName" class="form-input" placeholder="Enter name" required style="flex: 1;">
                        </div>
                    </div>

                    <!-- Auditee Designation -->
                    <div class="form-group">
                        <label for="auditeeDesignation" class="form-label">Auditee Organization Person Designation*</label>
                        <input type="text" id="auditeeDesignation" name="auditeeDesignation" class="form-input" placeholder="e.g., IT Manager" required>
                    </div>

                    <!-- Address -->
                    <div class="form-group">
                        <label for="address" class="form-label">Address*</label>
                        <textarea id="address" name="address" class="form-input" placeholder="Enter complete address" required rows="3" style="width: 100%; resize: vertical;"></textarea>
                    </div>

                    <!-- Email with dynamic fields -->
                    <div class="form-group">
                        <label class="form-label">Email Address(es)*</label>
                        <div id="isAuditEmailContainer">
                            <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                                <input type="email" name="email[]" class="form-input" placeholder="Enter email address" required style="flex: 1;">
                                <button type="button" class="submit-btn" onclick="addEmailField()" style="flex: 0 0 40px; padding: 8px;">+</button>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Banking Details</h4>
                    </div>

                    <!-- Bank Under -->
                    <div class="form-group">
                        <label class="form-label">Bank Under*</label>
                        <div style="display: flex; gap: 20px;">
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="radio" name="bankUnder" value="RBI" required> RBI
                            </label>
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="radio" name="bankUnder" value="NABARD" required> NABARD
                            </label>
                        </div>
                    </div>

                    <!-- Number of Branches -->
                    <div class="form-group">
                        <label for="numberOfBranches" class="form-label">Number of Branches*</label>
                        <input type="number" id="numberOfBranches" name="numberOfBranches" class="form-input" placeholder="Enter number of branches" required min="0">
                    </div>

                    <!-- CBS Provider Name -->
                    <div class="form-group">
                        <label for="cbsProviderName" class="form-label">CBS Provider Name*</label>
                        <input type="text" id="cbsProviderName" name="cbsProviderName" class="form-input" placeholder="e.g., Infosys Finacle, TCS BaNCS" required>
                    </div>

                    <!-- Business Activity Model -->
                    <div class="form-group">
                        <label for="businessActivityModel" class="form-label">Business Activity Model*</label>
                        <select id="businessActivityModel" name="businessActivityModel" class="form-input" required onchange="toggleOtherField('businessActivityModel', 'businessActivityModelOther')">
                            <option value="">Select Model</option>
                            <option value="ASP Model">ASP Model</option>
                            <option value="Other">Other (Specify)</option>
                        </select>
                        <input type="text" id="businessActivityModelOther" name="businessActivityModelOther" class="form-input" placeholder="Specify business model" style="display: none; margin-top: 10px;">
                    </div>

                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Infrastructure Details</h4>
                    </div>

                    <!-- CBS Data Center Management -->
                    <div class="form-group">
                        <label for="cbsDataCenterManaged" class="form-label">CBS Data Center and Networking Devices Managed by*</label>
                        <input type="text" id="cbsDataCenterManaged" name="cbsDataCenterManaged" class="form-input" placeholder="e.g., In-house, Vendor Name" required>
                    </div>

                    <!-- DC Location -->
                    <div class="form-group">
                        <label for="dcLocation" class="form-label">DC Location*</label>
                        <select id="dcLocation" name="dcLocation" class="form-input" required onchange="toggleOtherField('dcLocation', 'dcLocationOther')">
                            <option value="">Select City</option>
                            <!-- Gujarat -->
                            <option value="Ahmedabad">Ahmedabad</option>
                            <option value="Amreli">Amreli</option>
                            <option value="Anand">Anand</option>
                            <option value="Aravalli">Aravalli</option>
                            <option value="Banaskantha">Banaskantha</option>
                            <option value="Bharuch">Bharuch</option>
                            <option value="Bhavnagar">Bhavnagar</option>
                            <option value="Botad">Botad</option>
                            <option value="Chhota Udaipur">Chhota Udaipur</option>
                            <option value="Dahod">Dahod</option>
                            <option value="Dang">Dang</option>
                            <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                            <option value="Gandhinagar">Gandhinagar</option>
                            <option value="Gir Somnath">Gir Somnath</option>
                            <option value="Jamnagar">Jamnagar</option>
                            <option value="Junagadh">Junagadh</option>
                            <option value="Kheda">Kheda</option>
                            <option value="Kutch">Kutch</option>
                            <option value="Mahisagar">Mahisagar</option>
                            <option value="Mehsana">Mehsana</option>
                            <option value="Morbi">Morbi</option>
                            <option value="Narmada">Narmada</option>
                            <option value="Navsari">Navsari</option>
                            <option value="Patan">Patan</option>
                            <option value="Panchmahal">Panchmahal</option>
                            <option value="Porbandar">Porbandar</option>
                            <option value="Rajkot">Rajkot</option>
                            <option value="Sabarkantha">Sabarkantha</option>
                            <option value="Surat">Surat</option>
                            <option value="Surendranagar">Surendranagar</option>
                            <option value="Tapi">Tapi</option>
                            <option value="Vadodara">Vadodara</option>
                            <option value="Valsad">Valsad</option>

                            <!-- Rajasthan -->
                            <option value="Ajmer">Ajmer</option>
                            <option value="Alwar">Alwar</option>
                            <option value="Banswara">Banswara</option>
                            <option value="Baran">Baran</option>
                            <option value="Barmer">Barmer</option>
                            <option value="Bharatpur">Bharatpur</option>
                            <option value="Bhilwara">Bhilwara</option>
                            <option value="Bikaner">Bikaner</option>
                            <option value="Bundi">Bundi</option>
                            <option value="Chittorgarh">Chittorgarh</option>
                            <option value="Churu">Churu</option>
                            <option value="Dausa">Dausa</option>
                            <option value="Dholpur">Dholpur</option>
                            <option value="Dungarpur">Dungarpur</option>
                            <option value="Hanumangarh">Hanumangarh</option>
                            <option value="Jaipur">Jaipur</option>
                            <option value="Jaisalmer">Jaisalmer</option>
                            <option value="Jalore">Jalore</option>
                            <option value="Jhalawar">Jhalawar</option>
                            <option value="Jhunjhunu">Jhunjhunu</option>
                            <option value="Jodhpur">Jodhpur</option>
                            <option value="Karauli">Karauli</option>
                            <option value="Kota">Kota</option>
                            <option value="Nagaur">Nagaur</option>
                            <option value="Pali">Pali</option>
                            <option value="Pratapgarh">Pratapgarh</option>
                            <option value="Rajsamand">Rajsamand</option>
                            <option value="Sikar">Sikar</option>
                            <option value="Sirohi">Sirohi</option>
                            <option value="Sri Ganganagar">Sri Ganganagar</option>
                            <option value="Tonk">Tonk</option>
                            <option value="Udaipur">Udaipur</option>

                            <!-- Maharashtra -->
                            <option value="Ahmednagar">Ahmednagar</option>
                            <option value="Akola">Akola</option>
                            <option value="Amravati">Amravati</option>
                            <option value="Aurangabad">Aurangabad</option>
                            <option value="Beed">Beed</option>
                            <option value="Bhandara">Bhandara</option>
                            <option value="Chandrapur">Chandrapur</option>
                            <option value="Dhule">Dhule</option>
                            <option value="Gadchiroli">Gadchiroli</option>
                            <option value="Gondia">Gondia</option>
                            <option value="Hingoli">Hingoli</option>
                            <option value="Jalgaon">Jalgaon</option>
                            <option value="Jalna">Jalna</option>
                            <option value="Kolhapur">Kolhapur</option>
                            <option value="Latur">Latur</option>
                            <option value="Mumbai City">Mumbai City</option>
                            <option value="Mumbai Suburban">Mumbai Suburban</option>
                            <option value="Nagpur">Nagpur</option>
                            <option value="Nanded">Nanded</option>
                            <option value="Nandurbar">Nandurbar</option>
                            <option value="Nashik">Nashik</option>
                            <option value="Osmanabad">Osmanabad</option>
                            <option value="Palghar">Palghar</option>
                            <option value="Parbhani">Parbhani</option>
                            <option value="Pune">Pune</option>
                            <option value="Raigad">Raigad</option>
                            <option value="Ratnagiri">Ratnagiri</option>
                            <option value="Sangli">Sangli</option>
                            <option value="Satara">Satara</option>
                            <option value="Sindhudurg">Sindhudurg</option>
                            <option value="Solapur">Solapur</option>
                            <option value="Thane">Thane</option>
                            <option value="Wardha">Wardha</option>
                            <option value="Washim">Washim</option>
                            <option value="Yavatmal">Yavatmal</option>

                            <!-- Uttar Pradesh -->
                            <option value="Agra">Agra</option>
                            <option value="Aligarh">Aligarh</option>
                            <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                            <option value="Amethi">Amethi</option>
                            <option value="Amroha">Amroha</option>
                            <option value="Auraiya">Auraiya</option>
                            <option value="Ayodhya">Ayodhya</option>
                            <option value="Azamgarh">Azamgarh</option>
                            <option value="Bagpat">Bagpat</option>
                            <option value="Bahraich">Bahraich</option>
                            <option value="Ballia">Ballia</option>
                            <option value="Balrampur">Balrampur</option>
                            <option value="Banda">Banda</option>
                            <option value="Barabanki">Barabanki</option>
                            <option value="Bareilly">Bareilly</option>
                            <option value="Basti">Basti</option>
                            <option value="Bhadohi">Bhadohi</option>
                            <option value="Bijnor">Bijnor</option>
                            <option value="Bulandshahr">Bulandshahr</option>
                            <option value="Chandauli">Chandauli</option>
                            <option value="Chitrakoot">Chitrakoot</option>
                            <option value="Deoria">Deoria</option>
                            <option value="Etah">Etah</option>
                            <option value="Etawah">Etawah</option>
                            <option value="Farrukhabad">Farrukhabad</option>
                            <option value="Fatehpur">Fatehpur</option>
                            <option value="Firozabad">Firozabad</option>
                            <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                            <option value="Ghaziabad">Ghaziabad</option>
                            <option value="Ghazipur">Ghazipur</option>
                            <option value="Gonda">Gonda</option>
                            <option value="Gorakhpur">Gorakhpur</option>
                            <option value="Hamirpur">Hamirpur</option>
                            <option value="Hapur">Hapur</option>
                            <option value="Hardoi">Hardoi</option>
                            <option value="Hathras">Hathras</option>
                            <option value="Jalaun">Jalaun</option>
                            <option value="Jaunpur">Jaunpur</option>
                            <option value="Jhansi">Jhansi</option>
                            <option value="Kannauj">Kannauj</option>
                            <option value="Kanpur Dehat">Kanpur Dehat</option>
                            <option value="Kanpur Nagar">Kanpur Nagar</option>
                            <option value="Kasganj">Kasganj</option>
                            <option value="Kaushambi">Kaushambi</option>
                            <option value="Kushinagar">Kushinagar</option>
                            <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                            <option value="Lalitpur">Lalitpur</option>
                            <option value="Lucknow">Lucknow</option>
                            <option value="Maharajganj">Maharajganj</option>
                            <option value="Mahoba">Mahoba</option>
                            <option value="Mainpuri">Mainpuri</option>
                            <option value="Mathura">Mathura</option>
                            <option value="Mau">Mau</option>
                            <option value="Meerut">Meerut</option>
                            <option value="Mirzapur">Mirzapur</option>
                            <option value="Moradabad">Moradabad</option>
                            <option value="Muzaffarnagar">Muzaffarnagar</option>
                            <option value="Pilibhit">Pilibhit</option>
                            <option value="Pratapgarh">Pratapgarh</option>
                            <option value="Rae Bareli">Rae Bareli</option>
                            <option value="Rampur">Rampur</option>
                            <option value="Saharanpur">Saharanpur</option>
                            <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                            <option value="Shahjahanpur">Shahjahanpur</option>
                            <option value="Shravasti">Shravasti</option>
                            <option value="Siddharthnagar">Siddharthnagar</option>
                            <option value="Sitapur">Sitapur</option>
                            <option value="Sonbhadra">Sonbhadra</option>
                            <option value="Sultanpur">Sultanpur</option>
                            <option value="Unnao">Unnao</option>
                            <option value="Varanasi">Varanasi</option>

                            <!-- Uttarakhand -->
                            <option value="Almora">Almora</option>
                            <option value="Bageshwar">Bageshwar</option>
                            <option value="Chamoli">Chamoli</option>
                            <option value="Champawat">Champawat</option>
                            <option value="Dehradun">Dehradun</option>
                            <option value="Haridwar">Haridwar</option>
                            <option value="Nainital">Nainital</option>
                            <option value="Pauri Garhwal">Pauri Garhwal</option>
                            <option value="Pithoragarh">Pithoragarh</option>
                            <option value="Rudraprayag">Rudraprayag</option>
                            <option value="Tehri Garhwal">Tehri Garhwal</option>
                            <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                            <option value="Uttarkashi">Uttarkashi</option>


                            <option value="Other">Other (Specify)</option>
                        </select>
                        <input type="text" id="dcLocationOther" name="dcLocationOther" class="form-input" placeholder="Specify DC location" style="display: none; margin-top: 10px;">
                    </div>

                    <!-- DR Location -->
                    <div class="form-group">
                        <label for="isAuditWordReportDrLocation" class="form-label">DR Location*</label>
                        <select id="isAuditWordReportDrLocation" name="drLocation" class="form-input" required onchange="toggleOtherField('isAuditWordReportDrLocation', 'isAuditWordReportDrLocationOther')">
                            <option value="">Select City</option>
                            <!-- Gujarat -->
                            <option value="Ahmedabad">Ahmedabad</option>
                            <option value="Amreli">Amreli</option>
                            <option value="Anand">Anand</option>
                            <option value="Aravalli">Aravalli</option>
                            <option value="Banaskantha">Banaskantha</option>
                            <option value="Bharuch">Bharuch</option>
                            <option value="Bhavnagar">Bhavnagar</option>
                            <option value="Botad">Botad</option>
                            <option value="Chhota Udaipur">Chhota Udaipur</option>
                            <option value="Dahod">Dahod</option>
                            <option value="Dang">Dang</option>
                            <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                            <option value="Gandhinagar">Gandhinagar</option>
                            <option value="Gir Somnath">Gir Somnath</option>
                            <option value="Jamnagar">Jamnagar</option>
                            <option value="Junagadh">Junagadh</option>
                            <option value="Kheda">Kheda</option>
                            <option value="Kutch">Kutch</option>
                            <option value="Mahisagar">Mahisagar</option>
                            <option value="Mehsana">Mehsana</option>
                            <option value="Morbi">Morbi</option>
                            <option value="Narmada">Narmada</option>
                            <option value="Navsari">Navsari</option>
                            <option value="Patan">Patan</option>
                            <option value="Panchmahal">Panchmahal</option>
                            <option value="Porbandar">Porbandar</option>
                            <option value="Rajkot">Rajkot</option>
                            <option value="Sabarkantha">Sabarkantha</option>
                            <option value="Surat">Surat</option>
                            <option value="Surendranagar">Surendranagar</option>
                            <option value="Tapi">Tapi</option>
                            <option value="Vadodara">Vadodara</option>
                            <option value="Valsad">Valsad</option>

                            <!-- Rajasthan -->
                            <option value="Ajmer">Ajmer</option>
                            <option value="Alwar">Alwar</option>
                            <option value="Banswara">Banswara</option>
                            <option value="Baran">Baran</option>
                            <option value="Barmer">Barmer</option>
                            <option value="Bharatpur">Bharatpur</option>
                            <option value="Bhilwara">Bhilwara</option>
                            <option value="Bikaner">Bikaner</option>
                            <option value="Bundi">Bundi</option>
                            <option value="Chittorgarh">Chittorgarh</option>
                            <option value="Churu">Churu</option>
                            <option value="Dausa">Dausa</option>
                            <option value="Dholpur">Dholpur</option>
                            <option value="Dungarpur">Dungarpur</option>
                            <option value="Hanumangarh">Hanumangarh</option>
                            <option value="Jaipur">Jaipur</option>
                            <option value="Jaisalmer">Jaisalmer</option>
                            <option value="Jalore">Jalore</option>
                            <option value="Jhalawar">Jhalawar</option>
                            <option value="Jhunjhunu">Jhunjhunu</option>
                            <option value="Jodhpur">Jodhpur</option>
                            <option value="Karauli">Karauli</option>
                            <option value="Kota">Kota</option>
                            <option value="Nagaur">Nagaur</option>
                            <option value="Pali">Pali</option>
                            <option value="Pratapgarh">Pratapgarh</option>
                            <option value="Rajsamand">Rajsamand</option>
                            <option value="Sikar">Sikar</option>
                            <option value="Sirohi">Sirohi</option>
                            <option value="Sri Ganganagar">Sri Ganganagar</option>
                            <option value="Tonk">Tonk</option>
                            <option value="Udaipur">Udaipur</option>

                            <!-- Maharashtra -->
                            <option value="Ahmednagar">Ahmednagar</option>
                            <option value="Akola">Akola</option>
                            <option value="Amravati">Amravati</option>
                            <option value="Aurangabad">Aurangabad</option>
                            <option value="Beed">Beed</option>
                            <option value="Bhandara">Bhandara</option>
                            <option value="Chandrapur">Chandrapur</option>
                            <option value="Dhule">Dhule</option>
                            <option value="Gadchiroli">Gadchiroli</option>
                            <option value="Gondia">Gondia</option>
                            <option value="Hingoli">Hingoli</option>
                            <option value="Jalgaon">Jalgaon</option>
                            <option value="Jalna">Jalna</option>
                            <option value="Kolhapur">Kolhapur</option>
                            <option value="Latur">Latur</option>
                            <option value="Mumbai City">Mumbai City</option>
                            <option value="Mumbai Suburban">Mumbai Suburban</option>
                            <option value="Nagpur">Nagpur</option>
                            <option value="Nanded">Nanded</option>
                            <option value="Nandurbar">Nandurbar</option>
                            <option value="Nashik">Nashik</option>
                            <option value="Osmanabad">Osmanabad</option>
                            <option value="Palghar">Palghar</option>
                            <option value="Parbhani">Parbhani</option>
                            <option value="Pune">Pune</option>
                            <option value="Raigad">Raigad</option>
                            <option value="Ratnagiri">Ratnagiri</option>
                            <option value="Sangli">Sangli</option>
                            <option value="Satara">Satara</option>
                            <option value="Sindhudurg">Sindhudurg</option>
                            <option value="Solapur">Solapur</option>
                            <option value="Thane">Thane</option>
                            <option value="Wardha">Wardha</option>
                            <option value="Washim">Washim</option>
                            <option value="Yavatmal">Yavatmal</option>

                            <!-- Uttar Pradesh -->
                            <option value="Agra">Agra</option>
                            <option value="Aligarh">Aligarh</option>
                            <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                            <option value="Amethi">Amethi</option>
                            <option value="Amroha">Amroha</option>
                            <option value="Auraiya">Auraiya</option>
                            <option value="Ayodhya">Ayodhya</option>
                            <option value="Azamgarh">Azamgarh</option>
                            <option value="Bagpat">Bagpat</option>
                            <option value="Bahraich">Bahraich</option>
                            <option value="Ballia">Ballia</option>
                            <option value="Balrampur">Balrampur</option>
                            <option value="Banda">Banda</option>
                            <option value="Barabanki">Barabanki</option>
                            <option value="Bareilly">Bareilly</option>
                            <option value="Basti">Basti</option>
                            <option value="Bhadohi">Bhadohi</option>
                            <option value="Bijnor">Bijnor</option>
                            <option value="Bulandshahr">Bulandshahr</option>
                            <option value="Chandauli">Chandauli</option>
                            <option value="Chitrakoot">Chitrakoot</option>
                            <option value="Deoria">Deoria</option>
                            <option value="Etah">Etah</option>
                            <option value="Etawah">Etawah</option>
                            <option value="Farrukhabad">Farrukhabad</option>
                            <option value="Fatehpur">Fatehpur</option>
                            <option value="Firozabad">Firozabad</option>
                            <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                            <option value="Ghaziabad">Ghaziabad</option>
                            <option value="Ghazipur">Ghazipur</option>
                            <option value="Gonda">Gonda</option>
                            <option value="Gorakhpur">Gorakhpur</option>
                            <option value="Hamirpur">Hamirpur</option>
                            <option value="Hapur">Hapur</option>
                            <option value="Hardoi">Hardoi</option>
                            <option value="Hathras">Hathras</option>
                            <option value="Jalaun">Jalaun</option>
                            <option value="Jaunpur">Jaunpur</option>
                            <option value="Jhansi">Jhansi</option>
                            <option value="Kannauj">Kannauj</option>
                            <option value="Kanpur Dehat">Kanpur Dehat</option>
                            <option value="Kanpur Nagar">Kanpur Nagar</option>
                            <option value="Kasganj">Kasganj</option>
                            <option value="Kaushambi">Kaushambi</option>
                            <option value="Kushinagar">Kushinagar</option>
                            <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                            <option value="Lalitpur">Lalitpur</option>
                            <option value="Lucknow">Lucknow</option>
                            <option value="Maharajganj">Maharajganj</option>
                            <option value="Mahoba">Mahoba</option>
                            <option value="Mainpuri">Mainpuri</option>
                            <option value="Mathura">Mathura</option>
                            <option value="Mau">Mau</option>
                            <option value="Meerut">Meerut</option>
                            <option value="Mirzapur">Mirzapur</option>
                            <option value="Moradabad">Moradabad</option>
                            <option value="Muzaffarnagar">Muzaffarnagar</option>
                            <option value="Pilibhit">Pilibhit</option>
                            <option value="Pratapgarh">Pratapgarh</option>
                            <option value="Rae Bareli">Rae Bareli</option>
                            <option value="Rampur">Rampur</option>
                            <option value="Saharanpur">Saharanpur</option>
                            <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                            <option value="Shahjahanpur">Shahjahanpur</option>
                            <option value="Shravasti">Shravasti</option>
                            <option value="Siddharthnagar">Siddharthnagar</option>
                            <option value="Sitapur">Sitapur</option>
                            <option value="Sonbhadra">Sonbhadra</option>
                            <option value="Sultanpur">Sultanpur</option>
                            <option value="Unnao">Unnao</option>
                            <option value="Varanasi">Varanasi</option>

                            <!-- Uttarakhand -->
                            <option value="Almora">Almora</option>
                            <option value="Bageshwar">Bageshwar</option>
                            <option value="Chamoli">Chamoli</option>
                            <option value="Champawat">Champawat</option>
                            <option value="Dehradun">Dehradun</option>
                            <option value="Haridwar">Haridwar</option>
                            <option value="Nainital">Nainital</option>
                            <option value="Pauri Garhwal">Pauri Garhwal</option>
                            <option value="Pithoragarh">Pithoragarh</option>
                            <option value="Rudraprayag">Rudraprayag</option>
                            <option value="Tehri Garhwal">Tehri Garhwal</option>
                            <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                            <option value="Uttarkashi">Uttarkashi</option>


                            <option value="Other">Other (Specify)</option>
                        </select>
                        <input type="text" id="isAuditWordReportDrLocationOther" name="drLocationOther" class="form-input" placeholder="Specify DR location" style="display: none; margin-top: 10px;">
                    </div>

                    <!-- Connectivity -->
                    <div class="form-group">
                        <label for="primaryConnectivity" class="form-label">Primary Connectivity*</label>
                        <input type="text" id="primaryConnectivity" name="primaryConnectivity" class="form-input" placeholder="e.g., MPLS, Leased Line" required>
                    </div>

                    <div class="form-group">
                        <label for="secondaryConnectivity" class="form-label">Secondary Connectivity*</label>
                        <input type="text" id="secondaryConnectivity" name="secondaryConnectivity" class="form-input" placeholder="e.g., Broadband, 4G" required>
                    </div>

                    <!-- Is bank operating any services? -->
                    <div class="form-group">
                        <label class="form-label">Is bank operating any services?*</label>
                        <div style="display: flex; gap: 20px;">
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="radio" name="hasOtherServices" value="Yes" required onchange="toggleOtherServicesFields(true)"> Yes
                            </label>
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="radio" name="hasOtherServices" value="No" required onchange="toggleOtherServicesFields(false)"> No
                            </label>
                        </div>
                    </div>

                    <!-- Other Services -->
                    <div class="form-group" id="otherServicesGroup" style="display: none;">
                        <label for="otherServices" class="form-label">Other Services</label>
                        <input type="text" id="otherServices" name="otherServices" class="form-input" placeholder="e.g., Email, Internet Banking">
                    </div>

                    <!-- Other Services DC Location -->
                    <div class="form-group" id="otherServicesDCGroup" style="display: none;">
                        <label for="otherServicesDC" class="form-label">Other Services Host DC Location</label>
                        <select id="otherServicesDC" name="otherServicesDC" class="form-input" onchange="toggleOtherField('otherServicesDC', 'otherServicesDCOther')">
                            <option value="">Select City</option>
                            <!-- Gujarat -->
                            <option value="Ahmedabad">Ahmedabad</option>
                            <option value="Amreli">Amreli</option>
                            <option value="Anand">Anand</option>
                            <option value="Aravalli">Aravalli</option>
                            <option value="Banaskantha">Banaskantha</option>
                            <option value="Bharuch">Bharuch</option>
                            <option value="Bhavnagar">Bhavnagar</option>
                            <option value="Botad">Botad</option>
                            <option value="Chhota Udaipur">Chhota Udaipur</option>
                            <option value="Dahod">Dahod</option>
                            <option value="Dang">Dang</option>
                            <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                            <option value="Gandhinagar">Gandhinagar</option>
                            <option value="Gir Somnath">Gir Somnath</option>
                            <option value="Jamnagar">Jamnagar</option>
                            <option value="Junagadh">Junagadh</option>
                            <option value="Kheda">Kheda</option>
                            <option value="Kutch">Kutch</option>
                            <option value="Mahisagar">Mahisagar</option>
                            <option value="Mehsana">Mehsana</option>
                            <option value="Morbi">Morbi</option>
                            <option value="Narmada">Narmada</option>
                            <option value="Navsari">Navsari</option>
                            <option value="Patan">Patan</option>
                            <option value="Panchmahal">Panchmahal</option>
                            <option value="Porbandar">Porbandar</option>
                            <option value="Rajkot">Rajkot</option>
                            <option value="Sabarkantha">Sabarkantha</option>
                            <option value="Surat">Surat</option>
                            <option value="Surendranagar">Surendranagar</option>
                            <option value="Tapi">Tapi</option>
                            <option value="Vadodara">Vadodara</option>
                            <option value="Valsad">Valsad</option>

                            <!-- Rajasthan -->
                            <option value="Ajmer">Ajmer</option>
                            <option value="Alwar">Alwar</option>
                            <option value="Banswara">Banswara</option>
                            <option value="Baran">Baran</option>
                            <option value="Barmer">Barmer</option>
                            <option value="Bharatpur">Bharatpur</option>
                            <option value="Bhilwara">Bhilwara</option>
                            <option value="Bikaner">Bikaner</option>
                            <option value="Bundi">Bundi</option>
                            <option value="Chittorgarh">Chittorgarh</option>
                            <option value="Churu">Churu</option>
                            <option value="Dausa">Dausa</option>
                            <option value="Dholpur">Dholpur</option>
                            <option value="Dungarpur">Dungarpur</option>
                            <option value="Hanumangarh">Hanumangarh</option>
                            <option value="Jaipur">Jaipur</option>
                            <option value="Jaisalmer">Jaisalmer</option>
                            <option value="Jalore">Jalore</option>
                            <option value="Jhalawar">Jhalawar</option>
                            <option value="Jhunjhunu">Jhunjhunu</option>
                            <option value="Jodhpur">Jodhpur</option>
                            <option value="Karauli">Karauli</option>
                            <option value="Kota">Kota</option>
                            <option value="Nagaur">Nagaur</option>
                            <option value="Pali">Pali</option>
                            <option value="Pratapgarh">Pratapgarh</option>
                            <option value="Rajsamand">Rajsamand</option>
                            <option value="Sikar">Sikar</option>
                            <option value="Sirohi">Sirohi</option>
                            <option value="Sri Ganganagar">Sri Ganganagar</option>
                            <option value="Tonk">Tonk</option>
                            <option value="Udaipur">Udaipur</option>

                            <!-- Maharashtra -->
                            <option value="Ahmednagar">Ahmednagar</option>
                            <option value="Akola">Akola</option>
                            <option value="Amravati">Amravati</option>
                            <option value="Aurangabad">Aurangabad</option>
                            <option value="Beed">Beed</option>
                            <option value="Bhandara">Bhandara</option>
                            <option value="Chandrapur">Chandrapur</option>
                            <option value="Dhule">Dhule</option>
                            <option value="Gadchiroli">Gadchiroli</option>
                            <option value="Gondia">Gondia</option>
                            <option value="Hingoli">Hingoli</option>
                            <option value="Jalgaon">Jalgaon</option>
                            <option value="Jalna">Jalna</option>
                            <option value="Kolhapur">Kolhapur</option>
                            <option value="Latur">Latur</option>
                            <option value="Mumbai City">Mumbai City</option>
                            <option value="Mumbai Suburban">Mumbai Suburban</option>
                            <option value="Nagpur">Nagpur</option>
                            <option value="Nanded">Nanded</option>
                            <option value="Nandurbar">Nandurbar</option>
                            <option value="Nashik">Nashik</option>
                            <option value="Osmanabad">Osmanabad</option>
                            <option value="Palghar">Palghar</option>
                            <option value="Parbhani">Parbhani</option>
                            <option value="Pune">Pune</option>
                            <option value="Raigad">Raigad</option>
                            <option value="Ratnagiri">Ratnagiri</option>
                            <option value="Sangli">Sangli</option>
                            <option value="Satara">Satara</option>
                            <option value="Sindhudurg">Sindhudurg</option>
                            <option value="Solapur">Solapur</option>
                            <option value="Thane">Thane</option>
                            <option value="Wardha">Wardha</option>
                            <option value="Washim">Washim</option>
                            <option value="Yavatmal">Yavatmal</option>

                            <!-- Uttar Pradesh -->
                            <option value="Agra">Agra</option>
                            <option value="Aligarh">Aligarh</option>
                            <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                            <option value="Amethi">Amethi</option>
                            <option value="Amroha">Amroha</option>
                            <option value="Auraiya">Auraiya</option>
                            <option value="Ayodhya">Ayodhya</option>
                            <option value="Azamgarh">Azamgarh</option>
                            <option value="Bagpat">Bagpat</option>
                            <option value="Bahraich">Bahraich</option>
                            <option value="Ballia">Ballia</option>
                            <option value="Balrampur">Balrampur</option>
                            <option value="Banda">Banda</option>
                            <option value="Barabanki">Barabanki</option>
                            <option value="Bareilly">Bareilly</option>
                            <option value="Basti">Basti</option>
                            <option value="Bhadohi">Bhadohi</option>
                            <option value="Bijnor">Bijnor</option>
                            <option value="Bulandshahr">Bulandshahr</option>
                            <option value="Chandauli">Chandauli</option>
                            <option value="Chitrakoot">Chitrakoot</option>
                            <option value="Deoria">Deoria</option>
                            <option value="Etah">Etah</option>
                            <option value="Etawah">Etawah</option>
                            <option value="Farrukhabad">Farrukhabad</option>
                            <option value="Fatehpur">Fatehpur</option>
                            <option value="Firozabad">Firozabad</option>
                            <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                            <option value="Ghaziabad">Ghaziabad</option>
                            <option value="Ghazipur">Ghazipur</option>
                            <option value="Gonda">Gonda</option>
                            <option value="Gorakhpur">Gorakhpur</option>
                            <option value="Hamirpur">Hamirpur</option>
                            <option value="Hapur">Hapur</option>
                            <option value="Hardoi">Hardoi</option>
                            <option value="Hathras">Hathras</option>
                            <option value="Jalaun">Jalaun</option>
                            <option value="Jaunpur">Jaunpur</option>
                            <option value="Jhansi">Jhansi</option>
                            <option value="Kannauj">Kannauj</option>
                            <option value="Kanpur Dehat">Kanpur Dehat</option>
                            <option value="Kanpur Nagar">Kanpur Nagar</option>
                            <option value="Kasganj">Kasganj</option>
                            <option value="Kaushambi">Kaushambi</option>
                            <option value="Kushinagar">Kushinagar</option>
                            <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                            <option value="Lalitpur">Lalitpur</option>
                            <option value="Lucknow">Lucknow</option>
                            <option value="Maharajganj">Maharajganj</option>
                            <option value="Mahoba">Mahoba</option>
                            <option value="Mainpuri">Mainpuri</option>
                            <option value="Mathura">Mathura</option>
                            <option value="Mau">Mau</option>
                            <option value="Meerut">Meerut</option>
                            <option value="Mirzapur">Mirzapur</option>
                            <option value="Moradabad">Moradabad</option>
                            <option value="Muzaffarnagar">Muzaffarnagar</option>
                            <option value="Pilibhit">Pilibhit</option>
                            <option value="Pratapgarh">Pratapgarh</option>
                            <option value="Rae Bareli">Rae Bareli</option>
                            <option value="Rampur">Rampur</option>
                            <option value="Saharanpur">Saharanpur</option>
                            <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                            <option value="Shahjahanpur">Shahjahanpur</option>
                            <option value="Shravasti">Shravasti</option>
                            <option value="Siddharthnagar">Siddharthnagar</option>
                            <option value="Sitapur">Sitapur</option>
                            <option value="Sonbhadra">Sonbhadra</option>
                            <option value="Sultanpur">Sultanpur</option>
                            <option value="Unnao">Unnao</option>
                            <option value="Varanasi">Varanasi</option>

                            <!-- Uttarakhand -->
                            <option value="Almora">Almora</option>
                            <option value="Bageshwar">Bageshwar</option>
                            <option value="Chamoli">Chamoli</option>
                            <option value="Champawat">Champawat</option>
                            <option value="Dehradun">Dehradun</option>
                            <option value="Haridwar">Haridwar</option>
                            <option value="Nainital">Nainital</option>
                            <option value="Pauri Garhwal">Pauri Garhwal</option>
                            <option value="Pithoragarh">Pithoragarh</option>
                            <option value="Rudraprayag">Rudraprayag</option>
                            <option value="Tehri Garhwal">Tehri Garhwal</option>
                            <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                            <option value="Uttarkashi">Uttarkashi</option>


                            <option value="Other">Other (Specify)</option>
                        </select>
                        <input type="text" id="otherServicesDCOther" name="otherServicesDCOther" class="form-input" placeholder="Specify location" style="display: none; margin-top: 10px;">
                    </div>

                    <!-- Other Services DR Location -->
                    <div class="form-group" id="otherServicesDRGroup" style="display: none;">
                        <label for="otherServicesDR" class="form-label">Other Services Host DR Location</label>
                        <select id="otherServicesDR" name="otherServicesDR" class="form-input" onchange="toggleOtherField('otherServicesDR', 'otherServicesDROther')">
                            <option value="">Select City</option>
                            <!-- Gujarat -->
                            <option value="Ahmedabad">Ahmedabad</option>
                            <option value="Amreli">Amreli</option>
                            <option value="Anand">Anand</option>
                            <option value="Aravalli">Aravalli</option>
                            <option value="Banaskantha">Banaskantha</option>
                            <option value="Bharuch">Bharuch</option>
                            <option value="Bhavnagar">Bhavnagar</option>
                            <option value="Botad">Botad</option>
                            <option value="Chhota Udaipur">Chhota Udaipur</option>
                            <option value="Dahod">Dahod</option>
                            <option value="Dang">Dang</option>
                            <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                            <option value="Gandhinagar">Gandhinagar</option>
                            <option value="Gir Somnath">Gir Somnath</option>
                            <option value="Jamnagar">Jamnagar</option>
                            <option value="Junagadh">Junagadh</option>
                            <option value="Kheda">Kheda</option>
                            <option value="Kutch">Kutch</option>
                            <option value="Mahisagar">Mahisagar</option>
                            <option value="Mehsana">Mehsana</option>
                            <option value="Morbi">Morbi</option>
                            <option value="Narmada">Narmada</option>
                            <option value="Navsari">Navsari</option>
                            <option value="Patan">Patan</option>
                            <option value="Panchmahal">Panchmahal</option>
                            <option value="Porbandar">Porbandar</option>
                            <option value="Rajkot">Rajkot</option>
                            <option value="Sabarkantha">Sabarkantha</option>
                            <option value="Surat">Surat</option>
                            <option value="Surendranagar">Surendranagar</option>
                            <option value="Tapi">Tapi</option>
                            <option value="Vadodara">Vadodara</option>
                            <option value="Valsad">Valsad</option>

                            <!-- Rajasthan -->
                            <option value="Ajmer">Ajmer</option>
                            <option value="Alwar">Alwar</option>
                            <option value="Banswara">Banswara</option>
                            <option value="Baran">Baran</option>
                            <option value="Barmer">Barmer</option>
                            <option value="Bharatpur">Bharatpur</option>
                            <option value="Bhilwara">Bhilwara</option>
                            <option value="Bikaner">Bikaner</option>
                            <option value="Bundi">Bundi</option>
                            <option value="Chittorgarh">Chittorgarh</option>
                            <option value="Churu">Churu</option>
                            <option value="Dausa">Dausa</option>
                            <option value="Dholpur">Dholpur</option>
                            <option value="Dungarpur">Dungarpur</option>
                            <option value="Hanumangarh">Hanumangarh</option>
                            <option value="Jaipur">Jaipur</option>
                            <option value="Jaisalmer">Jaisalmer</option>
                            <option value="Jalore">Jalore</option>
                            <option value="Jhalawar">Jhalawar</option>
                            <option value="Jhunjhunu">Jhunjhunu</option>
                            <option value="Jodhpur">Jodhpur</option>
                            <option value="Karauli">Karauli</option>
                            <option value="Kota">Kota</option>
                            <option value="Nagaur">Nagaur</option>
                            <option value="Pali">Pali</option>
                            <option value="Pratapgarh">Pratapgarh</option>
                            <option value="Rajsamand">Rajsamand</option>
                            <option value="Sikar">Sikar</option>
                            <option value="Sirohi">Sirohi</option>
                            <option value="Sri Ganganagar">Sri Ganganagar</option>
                            <option value="Tonk">Tonk</option>
                            <option value="Udaipur">Udaipur</option>

                            <!-- Maharashtra -->
                            <option value="Ahmednagar">Ahmednagar</option>
                            <option value="Akola">Akola</option>
                            <option value="Amravati">Amravati</option>
                            <option value="Aurangabad">Aurangabad</option>
                            <option value="Beed">Beed</option>
                            <option value="Bhandara">Bhandara</option>
                            <option value="Chandrapur">Chandrapur</option>
                            <option value="Dhule">Dhule</option>
                            <option value="Gadchiroli">Gadchiroli</option>
                            <option value="Gondia">Gondia</option>
                            <option value="Hingoli">Hingoli</option>
                            <option value="Jalgaon">Jalgaon</option>
                            <option value="Jalna">Jalna</option>
                            <option value="Kolhapur">Kolhapur</option>
                            <option value="Latur">Latur</option>
                            <option value="Mumbai City">Mumbai City</option>
                            <option value="Mumbai Suburban">Mumbai Suburban</option>
                            <option value="Nagpur">Nagpur</option>
                            <option value="Nanded">Nanded</option>
                            <option value="Nandurbar">Nandurbar</option>
                            <option value="Nashik">Nashik</option>
                            <option value="Osmanabad">Osmanabad</option>
                            <option value="Palghar">Palghar</option>
                            <option value="Parbhani">Parbhani</option>
                            <option value="Pune">Pune</option>
                            <option value="Raigad">Raigad</option>
                            <option value="Ratnagiri">Ratnagiri</option>
                            <option value="Sangli">Sangli</option>
                            <option value="Satara">Satara</option>
                            <option value="Sindhudurg">Sindhudurg</option>
                            <option value="Solapur">Solapur</option>
                            <option value="Thane">Thane</option>
                            <option value="Wardha">Wardha</option>
                            <option value="Washim">Washim</option>
                            <option value="Yavatmal">Yavatmal</option>

                            <!-- Uttar Pradesh -->
                            <option value="Agra">Agra</option>
                            <option value="Aligarh">Aligarh</option>
                            <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                            <option value="Amethi">Amethi</option>
                            <option value="Amroha">Amroha</option>
                            <option value="Auraiya">Auraiya</option>
                            <option value="Ayodhya">Ayodhya</option>
                            <option value="Azamgarh">Azamgarh</option>
                            <option value="Bagpat">Bagpat</option>
                            <option value="Bahraich">Bahraich</option>
                            <option value="Ballia">Ballia</option>
                            <option value="Balrampur">Balrampur</option>
                            <option value="Banda">Banda</option>
                            <option value="Barabanki">Barabanki</option>
                            <option value="Bareilly">Bareilly</option>
                            <option value="Basti">Basti</option>
                            <option value="Bhadohi">Bhadohi</option>
                            <option value="Bijnor">Bijnor</option>
                            <option value="Bulandshahr">Bulandshahr</option>
                            <option value="Chandauli">Chandauli</option>
                            <option value="Chitrakoot">Chitrakoot</option>
                            <option value="Deoria">Deoria</option>
                            <option value="Etah">Etah</option>
                            <option value="Etawah">Etawah</option>
                            <option value="Farrukhabad">Farrukhabad</option>
                            <option value="Fatehpur">Fatehpur</option>
                            <option value="Firozabad">Firozabad</option>
                            <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                            <option value="Ghaziabad">Ghaziabad</option>
                            <option value="Ghazipur">Ghazipur</option>
                            <option value="Gonda">Gonda</option>
                            <option value="Gorakhpur">Gorakhpur</option>
                            <option value="Hamirpur">Hamirpur</option>
                            <option value="Hapur">Hapur</option>
                            <option value="Hardoi">Hardoi</option>
                            <option value="Hathras">Hathras</option>
                            <option value="Jalaun">Jalaun</option>
                            <option value="Jaunpur">Jaunpur</option>
                            <option value="Jhansi">Jhansi</option>
                            <option value="Kannauj">Kannauj</option>
                            <option value="Kanpur Dehat">Kanpur Dehat</option>
                            <option value="Kanpur Nagar">Kanpur Nagar</option>
                            <option value="Kasganj">Kasganj</option>
                            <option value="Kaushambi">Kaushambi</option>
                            <option value="Kushinagar">Kushinagar</option>
                            <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                            <option value="Lalitpur">Lalitpur</option>
                            <option value="Lucknow">Lucknow</option>
                            <option value="Maharajganj">Maharajganj</option>
                            <option value="Mahoba">Mahoba</option>
                            <option value="Mainpuri">Mainpuri</option>
                            <option value="Mathura">Mathura</option>
                            <option value="Mau">Mau</option>
                            <option value="Meerut">Meerut</option>
                            <option value="Mirzapur">Mirzapur</option>
                            <option value="Moradabad">Moradabad</option>
                            <option value="Muzaffarnagar">Muzaffarnagar</option>
                            <option value="Pilibhit">Pilibhit</option>
                            <option value="Pratapgarh">Pratapgarh</option>
                            <option value="Rae Bareli">Rae Bareli</option>
                            <option value="Rampur">Rampur</option>
                            <option value="Saharanpur">Saharanpur</option>
                            <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                            <option value="Shahjahanpur">Shahjahanpur</option>
                            <option value="Shravasti">Shravasti</option>
                            <option value="Siddharthnagar">Siddharthnagar</option>
                            <option value="Sitapur">Sitapur</option>
                            <option value="Sonbhadra">Sonbhadra</option>
                            <option value="Sultanpur">Sultanpur</option>
                            <option value="Unnao">Unnao</option>
                            <option value="Varanasi">Varanasi</option>

                            <!-- Uttarakhand -->
                            <option value="Almora">Almora</option>
                            <option value="Bageshwar">Bageshwar</option>
                            <option value="Chamoli">Chamoli</option>
                            <option value="Champawat">Champawat</option>
                            <option value="Dehradun">Dehradun</option>
                            <option value="Haridwar">Haridwar</option>
                            <option value="Nainital">Nainital</option>
                            <option value="Pauri Garhwal">Pauri Garhwal</option>
                            <option value="Pithoragarh">Pithoragarh</option>
                            <option value="Rudraprayag">Rudraprayag</option>
                            <option value="Tehri Garhwal">Tehri Garhwal</option>
                            <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                            <option value="Uttarkashi">Uttarkashi</option>


                            <option value="Other">Other (Specify)</option>
                        </select>
                        <input type="text" id="otherServicesDROther" name="otherServicesDROther" class="form-input" placeholder="Specify location" style="display: none; margin-top: 10px;">
                    </div>

                    <!-- Is Bank direct member of RBI and NPCI? -->
                    <div class="form-group">
                        <label class="form-label">Is Bank direct member of RBI and NPCI?*</label>
                        <div style="display: flex; gap: 20px;">
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="radio" name="isDirectMember" value="Yes" required onchange="toggleSubmemberBanksField(true)"> Yes
                            </label>
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="radio" name="isDirectMember" value="No" required onchange="toggleSubmemberBanksField(false)"> No
                            </label>
                        </div>
                    </div>

                    <!-- Sub-member banks -->
                    <div class="form-group" id="submemberBanksGroup" style="display: none;">
                        <label for="numberOfSubmemberBanks" class="form-label">Number of Sub-member Banks</label>
                        <input type="number" id="numberOfSubmemberBanks" name="numberOfSubmemberBanks" class="form-input" placeholder="Enter number" min="0">
                    </div>

                    <!-- Sponsor Bank -->
                    <div class="form-group">
                        <label for="sponsorBankName" class="form-label">Sponsor Bank Name</label>
                        <select id="sponsorBankName" name="sponsorBankName" class="form-input" onchange="toggleOtherField('sponsorBankName', 'sponsorBankNameOther')">
                            <option value="">Select Sponsor Bank</option>
                            <option value="State Bank of India">State Bank of India</option>
                            <option value="HDFC Bank">HDFC Bank</option>
                            <option value="ICICI Bank">ICICI Bank</option>
                            <option value="Other">Other (Specify)</option>
                        </select>
                        <input type="text" id="sponsorBankNameOther" name="sponsorBankNameOther" class="form-input" placeholder="Specify sponsor bank" style="display: none; margin-top: 10px;">
                    </div>

                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Software & Security Details</h4>
                    </div>

                    <!-- Hardware Vendor -->
                    <div class="form-group">
                        <label for="hardwareVendorName" class="form-label">Hardware Vendor Name*</label>
                        <input type="text" id="hardwareVendorName" name="hardwareVendorName" class="form-input" placeholder="e.g., Dell, HP, Cisco" required>
                    </div>

                    <!-- Antivirus -->
                    <div class="form-group">
                        <label for="antivirusName" class="form-label">Antivirus Name*</label>
                        <input type="text" id="antivirusName" name="antivirusName" class="form-input" placeholder="e.g., McAfee, Symantec, Quick Heal" required>
                    </div>

                    <!-- Antimalware Solution -->
                    <div class="form-group">
                        <label class="form-label">Antimalware Solution*</label>
                        <div style="display: flex; gap: 20px;">
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="radio" name="hasAntimalware" value="Yes" required onchange="toggleAntimalwareField(true)"> Yes
                            </label>
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="radio" name="hasAntimalware" value="No" required onchange="toggleAntimalwareField(false)"> No
                            </label>
                        </div>
                        <input type="text" id="antimalwareName" name="antimalwareName" class="form-input" placeholder="Specify antimalware solution name" style="display: none; margin-top: 10px;">
                    </div>

                    <!-- Mail and Messaging -->
                    <div class="form-group">
                        <label for="mailMessagingService" class="form-label">Mail and Messaging Service Name*</label>
                        <input type="text" id="mailMessagingService" name="mailMessagingService" class="form-input" placeholder="e.g., Microsoft Exchange, Gmail" required>
                    </div>

                    <!-- Bank has AD -->
                    <div class="form-group">
                        <label class="form-label">Bank has AD (Active Directory)?*</label>
                        <div style="display: flex; gap: 20px;">
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="radio" name="hasAD" value="Yes" required> Yes
                            </label>
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="radio" name="hasAD" value="No" required> No
                            </label>
                        </div>
                    </div>

                    <!-- Bank has PAM -->
                    <div class="form-group">
                        <label class="form-label">Bank has PAM (Privileged Access Management)?*</label>
                        <div style="display: flex; gap: 20px;">
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="radio" name="hasPAM" value="Yes" required onchange="togglePAMField(true)"> Yes
                            </label>
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="radio" name="hasPAM" value="No" required onchange="togglePAMField(false)"> No
                            </label>
                        </div>
                        <input type="text" id="pamName" name="pamName" class="form-input" placeholder="Specify PAM solution name" style="display: none; margin-top: 10px;">
                    </div>

                    <!-- CBS and Non-CBS Applications -->
                    <div class="form-group">
                        <label class="form-label">Name of CBS and Non-CBS Applications*</label>
                        <div id="applicationsContainer">
                            <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                                <input type="text" name="applications[]" class="form-input" placeholder="Enter application name" required style="flex: 1;">
                                <button type="button" class="submit-btn" onclick="addApplicationField()" style="flex: 0 0 40px; padding: 8px;">+</button>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Upload Files</h4>
                    </div>

                    <!-- Excel File 1 -->
                    <div class="form-group">
                        <label for="excelFile1" class="form-label">Asset Review Non-Compliance Points Excel File (.xlsx, .xls)*</label>
                        <input type="file" id="excelFile1" name="excelFile1" class="form-input" accept=".xlsx,.xls" required>
                        <small class="form-help">Please upload the Excel file which is for Asset Review Non-Compliance Points</small>
                    </div>

                    <!-- Excel File 2 -->
                    <div class="form-group">
                        <label for="excelFile2" class="form-label">Combined Branch Excel without POC Excel File (.xlsx, .xls)*</label>
                        <input type="file" id="excelFile2" name="excelFile2" class="form-input" accept=".xlsx,.xls" required>
                        <small class="form-help">Please upload the Excel file which is for Combined Branch Excel without Evidance</small>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeModal('isAuditWordReportModal')">Cancel</button>
                        <button type="submit" class="submit-btn" id="isAuditWordReportSubmitBtn">Generate Report</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- VICS Modal -->
    <div id="vicsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>VICS</h3>
                <span class="close-modal" onclick="closeModal('vicsModal')">&times;</span>
            </div>
            <div class="modal-body">
                <div class="assets-list">
                    <ol>
                        <li onclick="openModal('vicsPart1Modal')" style="cursor: pointer;">Part 1: IT Asset Management | Preventing unauthorised software | Environment controls - 17 Marks</li>
                        <li onclick="openModal('vicsPart2Modal')" style="cursor: pointer;">Part 2: Network management | Antivirus and patch management | Access Control - 29 Marks</li>
                        <li onclick="openModal('vicsPart3Modal')" style="cursor: pointer;">Part 3: Removable Media | Secure Configuration and Backup Management | Cyber Security Framework Compliance - 15 Marks</li>
                        <li onclick="openModal('vicsPart4Modal')" style="cursor: pointer;">Part 4: Threat Intelligence and VAPT Management | Secure mail and messaging | Awareness / trainings on Cyber Security - 13 Marks</li>
                        <li onclick="openModal('vicsPart5Modal')" style="cursor: pointer;">Part 5: Policies and procedures | Governance | Information System Audit | Chief Information Security Officer (CISO) - 30 Marks</li>
                        <li onclick="openModal('vicsPart6Modal')" style="cursor: pointer;">Part 6: Vendor On-boarding | Oversight and Review of Vendors | Addressing security in SLA | Compliance Adherence with legal and regulatory compliances | Dependency on Vendor staffs - 30 Marks</li>
                        <li onclick="openModal('vicsPart7Modal')" style="cursor: pointer;">Part 7: Cyber Crisis/ Incident Management | Detection and Response to cyber incidents | Corrective actions, Collection of evidence and Reporting - 16 Marks</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <!-- Create VICS Worksheet Modal -->
    <div id="createVICSWorksheetModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>Create VICS Worksheet</h3>
                <span class="close-modal" onclick="closeModal('createVICSWorksheetModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="createVICSWorksheetForm" enctype="multipart/form-data">
                    <div class="form-group">
                        <label class="form-label">VICS Parts - ZIP File</label>
                        <input type="file" name="vics_parts_zip" id="vics_parts_zip" class="form-input" accept=".zip" required>
                        <small style="color: #666; display: block; margin-top: 5px;">Upload ZIP file containing VICS all parts Excel files</small>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Evidance - ZIP File</label>
                        <input type="file" name="vics_parts_zip2" id="vics_parts_zip2" class="form-input" accept=".zip" required>
                        <small style="color: #666; display: block; margin-top: 5px;">Please upload a ZIP file containing the VICS evidence. The evidence image file names inside this ZIP must be strictly mapped according to the point numbers mentioned in the VICS Questions. For example, for the question “1.1 Whether all IT Assets (both hardware and software) have been inventoried?”, the corresponding evidence file names must begin with the point number “1_1”. Valid naming examples include “1_1 Asset Inventory.png”, “1_1 Software Inventory.png”, and “1_1 Hardware Inventory.png”. Following the correct naming format is mandatory to ensure proper automated mapping and accurate evidence placement in the final report.</small>
                    </div>
                    
                    <div class="form-group" style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('createVICSWorksheetModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="createVICSWorksheetSubmitBtn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Create VICS Worksheet with Bank Input Modal -->
    <div id="createVICSWithBankInputModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>Create VICS Worksheet with Bank Input</h3>
                <span class="close-modal" onclick="closeModal('createVICSWithBankInputModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="createVICSWithBankInputForm" enctype="multipart/form-data">
                    <div class="form-group">
                        <label class="form-label">Upload Generated VICS Excel File</label>
                        <input type="file" name="vics_file1" id="vics_file1" class="form-input" accept=".xlsx,.xls" required>
                        <small style="color: #666; display: block; margin-top: 5px;">Upload the Excel file that is generated through this tool.</small>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Upload the Excel File with Bank Input Column</label>
                        <input type="file" name="vics_file2" id="vics_file2" class="form-input" accept=".xlsx,.xls" required>
                        <small style="color: #666; display: block; margin-top: 5px;">Kindly download the <a href="/static/Formats_and_Catalog/Sample_Files/VICS Bank Input Worksheet.xlsx" download="VICS Bank Input Worksheet.xlsx" style="color: #007bff; text-decoration: underline; cursor: pointer;"> Excel file</a> and fill in the "Marks Given by Bank" column. After completing the required entries, please upload the updated Excel file here.</small>
                    </div>
                    
                    <div class="form-group" style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('createVICSWithBankInputModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="createVICSWithBankInputSubmitBtn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- LOC Modal -->
    <div id="locModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>LOC - List of Compliances</h3>
                <span class="close-modal" onclick="closeModal('locModal')">&times;</span>
            </div>
            <div class="modal-body">
                <div class="assets-list">
                    <ol>
                        <li onclick="openModal('locLevel2Modal')" style="cursor: pointer;">Level 2: Network Management and Security | Secure Configuration | Application Security Life Cycle(ASLC) | Change Management | Periodic Testing | User Access Control/Management | Authentication Framework for Customers | Anti-Phishing | User/Employee/Management Awareness | Audit Logs | Incident Response and Management</li>
                        <li onclick="openModal('locLevel3Modal')" style="cursor: pointer;">Level 3: Network Management and Security | Secure Configuration | Application Security Life Cycle(ASLC) | User Access Control | Advance Real-time Threat Defence and Management | Maintenance, Monitoring and Analysis of Audit Logs | Incident Response and Management | Risk based transaction monitoring</li>
                        <li onclick="openModal('locLevel4Modal')" style="cursor: pointer;">Level 4: Arrangement for continuous surveillance- Setting up of Cyber Security Operation Centre(C-SOC) | If Yes, CSOC in place then answer the following | Expectations from C-SOC | Steps for setting up C-SOC- Technological Aspects | Participation in Cyber Drills | Incident Response and Management | Forensics and Metrics | IT Strategy and Policy | IT and IS governance Framework | IT strategy Committee | IT Steering Committee | CISO</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <!-- LOC Level 2 Modal -->
    <div id="locLevel2Modal" class="modal">
        <div class="modal-content" style="max-width: 1200px;">
            <div class="modal-header">
                <h3>LOC Level 2: Compliance Requirements</h3>
                <span class="close-modal" onclick="closeModal('locLevel2Modal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="locLevel2Form" method="POST" onsubmit="handleLOCLevel2Submit(event)">
                    
                    <!-- Network Management and Security Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">1. Network Management and Security</h4>
                    </div>

                    <!-- Question 1_A -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">1_A. Do you have a centralised inventory of authorised devices and other related network devices connected to banks network (within/outside banks premises)?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q1_A" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 1_B -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">1_B. Whether boundary defence for banks network is multi-layered?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q1_B" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 1_C -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">1_C. Whether Firewall configured in Boundary defence?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q1_C" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 1_D -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">1_D. Whether proxy servers configured in boundary defence system?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q1_D" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 1_E -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">1_E. Whether De-Militarized Zone (DMZ) is implemented in boundary defence system?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q1_E" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 1_F -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">1_F. Whether Network-based Intrusion Prevention System, Intrusion Detection System or other perimeter networks installed?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q1_F" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 1_G -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">1_G. Whether the boundary defence system put in place is able to filter both inbound and outbound traffic?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q1_G" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 1_H -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">1_H. Do you have in-house or onsite ATM facility at HO or any of the branches of the bank? If no, skip the next question.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q1_H" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 1_I -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">1_I. Whether LAN segments for in-house/onsite ATM and CBS/branch network are different?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q1_I" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Secure Configuration Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">2. Secure Configuration</h4>
                    </div>

                    <!-- Question 2_A -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">2_A. Whether baseline security requirements/configurations are applied to all categories of devices i.e. end-points/workstations, mobile devices, operating systems, databases, applications, network devices, security devices, security systems etc. throughout their lifecycle (from conception to deployment)?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q2_A" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 2_B -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">2_B. Whether the security requirements/configurations for each and every device is documented?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q2_B" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 2_C -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">2_C. Whether the security requirements/configurations applied on devices are reviewed periodically?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q2_C" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Application Security Life Cycle Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">3. Application Security Life Cycle (ASLC)</h4>
                    </div>

                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">3_A. Is the bank developing any software application? Answer Yes even if the software development was completed during last financial year.</label></div><div class="form-col" style="flex: 1;"><select name="q3_A" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">3_B. Whether the development/test environments were/are properly segregated from production environments?</label></div><div class="form-col" style="flex: 1;"><select name="q3_B" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">3_C. Whether the data used for development and testing of application/software was/is appropriately masked?</label></div><div class="form-col" style="flex: 1;"><select name="q3_C" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">3_D. Whether secure coding principles were/are adhered to in case of software/application development approach?</label></div><div class="form-col" style="flex: 1;"><select name="q3_D" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">3_E. Whether security testing and secure rollout were/are done as per global standards, in case of software/application development approach?</label></div><div class="form-col" style="flex: 1;"><select name="q3_E" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <!-- Change Management Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">4. Change Management</h4>
                    </div>

                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">4_A. Whether bank has a change management process in place to record and monitor all changes that are moved/pushed into production environment by bank/software vendor?</label></div><div class="form-col" style="flex: 1;"><select name="q4_A" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">4_B. Whether there was change in any business applications or supporting technology or service components and facilities during the last year?</label></div><div class="form-col" style="flex: 1;"><select name="q4_B" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">4_C. Whether configuration management processes were employed by the bank/vendor?</label></div><div class="form-col" style="flex: 1;"><select name="q4_C" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <!-- Periodic Testing Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">5. Periodic Testing</h4>
                    </div>

                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">5_A. Whether Vulnerability Assessment (VA) / Penetration Testing (PT) of internet facing or web or mobile applications or servers and/or network components were conducted in pre-implementation stage?</label></div><div class="form-col" style="flex: 1;"><select name="q5_A" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">5_B. Whether periodic Vulnerability Assessment (VA) / Penetration Testing (PT) of internet facing or web or mobile applications or servers and/or network components are being conducted in post-implementation stage?</label></div><div class="form-col" style="flex: 1;"><select name="q5_B" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">5_C. Whether Vulnerability Assessment (VA) of critical applications and those on DMZ are conducted at least once every six months?</label></div><div class="form-col" style="flex: 1;"><select name="q5_C" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">5_D. Whether Penetration Testing (PT) of critical applications and those on DMZ are conducted at least once in a year?</label></div><div class="form-col" style="flex: 1;"><select name="q5_D" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">5_E. Whether the bank has its CBS on a shared infrastructure of an Application Service Provider (CBS-ASP) / Apex Bank / Sponsor bank? If no, skip the next question.</label></div><div class="form-col" style="flex: 1;"><select name="q5_E" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">5_F. Whether VA/PT is conducted for CBS provided by ASP (CBS-ASP) / Apex Bank / Sponsor bank on shared infrastructure?</label></div><div class="form-col" style="flex: 1;"><select name="q5_F" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">5_G. Whether security testing of web/mobile applications is conducted before going live and after every major change in the applications?</label></div><div class="form-col" style="flex: 1;"><select name="q5_G" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">5_H. Whether the vulnerabilities detected through VA/PT are remedied as per bank's risk management framework?</label></div><div class="form-col" style="flex: 1;"><select name="q5_H" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">5_I. Are the VA and/or PTs conducted by professionally qualified teams?</label></div><div class="form-col" style="flex: 1;"><select name="q5_I" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">5_J. Whether findings of the VA and/or PT reports were placed before IT Sub Committee of the Board and/or Board of Directors?</label></div><div class="form-col" style="flex: 1;"><select name="q5_J" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">5_K. Whether follow-up action was taken on findings of the VA and/or PT reports by IS/IT/Audit/Top Management team?</label></div><div class="form-col" style="flex: 1;"><select name="q5_K" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <!-- User Access Control/Management Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">6. User Access Control/Management</h4>
                    </div>

                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">6_A. Whether the access to bank's assets/services from within or outside bank's network is secured by use of encryption for data at rest?</label></div><div class="form-col" style="flex: 1;"><select name="q6_A" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">6_B. Whether the access to bank's assets/services from within or outside bank's network is secured through VPN/standard technologies for in-transit data?</label></div><div class="form-col" style="flex: 1;"><select name="q6_B" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <!-- Authentication Framework for Customers Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">7. Authentication Framework for Customers</h4>
                    </div>

                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">7_A. Whether the bank has a centralised authentication methodology to ensure transactions (including customer access credential) are only put through genuine authorised applications?</label></div><div class="form-col" style="flex: 1;"><select name="q7_A" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">7_B. Has the bank implemented authentication framework/mechanism to securely verify and identify the banks applications to customers?</label></div><div class="form-col" style="flex: 1;"><select name="q7_B" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">7_C. Are digital certificates being used to securely verify and identify banks application to customers?</label></div><div class="form-col" style="flex: 1;"><select name="q7_C" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <!-- Anti-Phishing Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">8. Anti-Phishing</h4>
                    </div>

                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">8_A. Whether bank has subscribed to anti-phishing/anti-rogue application services from external service providers for identifying and taking down phishing websites/rogue applications?</label></div><div class="form-col" style="flex: 1;"><select name="q8_A" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <!-- User/Employee/Management Awareness Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">9. User/Employee/Management Awareness</h4>
                    </div>

                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">9_A. Whether efforts are made to encourage employees to report suspicious behaviour and incidents to the incident management team?</label></div><div class="form-col" style="flex: 1;"><select name="q9_A" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">9_B. Whether bank is conducting mandatory awareness programs on cyber security for newly recruited employees?</label></div><div class="form-col" style="flex: 1;"><select name="q9_B" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">9_C. Whether web-based quiz and training are conducted for all levels of management every year?</label></div><div class="form-col" style="flex: 1;"><select name="q9_C" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">9_D. Whether arrangements are made to sensitise Board members on various technological and cyber security related developments periodically?</label></div><div class="form-col" style="flex: 1;"><select name="q9_D" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <!-- Audit Logs Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">10. Audit Logs</h4>
                    </div>

                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">10_A. Whether the system captures audit logs of user actions?</label></div><div class="form-col" style="flex: 1;"><select name="q10_A" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">10_B. Whether alert mechanism is activated to monitor changes in audit log settings?</label></div><div class="form-col" style="flex: 1;"><select name="q10_B" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <!-- Incident Response and Management Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">11. Incident Response and Management</h4>
                    </div>

                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">11_A. Does the bank have written/documented incident response procedures including roles/staff/outsourced staff to handle cyber incidents?</label></div><div class="form-col" style="flex: 1;"><select name="q11_A" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <div class="form-group" style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('locLevel2Modal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="locLevel2SubmitBtn">
                            <i class="fas fa-check"></i> Submit
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- LOC Level 3 Modal -->
    <div id="locLevel3Modal" class="modal">
        <div class="modal-content" style="max-width: 1200px;">
            <div class="modal-header">
                <h3>LOC Level 3: Compliance Requirements</h3>
                <span class="close-modal" onclick="closeModal('locLevel3Modal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="locLevel3Form" method="POST" onsubmit="handleLOCLevel3Submit(event)">
                    
                    <!-- Section 12: Network Management and Security -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">12. Network Management and Security</h4>
                    </div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">12_A. Whether appropriate mechanisms to detect and remedy any unusual activity in systems, servers, network devices and endpoints are in place?</label></div><div class="form-col" style="flex: 1;"><select name="q12_A" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">12_B. Whether Firewall rules have been defined to block unidentified outbound connections, reverse TCP shells and other potential backdoor connections?</label></div><div class="form-col" style="flex: 1;"><select name="q12_B" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <!-- Section 13: Secure Configuration -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">13. Secure Configuration</h4>
                    </div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">13_A. Do you have ATM Switch or SWIFT Interface? (If no, skip the next 2 questions.)</label></div><div class="form-col" style="flex: 1;"><select name="q13_A" id="q13_A" class="form-input" required onchange="toggleLOCLevel3SkipQuestions()"><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group" id="q13_B_group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">13_B. Whether IP table is enabled to restrict access of the clients and servers in ATM Switch environment only to authorised systems?</label></div><div class="form-col" style="flex: 1;"><select name="q13_B" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group" id="q13_C_group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">13_C. Has the bank ensured the software integrity of the ATM Switch / SWITCH related applications?</label></div><div class="form-col" style="flex: 1;"><select name="q13_C" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">13_D. Whether PowerShell is disabled in Desktop systems?</label></div><div class="form-col" style="flex: 1;"><select name="q13_D" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">13_E. Whether PowerShell is disabled in Servers where it is not required?</label></div><div class="form-col" style="flex: 1;"><select name="q13_E" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">13_F. Have the default shares including IPC$ share (inter-process communication share) been restricted?</label></div><div class="form-col" style="flex: 1;"><select name="q13_F" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <!-- Section 14: Application Security Life Cycle -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">14. Application Security Life Cycle (ASLC)</h4>
                    </div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">14_A. Did the bank develop any software application during the current financial year? (If "No" then skip next questions.)</label></div><div class="form-col" style="flex: 1;"><select name="q14_A" id="q14_A" class="form-input" required onchange="toggleLOCLevel3SkipQuestions()"><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group" id="q14_B_group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">14_B. Whether source code audits were conducted for critical business applications by professionally competent personnel/service providers?</label></div><div class="form-col" style="flex: 1;"><select name="q14_B" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group" id="q14_C_group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">14_C. Whether security requirements relating to system access control are ensured throughout the stages of system development/acquisition/implementation?</label></div><div class="form-col" style="flex: 1;"><select name="q14_C" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group" id="q14_D_group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">14_D. Whether security requirements relating to user authentication are ensured throughout the stages of system development/acquisition/implementation?</label></div><div class="form-col" style="flex: 1;"><select name="q14_D" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group" id="q14_E_group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">14_E. Whether security requirements relating to transaction authorization are ensured throughout the stages of system development/acquisition/implementation?</label></div><div class="form-col" style="flex: 1;"><select name="q14_E" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group" id="q14_F_group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">14_F. Whether security requirements relating to data integrity are ensured throughout the stages of system development/acquisition/implementation?</label></div><div class="form-col" style="flex: 1;"><select name="q14_F" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group" id="q14_G_group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">14_G. Whether security requirements relating to system activity logging and audit trail are ensured throughout the stages of system development/acquisition/implementation?</label></div><div class="form-col" style="flex: 1;"><select name="q14_G" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group" id="q14_H_group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">14_H. Whether security requirements relating to session management are ensured throughout the stages of system development/acquisition/implementation?</label></div><div class="form-col" style="flex: 1;"><select name="q14_H" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group" id="q14_I_group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">14_I. Whether security requirements relating to security event tracking are ensured throughout the stages of system development/acquisition/implementation?</label></div><div class="form-col" style="flex: 1;"><select name="q14_I" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group" id="q14_J_group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">14_J. Whether security requirements relating to exception handling are ensured throughout the stages of system development/acquisition/implementation?</label></div><div class="form-col" style="flex: 1;"><select name="q14_J" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group" id="q14_K_group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">14_K. Whether software/application development practices adopt the principle of defence-in-depth to provide layered security mechanisms?</label></div><div class="form-col" style="flex: 1;"><select name="q14_K" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group" id="q14_L_group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">14_L. Whether application providers/OEMs have given assurance that applications are free from embedded malicious/fraudulent code?</label></div><div class="form-col" style="flex: 1;"><select name="q14_L" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group" id="q14_M_group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">14_M. Do you have proper guidelines in place to ensure that adoption of new technologies is adequately evaluated for existing/evolving security threats?</label></div><div class="form-col" style="flex: 1;"><select name="q14_M" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group" id="q14_N_group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">14_N. Do you have guidelines for IT/security teams to first achieve reasonable maturity with new technologies before introducing them for critical systems?</label></div><div class="form-col" style="flex: 1;"><select name="q14_N" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <!-- Section 15: User Access Control -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">15. User Access Control</h4>
                    </div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">15_A. Applicable to all infrastructure management modes (in-house/shared/service provider). All user access controls must be ensured.</label></div><div class="form-col" style="flex: 1;"><select name="q15_A" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">15_B. Whether a centralised authentication and authorisation system through an Identity and Access Management solution has been implemented?</label></div><div class="form-col" style="flex: 1;"><select name="q15_B" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">15_C. Is the centralised authentication and authorisation system implemented for accessing and administering operating systems?</label></div><div class="form-col" style="flex: 1;"><select name="q15_C" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">15_D. Is the centralised authentication and authorisation system implemented for accessing and administering databases?</label></div><div class="form-col" style="flex: 1;"><select name="q15_D" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">15_E. Is the centralised authentication and authorisation system implemented for accessing and administering network and security devices/systems?</label></div><div class="form-col" style="flex: 1;"><select name="q15_E" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">15_F. Is the centralised authentication and authorisation system implemented for accessing and administering other critical applications?</label></div><div class="form-col" style="flex: 1;"><select name="q15_F" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">15_G. Do you have a centralised authentication and authorisation system for accessing all points of connectivity (local/remote)?</label></div><div class="form-col" style="flex: 1;"><select name="q15_G" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">15_H. Does the centralised authentication and authorisation system enforce strong password policy?</label></div><div class="form-col" style="flex: 1;"><select name="q15_H" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">15_I. Does the centralised authentication and authorisation system enforce two-factor/multi-factor authentication?</label></div><div class="form-col" style="flex: 1;"><select name="q15_I" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">15_J. Does the bank/vendor policy for privileged access follow the principle of least privilege and separation of duties?</label></div><div class="form-col" style="flex: 1;"><select name="q15_J" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">15_K. Have you implemented Active Directory or Endpoint Management systems to implement centralised policies like whitelisting, blacklisting, restricting removable media, etc.?</label></div><div class="form-col" style="flex: 1;"><select name="q15_K" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <!-- Section 16: Advanced Real-time Threat Defence -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">16. Advanced Real-time Threat Defence and Management</h4>
                    </div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">16_A. Have you set in place proper defence mechanisms against the installation, spread and execution of malicious code at multiple points in the enterprise?</label></div><div class="form-col" style="flex: 1;"><select name="q16_A" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">16_B. Whether mechanism for whitelisting of internet websites/systems has been put in place?</label></div><div class="form-col" style="flex: 1;"><select name="q16_B" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <!-- Section 17: Maintenance, Monitoring and Analysis of Audit Logs -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">17. Maintenance, Monitoring and Analysis of Audit Logs</h4>
                    </div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">17_A. Whether procedure laid down for consulting all stakeholders before finalising the scope, frequency and storage of log collection?</label></div><div class="form-col" style="flex: 1;"><select name="q17_A" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">17_B. Whether there is an established system for analysis and management of audit logs to detect, respond, understand or recover from an attack?</label></div><div class="form-col" style="flex: 1;"><select name="q17_B" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">17_C. Whether audit log/audit trail is captured for all devices, system software and application software?</label></div><div class="form-col" style="flex: 1;"><select name="q17_C" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">17_D. Whether all the settings for all audit logs are validated periodically?</label></div><div class="form-col" style="flex: 1;"><select name="q17_D" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">17_E. Whether the logs are properly captured with minimum information to uniquely identify the log?</label></div><div class="form-col" style="flex: 1;"><select name="q17_E" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <!-- Section 18: Incident Response and Management -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">18. Incident Response and Management</h4>
                    </div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">18_A. Whether bank's existing BCP/DR capabilities are properly in tune with its cyber resilience objectives?</label></div><div class="form-col" style="flex: 1;"><select name="q18_A" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">18_B. Do you have necessary arrangements with third-party vendors/service providers for implementation of Incident Response and Management?</label></div><div class="form-col" style="flex: 1;"><select name="q18_B" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">18_C. Do you have necessary mechanisms with third-party vendors/service providers to get timely information about any cyber security incident for early mitigation of risk and compliance with regulatory requirements?</label></div><div class="form-col" style="flex: 1;"><select name="q18_C" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">18_D. Do you have mechanisms to continually improve response strategy by dynamically incorporating gained knowledge in the Incident Response Procedure/BCP?</label></div><div class="form-col" style="flex: 1;"><select name="q18_D" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <!-- Section 19: Risk Based Transaction Monitoring -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">19. Risk Based Transaction Monitoring</h4>
                    </div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">19_A. Whether bank is a direct member of CPS and has its own ATM switch interface or SWIFT interface?</label></div><div class="form-col" style="flex: 1;"><select name="q19_A" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">19_B. If yes, whether bank has implemented risk-based transaction monitoring or surveillance as part of Fraud Risk Management Systems across all delivery channels?</label></div><div class="form-col" style="flex: 1;"><select name="q19_B" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <div class="form-group" style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('locLevel3Modal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="locLevel3SubmitBtn">
                            <i class="fas fa-check"></i> Submit
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- LOC Level 4 Modal -->
    <div id="locLevel4Modal" class="modal">
        <div class="modal-content" style="max-width: 1200px;">
            <div class="modal-header">
                <h3>LOC Level 4: Compliance Requirements</h3>
                <span class="close-modal" onclick="closeModal('locLevel4Modal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="locLevel4Form" method="POST" onsubmit="handleLOCLevel4Submit(event)">
                    
                    <!-- Section 20: CSOC -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">20. Arrangement for continuous surveillance- Setting up of Cyber Security Operation Centre(C-SOC)</h4>
                    </div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">20_A. Does the bank have continuous surveillance through Cyber Security Operations Centre (CSOC)? (Answer Yes if the bank has CSOC of any kind – owned, shared, with ASP/MSSP, association, hybrid, or any other)</label></div><div class="form-col" style="flex: 1;"><select name="q20_A" id="q20_A" class="form-input" required onchange="toggleLOCLevel4Section21()"><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <!-- Section 21: CSOC Ownership (conditional) -->
                    <div id="section21" style="display: none;">
                        <div class="form-group">
                            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">21. If Yes, CSOC in place then answer the following</h4>
                        </div>
                        <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">21_A. CSOC fully owned and managed by it</label></div><div class="form-col" style="flex: 0.7;"><select name="q21_A" class="form-input"><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div><div class="form-col" style="flex: 0.7;"><input type="text" name="q21_A_input" class="form-input" placeholder="Details"></div></div></div>
                        <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">21_B. Sharing CSOC with Apex Bank / Sponsor Bank / group of DCCBs in the same State</label></div><div class="form-col" style="flex: 0.7;"><select name="q21_B" class="form-input"><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div><div class="form-col" style="flex: 0.7;"><input type="text" name="q21_B_input" class="form-input" placeholder="Details"></div></div></div>
                        <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">21_C. Availing CSOC services from a shared CSOC set up by an Association / Federation</label></div><div class="form-col" style="flex: 0.7;"><select name="q21_C" class="form-input"><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div><div class="form-col" style="flex: 0.7;"><input type="text" name="q21_C_input" class="form-input" placeholder="Details"></div></div></div>
                        <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">21_D. Engaged Managed Security Service Provider (MSSP)</label></div><div class="form-col" style="flex: 0.7;"><select name="q21_D" class="form-input"><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div><div class="form-col" style="flex: 0.7;"><input type="text" name="q21_D_input" class="form-input" placeholder="Details"></div></div></div>
                        <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">21_E. Hybrid model - Own the infrastructure but managed by professionals from IT companies</label></div><div class="form-col" style="flex: 0.7;"><select name="q21_E" class="form-input"><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div><div class="form-col" style="flex: 0.7;"><input type="text" name="q21_E_input" class="form-input" placeholder="Details"></div></div></div>
                        <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">21_F. Other</label></div><div class="form-col" style="flex: 0.7;"><select name="q21_F" class="form-input"><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div><div class="form-col" style="flex: 0.7;"><input type="text" name="q21_F_input" class="form-input" placeholder="Details"></div></div></div>
                    </div>

                    <!-- Section 22: Expectations from C-SOC -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">22. Expectations from C-SOC</h4>
                    </div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">22_A. Whether guidelines for C-SOC have been framed including eligibility criteria, roles and responsibilities, and details of functionalities?</label></div><div class="form-col" style="flex: 1;"><select name="q22_A" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">22_B. Whether CSOC complies with laws and regulations in the country for protection of business and customer data/information?</label></div><div class="form-col" style="flex: 1;"><select name="q22_B" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">22_C. Can compliance for Q(93) be demonstrated (through documentation, policies, processes, logs, records of activities, governance/oversight)?</label></div><div class="form-col" style="flex: 1;"><select name="q22_C" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">22_D. Ability to provide real-time/near real-time information on security posture of the bank to senior management?</label></div><div class="form-col" style="flex: 1;"><select name="q22_D" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">22_E. Can the C-SOC monitor logs of various network activities and escalate abnormal/undesirable activities?</label></div><div class="form-col" style="flex: 1;"><select name="q22_E" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">22_F. Whether all log types and logging options are integrated with Security Information and Event Management (SIEM) system?</label></div><div class="form-col" style="flex: 1;"><select name="q22_F" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <!-- Section 23: Steps for setting up C-SOC -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">23. Steps for setting up C-SOC- Technological Aspects</h4>
                    </div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">23_A. Whether a suitable technology framework is designed and implemented to ensure proactive monitoring capabilities and meet business/regulatory requirements?</label></div><div class="form-col" style="flex: 1;"><select name="q23_A" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">23_B. Does the CSOC include a security analytics engine capable of processing logs within reasonable time and providing recommendations with options for further deep-dive investigations?</label></div><div class="form-col" style="flex: 1;"><select name="q23_B" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">23_C. Whether deep packet inspection (DPI) is introduced?</label></div><div class="form-col" style="flex: 1;"><select name="q23_C" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">23_D. Does CSOC have tools and technologies for malware detection and imaging solutions for data?</label></div><div class="form-col" style="flex: 1;"><select name="q23_D" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">23_E. Does CSOC have forensic analysis capability?</label></div><div class="form-col" style="flex: 1;"><select name="q23_E" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">23_F. Is the CSOC designed for scalability?</label></div><div class="form-col" style="flex: 1;"><select name="q23_F" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">23_G. Does the CSOC offer high availability?</label></div><div class="form-col" style="flex: 1;"><select name="q23_G" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <!-- Section 24: Participation in Cyber Drills -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">24. Participation in Cyber Drills</h4>
                    </div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">24_A. Whether the bank participates in cyber drills conducted under the aegis of CERT-IN, IDRBT, etc.?</label></div><div class="form-col" style="flex: 1;"><select name="q24_A" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <!-- Section 25: Incident Response and Management -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">25. Incident Response and Management</h4>
                    </div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">25_A. Have you developed incident response capabilities in all interconnected systems and networks?</label></div><div class="form-col" style="flex: 1;"><select name="q25_A" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">25_B. Have you developed incident response capabilities for interconnected systems and networks of vendors and partners?</label></div><div class="form-col" style="flex: 1;"><select name="q25_B" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">25_C. Have you tested and demonstrated readiness through a collaborative and coordinated approach to meet the bank's recovery time objectives?</label></div><div class="form-col" style="flex: 1;"><select name="q25_C" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">25_D. Have you implemented policy and framework for aligning Security Operations Centre, Incident Response, and Digital Forensics to reduce business downtime/restore normalcy?</label></div><div class="form-col" style="flex: 1;"><select name="q25_D" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <!-- Section 26: Forensics and Metrics -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">26. Forensics and Metrics</h4>
                    </div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">26_A. Whether a comprehensive set of metrics has been developed to provide prospective and retrospective measures like KPIs and KRIs?</label></div><div class="form-col" style="flex: 1;"><select name="q26_A" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">26_B. Do you have support/arrangements for network forensics/forensic investigations?</label></div><div class="form-col" style="flex: 1;"><select name="q26_B" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">26_C. Do you have support/arrangements for distributed denial-of-service (DDoS) mitigation services on standby?</label></div><div class="form-col" style="flex: 1;"><select name="q26_C" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <!-- Section 27: IT Strategy and Policy -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">27. IT Strategy and Policy</h4>
                    </div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">27_A. Whether the Board-approved Cyber Security Policy includes existing and proposed hardware/network architecture and rationale?</label></div><div class="form-col" style="flex: 1;"><select name="q27_A" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">27_B. Whether the Board-approved Cyber Security Policy includes standards for hardware/software prescribed by the proposed architecture?</label></div><div class="form-col" style="flex: 1;"><select name="q27_B" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">27_C. Whether the Board-approved Cyber Security Policy includes strategy for outsourcing, insourcing, off-the-shelf software procurement, and in-house development?</label></div><div class="form-col" style="flex: 1;"><select name="q27_C" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">27_D. Whether the Board-approved Cyber Security Policy includes departmental organizational structure?</label></div><div class="form-col" style="flex: 1;"><select name="q27_D" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">27_E. Whether the Board-approved Cyber Security Policy includes desired IT expertise/competencies, gap-bridging plan, and training/development requirements?</label></div><div class="form-col" style="flex: 1;"><select name="q27_E" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">27_F. Whether the Board-approved Cyber Security Policy includes strategy for keeping abreast of technology developments and updating systems as required?</label></div><div class="form-col" style="flex: 1;"><select name="q27_F" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">27_G. Strategy for independent assessment, evaluation, and monitoring of IT risks and findings of IT/IS/Cybersecurity audits</label></div><div class="form-col" style="flex: 1;"><select name="q27_G" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <!-- Section 28: IT and IS governance Framework -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">28. IT and IS governance Framework</h4>
                    </div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">28_A. Do you have a well-equipped cyber security function (vertical/department/group) with adequate staff and expertise focused exclusively on cyber security management?</label></div><div class="form-col" style="flex: 1;"><select name="q28_A" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <!-- Section 29: IT Strategy Committee -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">29. IT strategy Committee</h4>
                    </div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">29_A. Whether the Board-level IT Strategy Committee is constituted with at least two board members, one technically qualified?</label></div><div class="form-col" style="flex: 1;"><select name="q29_A" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">29_B. Has the IT Strategy Committee approved all policy documents, IT organizational structure, and IT investments?</label></div><div class="form-col" style="flex: 1;"><select name="q29_B" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">29_C. Does the IT Strategy Committee review performance of IT infrastructure and policy implementation?</label></div><div class="form-col" style="flex: 1;"><select name="q29_C" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <!-- Section 30: IT Steering Committee -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">30. IT Steering Committee</h4>
                    </div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">30_A. Has the IT Steering Committee with representatives from IT, HR, legal, and business sectors been constituted?</label></div><div class="form-col" style="flex: 1;"><select name="q30_A" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">30_B. Does the IT Steering Committee report progress of IT implementation projects to the IT Strategy Committee (of Board)?</label></div><div class="form-col" style="flex: 1;"><select name="q30_B" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <!-- Section 31: CISO -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">31. CISO</h4>
                    </div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">31_A. Whether the CISO has the requisite technical background and expertise?</label></div><div class="form-col" style="flex: 1;"><select name="q31_A" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">31_B. Whether arrangements have been made to enhance human resources and expertise if required, commensurate with increased business volume/technology adoption and complexity?</label></div><div class="form-col" style="flex: 1;"><select name="q31_B" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">31_C. Have you ensured that CISO has no direct reporting relation with CIO/CTO?</label></div><div class="form-col" style="flex: 1;"><select name="q31_C" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">31_D. Whether CISO is given any business targets?</label></div><div class="form-col" style="flex: 1;"><select name="q31_D" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>
                    <div class="form-group"><div class="form-row"><div class="form-col" style="flex: 2;"><label class="form-label">31_E. Whether Information Security Committee is reviewing security events, assessing new developments affecting cyber security, and reporting to the Board?</label></div><div class="form-col" style="flex: 1;"><select name="q31_E" class="form-input" required><option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="Not Applicable">Not Applicable</option></select></div></div></div>

                    <div class="form-group" style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('locLevel4Modal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="locLevel4SubmitBtn">
                            <i class="fas fa-check"></i> Submit
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Create LOC Worksheet Modal -->
    <div id="createLOCWorksheetModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>Create LOC Worksheet</h3>
                <span class="close-modal" onclick="closeModal('createLOCWorksheetModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="createLOCWorksheetForm" enctype="multipart/form-data">
                    <div class="form-group">
                        <label class="form-label">LOC Worksheet - ZIP File</label>
                        <input type="file" name="loc_parts_zip1" id="loc_parts_zip1" class="form-input" accept=".zip" required>
                        <small style="color: #666; display: block; margin-top: 5px;">Upload ZIP file containing LOC Excel files</small>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">LOC Evidance - ZIP File</label>
                        <input type="file" name="loc_parts_zip2" id="loc_parts_zip2" class="form-input" accept=".zip" required>
                        <small style="color: #666; display: block; margin-top: 5px;">Please upload a ZIP file containing the LOC evidence. Ensure that each evidence image inside the ZIP is named according to the specific point name provided in the LOC questionnaire. For example, for the question “1_A. Do you have a centralized inventory of authorized devices and other related network devices connected to the bank’s network (within/outside bank premises)?”, the corresponding evidence file names must start with “1_A”. Valid naming examples include “1_A Hardware Inventory.png”, “1_A Software Inventory.png”, and “1_A Network Inventory.png”. It is mandatory to follow this naming format to ensure proper automated mapping and accurate placement of evidence in the report. Any incorrect or mismatched naming may result in missing evidence or processing errors.</small>
                    </div>
                    
                    <div class="form-group" style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('createLOCWorksheetModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="createLOCWorksheetSubmitBtn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Create LOC Worksheet with Bank Input Modal -->
    <div id="createLOCWithBankInputModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>Create LOC Worksheet with Bank Input</h3>
                <span class="close-modal" onclick="closeModal('createLOCWithBankInputModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="createLOCWithBankInputForm" enctype="multipart/form-data">
                    <div class="form-group">
                        <label class="form-label">LOC Excel File</label>
                        <input type="file" name="loc_file1" id="loc_file1" class="form-input" accept=".xlsx,.xls" required>
                        <small style="color: #666; display: block; margin-top: 5px;">Upload the LOC Excel file that is generated through this tool.</small>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">LOC Excel File with Yes/No given by the Bank Column</label>
                        <input type="file" name="loc_file2" id="loc_file2" class="form-input" accept=".xlsx,.xls" required>
                        <small style="color: #666; display: block; margin-top: 5px;">Kindly download the<a href="/static/Formats_and_Catalog/Sample_Files/LOC Bank Input Worksheet.xlsx" download="LOC Bank Input Worksheet.xlsx" style="color: #007bff; text-decoration: underline; cursor: pointer;"> Excel file</a> and fill in the "Yes/No given by the Bank" column. After completing the required entries, please upload the updated Excel file here.
                        </small>
                    </div>
                    
                    <div class="form-group" style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('createLOCWithBankInputModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="createLOCWithBankInputSubmitBtn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- LOE Modal -->
    <div id="loeModal" class="modal">
        <div class="modal-content" style="max-width: 1200px;">
            <div class="modal-header">
                <h3>LOE - Level of Exposure</h3>
                <span class="close-modal" onclick="closeModal('loeModal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="loeForm" method="POST" onsubmit="handleLOESubmit(event)">
                    
                    <!-- Question 1 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">1. Is the bank implementing CBS?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q1" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 2 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">2. If yes, are the following modules operational? Please see maker guide (click on hyperlink) to answer questions 2(a) to 2(h)</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q2" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 2_A -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">2_A. Core Modules?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q2_A" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 2_B -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">2_B. Retail Banking Module?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q2_B" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 2_C -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">2_C. Loan and Advances Module?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q2_C" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 2_D -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">2_D. Remittances and Services Module?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q2_D" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 2_E -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">2_E. Reports and MIS Module?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q2_E" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 2_F -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">2_F. Customer Information Module?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q2_F" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 2_G -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">2_G. Head Office Module?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q2_G" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 2_H -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">2_H. Interfaces with outside agencies?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q2_H" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 3 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">3. Whether direct member of Central Payment System (RTGS / NEFT)?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q3" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 4 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">4. Whether sub member of Central Payment System (RTGS / NEFT)?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q4" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 5 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">5. If sub member Name of Sponsor Bank providing NEFT / RTGS facility?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q5" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 6 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">6. Whether bank is providing Internet View facility to customers?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q6" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 7 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">7. Whether RBI has given approval for internet Transaction facility to your bank?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q7" id="q7" class="form-input" onchange="toggleLOEQuestion8()" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 8 - Conditional -->
                    <div class="form-group" id="q8_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">8. If yes, date of approval?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q8" id="q8" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 9 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">9. Whether your bank is providing internet transaction facility to customers?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q9" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 10 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">10. Has RBI permitted mobile banking?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q10" id="q10" class="form-input" onchange="toggleLOEQuestion11()" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 11 - Conditional -->
                    <div class="form-group" id="q11_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">11. If yes, date of permission for mobile banking</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q11" id="q11" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 12 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">12. If yes, whether providing Mobile Banking facility to customers? (either through App or Smart phone answer YES)</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q12" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 13 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">13. Whether Direct Member of Cheque Truncation System (CTS)?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q13" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 14 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">14. Whether Direct Member of Immediate payment Service (IMPS)?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q14" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 15 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">15. Whether Direct Member of Unified Payment Interface (UPI)?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q15" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 16 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">16. Whether Bank has its own ATM switch?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q16" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 17 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">17. Whether Bank has SWIFT interface?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q17" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 18 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">18. Whether hosting Data center of other banks?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q18" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 19 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">19. Whether providing software support to other banks? (if providing either directly or through fully owned subsidiaries then answer YES)</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q19" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 20 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">20. Whether acting as sponsor bank for other banks (DCCBs/UCBs) for CPS/CTS/UPI/IMPS etc)</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q20" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('loeModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="loeSubmitBtn">
                            <i class="fas fa-check"></i> Submit
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Gap Assessment Excel Modal -->
    <div id="gapAssessmentExcelModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>Gap Assessment Excel</h3>
                <span class="close-modal" onclick="closeModal('gapAssessmentExcelModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="gapAssessmentExcelForm" enctype="multipart/form-data">
                    <div class="form-group">
                        <label class="form-label">VICS, LOC, LOE - Zip Files</label>
                        <input type="file" name="gap_assessment_zip" id="gap_assessment_zip" class="form-input" accept=".zip" required>
                        <small style="color: #666; display: block; margin-top: 5px;">Upload ZIP file containing VICS, LOC, and LOE Excel files</small>
                    </div>
                    
                    <div class="form-group" style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('gapAssessmentExcelModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="gapAssessmentExcelSubmitBtn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Gap Assessment Report Modal -->
    <div id="gapAssessmentReportModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h3>Gap Assessment Report</h3>
                <span class="close-modal" onclick="closeModal('gapAssessmentReportModal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="gapAssessmentReportForm" method="POST" enctype="multipart/form-data" onsubmit="handleGapAssessmentReportSubmit(event)">
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Organization Details</h4>
                    </div>

                    <!-- Organization Name -->
                    <div class="form-group">
                        <label for="gapOrgName" class="form-label">Organization Name*</label>
                        <select id="gapOrgName" name="organizationName" class="form-input" required onchange="toggleOtherField('gapOrgName', 'gapOrgNameOther')">
                            <option value="">Select Organization</option>
                            <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
<option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
<option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
<option value="Megasoft Limited">Megasoft Limited</option>
<option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
<option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
<option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
<option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
<option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
<option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
<option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
<option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
<option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
<option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
<option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
<option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
<option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
<option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
<option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
<option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
<option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
<option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
<option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
<option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
<option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
<option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
<option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
<option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
<option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
<option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
<option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
<option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
<option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
<option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
<option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
<option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
<option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
<option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
<option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
<option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>

                            <option value="Other">Other (Specify)</option>
                        </select>
                        <input type="text" id="gapOrgNameOther" name="organizationNameOther" class="form-input" placeholder="Specify organization name" style="display: none; margin-top: 10px;">
                    </div>

                    <!-- City -->
                    <div class="form-group">
                        <label for="gapCity" class="form-label">City*</label>
                        <select id="gapCity" name="city" class="form-input" required onchange="toggleOtherField('gapCity', 'gapCityOther')">
                            <option value="">Select City</option>
                            <!-- Gujarat -->
                            <option value="Ahmedabad">Ahmedabad</option>
                            <option value="Amreli">Amreli</option>
                            <option value="Anand">Anand</option>
                            <option value="Aravalli">Aravalli</option>
                            <option value="Banaskantha">Banaskantha</option>
                            <option value="Bharuch">Bharuch</option>
                            <option value="Bhavnagar">Bhavnagar</option>
                            <option value="Botad">Botad</option>
                            <option value="Chhota Udaipur">Chhota Udaipur</option>
                            <option value="Dahod">Dahod</option>
                            <option value="Dang">Dang</option>
                            <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                            <option value="Gandhinagar">Gandhinagar</option>
                            <option value="Gir Somnath">Gir Somnath</option>
                            <option value="Jamnagar">Jamnagar</option>
                            <option value="Junagadh">Junagadh</option>
                            <option value="Kheda">Kheda</option>
                            <option value="Kutch">Kutch</option>
                            <option value="Mahisagar">Mahisagar</option>
                            <option value="Mehsana">Mehsana</option>
                            <option value="Morbi">Morbi</option>
                            <option value="Narmada">Narmada</option>
                            <option value="Navsari">Navsari</option>
                            <option value="Patan">Patan</option>
                            <option value="Panchmahal">Panchmahal</option>
                            <option value="Porbandar">Porbandar</option>
                            <option value="Rajkot">Rajkot</option>
                            <option value="Sabarkantha">Sabarkantha</option>
                            <option value="Surat">Surat</option>
                            <option value="Surendranagar">Surendranagar</option>
                            <option value="Tapi">Tapi</option>
                            <option value="Vadodara">Vadodara</option>
                            <option value="Valsad">Valsad</option>

                            <!-- Rajasthan -->
                            <option value="Ajmer">Ajmer</option>
                            <option value="Alwar">Alwar</option>
                            <option value="Banswara">Banswara</option>
                            <option value="Baran">Baran</option>
                            <option value="Barmer">Barmer</option>
                            <option value="Bharatpur">Bharatpur</option>
                            <option value="Bhilwara">Bhilwara</option>
                            <option value="Bikaner">Bikaner</option>
                            <option value="Bundi">Bundi</option>
                            <option value="Chittorgarh">Chittorgarh</option>
                            <option value="Churu">Churu</option>
                            <option value="Dausa">Dausa</option>
                            <option value="Dholpur">Dholpur</option>
                            <option value="Dungarpur">Dungarpur</option>
                            <option value="Hanumangarh">Hanumangarh</option>
                            <option value="Jaipur">Jaipur</option>
                            <option value="Jaisalmer">Jaisalmer</option>
                            <option value="Jalore">Jalore</option>
                            <option value="Jhalawar">Jhalawar</option>
                            <option value="Jhunjhunu">Jhunjhunu</option>
                            <option value="Jodhpur">Jodhpur</option>
                            <option value="Karauli">Karauli</option>
                            <option value="Kota">Kota</option>
                            <option value="Nagaur">Nagaur</option>
                            <option value="Pali">Pali</option>
                            <option value="Pratapgarh">Pratapgarh</option>
                            <option value="Rajsamand">Rajsamand</option>
                            <option value="Sikar">Sikar</option>
                            <option value="Sirohi">Sirohi</option>
                            <option value="Sri Ganganagar">Sri Ganganagar</option>
                            <option value="Tonk">Tonk</option>
                            <option value="Udaipur">Udaipur</option>

                            <!-- Maharashtra -->
                            <option value="Ahmednagar">Ahmednagar</option>
                            <option value="Akola">Akola</option>
                            <option value="Amravati">Amravati</option>
                            <option value="Aurangabad">Aurangabad</option>
                            <option value="Beed">Beed</option>
                            <option value="Bhandara">Bhandara</option>
                            <option value="Chandrapur">Chandrapur</option>
                            <option value="Dhule">Dhule</option>
                            <option value="Gadchiroli">Gadchiroli</option>
                            <option value="Gondia">Gondia</option>
                            <option value="Hingoli">Hingoli</option>
                            <option value="Jalgaon">Jalgaon</option>
                            <option value="Jalna">Jalna</option>
                            <option value="Kolhapur">Kolhapur</option>
                            <option value="Latur">Latur</option>
                            <option value="Mumbai City">Mumbai City</option>
                            <option value="Mumbai Suburban">Mumbai Suburban</option>
                            <option value="Nagpur">Nagpur</option>
                            <option value="Nanded">Nanded</option>
                            <option value="Nandurbar">Nandurbar</option>
                            <option value="Nashik">Nashik</option>
                            <option value="Osmanabad">Osmanabad</option>
                            <option value="Palghar">Palghar</option>
                            <option value="Parbhani">Parbhani</option>
                            <option value="Pune">Pune</option>
                            <option value="Raigad">Raigad</option>
                            <option value="Ratnagiri">Ratnagiri</option>
                            <option value="Sangli">Sangli</option>
                            <option value="Satara">Satara</option>
                            <option value="Sindhudurg">Sindhudurg</option>
                            <option value="Solapur">Solapur</option>
                            <option value="Thane">Thane</option>
                            <option value="Wardha">Wardha</option>
                            <option value="Washim">Washim</option>
                            <option value="Yavatmal">Yavatmal</option>

                            <!-- Uttar Pradesh -->
                            <option value="Agra">Agra</option>
                            <option value="Aligarh">Aligarh</option>
                            <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                            <option value="Amethi">Amethi</option>
                            <option value="Amroha">Amroha</option>
                            <option value="Auraiya">Auraiya</option>
                            <option value="Ayodhya">Ayodhya</option>
                            <option value="Azamgarh">Azamgarh</option>
                            <option value="Bagpat">Bagpat</option>
                            <option value="Bahraich">Bahraich</option>
                            <option value="Ballia">Ballia</option>
                            <option value="Balrampur">Balrampur</option>
                            <option value="Banda">Banda</option>
                            <option value="Barabanki">Barabanki</option>
                            <option value="Bareilly">Bareilly</option>
                            <option value="Basti">Basti</option>
                            <option value="Bhadohi">Bhadohi</option>
                            <option value="Bijnor">Bijnor</option>
                            <option value="Bulandshahr">Bulandshahr</option>
                            <option value="Chandauli">Chandauli</option>
                            <option value="Chitrakoot">Chitrakoot</option>
                            <option value="Deoria">Deoria</option>
                            <option value="Etah">Etah</option>
                            <option value="Etawah">Etawah</option>
                            <option value="Farrukhabad">Farrukhabad</option>
                            <option value="Fatehpur">Fatehpur</option>
                            <option value="Firozabad">Firozabad</option>
                            <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                            <option value="Ghaziabad">Ghaziabad</option>
                            <option value="Ghazipur">Ghazipur</option>
                            <option value="Gonda">Gonda</option>
                            <option value="Gorakhpur">Gorakhpur</option>
                            <option value="Hamirpur">Hamirpur</option>
                            <option value="Hapur">Hapur</option>
                            <option value="Hardoi">Hardoi</option>
                            <option value="Hathras">Hathras</option>
                            <option value="Jalaun">Jalaun</option>
                            <option value="Jaunpur">Jaunpur</option>
                            <option value="Jhansi">Jhansi</option>
                            <option value="Kannauj">Kannauj</option>
                            <option value="Kanpur Dehat">Kanpur Dehat</option>
                            <option value="Kanpur Nagar">Kanpur Nagar</option>
                            <option value="Kasganj">Kasganj</option>
                            <option value="Kaushambi">Kaushambi</option>
                            <option value="Kushinagar">Kushinagar</option>
                            <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                            <option value="Lalitpur">Lalitpur</option>
                            <option value="Lucknow">Lucknow</option>
                            <option value="Maharajganj">Maharajganj</option>
                            <option value="Mahoba">Mahoba</option>
                            <option value="Mainpuri">Mainpuri</option>
                            <option value="Mathura">Mathura</option>
                            <option value="Mau">Mau</option>
                            <option value="Meerut">Meerut</option>
                            <option value="Mirzapur">Mirzapur</option>
                            <option value="Moradabad">Moradabad</option>
                            <option value="Muzaffarnagar">Muzaffarnagar</option>
                            <option value="Pilibhit">Pilibhit</option>
                            <option value="Pratapgarh">Pratapgarh</option>
                            <option value="Rae Bareli">Rae Bareli</option>
                            <option value="Rampur">Rampur</option>
                            <option value="Saharanpur">Saharanpur</option>
                            <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                            <option value="Shahjahanpur">Shahjahanpur</option>
                            <option value="Shravasti">Shravasti</option>
                            <option value="Siddharthnagar">Siddharthnagar</option>
                            <option value="Sitapur">Sitapur</option>
                            <option value="Sonbhadra">Sonbhadra</option>
                            <option value="Sultanpur">Sultanpur</option>
                            <option value="Unnao">Unnao</option>
                            <option value="Varanasi">Varanasi</option>

                            <!-- Uttarakhand -->
                            <option value="Almora">Almora</option>
                            <option value="Bageshwar">Bageshwar</option>
                            <option value="Chamoli">Chamoli</option>
                            <option value="Champawat">Champawat</option>
                            <option value="Dehradun">Dehradun</option>
                            <option value="Haridwar">Haridwar</option>
                            <option value="Nainital">Nainital</option>
                            <option value="Pauri Garhwal">Pauri Garhwal</option>
                            <option value="Pithoragarh">Pithoragarh</option>
                            <option value="Rudraprayag">Rudraprayag</option>
                            <option value="Tehri Garhwal">Tehri Garhwal</option>
                            <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                            <option value="Uttarkashi">Uttarkashi</option>


                            <option value="Other">Other (Specify)</option>
                        </select>
                        <input type="text" id="gapCityOther" name="cityOther" class="form-input" placeholder="Specify city" style="display: none; margin-top: 10px;">
                    </div>

                    <!-- State -->
                    <div class="form-group">
                        <label for="gapState" class="form-label">State*</label>
                        <select id="gapState" name="state" class="form-input" required>
                            <option value="">Select State</option>
                            <option value="Andhra Pradesh">Andhra Pradesh</option>
                            <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                            <option value="Assam">Assam</option>
                            <option value="Bihar">Bihar</option>
                            <option value="Chhattisgarh">Chhattisgarh</option>
                            <option value="Goa">Goa</option>
                            <option value="Gujarat">Gujarat</option>
                            <option value="Haryana">Haryana</option>
                            <option value="Himachal Pradesh">Himachal Pradesh</option>
                            <option value="Jharkhand">Jharkhand</option>
                            <option value="Karnataka">Karnataka</option>
                            <option value="Kerala">Kerala</option>
                            <option value="Madhya Pradesh">Madhya Pradesh</option>
                            <option value="Maharashtra">Maharashtra</option>
                            <option value="Manipur">Manipur</option>
                            <option value="Meghalaya">Meghalaya</option>
                            <option value="Mizoram">Mizoram</option>
                            <option value="Nagaland">Nagaland</option>
                            <option value="Odisha">Odisha</option>
                            <option value="Punjab">Punjab</option>
                            <option value="Rajasthan">Rajasthan</option>
                            <option value="Sikkim">Sikkim</option>
                            <option value="Tamil Nadu">Tamil Nadu</option>
                            <option value="Telangana">Telangana</option>
                            <option value="Tripura">Tripura</option>
                            <option value="Uttar Pradesh">Uttar Pradesh</option>
                            <option value="Uttarakhand">Uttarakhand</option>
                            <option value="West Bengal">West Bengal</option>

                            <!-- Union Territories -->
                            <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                            <option value="Chandigarh">Chandigarh</option>
                            <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                            <option value="Delhi">Delhi</option>
                            <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                            <option value="Ladakh">Ladakh</option>
                            <option value="Lakshadweep">Lakshadweep</option>
                            <option value="Puducherry">Puducherry</option>

                        </select>
                    </div>

                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Auditor Details</h4>
                    </div>

                    <!-- Prepared By -->
                    <div class="form-group">
                        <label for="gapPreparedByPrefix" class="form-label">Prepared By*</label>
                        <div style="display: flex; gap: 10px;">
                            <select id="gapPreparedByPrefix" name="preparedByPrefix" class="form-input" required style="flex: 0 0 100px;">
                                <option value="Mr.">Mr.</option>
                                <option value="Mrs.">Mrs.</option>
                                <option value="Dr.">Dr.</option>
                                <option value="Miss">Miss</option>
                            </select>
                            <input type="text" id="gapPreparedByName" name="preparedByName" class="form-input" placeholder="Enter name" required style="flex: 1;">
                        </div>
                    </div>

                    <!-- Audit Dates -->
                    <div class="form-group">
                        <label for="gapStartDate" class="form-label">Start Audit Date*</label>
                        <input type="date" id="gapStartDate" name="startAuditDate" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label for="gapEndDate" class="form-label">End Audit Date*</label>
                        <input type="date" id="gapEndDate" name="endAuditDate" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Auditee Details</h4>
                    </div>

                    <!-- Auditee Person Name -->
                    <div class="form-group">
                        <label for="gapAuditeePrefix" class="form-label">Auditee Organization Person Name*</label>
                        <div style="display: flex; gap: 10px;">
                            <select id="gapAuditeePrefix" name="auditeePersonPrefix" class="form-input" required style="flex: 0 0 100px;">
                                <option value="Mr.">Mr.</option>
                                <option value="Mrs.">Mrs.</option>
                                <option value="Dr.">Dr.</option>
                                <option value="Miss">Miss</option>
                            </select>
                            <input type="text" id="gapAuditeeName" name="auditeePersonName" class="form-input" placeholder="Enter name" required style="flex: 1;">
                        </div>
                    </div>

                    <!-- Auditee Designation -->
                    <div class="form-group">
                        <label for="gapAuditeeDesignation" class="form-label">Designation of Auditee Organization Person*</label>
                        <input type="text" id="gapAuditeeDesignation" name="auditeeDesignation" class="form-input" placeholder="e.g., IT Manager" required>
                    </div>

                    <!-- Bank Address -->
                    <div class="form-group">
                        <label for="gapBankAddress" class="form-label">Bank Address*</label>
                        <textarea id="gapBankAddress" name="bankAddress" class="form-input" placeholder="Enter complete bank address" required rows="3" style="width: 100%; resize: vertical;"></textarea>
                    </div>

                    <!-- Email with dynamic fields -->
                    <div class="form-group">
                        <label class="form-label">Bank Email Address(es)*</label>
                        <div id="gapEmailContainer">
                            <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                                <input type="email" name="email[]" class="form-input" placeholder="Enter email address" required style="flex: 1;">
                                <button type="button" class="submit-btn" onclick="addGapEmailField()" style="flex: 0 0 40px; padding: 8px;">+</button>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Upload Files</h4>
                    </div>

                    <!-- Excel File Upload -->
                    <div class="form-group">
                        <label for="gapExcelFile" class="form-label">Gap Assessment Excel File</label>
                        <input type="file" id="gapExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                        <small style="color: #666; display: block; margin-top: 5px;">Upload the Gap Assessment Excel file (with VICS, LOC, LOE worksheets)</small>
                    </div>

                    <!-- ZIP File Upload -->
                    <div class="form-group">
                        <label for="gapZipFile" class="form-label">VICS and LOC Evidance - ZIP File</label>
                        <input type="file" id="gapZipFile" name="zipFile" class="form-input" accept=".zip" required>
                        <small style="color: #666; display: block; margin-top: 5px;">Please upload a ZIP file containing the VICS and LOC evidence with proper file naming as instructed for the worksheet.</small>
                    </div>

                    <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('gapAssessmentReportModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="gapAssessmentReportSubmitBtn">
                            <i class="fas fa-check"></i> Submit
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Gap Assessment Report with Bank Input Modal -->
    <div id="gapAssessmentReportBankInputModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h3>Gap Assessment Report - with Bank Column</h3>
                <span class="close-modal" onclick="closeModal('gapAssessmentReportBankInputModal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="gapAssessmentReportBankInputForm" method="POST" enctype="multipart/form-data" onsubmit="handleGapAssessmentReportBankInputSubmit(event)">
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Organization Details</h4>
                    </div>

                    <!-- Organization Name -->
                    <div class="form-group">
                        <label for="gapBankOrgName" class="form-label">Organization Name*</label>
                        <select id="gapBankOrgName" name="organizationName" class="form-input" required onchange="toggleOtherField('gapBankOrgName', 'gapBankOrgNameOther')">
                            <option value="">Select Organization</option>
                            <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                            <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                            <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                            <option value="Megasoft Limited">Megasoft Limited</option>
                            <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                            <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                            <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                            <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                            <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                            <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                            <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                            <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                            <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                            <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                            <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                            <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                            <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                            <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                            <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                            <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                            <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                            <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                            <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                            <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                            <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                            <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                            <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                            <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                            <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                            <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                            <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                            <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                            <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                            <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                            <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                            <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                            <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                            <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                            <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                            <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                            
                            <option value="Other">Other (Specify)</option>
                        </select>
                        <input type="text" id="gapBankOrgNameOther" name="organizationNameOther" class="form-input" placeholder="Specify organization name" style="display: none; margin-top: 10px;">
                    </div>

                    <!-- City -->
                    <div class="form-group">
                        <label for="gapBankCity" class="form-label">City*</label>
                        <select id="gapBankCity" name="city" class="form-input" required onchange="toggleOtherField('gapBankCity', 'gapBankCityOther')">
                            <option value="">Select City</option>
                            <!-- Gujarat -->
                            <option value="Ahmedabad">Ahmedabad</option>
                            <option value="Amreli">Amreli</option>
                            <option value="Anand">Anand</option>
                            <option value="Aravalli">Aravalli</option>
                            <option value="Banaskantha">Banaskantha</option>
                            <option value="Bharuch">Bharuch</option>
                            <option value="Bhavnagar">Bhavnagar</option>
                            <option value="Botad">Botad</option>
                            <option value="Chhota Udaipur">Chhota Udaipur</option>
                            <option value="Dahod">Dahod</option>
                            <option value="Dang">Dang</option>
                            <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                            <option value="Gandhinagar">Gandhinagar</option>
                            <option value="Gir Somnath">Gir Somnath</option>
                            <option value="Jamnagar">Jamnagar</option>
                            <option value="Junagadh">Junagadh</option>
                            <option value="Kheda">Kheda</option>
                            <option value="Kutch">Kutch</option>
                            <option value="Mahisagar">Mahisagar</option>
                            <option value="Mehsana">Mehsana</option>
                            <option value="Morbi">Morbi</option>
                            <option value="Narmada">Narmada</option>
                            <option value="Navsari">Navsari</option>
                            <option value="Patan">Patan</option>
                            <option value="Panchmahal">Panchmahal</option>
                            <option value="Porbandar">Porbandar</option>
                            <option value="Rajkot">Rajkot</option>
                            <option value="Sabarkantha">Sabarkantha</option>
                            <option value="Surat">Surat</option>
                            <option value="Surendranagar">Surendranagar</option>
                            <option value="Tapi">Tapi</option>
                            <option value="Vadodara">Vadodara</option>
                            <option value="Valsad">Valsad</option>

                            <!-- Rajasthan -->
                            <option value="Ajmer">Ajmer</option>
                            <option value="Alwar">Alwar</option>
                            <option value="Banswara">Banswara</option>
                            <option value="Baran">Baran</option>
                            <option value="Barmer">Barmer</option>
                            <option value="Bharatpur">Bharatpur</option>
                            <option value="Bhilwara">Bhilwara</option>
                            <option value="Bikaner">Bikaner</option>
                            <option value="Bundi">Bundi</option>
                            <option value="Chittorgarh">Chittorgarh</option>
                            <option value="Churu">Churu</option>
                            <option value="Dausa">Dausa</option>
                            <option value="Dholpur">Dholpur</option>
                            <option value="Dungarpur">Dungarpur</option>
                            <option value="Hanumangarh">Hanumangarh</option>
                            <option value="Jaipur">Jaipur</option>
                            <option value="Jaisalmer">Jaisalmer</option>
                            <option value="Jalore">Jalore</option>
                            <option value="Jhalawar">Jhalawar</option>
                            <option value="Jhunjhunu">Jhunjhunu</option>
                            <option value="Jodhpur">Jodhpur</option>
                            <option value="Karauli">Karauli</option>
                            <option value="Kota">Kota</option>
                            <option value="Nagaur">Nagaur</option>
                            <option value="Pali">Pali</option>
                            <option value="Pratapgarh">Pratapgarh</option>
                            <option value="Rajsamand">Rajsamand</option>
                            <option value="Sikar">Sikar</option>
                            <option value="Sirohi">Sirohi</option>
                            <option value="Sri Ganganagar">Sri Ganganagar</option>
                            <option value="Tonk">Tonk</option>
                            <option value="Udaipur">Udaipur</option>

                            <!-- Maharashtra -->
                            <option value="Ahmednagar">Ahmednagar</option>
                            <option value="Akola">Akola</option>
                            <option value="Amravati">Amravati</option>
                            <option value="Aurangabad">Aurangabad</option>
                            <option value="Beed">Beed</option>
                            <option value="Bhandara">Bhandara</option>
                            <option value="Chandrapur">Chandrapur</option>
                            <option value="Dhule">Dhule</option>
                            <option value="Gadchiroli">Gadchiroli</option>
                            <option value="Gondia">Gondia</option>
                            <option value="Hingoli">Hingoli</option>
                            <option value="Jalgaon">Jalgaon</option>
                            <option value="Jalna">Jalna</option>
                            <option value="Kolhapur">Kolhapur</option>
                            <option value="Latur">Latur</option>
                            <option value="Mumbai City">Mumbai City</option>
                            <option value="Mumbai Suburban">Mumbai Suburban</option>
                            <option value="Nagpur">Nagpur</option>
                            <option value="Nanded">Nanded</option>
                            <option value="Nandurbar">Nandurbar</option>
                            <option value="Nashik">Nashik</option>
                            <option value="Osmanabad">Osmanabad</option>
                            <option value="Palghar">Palghar</option>
                            <option value="Parbhani">Parbhani</option>
                            <option value="Pune">Pune</option>
                            <option value="Raigad">Raigad</option>
                            <option value="Ratnagiri">Ratnagiri</option>
                            <option value="Sangli">Sangli</option>
                            <option value="Satara">Satara</option>
                            <option value="Sindhudurg">Sindhudurg</option>
                            <option value="Solapur">Solapur</option>
                            <option value="Thane">Thane</option>
                            <option value="Wardha">Wardha</option>
                            <option value="Washim">Washim</option>
                            <option value="Yavatmal">Yavatmal</option>

                            <!-- Uttar Pradesh -->
                            <option value="Agra">Agra</option>
                            <option value="Aligarh">Aligarh</option>
                            <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                            <option value="Amethi">Amethi</option>
                            <option value="Amroha">Amroha</option>
                            <option value="Auraiya">Auraiya</option>
                            <option value="Ayodhya">Ayodhya</option>
                            <option value="Azamgarh">Azamgarh</option>
                            <option value="Bagpat">Bagpat</option>
                            <option value="Bahraich">Bahraich</option>
                            <option value="Ballia">Ballia</option>
                            <option value="Balrampur">Balrampur</option>
                            <option value="Banda">Banda</option>
                            <option value="Barabanki">Barabanki</option>
                            <option value="Bareilly">Bareilly</option>
                            <option value="Basti">Basti</option>
                            <option value="Bhadohi">Bhadohi</option>
                            <option value="Bijnor">Bijnor</option>
                            <option value="Bulandshahr">Bulandshahr</option>
                            <option value="Chandauli">Chandauli</option>
                            <option value="Chitrakoot">Chitrakoot</option>
                            <option value="Deoria">Deoria</option>
                            <option value="Etah">Etah</option>
                            <option value="Etawah">Etawah</option>
                            <option value="Farrukhabad">Farrukhabad</option>
                            <option value="Fatehpur">Fatehpur</option>
                            <option value="Firozabad">Firozabad</option>
                            <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                            <option value="Ghaziabad">Ghaziabad</option>
                            <option value="Ghazipur">Ghazipur</option>
                            <option value="Gonda">Gonda</option>
                            <option value="Gorakhpur">Gorakhpur</option>
                            <option value="Hamirpur">Hamirpur</option>
                            <option value="Hapur">Hapur</option>
                            <option value="Hardoi">Hardoi</option>
                            <option value="Hathras">Hathras</option>
                            <option value="Jalaun">Jalaun</option>
                            <option value="Jaunpur">Jaunpur</option>
                            <option value="Jhansi">Jhansi</option>
                            <option value="Kannauj">Kannauj</option>
                            <option value="Kanpur Dehat">Kanpur Dehat</option>
                            <option value="Kanpur Nagar">Kanpur Nagar</option>
                            <option value="Kasganj">Kasganj</option>
                            <option value="Kaushambi">Kaushambi</option>
                            <option value="Kushinagar">Kushinagar</option>
                            <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                            <option value="Lalitpur">Lalitpur</option>
                            <option value="Lucknow">Lucknow</option>
                            <option value="Maharajganj">Maharajganj</option>
                            <option value="Mahoba">Mahoba</option>
                            <option value="Mainpuri">Mainpuri</option>
                            <option value="Mathura">Mathura</option>
                            <option value="Mau">Mau</option>
                            <option value="Meerut">Meerut</option>
                            <option value="Mirzapur">Mirzapur</option>
                            <option value="Moradabad">Moradabad</option>
                            <option value="Muzaffarnagar">Muzaffarnagar</option>
                            <option value="Pilibhit">Pilibhit</option>
                            <option value="Pratapgarh">Pratapgarh</option>
                            <option value="Rae Bareli">Rae Bareli</option>
                            <option value="Rampur">Rampur</option>
                            <option value="Saharanpur">Saharanpur</option>
                            <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                            <option value="Shahjahanpur">Shahjahanpur</option>
                            <option value="Shravasti">Shravasti</option>
                            <option value="Siddharthnagar">Siddharthnagar</option>
                            <option value="Sitapur">Sitapur</option>
                            <option value="Sonbhadra">Sonbhadra</option>
                            <option value="Sultanpur">Sultanpur</option>
                            <option value="Unnao">Unnao</option>
                            <option value="Varanasi">Varanasi</option>

                            <!-- Uttarakhand -->
                            <option value="Almora">Almora</option>
                            <option value="Bageshwar">Bageshwar</option>
                            <option value="Chamoli">Chamoli</option>
                            <option value="Champawat">Champawat</option>
                            <option value="Dehradun">Dehradun</option>
                            <option value="Haridwar">Haridwar</option>
                            <option value="Nainital">Nainital</option>
                            <option value="Pauri Garhwal">Pauri Garhwal</option>
                            <option value="Pithoragarh">Pithoragarh</option>
                            <option value="Rudraprayag">Rudraprayag</option>
                            <option value="Tehri Garhwal">Tehri Garhwal</option>
                            <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                            <option value="Uttarkashi">Uttarkashi</option>


                            <option value="Other">Other (Specify)</option>
                        </select>
                        <input type="text" id="gapBankCityOther" name="cityOther" class="form-input" placeholder="Specify city" style="display: none; margin-top: 10px;">
                    </div>

                    <!-- State -->
                    <div class="form-group">
                        <label for="gapBankState" class="form-label">State*</label>
                        <select id="gapBankState" name="state" class="form-input" required>
                            <option value="">Select State</option>
                            <option value="Andhra Pradesh">Andhra Pradesh</option>
                            <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                            <option value="Assam">Assam</option>
                            <option value="Bihar">Bihar</option>
                            <option value="Chhattisgarh">Chhattisgarh</option>
                            <option value="Goa">Goa</option>
                            <option value="Gujarat">Gujarat</option>
                            <option value="Haryana">Haryana</option>
                            <option value="Himachal Pradesh">Himachal Pradesh</option>
                            <option value="Jharkhand">Jharkhand</option>
                            <option value="Karnataka">Karnataka</option>
                            <option value="Kerala">Kerala</option>
                            <option value="Madhya Pradesh">Madhya Pradesh</option>
                            <option value="Maharashtra">Maharashtra</option>
                            <option value="Manipur">Manipur</option>
                            <option value="Meghalaya">Meghalaya</option>
                            <option value="Mizoram">Mizoram</option>
                            <option value="Nagaland">Nagaland</option>
                            <option value="Odisha">Odisha</option>
                            <option value="Punjab">Punjab</option>
                            <option value="Rajasthan">Rajasthan</option>
                            <option value="Sikkim">Sikkim</option>
                            <option value="Tamil Nadu">Tamil Nadu</option>
                            <option value="Telangana">Telangana</option>
                            <option value="Tripura">Tripura</option>
                            <option value="Uttar Pradesh">Uttar Pradesh</option>
                            <option value="Uttarakhand">Uttarakhand</option>
                            <option value="West Bengal">West Bengal</option>

                            <!-- Union Territories -->
                            <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                            <option value="Chandigarh">Chandigarh</option>
                            <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                            <option value="Delhi">Delhi</option>
                            <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                            <option value="Ladakh">Ladakh</option>
                            <option value="Lakshadweep">Lakshadweep</option>
                            <option value="Puducherry">Puducherry</option>

                        </select>
                    </div>

                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Auditor Details</h4>
                    </div>

                    <!-- Prepared By -->
                    <div class="form-group">
                        <label for="gapBankPreparedByPrefix" class="form-label">Prepared By*</label>
                        <div style="display: flex; gap: 10px;">
                            <select id="gapBankPreparedByPrefix" name="preparedByPrefix" class="form-input" required style="flex: 0 0 100px;">
                                <option value="Mr.">Mr.</option>
                                <option value="Mrs.">Mrs.</option>
                                <option value="Dr.">Dr.</option>
                                <option value="Miss">Miss</option>
                            </select>
                            <input type="text" id="gapBankPreparedByName" name="preparedByName" class="form-input" placeholder="Enter name" required style="flex: 1;">
                        </div>
                    </div>

                    <!-- Audit Dates -->
                    <div class="form-group">
                        <label for="gapBankStartDate" class="form-label">Start Audit Date*</label>
                        <input type="date" id="gapBankStartDate" name="startAuditDate" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label for="gapBankEndDate" class="form-label">End Audit Date*</label>
                        <input type="date" id="gapBankEndDate" name="endAuditDate" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Auditee Details</h4>
                    </div>

                    <!-- Auditee Person Name -->
                    <div class="form-group">
                        <label for="gapBankAuditeePrefix" class="form-label">Auditee Organization Person Name*</label>
                        <div style="display: flex; gap: 10px;">
                            <select id="gapBankAuditeePrefix" name="auditeePersonPrefix" class="form-input" required style="flex: 0 0 100px;">
                                <option value="Mr.">Mr.</option>
                                <option value="Mrs.">Mrs.</option>
                                <option value="Dr.">Dr.</option>
                                <option value="Miss">Miss</option>
                            </select>
                            <input type="text" id="gapBankAuditeeName" name="auditeePersonName" class="form-input" placeholder="Enter name" required style="flex: 1;">
                        </div>
                    </div>

                    <!-- Auditee Designation -->
                    <div class="form-group">
                        <label for="gapBankAuditeeDesignation" class="form-label">Designation of Auditee Organization Person*</label>
                        <input type="text" id="gapBankAuditeeDesignation" name="auditeeDesignation" class="form-input" placeholder="e.g., IT Manager" required>
                    </div>

                    <!-- Bank Address -->
                    <div class="form-group">
                        <label for="gapBankAddress" class="form-label">Bank Address*</label>
                        <textarea id="gapBankAddress" name="bankAddress" class="form-input" placeholder="Enter complete bank address" required rows="3" style="width: 100%; resize: vertical;"
                        ></textarea>
                    </div>

                    <!-- Email with dynamic fields -->
                    <div class="form-group">
                        <label class="form-label">Bank Email Address(es)*</label>
                        <div id="gapBankEmailContainer">
                            <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                                <input type="email" name="email[]" class="form-input" placeholder="Enter email address" required style="flex: 1;">
                                <button type="button" class="submit-btn" onclick="addGapBankEmailField()" style="flex: 0 0 40px; padding: 8px;">+</button>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Upload Files</h4>
                    </div>

                    <!-- Excel File Upload -->
                    <div class="form-group">
                        <label for="gapBankExcelFile" class="form-label">Gap Assessment Excel File*</label>
                        <input type="file" id="gapBankExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                        <small style="color: #666; display: block; margin-top: 5px;">Upload the Gap Assessment Excel file with Bank Input Column (with VICS, LOC, LOE worksheets)</small>
                    </div>

                    <!-- ZIP File Upload -->
                    <div class="form-group">
                        <label for="gapBankZipFile" class="form-label">Evidance - Zip File*</label>
                        <input type="file" id="gapBankZipFile" name="zipFile" class="form-input" accept=".zip" required>
                        <small style="color: #666; display: block; margin-top: 5px;">Please upload a ZIP file containing the VICS and LOC evidence images, ensuring that the image file names strictly follow the naming instructions provided during the generation of the VICS and LOC Excel files.</small>
                    </div>

                    <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('gapAssessmentReportBankInputModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="gapAssessmentReportBankInputSubmitBtn">
                            <i class="fas fa-check"></i> Submit
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- VICS Certificate Modal -->
    <div id="vicsCertificateModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>VICS Certificate</h3>
                <span class="close-modal" onclick="closeModal('vicsCertificateModal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="vicsCertificateForm" method="POST" enctype="multipart/form-data" onsubmit="handleVicsCertificateSubmit(event)">
                    <!-- Organization Name -->
                    <div class="form-group">
                        <label for="vicsCertOrgName" class="form-label">Organization Name*</label>
                        <select id="vicsCertOrgName" name="organizationName" class="form-input" required onchange="toggleOtherField('vicsCertOrgName', 'vicsCertOrgNameOther')">
                            <option value="">Select Organization</option>
                            <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                            <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                            <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                            <option value="Megasoft Limited">Megasoft Limited</option>
                            <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                            <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                            <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                            <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                            <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                            <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                            <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                            <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                            <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                            <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                            <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                            <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                            <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                            <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                            <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                            <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                            <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                            <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                            <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                            <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                            <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                            <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                            <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                            <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                            <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                            <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                            <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                            <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                            <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                            <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                            <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                            <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                            <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                            <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                            <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                            <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                            
                            <option value="Other">Other (Specify)</option>
                        </select>
                        <input type="text" id="vicsCertOrgNameOther" name="organizationNameOther" class="form-input" placeholder="Specify organization name" style="display: none; margin-top: 10px;">
                    </div>

                    <!-- Excel File Upload -->
                    <div class="form-group">
                        <label for="vicsCertExcelFile" class="form-label">VICS Excel File*</label>
                        <input type="file" id="vicsCertExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                        <small style="color: #666; display: block; margin-top: 5px;">Upload the VICS Excel file (with VICS worksheet)</small>
                    </div>

                    <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('vicsCertificateModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="vicsCertificateSubmitBtn">
                            <i class="fas fa-check"></i> Submit
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Cyber Security Audit Excel - Separate Parts Modal -->
    <div id="cyberSecurityAuditExcelModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Cyber Security Audit Excel - Separate Parts</h3>
                <span class="close-modal" onclick="closeModal('cyberSecurityAuditExcelModal')">&times;</span>
            </div>
            <div class="modal-body">
                <div class="assets-list">
                    <ol>
                        <li onclick="openModal('meityAuditPart1Modal')" style="cursor: pointer;">Part 1: 1 to 25 Questions</li>
                        <li onclick="openModal('meityAuditPart2Modal')" style="cursor: pointer;">Part 2: 26 to 50 Questions</li>
                        <li onclick="openModal('meityAuditPart3Modal')" style="cursor: pointer;">Part 3: 51 to 71 Questions</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <!-- Create Cyber Security Audit Excel Modal -->
    <div id="createCyberSecurityAuditExcelModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>Create Cyber Security Audit Excel</h3>
                <span class="close-modal" onclick="closeModal('createCyberSecurityAuditExcelModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="createCyberSecurityAuditExcelForm" enctype="multipart/form-data" onsubmit="handleCreateCyberSecurityAuditExcelSubmit(event)">
                    <div class="form-group">
                        <label class="form-label">Upload Meity Audit Parts ZIP File*</label>
                        <input type="file" name="meity_parts_zip" id="meity_parts_zip" class="form-input" accept=".zip" required>
                        <small style="color: #666; display: block; margin-top: 5px;">Upload ZIP file containing Meity Audit Part 1, 2, and 3 Excel files</small>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Upload Images ZIP File*</label>
                        <input type="file" name="images_zip" id="images_zip" class="form-input" accept=".zip" required>
                        <small style="color: #666; display: block; margin-top: 5px;">Please upload a ZIP file containing the evidence. The evidence image file names must strictly follow the defined naming format based on the corresponding question number. For example, for the question “1. Has the bank conducted its audit through a CERT-In empanelled agency?”, the evidence image names should begin with the point number “1”, followed by a short descriptive title. Valid examples include “1 Is Audit Report.png” and “1 VAPT Report.jpg”.</small>
                    </div>
                    
                    <div class="form-group" style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('createCyberSecurityAuditExcelModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="createCyberSecurityAuditExcelSubmitBtn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Cyber Security Audit Report Modal -->
    <div id="cyberSecurityAuditReportModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h3>Cyber Security Audit Report</h3>
                <span class="close-modal" onclick="closeModal('cyberSecurityAuditReportModal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="cyberSecurityAuditReportForm" method="POST" enctype="multipart/form-data" onsubmit="handleCyberSecurityAuditReportSubmit(event)">
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Organization Details</h4>
                    </div>

                    <!-- Organization Name -->
                    <div class="form-group">
                        <label for="cyberOrgName" class="form-label">Organization Name*</label>
                        <select id="cyberOrgName" name="organizationName" class="form-input" required onchange="toggleOtherField('cyberOrgName', 'cyberOrgNameOther')">
                            <option value="">Select Organization</option>
                            <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                            <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                            <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                            <option value="Megasoft Limited">Megasoft Limited</option>
                            <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                            <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                            <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                            <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                            <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                            <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                            <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                            <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                            <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                            <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                            <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                            <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                            <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                            <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                            <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                            <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                            <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                            <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                            <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                            <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                            <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                            <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                            <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                            <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                            <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                            <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                            <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                            <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                            <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                            <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                            <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                            <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                            <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                            <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                            <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                            <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                            
                            <option value="Other">Other (Specify)</option>
                        </select>
                        <input type="text" id="cyberOrgNameOther" name="organizationNameOther" class="form-input" placeholder="Specify organization name" style="display: none; margin-top: 10px;">
                    </div>

                    <!-- City -->
                    <div class="form-group">
                        <label for="cyberCity" class="form-label">City*</label>
                        <select id="cyberCity" name="city" class="form-input" required onchange="toggleOtherField('cyberCity', 'cyberCityOther')">
                            <option value="">Select City</option>
                            <!-- Gujarat -->
                            <option value="Ahmedabad">Ahmedabad</option>
                            <option value="Amreli">Amreli</option>
                            <option value="Anand">Anand</option>
                            <option value="Aravalli">Aravalli</option>
                            <option value="Banaskantha">Banaskantha</option>
                            <option value="Bharuch">Bharuch</option>
                            <option value="Bhavnagar">Bhavnagar</option>
                            <option value="Botad">Botad</option>
                            <option value="Chhota Udaipur">Chhota Udaipur</option>
                            <option value="Dahod">Dahod</option>
                            <option value="Dang">Dang</option>
                            <option value="Devbhoomi Dwarka">Devbhoomi Dwarka</option>
                            <option value="Gandhinagar">Gandhinagar</option>
                            <option value="Gir Somnath">Gir Somnath</option>
                            <option value="Jamnagar">Jamnagar</option>
                            <option value="Junagadh">Junagadh</option>
                            <option value="Kheda">Kheda</option>
                            <option value="Kutch">Kutch</option>
                            <option value="Mahisagar">Mahisagar</option>
                            <option value="Mehsana">Mehsana</option>
                            <option value="Morbi">Morbi</option>
                            <option value="Narmada">Narmada</option>
                            <option value="Navsari">Navsari</option>
                            <option value="Patan">Patan</option>
                            <option value="Panchmahal">Panchmahal</option>
                            <option value="Porbandar">Porbandar</option>
                            <option value="Rajkot">Rajkot</option>
                            <option value="Sabarkantha">Sabarkantha</option>
                            <option value="Surat">Surat</option>
                            <option value="Surendranagar">Surendranagar</option>
                            <option value="Tapi">Tapi</option>
                            <option value="Vadodara">Vadodara</option>
                            <option value="Valsad">Valsad</option>

                            <!-- Rajasthan -->
                            <option value="Ajmer">Ajmer</option>
                            <option value="Alwar">Alwar</option>
                            <option value="Banswara">Banswara</option>
                            <option value="Baran">Baran</option>
                            <option value="Barmer">Barmer</option>
                            <option value="Bharatpur">Bharatpur</option>
                            <option value="Bhilwara">Bhilwara</option>
                            <option value="Bikaner">Bikaner</option>
                            <option value="Bundi">Bundi</option>
                            <option value="Chittorgarh">Chittorgarh</option>
                            <option value="Churu">Churu</option>
                            <option value="Dausa">Dausa</option>
                            <option value="Dholpur">Dholpur</option>
                            <option value="Dungarpur">Dungarpur</option>
                            <option value="Hanumangarh">Hanumangarh</option>
                            <option value="Jaipur">Jaipur</option>
                            <option value="Jaisalmer">Jaisalmer</option>
                            <option value="Jalore">Jalore</option>
                            <option value="Jhalawar">Jhalawar</option>
                            <option value="Jhunjhunu">Jhunjhunu</option>
                            <option value="Jodhpur">Jodhpur</option>
                            <option value="Karauli">Karauli</option>
                            <option value="Kota">Kota</option>
                            <option value="Nagaur">Nagaur</option>
                            <option value="Pali">Pali</option>
                            <option value="Pratapgarh">Pratapgarh</option>
                            <option value="Rajsamand">Rajsamand</option>
                            <option value="Sikar">Sikar</option>
                            <option value="Sirohi">Sirohi</option>
                            <option value="Sri Ganganagar">Sri Ganganagar</option>
                            <option value="Tonk">Tonk</option>
                            <option value="Udaipur">Udaipur</option>

                            <!-- Maharashtra -->
                            <option value="Ahmednagar">Ahmednagar</option>
                            <option value="Akola">Akola</option>
                            <option value="Amravati">Amravati</option>
                            <option value="Aurangabad">Aurangabad</option>
                            <option value="Beed">Beed</option>
                            <option value="Bhandara">Bhandara</option>
                            <option value="Chandrapur">Chandrapur</option>
                            <option value="Dhule">Dhule</option>
                            <option value="Gadchiroli">Gadchiroli</option>
                            <option value="Gondia">Gondia</option>
                            <option value="Hingoli">Hingoli</option>
                            <option value="Jalgaon">Jalgaon</option>
                            <option value="Jalna">Jalna</option>
                            <option value="Kolhapur">Kolhapur</option>
                            <option value="Latur">Latur</option>
                            <option value="Mumbai City">Mumbai City</option>
                            <option value="Mumbai Suburban">Mumbai Suburban</option>
                            <option value="Nagpur">Nagpur</option>
                            <option value="Nanded">Nanded</option>
                            <option value="Nandurbar">Nandurbar</option>
                            <option value="Nashik">Nashik</option>
                            <option value="Osmanabad">Osmanabad</option>
                            <option value="Palghar">Palghar</option>
                            <option value="Parbhani">Parbhani</option>
                            <option value="Pune">Pune</option>
                            <option value="Raigad">Raigad</option>
                            <option value="Ratnagiri">Ratnagiri</option>
                            <option value="Sangli">Sangli</option>
                            <option value="Satara">Satara</option>
                            <option value="Sindhudurg">Sindhudurg</option>
                            <option value="Solapur">Solapur</option>
                            <option value="Thane">Thane</option>
                            <option value="Wardha">Wardha</option>
                            <option value="Washim">Washim</option>
                            <option value="Yavatmal">Yavatmal</option>

                            <!-- Uttar Pradesh -->
                            <option value="Agra">Agra</option>
                            <option value="Aligarh">Aligarh</option>
                            <option value="Ambedkar Nagar">Ambedkar Nagar</option>
                            <option value="Amethi">Amethi</option>
                            <option value="Amroha">Amroha</option>
                            <option value="Auraiya">Auraiya</option>
                            <option value="Ayodhya">Ayodhya</option>
                            <option value="Azamgarh">Azamgarh</option>
                            <option value="Bagpat">Bagpat</option>
                            <option value="Bahraich">Bahraich</option>
                            <option value="Ballia">Ballia</option>
                            <option value="Balrampur">Balrampur</option>
                            <option value="Banda">Banda</option>
                            <option value="Barabanki">Barabanki</option>
                            <option value="Bareilly">Bareilly</option>
                            <option value="Basti">Basti</option>
                            <option value="Bhadohi">Bhadohi</option>
                            <option value="Bijnor">Bijnor</option>
                            <option value="Bulandshahr">Bulandshahr</option>
                            <option value="Chandauli">Chandauli</option>
                            <option value="Chitrakoot">Chitrakoot</option>
                            <option value="Deoria">Deoria</option>
                            <option value="Etah">Etah</option>
                            <option value="Etawah">Etawah</option>
                            <option value="Farrukhabad">Farrukhabad</option>
                            <option value="Fatehpur">Fatehpur</option>
                            <option value="Firozabad">Firozabad</option>
                            <option value="Gautam Buddha Nagar">Gautam Buddha Nagar</option>
                            <option value="Ghaziabad">Ghaziabad</option>
                            <option value="Ghazipur">Ghazipur</option>
                            <option value="Gonda">Gonda</option>
                            <option value="Gorakhpur">Gorakhpur</option>
                            <option value="Hamirpur">Hamirpur</option>
                            <option value="Hapur">Hapur</option>
                            <option value="Hardoi">Hardoi</option>
                            <option value="Hathras">Hathras</option>
                            <option value="Jalaun">Jalaun</option>
                            <option value="Jaunpur">Jaunpur</option>
                            <option value="Jhansi">Jhansi</option>
                            <option value="Kannauj">Kannauj</option>
                            <option value="Kanpur Dehat">Kanpur Dehat</option>
                            <option value="Kanpur Nagar">Kanpur Nagar</option>
                            <option value="Kasganj">Kasganj</option>
                            <option value="Kaushambi">Kaushambi</option>
                            <option value="Kushinagar">Kushinagar</option>
                            <option value="Lakhimpur Kheri">Lakhimpur Kheri</option>
                            <option value="Lalitpur">Lalitpur</option>
                            <option value="Lucknow">Lucknow</option>
                            <option value="Maharajganj">Maharajganj</option>
                            <option value="Mahoba">Mahoba</option>
                            <option value="Mainpuri">Mainpuri</option>
                            <option value="Mathura">Mathura</option>
                            <option value="Mau">Mau</option>
                            <option value="Meerut">Meerut</option>
                            <option value="Mirzapur">Mirzapur</option>
                            <option value="Moradabad">Moradabad</option>
                            <option value="Muzaffarnagar">Muzaffarnagar</option>
                            <option value="Pilibhit">Pilibhit</option>
                            <option value="Pratapgarh">Pratapgarh</option>
                            <option value="Rae Bareli">Rae Bareli</option>
                            <option value="Rampur">Rampur</option>
                            <option value="Saharanpur">Saharanpur</option>
                            <option value="Sant Kabir Nagar">Sant Kabir Nagar</option>
                            <option value="Shahjahanpur">Shahjahanpur</option>
                            <option value="Shravasti">Shravasti</option>
                            <option value="Siddharthnagar">Siddharthnagar</option>
                            <option value="Sitapur">Sitapur</option>
                            <option value="Sonbhadra">Sonbhadra</option>
                            <option value="Sultanpur">Sultanpur</option>
                            <option value="Unnao">Unnao</option>
                            <option value="Varanasi">Varanasi</option>

                            <!-- Uttarakhand -->
                            <option value="Almora">Almora</option>
                            <option value="Bageshwar">Bageshwar</option>
                            <option value="Chamoli">Chamoli</option>
                            <option value="Champawat">Champawat</option>
                            <option value="Dehradun">Dehradun</option>
                            <option value="Haridwar">Haridwar</option>
                            <option value="Nainital">Nainital</option>
                            <option value="Pauri Garhwal">Pauri Garhwal</option>
                            <option value="Pithoragarh">Pithoragarh</option>
                            <option value="Rudraprayag">Rudraprayag</option>
                            <option value="Tehri Garhwal">Tehri Garhwal</option>
                            <option value="Udham Singh Nagar">Udham Singh Nagar</option>
                            <option value="Uttarkashi">Uttarkashi</option>


                            <option value="Other">Other (Specify)</option>
                        </select>
                        <input type="text" id="cyberCityOther" name="cityOther" class="form-input" placeholder="Specify city" style="display: none; margin-top: 10px;">
                    </div>

                    <!-- State -->
                    <div class="form-group">
                        <label for="cyberState" class="form-label">State*</label>
                        <select id="cyberState" name="state" class="form-input" required>
                            <option value="">Select State</option>
                            <option value="Andhra Pradesh">Andhra Pradesh</option>
                            <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                            <option value="Assam">Assam</option>
                            <option value="Bihar">Bihar</option>
                            <option value="Chhattisgarh">Chhattisgarh</option>
                            <option value="Goa">Goa</option>
                            <option value="Gujarat">Gujarat</option>
                            <option value="Haryana">Haryana</option>
                            <option value="Himachal Pradesh">Himachal Pradesh</option>
                            <option value="Jharkhand">Jharkhand</option>
                            <option value="Karnataka">Karnataka</option>
                            <option value="Kerala">Kerala</option>
                            <option value="Madhya Pradesh">Madhya Pradesh</option>
                            <option value="Maharashtra">Maharashtra</option>
                            <option value="Manipur">Manipur</option>
                            <option value="Meghalaya">Meghalaya</option>
                            <option value="Mizoram">Mizoram</option>
                            <option value="Nagaland">Nagaland</option>
                            <option value="Odisha">Odisha</option>
                            <option value="Punjab">Punjab</option>
                            <option value="Rajasthan">Rajasthan</option>
                            <option value="Sikkim">Sikkim</option>
                            <option value="Tamil Nadu">Tamil Nadu</option>
                            <option value="Telangana">Telangana</option>
                            <option value="Tripura">Tripura</option>
                            <option value="Uttar Pradesh">Uttar Pradesh</option>
                            <option value="Uttarakhand">Uttarakhand</option>
                            <option value="West Bengal">West Bengal</option>

                            <!-- Union Territories -->
                            <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                            <option value="Chandigarh">Chandigarh</option>
                            <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                            <option value="Delhi">Delhi</option>
                            <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                            <option value="Ladakh">Ladakh</option>
                            <option value="Lakshadweep">Lakshadweep</option>
                            <option value="Puducherry">Puducherry</option>

                        </select>
                    </div>

                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Auditor Details</h4>
                    </div>

                    <!-- Prepared By -->
                    <div class="form-group">
                        <label for="cyberPreparedByPrefix" class="form-label">Prepared By*</label>
                        <div style="display: flex; gap: 10px;">
                            <select id="cyberPreparedByPrefix" name="preparedByPrefix" class="form-input" required style="flex: 0 0 100px;">
                                <option value="Mr.">Mr.</option>
                                <option value="Mrs.">Mrs.</option>
                                <option value="Dr.">Dr.</option>
                                <option value="Miss">Miss</option>
                            </select>
                            <input type="text" id="cyberPreparedByName" name="preparedByName" class="form-input" placeholder="Enter name" required style="flex: 1;">
                        </div>
                    </div>

                    <!-- Audit Dates -->
                    <div class="form-group">
                        <label for="cyberStartDate" class="form-label">Start Audit Date*</label>
                        <input type="date" id="cyberStartDate" name="startAuditDate" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label for="cyberEndDate" class="form-label">End Audit Date*</label>
                        <input type="date" id="cyberEndDate" name="endAuditDate" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Auditee Details</h4>
                    </div>

                    <!-- Submitted To -->
                    <div class="form-group">
                        <label for="cyberSubmittedToPrefix" class="form-label">Submitted To*</label>
                        <div style="display: flex; gap: 10px;">
                            <select id="cyberSubmittedToPrefix" name="submittedToPrefix" class="form-input" required style="flex: 0 0 100px;">
                                <option value="Mr.">Mr.</option>
                                <option value="Mrs.">Mrs.</option>
                                <option value="Dr.">Dr.</option>
                                <option value="Miss">Miss</option>
                            </select>
                            <input type="text" id="cyberSubmittedToName" name="submittedToName" class="form-input" placeholder="Enter name" required style="flex: 1;">
                        </div>
                    </div>

                    <!-- Auditee Designation -->
                    <div class="form-group">
                        <label for="cyberAuditeeDesignation" class="form-label">Designation of Auditee Person*</label>
                        <input type="text" id="cyberAuditeeDesignation" name="auditeeDesignation" class="form-input" placeholder="e.g., IT Manager" required>
                    </div>

                    <!-- Address -->
                    <div class="form-group">
                        <label for="cyberAddress" class="form-label">Address*</label>
                        <textarea id="cyberAddress" name="address" class="form-input" placeholder="Enter complete address" required rows="3" style="width: 100%;"></textarea>
                    </div>

                    <!-- Email with dynamic fields -->
                    <div class="form-group">
                        <label class="form-label">Email Address(es)*</label>
                        <div id="cyberEmailContainer">
                            <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                                <input type="email" name="email[]" class="form-input" placeholder="Enter email address" required style="flex: 1;">
                                <button type="button" class="submit-btn" onclick="addCyberEmailField()" style="flex: 0 0 40px; padding: 8px;">+</button>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Upload Files</h4>
                    </div>

                    <!-- Excel File Upload -->
                    <div class="form-group">
                        <label for="cyberExcelFile" class="form-label">Cybersecurity Audit Excel File*</label>
                        <input type="file" id="cyberExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                        <small style="color: #666; display: block; margin-top: 5px;">Upload the Cyber Security Audit Excel file.</small>
                    </div>

                    <!-- ZIP File Upload -->
                    <div class="form-group">
                        <label for="cyberZipFile" class="form-label">Evidance - ZIP File (Images)*</label>
                        <input type="file" id="cyberZipFile" name="zipFile" class="form-input" accept=".zip" required>
                        <small style="color: #666; display: block; margin-top: 5px;">Please upload a ZIP file containing the evidence. The evidence image file names must strictly follow the defined naming format based on the corresponding question number. For example, for the question “1. Has the bank conducted its audit through a CERT-In empanelled agency?”, the evidence image names should begin with the point number “1”, followed by a short descriptive title. Valid examples include “1 Is Audit Report.png” and “1 VAPT Report.jpg”.</small>
                    </div>

                    <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('cyberSecurityAuditReportModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="cyberSecurityAuditReportSubmitBtn">
                            <i class="fas fa-check"></i> Submit
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- First Audit MetaData Modal -->
    <div id="firstAuditMetaDataModal" class="modal">
        <div class="modal-content" style="max-width: 1000px;">
            <div class="modal-header">
                <h3>First Audit MetaData</h3>
                <span class="close-modal" onclick="closeModal('firstAuditMetaDataModal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="firstAuditMetaDataForm" method="POST" onsubmit="handleFirstAuditMetaDataSubmit(event)">
                    
                    <!-- Audit Dates -->
                    <div class="form-group">
                        <label for="metaStartDate" class="form-label">Start Audit Date*</label>
                        <input type="date" id="metaStartDate" name="startAuditDate" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label for="metaEndDate" class="form-label">End Audit Date*</label>
                        <input type="date" id="metaEndDate" name="endAuditDate" class="form-input" required>
                    </div>

                    <!-- Name of Auditee organization -->
                    <div class="form-group">
                        <label for="metaAuditeeOrg" class="form-label">Name of Auditee Organization*</label>
                        <select id="metaAuditeeOrg" name="nameOfAuditeeOrg" class="form-input" required onchange="toggleOtherField('metaAuditeeOrg', 'metaAuditeeOrgOther')">
                            <option value="">Select Organization</option>
                            <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                            <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                            <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                            <option value="Megasoft Limited">Megasoft Limited</option>
                            <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                            <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                            <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                            <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                            <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                            <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                            <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                            <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                            <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                            <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                            <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                            <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                            <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                            <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                            <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                            <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                            <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                            <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                            <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                            <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                            <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                            <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                            <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                            <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                            <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                            <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                            <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                            <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                            <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                            <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                            <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                            <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                            <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                            <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                            <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                            <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                            
                            <option value="Other">Other (Specify)</option>
                        </select>
                        <input type="text" id="metaAuditeeOrgOther" name="nameOfAuditeeOrgOther" class="form-input" placeholder="Specify organization name" style="display: none; margin-top: 10px;">
                    </div>

                    <!-- Category of Organization -->
                    <div class="form-group">
                        <label for="metaCategoryOrg" class="form-label">Category of Organization*</label>
                        <select id="metaCategoryOrg" name="categoryOfOrg" class="form-input" required>
                            <option value="">Select Category</option>
                            <option value="Central Ministry/Department">Central Ministry/Department</option>
                            <option value="Organization under Government Department">Organization under Government Department</option>
                            <option value="Private Sector" selected>Private Sector</option>
                            <option value="Public sector organisations">Public sector organisations</option>
                            <option value="State Government Department">State Government Department</option>
                        </select>
                    </div>

                    <!-- Sector of Organization -->
                    <div class="form-group">
                        <label for="metaSectorOrg" class="form-label">Sector of Organization*</label>
                        <select id="metaSectorOrg" name="sectorOfOrg" class="form-input" required onchange="updateSubSectorOptions()">
                            <option value="">Select Sector</option>
                            <option value="Agriculture">Agriculture</option>
                            <option value="Defence">Defence</option>
                            <option value="Education">Education</option>
                            <option value="Energy">Energy</option>
                            <option value="Finance" selected>Finance</option>
                            <option value="Healthcare">Healthcare</option>
                            <option value="Information_and_Broadcasting">Information and Broadcasting</option>
                            <option value="Information_and_Communication_Technology">Information and Communication Technology</option>
                            <option value="Law_Enforcement_and_Security">Law Enforcement and Security</option>
                            <option value="Public_Essential_Services_and_Utilities">Public Essential Services and Utilities</option>
                            <option value="Space">Space</option>
                            <option value="Transportation">Transportation</option>
                        </select>
                    </div>

                    <!-- Sub Sector -->
                    <div class="form-group">
                        <label for="metaSubSector" class="form-label">Sub Sector*</label>
                        <select id="metaSubSector" name="subSector" class="form-input" required>
                            <option value="">Select Sector First</option>
                        </select>
                    </div>

                    <!-- Type of audit -->
                    <div class="form-group">
                        <label for="metaTypeAudit" class="form-label">Type of Audit*</label>
                        <select id="metaTypeAudit" name="typeOfAudit" class="form-input" required onchange="toggleOtherField('metaTypeAudit', 'metaTypeAuditOther')">
                            <option value="">Select Type</option>
                            <option value="API Security Audit">API Security Audit</option>
                            <option value="Cloud Security Audit">Cloud Security Audit</option>
                            <option value="Compliance to Standard/Framework/Policies Related Audit">Compliance to Standard/Framework/Policies Related Audit</option>
                            <option value="Digital Forensic Readiness Assessment">Digital Forensic Readiness Assessment</option>
                            <option value="Industrial Control Systems (ICS) / SCADA Audit">Industrial Control Systems (ICS) / SCADA Audit</option>
                            <option value="IoT Security Assessment">IoT Security Assessment</option>
                            <option value="Mobile Application Audit">Mobile Application Audit</option>
                            <option value="Network Infrastructure Audits">Network Infrastructure Audits</option>
                            <option value="Process Audit">Process Audit</option>
                            <option value="Red Team Assessment">Red Team Assessment</option>
                            <option value="Source Code Review">Source Code Review</option>
                            <option value="VAPT-Infrastructure" selected>VAPT-Infrastructure</option>
                            <option value="VAPT-Application">VAPT-Application</option>
                            <option value="Website /Web Application Audit">Website /Web Application Audit</option>
                            <option value="Wireless security audit">Wireless security audit</option>
                            <option value="Other">Other (Specify)</option>
                        </select>
                        <input type="text" id="metaTypeAuditOther" name="typeOfAuditOther" class="form-input" placeholder="Please specify type of audit" style="display: none; margin-top: 10px;">
                    </div>

                    <!-- Details of website/application/infrastructure -->
                    <div class="form-group">
                        <label for="metaDetails" class="form-label">Details of web site/name of application/no. of servers, perimeter devices, other infrastructure*</label>
                        <textarea id="metaDetails" name="detailsOfWebsite" class="form-input" placeholder="Enter details" required rows="4" style="width: 100%; resize: vertical;"></textarea>
                    </div>

                    <!-- Reason for conducting Audit -->
                    <div class="form-group">
                        <label for="metaReason" class="form-label">Reason for conducting Audit*</label>
                        <select id="metaReason" name="reasonForAudit" class="form-input" required>
                            <option value="">Select Reason</option>
                            <option value="Certificate of compliance like ISO 27001">Certificate of compliance like ISO 27001</option>
                            <option value="Certificate of safe hosting">Certificate of safe hosting</option>
                            <option value="Change in process or infrastructure">Change in process or infrastructure</option>
                            <option value="Government directions">Government directions</option>
                            <option value="Incident/ Breach in Organisation">Incident/ Breach in Organisation</option>
                            <option value="Incident/ Breach in Sector">Incident/ Breach in Sector</option>
                            <option value="New application/ Infrastructure">New application/ Infrastructure</option>
                            <option value="Not Known">Not Known</option>
                            <option value="Periodic Audit as per Policy of organisation.">Periodic Audit as per Policy of organisation.</option>
                            <option value="Regulatory directions" selected>Regulatory directions</option>
                            <option value="Third Party Initiated">Third Party Initiated</option>
                        </select>
                    </div>

                    <!-- Standards Used for conducting Audit -->
                    <div class="form-group">
                        <label for="metaStandards" class="form-label">Standards Used for conducting Audit*</label>
                        <input type="text" id="metaStandards" name="standardsUsed" class="form-input" placeholder="Enter standards" required>
                    </div>

                    <!-- Challenges in conducting Audits -->
                    <div class="form-group">
                        <label for="metaChallenges" class="form-label">Challenges in conducting Audits*</label>
                        <textarea id="metaChallenges" name="challenges" class="form-input" placeholder="Enter challenges" required rows="4" style="width: 100%; resize: vertical;"></textarea>
                    </div>

                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Compliance Questions</h4>
                    </div>

                    <!-- Compliance questions -->
                    <div class="form-group">
                        <label for="metaCompFinancial" class="form-label">Compliance to financial sector regulatory bodies guidelines/circulars/directions like from RBI, IRDAI, SEBI, NPCI*</label>
                        <select id="metaCompFinancial" name="complianceFinancial" class="form-input" required>
                            <option value="">Select</option>
                            <option value="Yes">Yes</option>
                            <option value="No">No</option>
                            <option value="Not applicable">Not applicable</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="metaCompRegulatory" class="form-label">Compliance to regulatory bodies guidelines/circulars/directions like from UIDAI, CCA, DoT, TRAI*</label>
                        <select id="metaCompRegulatory" name="complianceRegulatory" class="form-input" required>
                            <option value="">Select</option>
                            <option value="Yes">Yes</option>
                            <option value="No">No</option>
                            <option value="Not applicable">Not applicable</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="metaCompCertIn" class="form-label">Compliance to CERT-In directions under sub-section (6) of section 70B of the IT Act, 2000 dated 28 April, 2022*</label>
                        <select id="metaCompCertIn" name="complianceCertIn" class="form-input" required>
                            <option value="">Select</option>
                            <option value="Yes">Yes</option>
                            <option value="No">No</option>
                            <option value="Not applicable">Not applicable</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="metaCompCEA" class="form-label">Compliance to CEA (Cyber Security in Power Sector) guidelines 2021*</label>
                        <select id="metaCompCEA" name="complianceCEA" class="form-input" required>
                            <option value="">Select</option>
                            <option value="Yes">Yes</option>
                            <option value="No">No</option>
                            <option value="Not applicable">Not applicable</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="metaCompOther" class="form-label">Any other domestic regulation, directions, guidelines (Please Specify)*</label>
                        <select id="metaCompOther" name="complianceOther" class="form-input" required>
                            <option value="">Select</option>
                            <option value="Yes">Yes</option>
                            <option value="No" selected>No</option>
                            <option value="Not applicable">Not applicable</option>
                        </select>
                    </div>

                    <!-- Type of Audit Report -->
                    <div class="form-group">
                        <label for="metaTypeReport" class="form-label">Type of Audit Report*</label>
                        <select id="metaTypeReport" name="typeOfAuditReport" class="form-input" required>
                            <option value="">Select Type</option>
                            <option value="First Audit Report" selected>First Audit Report</option>
                            <option value="Follow up Audit Report">Follow up Audit Report</option>
                        </select>
                    </div>

                    <!-- No. of vulnerabilities -->
                    <div class="form-group">
                        <label for="metaNumVuln" class="form-label">No. of vulnerabilities/ security issues reported during FIRST Audit*</label>
                        <input type="number" id="metaNumVuln" name="numVulnerabilities" class="form-input" placeholder="Enter number" min="0" required>
                    </div>

                    <!-- No. of days taken to patch -->
                    <div class="form-group">
                        <label for="metaDaysPatch" class="form-label">No. of days taken by Client to patch the vulnerabilities after submission of Audit report*</label>
                        <select id="metaDaysPatch" name="numDaysToPatch" class="form-input" required>
                            <option value="">Select</option>
                            <option value="Not Known">Not Known</option>
                            <option value="Follow up audit not performed" selected>Follow up audit not performed</option>
                            <option value="NA">NA</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                            <option value="13">13</option>
                            <option value="14">14</option>
                            <option value="15">15</option>
                            <option value="16">16</option>
                            <option value="17">17</option>
                            <option value="18">18</option>
                            <option value="19">19</option>
                            <option value="20">20</option>
                            <option value="21">21</option>
                            <option value="22">22</option>
                            <option value="23">23</option>
                            <option value="24">24</option>
                            <option value="25">25</option>
                            <option value="26">26</option>
                            <option value="27">27</option>
                            <option value="28">28</option>
                            <option value="29">29</option>
                            <option value="30">30</option>
                            <option value="31">31</option>
                            <option value="32">32</option>
                            <option value="33">33</option>
                            <option value="34">34</option>
                            <option value="35">35</option>
                            <option value="36">36</option>
                            <option value="37">37</option>
                            <option value="38">38</option>
                            <option value="39">39</option>
                            <option value="40">40</option>
                            <option value="41">41</option>
                            <option value="42">42</option>
                            <option value="43">43</option>
                            <option value="44">44</option>
                            <option value="45">45</option>
                            <option value="46">46</option>
                            <option value="47">47</option>
                            <option value="48">48</option>
                            <option value="49">49</option>
                            <option value="50">50</option>
                            <option value="51">51</option>
                            <option value="52">52</option>
                            <option value="53">53</option>
                            <option value="54">54</option>
                            <option value="55">55</option>
                            <option value="56">56</option>
                            <option value="57">57</option>
                            <option value="58">58</option>
                            <option value="59">59</option>
                            <option value="60">60</option>
                            <option value="61">61</option>
                            <option value="62">62</option>
                            <option value="63">63</option>
                            <option value="64">64</option>
                            <option value="65">65</option>
                            <option value="66">66</option>
                            <option value="67">67</option>
                            <option value="68">68</option>
                            <option value="69">69</option>
                            <option value="70">70</option>
                            <option value="71">71</option>
                            <option value="72">72</option>
                            <option value="73">73</option>
                            <option value="74">74</option>
                            <option value="75">75</option>
                            <option value="76">76</option>
                            <option value="77">77</option>
                            <option value="78">78</option>
                            <option value="79">79</option>
                            <option value="80">80</option>
                            <option value="81">81</option>
                            <option value="82">82</option>
                            <option value="83">83</option>
                            <option value="84">84</option>
                            <option value="85">85</option>
                            <option value="86">86</option>
                            <option value="87">87</option>
                            <option value="88">88</option>
                            <option value="89">89</option>
                            <option value="90">90</option>
                            <option value="91">91</option>
                            <option value="92">92</option>
                            <option value="93">93</option>
                            <option value="94">94</option>
                            <option value="95">95</option>
                            <option value="96">96</option>
                            <option value="97">97</option>
                            <option value="98">98</option>
                            <option value="99">99</option>
                            <option value="100">100</option>
                            <option value="More than 100">More than 100</option>
                        </select>
                    </div>

                    <!-- Duration between audits -->
                    <div class="form-group">
                        <label for="metaDuration" class="form-label">Durations (in days) between end of FIRST audit and start of FOLLOW-UP/SECOND audit*</label>
                        <select id="metaDuration" name="durationBetweenAudits" class="form-input" required>
                            <option value="">Select</option>
                            <option value="Follow up audit not performed" selected>Follow up audit not performed</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                            <option value="13">13</option>
                            <option value="14">14</option>
                            <option value="15">15</option>
                            <option value="16">16</option>
                            <option value="17">17</option>
                            <option value="18">18</option>
                            <option value="19">19</option>
                            <option value="20">20</option>
                            <option value="21">21</option>
                            <option value="22">22</option>
                            <option value="23">23</option>
                            <option value="24">24</option>
                            <option value="25">25</option>
                            <option value="26">26</option>
                            <option value="27">27</option>
                            <option value="28">28</option>
                            <option value="29">29</option>
                            <option value="30">30</option>
                            <option value="31">31</option>
                            <option value="32">32</option>
                            <option value="33">33</option>
                            <option value="34">34</option>
                            <option value="35">35</option>
                            <option value="36">36</option>
                            <option value="37">37</option>
                            <option value="38">38</option>
                            <option value="39">39</option>
                            <option value="40">40</option>
                            <option value="41">41</option>
                            <option value="42">42</option>
                            <option value="43">43</option>
                            <option value="44">44</option>
                            <option value="45">45</option>
                            <option value="46">46</option>
                            <option value="47">47</option>
                            <option value="48">48</option>
                            <option value="49">49</option>
                            <option value="50">50</option>
                            <option value="51">51</option>
                            <option value="52">52</option>
                            <option value="53">53</option>
                            <option value="54">54</option>
                            <option value="55">55</option>
                            <option value="56">56</option>
                            <option value="57">57</option>
                            <option value="58">58</option>
                            <option value="59">59</option>
                            <option value="60">60</option>
                            <option value="61">61</option>
                            <option value="62">62</option>
                            <option value="63">63</option>
                            <option value="64">64</option>
                            <option value="65">65</option>
                            <option value="66">66</option>
                            <option value="67">67</option>
                            <option value="68">68</option>
                            <option value="69">69</option>
                            <option value="70">70</option>
                            <option value="71">71</option>
                            <option value="72">72</option>
                            <option value="73">73</option>
                            <option value="74">74</option>
                            <option value="75">75</option>
                            <option value="76">76</option>
                            <option value="77">77</option>
                            <option value="78">78</option>
                            <option value="79">79</option>
                            <option value="80">80</option>
                            <option value="81">81</option>
                            <option value="82">82</option>
                            <option value="83">83</option>
                            <option value="84">84</option>
                            <option value="85">85</option>
                            <option value="86">86</option>
                            <option value="87">87</option>
                            <option value="88">88</option>
                            <option value="89">89</option>
                            <option value="90">90</option>
                            <option value="91">91</option>
                            <option value="92">92</option>
                            <option value="93">93</option>
                            <option value="94">94</option>
                            <option value="95">95</option>
                            <option value="96">96</option>
                            <option value="97">97</option>
                            <option value="98">98</option>
                            <option value="99">99</option>
                            <option value="100">100</option>
                            <option value="More than 100">More than 100</option>
                        </select>
                    </div>

                    <!-- No. of open issues -->
                    <div class="form-group">
                        <label for="metaOpenIssues" class="form-label">No. of open issues after follow-up audits*</label>
                        <select id="metaOpenIssues" name="numOpenIssues" class="form-input" required>
                            <option value="">Select</option>
                            <option value="Follow up audit not performed" selected>Follow up audit not performed</option>
                            <option value="NA">NA</option>
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                            <option value="13">13</option>
                            <option value="14">14</option>
                            <option value="15">15</option>
                            <option value="16">16</option>
                            <option value="17">17</option>
                            <option value="18">18</option>
                            <option value="19">19</option>
                            <option value="20">20</option>
                            <option value="21">21</option>
                            <option value="22">22</option>
                            <option value="23">23</option>
                            <option value="24">24</option>
                            <option value="25">25</option>
                            <option value="26">26</option>
                            <option value="27">27</option>
                            <option value="28">28</option>
                            <option value="29">29</option>
                            <option value="30">30</option>
                            <option value="31">31</option>
                            <option value="32">32</option>
                            <option value="33">33</option>
                            <option value="34">34</option>
                            <option value="35">35</option>
                            <option value="36">36</option>
                            <option value="37">37</option>
                            <option value="38">38</option>
                            <option value="39">39</option>
                            <option value="40">40</option>
                            <option value="41">41</option>
                            <option value="42">42</option>
                            <option value="43">43</option>
                            <option value="44">44</option>
                            <option value="45">45</option>
                            <option value="46">46</option>
                            <option value="47">47</option>
                            <option value="48">48</option>
                            <option value="49">49</option>
                            <option value="50">50</option>
                            <option value="51">51</option>
                            <option value="52">52</option>
                            <option value="53">53</option>
                            <option value="54">54</option>
                            <option value="55">55</option>
                            <option value="56">56</option>
                            <option value="57">57</option>
                            <option value="58">58</option>
                            <option value="59">59</option>
                            <option value="60">60</option>
                            <option value="61">61</option>
                            <option value="62">62</option>
                            <option value="63">63</option>
                            <option value="64">64</option>
                            <option value="65">65</option>
                            <option value="66">66</option>
                            <option value="67">67</option>
                            <option value="68">68</option>
                            <option value="69">69</option>
                            <option value="70">70</option>
                            <option value="71">71</option>
                            <option value="72">72</option>
                            <option value="73">73</option>
                            <option value="74">74</option>
                            <option value="75">75</option>
                            <option value="76">76</option>
                            <option value="77">77</option>
                            <option value="78">78</option>
                            <option value="79">79</option>
                            <option value="80">80</option>
                            <option value="81">81</option>
                            <option value="82">82</option>
                            <option value="83">83</option>
                            <option value="84">84</option>
                            <option value="85">85</option>
                            <option value="86">86</option>
                            <option value="87">87</option>
                            <option value="88">88</option>
                            <option value="89">89</option>
                            <option value="90">90</option>
                            <option value="91">91</option>
                            <option value="92">92</option>
                            <option value="93">93</option>
                            <option value="94">94</option>
                            <option value="95">95</option>
                            <option value="96">96</option>
                            <option value="97">97</option>
                            <option value="98">98</option>
                            <option value="99">99</option>
                            <option value="100">100</option>
                            <option value="101">101</option>
                            <option value="102">102</option>
                            <option value="103">103</option>
                            <option value="104">104</option>
                            <option value="105">105</option>
                            <option value="106">106</option>
                            <option value="107">107</option>
                            <option value="108">108</option>
                            <option value="109">109</option>
                            <option value="110">110</option>
                            <option value="111">111</option>
                            <option value="112">112</option>
                            <option value="113">113</option>
                            <option value="114">114</option>
                            <option value="115">115</option>
                            <option value="116">116</option>
                            <option value="117">117</option>
                            <option value="118">118</option>
                            <option value="119">119</option>
                            <option value="120">120</option>
                            <option value="121">121</option>
                            <option value="122">122</option>
                            <option value="123">123</option>
                            <option value="124">124</option>
                            <option value="125">125</option>
                            <option value="126">126</option>
                            <option value="127">127</option>
                            <option value="128">128</option>
                            <option value="129">129</option>
                            <option value="130">130</option>
                            <option value="131">131</option>
                            <option value="132">132</option>
                            <option value="133">133</option>
                            <option value="134">134</option>
                            <option value="135">135</option>
                            <option value="136">136</option>
                            <option value="137">137</option>
                            <option value="138">138</option>
                            <option value="139">139</option>
                            <option value="140">140</option>
                            <option value="141">141</option>
                            <option value="142">142</option>
                            <option value="143">143</option>
                            <option value="144">144</option>
                            <option value="145">145</option>
                            <option value="146">146</option>
                            <option value="147">147</option>
                            <option value="148">148</option>
                            <option value="149">149</option>
                            <option value="150">150</option>
                            <option value="151">151</option>
                            <option value="152">152</option>
                            <option value="153">153</option>
                            <option value="154">154</option>
                            <option value="155">155</option>
                            <option value="156">156</option>
                            <option value="157">157</option>
                            <option value="158">158</option>
                            <option value="159">159</option>
                            <option value="160">160</option>
                            <option value="161">161</option>
                            <option value="162">162</option>
                            <option value="163">163</option>
                            <option value="164">164</option>
                            <option value="165">165</option>
                            <option value="166">166</option>
                            <option value="167">167</option>
                            <option value="168">168</option>
                            <option value="169">169</option>
                            <option value="170">170</option>
                            <option value="171">171</option>
                            <option value="172">172</option>
                            <option value="173">173</option>
                            <option value="174">174</option>
                            <option value="175">175</option>
                            <option value="176">176</option>
                            <option value="177">177</option>
                            <option value="178">178</option>
                            <option value="179">179</option>
                            <option value="180">180</option>
                            <option value="More than 180">More than 180</option>
                        </select>
                    </div>

                    <!-- Geographical detail -->
                    <div class="form-group">
                        <label for="metaGeoState" class="form-label">Geographical detail of Client (State/UT)*</label>
                        <select id="metaGeoState" name="geographicalState" class="form-input" required>
                            <option value="">Select State/UT</option>
                            <option value="Andhra Pradesh">Andhra Pradesh</option>
                            <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                            <option value="Assam">Assam</option>
                            <option value="Bihar">Bihar</option>
                            <option value="Chhattisgarh">Chhattisgarh</option>
                            <option value="Goa">Goa</option>
                            <option value="Gujarat">Gujarat</option>
                            <option value="Haryana">Haryana</option>
                            <option value="Himachal Pradesh">Himachal Pradesh</option>
                            <option value="Jharkhand">Jharkhand</option>
                            <option value="Karnataka">Karnataka</option>
                            <option value="Kerala">Kerala</option>
                            <option value="Madhya Pradesh">Madhya Pradesh</option>
                            <option value="Maharashtra">Maharashtra</option>
                            <option value="Manipur">Manipur</option>
                            <option value="Meghalaya">Meghalaya</option>
                            <option value="Mizoram">Mizoram</option>
                            <option value="Nagaland">Nagaland</option>
                            <option value="Odisha">Odisha</option>
                            <option value="Punjab">Punjab</option>
                            <option value="Rajasthan">Rajasthan</option>
                            <option value="Sikkim">Sikkim</option>
                            <option value="Tamil Nadu">Tamil Nadu</option>
                            <option value="Telangana">Telangana</option>
                            <option value="Tripura">Tripura</option>
                            <option value="Uttar Pradesh">Uttar Pradesh</option>
                            <option value="Uttarakhand">Uttarakhand</option>
                            <option value="West Bengal">West Bengal</option>

                            <!-- Union Territories -->
                            <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                            <option value="Chandigarh">Chandigarh</option>
                            <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                            <option value="Delhi">Delhi</option>
                            <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                            <option value="Ladakh">Ladakh</option>
                            <option value="Lakshadweep">Lakshadweep</option>
                            <option value="Puducherry">Puducherry</option>

                        </select>
                    </div>

                    <!-- Date of Audit Completion -->
                    <div class="form-group">
                        <label for="metaDateCompletion" class="form-label">Date of Audit Completion*</label>
                        <input type="date" id="metaDateCompletion" name="dateAuditCompletion" class="form-input" required>
                    </div>

                    <!-- Date of last audit -->
                    <div class="form-group">
                        <label for="metaDateLastAuditType" class="form-label">Date of last audit of same infrastructure*</label>
                        <select id="metaDateLastAuditType" name="dateLastAuditType" class="form-input" required onchange="toggleLastAuditDateInput('metaDateLastAuditType', 'metaDateLastAudit')">
                            <option value="">Select</option>
                            <option value="NA" selected>NA</option>
                            <option value="EnterDate">Enter Date</option>
                        </select>
                        <input type="date" id="metaDateLastAudit" class="form-input" style="display: none; margin-top: 10px;">
                        <input type="hidden" id="metaDateLastAuditValue" name="dateLastAudit" value="NA">
                    </div>

                    <!-- Vulnerability Status Radio Button -->
                    <div class="form-group">
                        <label class="form-label">Vulnerability Status*</label>
                        <div style="display: flex; gap: 30px; margin-top: 10px;">
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="radio" name="vulnerabilityStatus" value="0" required onchange="toggleVulnerabilitySection()">
                                <span>0 Vulnerability</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="radio" name="vulnerabilityStatus" value="has" required onchange="toggleVulnerabilitySection()" checked>
                                <span>Has Vulnerability</span>
                            </label>
                        </div>
                    </div>

                    <!-- Vulnerability Details Section -->
                    <div id="vulnerabilitySection" class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                            Audited Infrastructure Details
                            <button type="button" class="submit-btn" onclick="addVulnerabilityEntry()" style="float: right; margin-top: -5px;">
                                <i class="fas fa-plus"></i> Add Entry
                            </button>
                        </h4>

                        <div id="vulnerabilityContainer">
                        <!-- First vulnerability entry -->
                        <div class="vulnerability-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                            <div class="form-group">
                                <label class="form-label">Audited infrastructure details*</label>
                                <input type="text" name="vuln_0_infrastructure" class="form-input" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                                <input type="text" name="vuln_0_name" class="form-input" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">CVE/CWE Reference Number*</label>
                                <input type="text" name="vuln_0_cve" class="form-input" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Severity of Issue*</label>
                                <select name="vuln_0_severity" class="form-input" required>
                                    <option value="">Select Severity</option>
                                    <option value="Critical">Critical</option>
                                    <option value="High">High</option>
                                    <option value="Medium">Medium</option>
                                    <option value="Low">Low</option>
                                    <option value="Informational">Informational</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                                <input type="number" name="vuln_0_count" class="form-input" min="0" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Attributing Factor*</label>
                                <select name="vuln_0_factor" class="form-input" required>
                                    <option value="">Select Factor</option>
                                    <option value="Coding Error">Coding Error</option>
                                    <option value="Configuration Error">Configuration Error</option>
                                    <option value="Deployment Error">Deployment Error</option>
                                    <option value="Design Error">Design Error</option>
                                    <option value="Operation Error">Operation Error</option>
                                    <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    </div>

                    <!-- Employee Details Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                            Employee Details
                            <button type="button" class="submit-btn" onclick="addEmployeeEntry()" style="float: right; margin-top: -5px;">
                                <i class="fas fa-plus"></i> Add Employee
                            </button>
                        </h4>
                    </div>

                    <div id="employeeContainer">
                        <!-- First employee entry -->
                        <div class="employee-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                            <div class="form-group">
                                <label class="form-label">Name of employee*</label>
                                <input type="text" name="emp_0_name" class="form-input" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">E-mail ID*</label>
                                <input type="email" name="emp_0_email" class="form-input" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">CISSP*</label>
                                <div style="display: flex; gap: 20px;">
                                    <label><input type="radio" name="emp_0_cissp" value="Yes" required> Yes</label>
                                    <label><input type="radio" name="emp_0_cissp" value="No" required> No</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">CISA*</label>
                                <div style="display: flex; gap: 20px;">
                                    <label><input type="radio" name="emp_0_cisa" value="Yes" required> Yes</label>
                                    <label><input type="radio" name="emp_0_cisa" value="No" required> No</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">CISM*</label>
                                <div style="display: flex; gap: 20px;">
                                    <label><input type="radio" name="emp_0_cism" value="Yes" required> Yes</label>
                                    <label><input type="radio" name="emp_0_cism" value="No" required> No</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ISO*</label>
                                <div style="display: flex; gap: 20px;">
                                    <label><input type="radio" name="emp_0_iso" value="Yes" required> Yes</label>
                                    <label><input type="radio" name="emp_0_iso" value="No" required> No</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">DISA*</label>
                                <div style="display: flex; gap: 20px;">
                                    <label><input type="radio" name="emp_0_disa" value="Yes" required> Yes</label>
                                    <label><input type="radio" name="emp_0_disa" value="No" required> No</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">OSCP*</label>
                                <div style="display: flex; gap: 20px;">
                                    <label><input type="radio" name="emp_0_oscp" value="Yes" required> Yes</label>
                                    <label><input type="radio" name="emp_0_oscp" value="No" required> No</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">CEH*</label>
                                <div style="display: flex; gap: 20px;">
                                    <label><input type="radio" name="emp_0_ceh" value="Yes" required> Yes</label>
                                    <label><input type="radio" name="emp_0_ceh" value="No" required> No</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Others</label>
                                <input type="text" name="emp_0_others" class="form-input" placeholder="Specify other certifications">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                                <input type="number" name="emp_0_experience" class="form-input" min="0" step="0.5" required>
                            </div>
                        </div>
                    </div>

                    <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('firstAuditMetaDataModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="firstAuditMetaDataSubmitBtn">
                            <i class="fas fa-check"></i> Submit
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

<!-- Follow Up Audit MetaData Modal -->
    <div id="followUpAuditMetaDataModal" class="modal">
        <div class="modal-content" style="max-width: 1000px;">
            <div class="modal-header">
                <h3>Follow Up Audit MetaData</h3>
                <span class="close-modal" onclick="closeModal('followUpAuditMetaDataModal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="followUpAuditMetaDataForm" method="POST" onsubmit="handleFollowUpAuditMetaDataSubmit(event)">
                    
                    <!-- Audit Dates -->
                    <div class="form-group">
                        <label for="followUpMetaStartDate" class="form-label">Start Audit Date*</label>
                        <input type="date" id="followUpMetaStartDate" name="startAuditDate" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label for="followUpMetaEndDate" class="form-label">End Audit Date*</label>
                        <input type="date" id="followUpMetaEndDate" name="endAuditDate" class="form-input" required>
                    </div>

                    <!-- Name of Auditee organization -->
                    <div class="form-group">
                        <label for="followUpMetaAuditeeOrg" class="form-label">Name of Auditee Organization*</label>
                        <select id="followUpMetaAuditeeOrg" name="nameOfAuditeeOrg" class="form-input" required onchange="toggleOtherField('followUpMetaAuditeeOrg', 'followUpMetaAuditeeOrgOther')">
                            <option value="">Select Organization</option>
                            <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                            <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                            <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                            <option value="Megasoft Limited">Megasoft Limited</option>
                            <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                            <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                            <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                            <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                            <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                            <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                            <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                            <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                            <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                            <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                            <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                            <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                            <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                            <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                            <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                            <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                            <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                            <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                            <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                            <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                            <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                            <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                            <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                            <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                            <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                            <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                            <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                            <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                            <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                            <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                            <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                            <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                            <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                            <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                            <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                            <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                            
                            <option value="Other">Other (Specify)</option>
                        </select>
                        <input type="text" id="followUpMetaAuditeeOrgOther" name="nameOfAuditeeOrgOther" class="form-input" placeholder="Specify organization name" style="display: none; margin-top: 10px;">
                    </div>

                    <!-- Category of Organization -->
                    <div class="form-group">
                        <label for="followUpMetaCategoryOrg" class="form-label">Category of Organization*</label>
                        <select id="followUpMetaCategoryOrg" name="categoryOfOrg" class="form-input" required>
                            <option value="">Select Category</option>
                            <option value="Central Ministry/Department">Central Ministry/Department</option>
                            <option value="Organization under Government Department">Organization under Government Department</option>
                            <option value="Private Sector" selected>Private Sector</option>
                            <option value="Public sector organisations">Public sector organisations</option>
                            <option value="State Government Department">State Government Department</option>
                        </select>
                    </div>

                    <!-- Sector of Organization -->
                    <div class="form-group">
                        <label for="followUpMetaSectorOrg" class="form-label">Sector of Organization*</label>
                        <select id="followUpMetaSectorOrg" name="sectorOfOrg" class="form-input" required onchange="updateFollowUpSubSectorOptions()">
                            <option value="">Select Sector</option>
                            <option value="Agriculture">Agriculture</option>
                            <option value="Defence">Defence</option>
                            <option value="Education">Education</option>
                            <option value="Energy">Energy</option>
                            <option value="Finance" selected>Finance</option>
                            <option value="Healthcare">Healthcare</option>
                            <option value="Information_and_Broadcasting">Information and Broadcasting</option>
                            <option value="Information_and_Communication_Technology">Information and Communication Technology</option>
                            <option value="Law_Enforcement_and_Security">Law Enforcement and Security</option>
                            <option value="Public_Essential_Services_and_Utilities">Public Essential Services and Utilities</option>
                            <option value="Space">Space</option>
                            <option value="Transportation">Transportation</option>
                        </select>
                    </div>

                    <!-- Sub Sector -->
                    <div class="form-group">
                        <label for="followUpMetaSubSector" class="form-label">Sub Sector*</label>
                        <select id="followUpMetaSubSector" name="subSector" class="form-input" required>
                            <option value="">Select Sector First</option>
                        </select>
                    </div>

                    <!-- Type of audit -->
                    <div class="form-group">
                        <label for="followUpMetaTypeAudit" class="form-label">Type of Audit*</label>
                        <select id="followUpMetaTypeAudit" name="typeOfAudit" class="form-input" required onchange="toggleOtherField('followUpMetaTypeAudit', 'followUpMetaTypeAuditOther')">
                            <option value="">Select Type</option>
                            <option value="API Security Audit">API Security Audit</option>
                            <option value="Cloud Security Audit">Cloud Security Audit</option>
                            <option value="Compliance to Standard/Framework/Policies Related Audit">Compliance to Standard/Framework/Policies Related Audit</option>
                            <option value="Digital Forensic Readiness Assessment">Digital Forensic Readiness Assessment</option>
                            <option value="Industrial Control Systems (ICS) / SCADA Audit">Industrial Control Systems (ICS) / SCADA Audit</option>
                            <option value="IoT Security Assessment">IoT Security Assessment</option>
                            <option value="Mobile Application Audit">Mobile Application Audit</option>
                            <option value="Network Infrastructure Audits">Network Infrastructure Audits</option>
                            <option value="Process Audit">Process Audit</option>
                            <option value="Red Team Assessment">Red Team Assessment</option>
                            <option value="Source Code Review">Source Code Review</option>
                            <option value="VAPT-Infrastructure" selected>VAPT-Infrastructure</option>
                            <option value="VAPT-Application">VAPT-Application</option>
                            <option value="Website /Web Application Audit">Website /Web Application Audit</option>
                            <option value="Wireless security audit">Wireless security audit</option>
                            <option value="Other">Other (Specify)</option>
                        </select>
                        <input type="text" id="followUpMetaTypeAuditOther" name="typeOfAuditOther" class="form-input" placeholder="Please specify type of audit" style="display: none; margin-top: 10px;">
                    </div>

                    <!-- Details of website/application/infrastructure -->
                    <div class="form-group">
                        <label for="followUpMetaDetails" class="form-label">Details of web site/name of application/no. of servers, perimeter devices, other infrastructure*</label>
                        <textarea id="followUpMetaDetails" name="detailsOfWebsite" class="form-input" placeholder="Enter details" required rows="4" style="width: 100%; resize: vertical;"></textarea>
                    </div>

                    <!-- Reason for conducting Audit -->
                    <div class="form-group">
                        <label for="followUpMetaReason" class="form-label">Reason for conducting Audit*</label>
                        <select id="followUpMetaReason" name="reasonForAudit" class="form-input" required>
                            <option value="">Select Reason</option>
                            <option value="Certificate of compliance like ISO 27001">Certificate of compliance like ISO 27001</option>
                            <option value="Certificate of safe hosting">Certificate of safe hosting</option>
                            <option value="Change in process or infrastructure">Change in process or infrastructure</option>
                            <option value="Government directions">Government directions</option>
                            <option value="Incident/ Breach in Organisation">Incident/ Breach in Organisation</option>
                            <option value="Incident/ Breach in Sector">Incident/ Breach in Sector</option>
                            <option value="New application/ Infrastructure">New application/ Infrastructure</option>
                            <option value="Not Known">Not Known</option>
                            <option value="Periodic Audit as per Policy of organisation.">Periodic Audit as per Policy of organisation.</option>
                            <option value="Regulatory directions" selected>Regulatory directions</option>
                            <option value="Third Party Initiated">Third Party Initiated</option>
                        </select>
                    </div>

                    <!-- Standards Used for conducting Audit -->
                    <div class="form-group">
                        <label for="followUpMetaStandards" class="form-label">Standards Used for conducting Audit*</label>
                        <input type="text" id="followUpMetaStandards" name="standardsUsed" class="form-input" placeholder="Enter standards" required>
                    </div>

                    <!-- Challenges in conducting Audits -->
                    <div class="form-group">
                        <label for="followUpMetaChallenges" class="form-label">Challenges in conducting Audits*</label>
                        <textarea id="followUpMetaChallenges" name="challenges" class="form-input" placeholder="Enter challenges" required rows="4" style="width: 100%; resize: vertical;"></textarea>
                    </div>

                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Compliance Questions</h4>
                    </div>

                    <!-- Compliance questions -->
                    <div class="form-group">
                        <label for="followUpMetaCompFinancial" class="form-label">Compliance to financial sector regulatory bodies guidelines/circulars/directions like from RBI, IRDAI, SEBI, NPCI*</label>
                        <select id="followUpMetaCompFinancial" name="complianceFinancial" class="form-input" required>
                            <option value="">Select</option>
                            <option value="Yes">Yes</option>
                            <option value="No">No</option>
                            <option value="Not applicable">Not applicable</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="followUpMetaCompRegulatory" class="form-label">Compliance to regulatory bodies guidelines/circulars/directions like from UIDAI, CCA, DoT, TRAI*</label>
                        <select id="followUpMetaCompRegulatory" name="complianceRegulatory" class="form-input" required>
                            <option value="">Select</option>
                            <option value="Yes">Yes</option>
                            <option value="No">No</option>
                            <option value="Not applicable">Not applicable</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="followUpMetaCompCertIn" class="form-label">Compliance to CERT-In directions under sub-section (6) of section 70B of the IT Act, 2000 dated 28 April, 2022*</label>
                        <select id="followUpMetaCompCertIn" name="complianceCertIn" class="form-input" required>
                            <option value="">Select</option>
                            <option value="Yes">Yes</option>
                            <option value="No">No</option>
                            <option value="Not applicable">Not applicable</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="followUpMetaCompCEA" class="form-label">Compliance to CEA (Cyber Security in Power Sector) guidelines 2021*</label>
                        <select id="followUpMetaCompCEA" name="complianceCEA" class="form-input" required>
                            <option value="">Select</option>
                            <option value="Yes">Yes</option>
                            <option value="No">No</option>
                            <option value="Not applicable">Not applicable</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="followUpMetaCompOther" class="form-label">Any other domestic regulation, directions, guidelines (Please Specify)*</label>
                        <select id="followUpMetaCompOther" name="complianceOther" class="form-input" required>
                            <option value="">Select</option>
                            <option value="Yes">Yes</option>
                            <option value="No" selected>No</option>
                            <option value="Not applicable">Not applicable</option>
                        </select>
                    </div>

                    <!-- Type of Audit Report -->
                    <div class="form-group">
                        <label for="followUpMetaTypeReport" class="form-label">Type of Audit Report*</label>
                        <select id="followUpMetaTypeReport" name="typeOfAuditReport" class="form-input" required>
                            <option value="">Select Type</option>
                            <option value="First Audit Report">First Audit Report</option>
                            <option value="Follow up Audit Report" selected>Follow up Audit Report</option>
                        </select>
                    </div>

                    <!-- No. of vulnerabilities -->
                    <div class="form-group">
                        <label for="followUpMetaNumVuln" class="form-label">No. of vulnerabilities/ security issues reported during FIRST Audit*</label>
                        <input type="number" id="followUpMetaNumVuln" name="numVulnerabilities" class="form-input" placeholder="Enter number" min="0" required>
                    </div>

                    <!-- No. of days taken to patch -->
                    <div class="form-group">
                        <label for="followUpMetaDaysPatch" class="form-label">No. of days taken by Client to patch the vulnerabilities after submission of Audit report*</label>
                        <select id="followUpMetaDaysPatch" name="numDaysToPatch" class="form-input" required>
                            <option value="">Select</option>
                            <option value="Not Known">Not Known</option>
                            <option value="Follow up audit not performed">Follow up audit not performed</option>
                            <option value="NA">NA</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                            <option value="13">13</option>
                            <option value="14">14</option>
                            <option value="15">15</option>
                            <option value="16">16</option>
                            <option value="17">17</option>
                            <option value="18">18</option>
                            <option value="19">19</option>
                            <option value="20">20</option>
                            <option value="21">21</option>
                            <option value="22">22</option>
                            <option value="23">23</option>
                            <option value="24">24</option>
                            <option value="25">25</option>
                            <option value="26">26</option>
                            <option value="27">27</option>
                            <option value="28">28</option>
                            <option value="29">29</option>
                            <option value="30">30</option>
                            <option value="31">31</option>
                            <option value="32">32</option>
                            <option value="33">33</option>
                            <option value="34">34</option>
                            <option value="35">35</option>
                            <option value="36">36</option>
                            <option value="37">37</option>
                            <option value="38">38</option>
                            <option value="39">39</option>
                            <option value="40">40</option>
                            <option value="41">41</option>
                            <option value="42">42</option>
                            <option value="43">43</option>
                            <option value="44">44</option>
                            <option value="45">45</option>
                            <option value="46">46</option>
                            <option value="47">47</option>
                            <option value="48">48</option>
                            <option value="49">49</option>
                            <option value="50">50</option>
                            <option value="51">51</option>
                            <option value="52">52</option>
                            <option value="53">53</option>
                            <option value="54">54</option>
                            <option value="55">55</option>
                            <option value="56">56</option>
                            <option value="57">57</option>
                            <option value="58">58</option>
                            <option value="59">59</option>
                            <option value="60">60</option>
                            <option value="61">61</option>
                            <option value="62">62</option>
                            <option value="63">63</option>
                            <option value="64">64</option>
                            <option value="65">65</option>
                            <option value="66">66</option>
                            <option value="67">67</option>
                            <option value="68">68</option>
                            <option value="69">69</option>
                            <option value="70">70</option>
                            <option value="71">71</option>
                            <option value="72">72</option>
                            <option value="73">73</option>
                            <option value="74">74</option>
                            <option value="75">75</option>
                            <option value="76">76</option>
                            <option value="77">77</option>
                            <option value="78">78</option>
                            <option value="79">79</option>
                            <option value="80">80</option>
                            <option value="81">81</option>
                            <option value="82">82</option>
                            <option value="83">83</option>
                            <option value="84">84</option>
                            <option value="85">85</option>
                            <option value="86">86</option>
                            <option value="87">87</option>
                            <option value="88">88</option>
                            <option value="89">89</option>
                            <option value="90">90</option>
                            <option value="91">91</option>
                            <option value="92">92</option>
                            <option value="93">93</option>
                            <option value="94">94</option>
                            <option value="95">95</option>
                            <option value="96">96</option>
                            <option value="97">97</option>
                            <option value="98">98</option>
                            <option value="99">99</option>
                            <option value="100">100</option>
                            <option value="More than 100">More than 100</option>
                        </select>
                    </div>

                    <!-- Duration between audits -->
                    <div class="form-group">
                        <label for="followUpMetaDuration" class="form-label">Durations (in days) between end of FIRST audit and start of FOLLOW-UP/SECOND audit*</label>
                        <select id="followUpMetaDuration" name="durationBetweenAudits" class="form-input" required>
                            <option value="">Select</option>
                            <option value="Follow up audit not performed">Follow up audit not performed</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                            <option value="13">13</option>
                            <option value="14">14</option>
                            <option value="15">15</option>
                            <option value="16">16</option>
                            <option value="17">17</option>
                            <option value="18">18</option>
                            <option value="19">19</option>
                            <option value="20">20</option>
                            <option value="21">21</option>
                            <option value="22">22</option>
                            <option value="23">23</option>
                            <option value="24">24</option>
                            <option value="25">25</option>
                            <option value="26">26</option>
                            <option value="27">27</option>
                            <option value="28">28</option>
                            <option value="29">29</option>
                            <option value="30">30</option>
                            <option value="31">31</option>
                            <option value="32">32</option>
                            <option value="33">33</option>
                            <option value="34">34</option>
                            <option value="35">35</option>
                            <option value="36">36</option>
                            <option value="37">37</option>
                            <option value="38">38</option>
                            <option value="39">39</option>
                            <option value="40">40</option>
                            <option value="41">41</option>
                            <option value="42">42</option>
                            <option value="43">43</option>
                            <option value="44">44</option>
                            <option value="45">45</option>
                            <option value="46">46</option>
                            <option value="47">47</option>
                            <option value="48">48</option>
                            <option value="49">49</option>
                            <option value="50">50</option>
                            <option value="51">51</option>
                            <option value="52">52</option>
                            <option value="53">53</option>
                            <option value="54">54</option>
                            <option value="55">55</option>
                            <option value="56">56</option>
                            <option value="57">57</option>
                            <option value="58">58</option>
                            <option value="59">59</option>
                            <option value="60">60</option>
                            <option value="61">61</option>
                            <option value="62">62</option>
                            <option value="63">63</option>
                            <option value="64">64</option>
                            <option value="65">65</option>
                            <option value="66">66</option>
                            <option value="67">67</option>
                            <option value="68">68</option>
                            <option value="69">69</option>
                            <option value="70">70</option>
                            <option value="71">71</option>
                            <option value="72">72</option>
                            <option value="73">73</option>
                            <option value="74">74</option>
                            <option value="75">75</option>
                            <option value="76">76</option>
                            <option value="77">77</option>
                            <option value="78">78</option>
                            <option value="79">79</option>
                            <option value="80">80</option>
                            <option value="81">81</option>
                            <option value="82">82</option>
                            <option value="83">83</option>
                            <option value="84">84</option>
                            <option value="85">85</option>
                            <option value="86">86</option>
                            <option value="87">87</option>
                            <option value="88">88</option>
                            <option value="89">89</option>
                            <option value="90">90</option>
                            <option value="91">91</option>
                            <option value="92">92</option>
                            <option value="93">93</option>
                            <option value="94">94</option>
                            <option value="95">95</option>
                            <option value="96">96</option>
                            <option value="97">97</option>
                            <option value="98">98</option>
                            <option value="99">99</option>
                            <option value="100">100</option>
                            <option value="More than 100">More than 100</option>
                        </select>
                    </div>

                    <!-- No. of open issues -->
                    <div class="form-group">
                        <label for="followUpMetaOpenIssues" class="form-label">No. of open issues after follow-up audits*</label>
                        <select id="followUpMetaOpenIssues" name="numOpenIssues" class="form-input" required>
                            <option value="">Select</option>
                            <option value="Follow up audit not performed">Follow up audit not performed</option>
                            <option value="NA">NA</option>
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                            <option value="13">13</option>
                            <option value="14">14</option>
                            <option value="15">15</option>
                            <option value="16">16</option>
                            <option value="17">17</option>
                            <option value="18">18</option>
                            <option value="19">19</option>
                            <option value="20">20</option>
                            <option value="21">21</option>
                            <option value="22">22</option>
                            <option value="23">23</option>
                            <option value="24">24</option>
                            <option value="25">25</option>
                            <option value="26">26</option>
                            <option value="27">27</option>
                            <option value="28">28</option>
                            <option value="29">29</option>
                            <option value="30">30</option>
                            <option value="31">31</option>
                            <option value="32">32</option>
                            <option value="33">33</option>
                            <option value="34">34</option>
                            <option value="35">35</option>
                            <option value="36">36</option>
                            <option value="37">37</option>
                            <option value="38">38</option>
                            <option value="39">39</option>
                            <option value="40">40</option>
                            <option value="41">41</option>
                            <option value="42">42</option>
                            <option value="43">43</option>
                            <option value="44">44</option>
                            <option value="45">45</option>
                            <option value="46">46</option>
                            <option value="47">47</option>
                            <option value="48">48</option>
                            <option value="49">49</option>
                            <option value="50">50</option>
                            <option value="51">51</option>
                            <option value="52">52</option>
                            <option value="53">53</option>
                            <option value="54">54</option>
                            <option value="55">55</option>
                            <option value="56">56</option>
                            <option value="57">57</option>
                            <option value="58">58</option>
                            <option value="59">59</option>
                            <option value="60">60</option>
                            <option value="61">61</option>
                            <option value="62">62</option>
                            <option value="63">63</option>
                            <option value="64">64</option>
                            <option value="65">65</option>
                            <option value="66">66</option>
                            <option value="67">67</option>
                            <option value="68">68</option>
                            <option value="69">69</option>
                            <option value="70">70</option>
                            <option value="71">71</option>
                            <option value="72">72</option>
                            <option value="73">73</option>
                            <option value="74">74</option>
                            <option value="75">75</option>
                            <option value="76">76</option>
                            <option value="77">77</option>
                            <option value="78">78</option>
                            <option value="79">79</option>
                            <option value="80">80</option>
                            <option value="81">81</option>
                            <option value="82">82</option>
                            <option value="83">83</option>
                            <option value="84">84</option>
                            <option value="85">85</option>
                            <option value="86">86</option>
                            <option value="87">87</option>
                            <option value="88">88</option>
                            <option value="89">89</option>
                            <option value="90">90</option>
                            <option value="91">91</option>
                            <option value="92">92</option>
                            <option value="93">93</option>
                            <option value="94">94</option>
                            <option value="95">95</option>
                            <option value="96">96</option>
                            <option value="97">97</option>
                            <option value="98">98</option>
                            <option value="99">99</option>
                            <option value="100">100</option>
                            <option value="101">101</option>
                            <option value="102">102</option>
                            <option value="103">103</option>
                            <option value="104">104</option>
                            <option value="105">105</option>
                            <option value="106">106</option>
                            <option value="107">107</option>
                            <option value="108">108</option>
                            <option value="109">109</option>
                            <option value="110">110</option>
                            <option value="111">111</option>
                            <option value="112">112</option>
                            <option value="113">113</option>
                            <option value="114">114</option>
                            <option value="115">115</option>
                            <option value="116">116</option>
                            <option value="117">117</option>
                            <option value="118">118</option>
                            <option value="119">119</option>
                            <option value="120">120</option>
                            <option value="121">121</option>
                            <option value="122">122</option>
                            <option value="123">123</option>
                            <option value="124">124</option>
                            <option value="125">125</option>
                            <option value="126">126</option>
                            <option value="127">127</option>
                            <option value="128">128</option>
                            <option value="129">129</option>
                            <option value="130">130</option>
                            <option value="131">131</option>
                            <option value="132">132</option>
                            <option value="133">133</option>
                            <option value="134">134</option>
                            <option value="135">135</option>
                            <option value="136">136</option>
                            <option value="137">137</option>
                            <option value="138">138</option>
                            <option value="139">139</option>
                            <option value="140">140</option>
                            <option value="141">141</option>
                            <option value="142">142</option>
                            <option value="143">143</option>
                            <option value="144">144</option>
                            <option value="145">145</option>
                            <option value="146">146</option>
                            <option value="147">147</option>
                            <option value="148">148</option>
                            <option value="149">149</option>
                            <option value="150">150</option>
                            <option value="151">151</option>
                            <option value="152">152</option>
                            <option value="153">153</option>
                            <option value="154">154</option>
                            <option value="155">155</option>
                            <option value="156">156</option>
                            <option value="157">157</option>
                            <option value="158">158</option>
                            <option value="159">159</option>
                            <option value="160">160</option>
                            <option value="161">161</option>
                            <option value="162">162</option>
                            <option value="163">163</option>
                            <option value="164">164</option>
                            <option value="165">165</option>
                            <option value="166">166</option>
                            <option value="167">167</option>
                            <option value="168">168</option>
                            <option value="169">169</option>
                            <option value="170">170</option>
                            <option value="171">171</option>
                            <option value="172">172</option>
                            <option value="173">173</option>
                            <option value="174">174</option>
                            <option value="175">175</option>
                            <option value="176">176</option>
                            <option value="177">177</option>
                            <option value="178">178</option>
                            <option value="179">179</option>
                            <option value="180">180</option>
                            <option value="More than 180">More than 180</option>
                        </select>
                    </div>

                    <!-- Geographical detail -->
                    <div class="form-group">
                        <label for="followUpMetaGeoState" class="form-label">Geographical detail of Client (State/UT)*</label>
                        <select id="followUpMetaGeoState" name="geographicalState" class="form-input" required>
                            <option value="">Select State/UT</option>
                            <option value="Andhra Pradesh">Andhra Pradesh</option>
                            <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                            <option value="Assam">Assam</option>
                            <option value="Bihar">Bihar</option>
                            <option value="Chhattisgarh">Chhattisgarh</option>
                            <option value="Goa">Goa</option>
                            <option value="Gujarat">Gujarat</option>
                            <option value="Haryana">Haryana</option>
                            <option value="Himachal Pradesh">Himachal Pradesh</option>
                            <option value="Jharkhand">Jharkhand</option>
                            <option value="Karnataka">Karnataka</option>
                            <option value="Kerala">Kerala</option>
                            <option value="Madhya Pradesh">Madhya Pradesh</option>
                            <option value="Maharashtra">Maharashtra</option>
                            <option value="Manipur">Manipur</option>
                            <option value="Meghalaya">Meghalaya</option>
                            <option value="Mizoram">Mizoram</option>
                            <option value="Nagaland">Nagaland</option>
                            <option value="Odisha">Odisha</option>
                            <option value="Punjab">Punjab</option>
                            <option value="Rajasthan">Rajasthan</option>
                            <option value="Sikkim">Sikkim</option>
                            <option value="Tamil Nadu">Tamil Nadu</option>
                            <option value="Telangana">Telangana</option>
                            <option value="Tripura">Tripura</option>
                            <option value="Uttar Pradesh">Uttar Pradesh</option>
                            <option value="Uttarakhand">Uttarakhand</option>
                            <option value="West Bengal">West Bengal</option>

                            <!-- Union Territories -->
                            <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                            <option value="Chandigarh">Chandigarh</option>
                            <option value="Dadra and Nagar Haveli and Daman & Diu">Dadra and Nagar Haveli and Daman & Diu</option>
                            <option value="Delhi">Delhi</option>
                            <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                            <option value="Ladakh">Ladakh</option>
                            <option value="Lakshadweep">Lakshadweep</option>
                            <option value="Puducherry">Puducherry</option>

                        </select>
                    </div>

                    <!-- Date of Audit Completion -->
                    <div class="form-group">
                        <label for="followUpMetaDateCompletion" class="form-label">Date of Audit Completion*</label>
                        <input type="date" id="followUpMetaDateCompletion" name="dateAuditCompletion" class="form-input" required>
                    </div>

                    <!-- Date of last audit -->
                    <div class="form-group">
                        <label for="followUpMetaDateLastAudit" class="form-label">Date of last audit of same infrastructure*</label>
                        <input type="date" id="followUpMetaDateLastAudit" name="dateLastAudit" class="form-input" required>
                    </div>

                    <!-- Vulnerability Status Radio Button -->
                    <div class="form-group">
                        <label class="form-label">Vulnerability Status*</label>
                        <div style="display: flex; gap: 30px; margin-top: 10px;">
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="radio" name="followUpVulnerabilityStatus" value="0" required onchange="toggleFollowUpVulnerabilitySection()">
                                <span>0 Vulnerability</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="radio" name="followUpVulnerabilityStatus" value="has" required onchange="toggleFollowUpVulnerabilitySection()" checked>
                                <span>Has Vulnerability</span>
                            </label>
                        </div>
                    </div>

                    <!-- Vulnerability Details Section -->
                    <div id="followUpVulnerabilitySection" class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                            Audited Infrastructure Details
                            <button type="button" class="submit-btn" onclick="addFollowUpVulnerabilityEntry()" style="float: right; margin-top: -5px;">
                                <i class="fas fa-plus"></i> Add Entry
                            </button>
                        </h4>

                        <div id="followUpVulnerabilityContainer">
                        <!-- First vulnerability entry -->
                        <div class="vulnerability-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                            <div class="form-group">
                                <label class="form-label">Audited infrastructure details*</label>
                                <input type="text" name="vuln_0_infrastructure" class="form-input" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                                <input type="text" name="vuln_0_name" class="form-input" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">CVE/CWE Reference Number*</label>
                                <input type="text" name="vuln_0_cve" class="form-input" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Severity of Issue*</label>
                                <select name="vuln_0_severity" class="form-input" required>
                                    <option value="">Select Severity</option>
                                    <option value="Critical">Critical</option>
                                    <option value="High">High</option>
                                    <option value="Medium">Medium</option>
                                    <option value="Low">Low</option>
                                    <option value="Informational">Informational</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                                <input type="number" name="vuln_0_count" class="form-input" min="0" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Attributing Factor*</label>
                                <select name="vuln_0_factor" class="form-input" required>
                                    <option value="">Select Factor</option>
                                    <option value="Coding Error">Coding Error</option>
                                    <option value="Configuration Error">Configuration Error</option>
                                    <option value="Deployment Error">Deployment Error</option>
                                    <option value="Design Error">Design Error</option>
                                    <option value="Operation Error">Operation Error</option>
                                    <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    </div>

                    <!-- Employee Details Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; margin-top: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">
                            Employee Details
                            <button type="button" class="submit-btn" onclick="addFollowUpEmployeeEntry()" style="float: right; margin-top: -5px;">
                                <i class="fas fa-plus"></i> Add Employee
                            </button>
                        </h4>
                    </div>

                    <div id="followUpEmployeeContainer">
                        <!-- First employee entry -->
                        <div class="employee-entry" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                            <div class="form-group">
                                <label class="form-label">Name of employee*</label>
                                <input type="text" name="emp_0_name" class="form-input" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">E-mail ID*</label>
                                <input type="email" name="emp_0_email" class="form-input" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">CISSP*</label>
                                <div style="display: flex; gap: 20px;">
                                    <label><input type="radio" name="emp_0_cissp" value="Yes" required> Yes</label>
                                    <label><input type="radio" name="emp_0_cissp" value="No" required> No</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">CISA*</label>
                                <div style="display: flex; gap: 20px;">
                                    <label><input type="radio" name="emp_0_cisa" value="Yes" required> Yes</label>
                                    <label><input type="radio" name="emp_0_cisa" value="No" required> No</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">CISM*</label>
                                <div style="display: flex; gap: 20px;">
                                    <label><input type="radio" name="emp_0_cism" value="Yes" required> Yes</label>
                                    <label><input type="radio" name="emp_0_cism" value="No" required> No</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ISO*</label>
                                <div style="display: flex; gap: 20px;">
                                    <label><input type="radio" name="emp_0_iso" value="Yes" required> Yes</label>
                                    <label><input type="radio" name="emp_0_iso" value="No" required> No</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">DISA*</label>
                                <div style="display: flex; gap: 20px;">
                                    <label><input type="radio" name="emp_0_disa" value="Yes" required> Yes</label>
                                    <label><input type="radio" name="emp_0_disa" value="No" required> No</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">OSCP*</label>
                                <div style="display: flex; gap: 20px;">
                                    <label><input type="radio" name="emp_0_oscp" value="Yes" required> Yes</label>
                                    <label><input type="radio" name="emp_0_oscp" value="No" required> No</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">CEH*</label>
                                <div style="display: flex; gap: 20px;">
                                    <label><input type="radio" name="emp_0_ceh" value="Yes" required> Yes</label>
                                    <label><input type="radio" name="emp_0_ceh" value="No" required> No</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Others</label>
                                <input type="text" name="emp_0_others" class="form-input" placeholder="Specify other certifications">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                                <input type="number" name="emp_0_experience" class="form-input" min="0" step="0.5" required>
                            </div>
                        </div>
                    </div>

                    <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('followUpAuditMetaDataModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="followUpAuditMetaDataSubmitBtn">
                            <i class="fas fa-check"></i> Submit
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>



    <!-- Compliance Excel Selection Modal -->
    <div id="complianceExcelModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>Select Compliance Worksheet Type</h3>
                <span class="close-modal" onclick="closeModal('complianceExcelModal')">&times;</span>
            </div>
            <div class="modal-body">
                <div style="display: flex; flex-direction: column; gap: 15px;">
                    <button class="report-option" onclick="closeModal('complianceExcelModal'); openModal('isAuditComplianceModal')">
                        <i class="fas fa-file-excel"></i> IS Audit Compliance Worksheet
                    </button>
                    <button class="report-option" onclick="closeModal('complianceExcelModal'); openModal('infraVAPTComplianceModal')">
                        <i class="fas fa-file-excel"></i> Infrastructure VAPT Compliance Worksheet
                    </button>
                    <button class="report-option" onclick="closeModal('complianceExcelModal'); openModal('websiteVAPTComplianceModal')">
                        <i class="fas fa-file-excel"></i> Website VAPT Compliance Worksheet
                    </button>
                    <button class="report-option" onclick="closeModal('complianceExcelModal'); openModal('publicIPVAPTComplianceModal')">
                        <i class="fas fa-file-excel"></i> Public IP VAPT Compliance Worksheet
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- IS Audit Compliance Worksheet Modal -->
    <div id="isAuditComplianceModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>IS Audit Compliance Worksheet</h3>
                <span class="close-modal" onclick="closeModal('isAuditComplianceModal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="isAuditComplianceForm" method="POST" enctype="multipart/form-data" onsubmit="handleIsAuditComplianceSubmit(event)">
                    
                    <!-- Organization Name -->
                    <div class="form-group">
                        <label for="isAuditOrgName" class="form-label">Organization Name*</label>
                        <select id="isAuditOrgName" name="organizationName" class="form-input" required onchange="toggleOtherField('isAuditOrgName', 'isAuditOrgNameOther')">
                            <option value="">Select Organization</option>
                            <option value="The Gayatri Co-operative Bank Limited">The Gayatri Co-operative Bank Limited</option>
                            <option value="The Pochampally Co-operative Urban Bank Limited">The Pochampally Co-operative Urban Bank Limited</option>
                            <option value="The Sudha Co-operative Urban Bank Limited">The Sudha Co-operative Urban Bank Limited</option>
                            <option value="Megasoft Limited">Megasoft Limited</option>
                            <option value="Infrasoft Technologies Limited">Infrasoft Technologies Limited</option>
                            <option value="The Baroda District Co-operative Bank Limited">The Baroda District Co-operative Bank Limited</option>
                            <option value="The Kalupur Nagrik Sahakari Bank Limited">The Kalupur Nagrik Sahakari Bank Limited</option>
                            <option value="The Udaipur Urban Co-operative Bank Limited">The Udaipur Urban Co-operative Bank Limited</option>
                            <option value="The Citizens Co-operative Bank Limited">The Citizens Co-operative Bank Limited</option>
                            <option value="The Rajkot Commercial Co-operative Bank Limited">The Rajkot Commercial Co-operative Bank Limited</option>
                            <option value="The Jamnagar District Co-operative Bank Limited">The Jamnagar District Co-operative Bank Limited</option>
                            <option value="The Shree Parshwanath Co-operative Bank Limited">The Shree Parshwanath Co-operative Bank Limited</option>
                            <option value="The Janata Co-operative Bank Limited">The Janata Co-operative Bank Limited</option>
                            <option value="The Bhuj Mercantile Co-operative Bank Limited">The Bhuj Mercantile Co-operative Bank Limited</option>
                            <option value="The Surat District Co-operative Bank Limited">The Surat District Co-operative Bank Limited</option>
                            <option value="The Sutex Co-operative Bank Limited">The Sutex Co-operative Bank Limited</option>
                            <option value="The Bharuch District Co-operative Bank Limited">The Bharuch District Co-operative Bank Limited</option>
                            <option value="The Panchmahal District Co-operative Bank Limited">The Panchmahal District Co-operative Bank Limited</option>
                            <option value="The Kaira District Co-operative Bank Limited">The Kaira District Co-operative Bank Limited</option>
                            <option value="The Gujarat State Co-operative Bank Limited">The Gujarat State Co-operative Bank Limited</option>
                            <option value="The Ahmedabad District Co-operative Bank Limited">The Ahmedabad District Co-operative Bank Limited</option>
                            <option value="The Adarsh Co-operative Bank Limited">The Adarsh Co-operative Bank Limited</option>
                            <option value="The Sabarkantha District Co-operative Bank Limited">The Sabarkantha District Co-operative Bank Limited</option>
                            <option value="The Kutch District Co-operative Bank Limited">The Kutch District Co-operative Bank Limited</option>
                            <option value="The Surendranagar District Co-operative Bank Limited">The Surendranagar District Co-operative Bank Limited</option>
                            <option value="The Rajkot District Co-operative Bank Limited">The Rajkot District Co-operative Bank Limited</option>
                            <option value="The Rajkot Nagrik Sahakari Bank Limited">The Rajkot Nagrik Sahakari Bank Limited</option>
                            <option value="The Kodinar Taluka Co-operative Bank Limited">The Kodinar Taluka Co-operative Bank Limited</option>
                            <option value="The Amreli District Co-operative Bank Limited">The Amreli District Co-operative Bank Limited</option>
                            <option value="The Junagadh District Co-operative Bank Limited">The Junagadh District Co-operative Bank Limited</option>
                            <option value="Uttar Pradesh Co-operative Bank Limited">Uttar Pradesh Co-operative Bank Limited</option>
                            <option value="The Mirzapur District Co-operative Bank Limited">The Mirzapur District Co-operative Bank Limited</option>
                            <option value="The Varanasi District Co-operative Bank Limited">The Varanasi District Co-operative Bank Limited</option>
                            <option value="The Ghazipur District Co-operative Bank Limited">The Ghazipur District Co-operative Bank Limited</option>
                            <option value="The Sitapur District Co-operative Bank Limited">The Sitapur District Co-operative Bank Limited</option>
                            <option value="The Bhavnagar District Co-operative Bank Limited">The Bhavnagar District Co-operative Bank Limited</option>
                            <option value="The Uttarakhand State Co-operative Bank Limited">The Uttarakhand State Co-operative Bank Limited</option>
                            <option value="The Mahoba District Co-operative Bank Limited">The Mahoba District Co-operative Bank Limited</option>
                            <option value="The Mau Zila Sahakari Bank Limited">The Mau Zila Sahakari Bank Limited</option>
                            <option value="The Sultanpur District Co-operative Bank Limited">The Sultanpur District Co-operative Bank Limited</option>
                            
                            <option value="Other">Other (Specify)</option>
                        </select>
                        <input type="text" id="isAuditOrgNameOther" name="organizationNameOther" class="form-input" placeholder="Specify organization name" style="display: none; margin-top: 10px;">
                    </div>

                    <!-- Report ID -->
                    <div class="form-group">
                        <label for="isAuditReportId" class="form-label">Report ID*</label>
                        <input type="text" id="isAuditReportId" name="reportId" class="form-input" placeholder="Enter Report ID" required>
                    </div>

                    <!-- Report Date -->
                    <div class="form-group">
                        <label for="isAuditReportDate" class="form-label">Report Date*</label>
                        <input type="date" id="isAuditReportDate" name="reportDate" class="form-input" required>
                    </div>

                    <!-- Compliance Date -->
                    <div class="form-group">
                        <label for="isAuditComplianceDate" class="form-label">Compliance Date*</label>
                        <input type="date" id="isAuditComplianceDate" name="complianceDate" class="form-input" required>
                    </div>

                    <!-- Excel File 1 (Source Data) -->
                    <div class="form-group">
                        <label for="isAuditExcelFile1" class="form-label">Asset Review Non-Compliance Excel*</label>
                        <input type="file" id="isAuditExcelFile1" name="excelFile1" class="form-input" accept=".xlsx,.xls" required>
                        <small style="color: #666; display: block; margin-top: 5px;">Upload the Excel file which is for asset review Non-Compliance points.</small>
                    </div>

                    <!-- Excel File 2 (Additional Evidence) -->
                    <div class="form-group">
                        <label for="isAuditExcelFile2" class="form-label">Branch Console Excel File* </label>
                        <input type="file" id="isAuditExcelFile2" name="excelFile2" class="form-input" accept=".xlsx,.xls" required>
                        <small style="color: #666; display: block; margin-top: 5px;">Upload the Excel file Which is for Branch Console.</small>
                    </div>

                    <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('isAuditComplianceModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="isAuditComplianceSubmitBtn">
                            <i class="fas fa-check"></i> Submit
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Infrastructure VAPT Compliance Worksheet Modal -->
    <div id="infraVAPTComplianceModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>Infrastructure VAPT Compliance Worksheet</h3>
                <span class="close-modal" onclick="closeModal('infraVAPTComplianceModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="infraVAPTComplianceForm" enctype="multipart/form-data" onsubmit="handleInfraVAPTComplianceSubmit(event)">
                    <!-- Organization Name -->
                    <div class="form-group">
                        <label for="infraVAPTOrganizationName" class="form-label">Organization Name*</label>
                        <select id="infraVAPTOrganizationName" name="organizationName" class="form-input" required onchange="toggleInfraVAPTOtherOrganization()">
                            <option value="">-- Select Organization --</option>
                            <option value="The Ahmedabad Mercantile Co-Operative Bank Ltd.">The Ahmedabad Mercantile Co-Operative Bank Ltd.</option>
                            <option value="The Abhinav Sahakari Bank Ltd.">The Abhinav Sahakari Bank Ltd.</option>
                            <option value="The Cosmos Co-Operative Bank Ltd.">The Cosmos Co-Operative Bank Ltd.</option>
                            <option value="The Jalgaon Peoples Co-Op. Bank Ltd.">The Jalgaon Peoples Co-Op. Bank Ltd.</option>
                            <option value="Tumkur Grain Merchants Co-Operative Bank Ltd.">Tumkur Grain Merchants Co-Operative Bank Ltd.</option>
                            <option value="Textile Traders Co-Operative Bank Ltd.">Textile Traders Co-Operative Bank Ltd.</option>
                            <option value="The Udaipur Urban Co-Op Bank Ltd.">The Udaipur Urban Co-Op Bank Ltd.</option>
                            <option value="Shree Kadi Nagarik Sahakari Bank Ltd.">Shree Kadi Nagarik Sahakari Bank Ltd.</option>
                            <option value="Other">Other (Specify)</option>
                        </select>
                    </div>

                    <!-- Other Organization Name (Hidden by default) -->
                    <div class="form-group" id="infraVAPTOtherOrganizationGroup" style="display: none;">
                        <label for="infraVAPTOrganizationNameOther" class="form-label">Specify Organization Name*</label>
                        <input type="text" id="infraVAPTOrganizationNameOther" name="organizationNameOther" class="form-input">
                    </div>

                    <!-- Report ID -->
                    <div class="form-group">
                        <label for="infraVAPTReportId" class="form-label">Report ID*</label>
                        <input type="text" id="infraVAPTReportId" name="reportId" class="form-input" required placeholder="Enter Report ID">
                    </div>

                    <!-- Report Date -->
                    <div class="form-group">
                        <label for="infraVAPTReportDate" class="form-label">Report Date*</label>
                        <input type="date" id="infraVAPTReportDate" name="reportDate" class="form-input" required>
                    </div>

                    <!-- Compliance Date -->
                    <div class="form-group">
                        <label for="infraVAPTComplianceDate" class="form-label">Compliance Date*</label>
                        <input type="date" id="infraVAPTComplianceDate" name="complianceDate" class="form-input" required>
                    </div>

                    <!-- Excel File -->
                    <div class="form-group">
                        <label for="infraVAPTExcelFile" class="form-label">Infrastructure VAPT Excel File*</label>
                        <input type="file" id="infraVAPTExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                        <small style="color: #666; display: block; margin-top: 5px;">Upload the Excel file Which is for Infrastructure VAPT.</small>
                    </div>

                    <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('infraVAPTComplianceModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="infraVAPTComplianceSubmitBtn">
                            <i class="fas fa-check"></i> Submit
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Website VAPT Compliance Worksheet Modal -->
    <div id="websiteVAPTComplianceModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>Website VAPT Compliance Worksheet</h3>
                <span class="close-modal" onclick="closeModal('websiteVAPTComplianceModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="websiteVAPTComplianceForm" enctype="multipart/form-data" onsubmit="handleWebsiteVAPTComplianceSubmit(event)">
                    <!-- Organization Name -->
                    <div class="form-group">
                        <label for="websiteVAPTOrganizationName" class="form-label">Organization Name*</label>
                        <select id="websiteVAPTOrganizationName" name="organizationName" class="form-input" required onchange="toggleWebsiteVAPTOtherOrganization()">
                            <option value="">-- Select Organization --</option>
                            <option value="The Ahmedabad Mercantile Co-Operative Bank Ltd.">The Ahmedabad Mercantile Co-Operative Bank Ltd.</option>
                            <option value="The Abhinav Sahakari Bank Ltd.">The Abhinav Sahakari Bank Ltd.</option>
                            <option value="The Cosmos Co-Operative Bank Ltd.">The Cosmos Co-Operative Bank Ltd.</option>
                            <option value="The Jalgaon Peoples Co-Op. Bank Ltd.">The Jalgaon Peoples Co-Op. Bank Ltd.</option>
                            <option value="Tumkur Grain Merchants Co-Operative Bank Ltd.">Tumkur Grain Merchants Co-Operative Bank Ltd.</option>
                            <option value="Textile Traders Co-Operative Bank Ltd.">Textile Traders Co-Operative Bank Ltd.</option>
                            <option value="The Udaipur Urban Co-Op Bank Ltd.">The Udaipur Urban Co-Op Bank Ltd.</option>
                            <option value="Shree Kadi Nagarik Sahakari Bank Ltd.">Shree Kadi Nagarik Sahakari Bank Ltd.</option>
                            <option value="Other">Other (Specify)</option>
                        </select>
                    </div>

                    <!-- Other Organization Name (Hidden by default) -->
                    <div class="form-group" id="websiteVAPTOtherOrganizationGroup" style="display: none;">
                        <label for="websiteVAPTOrganizationNameOther" class="form-label">Specify Organization Name*</label>
                        <input type="text" id="websiteVAPTOrganizationNameOther" name="organizationNameOther" class="form-input">
                    </div>

                    <!-- Report ID -->
                    <div class="form-group">
                        <label for="websiteVAPTReportId" class="form-label">Report ID*</label>
                        <input type="text" id="websiteVAPTReportId" name="reportId" class="form-input" required placeholder="Enter Report ID">
                    </div>

                    <!-- Report Date -->
                    <div class="form-group">
                        <label for="websiteVAPTReportDate" class="form-label">Report Date*</label>
                        <input type="date" id="websiteVAPTReportDate" name="reportDate" class="form-input" required>
                    </div>

                    <!-- Compliance Date -->
                    <div class="form-group">
                        <label for="websiteVAPTComplianceDate" class="form-label">Compliance Date*</label>
                        <input type="date" id="websiteVAPTComplianceDate" name="complianceDate" class="form-input" required>
                    </div>

                    <!-- Excel File -->
                    <div class="form-group">
                        <label for="websiteVAPTExcelFile" class="form-label">Website VAPT Excel File*</label>
                        <input type="file" id="websiteVAPTExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                        <small style="color: #666; display: block; margin-top: 5px;">Upload the Excel file which is for Website VAPT.</small>
                    </div>

                    <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('websiteVAPTComplianceModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="websiteVAPTComplianceSubmitBtn">
                            <i class="fas fa-check"></i> Submit
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Public IP VAPT Compliance Worksheet Modal -->
    <div id="publicIPVAPTComplianceModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>Public IP VAPT Compliance Worksheet</h3>
                <span class="close-modal" onclick="closeModal('publicIPVAPTComplianceModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="publicIPVAPTComplianceForm" enctype="multipart/form-data" onsubmit="handlePublicIPVAPTComplianceSubmit(event)">
                    <!-- Organization Name -->
                    <div class="form-group">
                        <label for="publicIPVAPTOrganizationName" class="form-label">Organization Name*</label>
                        <select id="publicIPVAPTOrganizationName" name="organizationName" class="form-input" required onchange="togglePublicIPVAPTOtherOrganization()">
                            <option value="">-- Select Organization --</option>
                            <option value="The Ahmedabad Mercantile Co-Operative Bank Ltd.">The Ahmedabad Mercantile Co-Operative Bank Ltd.</option>
                            <option value="The Abhinav Sahakari Bank Ltd.">The Abhinav Sahakari Bank Ltd.</option>
                            <option value="The Cosmos Co-Operative Bank Ltd.">The Cosmos Co-Operative Bank Ltd.</option>
                            <option value="The Jalgaon Peoples Co-Op. Bank Ltd.">The Jalgaon Peoples Co-Op. Bank Ltd.</option>
                            <option value="Tumkur Grain Merchants Co-Operative Bank Ltd.">Tumkur Grain Merchants Co-Operative Bank Ltd.</option>
                            <option value="Textile Traders Co-Operative Bank Ltd.">Textile Traders Co-Operative Bank Ltd.</option>
                            <option value="The Udaipur Urban Co-Op Bank Ltd.">The Udaipur Urban Co-Op Bank Ltd.</option>
                            <option value="Shree Kadi Nagarik Sahakari Bank Ltd.">Shree Kadi Nagarik Sahakari Bank Ltd.</option>
                            <option value="Other">Other (Specify)</option>
                        </select>
                    </div>

                    <!-- Other Organization Name (Hidden by default) -->
                    <div class="form-group" id="publicIPVAPTOtherOrganizationGroup" style="display: none;">
                        <label for="publicIPVAPTOrganizationNameOther" class="form-label">Specify Organization Name*</label>
                        <input type="text" id="publicIPVAPTOrganizationNameOther" name="organizationNameOther" class="form-input">
                    </div>

                    <!-- Report ID -->
                    <div class="form-group">
                        <label for="publicIPVAPTReportId" class="form-label">Report ID*</label>
                        <input type="text" id="publicIPVAPTReportId" name="reportId" class="form-input" required placeholder="Enter Report ID">
                    </div>

                    <!-- Report Date -->
                    <div class="form-group">
                        <label for="publicIPVAPTReportDate" class="form-label">Report Date*</label>
                        <input type="date" id="publicIPVAPTReportDate" name="reportDate" class="form-input" required>
                    </div>

                    <!-- Compliance Date -->
                    <div class="form-group">
                        <label for="publicIPVAPTComplianceDate" class="form-label">Compliance Date*</label>
                        <input type="date" id="publicIPVAPTComplianceDate" name="complianceDate" class="form-input" required>
                    </div>

                    <!-- Excel File -->
                    <div class="form-group">
                        <label for="publicIPVAPTExcelFile" class="form-label">Public IP VAPT Excel File*</label>
                        <input type="file" id="publicIPVAPTExcelFile" name="excelFile" class="form-input" accept=".xlsx,.xls" required>
                        <small style="color: #666; display: block; margin-top: 5px;">Upload the Excel file which is for Public IP VAPT data</small>
                    </div>

                    <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('publicIPVAPTComplianceModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="publicIPVAPTComplianceSubmitBtn">
                            <i class="fas fa-check"></i> Submit
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Compliance Certificate Selection Modal -->
    <div id="complianceCertificateModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>Select Compliance Certificate Type</h3>
                <span class="close-modal" onclick="closeModal('complianceCertificateModal')">&times;</span>
            </div>
            <div class="modal-body">
                <div style="display: flex; flex-direction: column; gap: 15px;">
                    <button class="report-option" onclick="closeModal('complianceCertificateModal'); openModal('isAuditComplianceCertModal')">
                        <i class="fas fa-certificate"></i> IS Audit Compliance Certificate
                    </button>
                    <button class="report-option" onclick="closeModal('complianceCertificateModal'); openModal('infraVAPTComplianceCertModal')">
                        <i class="fas fa-certificate"></i> Infrastructure VAPT Compliance Certificate
                    </button>
                    <button class="report-option" onclick="closeModal('complianceCertificateModal'); openModal('websiteVAPTComplianceCertModal')">
                        <i class="fas fa-certificate"></i> Website VAPT Compliance Certificate
                    </button>
                    <button class="report-option" onclick="closeModal('complianceCertificateModal'); openModal('publicIPVAPTComplianceCertModal')">
                        <i class="fas fa-certificate"></i> Public IP VAPT Compliance Certificate
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- IS Audit Compliance Certificate Modal -->
    <div id="isAuditComplianceCertModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>IS Audit Compliance Certificate</h3>
                <span class="close-modal" onclick="closeModal('isAuditComplianceCertModal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="isAuditComplianceCertForm" enctype="multipart/form-data" onsubmit="handleIsAuditComplianceCertSubmit(event)">
                    <!-- Organization Name -->
                    <div class="form-group">
                        <label for="certOrganizationName" class="form-label">Organization Name*</label>
                        <select id="certOrganizationName" name="organizationName" class="form-input" required onchange="toggleCertOtherOrganization()">
                            <option value="">-- Select Organization --</option>
                            <option value="The Ahmedabad Mercantile Co-Operative Bank Ltd.">The Ahmedabad Mercantile Co-Operative Bank Ltd.</option>
                            <option value="The Abhinav Sahakari Bank Ltd.">The Abhinav Sahakari Bank Ltd.</option>
                            <option value="The Cosmos Co-Operative Bank Ltd.">The Cosmos Co-Operative Bank Ltd.</option>
                            <option value="The Jalgaon Peoples Co-Op. Bank Ltd.">The Jalgaon Peoples Co-Op. Bank Ltd.</option>
                            <option value="Tumkur Grain Merchants Co-Operative Bank Ltd.">Tumkur Grain Merchants Co-Operative Bank Ltd.</option>
                            <option value="Textile Traders Co-Operative Bank Ltd.">Textile Traders Co-Operative Bank Ltd.</option>
                            <option value="The Udaipur Urban Co-Op Bank Ltd.">The Udaipur Urban Co-Op Bank Ltd.</option>
                            <option value="Shree Kadi Nagarik Sahakari Bank Ltd.">Shree Kadi Nagarik Sahakari Bank Ltd.</option>
                            <option value="Other">Other (Specify)</option>
                        </select>
                    </div>

                    <!-- Other Organization Name (Hidden by default) -->
                    <div class="form-group" id="certOtherOrganizationGroup" style="display: none;">
                        <label for="certOrganizationNameOther" class="form-label">Specify Organization Name*</label>
                        <input type="text" id="certOrganizationNameOther" name="organizationNameOther" class="form-input">
                    </div>

                    <!-- Address -->
                    <div class="form-group">
                        <label for="certAddress" class="form-label">Address*</label>
                        <textarea id="certAddress" name="address" class="form-input" required rows="3" placeholder="Enter organization address" style="width: 100%;"></textarea>
                    </div>

                    <!-- Designation -->
                    <div class="form-group">
                        <label for="certDesignation" class="form-label">Designation*</label>
                        <input type="text" id="certDesignation" name="designation" class="form-input" required placeholder="Enter designation of the person submitting">
                    </div>

                    <!-- Financial Year -->
                    <div class="form-group">
                        <label for="certFinancialYear" class="form-label">Financial Year*</label>
                        <select id="certFinancialYear" name="financialYear" class="form-input" required onchange="toggleCertOtherFinancialYear()">
                            <option value="">-- Select Financial Year --</option>
                            <option value="2023-24">2023-2024</option>
                            <option value="2024-25">2024-2025</option>
                            <option value="2025-26">2025-2026</option>
                            <option value="2026-27">2026-2027</option>
                            <option value="2027-28">2027-2028</option>
                            <option value="2028-29">2028-2029</option>
                            <option value="2029-30">2029-2030</option>
                            <option value="Other">Other (Specify)</option>
                        </select>
                    </div>

                    <!-- Other Financial Year (Hidden by default) -->
                    <div class="form-group" id="certOtherFinancialYearGroup" style="display: none;">
                        <label for="certFinancialYearOther" class="form-label">Specify Financial Year (YYYY-YY)*</label>
                        <input type="text" id="certFinancialYearOther" name="financialYearOther" class="form-input" placeholder="e.g., 2030-31">
                    </div>

                    <!-- Number of Branches -->
                    <div class="form-group">
                        <label for="certBranchNumber" class="form-label">Number of Branches*</label>
                        <input type="number" id="certBranchNumber" name="branchNumber" class="form-input" required min="0" placeholder="Enter number of branches">
                    </div>

                    <!-- Report ID -->
                    <div class="form-group">
                        <label for="certReportId" class="form-label">Report ID*</label>
                        <input type="text" id="certReportId" name="reportId" class="form-input" required placeholder="Enter Report ID">
                    </div>

                    <!-- Report Date -->
                    <div class="form-group">
                        <label for="certReportDate" class="form-label">Date of the Report*</label>
                        <input type="date" id="certReportDate" name="reportDate" class="form-input" required>
                    </div>

                    <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('isAuditComplianceCertModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="isAuditComplianceCertSubmitBtn">
                            <i class="fas fa-check"></i> Submit
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Infrastructure VAPT Compliance Certificate Modal -->
    <div id="infraVAPTComplianceCertModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>Infrastructure VAPT Compliance Certificate</h3>
                <span class="close-modal" onclick="closeModal('infraVAPTComplianceCertModal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="infraVAPTComplianceCertForm" enctype="multipart/form-data" onsubmit="handleInfraVAPTComplianceCertSubmit(event)">
                    <!-- Same 7 fields as IS Audit -->
                    <div class="form-group">
                        <label for="infraCertOrganizationName" class="form-label">Organization Name*</label>
                        <select id="infraCertOrganizationName" name="organizationName" class="form-input" required onchange="toggleInfraCertOtherOrganization()">
                            <option value="">-- Select Organization --</option>
                            <option value="The Ahmedabad Mercantile Co-Operative Bank Ltd.">The Ahmedabad Mercantile Co-Operative Bank Ltd.</option>
                            <option value="The Abhinav Sahakari Bank Ltd.">The Abhinav Sahakari Bank Ltd.</option>
                            <option value="The Cosmos Co-Operative Bank Ltd.">The Cosmos Co-Operative Bank Ltd.</option>
                            <option value="The Jalgaon Peoples Co-Op. Bank Ltd.">The Jalgaon Peoples Co-Op. Bank Ltd.</option>
                            <option value="Tumkur Grain Merchants Co-Operative Bank Ltd.">Tumkur Grain Merchants Co-Operative Bank Ltd.</option>
                            <option value="Textile Traders Co-Operative Bank Ltd.">Textile Traders Co-Operative Bank Ltd.</option>
                            <option value="The Udaipur Urban Co-Op Bank Ltd.">The Udaipur Urban Co-Op Bank Ltd.</option>
                            <option value="Shree Kadi Nagarik Sahakari Bank Ltd.">Shree Kadi Nagarik Sahakari Bank Ltd.</option>
                            <option value="Other">Other (Specify)</option>
                        </select>
                    </div>
                    <div class="form-group" id="infraCertOtherOrganizationGroup" style="display: none;">
                        <label for="infraCertOrganizationNameOther" class="form-label">Specify Organization Name*</label>
                        <input type="text" id="infraCertOrganizationNameOther" name="organizationNameOther" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="infraCertAddress" class="form-label">Address*</label>
                        <textarea id="infraCertAddress" name="address" class="form-input" required rows="3" style="width: 100%;"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="infraCertDesignation" class="form-label">Designation*</label>
                        <input type="text" id="infraCertDesignation" name="designation" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label for="infraCertFinancialYear" class="form-label">Financial Year*</label>
                        <select id="infraCertFinancialYear" name="financialYear" class="form-input" required onchange="toggleInfraCertOtherFinancialYear()">
                            <option value="">-- Select Financial Year --</option>
                            <option value="2023-24">2023-2024</option>
                            <option value="2024-25">2024-2025</option>
                            <option value="2025-26">2025-2026</option>
                            <option value="2026-27">2026-2027</option>
                            <option value="2027-28">2027-2028</option>
                            <option value="2028-29">2028-2029</option>
                            <option value="2029-30">2029-2030</option>
                            <option value="Other">Other (Specify)</option>
                        </select>
                    </div>
                    <div class="form-group" id="infraCertOtherFinancialYearGroup" style="display: none;">
                        <label for="infraCertFinancialYearOther" class="form-label">Specify Financial Year (YYYY-YY)*</label>
                        <input type="text" id="infraCertFinancialYearOther" name="financialYearOther" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="infraCertBranchNumber" class="form-label">Number of Branches*</label>
                        <input type="number" id="infraCertBranchNumber" name="branchNumber" class="form-input" required min="0">
                    </div>
                    <div class="form-group">
                        <label for="infraCertReportId" class="form-label">Report ID*</label>
                        <input type="text" id="infraCertReportId" name="reportId" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label for="infraCertReportDate" class="form-label">Date of the Report*</label>
                        <input type="date" id="infraCertReportDate" name="reportDate" class="form-input" required>
                    </div>
                    <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('infraVAPTComplianceCertModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="infraVAPTComplianceCertSubmitBtn">
                            <i class="fas fa-check"></i> Submit
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Website VAPT Compliance Certificate Modal -->
    <div id="websiteVAPTComplianceCertModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>Website VAPT Compliance Certificate</h3>
                <span class="close-modal" onclick="closeModal('websiteVAPTComplianceCertModal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="websiteVAPTComplianceCertForm" enctype="multipart/form-data" onsubmit="handleWebsiteVAPTComplianceCertSubmit(event)">
                    <div class="form-group">
                        <label for="webCertOrganizationName" class="form-label">Organization Name*</label>
                        <select id="webCertOrganizationName" name="organizationName" class="form-input" required onchange="toggleWebCertOtherOrganization()">
                            <option value="">-- Select Organization --</option>
                            <option value="The Ahmedabad Mercantile Co-Operative Bank Ltd.">The Ahmedabad Mercantile Co-Operative Bank Ltd.</option>
                            <option value="The Abhinav Sahakari Bank Ltd.">The Abhinav Sahakari Bank Ltd.</option>
                            <option value="The Cosmos Co-Operative Bank Ltd.">The Cosmos Co-Operative Bank Ltd.</option>
                            <option value="The Jalgaon Peoples Co-Op. Bank Ltd.">The Jalgaon Peoples Co-Op. Bank Ltd.</option>
                            <option value="Tumkur Grain Merchants Co-Operative Bank Ltd.">Tumkur Grain Merchants Co-Operative Bank Ltd.</option>
                            <option value="Textile Traders Co-Operative Bank Ltd.">Textile Traders Co-Operative Bank Ltd.</option>
                            <option value="The Udaipur Urban Co-Op Bank Ltd.">The Udaipur Urban Co-Op Bank Ltd.</option>
                            <option value="Shree Kadi Nagarik Sahakari Bank Ltd.">Shree Kadi Nagarik Sahakari Bank Ltd.</option>
                            <option value="Other">Other (Specify)</option>
                        </select>
                    </div>
                    <div class="form-group" id="webCertOtherOrganizationGroup" style="display: none;">
                        <label for="webCertOrganizationNameOther" class="form-label">Specify Organization Name*</label>
                        <input type="text" id="webCertOrganizationNameOther" name="organizationNameOther" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="webCertAddress" class="form-label">Address*</label>
                        <textarea id="webCertAddress" name="address" class="form-input" required rows="3" style="width: 100%;"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="webCertDesignation" class="form-label">Designation*</label>
                        <input type="text" id="webCertDesignation" name="designation" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label for="webCertFinancialYear" class="form-label">Financial Year*</label>
                        <select id="webCertFinancialYear" name="financialYear" class="form-input" required onchange="toggleWebCertOtherFinancialYear()">
                            <option value="">-- Select Financial Year --</option>
                            <option value="2023-24">2023-2024</option>
                            <option value="2024-25">2024-2025</option>
                            <option value="2025-26">2025-2026</option>
                            <option value="2026-27">2026-2027</option>
                            <option value="2027-28">2027-2028</option>
                            <option value="2028-29">2028-2029</option>
                            <option value="2029-30">2029-2030</option>
                            <option value="Other">Other (Specify)</option>
                        </select>
                    </div>
                    <div class="form-group" id="webCertOtherFinancialYearGroup" style="display: none;">
                        <label for="webCertFinancialYearOther" class="form-label">Specify Financial Year (YYYY-YY)*</label>
                        <input type="text" id="webCertFinancialYearOther" name="financialYearOther" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="webCertReportId" class="form-label">Report ID*</label>
                        <input type="text" id="webCertReportId" name="reportId" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label for="webCertReportDate" class="form-label">Date of the Report*</label>
                        <input type="date" id="webCertReportDate" name="reportDate" class="form-input" required>
                    </div>
                    <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('websiteVAPTComplianceCertModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="websiteVAPTComplianceCertSubmitBtn">
                            <i class="fas fa-check"></i> Submit
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Public IP VAPT Compliance Certificate Modal -->
    <div id="publicIPVAPTComplianceCertModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>Public IP VAPT Compliance Certificate</h3>
                <span class="close-modal" onclick="closeModal('publicIPVAPTComplianceCertModal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="publicIPVAPTComplianceCertForm" enctype="multipart/form-data" onsubmit="handlePublicIPVAPTComplianceCertSubmit(event)">
                    <div class="form-group">
                        <label for="pubCertOrganizationName" class="form-label">Organization Name*</label>
                        <select id="pubCertOrganizationName" name="organizationName" class="form-input" required onchange="togglePubCertOtherOrganization()">
                            <option value="">-- Select Organization --</option>
                            <option value="The Ahmedabad Mercantile Co-Operative Bank Ltd.">The Ahmedabad Mercantile Co-Operative Bank Ltd.</option>
                            <option value="The Abhinav Sahakari Bank Ltd.">The Abhinav Sahakari Bank Ltd.</option>
                            <option value="The Cosmos Co-Operative Bank Ltd.">The Cosmos Co-Operative Bank Ltd.</option>
                            <option value="The Jalgaon Peoples Co-Op. Bank Ltd.">The Jalgaon Peoples Co-Op. Bank Ltd.</option>
                            <option value="Tumkur Grain Merchants Co-Operative Bank Ltd.">Tumkur Grain Merchants Co-Operative Bank Ltd.</option>
                            <option value="Textile Traders Co-Operative Bank Ltd.">Textile Traders Co-Operative Bank Ltd.</option>
                            <option value="The Udaipur Urban Co-Op Bank Ltd.">The Udaipur Urban Co-Op Bank Ltd.</option>
                            <option value="Shree Kadi Nagarik Sahakari Bank Ltd.">Shree Kadi Nagarik Sahakari Bank Ltd.</option>
                            <option value="Other">Other (Specify)</option>
                        </select>
                    </div>
                    <div class="form-group" id="pubCertOtherOrganizationGroup" style="display: none;">
                        <label for="pubCertOrganizationNameOther" class="form-label">Specify Organization Name*</label>
                        <input type="text" id="pubCertOrganizationNameOther" name="organizationNameOther" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="pubCertAddress" class="form-label">Address*</label>
                        <textarea id="pubCertAddress" name="address" class="form-input" required rows="3" style="width: 100%;"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="pubCertDesignation" class="form-label">Designation*</label>
                        <input type="text" id="pubCertDesignation" name="designation" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label for="pubCertFinancialYear" class="form-label">Financial Year*</label>
                        <select id="pubCertFinancialYear" name="financialYear" class="form-input" required onchange="togglePubCertOtherFinancialYear()">
                            <option value="">-- Select Financial Year --</option>
                            <option value="2023-24">2023-2024</option>
                            <option value="2024-25">2024-2025</option>
                            <option value="2025-26">2025-2026</option>
                            <option value="2026-27">2026-2027</option>
                            <option value="2027-28">2027-2028</option>
                            <option value="2028-29">2028-2029</option>
                            <option value="2029-30">2029-2030</option>
                            <option value="Other">Other (Specify)</option>
                        </select>
                    </div>
                    <div class="form-group" id="pubCertOtherFinancialYearGroup" style="display: none;">
                        <label for="pubCertFinancialYearOther" class="form-label">Specify Financial Year (YYYY-YY)*</label>
                        <input type="text" id="pubCertFinancialYearOther" name="financialYearOther" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="pubCertReportId" class="form-label">Report ID*</label>
                        <input type="text" id="pubCertReportId" name="reportId" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label for="pubCertReportDate" class="form-label">Date of the Report*</label>
                        <input type="date" id="pubCertReportDate" name="reportDate" class="form-input" required>
                    </div>
                    <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('publicIPVAPTComplianceCertModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="publicIPVAPTComplianceCertSubmitBtn">
                            <i class="fas fa-check"></i> Submit
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Meity Audit Part 1 Modal -->
    <div id="meityAuditPart1Modal" class="modal">
        <div class="modal-content" style="max-width: 1200px;">
            <div class="modal-header">
                <h3>Meity Audit Part 1: Questions 1 to 25</h3>
                <span class="close-modal" onclick="closeModal('meityAuditPart1Modal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="meityAuditPart1Form" method="POST" onsubmit="handleMeityAuditPart1Submit(event)">
                    <!-- Question 1 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">1. Has the bank conducted its audit through a CERT-In empanelled agency?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q1_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q1_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 2 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">2. Does the third-party hosting provider furnish compliance reports regularly?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q2_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q2_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 3 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">3. Are externally hosted data and websites audited by a CERT-In empanelled agency?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q3_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q3_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 4 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">4. Is the Board or top management reviewing the corrective actions taken to resolve audit findings?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q4_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q4_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 5 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">5. Are post-change audits conducted after infrastructure updates?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q5_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q5_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 6 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">6. Is the IT asset inventory maintained and updated regularly?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q6_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q6_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 7 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">7. Are annual vulnerability assessments and penetration tests performed?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q7_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q7_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 8 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">8. Are critical vulnerabilities remediated within timelines defined by CERT-In?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q8_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q8_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 9 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">9. Does the bank enforce quarterly access reviews and implement multi-factor authentication (MFA) for privileged accounts on servers?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q9_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q9_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 10 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">10. Is a documented Incident Response Plan available?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q10_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q10_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 11 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">11. Is annual cybersecurity awareness training conducted for all employees?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q11_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q11_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 12 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">12. Are third-party vendors assessed for cybersecurity compliance?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q12_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q12_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 13 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">13. Is the bank's application (e.g. CBS, CTS) ensuring data encryption both at rest and during transmission, in compliance with CERT-In/MeitY guidelines?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q13_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q13_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 14 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">14. Are core banking systems like CBS and internet banking operating on the same system?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q14_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q14_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 15 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">15. Are email security protocols (SPF, DKIM, DMARC) properly configured?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q15_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q15_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 16 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">16. Are mobile banking applications tested against reverse engineering and injection threats?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q16_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q16_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 17 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">17. Is a SOC team deployed for 24/7 monitoring data center operations?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q17_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q17_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 18 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">18. Are audit findings and actions submitted to NABARD in the prescribed format?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q18_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q18_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 19 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">19. Is Wi-Fi secured using WPA3 and segmented from critical infrastructure?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q19_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q19_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 20 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">20. Are Disaster Recovery (DR) drills conducted at least twice a year for Data Center?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q20_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q20_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 21 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">21. Are all Windows OS versions licensed and updated, or are there outdated versions in use?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q21_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q21_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 22 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">22. Is antivirus protection installed and regularly updated on all systems?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q22_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q22_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 23 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">23. Is dual connectivity implemented?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q23_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q23_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 24 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">24. Are Business Continuity Plan (BCP) and Disaster Recovery Plan (DRP) documented and tested?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q24_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q24_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 25 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">25. Are vendor agreements, such as SLA and NDA, in place and reviewed after any changes are made to them?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q25_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q25_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('meityAuditPart1Modal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="meityAuditPart1FormSubmitBtn">
                            <i class="fas fa-check"></i> Submit
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Meity Audit Part 2 Modal -->
    <div id="meityAuditPart2Modal" class="modal">
        <div class="modal-content" style="max-width: 1200px;">
            <div class="modal-header">
                <h3>Meity Audit Part 2: Questions 26 to 50</h3>
                <span class="close-modal" onclick="closeModal('meityAuditPart2Modal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="meityAuditPart2Form" method="POST" onsubmit="handleMeityAuditPart2Submit(event)">
                    <!-- Question 26 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">26. Is USB port usage restricted and controlled across all endpoints?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q26_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q26_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 27 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">27. Is a Data Loss Prevention (DLP) solution implemented to control unauthorized data transfers?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q27_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q27_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 28 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">28. Is the internal network segmented from the DMZ and external zones?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q28_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q28_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 29 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">29. Is the SIEM solution at the data center capable of detecting insider threats, monitoring fraud, and supporting regulatory compliance?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q29_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q29_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 30 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">30. Is Active Directory regularly reviewed for access controls and hygiene?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q30_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q30_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 31 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">31. Are employees educated on phishing attacks, and does IT conduct awareness activities or simulations?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q31_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q31_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 32 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">32. Is there a mechanism to restrict or block unauthorized software installations within the bank's systems?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q32_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q32_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 33 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">33. Are periodic fire drills conducted?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q33_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q33_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 34 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">34. Are access control lists for the bank's networking devices maintained and reviewed regularly?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q34_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q34_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 35 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">35. Are common or shared user IDs avoided for systems and applications, and is their reviewed periodically?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q35_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q35_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 36 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">36. Is RDP disabled on endpoints, allowed only on approved servers, with access restricted to specific IPs and documented server lists?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q36_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q36_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 37 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">37. Are all servers, Systems and network devices hardened according to approved configuration guidelines or documentation?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q37_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q37_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 38 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">38. Is the Disaster Recovery (DR) site situated in a different seismic zone from the primary data center?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q38_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q38_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 39 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">39. Are the bank's IT, Information Security, VAPT, and Cybersecurity policies established and reviewed on an annual basis?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q39_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q39_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 40 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">40. Are IS Audit and VAPT findings addressed and resolved by the bank within the stipulated time period?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q40_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q40_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 41 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">41. Is a CISO appointed with defined responsibilities, and does the CISO quaterly oversee and review the bank's cybersecurity matters?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q41_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q41_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 42 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">42. Does the bank follow and act upon alerts and advisories issued by regulatory authorities?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q42_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q42_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 43 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">43. Is the infrastructure designed to eliminate single points of failure?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q43_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q43_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 44 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">44. Is IDS/IPS placed in the infrastructure network to detect and prevent unauthorized or malicious activities?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q44_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q44_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 45 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">45. Is there an NTP server configured to synchronize system time across all network devices and servers?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q45_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q45_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 46 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">46. Is there any mechanism in place to detect DDoS and port scanning attacks?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q46_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q46_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 47 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">47. Is multi-factor authentication implemented for all critical assets and applications?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q47_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q47_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 48 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">48. Are all passwords set according to the organization's password policy or security standards?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q48_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q48_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 49 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">49. Are login/Session timeouts for all critical assets and applications set according to organizational policy or security standards?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q49_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q49_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 50 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">50. Is system access limited to authorized users, and are normal users prevented from performing administrative tasks?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q50_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q50_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('meityAuditPart2Modal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="meityAuditPart2FormSubmitBtn">
                            <i class="fas fa-check"></i> Submit
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Meity Audit Part 3 Modal -->
    <div id="meityAuditPart3Modal" class="modal">
        <div class="modal-content" style="max-width: 1200px;">
            <div class="modal-header">
                <h3>Meity Audit Part 3: Questions 51 to 71</h3>
                <span class="close-modal" onclick="closeModal('meityAuditPart3Modal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="meityAuditPart3Form" method="POST" onsubmit="handleMeityAuditPart3Submit(event)">
                    <!-- Question 51 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">51. Are all network devices and systems regularly updated with the latest patches?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q51_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q51_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 52 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">52. Is vendor due diligence conducted by the bank prior to onboarding, and is there a defined process in place for it?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q52_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q52_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 53 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">53. Are critical network devices (e.g., firewalls, routers) in HA mode for redundancy?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q53_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q53_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 54 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">54. Are critical asset consoles restricted to access only from predefined or authorized (whitelisted) systems?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q54_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q54_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 55 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">55. Are records related to logs, change management, permission for restricted access, and other security controls maintained by the bank?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q55_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q55_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 56 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">56. Are logs of critical events and assets stored and maintained for 180 days?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q56_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q56_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 57 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">57. Is an escalation matrix defined for handling cybersecurity events, issues, and policy-related actions or decisions?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q57_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q57_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 58 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">58. Are important documents, guidelines, and awareness materials shared with staff, stakeholders, and vendors, and are meetings conducted to discuss cybersecurity matters?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q58_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q58_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 59 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">59. Are all bank's email accounts protected with two-factor authentication, not shared among multiple users, and is the bank not using public domains?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q59_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q59_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 60 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">60. Is the bank's higher authority periodic reviews cybersecurity-related issues and controls?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q60_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q60_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 61 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">61. Is there a formal process implemented by the bank to revoke employee access to systems and premises upon exit or role change?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q61_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q61_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 62 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">62. Is the bank's organizational setup equipped to oversee IT security operations and handle related concerns effectively?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q62_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q62_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 63 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">63. Is there a process for securely disposing of decommissioned hardware and storage media?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q63_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q63_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 64 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">64. Is an SSL certificate implemented on the bank's website?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q64_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q64_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 65 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">65. Is there an IT Sub-Committee, IT Steering Committee, IT Strategy Committee, and IT Security Committee in the bank that meets periodically and review cyber risks and cybersecurity controls?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q65_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q65_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 66 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">66. Is backup taken and tested on a regular basis, and is there a method to verify the integrity of the backup when it is restored?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q66_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q66_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 67 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">67. Are fire extinguishers, earthing systems, and UPS units tested or refilled regularly?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q67_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q67_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 68 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">68. Are the availability statuses of important network devices and servers being monitored through a defined mechanism?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q68_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q68_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 69 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">69. Are employees aware of the need to report fraudulent transactions and cybersecurity incidents to regulators within the defined time period, and does the bank have a process in place to support this?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q69_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q69_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 70 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">70. In case the bank utilizes APIs, are appropriate security measures such as authentication, encryption, and rate-limiting implemented?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q70_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q70_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <!-- Question 71 -->
                    <div class="form-group">
                        <div class="form-row" style="display: flex; gap: 15px; align-items: center;">
                            <div class="form-col" style="flex: 3;">
                                <label class="form-label">71. Is customer data maintained at the data center in compliance with NABARD's cybersecurity guidelines and secured using adequate controls?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q71_status" class="form-input" required>
                                    <option value="">Select Status</option>
                                    <option value="Fully Complied">Fully Complied</option>
                                    <option value="Partially Complied">Partially Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Not Applicable">Not Applicable</option>
                                </select>
                            </div>
                            <div class="form-col" style="flex: 2;">
                                <input type="text" name="q71_remark" class="form-input" placeholder="Auditor's Remark/Comments" required>
                            </div>
                        </div>
                    </div>

                    <div class="form-actions" style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('meityAuditPart3Modal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="meityAuditPart3FormSubmitBtn">
                            <i class="fas fa-check"></i> Submit
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>



    <!-- VICS Part 1 Modal -->
    <div id="vicsPart1Modal" class="modal">Instead of vulnerability,match not found or impur field pop up 

        <div class="modal-content" style="max-width: 1200px;">
            <div class="modal-header">
                <h3>VICS Part 1: IT Asset Management | Preventing unauthorised software | Environment controls</h3>
                <span class="close-modal" onclick="closeModal('vicsPart1Modal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="vicsPart1Form" action="/process_vics_part1" method="POST" onsubmit="handleVICSPart1Submit(event)">
                    
                    <!-- IT Asset Management Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">IT Asset Management</h4>
                    </div>

                    <!-- Question 1.1 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">1.1 Whether all IT Assets (both hardware and software) have been inventoried?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q1_1" id="q1_1" class="form-input" required onchange="toggleVICSSubQuestions('q1_1', ['q1_1_1_group', 'q1_1_2_group'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 1.1.1 -->
                    <div class="form-group" id="q1_1_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">1.1.1 No. of hardware within bank.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="number" name="q1_1_1" class="form-input" placeholder="Enter number" min="0">
                            </div>
                        </div>
                    </div>

                    <!-- Question 1.1.2 -->
                    <div class="form-group" id="q1_1_2_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">1.1.2 No. of software within bank.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="number" name="q1_1_2" class="form-input" placeholder="Enter number" min="0">
                            </div>
                        </div>
                    </div>

                    <!-- Question 1.2 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">1.2 Whether IT assets have been classified based on their criticality (e.g. High, Medium, Low) & sensitivity based on data availability (e.g. Confidential, Private, Sensitive, Public)?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q1_2" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 1.3 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">1.3 Whether the inventory contains asset/system/application owner contact details?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q1_3" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 1.4 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">1.4 Whether IT asset inventory is updated periodically, at least quarterly and version controlled is maintained?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q1_4" id="q1_4" class="form-input" required onchange="toggleVICSSubQuestions('q1_4', ['q1_4_1_group'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 1.4.1 -->
                    <div class="form-group" id="q1_4_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">1.4.1 Provide last update date.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q1_4_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 1.5 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">1.5 Whether all hardware assets are labelled as per inventory?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q1_5" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Preventing unauthorised software Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px; margin-top: 30px;">Preventing unauthorised software</h4>
                    </div>

                    <!-- Question 2.1 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">2.1 Whether the bank has centralised authorised software inventory/ register for end points?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q2_1" id="q2_1" class="form-input" required onchange="toggleVICSSubQuestions('q2_1', ['q2_1_1_group'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 2.1.1 -->
                    <div class="form-group" id="q2_1_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">2.1.1 Provide No. of approved software.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="number" name="q2_1_1" class="form-input" placeholder="Enter number" min="0">
                            </div>
                        </div>
                    </div>

                    <!-- Question 2.2 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">2.2 Whether list of authorised software is communicated to the staff/ users and sensitized not to install any other software?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q2_2" id="q2_2" class="form-input" required onchange="toggleVICSSubQuestions('q2_2', ['q2_2_1_group'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 2.2.1 -->
                    <div class="form-group" id="q2_2_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">2.2.1 Provide date of last such communication.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q2_2_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 2.3 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">2.3 Whether the bank has mechanism/ control to block installation of unauthorised software?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1.5</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q2_3" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 2.4 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">2.4 Whether bank has mechanism to push system/ user policies (preferably centrally) or by configuring local policies including disabling of JavaScript, ActiveX, restricting macro enabled files if not used?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1.5</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q2_4" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 2.5 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">2.5 Whether the bank has ensured that internet usage is limited to standalone PCs or has put in place technical control if internet is provided to intranet machines (internet connected system must not be used in CBS & related operation)?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 2</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q2_5" id="q2_5" class="form-input" required onchange="toggleVICSPart3SubQuestions('q2_5', ['q2_5_1_group'], ['Implemented', 'Not Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 2.5.1 -->
                    <div class="form-group" id="q2_5_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">2.5.1 Provide No. of intranet connected systems having internet access (with or without technical controls).</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="number" name="q2_5_1" class="form-input" placeholder="Enter number" min="0">
                            </div>
                        </div>
                    </div>

                    <!-- Environment controls Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px; margin-top: 30px;">Environment controls (Includes all premises e.g. HO, DC , DR, Branches etc.)</h4>
                    </div>

                    <!-- Question 3.1 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">3.1 Whether Fire alarms installed and tested periodically?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q3_1" id="q3_1" class="form-input" required onchange="toggleVICSSubQuestions('q3_1', ['q3_1_1_group'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 3.1.1 -->
                    <div class="form-group" id="q3_1_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">3.1.1 Provide date of last testing conducted at HO/DC/DR only.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q3_1_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 3.2 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">3.2 Whether electric testing including earthing is being conducted periodically?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q3_2" id="q3_2" class="form-input" required onchange="toggleVICSSubQuestions('q3_2', ['q3_2_1_group'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 3.2.1 -->
                    <div class="form-group" id="q3_2_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">3.2.1 Provide date of last testing conducted at HO/DC/DR only</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q3_2_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 3.3 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">3.3 Whether Fire extinguisher(s) is/are maintained and refilled according to its life cycle?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q3_3" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 3.4 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">3.4 Whether CCTV cameras are installed at appropriate locations with proper lighting conditions and its recording are being kept for the identified period?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q3_4" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 3.5 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">3.5 Whether periodic fire drill is conducted?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q3_5" id="q3_5" class="form-input" required onchange="toggleVICSSubQuestions('q3_5', ['q3_5_1_group'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 3.5.1 -->
                    <div class="form-group" id="q3_5_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">3.5.1 Provide date of last testing conducted at HO/DC/DR only.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q3_5_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeModal('vicsPart1Modal')">Cancel</button>
                        <button type="submit" class="submit-btn" id="vicsPart1SubmitBtn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- VICS Part 2 Modal -->
    <div id="vicsPart2Modal" class="modal">
        <div class="modal-content" style="max-width: 1200px;">
            <div class="modal-header">
                <h3>VICS Part 2: Network management | Antivirus and patch management | Access Control</h3>
                <span class="close-modal" onclick="closeModal('vicsPart2Modal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="vicsPart2Form" action="/process_vics_part2" method="POST" onsubmit="handleVICSPart2Submit(event)">
                    
                    <!-- Network management Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Network management</h4>
                    </div>

                    <!-- Question 4.1 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">4.1 Whether network devices updated regularly as soon as patch (stable) is released by Original equipment manufacturer (OEM)?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1.5</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q4_1" id="q4_1" class="form-input" required onchange="toggleVICSSubQuestions('q4_1', ['q4_1_1_group'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 4.1.1 -->
                    <div class="form-group" id="q4_1_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">4.1.1 Provide date of last such update.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q4_1_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 4.2 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">4.2 Whether rules (Access Control List) are being configured in firewall/router/switches only after approval from competent authority?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q4_2" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 4.3 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">4.3 Whether access control Lists of any networking devices (Firewall, Router, Wi-Fi device, Proxy etc.) are being reviewed periodically?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1.5</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q4_3" id="q4_3" class="form-input" required onchange="toggleVICSSubQuestions('q4_3', ['q4_3_1_group'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 4.3.1 -->
                    <div class="form-group" id="q4_3_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">4.3.1 Provide date of last review.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q4_3_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 4.4 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">4.4 Whether bank ensures, that there is no wireless (wi-fi) facility for systems in bank/branches without prior approval from competent authority?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q4_4" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 4.5 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">4.5 If wireless facility is present, whether bank has placed necessary security mechanism?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q4_5" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 4.6 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">4.6 Whether there are separate network for internet & intranet server and user zone e.g. communication between these vlans/ network are through Access Control List?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 2</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q4_6" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 4.7 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">4.7 Whether bank maintains IT/Network architecture diagram/document approved by the management?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q4_7" id="q4_7" class="form-input" required onchange="toggleVICSSubQuestions('q4_7', ['q4_7_1_group'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 4.7.1 -->
                    <div class="form-group" id="q4_7_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">4.7.1 Provide date of approval.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q4_7_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 4.8 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">4.8 Whether bank ensures that all the network connection from/to outside bank (e.g. internet) is routed through controlled access (e.g. through firewall and other applicable security solution)?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q4_8" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Antivirus and patch management Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px; margin-top: 30px;">Antivirus and patch management</h4>
                    </div>

                    <!-- Question 5.1 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">5.1 Whether Antivirus installed in all Servers/ PCs / endpoints?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q5_1" id="q5_1" class="form-input" required onchange="toggleVICSSubQuestions('q5_1', ['q5_1_1_group'], 'Not Implemented')">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 5.1.1 -->
                    <div class="form-group" id="q5_1_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">5.1.1 Provide total systems (in percentage) not having antivirus.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="number" name="q5_1_1" class="form-input" placeholder="Enter percentage" min="0" max="100" step="0.01">
                            </div>
                        </div>
                    </div>

                    <!-- Question 5.2 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">5.2 Whether Antivirus updated regularly in all Servers/ PCs / endpoints?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q5_2" id="q5_2" class="form-input" required onchange="toggleVICSSubQuestions('q5_2', ['q5_2_1_group'], 'Not Implemented')">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 5.2.1 -->
                    <div class="form-group" id="q5_2_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">5.2.1 Provide total systems (in percentage) not updated within last 7 days.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="number" name="q5_2_1" class="form-input" placeholder="Enter percentage" min="0" max="100" step="0.01">
                            </div>
                        </div>
                    </div>

                    <!-- Question 5.3 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">5.3 Whether patches are regularly updated?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q5_3" id="q5_3" class="form-input" required onchange="toggleVICSSubQuestions('q5_3', ['q5_3_1_group'], 'Not Implemented')">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 5.3.1 -->
                    <div class="form-group" id="q5_3_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">5.3.1 Provide total systems (in percentage) not updated within last 30 days.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="number" name="q5_3_1" class="form-input" placeholder="Enter percentage" min="0" max="100" step="0.01">
                            </div>
                        </div>
                    </div>

                    <!-- Question 5.4 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">5.4 Whether register for patch update is maintained?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 0.5</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q5_4" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 5.5 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">5.5 Whether it is ensured that there is no out of support operating system/database (e.g. windows 7) version being used within the bank.</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q5_5" id="q5_5" class="form-input" required onchange="toggleVICSSubQuestions('q5_5', ['q5_5_1_group'], 'Not Implemented')">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 5.5.1 -->
                    <div class="form-group" id="q5_5_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">5.5.1 Provide No. systems having out of support OS.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="number" name="q5_5_1" class="form-input" placeholder="Enter number" min="0">
                            </div>
                        </div>
                    </div>

                    <!-- Access Control Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px; margin-top: 30px;">Access Control</h4>
                    </div>

                    <!-- Question 6.1 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">6.1 Whether user rights are provided based on minimum access required to perform their duty (least privilege)?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q6_1" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 6.2 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">6.2 Whether bank ensures there is no shared/ generic user ids are being used?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q6_2" id="q6_2" class="form-input" required onchange="toggleVICSSubQuestions('q6_2', ['q6_2_1_group'], 'Not Implemented')">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 6.2.1 -->
                    <div class="form-group" id="q6_2_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">6.2.1 Provide No. of shared/ generic user ids present in the critical servers/applications.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="number" name="q6_2_1" class="form-input" placeholder="Enter number" min="0">
                            </div>
                        </div>
                    </div>

                    <!-- Question 6.3 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">6.3 If shared/ generic user ids are being used, has approval been obtained from competent authority?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q6_3" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 6.4 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">6.4 Whether periodic user access review is conducted for all the critical systems?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q6_4" id="q6_4" class="form-input" required onchange="toggleVICSSubQuestions('q6_4', ['q6_4_1_group'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 6.4.1 -->
                    <div class="form-group" id="q6_4_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">6.4.1 Provide date of last review.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q6_4_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 6.5 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">6.5 Whether Admin rights restricted to end users?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 2</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q6_5" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 6.6 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">6.6 Whether centralised system/process has been implemented to manage and monitor privileged/Super User / administrative access to critical systems?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 2</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q6_6" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 6.7 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">6.7 Whether Remote Desktop Protocol (RDP) disabled on endpoints and limited on the servers?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 2</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q6_7" id="q6_7" class="form-input" required onchange="toggleVICSSubQuestions('q6_7', ['q6_7_1_group'], 'Both')">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 6.7.1 -->
                    <div class="form-group" id="q6_7_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">6.7.1 Provide No. of end points (in percentage) where RDP is enabled.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="number" name="q6_7_1" class="form-input" placeholder="Enter percentage" min="0" max="100" step="0.01">
                            </div>
                        </div>
                    </div>

                    <!-- Question 6.8 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">6.8 Whether access to all intranet resources are restricted over the internet, if allowed it is through virtual private network (VPN) only after approval from CISO or competent authority?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1.5</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q6_8" id="q6_8" class="form-input" required onchange="toggleVICSSubQuestions('q6_8', ['q6_8_1_group'], 'Not Implemented')">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 6.8.1 -->
                    <div class="form-group" id="q6_8_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">6.8.1 Provide No. of intranet systems where access is enabled over the internet without VPN.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="number" name="q6_8_1" class="form-input" placeholder="Enter number" min="0">
                            </div>
                        </div>
                    </div>

                    <!-- Question 6.9 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">6.9 Does the bank have a two factor authentication (2FA) for CBS, CBS linked applications and other critical applications with second factor being dynamic?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 2</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q6_9" id="q6_9" class="form-input" required onchange="toggleVICSSubQuestions('q6_9', ['q6_9_1_group'], 'Not Implemented')">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 6.9.1 -->
                    <div class="form-group" id="q6_9_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">6.9.1 Provide No. of users (in percentage) who are not enabled for 2FA for CBS.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="number" name="q6_9_1" class="form-input" placeholder="Enter percentage" min="0" max="100" step="0.01">
                            </div>
                        </div>
                    </div>

                    <!-- Question 6.10 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">6.10 Whether security review of terminals used to access corporate internet banking applications of sponsor bank or being used for administrative access of servers is being done through a qualified IS auditor?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q6_10" id="q6_10" class="form-input" required onchange="toggleVICSSubQuestions('q6_10', ['q6_10_1_group'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 6.10.1 -->
                    <div class="form-group" id="q6_10_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">6.10.1 Provide date of last review.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q6_10_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeModal('vicsPart2Modal')">Cancel</button>
                        <button type="submit" class="submit-btn" id="vicsPart2SubmitBtn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- VICS Part 3 Modal -->
    <div id="vicsPart3Modal" class="modal">
        <div class="modal-content" style="max-width: 1200px;">
            <div class="modal-header">
                <h3>VICS Part 3: Removable Media | Secure Configuration and Backup Management | Cyber Security Framework Compliance</h3>
                <span class="close-modal" onclick="closeModal('vicsPart3Modal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="vicsPart3Form" action="/process_vics_part3" method="POST" onsubmit="handleVICSPart3Submit(event)">
                    
                    <!-- Removable Media Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Removable Media</h4>
                    </div>

                    <!-- Question 7.1 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">7.1 Whether removable media disallowed in all endpoints and servers?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q7_1" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 7.2 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">7.2 Whether access of removable media is allowed for a specific period and only after approval from authority?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q7_2" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 7.3 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">7.3 Whether register for systems, having access to Removable media is maintained?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q7_3" id="q7_3" class="form-input" required onchange="toggleVICSPart3SubQuestions('q7_3', ['q7_3_1_group'], ['Implemented', 'Not Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 7.3.1 -->
                    <div class="form-group" id="q7_3_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">7.3.1 Provide No. of systems (in percentage) where USB is allowed.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="number" name="q7_3_1" class="form-input" placeholder="Enter percentage" min="0" max="100" step="0.01">
                            </div>
                        </div>
                    </div>

                    <!-- Secure Configuration and Backup Management Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Secure Configuration and Backup Management</h4>
                    </div>

                    <!-- Question 8.1 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">8.1 Whether bank maintains secure configuration/ hardening document for servers/network devices/end points etc?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q8_1" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 8.2 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">8.2 Whether all the servers and network devices are hardened as per document?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q8_2" id="q8_2" class="form-input" required onchange="toggleVICSPart3SubQuestions('q8_2', ['q8_2_1_group'], ['Not Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 8.2.1 -->
                    <div class="form-group" id="q8_2_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">8.2.1 Provide No. of systems (in percentage) which are hardened as per document.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="number" name="q8_2_1" class="form-input" placeholder="Enter percentage" min="0" max="100" step="0.01">
                            </div>
                        </div>
                    </div>

                    <!-- Question 8.3 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">8.3 Whether configuration review of the critical systems is conducted periodically minimum annually?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q8_3" id="q8_3" class="form-input" required onchange="toggleVICSPart3SubQuestions('q8_3', ['q8_3_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 8.3.1 -->
                    <div class="form-group" id="q8_3_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">8.3.1 Provide last review date.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q8_3_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 8.4 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">8.4 Whether security policies (including password management) are managed and enforced on all the endpoints?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q8_4" id="q8_4" class="form-input" required onchange="toggleVICSPart3SubQuestions('q8_4', ['q8_4_1_group'], ['Not Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 8.4.1 -->
                    <div class="form-group" id="q8_4_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">8.4.1 Provide no. of systems, where policy is not enforced.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="number" name="q8_4_1" class="form-input" placeholder="Enter number of systems" min="0" step="1">
                            </div>
                        </div>
                    </div>

                    <!-- Question 8.5 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">8.5 Whether Bank has Backup and Restoration Policy?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q8_5" id="q8_5" class="form-input" required onchange="toggleVICSPart3SubQuestions('q8_5', ['q8_5_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 8.5.1 -->
                    <div class="form-group" id="q8_5_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">8.5.1 Provide date of approval.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q8_5_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 8.6 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">8.6 Whether periodic backup is being taken and safe storage of important data is being ensured as per policy?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q8_6" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 8.7 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">8.7 Whether backup restoration of critical system is tested periodically?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q8_7" id="q8_7" class="form-input" required onchange="toggleVICSPart3SubQuestions('q8_7', ['q8_7_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 8.7.1 -->
                    <div class="form-group" id="q8_7_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">8.7.1 Provide date of last restoration.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q8_7_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 8.8 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">8.8 Whether bank has centralized logging mechanism to store logs of all the critical systems?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q8_8" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 8.9 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">8.9 Whether Disaster Recovery site is located in different seismic zones?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q8_9" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Cyber Security Framework Compliance Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Cyber Security Framework Compliance</h4>
                    </div>

                    <!-- Question 9.1 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">9.1 Whether Gap analysis of Cyber Security Framework (Availability vs. Requirement) has been carried out?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q9_1" id="q9_1" class="form-input" required onchange="toggleVICSPart3SubQuestions('q9_1', ['q9_1_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 9.1.1 -->
                    <div class="form-group" id="q9_1_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">9.1.1 Provide date of gap analysis.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q9_1_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 9.2 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">9.2 Whether detailed plan for compliance of cyber security framework is submitted and regularly reviewed by the top management?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 2</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q9_2" id="q9_2" class="form-input" required onchange="toggleVICSPart3SubQuestions('q9_2', ['q9_2_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 9.2.1 -->
                    <div class="form-group" id="q9_2_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">9.2.1 Provide date of last compliance review of cyber security framework by top management.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q9_2_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeModal('vicsPart3Modal')">Cancel</button>
                        <button type="submit" class="submit-btn" id="vicsPart3SubmitBtn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- VICS Part 4 Modal -->
    <div id="vicsPart4Modal" class="modal">
        <div class="modal-content" style="max-width: 1200px;">
            <div class="modal-header">
                <h3>VICS Part 4: Threat Intelligence and VAPT Management | Secure mail and messaging | Awareness / trainings on Cyber Security</h3>
                <span class="close-modal" onclick="closeModal('vicsPart4Modal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="vicsPart4Form" action="/process_vics_part4" method="POST" onsubmit="handleVICSPart4Submit(event)">
                    
                    <!-- Threat Intelligence and VAPT Management Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Threat Intelligence and VAPT Management</h4>
                    </div>

                    <!-- Question 10.1 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">10.1 Whether Bank has Board approved Vulnerability Assessment and Penetration Testing (VAPT) policy?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q10_1" id="q10_1" class="form-input" required onchange="toggleVICSPart3SubQuestions('q10_1', ['q10_1_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 10.1.1 -->
                    <div class="form-group" id="q10_1_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">10.1.1 Provide date of approval.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q10_1_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 10.2 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">10.2 Whether critical system in intranet and all the servers/ applications /network devices published over internet (DMZ) are tested every six months?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q10_2" id="q10_2" class="form-input" required onchange="toggleVICSPart3SubQuestions('q10_2', ['q10_2_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 10.2.1 -->
                    <div class="form-group" id="q10_2_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">10.2.1 Provide date of last VA testing?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q10_2_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 10.3 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">10.3 Whether bank is closing critical/high VA/PT points immediately after the identification?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q10_3" id="q10_3" class="form-input" required onchange="toggleVICSPart3SubQuestions('q10_3', ['q10_3_1_group'], ['Implemented', 'Not Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 10.3.1 -->
                    <div class="form-group" id="q10_3_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">10.3.1 Provide average time of closure (in Hrs) of critical/ high points.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="number" name="q10_3_1" class="form-input" placeholder="Enter hours" min="0" step="1">
                            </div>
                        </div>
                    </div>

                    <!-- Question 10.4 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">10.4 Whether VA/PT observation and compliance periodically reported to the top management?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q10_4" id="q10_4" class="form-input" required onchange="toggleVICSPart3SubQuestions('q10_4', ['q10_4_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 10.4.1 -->
                    <div class="form-group" id="q10_4_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">10.4.1 Provide date of last review.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q10_4_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 10.5 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">10.5 Whether bank has ensured compliance to all the advisories and alerts sent by NABARD?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q10_5" id="q10_5" class="form-input" required onchange="toggleVICSPart3SubQuestions('q10_5', ['q10_5_1_group'], ['Implemented', 'Not Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 10.5.1 -->
                    <div class="form-group" id="q10_5_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">10.5.1 Provide No. of complied advisories/ alerts in current FY.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="number" name="q10_5_1" class="form-input" placeholder="Enter number" min="0" step="1">
                            </div>
                        </div>
                    </div>

                    <!-- Secure mail and messaging Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Secure mail and messaging</h4>
                    </div>

                    <!-- Question 11.1 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">11.1 Whether bank specific domain email system in place?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q11_1" id="q11_1" class="form-input" required onchange="toggleVICSPart3SubQuestions('q11_1', ['q11_1_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 11.1.1 -->
                    <div class="form-group" id="q11_1_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">11.1.1 Provide domain name.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="text" name="q11_1_1" class="form-input" placeholder="Enter domain name">
                            </div>
                        </div>
                    </div>

                    <!-- Question 11.2 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">11.2 Whether bank ensures no communication from the non-specific domain email ids?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q11_2" id="q11_2" class="form-input" required onchange="toggleVICSPart3SubQuestions('q11_2', ['q11_2_1_group'], ['Not Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 11.2.1 -->
                    <div class="form-group" id="q11_2_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">11.2.1 Provide No. of non-specific domain email ids active within the bank.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="number" name="q11_2_1" class="form-input" placeholder="Enter number" min="0" step="1">
                            </div>
                        </div>
                    </div>

                    <!-- Question 11.3 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">11.3 Whether anti-phishing, anti-malware, anti-spam and DMARC controls enforced with email solution?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q11_3" id="q11_3" class="form-input" required onchange="toggleVICSPart3SubQuestions('q11_3', ['q11_3_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 11.3.1 -->
                    <div class="form-group" id="q11_3_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">11.3.1 Provide date of implementation.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q11_3_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 11.4 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">11.4 Whether comprehensive data loss / leakage prevention strategy to safeguard sensitive/confidential business and customer data / information is part of Cyber Security Policy?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q11_4" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Awareness / trainings on Cyber Security Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Awareness / trainings on Cyber Security</h4>
                    </div>

                    <!-- Question 12.1 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">12.1 Whether awareness programmes conducted for all staff on cyber security?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q12_1" id="q12_1" class="form-input" required onchange="toggleVICSPart3SubQuestions('q12_1', ['q12_1_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 12.1.1 -->
                    <div class="form-group" id="q12_1_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">12.1.1 Provide no. of programme conducted in last half year.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="number" name="q12_1_1" class="form-input" placeholder="Enter number" min="0" step="1">
                            </div>
                        </div>
                    </div>

                    <!-- Question 12.2 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">12.2 Whether any document prepared and distributed among staff on measures to be taken by them on cyber security?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q12_2" id="q12_2" class="form-input" required onchange="toggleVICSPart3SubQuestions('q12_2', ['q12_2_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 12.2.1 -->
                    <div class="form-group" id="q12_2_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">12.2.1 Provide date of last such communication.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q12_2_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 12.3 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">12.3 Whether CEO/ Chairman has attended any training programme on Cyber Security?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q12_3" id="q12_3" class="form-input" required onchange="toggleVICSPart3SubQuestions('q12_3', ['q12_3_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 12.3.1 -->
                    <div class="form-group" id="q12_3_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">12.3.1 Provide date of last such training.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q12_3_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 12.4 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">12.4 Whether Board members/ Administrator of the bank have attended any programme on Cyber Security?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q12_4" id="q12_4" class="form-input" required onchange="toggleVICSPart3SubQuestions('q12_4', ['q12_4_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 12.4.1 -->
                    <div class="form-group" id="q12_4_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">12.4.1 Provide date of last such training.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q12_4_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeModal('vicsPart4Modal')">Cancel</button>
                        <button type="submit" class="submit-btn" id="vicsPart4SubmitBtn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- VICS Part 5 Modal -->
    <div id="vicsPart5Modal" class="modal">
        <div class="modal-content" style="max-width: 1200px;">
            <div class="modal-header">
                <h3>VICS Part 5: Policies and procedures | Governance | Information System Audit | Chief Information Security Officer (CISO)</h3>
                <span class="close-modal" onclick="closeModal('vicsPart5Modal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="vicsPart5Form" action="/process_vics_part5" method="POST" onsubmit="handleVICSPart5Submit(event)">
                    
                    <!-- Policies and procedures Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Policies and procedures</h4>
                    </div>

                    <!-- Question 13.1 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">13.1 Whether Bank has Board approved Information Security (IS) Policy?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 2</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q13_1" id="q13_1" class="form-input" required onchange="toggleVICSPart3SubQuestions('q13_1', ['q13_1_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 13.1.1 -->
                    <div class="form-group" id="q13_1_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">13.1.1 Provide date of approval.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q13_1_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 13.2 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">13.2 Whether Board approved IS policy distinct from IT policy is available?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q13_2" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 13.3 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">13.3 Whether Bank has Board approved Cyber Security Policy?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 2</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q13_3" id="q13_3" class="form-input" required onchange="toggleVICSPart3SubQuestions('q13_3', ['q13_3_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 13.3.1 -->
                    <div class="form-group" id="q13_3_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">13.3.1 Provide date of approval.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q13_3_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 13.4 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">13.4 Whether Board approved Cyber Security policy distinct from IS policy is available?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q13_4" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 13.5 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">13.5 Whether Standard Operating Procedures/ guidelines are framed for implementing policies?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q13_5" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 13.6 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">13.6 Whether IT and IS policies are reviewed periodically atleast annually?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q13_6" id="q13_6" class="form-input" required onchange="toggleVICSPart3SubQuestions('q13_6', ['q13_6_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 13.6.1 -->
                    <div class="form-group" id="q13_6_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">13.6.1 Provide date of last review.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q13_6_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 13.7 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">13.7 Whether policies are communicated to all the stake holders including staff?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q13_7" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 13.8 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">13.8 In case of any exception to policy/ process, whether it is approved by CISO and reported to Information Security Committee?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q13_8" id="q13_8" class="form-input" required onchange="toggleVICSPart3SubQuestions('q13_8', ['q13_8_1_group'], ['Implemented', 'Not Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 13.8.1 -->
                    <div class="form-group" id="q13_8_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">13.8.1 Provide total no. of exception.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="number" name="q13_8_1" class="form-input" placeholder="Enter number" min="0" step="1">
                            </div>
                        </div>
                    </div>

                    <!-- Governance Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Governance</h4>
                    </div>

                    <!-- Question 14.1 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">14.1 Whether IT Strategy Committee or IT Sub-Committee of the Board set up?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 2</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q14_1" id="q14_1" class="form-input" required onchange="toggleVICSPart3SubQuestions('q14_1', ['q14_1_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 14.1.1 -->
                    <div class="form-group" id="q14_1_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">14.1.1 Provide no. of technically competent Board members.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="number" name="q14_1_1" class="form-input" placeholder="Enter number" min="0" step="1">
                            </div>
                        </div>
                    </div>

                    <!-- Question 14.2 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">14.2 Whether IT Strategy Committee or IT Sub-Committee of the Board review performance related to IT Security periodically?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q14_2" id="q14_2" class="form-input" required onchange="toggleVICSPart3SubQuestions('q14_2', ['q14_2_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 14.2.1 -->
                    <div class="form-group" id="q14_2_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">14.2.1 Provide date of last review.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q14_2_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 14.3 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">14.3 Whether IT Steering Committee set up?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q14_3" id="q14_3" class="form-input" required onchange="toggleVICSPart3SubQuestions('q14_3', ['q14_3_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 14.3.1 -->
                    <div class="form-group" id="q14_3_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">14.3.1 Provide date of committee formed.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q14_3_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 14.4 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">14.4 Whether IT Steering Committee meets periodically to review IT initiatives and performance?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q14_4" id="q14_4" class="form-input" required onchange="toggleVICSPart3SubQuestions('q14_4', ['q14_4_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 14.4.1 -->
                    <div class="form-group" id="q14_4_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">14.4.1 Provide date of last review.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q14_4_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 14.5 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">14.5 Whether Information Security Committee set up?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 2</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q14_5" id="q14_5" class="form-input" required onchange="toggleVICSPart3SubQuestions('q14_5', ['q14_5_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 14.5.1 -->
                    <div class="form-group" id="q14_5_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">14.5.1 Provide date of committee formed.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q14_5_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 14.6 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">14.6 Whether the Information Security committee meets periodically at least quarterly?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q14_6" id="q14_6" class="form-input" required onchange="toggleVICSPart3SubQuestions('q14_6', ['q14_6_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 14.6.1 -->
                    <div class="form-group" id="q14_6_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">14.6.1 Provide date of last review.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q14_6_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Information System Audit Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Information System Audit</h4>
                    </div>

                    <!-- Question 15.1 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">15.1 Whether IS audit is completed for the due period?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q15_1" id="q15_1" class="form-input" required onchange="toggleVICSPart3SubQuestions('q15_1', ['q15_1_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 15.1.1 -->
                    <div class="form-group" id="q15_1_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">15.1.1 Provide date of last audit.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q15_1_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 15.2 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">15.2 Whether all the observations of last IS audit are closed?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 2</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q15_2" id="q15_2" class="form-input" required onchange="toggleVICSPart3SubQuestions('q15_2', ['q15_2_1_group'], ['Not Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 15.2.1 -->
                    <div class="form-group" id="q15_2_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">15.2.1 Provide total no. of observation (in percentage) still open.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="number" name="q15_2_1" class="form-input" placeholder="Enter percentage" min="0" max="100" step="0.01">
                            </div>
                        </div>
                    </div>

                    <!-- Question 15.3 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">15.3 Whether the Audit Committee of the Board review IS audit findings and its closure status?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1.5</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q15_3" id="q15_3" class="form-input" required onchange="toggleVICSPart3SubQuestions('q15_3', ['q15_3_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 15.3.1 -->
                    <div class="form-group" id="q15_3_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">15.3.1 Provide date of last review.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q15_3_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 15.4 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">15.4 Whether Audit Committee of Board monitors Information security assessment, VAPT and ensure compliance and closure of issues?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1.5</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q15_4" id="q15_4" class="form-input" required onchange="toggleVICSPart3SubQuestions('q15_4', ['q15_4_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 15.4.1 -->
                    <div class="form-group" id="q15_4_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">15.4.1 Provide date of last review.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q15_4_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 15.5 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">15.5 Whether compliance review of Cyber Security Framework is part of IS Audit?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q15_5" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Chief Information Security Officer (CISO) Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Chief Information Security Officer (CISO)</h4>
                    </div>

                    <!-- Question 16.1 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">16.1 Whether the bank has appointed CISO?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 2</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q16_1" id="q16_1" class="form-input" required onchange="toggleVICSPart3SubQuestions('q16_1', ['q16_1_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 16.1.1 -->
                    <div class="form-group" id="q16_1_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">16.1.1 Provide name of the CISO.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="text" name="q16_1_1" class="form-input" placeholder="Enter name">
                            </div>
                        </div>
                    </div>

                    <!-- Question 16.2 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">16.2 Whether is CISO a member of Information Security Committee?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q16_2" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 16.3 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">16.3 Whether CISO is from senior management? [GM or above for RRBs and StCBs & DGM or above for DCCBs]</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q16_3" id="q16_3" class="form-input" required onchange="toggleVICSPart3SubQuestions('q16_3', ['q16_3_1_group'], ['Implemented', 'Not Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 16.3.1 -->
                    <div class="form-group" id="q16_3_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">16.3.1 Provide designation of CISO.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="text" name="q16_3_1" class="form-input" placeholder="Enter designation">
                            </div>
                        </div>
                    </div>

                    <!-- Question 16.4 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">16.4 Whether role of CISO is defined and documented?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q16_4" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeModal('vicsPart5Modal')">Cancel</button>
                        <button type="submit" class="submit-btn" id="vicsPart5SubmitBtn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- VICS Part 6 Modal -->
    <div id="vicsPart6Modal" class="modal">
        <div class="modal-content" style="max-width: 1200px;">
            <div class="modal-header">
                <h3>VICS Part 6: Vendor On-boarding | Oversight and Review of Vendors | Addressing security in SLA | Compliance Adherence | Dependency on Vendor staffs</h3>
                <span class="close-modal" onclick="closeModal('vicsPart6Modal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="vicsPart6Form" action="/process_vics_part6" method="POST" onsubmit="handleVICSPart6Submit(event)">
                    
                    <!-- Vendor On-boarding Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Vendor On-boarding</h4>
                    </div>

                    <!-- Question 17.1 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">17.1 Whether bank has outsourcing/ vendor management policy?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q17_1" id="q17_1" class="form-input" required onchange="toggleVICSPart3SubQuestions('q17_1', ['q17_1_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 17.1.1 -->
                    <div class="form-group" id="q17_1_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">17.1.1 Provide date of approval.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q17_1_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 17.2 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">17.2 Whether a list of third party IT vendors is maintained?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q17_2" id="q17_2" class="form-input" required onchange="toggleVICSPart3SubQuestions('q17_2', ['q17_2_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 17.2.1 -->
                    <div class="form-group" id="q17_2_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">17.2.1 Provide no. of vendors.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="number" name="q17_2_1" class="form-input" placeholder="Enter number" min="0" step="1">
                            </div>
                        </div>
                    </div>

                    <!-- Question 17.3 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">17.3 Whether there is a provision to review or update Service Level Agreements with vendor(s), whenever required?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q17_3" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 17.4 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">17.4 Whether bank does the due diligence of vendor before on-boarding?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q17_4" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 17.5 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">17.5 Whether contracts/ SLA have been signed between the bank and all the vendors?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 2</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q17_5" id="q17_5" class="form-input" required onchange="toggleVICSPart3SubQuestions('q17_5', ['q17_5_1_group'], ['Not Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 17.5.1 -->
                    <div class="form-group" id="q17_5_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">17.5.1 Provide no. of vendors SLA/contracts have not made with?</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="number" name="q17_5_1" class="form-input" placeholder="Enter number" min="0" step="1">
                            </div>
                        </div>
                    </div>

                    <!-- Question 17.6 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">17.6 Whether the guidelines on sharing of Information Technology resources issued by RBI vide circular RBI/2013-14/216 dated 30 August 2013 are being followed?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 2</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q17_6" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Oversight and Review of Vendors Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Oversight and Review of Vendors</h4>
                    </div>

                    <!-- Question 18.1 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">18.1 Whether regular meetings are taking place between vendors and bank to discuss cyber security related issues and developments?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1.5</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q18_1" id="q18_1" class="form-input" required onchange="toggleVICSPart3SubQuestions('q18_1', ['q18_1_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 18.1.1 -->
                    <div class="form-group" id="q18_1_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">18.1.1 Provide date of last such meeting.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q18_1_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 18.2 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">18.2 Whether bank reviews cyber security compliance (including action on advisory and alerts) from the vendor periodically?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 2</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q18_2" id="q18_2" class="form-input" required onchange="toggleVICSPart3SubQuestions('q18_2', ['q18_2_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 18.2.1 -->
                    <div class="form-group" id="q18_2_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">18.2.1 Provide date of last review.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q18_2_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Addressing security in SLA Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Addressing security in SLA</h4>
                    </div>

                    <!-- Question 19.1 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">19.1 Whether SLA has provisions for updating latest security requirements?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 2</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q19_1" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 19.2 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">19.2 Whether (Non Disclosure Agreement) NDA is signed with vendor as part of SLA or separately?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q19_2" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 19.3 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">19.3 Whether roles and responsibilities for vendor and bank are defined in SLA in case of incident?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1.5</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q19_3" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 19.4 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">19.4 Whether SLA has provision for penalties and legal action on vendor in case of breach of contract?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 2</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q19_4" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 19.5 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">19.5 Whether time-frame has been stipulated for implementing tools/applications/projects and ensuring uptime?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 2</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q19_5" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 19.6 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">19.6 Do the outsourcing agreements include clauses to recognise the right of RBI / NABARD to inspect banks documents, records, transactions, logs processed by the service provider?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 2</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q19_6" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 19.7 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">19.7 Whether there is a clause in SLA with vendors to address Grievances of customers including system/ technology issues?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q19_7" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Compliance Adherence Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Compliance Adherence with legal and regulatory compliances</h4>
                    </div>

                    <!-- Question 20.1 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">20.1 Whether clause related to ensure regulatory compliances by the vendors are included in SLA?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q20_1" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 20.2 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">20.2 Whether the right to audit by the bank or by its authorized auditor has been included in the SLA?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 2</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q20_2" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 20.3 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">20.3 Whether the SLA was checked by legal department or law officer for compliance?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q20_3" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Dependency on Vendor staffs Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Dependency on Vendor staffs</h4>
                    </div>

                    <!-- Question 21.1 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">21.1 Whether system access for doing financial transaction is restricted to bank officials only?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 2</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q21_1" id="q21_1" class="form-input" required onchange="toggleVICSPart3SubQuestions('q21_1', ['q21_1_1_group'], ['Not Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 21.1.1 -->
                    <div class="form-group" id="q21_1_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">21.1.1 Provide no. of vendor staff having access to do financial transactions.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="number" name="q21_1_1" class="form-input" placeholder="Enter number" min="0" step="1">
                            </div>
                        </div>
                    </div>

                    <!-- Question 21.2 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">21.2 Whether provision for providing support for smooth transition/migration / upgradation from one system to another without hampering business continuity is included in SLA?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q21_2" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeModal('vicsPart6Modal')">Cancel</button>
                        <button type="submit" class="submit-btn" id="vicsPart6SubmitBtn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- VICS Part 7 Modal -->
    <div id="vicsPart7Modal" class="modal">
        <div class="modal-content" style="max-width: 1200px;">
            <div class="modal-header">
                <h3>VICS Part 7: Cyber Crisis/ Incident Management | Detection and Response to cyber incidents | Corrective actions, Collection of evidence and Reporting</h3>
                <span class="close-modal" onclick="closeModal('vicsPart7Modal')">&times;</span>
            </div>
            <div class="modal-body scrollable-content">
                <form id="vicsPart7Form" action="/process_vics_part7" method="POST" onsubmit="handleVICSPart7Submit(event)">
                    
                    <!-- Cyber Crisis/ Incident Management Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Cyber Crisis/ Incident Management</h4>
                    </div>

                    <!-- Question 22.1 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">22.1 Whether bank has Board approved CCMP?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 2</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q22_1" id="q22_1" class="form-input" required onchange="toggleVICSPart3SubQuestions('q22_1', ['q22_1_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 22.1.1 -->
                    <div class="form-group" id="q22_1_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">22.1.1 Provide date of approval.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q22_1_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 22.2 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">22.2 Whether the CCMP is in line with National Cyber Crisis Management Plan and Cyber Security Assessment Framework, framed by CERT-In, GOI?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q22_2" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 22.3 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">22.3 Whether CCMP updated whenever changes are required based on various internal and external inputs or reviewed atleast annually?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q22_3" id="q22_3" class="form-input" required onchange="toggleVICSPart3SubQuestions('q22_3', ['q22_3_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 22.3.1 -->
                    <div class="form-group" id="q22_3_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">22.3.1 Provide date of last review.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q22_3_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 22.4 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">22.4 Whether roles and responsibilities of staff is defined in CCMP?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1.5</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q22_4" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 22.5 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">22.5 Whether CCMP has been communicated to the relevant stakeholders?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q22_5" id="q22_5" class="form-input" required onchange="toggleVICSPart3SubQuestions('q22_5', ['q22_5_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 22.5.1 -->
                    <div class="form-group" id="q22_5_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">22.5.1 Provide date of last such communication.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q22_5_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Detection and Response to cyber incidents Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Detection and Response to cyber incidents</h4>
                    </div>

                    <!-- Question 23.1 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">23.1 Whether suspicious events/ transactions are being reviewed regularly from cyber security perspective?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1.5</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q23_1" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 23.2 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">23.2 Whether any mechanism/controls/tools has been put in place for detection of breaches / incidents?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 2</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q23_2" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 23.3 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">23.3 Whether daily reconciliation of transactions between sponsor and client bank is ensured, if applicable?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q23_3" id="q23_3" class="form-input" required onchange="toggleVICSPart3SubQuestions('q23_3', ['q23_3_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 23.3.1 -->
                    <div class="form-group" id="q23_3_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">23.3.1 Provide date of last review.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q23_3_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Question 23.4 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">23.4 Whether daily review of chargeback claims for digital payment channels (e.g. ATM, UPI, IMPS) are ensured?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q23_4" id="q23_4" class="form-input" required onchange="toggleVICSPart3SubQuestions('q23_4', ['q23_4_1_group'], ['Implemented'])">
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-question 23.4.1 -->
                    <div class="form-group" id="q23_4_1_group" style="display: none;">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2.3;">
                                <label class="form-label">23.4.1 Provide date of last review.</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <input type="date" name="q23_4_1" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Corrective actions, Collection of evidence and Reporting Section -->
                    <div class="form-group">
                        <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #2c3e50; padding-bottom: 10px;">Corrective actions, Collection of evidence and Reporting</h4>
                    </div>

                    <!-- Question 24.1 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">24.1 Whether the bank maintains the source, root cause analysis (RCA) Cyber Incidents?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q24_1" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 24.2 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">24.2 Whether such RCA are placed before the Board for information?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q24_2" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 24.3 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">24.3 Whether actions identified during RCA, are implemented to prevent incidents in future?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q24_3" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Question 24.4 -->
                    <div class="form-group">
                        <div class="form-row">
                            <div class="form-col" style="flex: 2;">
                                <label class="form-label">24.4 Whether core staff is aware that cyber incidents have to be reported to NABARD and CERT-In within 06 hours of detection?</label>
                            </div>
                            <div class="form-col" style="flex: 0.3;">
                                <label class="form-label">Marks: 1</label>
                            </div>
                            <div class="form-col" style="flex: 1;">
                                <select name="q24_4" class="form-input" required>
                                    <option value="">Select</option>
                                    <option value="Implemented">Implemented</option>
                                    <option value="Not Implemented">Not Implemented</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeModal('vicsPart7Modal')">Cancel</button>
                        <button type="submit" class="submit-btn" id="vicsPart7SubmitBtn">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Toggle "Other" input fields
        function toggleOtherField(selectId, otherId) {
            const selectElement = document.getElementById(selectId);
            const otherInput = document.getElementById(otherId);
            
            if (selectElement.value === 'Other') {
                otherInput.style.display = 'block';
                otherInput.required = true;
            } else {
                otherInput.style.display = 'none';
                otherInput.required = false;
                otherInput.value = '';
            }
        }

        // Toggle Antimalware field
        function toggleAntimalwareField(show) {
            const antimalwareInput = document.getElementById('antimalwareName');
            if (show) {
                antimalwareInput.style.display = 'block';
                antimalwareInput.required = true;
            } else {
                antimalwareInput.style.display = 'none';
                antimalwareInput.required = false;
                antimalwareInput.value = '';
            }
        }

        // Toggle PAM field
        function togglePAMField(show) {
            const pamInput = document.getElementById('pamName');
            if (show) {
                pamInput.style.display = 'block';
                pamInput.required = true;
            } else {
                pamInput.style.display = 'none';
                pamInput.required = false;
                pamInput.value = '';
            }
        }

        // Toggle Other Services fields
        function toggleOtherServicesFields(show) {
            const otherServicesGroup = document.getElementById('otherServicesGroup');
            const otherServicesDCGroup = document.getElementById('otherServicesDCGroup');
            const otherServicesDRGroup = document.getElementById('otherServicesDRGroup');
            
            if (show) {
                otherServicesGroup.style.display = 'block';
                otherServicesDCGroup.style.display = 'block';
                otherServicesDRGroup.style.display = 'block';
            } else {
                otherServicesGroup.style.display = 'none';
                otherServicesDCGroup.style.display = 'none';
                otherServicesDRGroup.style.display = 'none';
                // Clear values when hiding
                document.getElementById('otherServices').value = '';
                document.getElementById('otherServicesDC').value = '';
                document.getElementById('otherServicesDCOther').value = '';
                document.getElementById('otherServicesDR').value = '';
                document.getElementById('otherServicesDROther').value = '';
            }
        }

        // Toggle Sub-member Banks field
        function toggleSubmemberBanksField(show) {
            const submemberBanksGroup = document.getElementById('submemberBanksGroup');
            
            if (show) {
                submemberBanksGroup.style.display = 'block';
            } else {
                submemberBanksGroup.style.display = 'none';
                // Clear value when hiding
                document.getElementById('numberOfSubmemberBanks').value = '';
            }
        }

        // Add email field
        function addEmailField() {
            const container = document.getElementById('isAuditEmailContainer');
            if (!container) {
                console.error('Email container not found!');
                return;
            }
            const newField = document.createElement('div');
            newField.style.display = 'flex';
            newField.style.gap = '10px';
            newField.style.marginBottom = '10px';
            newField.innerHTML = `
                <input type="email" name="email[]" class="form-input" placeholder="Enter email address" style="flex: 1;">
                <button type="button" class="cancel-btn" onclick="this.parentElement.remove()" style="flex: 0 0 40px; padding: 8px;">-</button>
            `;
            container.appendChild(newField);
            console.log('Email field added successfully to isAuditEmailContainer');
        }

        // Add application field
        function addApplicationField() {
            const container = document.getElementById('applicationsContainer');
            const newField = document.createElement('div');
            newField.style.display = 'flex';
            newField.style.gap = '10px';
            newField.style.marginBottom = '10px';
            newField.innerHTML = `
                <input type="text" name="applications[]" class="form-input" placeholder="Enter application name" required style="flex: 1;">
                <button type="button" class="cancel-btn" onclick="this.parentElement.remove()" style="flex: 0 0 40px; padding: 8px;">-</button>
            `;
            container.appendChild(newField);
        }

        // Handle IS Audit Word Report form submission
        function handleISAuditWordReportSubmit(event) {
            console.log('IS Audit Word Report form submission started');
            event.preventDefault();
            
            const submitBtn = document.getElementById('isAuditWordReportSubmitBtn');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating Report...';
            submitBtn.disabled = true;
            
            const form = document.getElementById('isAuditWordReportForm');
            const formData = new FormData(form);
            
            console.log('Submitting IS Audit Word Report form...');
            
            fetch('/process_is_audit_word_report', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('IS Audit Word Report response received:', response);
                
                if (response.ok) {
                    const contentType = response.headers.get('content-type');
                    const contentDisposition = response.headers.get('content-disposition');
                    
                    if (contentType && contentType.includes('application/vnd.openxmlformats-officedocument.wordprocessingml.document')) {
                        let filename = 'IS_Audit_Report.docx';
                        if (contentDisposition) {
                            const filenameMatch = contentDisposition.match(/filename="([^"]+)"/);
                            if (filenameMatch) {
                                filename = filenameMatch[1];
                            }
                        }
                        
                        return response.blob().then(blob => {
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.style.display = 'none';
                            a.href = url;
                            a.download = filename;
                            document.body.appendChild(a);
                            a.click();
                            window.URL.revokeObjectURL(url);
                            document.body.removeChild(a);
                            
                            closeModal('isAuditWordReportModal');
                            setTimeout(() => {
                                window.location.reload();
                            }, 1000);
                        });
                    } else {
                        return response.text().then(text => {
                            alert('Unexpected response format');
                        });
                    }
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .catch(error => {
                console.error('IS Audit Word Report Error:', error);
                alert('An error occurred: ' + error.message);
            })
            .finally(() => {
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // Toggle VICS Sub-Questions based on parent answer
        function toggleVICSSubQuestions(parentSelectId, subQuestionGroupIds, showOn = 'Implemented') {
            const parentSelect = document.getElementById(parentSelectId);
            const selectedValue = parentSelect.value;
            
            // Determine if sub-questions should be shown based on the showOn parameter
            let showSubQuestions = false;
            
            if (showOn === 'Implemented') {
                showSubQuestions = selectedValue === "Implemented";
            } else if (showOn === 'Not Implemented') {
                showSubQuestions = selectedValue === "Not Implemented";
            } else if (showOn === 'Both') {
                showSubQuestions = selectedValue === "Implemented" || selectedValue === "Not Implemented";
            }
            
            subQuestionGroupIds.forEach(function(groupId) {
                const groupElement = document.getElementById(groupId);
                if (groupElement) {
                    if (showSubQuestions) {
                        groupElement.style.display = 'block';
                        // Make inputs required when visible
                        const inputs = groupElement.querySelectorAll('input, select, textarea');
                        inputs.forEach(function(input) {
                            input.required = true;
                        });
                    } else {
                        groupElement.style.display = 'none';
                        // Clear the input values and remove required when hiding
                        const inputs = groupElement.querySelectorAll('input, select, textarea');
                        inputs.forEach(function(input) {
                            input.required = false;
                            if (input.type === 'checkbox' || input.type === 'radio') {
                                input.checked = false;
                            } else {
                                input.value = '';
                            }
                        });
                    }
                }
            });
        }

        // VICS Part 1 Form Submission Handler
        function handleVICSPart1Submit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('vicsPart1SubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            // Update button state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            // Create FormData
            const formData = new FormData(document.getElementById('vicsPart1Form'));
            
            // Submit form
            fetch('/process_vics_part1', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    return response.json();
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .then(data => {
                console.log('VICS Part 1 Data:', data);
                
                // Download the Excel file if available
                if (data.download_url) {
                    const link = document.createElement('a');
                    link.href = data.download_url;
                    link.download = data.excel_file;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    // Close modal
                    closeModal('vicsPart1Modal');
                    
                    // Cleanup files after 2 seconds to ensure download has started
                    setTimeout(() => {
                        fetch('/cleanup_vics_files', { method: 'POST' })
                            .then(() => {
                                // Reload page after cleanup
                                location.reload();
                            })
                            .catch(err => {
                                console.error('Cleanup error:', err);
                                // Reload anyway
                                location.reload();
                            });
                    }, 2000);
                }
            })
            .catch(error => {
                console.error('VICS Part 1 Error:', error);
                alert('An error occurred: ' + error.message);
            })
            .finally(() => {
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // VICS Part 2 Form Submission Handler
        function handleVICSPart2Submit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('vicsPart2SubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            // Update button state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            // Create FormData
            const formData = new FormData(document.getElementById('vicsPart2Form'));
            
            // Submit form
            fetch('/process_vics_part2', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    return response.json();
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .then(data => {
                console.log('VICS Part 2 Data:', data);
                
                // Download the Excel file if available
                if (data.download_url) {
                    const link = document.createElement('a');
                    link.href = data.download_url;
                    link.download = data.excel_file;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    // Close modal
                    closeModal('vicsPart2Modal');
                    
                    // Cleanup files after 2 seconds to ensure download has started
                    setTimeout(() => {
                        fetch('/cleanup_vics_files', { method: 'POST' })
                            .then(() => location.reload())
                            .catch(err => {
                                console.error('Cleanup error:', err);
                                location.reload();
                            });
                    }, 2000);
                }
            })
            .catch(error => {
                console.error('VICS Part 2 Error:', error);
                alert('An error occurred: ' + error.message);
            })
            .finally(() => {
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // Toggle sub-questions for VICS Part 3 with conditional display
        function toggleVICSPart3SubQuestions(selectId, subQuestionIds, showForValues) {
            const selectElement = document.getElementById(selectId);
            const selectedValue = selectElement.value;
            
            // Show/hide sub-questions based on selected value
            subQuestionIds.forEach(subQuestionId => {
                const subQuestionElement = document.getElementById(subQuestionId);
                if (subQuestionElement) {
                    if (showForValues.includes(selectedValue)) {
                        subQuestionElement.style.display = 'block';
                        // Make inputs required when visible
                        const inputs = subQuestionElement.querySelectorAll('input, select, textarea');
                        inputs.forEach(input => {
                            input.required = true;
                        });
                    } else {
                        subQuestionElement.style.display = 'none';
                        // Clear input values and remove required when hiding
                        const inputs = subQuestionElement.querySelectorAll('input, select, textarea');
                        inputs.forEach(input => {
                            input.required = false;
                            if (input.type === 'checkbox' || input.type === 'radio') {
                                input.checked = false;
                            } else {
                                input.value = '';
                            }
                        });
                    }
                }
            });
        }

        // Handle VICS Part 3 form submission
        function handleVICSPart3Submit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('vicsPart3SubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            // Update button state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            // Create FormData
            const formData = new FormData(document.getElementById('vicsPart3Form'));
            
            // Submit form
            fetch('/process_vics_part3', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    return response.json();
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .then(data => {
                console.log('VICS Part 3 Data:', data);
                
                // Download the Excel file if available
                if (data.download_url) {
                    const link = document.createElement('a');
                    link.href = data.download_url;
                    link.download = data.excel_file;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    // Close modal
                    closeModal('vicsPart3Modal');
                    
                    // Cleanup files after 2 seconds to ensure download has started
                    setTimeout(() => {
                        fetch('/cleanup_vics_files', { method: 'POST' })
                            .then(() => location.reload())
                            .catch(err => {
                                console.error('Cleanup error:', err);
                                location.reload();
                            });
                    }, 2000);
                }
            })
            .catch(error => {
                console.error('VICS Part 3 Error:', error);
                alert('An error occurred: ' + error.message);
            })
            .finally(() => {
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // Handle VICS Part 4 form submission
        function handleVICSPart4Submit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('vicsPart4SubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            // Update button state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            // Create FormData
            const formData = new FormData(document.getElementById('vicsPart4Form'));
            
            // Submit form
            fetch('/process_vics_part4', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    return response.json();
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .then(data => {
                console.log('VICS Part 4 Data:', data);
                
                // Download the Excel file if available
                if (data.download_url) {
                    const link = document.createElement('a');
                    link.href = data.download_url;
                    link.download = data.excel_file;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    // Close modal
                    closeModal('vicsPart4Modal');
                    
                    // Cleanup files after 2 seconds to ensure download has started
                    setTimeout(() => {
                        fetch('/cleanup_vics_files', { method: 'POST' })
                            .then(() => location.reload())
                            .catch(err => {
                                console.error('Cleanup error:', err);
                                location.reload();
                            });
                    }, 2000);
                }
            })
            .catch(error => {
                console.error('VICS Part 4 Error:', error);
                alert('An error occurred: ' + error.message);
            })
            .finally(() => {
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // Handle VICS Part 5 form submission
        function handleVICSPart5Submit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('vicsPart5SubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            // Update button state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            // Create FormData
            const formData = new FormData(document.getElementById('vicsPart5Form'));
            
            // Submit form
            fetch('/process_vics_part5', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    return response.json();
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .then(data => {
                console.log('VICS Part 5 Data:', data);
                
                // Check if download URL is provided
                if (data.download_url) {
                    // Create a temporary link to trigger download
                    const link = document.createElement('a');
                    link.href = data.download_url;
                    link.download = data.excel_file || 'VICS_Part5.xlsx';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    // Close modal
                    closeModal('vicsPart5Modal');
                    
                    // Cleanup files after 2 seconds to ensure download has started
                    setTimeout(() => {
                        fetch('/cleanup_vics_files', { method: 'POST' })
                            .then(() => location.reload())
                            .catch(err => {
                                console.error('Cleanup error:', err);
                                location.reload();
                            });
                    }, 2000);
                } else {
                    alert('VICS Part 5 data submitted successfully! Check console for details.');
                    closeModal('vicsPart5Modal');
                }
            })
            .catch(error => {
                console.error('VICS Part 5 Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // Handle VICS Part 6 form submission
        function handleVICSPart6Submit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('vicsPart6SubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            // Update button state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            // Create FormData
            const formData = new FormData(document.getElementById('vicsPart6Form'));
            
            // Submit form
            fetch('/process_vics_part6', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    return response.json();
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .then(data => {
                console.log('VICS Part 6 Data:', data);
                
                // Check if download URL is provided
                if (data.download_url) {
                    // Create a temporary link to trigger download
                    const link = document.createElement('a');
                    link.href = data.download_url;
                    link.download = data.excel_file || 'VICS_Part6.xlsx';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    // Close modal
                    closeModal('vicsPart6Modal');
                    
                    // Cleanup files after 2 seconds to ensure download has started
                    setTimeout(() => {
                        fetch('/cleanup_vics_files', { method: 'POST' })
                            .then(() => location.reload())
                            .catch(err => {
                                console.error('Cleanup error:', err);
                                location.reload();
                            });
                    }, 2000);
                } else {
                    alert('VICS Part 6 data submitted successfully! Check console for details.');
                    closeModal('vicsPart6Modal');
                }
            })
            .catch(error => {
                console.error('VICS Part 6 Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // Handle VICS Part 7 form submission
        function handleVICSPart7Submit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('vicsPart7SubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            // Update button state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            // Create FormData
            const formData = new FormData(document.getElementById('vicsPart7Form'));
            
            // Submit form
            fetch('/process_vics_part7', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    return response.json();
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .then(data => {
                console.log('VICS Part 7 Data:', data);
                
                // Check if download URL is provided
                if (data.download_url) {
                    // Create a temporary link to trigger download
                    const link = document.createElement('a');
                    link.href = data.download_url;
                    link.download = data.excel_file || 'VICS_Part7.xlsx';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    // Close modal
                    closeModal('vicsPart7Modal');
                    
                    // Cleanup files after 2 seconds to ensure download has started
                    setTimeout(() => {
                        fetch('/cleanup_vics_files', { method: 'POST' })
                            .then(() => location.reload())
                            .catch(err => {
                                console.error('Cleanup error:', err);
                                location.reload();
                            });
                    }, 2000);
                } else {
                    alert('VICS Part 7 data submitted successfully! Check console for details.');
                    closeModal('vicsPart7Modal');
                }
            })
            .catch(error => {
                console.error('VICS Part 7 Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // Handle Create VICS Worksheet form submission
        document.getElementById('createVICSWorksheetForm').addEventListener('submit', function(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('createVICSWorksheetSubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            // Update button state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            // Create FormData
            const formData = new FormData();
            const vicsPartsZip = document.getElementById('vics_parts_zip').files[0];
            const vicsPartsZip2 = document.getElementById('vics_parts_zip2').files[0];
            
            formData.append('vics_parts_zip', vicsPartsZip);
            formData.append('vics_parts_zip2', vicsPartsZip2);
            
            // Submit form
            fetch('/create_vics_worksheet', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    return response.json();
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .then(data => {
                console.log('Create VICS Worksheet Response:', data);
                
                // Check if download URL is provided
                if (data.download_url) {
                    // Fetch the file as blob to download with custom name
                    fetch(data.download_url)
                        .then(response => response.blob())
                        .then(blob => {
                            // Create blob URL and download with custom filename
                            const blobUrl = window.URL.createObjectURL(blob);
                            const link = document.createElement('a');
                            link.href = blobUrl;
                            link.download = data.excel_file || 'VICS.xlsx';
                            document.body.appendChild(link);
                            link.click();
                            document.body.removeChild(link);
                            
                            // Clean up blob URL
                            window.URL.revokeObjectURL(blobUrl);
                            
                            // Close modal
                            closeModal('createVICSWorksheetModal');
                            
                            // Cleanup files after 2 seconds to ensure download has started
                            setTimeout(() => {
                                fetch('/cleanup_vics_consolidated', { method: 'POST' })
                                    .then(() => location.reload())
                                    .catch(err => {
                                        console.error('Cleanup error:', err);
                                        location.reload();
                                    });
                            }, 2000);
                        })
                        .catch(err => {
                            console.error('Download error:', err);
                            alert('Error downloading file: ' + err.message);
                        });
                } else {
                    alert('VICS Worksheet created successfully!');
                    closeModal('createVICSWorksheetModal');
                    location.reload();
                }
            })
            .catch(error => {
                console.error('Create VICS Worksheet Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        });

        // Handle Create LOC Worksheet form submission
        document.getElementById('createLOCWorksheetForm').addEventListener('submit', function(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('createLOCWorksheetSubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            // Update button state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            // Create FormData
            const formData = new FormData();
            const locPartsZip1 = document.getElementById('loc_parts_zip1').files[0];
            const locPartsZip2 = document.getElementById('loc_parts_zip2').files[0];
            
            formData.append('loc_parts_zip1', locPartsZip1);
            formData.append('loc_parts_zip2', locPartsZip2);
            
            // Submit form
            fetch('/create_loc_worksheet', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    return response.json();
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .then(data => {
                console.log('Create LOC Worksheet Response:', data);
                
                // Check if download URL is provided
                if (data.download_url) {
                    // Fetch the file as blob to download with custom name
                    fetch(data.download_url)
                        .then(response => response.blob())
                        .then(blob => {
                            // Create blob URL and download with custom filename
                            const blobUrl = window.URL.createObjectURL(blob);
                            const link = document.createElement('a');
                            link.href = blobUrl;
                            link.download = data.excel_file || 'LOC.xlsx';
                            document.body.appendChild(link);
                            link.click();
                            document.body.removeChild(link);
                            
                            // Clean up blob URL
                            window.URL.revokeObjectURL(blobUrl);
                            
                            // Close modal
                            closeModal('createLOCWorksheetModal');
                            
                            // Cleanup files after 2 seconds to ensure download has started
                            setTimeout(() => {
                                fetch('/cleanup_loc_consolidated', { method: 'POST' })
                                    .then(() => location.reload())
                                    .catch(err => {
                                        console.error('Cleanup error:', err);
                                        location.reload();
                                    });
                            }, 2000);
                        })
                        .catch(err => {
                            console.error('Download error:', err);
                            alert('Error downloading file: ' + err.message);
                        });
                } else {
                    alert('LOC Worksheet created successfully!');
                    closeModal('createLOCWorksheetModal');
                    location.reload();
                }
            })
            .catch(error => {
                console.error('Create LOC Worksheet Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        });

        // Toggle skip questions for LOC Level 3
        function toggleLOCLevel3SkipQuestions() {
            const q13_A = document.getElementById('q13_A').value;
            const q14_A = document.getElementById('q14_A').value;
            const q19_A = document.getElementById('q19_A').value;
            
            // Handle 13_A skip logic (13_B, 13_C)
            const skip13Groups = ['q13_B_group', 'q13_C_group'];
            skip13Groups.forEach(groupId => {
                const group = document.getElementById(groupId);
                const select = group.querySelector('select');
                if (q13_A === 'No' || q13_A === 'Not Applicable') {
                    group.style.display = 'none';
                    select.value = 'Not Applicable';
                    select.removeAttribute('required');
                } else {
                    group.style.display = 'block';
                    select.setAttribute('required', 'required');
                }
            });
            
            // Handle 14_A skip logic (14_B through 14_K only, not 14_L and 14_M)
            const skip14Groups = ['q14_B_group', 'q14_C_group', 'q14_D_group', 'q14_E_group', 'q14_F_group', 'q14_G_group', 'q14_H_group', 'q14_I_group', 'q14_J_group', 'q14_K_group'];
            skip14Groups.forEach(groupId => {
                const group = document.getElementById(groupId);
                const select = group.querySelector('select');
                if (q14_A === 'No' || q14_A === 'Not Applicable') {
                    group.style.display = 'none';
                    select.value = 'Not Applicable';
                    select.removeAttribute('required');
                } else {
                    group.style.display = 'block';
                    select.setAttribute('required', 'required');
                }
            });
            
            // 19_B is always visible (no skip logic needed)
        }

        // Handle LOC Level 2 form submission
        function handleLOCLevel2Submit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('locLevel2SubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            // Update button state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            // Create FormData
            const formData = new FormData(document.getElementById('locLevel2Form'));
            
            // Submit form
            fetch('/process_loc_level2', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    return response.json();
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .then(data => {
                console.log('LOC Level 2 Data:', data);
                
                // Check if download URL is provided
                if (data.download_url) {
                    // Fetch the file as blob to download with custom name
                    fetch(data.download_url)
                        .then(response => response.blob())
                        .then(blob => {
                            const blobUrl = window.URL.createObjectURL(blob);
                            const link = document.createElement('a');
                            link.href = blobUrl;
                            link.download = data.excel_file || 'LOC_Level2.xlsx';
                            document.body.appendChild(link);
                            link.click();
                            document.body.removeChild(link);
                            window.URL.revokeObjectURL(blobUrl);
                            
                            closeModal('locLevel2Modal');
                            
                            // Call cleanup after 2 seconds, then reload
                            setTimeout(() => {
                                fetch('/cleanup_loc_files', {
                                    method: 'POST'
                                }).then(() => {
                                    location.reload();
                                }).catch(err => {
                                    console.error('Cleanup error:', err);
                                    location.reload(); // Reload anyway
                                });
                            }, 2000);
                        });
                } else {
                    alert('LOC Level 2 data submitted successfully!');
                    closeModal('locLevel2Modal');
                }
            })
            .catch(error => {
                console.error('LOC Level 2 Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // Toggle Section 21 for LOC Level 4
        function toggleLOCLevel4Section21() {
            const q20_A = document.getElementById('q20_A').value;
            const section21 = document.getElementById('section21');
            
            if (q20_A === 'Yes') {
                section21.style.display = 'block';
            } else {
                section21.style.display = 'none';
                // Clear all section 21 answers when hidden
                const section21Selects = section21.querySelectorAll('select');
                const section21Inputs = section21.querySelectorAll('input');
                section21Selects.forEach(select => select.value = '');
                section21Inputs.forEach(input => input.value = '');
            }
        }

        // Handle LOC Level 3 form submission
        function handleLOCLevel3Submit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('locLevel3SubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            const formData = new FormData(document.getElementById('locLevel3Form'));
            
            fetch('/process_loc_level3', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    return response.json();
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .then(data => {
                console.log('LOC Level 3 Data:', data);
                
                if (data.download_url) {
                    fetch(data.download_url)
                        .then(response => response.blob())
                        .then(blob => {
                            const blobUrl = window.URL.createObjectURL(blob);
                            const link = document.createElement('a');
                            link.href = blobUrl;
                            link.download = data.excel_file || 'LOC_Level3.xlsx';
                            document.body.appendChild(link);
                            link.click();
                            document.body.removeChild(link);
                            window.URL.revokeObjectURL(blobUrl);
                            
                            closeModal('locLevel3Modal');
                            
                            // Call cleanup after 2 seconds, then reload
                            setTimeout(() => {
                                fetch('/cleanup_loc_files', {
                                    method: 'POST'
                                }).then(() => {
                                    location.reload();
                                }).catch(err => {
                                    console.error('Cleanup error:', err);
                                    location.reload(); // Reload anyway
                                });
                            }, 2000);
                        });
                }
            })
            .catch(error => {
                console.error('LOC Level 3 Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // Handle LOC Level 4 form submission
        function handleLOCLevel4Submit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('locLevel4SubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            const formData = new FormData(document.getElementById('locLevel4Form'));
            
            fetch('/process_loc_level4', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    return response.json();
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .then(data => {
                console.log('LOC Level 4 Data:', data);
                
                if (data.download_url) {
                    fetch(data.download_url)
                        .then(response => response.blob())
                        .then(blob => {
                            const blobUrl = window.URL.createObjectURL(blob);
                            const link = document.createElement('a');
                            link.href = blobUrl;
                            link.download = data.excel_file || 'LOC_Level4.xlsx';
                            document.body.appendChild(link);
                            link.click();
                            document.body.removeChild(link);
                            window.URL.revokeObjectURL(blobUrl);
                            
                            closeModal('locLevel4Modal');
                            
                            // Call cleanup after 2 seconds, then reload
                            setTimeout(() => {
                                fetch('/cleanup_loc_files', {
                                    method: 'POST'
                                }).then(() => {
                                    location.reload();
                                }).catch(err => {
                                    console.error('Cleanup error:', err);
                                    location.reload(); // Reload anyway
                                });
                            }, 2000);
                        });
                }
            })
            .catch(error => {
                console.error('LOC Level 4 Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // Toggle LOE Question 8 based on Question 7
        function toggleLOEQuestion8() {
            const q7 = document.getElementById('q7').value;
            const q8_group = document.getElementById('q8_group');
            const q8 = document.getElementById('q8');
            
            if (q7 === 'Yes') {
                q8_group.style.display = 'block';
                q8.setAttribute('required', 'required');
            } else {
                q8_group.style.display = 'none';
                q8.removeAttribute('required');
                q8.value = ''; // Clear the value
            }
        }

        // Toggle LOE Question 11 based on Question 10
        function toggleLOEQuestion11() {
            const q10 = document.getElementById('q10').value;
            const q11_group = document.getElementById('q11_group');
            const q11 = document.getElementById('q11');
            
            if (q10 === 'Yes') {
                q11_group.style.display = 'block';
                q11.setAttribute('required', 'required');
            } else {
                q11_group.style.display = 'none';
                q11.removeAttribute('required');
                q11.value = ''; // Clear the value
            }
        }

        // Handle LOE form submission
        function handleLOESubmit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('loeSubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            const formData = new FormData(document.getElementById('loeForm'));
            
            fetch('/process_loe', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    return response.json();
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .then(data => {
                console.log('LOE Data:', data);
                
                if (data.download_url) {
                    fetch(data.download_url)
                        .then(response => response.blob())
                        .then(blob => {
                            const blobUrl = window.URL.createObjectURL(blob);
                            const link = document.createElement('a');
                            link.href = blobUrl;
                            link.download = data.excel_file || 'LOE.xlsx';
                            document.body.appendChild(link);
                            link.click();
                            document.body.removeChild(link);
                            window.URL.revokeObjectURL(blobUrl);
                            
                            closeModal('loeModal');
                            
                            // Call cleanup after 2 seconds, then reload
                            setTimeout(() => {
                                fetch('/cleanup_loe_files', {
                                    method: 'POST'
                                }).then(() => {
                                    location.reload();
                                }).catch(err => {
                                    console.error('Cleanup error:', err);
                                    location.reload(); // Reload anyway
                                });
                            }, 2000);
                        });
                }
            })
            .catch(error => {
                console.error('LOE Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // Handle Create VICS Worksheet with Bank Input form submission
        document.getElementById('createVICSWithBankInputForm').addEventListener('submit', function(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('createVICSWithBankInputSubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            // Update button state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            // Create FormData
            const formData = new FormData();
            const vicsFile1 = document.getElementById('vics_file1').files[0];
            const vicsFile2 = document.getElementById('vics_file2').files[0];
            
            formData.append('vics_file1', vicsFile1);
            formData.append('vics_file2', vicsFile2);
            
            // Submit form
            fetch('/create_vics_with_bank_input', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    return response.json();
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .then(data => {
                console.log('Create VICS with Bank Input Response:', data);
                
                // Check if download URL is provided
                if (data.download_url) {
                    // Fetch the file as blob to download with custom name
                    fetch(data.download_url)
                        .then(response => response.blob())
                        .then(blob => {
                            // Create blob URL and download with custom filename
                            const blobUrl = window.URL.createObjectURL(blob);
                            const link = document.createElement('a');
                            link.href = blobUrl;
                            link.download = data.excel_file || 'VICS_With_Bank_Input.xlsx';
                            document.body.appendChild(link);
                            link.click();
                            document.body.removeChild(link);
                            
                            // Clean up blob URL
                            window.URL.revokeObjectURL(blobUrl);
                            
                            // Close modal
                            closeModal('createVICSWithBankInputModal');
                            
                            // Cleanup files after 2 seconds to ensure download has started
                            setTimeout(() => {
                                fetch('/cleanup_vics_with_bank_input', { method: 'POST' })
                                    .then(() => location.reload())
                                    .catch(err => {
                                        console.error('Cleanup error:', err);
                                        location.reload();
                                    });
                            }, 2000);
                        })
                        .catch(err => {
                            console.error('Download error:', err);
                            alert('Error downloading file: ' + err.message);
                        });
                } else {
                    alert('VICS Worksheet with Bank Input created successfully!');
                    closeModal('createVICSWithBankInputModal');
                    location.reload();
                }
            })
            .catch(error => {
                console.error('Create VICS with Bank Input Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        });

        // Handle Create LOC Worksheet with Bank Input form submission
        const createLOCWithBankInputForm = document.getElementById('createLOCWithBankInputForm');
        if (createLOCWithBankInputForm) {
            createLOCWithBankInputForm.addEventListener('submit', function(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('createLOCWithBankInputSubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            // Update button state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            // Create FormData
            const formData = new FormData();
            const locFile1 = document.getElementById('loc_file1').files[0];
            const locFile2 = document.getElementById('loc_file2').files[0];
            
            formData.append('loc_file1', locFile1);
            formData.append('loc_file2', locFile2);
            
            // Submit form
            fetch('/create_loc_with_bank_input', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    return response.json();
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .then(data => {
                console.log('Create LOC with Bank Input Response:', data);
                
                // Check if there was an error
                if (data.error) {
                    alert(data.error);
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                    return;
                }
                
                // Check if download URL is provided
                if (data.download_url) {
                    // Fetch the file as blob to download with custom name
                    fetch(data.download_url)
                        .then(response => response.blob())
                        .then(blob => {
                            // Create blob URL and download with custom filename
                            const blobUrl = window.URL.createObjectURL(blob);
                            const link = document.createElement('a');
                            link.href = blobUrl;
                            link.download = data.excel_file || 'LOC.xlsx';
                            document.body.appendChild(link);
                            link.click();
                            document.body.removeChild(link);
                            
                            // Clean up blob URL
                            window.URL.revokeObjectURL(blobUrl);
                            
                            // Close modal
                            closeModal('createLOCWithBankInputModal');
                            
                            // Cleanup files after 2 seconds to ensure download has started
                            setTimeout(() => {
                                fetch('/cleanup_loc_with_bank_input', { method: 'POST' })
                                    .then(() => location.reload())
                                    .catch(err => {
                                        console.error('Cleanup error:', err);
                                        location.reload();
                                    });
                            }, 2000);
                        })
                        .catch(err => {
                            console.error('Download error:', err);
                            alert('Error downloading file: ' + err.message);
                        });
                } else {
                    alert('LOC Worksheet with Bank Input created successfully!');
                    closeModal('createLOCWithBankInputModal');
                    location.reload();
                }
            })
            .catch(error => {
                console.error('Create LOC with Bank Input Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        });
        } else {
            console.error('createLOCWithBankInputForm element not found');
        }

        // Handle Gap Assessment Excel form submission
        document.getElementById('gapAssessmentExcelForm').addEventListener('submit', function(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('gapAssessmentExcelSubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            // Update button state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            // Create FormData
            const formData = new FormData();
            const gapZip = document.getElementById('gap_assessment_zip').files[0];
            
            formData.append('gap_assessment_zip', gapZip);
            
            // Submit form
            fetch('/create_gap_assessment_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    return response.json();
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .then(data => {
                console.log('Gap Assessment Excel Response:', data);
                
                // Check if download URL is provided
                if (data.download_url) {
                    // Fetch the file as blob to download with custom name
                    fetch(data.download_url)
                        .then(response => response.blob())
                        .then(blob => {
                            // Create blob URL and download with custom filename
                            const blobUrl = window.URL.createObjectURL(blob);
                            const link = document.createElement('a');
                            link.href = blobUrl;
                            link.download = data.excel_file || 'Gap_Assessment.xlsx';
                            document.body.appendChild(link);
                            link.click();
                            document.body.removeChild(link);
                            
                            // Clean up blob URL
                            window.URL.revokeObjectURL(blobUrl);
                            
                            // Close modal
                            closeModal('gapAssessmentExcelModal');
                            
                            // Cleanup files after 2 seconds to ensure download has started
                            setTimeout(() => {
                                fetch('/cleanup_gap_assessment', { method: 'POST' })
                                    .then(() => location.reload())
                                    .catch(err => {
                                        console.error('Cleanup error:', err);
                                        location.reload();
                                    });
                            }, 2000);
                        })
                        .catch(err => {
                            console.error('Download error:', err);
                            alert('Error downloading file: ' + err.message);
                        });
                } else {
                    alert('Gap Assessment Excel created successfully!');
                    closeModal('gapAssessmentExcelModal');
                    location.reload();
                }
            })
            .catch(error => {
                console.error('Gap Assessment Excel Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        });

        // Add email field for Gap Assessment Report
        function addGapEmailField() {
            const container = document.getElementById('gapEmailContainer');
            const newField = document.createElement('div');
            newField.style.display = 'flex';
            newField.style.gap = '10px';
            newField.style.marginBottom = '10px';
            newField.innerHTML = `
                <input type="email" name="email[]" class="form-input" placeholder="Enter email address" style="flex: 1;">
                <button type="button" class="cancel-btn" onclick="this.parentElement.remove()" style="flex: 0 0 40px; padding: 8px;">-</button>
            `;
            container.appendChild(newField);
        }

        // Handle Gap Assessment Report form submission
        function handleGapAssessmentReportSubmit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('gapAssessmentReportSubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            const formData = new FormData(document.getElementById('gapAssessmentReportForm'));
            
            fetch('/process_gap_assessment_report', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    return response.blob();
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .then(blob => {
                // Create download link
                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'Gap_Assessment_Report.docx';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);
                
                closeModal('gapAssessmentReportModal');
                
                // Reload page after 1 second
                setTimeout(() => {
                    location.reload();
                }, 1000);
            })
            .catch(error => {
                console.error('Gap Assessment Report Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // Gap Assessment Report with Bank Input Functions
        function addGapBankEmailField() {
            const container = document.getElementById('gapBankEmailContainer');
            const emailFieldDiv = document.createElement('div');
            emailFieldDiv.style.display = 'flex';
            emailFieldDiv.style.gap = '10px';
            emailFieldDiv.style.marginBottom = '10px';
            
            const emailInput = document.createElement('input');
            emailInput.type = 'email';
            emailInput.name = 'email[]';
            emailInput.className = 'form-input';
            emailInput.placeholder = 'Enter email address';
            emailInput.required = true;
            emailInput.style.flex = '1';
            
            const removeBtn = document.createElement('button');
            removeBtn.type = 'button';
            removeBtn.className = 'submit-btn';
            removeBtn.textContent = '-';
            removeBtn.style.flex = '0 0 40px';
            removeBtn.style.padding = '8px';
            removeBtn.style.backgroundColor = '#e74c3c';
            removeBtn.onclick = function() {
                container.removeChild(emailFieldDiv);
            };
            
            emailFieldDiv.appendChild(emailInput);
            emailFieldDiv.appendChild(removeBtn);
            container.appendChild(emailFieldDiv);
        }

        function handleGapAssessmentReportBankInputSubmit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('gapAssessmentReportBankInputSubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            const formData = new FormData(document.getElementById('gapAssessmentReportBankInputForm'));
            
            fetch('/process_gap_assessment_report_bank_input', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    return response.blob();
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .then(blob => {
                // Create download link
                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'Gap_Assessment_Report_with_Bank_Input.docx';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);
                
                closeModal('gapAssessmentReportBankInputModal');
                
                // Reload page after 1 second
                setTimeout(() => {
                    location.reload();
                }, 1000);
            })
            .catch(error => {
                console.error('Gap Assessment Report Bank Input Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // VICS Certificate Functions
        function handleVicsCertificateSubmit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('vicsCertificateSubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            const formData = new FormData(document.getElementById('vicsCertificateForm'));
            
            fetch('/process_vics_certificate', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    return response.blob();
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .then(blob => {
                // Create download link
                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'VICS_Certificate.docx';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);
                
                closeModal('vicsCertificateModal');
                
                // Reload page after 1 second
                setTimeout(() => {
                    location.reload();
                }, 1000);
            })
            .catch(error => {
                console.error('VICS Certificate Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // Cyber Security Audit Report Functions
        function addCyberEmailField() {
            const container = document.getElementById('cyberEmailContainer');
            const emailFieldDiv = document.createElement('div');
            emailFieldDiv.style.display = 'flex';
            emailFieldDiv.style.gap = '10px';
            emailFieldDiv.style.marginBottom = '10px';
            
            const emailInput = document.createElement('input');
            emailInput.type = 'email';
            emailInput.name = 'email[]';
            emailInput.className = 'form-input';
            emailInput.placeholder = 'Enter email address';
            emailInput.required = true;
            emailInput.style.flex = '1';
            
            const removeBtn = document.createElement('button');
            removeBtn.type = 'button';
            removeBtn.className = 'submit-btn';
            removeBtn.textContent = '-';
            removeBtn.style.flex = '0 0 40px';
            removeBtn.style.padding = '8px';
            removeBtn.style.backgroundColor = '#e74c3c';
            removeBtn.onclick = function() {
                container.removeChild(emailFieldDiv);
            };
            
            emailFieldDiv.appendChild(emailInput);
            emailFieldDiv.appendChild(removeBtn);
            container.appendChild(emailFieldDiv);
        }

        function handleCyberSecurityAuditReportSubmit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('cyberSecurityAuditReportSubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            const formData = new FormData(document.getElementById('cyberSecurityAuditReportForm'));
            
            fetch('/process_cyber_security_audit_report', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    return response.blob();
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            })
            .then(blob => {
                // Create download link
                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'Cyber_Security_Audit_Report.docx';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);
                
                closeModal('cyberSecurityAuditReportModal');
                
                // Reload page after 1 second
                setTimeout(() => {
                    location.reload();
                }, 1000);
            })
            .catch(error => {
                console.error('Cyber Security Audit Report Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // First Audit MetaData Functions
        const subSectorMappings = {"Agriculture": ["Agriculture"], "Defence": ["Defence"], "Education": ["Education"], "Energy": ["Nuclear Energy", "Oil and Gas", "Power", "Renewable Energy"], "Finance": ["Banking", "Financial Services and Tax", "Insurance", "Market Infrastructure Institutions", "PFRDA", "NHB"], "Healthcare": ["Healthcare services", "Medical devices", "Pharmaceuticals"], "Information_and_Broadcasting": ["Information_and_Broadcasting"], "Information_and_Communication_Technology": ["Information_and_Communication_Technology"], "Law_Enforcement_and_Security": ["Law_Enforcement_and_Security"], "Public_Essential_Services_and_Utilities": ["Building and Construction", "Emergency Services", "Food", "Textiles and Consumer Goods", "Heavy industries", "Postal Services", "Public administration", "Retail services", "Sports, cultural activities, Trade Fairs and Entertainment", "Tourism & Hospitality", "Water and Sewage Utilities"], "Space": ["Space"], "Transportation": ["Air Transportation", "Land Transportation", "Water Transportation"]};

        function updateSubSectorOptions() {
            const sectorSelect = document.getElementById('metaSectorOrg');
            const subSectorSelect = document.getElementById('metaSubSector');
            const selectedSector = sectorSelect.value;

            // Clear existing options
            subSectorSelect.innerHTML = '<option value="">Select Sub Sector</option>';

            if (selectedSector && subSectorMappings[selectedSector]) {
                const subSectors = subSectorMappings[selectedSector];
                subSectors.forEach(subSector => {
                    const option = document.createElement('option');
                    option.value = subSector;
                    option.textContent = subSector;
                    subSectorSelect.appendChild(option);
                });
            }
        }

        let vulnEntryCount = 1;
        
        function toggleVulnerabilitySection() {
            const vulnerabilityStatus = document.querySelector('input[name="vulnerabilityStatus"]:checked');
            const vulnerabilitySection = document.getElementById('vulnerabilitySection');
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            
            if (vulnerabilityStatus && vulnerabilityStatus.value === '0') {
                // Hide the section
                vulnerabilitySection.style.display = 'none';
                // Remove required attribute from all inputs in the section
                vulnerabilityInputs.forEach(input => {
                    input.removeAttribute('required');
                });
            } else {
                // Show the section
                vulnerabilitySection.style.display = 'block';
                // Add required attribute back to all inputs in the section
                vulnerabilityInputs.forEach(input => {
                    input.setAttribute('required', 'required');
                });
            }
        }
        
        function toggleFollowUpVulnerabilitySection() {
            const vulnerabilityStatus = document.querySelector('input[name="followUpVulnerabilityStatus"]:checked');
            const vulnerabilitySection = document.getElementById('followUpVulnerabilitySection');
            const vulnerabilityInputs = vulnerabilitySection.querySelectorAll('input[required], select[required]');
            
            if (vulnerabilityStatus && vulnerabilityStatus.value === '0') {
                // Hide the section
                vulnerabilitySection.style.display = 'none';
                // Remove required attribute from all inputs in the section
                vulnerabilityInputs.forEach(input => {
                    input.removeAttribute('required');
                });
            } else {
                // Show the section
                vulnerabilitySection.style.display = 'block';
                // Add required attribute back to all inputs in the section
                vulnerabilityInputs.forEach(input => {
                    input.setAttribute('required', 'required');
                });
            }
        }
        
        function addVulnerabilityEntry() {
            const container = document.getElementById('vulnerabilityContainer');
            const entryDiv = document.createElement('div');
            entryDiv.className = 'vulnerability-entry';
            entryDiv.style.border = '1px solid #ddd';
            entryDiv.style.padding = '15px';
            entryDiv.style.marginBottom = '15px';
            entryDiv.style.borderRadius = '5px';
            entryDiv.style.position = 'relative';

            entryDiv.innerHTML = `
                <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
                <div class="form-group">
                    <label class="form-label">Audited infrastructure details*</label>
                    <input type="text" name="vuln_${vulnEntryCount}_infrastructure" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                    <input type="text" name="vuln_${vulnEntryCount}_name" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">CVE/CWE Reference Number*</label>
                    <input type="text" name="vuln_${vulnEntryCount}_cve" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Severity of Issue*</label>
                    <select name="vuln_${vulnEntryCount}_severity" class="form-input" required>
                        <option value="">Select Severity</option>
                        <option value="Critical">Critical</option>
                        <option value="High">High</option>
                        <option value="Medium">Medium</option>
                        <option value="Low">Low</option>
                        <option value="Informational">Informational</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                    <input type="number" name="vuln_${vulnEntryCount}_count" class="form-input" min="0" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Attributing Factor*</label>
                    <select name="vuln_${vulnEntryCount}_factor" class="form-input" required>
                        <option value="">Select Factor</option>
                        <option value="Coding Error">Coding Error</option>
                        <option value="Configuration Error">Configuration Error</option>
                        <option value="Deployment Error">Deployment Error</option>
                        <option value="Design Error">Design Error</option>
                        <option value="Operation Error">Operation Error</option>
                        <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                    </select>
                </div>
            `;

            container.appendChild(entryDiv);
            vulnEntryCount++;
        }

        let empEntryCount = 1;
        function addEmployeeEntry() {
            const container = document.getElementById('employeeContainer');
            const entryDiv = document.createElement('div');
            entryDiv.className = 'employee-entry';
            entryDiv.style.border = '1px solid #ddd';
            entryDiv.style.padding = '15px';
            entryDiv.style.marginBottom = '15px';
            entryDiv.style.borderRadius = '5px';
            entryDiv.style.position = 'relative';

            entryDiv.innerHTML = `
                <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
                <div class="form-group">
                    <label class="form-label">Name of employee*</label>
                    <input type="text" name="emp_${empEntryCount}_name" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">E-mail ID*</label>
                    <input type="email" name="emp_${empEntryCount}_email" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">CISSP*</label>
                    <div style="display: flex; gap: 20px;">
                        <label><input type="radio" name="emp_${empEntryCount}_cissp" value="Yes" required> Yes</label>
                        <label><input type="radio" name="emp_${empEntryCount}_cissp" value="No" required> No</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">CISA*</label>
                    <div style="display: flex; gap: 20px;">
                        <label><input type="radio" name="emp_${empEntryCount}_cisa" value="Yes" required> Yes</label>
                        <label><input type="radio" name="emp_${empEntryCount}_cisa" value="No" required> No</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">CISM*</label>
                    <div style="display: flex; gap: 20px;">
                        <label><input type="radio" name="emp_${empEntryCount}_cism" value="Yes" required> Yes</label>
                        <label><input type="radio" name="emp_${empEntryCount}_cism" value="No" required> No</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">ISO*</label>
                    <div style="display: flex; gap: 20px;">
                        <label><input type="radio" name="emp_${empEntryCount}_iso" value="Yes" required> Yes</label>
                        <label><input type="radio" name="emp_${empEntryCount}_iso" value="No" required> No</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">DISA*</label>
                    <div style="display: flex; gap: 20px;">
                        <label><input type="radio" name="emp_${empEntryCount}_disa" value="Yes" required> Yes</label>
                        <label><input type="radio" name="emp_${empEntryCount}_disa" value="No" required> No</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">OSCP*</label>
                    <div style="display: flex; gap: 20px;">
                        <label><input type="radio" name="emp_${empEntryCount}_oscp" value="Yes" required> Yes</label>
                        <label><input type="radio" name="emp_${empEntryCount}_oscp" value="No" required> No</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">CEH*</label>
                    <div style="display: flex; gap: 20px;">
                        <label><input type="radio" name="emp_${empEntryCount}_ceh" value="Yes" required> Yes</label>
                        <label><input type="radio" name="emp_${empEntryCount}_ceh" value="No" required> No</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Others</label>
                    <input type="text" name="emp_${empEntryCount}_others" class="form-input" placeholder="Specify other certifications">
                </div>
                <div class="form-group">
                    <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                    <input type="number" name="emp_${empEntryCount}_experience" class="form-input" min="0" step="0.5" required>
                </div>
            `;

            container.appendChild(entryDiv);
            empEntryCount++;
        }

        function handleFirstAuditMetaDataSubmit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('firstAuditMetaDataSubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            const formData = new FormData(document.getElementById('firstAuditMetaDataForm'));
            
            // Handle dateLastAudit value: if date input is visible and has value, use it; otherwise use "NA"
            const dateLastAuditType = document.getElementById('metaDateLastAuditType');
            const dateLastAuditInput = document.getElementById('metaDateLastAudit');
            const dateLastAuditHidden = document.getElementById('metaDateLastAuditValue');
            
            if (dateLastAuditType && dateLastAuditInput && dateLastAuditHidden) {
                if (dateLastAuditType.value === 'EnterDate' && dateLastAuditInput.value) {
                    // Use the date value from the date input
                    formData.set('dateLastAudit', dateLastAuditInput.value);
                } else {
                    // Use "NA" from hidden input
                    formData.set('dateLastAudit', dateLastAuditHidden.value || 'NA');
                }
            }
            
            fetch('/process_first_audit_metadata', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Download the file
                    const link = document.createElement('a');
                    link.href = data.download_url;
                    link.download = data.filename;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    // Close modal
                    closeModal('firstAuditMetaDataModal');
                    
                    // Cleanup and reload after 2 seconds
                    setTimeout(() => {
                        fetch('/cleanup_first_audit_metadata', {
                            method: 'POST'
                        }).then(() => {
                            location.reload();
                        });
                    }, 2000);
                } else {
                    alert('Error: ' + (data.error || 'Unknown error'));
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                }
            })
            .catch(error => {
                console.error('First Audit MetaData Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        

        // Follow Up Audit MetaData Functions
        const followUpSubSectorMappings = {"Agriculture": ["Agriculture"], "Defence": ["Defence"], "Education": ["Education"], "Energy": ["Nuclear Energy", "Oil and Gas", "Power", "Renewable Energy"], "Finance": ["Banking", "Financial Services and Tax", "Insurance", "Market Infrastructure Institutions", "PFRDA", "NHB"], "Healthcare": ["Healthcare services", "Medical devices", "Pharmaceuticals"], "Information_and_Broadcasting": ["Information_and_Broadcasting"], "Information_and_Communication_Technology": ["Information_and_Communication_Technology"], "Law_Enforcement_and_Security": ["Law_Enforcement_and_Security"], "Public_Essential_Services_and_Utilities": ["Building and Construction", "Emergency Services", "Food", "Textiles and Consumer Goods", "Heavy industries", "Postal Services", "Public administration", "Retail services", "Sports, cultural activities, Trade Fairs and Entertainment", "Tourism & Hospitality", "Water and Sewage Utilities"], "Space": ["Space"], "Transportation": ["Air Transportation", "Land Transportation", "Water Transportation"]};

        function updateFollowUpSubSectorOptions() {
            const sectorSelect = document.getElementById('followUpMetaSectorOrg');
            const subSectorSelect = document.getElementById('followUpMetaSubSector');
            const selectedSector = sectorSelect.value;

            // Clear existing options
            subSectorSelect.innerHTML = '<option value="">Select Sub Sector</option>';

            if (selectedSector && followUpSubSectorMappings[selectedSector]) {
                const subSectors = followUpSubSectorMappings[selectedSector];
                subSectors.forEach(subSector => {
                    const option = document.createElement('option');
                    option.value = subSector;
                    option.textContent = subSector;
                    subSectorSelect.appendChild(option);
                });
            }
        }

        let followUpVulnEntryCount = 1;
        function addFollowUpVulnerabilityEntry() {
            const container = document.getElementById('followUpVulnerabilityContainer');
            const entryDiv = document.createElement('div');
            entryDiv.className = 'vulnerability-entry';
            entryDiv.style.border = '1px solid #ddd';
            entryDiv.style.padding = '15px';
            entryDiv.style.marginBottom = '15px';
            entryDiv.style.borderRadius = '5px';
            entryDiv.style.position = 'relative';

            entryDiv.innerHTML = `
                <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
                <div class="form-group">
                    <label class="form-label">Audited infrastructure details*</label>
                    <input type="text" name="vuln_${followUpVulnEntryCount}_infrastructure" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Name of Vulnerability / Security Issues as per CVE/CWE/Mitre DB Only*</label>
                    <input type="text" name="vuln_${followUpVulnEntryCount}_name" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">CVE/CWE Reference Number*</label>
                    <input type="text" name="vuln_${followUpVulnEntryCount}_cve" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Severity of Issue*</label>
                    <select name="vuln_${followUpVulnEntryCount}_severity" class="form-input" required>
                        <option value="">Select Severity</option>
                        <option value="Critical">Critical</option>
                        <option value="High">High</option>
                        <option value="Medium">Medium</option>
                        <option value="Low">Low</option>
                        <option value="Informational">Informational</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Cumulative count of no. of occurrence of vulnerability in audit*</label>
                    <input type="number" name="vuln_${followUpVulnEntryCount}_count" class="form-input" min="0" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Attributing Factor*</label>
                    <select name="vuln_${followUpVulnEntryCount}_factor" class="form-input" required>
                        <option value="">Select Factor</option>
                        <option value="Coding Error">Coding Error</option>
                        <option value="Configuration Error">Configuration Error</option>
                        <option value="Deployment Error">Deployment Error</option>
                        <option value="Design Error">Design Error</option>
                        <option value="Operation Error">Operation Error</option>
                        <option value="Vulnerable Software Versions">Vulnerable Software Versions</option>
                    </select>
                </div>
            `;

            container.appendChild(entryDiv);
            followUpVulnEntryCount++;
        }

        let followUpEmpEntryCount = 1;
        function addFollowUpEmployeeEntry() {
            const container = document.getElementById('followUpEmployeeContainer');
            const entryDiv = document.createElement('div');
            entryDiv.className = 'employee-entry';
            entryDiv.style.border = '1px solid #ddd';
            entryDiv.style.padding = '15px';
            entryDiv.style.marginBottom = '15px';
            entryDiv.style.borderRadius = '5px';
            entryDiv.style.position = 'relative';

            entryDiv.innerHTML = `
                <button type="button" onclick="this.parentElement.remove()" style="position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
                <div class="form-group">
                    <label class="form-label">Name of employee*</label>
                    <input type="text" name="emp_${followUpEmpEntryCount}_name" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">E-mail ID*</label>
                    <input type="email" name="emp_${followUpEmpEntryCount}_email" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">CISSP*</label>
                    <div style="display: flex; gap: 20px;">
                        <label><input type="radio" name="emp_${followUpEmpEntryCount}_cissp" value="Yes" required> Yes</label>
                        <label><input type="radio" name="emp_${followUpEmpEntryCount}_cissp" value="No" required> No</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">CISA*</label>
                    <div style="display: flex; gap: 20px;">
                        <label><input type="radio" name="emp_${followUpEmpEntryCount}_cisa" value="Yes" required> Yes</label>
                        <label><input type="radio" name="emp_${followUpEmpEntryCount}_cisa" value="No" required> No</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">CISM*</label>
                    <div style="display: flex; gap: 20px;">
                        <label><input type="radio" name="emp_${followUpEmpEntryCount}_cism" value="Yes" required> Yes</label>
                        <label><input type="radio" name="emp_${followUpEmpEntryCount}_cism" value="No" required> No</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">ISO*</label>
                    <div style="display: flex; gap: 20px;">
                        <label><input type="radio" name="emp_${followUpEmpEntryCount}_iso" value="Yes" required> Yes</label>
                        <label><input type="radio" name="emp_${followUpEmpEntryCount}_iso" value="No" required> No</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">DISA*</label>
                    <div style="display: flex; gap: 20px;">
                        <label><input type="radio" name="emp_${followUpEmpEntryCount}_disa" value="Yes" required> Yes</label>
                        <label><input type="radio" name="emp_${followUpEmpEntryCount}_disa" value="No" required> No</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">OSCP*</label>
                    <div style="display: flex; gap: 20px;">
                        <label><input type="radio" name="emp_${followUpEmpEntryCount}_oscp" value="Yes" required> Yes</label>
                        <label><input type="radio" name="emp_${followUpEmpEntryCount}_oscp" value="No" required> No</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">CEH*</label>
                    <div style="display: flex; gap: 20px;">
                        <label><input type="radio" name="emp_${followUpEmpEntryCount}_ceh" value="Yes" required> Yes</label>
                        <label><input type="radio" name="emp_${followUpEmpEntryCount}_ceh" value="No" required> No</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Others</label>
                    <input type="text" name="emp_${followUpEmpEntryCount}_others" class="form-input" placeholder="Specify other certifications">
                </div>
                <div class="form-group">
                    <label class="form-label">Experience in Cyber Security Audit (No. of Years)*</label>
                    <input type="number" name="emp_${followUpEmpEntryCount}_experience" class="form-input" min="0" step="0.5" required>
                </div>
            `;

            container.appendChild(entryDiv);
            followUpEmpEntryCount++;
        }

        function handleFollowUpAuditMetaDataSubmit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('followUpAuditMetaDataSubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            const formData = new FormData(document.getElementById('followUpAuditMetaDataForm'));
            
            // Add vulnerability status to form data
            const vulnerabilityStatus = document.querySelector('input[name="followUpVulnerabilityStatus"]:checked');
            if (vulnerabilityStatus) {
                formData.set('vulnerabilityStatus', vulnerabilityStatus.value);
            } else {
                formData.set('vulnerabilityStatus', 'has'); // Default to 'has'
            }
            
            fetch('/process_follow_up_audit_metadata', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Download the file
                    const link = document.createElement('a');
                    link.href = data.download_url;
                    link.download = data.filename;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    // Close modal
                    closeModal('followUpAuditMetaDataModal');
                    
                    // Cleanup and reload after 2 seconds
                    setTimeout(() => {
                        fetch('/cleanup_follow_up_audit_metadata', {
                            method: 'POST'
                        }).then(() => {
                            location.reload();
                        });
                    }, 2000);
                } else {
                    alert('Error: ' + (data.error || 'Unknown error'));
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                }
            })
            .catch(error => {
                console.error('Follow Up Audit MetaData Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // IS Audit Compliance Worksheet Functions
        function handleIsAuditComplianceSubmit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('isAuditComplianceSubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            const formData = new FormData(document.getElementById('isAuditComplianceForm'));
            
            fetch('/process_is_audit_compliance', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Download the file
                    const link = document.createElement('a');
                    link.href = data.download_url;
                    link.download = data.filename;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    // Close modal
                    closeModal('isAuditComplianceModal');
                    
                    // Reset form
                    document.getElementById('isAuditComplianceForm').reset();
                    
                    // Delete the file from server and reload page
                    setTimeout(() => {
                        fetch('/cleanup_is_audit_compliance', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({ filename: data.filename })
                        })
                        .then(() => {
                            // Reload the page after cleanup
                            location.reload();
                        })
                        .catch(err => {
                            console.error('Cleanup error:', err);
                            // Reload even if cleanup fails
                            location.reload();
                        });
                    }, 1000);
                } else {
                    alert('Error: ' + (data.error || 'Unknown error'));
                }
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            })
            .catch(error => {
                console.error('IS Audit Compliance Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // Infrastructure VAPT Compliance Worksheet Functions
        function toggleInfraVAPTOtherOrganization() {
            const select = document.getElementById('infraVAPTOrganizationName');
            const otherGroup = document.getElementById('infraVAPTOtherOrganizationGroup');
            const otherInput = document.getElementById('infraVAPTOrganizationNameOther');
            
            if (select.value === 'Other') {
                otherGroup.style.display = 'block';
                otherInput.required = true;
            } else {
                otherGroup.style.display = 'none';
                otherInput.required = false;
                otherInput.value = '';
            }
        }

        function handleInfraVAPTComplianceSubmit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('infraVAPTComplianceSubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            const formData = new FormData(document.getElementById('infraVAPTComplianceForm'));
            
            fetch('/process_infra_vapt_compliance', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Download the file
                    const link = document.createElement('a');
                    link.href = data.download_url;
                    link.download = data.filename;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    // Close modal
                    closeModal('infraVAPTComplianceModal');
                    
                    // Reset form
                    document.getElementById('infraVAPTComplianceForm').reset();
                    toggleInfraVAPTOtherOrganization(); // Reset the other organization field visibility
                    
                    // Delete the file from server and reload page
                    setTimeout(() => {
                        fetch('/cleanup_infra_vapt_compliance', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({ filename: data.filename })
                        })
                        .then(() => {
                            // Reload the page after cleanup
                            location.reload();
                        })
                        .catch(err => {
                            console.error('Cleanup error:', err);
                            // Reload even if cleanup fails
                            location.reload();
                        });
                    }, 1000);
                } else {
                    alert('Error: ' + (data.error || 'Unknown error'));
                }
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            })
            .catch(error => {
                console.error('Infrastructure VAPT Compliance Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // Website VAPT Compliance Worksheet Functions
        function toggleWebsiteVAPTOtherOrganization() {
            const select = document.getElementById('websiteVAPTOrganizationName');
            const otherGroup = document.getElementById('websiteVAPTOtherOrganizationGroup');
            const otherInput = document.getElementById('websiteVAPTOrganizationNameOther');
            
            if (select.value === 'Other') {
                otherGroup.style.display = 'block';
                otherInput.required = true;
            } else {
                otherGroup.style.display = 'none';
                otherInput.required = false;
                otherInput.value = '';
            }
        }

        function handleWebsiteVAPTComplianceSubmit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('websiteVAPTComplianceSubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            const formData = new FormData(document.getElementById('websiteVAPTComplianceForm'));
            
            fetch('/process_website_vapt_compliance', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Download the file
                    const link = document.createElement('a');
                    link.href = data.download_url;
                    link.download = data.filename;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    // Close modal
                    closeModal('websiteVAPTComplianceModal');
                    
                    // Reset form
                    document.getElementById('websiteVAPTComplianceForm').reset();
                    toggleWebsiteVAPTOtherOrganization(); // Reset the other organization field visibility
                    
                    // Delete the file from server and reload page
                    setTimeout(() => {
                        fetch('/cleanup_website_vapt_compliance', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({ filename: data.filename })
                        })
                        .then(() => {
                            // Reload the page after cleanup
                            location.reload();
                        })
                        .catch(err => {
                            console.error('Cleanup error:', err);
                            // Reload even if cleanup fails
                            location.reload();
                        });
                    }, 1000);
                } else {
                    alert('Error: ' + (data.error || 'Unknown error'));
                }
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            })
            .catch(error => {
                console.error('Website VAPT Compliance Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // Public IP VAPT Compliance Worksheet Functions
        function togglePublicIPVAPTOtherOrganization() {
            const select = document.getElementById('publicIPVAPTOrganizationName');
            const otherGroup = document.getElementById('publicIPVAPTOtherOrganizationGroup');
            const otherInput = document.getElementById('publicIPVAPTOrganizationNameOther');
            
            if (select.value === 'Other') {
                otherGroup.style.display = 'block';
                otherInput.required = true;
            } else {
                otherGroup.style.display = 'none';
                otherInput.required = false;
                otherInput.value = '';
            }
        }

        function handlePublicIPVAPTComplianceSubmit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('publicIPVAPTComplianceSubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            const formData = new FormData(document.getElementById('publicIPVAPTComplianceForm'));
            
            fetch('/process_public_ip_vapt_compliance', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Download the file
                    const link = document.createElement('a');
                    link.href = data.download_url;
                    link.download = data.filename;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    // Close modal
                    closeModal('publicIPVAPTComplianceModal');
                    
                    // Reset form
                    document.getElementById('publicIPVAPTComplianceForm').reset();
                    togglePublicIPVAPTOtherOrganization(); // Reset the other organization field visibility
                    
                    // Delete the file from server and reload page
                    setTimeout(() => {
                        fetch('/cleanup_public_ip_vapt_compliance', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({ filename: data.filename })
                        })
                        .then(() => {
                            // Reload the page after cleanup
                            location.reload();
                        })
                        .catch(err => {
                            console.error('Cleanup error:', err);
                            // Reload even if cleanup fails
                            location.reload();
                        });
                    }, 1000);
                } else {
                    alert('Error: ' + (data.error || 'Unknown error'));
                }
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            })
            .catch(error => {
                console.error('Public IP VAPT Compliance Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // IS Audit Compliance Certificate Functions
        function toggleCertOtherOrganization() {
            const select = document.getElementById('certOrganizationName');
            const otherGroup = document.getElementById('certOtherOrganizationGroup');
            const otherInput = document.getElementById('certOrganizationNameOther');
            
            if (select.value === 'Other') {
                otherGroup.style.display = 'block';
                otherInput.required = true;
            } else {
                otherGroup.style.display = 'none';
                otherInput.required = false;
                otherInput.value = '';
            }
        }

        function toggleCertOtherFinancialYear() {
            const select = document.getElementById('certFinancialYear');
            const otherGroup = document.getElementById('certOtherFinancialYearGroup');
            const otherInput = document.getElementById('certFinancialYearOther');
            
            if (select.value === 'Other') {
                otherGroup.style.display = 'block';
                otherInput.required = true;
            } else {
                otherGroup.style.display = 'none';
                otherInput.required = false;
                otherInput.value = '';
            }
        }

        function handleIsAuditComplianceCertSubmit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('isAuditComplianceCertSubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            const formData = new FormData(document.getElementById('isAuditComplianceCertForm'));
            
            fetch('/process_is_audit_compliance_certificate', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Download the file
                    const link = document.createElement('a');
                    link.href = data.download_url;
                    link.download = data.filename;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    // Close modal
                    closeModal('isAuditComplianceCertModal');
                    
                    // Reset form
                    document.getElementById('isAuditComplianceCertForm').reset();
                    toggleCertOtherOrganization();
                    toggleCertOtherFinancialYear();
                    
                    // Delete the file from server and reload page
                    setTimeout(() => {
                        fetch('/cleanup_is_audit_compliance_certificate', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({ filename: data.filename })
                        })
                        .then(() => {
                            // Reload the page after cleanup
                            location.reload();
                        })
                        .catch(err => {
                            console.error('Cleanup error:', err);
                            // Reload even if cleanup fails
                            location.reload();
                        });
                    }, 1000);
                } else {
                    alert('Error: ' + (data.error || 'Unknown error'));
                }
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            })
            .catch(error => {
                console.error('IS Audit Compliance Certificate Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // Infrastructure VAPT Compliance Certificate Functions
        function toggleInfraCertOtherOrganization() {
            const select = document.getElementById('infraCertOrganizationName');
            const otherGroup = document.getElementById('infraCertOtherOrganizationGroup');
            const otherInput = document.getElementById('infraCertOrganizationNameOther');
            
            if (select.value === 'Other') {
                otherGroup.style.display = 'block';
                otherInput.required = true;
            } else {
                otherGroup.style.display = 'none';
                otherInput.required = false;
                otherInput.value = '';
            }
        }

        function toggleInfraCertOtherFinancialYear() {
            const select = document.getElementById('infraCertFinancialYear');
            const otherGroup = document.getElementById('infraCertOtherFinancialYearGroup');
            const otherInput = document.getElementById('infraCertFinancialYearOther');
            
            if (select.value === 'Other') {
                otherGroup.style.display = 'block';
                otherInput.required = true;
            } else {
                otherGroup.style.display = 'none';
                otherInput.required = false;
                otherInput.value = '';
            }
        }

        function handleInfraVAPTComplianceCertSubmit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('infraVAPTComplianceCertSubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            const formData = new FormData(document.getElementById('infraVAPTComplianceCertForm'));
            
            fetch('/process_infrastructure_vapt_compliance_certificate', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    const link = document.createElement('a');
                    link.href = data.download_url;
                    link.download = data.filename;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    closeModal('infraVAPTComplianceCertModal');
                    document.getElementById('infraVAPTComplianceCertForm').reset();
                    toggleInfraCertOtherOrganization();
                    toggleInfraCertOtherFinancialYear();
                    
                    setTimeout(() => {
                        fetch('/cleanup_infrastructure_vapt_compliance_certificate', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ filename: data.filename })
                        })
                        .then(() => location.reload())
                        .catch(err => location.reload());
                    }, 1000);
                } else {
                    alert('Error: ' + (data.error || 'Unknown error'));
                }
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            })
            .catch(error => {
                console.error('Infrastructure VAPT Compliance Certificate Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // Website VAPT Compliance Certificate Functions
        function toggleWebCertOtherOrganization() {
            const select = document.getElementById('webCertOrganizationName');
            const otherGroup = document.getElementById('webCertOtherOrganizationGroup');
            const otherInput = document.getElementById('webCertOrganizationNameOther');
            
            if (select.value === 'Other') {
                otherGroup.style.display = 'block';
                otherInput.required = true;
            } else {
                otherGroup.style.display = 'none';
                otherInput.required = false;
                otherInput.value = '';
            }
        }

        function toggleWebCertOtherFinancialYear() {
            const select = document.getElementById('webCertFinancialYear');
            const otherGroup = document.getElementById('webCertOtherFinancialYearGroup');
            const otherInput = document.getElementById('webCertFinancialYearOther');
            
            if (select.value === 'Other') {
                otherGroup.style.display = 'block';
                otherInput.required = true;
            } else {
                otherGroup.style.display = 'none';
                otherInput.required = false;
                otherInput.value = '';
            }
        }

        function handleWebsiteVAPTComplianceCertSubmit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('websiteVAPTComplianceCertSubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            const formData = new FormData(document.getElementById('websiteVAPTComplianceCertForm'));
            
            fetch('/process_website_vapt_compliance_certificate', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    const link = document.createElement('a');
                    link.href = data.download_url;
                    link.download = data.filename;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    closeModal('websiteVAPTComplianceCertModal');
                    document.getElementById('websiteVAPTComplianceCertForm').reset();
                    toggleWebCertOtherOrganization();
                    toggleWebCertOtherFinancialYear();
                    
                    setTimeout(() => {
                        fetch('/cleanup_website_vapt_compliance_certificate', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ filename: data.filename })
                        })
                        .then(() => location.reload())
                        .catch(err => location.reload());
                    }, 1000);
                } else {
                    alert('Error: ' + (data.error || 'Unknown error'));
                }
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            })
            .catch(error => {
                console.error('Website VAPT Compliance Certificate Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // Public IP VAPT Compliance Certificate Functions
        function togglePubCertOtherOrganization() {
            const select = document.getElementById('pubCertOrganizationName');
            const otherGroup = document.getElementById('pubCertOtherOrganizationGroup');
            const otherInput = document.getElementById('pubCertOrganizationNameOther');
            
            if (select.value === 'Other') {
                otherGroup.style.display = 'block';
                otherInput.required = true;
            } else {
                otherGroup.style.display = 'none';
                otherInput.required = false;
                otherInput.value = '';
            }
        }

        function togglePubCertOtherFinancialYear() {
            const select = document.getElementById('pubCertFinancialYear');
            const otherGroup = document.getElementById('pubCertOtherFinancialYearGroup');
            const otherInput = document.getElementById('pubCertFinancialYearOther');
            
            if (select.value === 'Other') {
                otherGroup.style.display = 'block';
                otherInput.required = true;
            } else {
                otherGroup.style.display = 'none';
                otherInput.required = false;
                otherInput.value = '';
            }
        }

        function handlePublicIPVAPTComplianceCertSubmit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('publicIPVAPTComplianceCertSubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            const formData = new FormData(document.getElementById('publicIPVAPTComplianceCertForm'));
            
            fetch('/process_public_ip_vapt_compliance_certificate', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    const link = document.createElement('a');
                    link.href = data.download_url;
                    link.download = data.filename;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    closeModal('publicIPVAPTComplianceCertModal');
                    document.getElementById('publicIPVAPTComplianceCertForm').reset();
                    togglePubCertOtherOrganization();
                    togglePubCertOtherFinancialYear();
                    
                    setTimeout(() => {
                        fetch('/cleanup_public_ip_vapt_compliance_certificate', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ filename: data.filename })
                        })
                        .then(() => location.reload())
                        .catch(err => location.reload());
                    }, 1000);
                } else {
                    alert('Error: ' + (data.error || 'Unknown error'));
                }
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            })
            .catch(error => {
                console.error('Public IP VAPT Compliance Certificate Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // Create Cyber Security Audit Excel Functions
        function handleCreateCyberSecurityAuditExcelSubmit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('createCyberSecurityAuditExcelSubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            const formData = new FormData(document.getElementById('createCyberSecurityAuditExcelForm'));
            
            fetch('/create_cyber_security_audit_excel', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Download the file using blob to set custom filename
                    fetch(data.download_url)
                        .then(response => response.blob())
                        .then(blob => {
                            const url = window.URL.createObjectURL(blob);
                            const link = document.createElement('a');
                            link.href = url;
                            link.download = data.excel_file;
                            document.body.appendChild(link);
                            link.click();
                            document.body.removeChild(link);
                            window.URL.revokeObjectURL(url);
                            
                            closeModal('createCyberSecurityAuditExcelModal');
                            
                            // Cleanup and reload after 2 seconds
                            setTimeout(() => {
                                fetch('/cleanup_cyber_security_audit', {
                                    method: 'POST'
                                }).then(() => {
                                    location.reload();
                                });
                            }, 2000);
                        });
                } else {
                    alert('Error: ' + (data.error || 'Unknown error'));
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                }
            })
            .catch(error => {
                console.error('Create Cyber Security Audit Excel Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // Meity Audit Part 1 Functions
        function handleMeityAuditPart1Submit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('meityAuditPart1FormSubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            const formData = new FormData(document.getElementById('meityAuditPart1Form'));
            
            fetch('/process_meity_audit_part1', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Download the file
                    const link = document.createElement('a');
                    link.href = data.download_url;
                    link.download = data.filename;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    // Close modal
                    closeModal('meityAuditPart1Modal');
                    
                    // Cleanup and reload after 2 seconds
                    setTimeout(() => {
                        fetch('/cleanup_meity_audit_part1', {
                            method: 'POST'
                        }).then(() => {
                            location.reload();
                        });
                    }, 2000);
                } else {
                    alert('Error: ' + (data.error || 'Unknown error'));
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                }
            })
            .catch(error => {
                console.error('Meity Audit Part 1 Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        // Meity Audit Part 2 Functions
        function handleMeityAuditPart2Submit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('meityAuditPart2FormSubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            const formData = new FormData(document.getElementById('meityAuditPart2Form'));
            
            fetch('/process_meity_audit_part2', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Download the file
                    const link = document.createElement('a');
                    link.href = data.download_url;
                    link.download = data.filename;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    // Close modal
                    closeModal('meityAuditPart2Modal');
                    
                    // Cleanup and reload after 2 seconds
                    setTimeout(() => {
                        fetch('/cleanup_meity_audit_part2', {
                            method: 'POST'
                        }).then(() => {
                            location.reload();
                        });
                    }, 2000);
                } else {
                    alert('Error: ' + (data.error || 'Unknown error'));
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                }
            })
            .catch(error => {
                console.error('Meity Audit Part 2 Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

        document.addEventListener('DOMContentLoaded', function () {
            const startAuditInput = document.getElementById('gapBankStartDate');
            const endAuditInput = document.getElementById('gapBankEndDate');

            if (!startAuditInput || !endAuditInput) {
                return;
            }

            const applyEndConstraints = () => {
                if (startAuditInput.value) {
                    endAuditInput.min = startAuditInput.value;

                    if (endAuditInput.value && endAuditInput.value < startAuditInput.value) {
                        endAuditInput.value = startAuditInput.value;
                    }
                } else {
                    endAuditInput.removeAttribute('min');
                }
            };

            const applyStartConstraints = () => {
                if (endAuditInput.value) {
                    startAuditInput.max = endAuditInput.value;

                    if (startAuditInput.value && startAuditInput.value > endAuditInput.value) {
                        startAuditInput.value = endAuditInput.value;
                    }
                } else {
                    startAuditInput.removeAttribute('max');
                }
            };

            startAuditInput.addEventListener('change', () => {
                applyEndConstraints();
                applyStartConstraints();
            });

            endAuditInput.addEventListener('change', () => {
                applyStartConstraints();
                applyEndConstraints();
            });

            applyStartConstraints();
            applyEndConstraints();
        });

    // Date constraints for Gap Assessment Audit Certificate form
    document.addEventListener('DOMContentLoaded', function() {
        const startAuditInput = document.getElementById('gapAssessmentAuditCertificateStartAuditDate');
        const endAuditInput = document.getElementById('gapAssessmentAuditCertificateEndAuditDate');

        if (!startAuditInput || !endAuditInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        // When start audit date changes, set minimum date for end audit date (start date + 1 day)
        const applyEndDateMinConstraint = () => {
            if (startAuditInput.value) {
                const startDate = new Date(startAuditInput.value);
                // Set minimum to start date + 1 day (so end date must be after start date)
                const minDate = new Date(startDate);
                minDate.setDate(minDate.getDate() + 1);
                const minDateStr = formatDate(minDate);
                endAuditInput.setAttribute('min', minDateStr);
                // If end date is before or equal to start date, clear it
                if (endAuditInput.value && endAuditInput.value <= startAuditInput.value) {
                    endAuditInput.value = '';
                }
            } else {
                endAuditInput.removeAttribute('min');
            }
        };

        // When end audit date changes, set maximum date for start audit date (end date - 1 day)
        const applyStartDateMaxConstraint = () => {
            if (endAuditInput.value) {
                const endDate = new Date(endAuditInput.value);
                // Set maximum to end date - 1 day (so start date must be before end date)
                const maxDate = new Date(endDate);
                maxDate.setDate(maxDate.getDate() - 1);
                const maxDateStr = formatDate(maxDate);
                startAuditInput.setAttribute('max', maxDateStr);
                // If start date is after or equal to end date, clear it
                if (startAuditInput.value && startAuditInput.value >= endAuditInput.value) {
                    startAuditInput.value = '';
                }
            } else {
                startAuditInput.removeAttribute('max');
            }
        };

        // Add event listeners
        startAuditInput.addEventListener('change', () => {
            applyEndDateMinConstraint();
        });

        endAuditInput.addEventListener('change', () => {
            applyStartDateMaxConstraint();
        });

        // Apply constraints on page load if values are already set
        applyEndDateMinConstraint();
        applyStartDateMaxConstraint();
    });

    // Date constraints for Cyber Security Audit Certificate form
    document.addEventListener('DOMContentLoaded', function() {
        const startAuditInput = document.getElementById('cyberSecurityAuditCertificateStartAuditDate');
        const endAuditInput = document.getElementById('cyberSecurityAuditCertificateEndAuditDate');

        if (!startAuditInput || !endAuditInput) {
            return;
        }

        const formatDate = (date) => date.toISOString().split('T')[0];

        // When start audit date changes, set minimum date for end audit date (start date + 1 day)
        const applyEndDateMinConstraint = () => {
            if (startAuditInput.value) {
                const startDate = new Date(startAuditInput.value);
                // Set minimum to start date + 1 day (so end date must be after start date)
                const minDate = new Date(startDate);
                minDate.setDate(minDate.getDate() + 1);
                const minDateStr = formatDate(minDate);
                endAuditInput.setAttribute('min', minDateStr);
                // If end date is before or equal to start date, clear it
                if (endAuditInput.value && endAuditInput.value <= startAuditInput.value) {
                    endAuditInput.value = '';
                }
            } else {
                endAuditInput.removeAttribute('min');
            }
        };

        // When end audit date changes, set maximum date for start audit date (end date - 1 day)
        const applyStartDateMaxConstraint = () => {
            if (endAuditInput.value) {
                const endDate = new Date(endAuditInput.value);
                // Set maximum to end date - 1 day (so start date must be before end date)
                const maxDate = new Date(endDate);
                maxDate.setDate(maxDate.getDate() - 1);
                const maxDateStr = formatDate(maxDate);
                startAuditInput.setAttribute('max', maxDateStr);
                // If start date is after or equal to end date, clear it
                if (startAuditInput.value && startAuditInput.value >= endAuditInput.value) {
                    startAuditInput.value = '';
                }
            } else {
                startAuditInput.removeAttribute('max');
            }
        };

        // Add event listeners
        startAuditInput.addEventListener('change', () => {
            applyEndDateMinConstraint();
        });

        endAuditInput.addEventListener('change', () => {
            applyStartDateMaxConstraint();
        });

        // Apply constraints on page load if values are already set
        applyEndDateMinConstraint();
        applyStartDateMaxConstraint();
    });

        // Meity Audit Part 3 Functions
        function handleMeityAuditPart3Submit(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('meityAuditPart3FormSubmitBtn');
            const originalText = submitBtn.innerHTML;
            
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            const formData = new FormData(document.getElementById('meityAuditPart3Form'));
            
            fetch('/process_meity_audit_part3', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Download the file
                    const link = document.createElement('a');
                    link.href = data.download_url;
                    link.download = data.filename;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    // Close modal
                    closeModal('meityAuditPart3Modal');
                    
                    // Cleanup and reload after 2 seconds
                    setTimeout(() => {
                        fetch('/cleanup_meity_audit_part3', {
                            method: 'POST'
                        }).then(() => {
                            location.reload();
                        });
                    }, 2000);
                } else {
                    alert('Error: ' + (data.error || 'Unknown error'));
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                }
            })
            .catch(error => {
                console.error('Meity Audit Part 3 Error:', error);
                alert('An error occurred: ' + error.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        }

    </script>


<script src="{{ url_for('static', filename='JS/audit_dashboard.js') }}"></script>

<script>
    // Accordion fallback initialization - ensure it works
    (function() {
        function initAccordion() {
            const accordionButtons = document.querySelectorAll('.accordion-btn');
            console.log('Initializing accordion buttons:', accordionButtons.length);
            
            accordionButtons.forEach(btn => {
                // Remove existing listeners to avoid duplicates
                const newBtn = btn.cloneNode(true);
                btn.parentNode.replaceChild(newBtn, btn);
                
                newBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    console.log('Accordion button clicked');
                    this.classList.toggle('active');
                    const content = this.nextElementSibling;
                    const chevron = this.querySelector('.fa-chevron-down');
                    
                    if (!content || !content.classList.contains('accordion-content')) {
                        console.error('Accordion content not found');
                        return;
                    }
                    
                    // Check current state
                    const currentMaxHeight = content.style.maxHeight;
                    const isOpen = currentMaxHeight && 
                                  currentMaxHeight !== '0px' && 
                                  currentMaxHeight !== '0' &&
                                  currentMaxHeight !== '';
                    
                    if (isOpen) {
                        // Close
                        content.style.maxHeight = '0px';
                        if (chevron) {
                            chevron.style.transform = 'rotate(0deg)';
                        }
                        console.log('Accordion closed');
                    } else {
                        // Open
                        content.style.maxHeight = content.scrollHeight + "px";
                        if (chevron) {
                            chevron.style.transform = 'rotate(180deg)';
                        }
                        console.log('Accordion opened, maxHeight:', content.style.maxHeight);
                    }
                });
            });
        }
        
        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function() {
                setTimeout(initAccordion, 100);
            });
        } else {
            setTimeout(initAccordion, 100);
        }
    })();
</script>
</body>
</html>